#!/bin/bash

apis=("tasklet_disable"
"tasklet_enable"
"tasklet_kill"
"tasklet_schedule"
"tasklet_setup"
"alloc_workqueue"
"wiphy_delayed_work_cancel"
"wiphy_delayed_work_flush"
"wiphy_delayed_work_init"
"wiphy_delayed_work_queue"
"wiphy_work_cancel"
"wiphy_work_flush"
"wiphy_work_init"
"wiphy_work_queue"
"wiphy_work_cancel"
"wiphy_work_flush"
"wiphy_work_init"
"wiphy_work_queue"
"schedule_work"
"schedule_delayed_work"
"queue_work"
"queue_delayed_work"
"destroy_workqueue"
"mod_delayed_work"
"cancel_delayed_work"
"cancel_delayed_work_sync"
"cancel_work_sync"
"flush_delayed_work"
"flush_work"
"flush_workqueue"
"add_timer"
"del_timer"
"del_timer_sync"
"timer_setup"
"timer_shutdown_sync"
"mod_timer"
"spin_lock"
"spin_lock_bh"
"spin_lock_init"
"spin_lock_irqsave"
"spin_lock_nested"
"spin_trylock_bh"
"spin_unlock"
"spin_unlock_bh"
"spin_unlock_irqrestore"
"mutex_destroy"
"mutex_init"
"mutex_lock"
"mutex_unlock"
#"__skb_dequeue"
#"skb_dequeue"
"list_add"
"list_add_rcu"
"list_add_tail"
"list_del"
"list_del_init"
"list_del_rcu"
"list_move_tail"
"list_splice_tail"
"list_splice_tail_init"
"wait_event"
"wait_for_completion"
"wake_up_all"
"wiphy_lock"
"wiphy_unlock"
"wiphy_work_init"
"wiphy_register"
"wiphy_unregister"
"rcu_read_lock"
"rcu_read_unlock"
"hlist_add_head"
"hlist_add_head_rcu"
"hlist_del"
"hlist_del_rcu"
"rcu_read_lock"
"rcu_read_unlock"
"rhltable_destroy"
"rhltable_init"
"rhltable_remove"
"rhashtable_init"
"rhashtable_remove_fast"
"rtnl_lock"
"rtnl_unlock"
"rhashtable_free_and_destroy"
"read_lock_bh"
"read_unlock_bh"
"netif_addr_lock_bh"
"netif_addr_unlock_bh")

for api in "${apis[@]}";
do
	x="$api"_"dbg"
	echo "Replacing $api with $x ...."

	find ./ -iname "*.c" -print | xargs sed -E -i "s/\b$api\b/$x/g"
done

