cscope 15 /home/bharathi/Downloads/kernel_692/linux-6.9.2/net/wireless               0001717186
	@ap.c

6 
	~<löux/õì80211.h
>

7 
	~<löux/exp‹t.h
>

8 
	~<√t/cfg80211.h
>

9 
	~"∆80211.h
"

10 
	~"c‹e.h
"

11 
	~"rdev-›s.h
"

14 
	$___cfg80211_°›_≠
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

15 
√t_devi˚
 *
dev
, 
lök_id
,

16 
boﬁ
 
nŸify
)

18 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

19 
îr
;

21 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

23 i‡(!
rdev
->
›s
->
°›_≠
)

24  -
EOPNOTSUPP
;

26 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

27 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
)

28  -
EOPNOTSUPP
;

30 i‡(!
wdev
->
löks
[
lök_id
].
≠
.
bóc⁄_öãrvÆ
)

31  -
ENOENT
;

33 
îr
 = 
	`rdev_°›_≠
(
rdev
, 
dev
, 
lök_id
);

34 i‡(!
îr
) {

35 
wdev
->
c⁄n_ow√r_∆p‹tid
 = 0;

36 
wdev
->
löks
[
lök_id
].
≠
.
bóc⁄_öãrvÆ
 = 0;

37 
	`mem£t
(&
wdev
->
löks
[
lök_id
].
≠
.
ch™def
, 0,

38 (
wdev
->
löks
[
lök_id
].
≠
.
ch™def
));

39 
wdev
->
u
.
≠
.
ssid_Àn
 = 0;

40 
	`rdev_£t_qos_m≠
(
rdev
, 
dev
, 
NULL
);

41 i‡(
nŸify
)

42 
	`∆80211_£nd_≠_°›≥d
(
wdev
, 
lök_id
);

47 
	`cfg80211_sched_dfs_ch™_upd©e
(
rdev
);

50 
	`scheduÀ_w‹k
(&
cfg80211_disc⁄√˘_w‹k
);

52  
îr
;

53 
	}
}

55 
	$cfg80211_°›_≠
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

56 
√t_devi˚
 *
dev
, 
lök_id
,

57 
boﬁ
 
nŸify
)

59 
lök
;

60 
ªt
 = 0;

62 i‡(
lök_id
 >= 0)

63  
	`___cfg80211_°›_≠
(
rdev
, 
dev
, 
lök_id
, 
nŸify
);

65 
	`f‹_óch_vÆid_lök
(
dev
->
õì80211_±r
, 
lök
) {

66 
ªt1
 = 
	`___cfg80211_°›_≠
(
rdev
, 
dev
, 
lök
, 
nŸify
);

68 i‡(
ªt1
)

69 
ªt
 = 
ªt1
;

73  
ªt
;

74 
	}
}

	@cfg80211.mod.c

1 
	~<löux/moduÀ.h
>

2 
	#INCLUDE_VERMAGIC


	)

3 
	~<löux/buûd-ß….h
>

4 
	~<löux/ñ‚Ÿe-…o.h
>

5 
	~<löux/exp‹t-öã∫Æ.h
>

6 
	~<löux/vîmagic.h
>

7 
	~<löux/compûî.h
>

9 #ifde‡
CONFIG_UNWINDER_ORC


10 
	~<asm/‹c_hódî.h
>

11 
	gORC_HEADER
;

14 
	gBUILD_SALT
;

15 
	gBUILD_LTO_INFO
;

17 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

18 
MODULE_INFO
(
«me
, 
KBUILD_MODNAME
);

20 
__visibÀ
 
moduÀ
 
__this_moduÀ


21 
__£˘i⁄
(".gnu.linkonce.this_module") = {

22 .
«me
 = 
KBUILD_MODNAME
,

23 .
	göô
 = 
öô_moduÀ
,

24 #ifde‡
CONFIG_MODULE_UNLOAD


25 .
	gexô
 = 
˛ónup_moduÀ
,

27 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

30 #ifde‡
CONFIG_MITIGATION_RETPOLINE


31 
MODULE_INFO
(
ªçﬁöe
, "Y");

34 
KSYMTAB_FUNC
(
cfg80211_shutdown_Æl_öãrÁ˚s
, "_gpl", "");

35 
KSYMTAB_FUNC
(
wùhy_√w_nm
, "", "");

36 
KSYMTAB_FUNC
(
wùhy_ªgi°î
, "", "");

37 
KSYMTAB_FUNC
(
wùhy_rfkûl_°¨t_pﬁlög
, "", "");

38 
KSYMTAB_FUNC
(
wùhy_uƒegi°î
, "", "");

39 
KSYMTAB_FUNC
(
wùhy_‰ì
, "", "");

40 
KSYMTAB_FUNC
(
wùhy_rfkûl_£t_hw_°©e_ªas⁄
, "", "");

41 
KSYMTAB_FUNC
(
cfg80211_uƒegi°î_wdev
, "", "");

42 
KSYMTAB_FUNC
(
cfg80211_°›_iÁ˚
, "", "");

43 
KSYMTAB_FUNC
(
cfg80211_ªgi°î_√tdevi˚
, "", "");

44 
KSYMTAB_FUNC
(
wùhy_w‹k_queue
, "_gpl", "");

45 
KSYMTAB_FUNC
(
wùhy_w‹k_ˇn˚l
, "_gpl", "");

46 
KSYMTAB_FUNC
(
wùhy_w‹k_Êush
, "_gpl", "");

47 
KSYMTAB_FUNC
(
wùhy_dñayed_w‹k_timî
, "", "");

48 
KSYMTAB_FUNC
(
wùhy_dñayed_w‹k_queue
, "_gpl", "");

49 
KSYMTAB_FUNC
(
wùhy_dñayed_w‹k_ˇn˚l
, "_gpl", "");

50 
KSYMTAB_FUNC
(
wùhy_dñayed_w‹k_Êush
, "_gpl", "");

51 
KSYMTAB_FUNC
(
õì80211_ødiŸ≠_ôî©‹_öô
, "", "");

52 
KSYMTAB_FUNC
(
õì80211_ødiŸ≠_ôî©‹_√xt
, "", "");

53 
KSYMTAB_FUNC
(
õì80211_gë_ª•⁄£_øã
, "", "");

54 
KSYMTAB_FUNC
(
õì80211_m™d©‹y_øãs
, "", "");

55 
KSYMTAB_FUNC
(
õì80211_ch™√l_to_‰eq_khz
, "", "");

56 
KSYMTAB_FUNC
(
õì80211_s1g_ch™√l_width
, "", "");

57 
KSYMTAB_FUNC
(
õì80211_‰eq_khz_to_ch™√l
, "", "");

58 
KSYMTAB_FUNC
(
õì80211_gë_ch™√l_khz
, "", "");

59 
KSYMTAB_FUNC
(
õì80211_hdæí
, "", "");

60 
KSYMTAB_FUNC
(
õì80211_gë_hdæí_‰om_skb
, "", "");

61 
KSYMTAB_FUNC
(
õì80211_gë_mesh_hdæí
, "", "");

62 
KSYMTAB_FUNC
(
õì80211_gë_8023_tu¬ñ_¥Ÿo
, "", "");

63 
KSYMTAB_FUNC
(
õì80211_°rù_8023_mesh_hdr
, "", "");

64 
KSYMTAB_FUNC
(
õì80211_d©a_to_8023_exthdr
, "", "");

65 
KSYMTAB_FUNC
(
õì80211_is_vÆid_amsdu
, "", "");

66 
KSYMTAB_FUNC
(
õì80211_amsdu_to_8023s
, "", "");

67 
KSYMTAB_FUNC
(
cfg80211_˛assify8021d
, "", "");

68 
KSYMTAB_FUNC
(
õì80211_bss_gë_ñem
, "", "");

69 
KSYMTAB_FUNC
(
cfg80211_ˇlcuœã_bôøã
, "", "");

70 
KSYMTAB_FUNC
(
cfg80211_gë_p2p_©å
, "", "");

71 
KSYMTAB_FUNC
(
õì80211_õ_•lô_ric
, "", "");

72 
KSYMTAB_FUNC
(
õì80211_‰agmít_ñemít
, "", "");

73 
KSYMTAB_FUNC
(
õì80211_›î©ög_˛ass_to_b™d
, "", "");

74 
KSYMTAB_FUNC
(
õì80211_›î©ög_˛ass_to_ch™def
, "", "");

75 
KSYMTAB_FUNC
(
õì80211_ch™def_to_›î©ög_˛ass
, "", "");

76 
KSYMTAB_FUNC
(
cfg80211_ôî_combö©i⁄s
, "", "");

77 
KSYMTAB_FUNC
(
cfg80211_check_combö©i⁄s
, "", "");

78 
KSYMTAB_FUNC
(
õì80211_gë_num_suµ‹ãd_ch™√ls
, "", "");

79 
KSYMTAB_FUNC
(
cfg80211_gë_°©i⁄
, "", "");

80 
KSYMTAB_FUNC
(
cfg80211_‰ì_«n_func
, "", "");

81 
KSYMTAB_FUNC
(
cfg80211_söfo_Æloc_tid_°©s
, "", "");

82 
KSYMTAB_DATA
(
rfc1042_hódî
, "", "");

83 
KSYMTAB_DATA
(
bridge_tu¬ñ_hódî
, "", "");

84 
KSYMTAB_FUNC
(
cfg80211_£nd_œyî2_upd©e
, "", "");

85 
KSYMTAB_FUNC
(
õì80211_gë_vht_max_nss
, "", "");

86 
KSYMTAB_FUNC
(
cfg80211_i·y≥_Ælowed
, "", "");

87 
KSYMTAB_FUNC
(
cfg80211_gë_i·y≥_ext_ˇ∑
, "", "");

88 
KSYMTAB_FUNC
(
gë_wùhy_ªgdom
, "", "");

89 
KSYMTAB_FUNC
(
ªg_quîy_ªgdb_wmm
, "", "");

90 
KSYMTAB_FUNC
(
‰eq_ªg_öfo
, "", "");

91 
KSYMTAB_FUNC
(
ªg_öôüt‹_«me
, "", "");

92 
KSYMTAB_FUNC
(
wùhy_≠∂y_cu°om_ªguœt‹y
, "", "");

93 
KSYMTAB_FUNC
(
ªguœt‹y_höt
, "", "");

94 
KSYMTAB_FUNC
(
ªguœt‹y_£t_wùhy_ªgd
, "", "");

95 
KSYMTAB_FUNC
(
ªguœt‹y_£t_wùhy_ªgd_sync
, "", "");

96 
KSYMTAB_FUNC
(
ªguœt‹y_¥e_ˇc_Ælowed
, "", "");

97 
KSYMTAB_FUNC
(
cfg80211_is_ñemít_öhîôed
, "", "");

98 
KSYMTAB_FUNC
(
cfg80211_ôî_∫r
, "_gpl", "");

99 
KSYMTAB_FUNC
(
cfg80211_sˇn_d⁄e
, "", "");

100 
KSYMTAB_FUNC
(
cfg80211_sched_sˇn_ªsu…s
, "", "");

101 
KSYMTAB_FUNC
(
cfg80211_sched_sˇn_°›≥d_locked
, "", "");

102 
KSYMTAB_FUNC
(
cfg80211_sched_sˇn_°›≥d
, "", "");

103 
KSYMTAB_FUNC
(
cfg80211_bss_Êush
, "", "");

104 
KSYMTAB_FUNC
(
cfg80211_föd_ñem_m©ch
, "", "");

105 
KSYMTAB_FUNC
(
cfg80211_föd_víd‹_ñem
, "", "");

106 
KSYMTAB_FUNC
(
__cfg80211_gë_bss
, "", "");

107 
KSYMTAB_FUNC
(
cfg80211_gë_õs_ch™√l_numbî
, "", "");

108 
KSYMTAB_FUNC
(
cfg80211_mîge_¥ofûe
, "", "");

109 
KSYMTAB_FUNC
(
cfg80211_de‰agmít_ñemít
, "", "");

110 
KSYMTAB_FUNC
(
cfg80211_öf‹m_bss_d©a
, "", "");

111 
KSYMTAB_FUNC
(
cfg80211_öf‹m_bss_‰ame_d©a
, "", "");

112 
KSYMTAB_FUNC
(
cfg80211_ªf_bss
, "", "");

113 
KSYMTAB_FUNC
(
cfg80211_put_bss
, "", "");

114 
KSYMTAB_FUNC
(
cfg80211_u∆ök_bss
, "", "");

115 
KSYMTAB_FUNC
(
cfg80211_bss_ôî
, "", "");

116 
KSYMTAB_FUNC
(
cfg80211_wext_siwsˇn
, "_gpl", "");

117 
KSYMTAB_FUNC
(
cfg80211_wext_giwsˇn
, "_gpl", "");

118 
KSYMTAB_FUNC
(
∆80211_£nd_ch™def
, "", "");

119 
KSYMTAB_FUNC
(
cfg80211_check_°©i⁄_ch™ge
, "", "");

120 
KSYMTAB_FUNC
(
__cfg80211_Æloc_evít_skb
, "", "");

121 
KSYMTAB_FUNC
(
__cfg80211_£nd_evít_skb
, "", "");

122 
KSYMTAB_FUNC
(
cfg80211_«n_m©ch
, "", "");

123 
KSYMTAB_FUNC
(
cfg80211_«n_func_ãrmö©ed
, "", "");

124 
KSYMTAB_FUNC
(
__cfg80211_Æloc_ª∂y_skb
, "", "");

125 
KSYMTAB_FUNC
(
cfg80211_víd‹_cmd_ª∂y
, "_gpl", "");

126 
KSYMTAB_FUNC
(
cfg80211_víd‹_cmd_gë_£ndî
, "_gpl", "");

127 
KSYMTAB_FUNC
(
cfg80211_rx_u≈rŸ_mlme_mgmt
, "", "");

128 
KSYMTAB_FUNC
(
cfg80211_löks_ªmoved
, "", "");

129 
KSYMTAB_FUNC
(
cfg80211_nŸify_√w_≥î_ˇndid©e
, "", "");

130 
KSYMTAB_FUNC
(
cfg80211_assoc_comeback
, "", "");

131 
KSYMTAB_FUNC
(
cfg80211_ªady_⁄_ch™√l
, "", "");

132 
KSYMTAB_FUNC
(
cfg80211_ªmaö_⁄_ch™√l_expúed
, "", "");

133 
KSYMTAB_FUNC
(
cfg80211_tx_mgmt_expúed
, "", "");

134 
KSYMTAB_FUNC
(
cfg80211_√w_°a
, "", "");

135 
KSYMTAB_FUNC
(
cfg80211_dñ_°a_söfo
, "", "");

136 
KSYMTAB_FUNC
(
cfg80211_c⁄n_Áûed
, "", "");

137 
KSYMTAB_FUNC
(
cfg80211_rx_•urious_‰ame
, "", "");

138 
KSYMTAB_FUNC
(
cfg80211_rx_u√x≥˘ed_4addr_‰ame
, "", "");

139 
KSYMTAB_FUNC
(
cfg80211_c⁄åﬁ_p‹t_tx_°©us
, "", "");

140 
KSYMTAB_FUNC
(
cfg80211_mgmt_tx_°©us_ext
, "", "");

141 
KSYMTAB_FUNC
(
cfg80211_rx_c⁄åﬁ_p‹t
, "", "");

142 
KSYMTAB_FUNC
(
cfg80211_cqm_rssi_nŸify
, "", "");

143 
KSYMTAB_FUNC
(
cfg80211_cqm_txe_nŸify
, "", "");

144 
KSYMTAB_FUNC
(
cfg80211_cqm_pkéoss_nŸify
, "", "");

145 
KSYMTAB_FUNC
(
cfg80211_cqm_bóc⁄_loss_nŸify
, "", "");

146 
KSYMTAB_FUNC
(
cfg80211_gtk_ªkey_nŸify
, "", "");

147 
KSYMTAB_FUNC
(
cfg80211_pmkß_ˇndid©e_nŸify
, "", "");

148 
KSYMTAB_FUNC
(
cfg80211_ch_swôch_nŸify
, "", "");

149 
KSYMTAB_FUNC
(
cfg80211_ch_swôch_°¨ãd_nŸify
, "", "");

150 
KSYMTAB_FUNC
(
cfg80211_bss_cﬁ‹_nŸify
, "", "");

151 
KSYMTAB_FUNC
(
cfg80211_°a_›mode_ch™ge_nŸify
, "", "");

152 
KSYMTAB_FUNC
(
cfg80211_¥obe_°©us
, "", "");

153 
KSYMTAB_FUNC
(
cfg80211_ªp‹t_obss_bóc⁄_khz
, "", "");

154 
KSYMTAB_FUNC
(
cfg80211_ªp‹t_wowœn_wakeup
, "", "");

155 
KSYMTAB_FUNC
(
cfg80211_tdls_›î_ªque°
, "", "");

156 
KSYMTAB_FUNC
(
cfg80211_·_evít
, "", "");

157 
KSYMTAB_FUNC
(
cfg80211_¸ô_¥Ÿo_°›≥d
, "", "");

158 
KSYMTAB_FUNC
(
cfg80211_exã∫Æ_auth_ªque°
, "", "");

159 
KSYMTAB_FUNC
(
cfg80211_upd©e_owe_öfo_evít
, "", "");

160 
KSYMTAB_FUNC
(
cfg80211_scheduÀ_ch™√ls_check
, "", "");

161 
KSYMTAB_FUNC
(
cfg80211_rx_assoc_ª•
, "", "");

162 
KSYMTAB_FUNC
(
cfg80211_rx_mlme_mgmt
, "", "");

163 
KSYMTAB_FUNC
(
cfg80211_auth_timeout
, "", "");

164 
KSYMTAB_FUNC
(
cfg80211_assoc_Áûuª
, "", "");

165 
KSYMTAB_FUNC
(
cfg80211_tx_mlme_mgmt
, "", "");

166 
KSYMTAB_FUNC
(
cfg80211_mich´l_mic_Áûuª
, "", "");

167 
KSYMTAB_FUNC
(
cfg80211_rx_mgmt_ext
, "", "");

168 
KSYMTAB_FUNC
(
__cfg80211_ød¨_evít
, "", "");

169 
KSYMTAB_FUNC
(
cfg80211_ˇc_evít
, "", "");

170 
KSYMTAB_FUNC
(
cfg80211_background_ˇc_ab‹t
, "", "");

171 
KSYMTAB_FUNC
(
cfg80211_ibss_joöed
, "", "");

172 
KSYMTAB_FUNC
(
cfg80211_c⁄√˘_d⁄e
, "", "");

173 
KSYMTAB_FUNC
(
cfg80211_rﬂmed
, "", "");

174 
KSYMTAB_FUNC
(
cfg80211_p‹t_auth‹ized
, "", "");

175 
KSYMTAB_FUNC
(
cfg80211_disc⁄√˘ed
, "", "");

176 
KSYMTAB_FUNC
(
cfg80211_ch™def_¸óã
, "", "");

177 
KSYMTAB_FUNC
(
∆80211_ch™_width_to_mhz
, "", "");

178 
KSYMTAB_FUNC
(
cfg80211_ch™def_vÆid
, "", "");

179 
KSYMTAB_FUNC
(
cfg80211_ch™def_¥im¨y
, "", "");

180 
KSYMTAB_FUNC
(
cfg80211_ch™def_com∑tibÀ
, "", "");

181 
KSYMTAB_FUNC
(
cfg80211_ch™def_dfs_ªquúed
, "", "");

182 
KSYMTAB_FUNC
(
cfg80211_ch™def_dfs_ußbÀ
, "", "");

183 
KSYMTAB_FUNC
(
cfg80211_ch™def_dfs_ˇc_time
, "", "");

184 
KSYMTAB_FUNC
(
cfg80211_ch™def_ußbÀ
, "", "");

185 
KSYMTAB_FUNC
(
cfg80211_ªg_ˇn_bóc⁄
, "", "");

186 
KSYMTAB_FUNC
(
cfg80211_ªg_ˇn_bóc⁄_ªœx
, "", "");

187 
KSYMTAB_FUNC
(
cfg80211_™y_ußbÀ_ch™√ls
, "", "");

188 
KSYMTAB_FUNC
(
wdev_ch™def
, "", "");

189 
KSYMTAB_FUNC
(
cfg80211_gë_drvöfo
, "", "");

190 
KSYMTAB_FUNC
(
cfg80211_pm§_com∂ëe
, "_gpl", "");

191 
KSYMTAB_FUNC
(
cfg80211_pm§_ªp‹t
, "_gpl", "");

192 
KSYMTAB_FUNC
(
wùhy_locked_debugfs_ªad
, "_gpl", "");

193 
KSYMTAB_FUNC
(
wùhy_locked_debugfs_wrôe
, "_gpl", "");

194 
KSYMTAB_FUNC
(
cfg80211_wext_giw«me
, "_gpl", "");

195 
KSYMTAB_FUNC
(
cfg80211_wext_siwmode
, "_gpl", "");

196 
KSYMTAB_FUNC
(
cfg80211_wext_giwmode
, "_gpl", "");

197 
KSYMTAB_FUNC
(
cfg80211_wext_giwønge
, "_gpl", "");

198 
KSYMTAB_FUNC
(
cfg80211_wext_siwπs
, "_gpl", "");

199 
KSYMTAB_FUNC
(
cfg80211_wext_giwπs
, "_gpl", "");

200 
KSYMTAB_FUNC
(
cfg80211_wext_siw‰ag
, "_gpl", "");

201 
KSYMTAB_FUNC
(
cfg80211_wext_giw‰ag
, "_gpl", "");

202 
KSYMTAB_FUNC
(
cfg80211_wext_giwªåy
, "_gpl", "");

204 
SYMBOL_CRC
(
cfg80211_shutdown_Æl_öãrÁ˚s
, 0x2850c99a, "_gpl");

205 
SYMBOL_CRC
(
wùhy_√w_nm
, 0x41226da2, "");

206 
SYMBOL_CRC
(
wùhy_ªgi°î
, 0xbe6343c1, "");

207 
SYMBOL_CRC
(
wùhy_rfkûl_°¨t_pﬁlög
, 0xb5192425, "");

208 
SYMBOL_CRC
(
wùhy_uƒegi°î
, 0xe6aaa79c, "");

209 
SYMBOL_CRC
(
wùhy_‰ì
, 0x1b5313f5, "");

210 
SYMBOL_CRC
(
wùhy_rfkûl_£t_hw_°©e_ªas⁄
, 0xda57179b, "");

211 
SYMBOL_CRC
(
cfg80211_uƒegi°î_wdev
, 0xc4d88a53, "");

212 
SYMBOL_CRC
(
cfg80211_°›_iÁ˚
, 0x973ccff2, "");

213 
SYMBOL_CRC
(
cfg80211_ªgi°î_√tdevi˚
, 0xd737f9bf, "");

214 
SYMBOL_CRC
(
wùhy_w‹k_queue
, 0x95bcba95, "_gpl");

215 
SYMBOL_CRC
(
wùhy_w‹k_ˇn˚l
, 0x1629a7b0, "_gpl");

216 
SYMBOL_CRC
(
wùhy_w‹k_Êush
, 0x35102ceb, "_gpl");

217 
SYMBOL_CRC
(
wùhy_dñayed_w‹k_timî
, 0x85de3f6f, "");

218 
SYMBOL_CRC
(
wùhy_dñayed_w‹k_queue
, 0xc4a7edf8, "_gpl");

219 
SYMBOL_CRC
(
wùhy_dñayed_w‹k_ˇn˚l
, 0x30c096d2, "_gpl");

220 
SYMBOL_CRC
(
wùhy_dñayed_w‹k_Êush
, 0x4cfd617b, "_gpl");

221 
SYMBOL_CRC
(
õì80211_ødiŸ≠_ôî©‹_öô
, 0x43afadee, "");

222 
SYMBOL_CRC
(
õì80211_ødiŸ≠_ôî©‹_√xt
, 0x7acb86ed, "");

223 
SYMBOL_CRC
(
õì80211_gë_ª•⁄£_øã
, 0x6aac3bef, "");

224 
SYMBOL_CRC
(
õì80211_m™d©‹y_øãs
, 0x272d6876, "");

225 
SYMBOL_CRC
(
õì80211_ch™√l_to_‰eq_khz
, 0x5584448a, "");

226 
SYMBOL_CRC
(
õì80211_s1g_ch™√l_width
, 0x1bb59029, "");

227 
SYMBOL_CRC
(
õì80211_‰eq_khz_to_ch™√l
, 0x6bedf402, "");

228 
SYMBOL_CRC
(
õì80211_gë_ch™√l_khz
, 0x3ba40631, "");

229 
SYMBOL_CRC
(
õì80211_hdæí
, 0x7ef39823, "");

230 
SYMBOL_CRC
(
õì80211_gë_hdæí_‰om_skb
, 0x1d16ed32, "");

231 
SYMBOL_CRC
(
õì80211_gë_mesh_hdæí
, 0xd56d55f3, "");

232 
SYMBOL_CRC
(
õì80211_gë_8023_tu¬ñ_¥Ÿo
, 0x13c58e52, "");

233 
SYMBOL_CRC
(
õì80211_°rù_8023_mesh_hdr
, 0x818d211d, "");

234 
SYMBOL_CRC
(
õì80211_d©a_to_8023_exthdr
, 0xb2276be3, "");

235 
SYMBOL_CRC
(
õì80211_is_vÆid_amsdu
, 0x0400b287, "");

236 
SYMBOL_CRC
(
õì80211_amsdu_to_8023s
, 0x0d037cae, "");

237 
SYMBOL_CRC
(
cfg80211_˛assify8021d
, 0x07334917, "");

238 
SYMBOL_CRC
(
õì80211_bss_gë_ñem
, 0x5cba2be4, "");

239 
SYMBOL_CRC
(
cfg80211_ˇlcuœã_bôøã
, 0x3c744e95, "");

240 
SYMBOL_CRC
(
cfg80211_gë_p2p_©å
, 0xf5596d89, "");

241 
SYMBOL_CRC
(
õì80211_õ_•lô_ric
, 0x275269b3, "");

242 
SYMBOL_CRC
(
õì80211_‰agmít_ñemít
, 0xa31253bf, "");

243 
SYMBOL_CRC
(
õì80211_›î©ög_˛ass_to_b™d
, 0xf40bc2f5, "");

244 
SYMBOL_CRC
(
õì80211_›î©ög_˛ass_to_ch™def
, 0x345fa8cc, "");

245 
SYMBOL_CRC
(
õì80211_ch™def_to_›î©ög_˛ass
, 0xefab0596, "");

246 
SYMBOL_CRC
(
cfg80211_ôî_combö©i⁄s
, 0x442afc8e, "");

247 
SYMBOL_CRC
(
cfg80211_check_combö©i⁄s
, 0x5d849196, "");

248 
SYMBOL_CRC
(
õì80211_gë_num_suµ‹ãd_ch™√ls
, 0x4c5ffda0, "");

249 
SYMBOL_CRC
(
cfg80211_gë_°©i⁄
, 0x2a439f22, "");

250 
SYMBOL_CRC
(
cfg80211_‰ì_«n_func
, 0x8fa02936, "");

251 
SYMBOL_CRC
(
cfg80211_söfo_Æloc_tid_°©s
, 0x3c86019a, "");

252 
SYMBOL_CRC
(
rfc1042_hódî
, 0x69b18f43, "");

253 
SYMBOL_CRC
(
bridge_tu¬ñ_hódî
, 0x1879fcbd, "");

254 
SYMBOL_CRC
(
cfg80211_£nd_œyî2_upd©e
, 0x0f22b2e7, "");

255 
SYMBOL_CRC
(
õì80211_gë_vht_max_nss
, 0x7c3ac925, "");

256 
SYMBOL_CRC
(
cfg80211_i·y≥_Ælowed
, 0x2cb2e0e0, "");

257 
SYMBOL_CRC
(
cfg80211_gë_i·y≥_ext_ˇ∑
, 0x625c9b0e, "");

258 
SYMBOL_CRC
(
gë_wùhy_ªgdom
, 0xfb67464b, "");

259 
SYMBOL_CRC
(
ªg_quîy_ªgdb_wmm
, 0x8f495c47, "");

260 
SYMBOL_CRC
(
‰eq_ªg_öfo
, 0x8f3fc172, "");

261 
SYMBOL_CRC
(
ªg_öôüt‹_«me
, 0xdba126c1, "");

262 
SYMBOL_CRC
(
wùhy_≠∂y_cu°om_ªguœt‹y
, 0x606ab5b5, "");

263 
SYMBOL_CRC
(
ªguœt‹y_höt
, 0x9e6e4b44, "");

264 
SYMBOL_CRC
(
ªguœt‹y_£t_wùhy_ªgd
, 0x65c21909, "");

265 
SYMBOL_CRC
(
ªguœt‹y_£t_wùhy_ªgd_sync
, 0x319ff993, "");

266 
SYMBOL_CRC
(
ªguœt‹y_¥e_ˇc_Ælowed
, 0x3842e136, "");

267 
SYMBOL_CRC
(
cfg80211_is_ñemít_öhîôed
, 0xcc1a7c48, "");

268 
SYMBOL_CRC
(
cfg80211_ôî_∫r
, 0x646c544c, "_gpl");

269 
SYMBOL_CRC
(
cfg80211_sˇn_d⁄e
, 0x270aa6c0, "");

270 
SYMBOL_CRC
(
cfg80211_sched_sˇn_ªsu…s
, 0x1dbe5917, "");

271 
SYMBOL_CRC
(
cfg80211_sched_sˇn_°›≥d_locked
, 0x66438f26, "");

272 
SYMBOL_CRC
(
cfg80211_sched_sˇn_°›≥d
, 0x8750abc3, "");

273 
SYMBOL_CRC
(
cfg80211_bss_Êush
, 0x9693ef81, "");

274 
SYMBOL_CRC
(
cfg80211_föd_ñem_m©ch
, 0x9d6cba30, "");

275 
SYMBOL_CRC
(
cfg80211_föd_víd‹_ñem
, 0x79b82a71, "");

276 
SYMBOL_CRC
(
__cfg80211_gë_bss
, 0x84e90575, "");

277 
SYMBOL_CRC
(
cfg80211_gë_õs_ch™√l_numbî
, 0x3aca71a1, "");

278 
SYMBOL_CRC
(
cfg80211_mîge_¥ofûe
, 0x117aca91, "");

279 
SYMBOL_CRC
(
cfg80211_de‰agmít_ñemít
, 0xd6c87a05, "");

280 
SYMBOL_CRC
(
cfg80211_öf‹m_bss_d©a
, 0x8a1e6a5a, "");

281 
SYMBOL_CRC
(
cfg80211_öf‹m_bss_‰ame_d©a
, 0x63fff101, "");

282 
SYMBOL_CRC
(
cfg80211_ªf_bss
, 0xee37f079, "");

283 
SYMBOL_CRC
(
cfg80211_put_bss
, 0xdfdc2e91, "");

284 
SYMBOL_CRC
(
cfg80211_u∆ök_bss
, 0x7757cd27, "");

285 
SYMBOL_CRC
(
cfg80211_bss_ôî
, 0x4a209b8f, "");

286 
SYMBOL_CRC
(
cfg80211_wext_siwsˇn
, 0x76bd2743, "_gpl");

287 
SYMBOL_CRC
(
cfg80211_wext_giwsˇn
, 0x24f9d649, "_gpl");

288 
SYMBOL_CRC
(
∆80211_£nd_ch™def
, 0x43c883f0, "");

289 
SYMBOL_CRC
(
cfg80211_check_°©i⁄_ch™ge
, 0x9c270dcd, "");

290 
SYMBOL_CRC
(
__cfg80211_Æloc_evít_skb
, 0x9646df5e, "");

291 
SYMBOL_CRC
(
__cfg80211_£nd_evít_skb
, 0x2e398578, "");

292 
SYMBOL_CRC
(
cfg80211_«n_m©ch
, 0x686d069a, "");

293 
SYMBOL_CRC
(
cfg80211_«n_func_ãrmö©ed
, 0x76ee3106, "");

294 
SYMBOL_CRC
(
__cfg80211_Æloc_ª∂y_skb
, 0x950ee53f, "");

295 
SYMBOL_CRC
(
cfg80211_víd‹_cmd_ª∂y
, 0x4f8bb154, "_gpl");

296 
SYMBOL_CRC
(
cfg80211_víd‹_cmd_gë_£ndî
, 0xf70d02ea, "_gpl");

297 
SYMBOL_CRC
(
cfg80211_rx_u≈rŸ_mlme_mgmt
, 0xd450b445, "");

298 
SYMBOL_CRC
(
cfg80211_löks_ªmoved
, 0x5c3cd60f, "");

299 
SYMBOL_CRC
(
cfg80211_nŸify_√w_≥î_ˇndid©e
, 0x33159b84, "");

300 
SYMBOL_CRC
(
cfg80211_assoc_comeback
, 0x1325e2b5, "");

301 
SYMBOL_CRC
(
cfg80211_ªady_⁄_ch™√l
, 0x9a0220a5, "");

302 
SYMBOL_CRC
(
cfg80211_ªmaö_⁄_ch™√l_expúed
, 0x214b213e, "");

303 
SYMBOL_CRC
(
cfg80211_tx_mgmt_expúed
, 0xe9effe6a, "");

304 
SYMBOL_CRC
(
cfg80211_√w_°a
, 0xab04f547, "");

305 
SYMBOL_CRC
(
cfg80211_dñ_°a_söfo
, 0x0ebbda7e, "");

306 
SYMBOL_CRC
(
cfg80211_c⁄n_Áûed
, 0xed23d8e1, "");

307 
SYMBOL_CRC
(
cfg80211_rx_•urious_‰ame
, 0xa875fcd3, "");

308 
SYMBOL_CRC
(
cfg80211_rx_u√x≥˘ed_4addr_‰ame
, 0x200e7ff0, "");

309 
SYMBOL_CRC
(
cfg80211_c⁄åﬁ_p‹t_tx_°©us
, 0x5080d9ce, "");

310 
SYMBOL_CRC
(
cfg80211_mgmt_tx_°©us_ext
, 0xf031e9cf, "");

311 
SYMBOL_CRC
(
cfg80211_rx_c⁄åﬁ_p‹t
, 0x0de559c1, "");

312 
SYMBOL_CRC
(
cfg80211_cqm_rssi_nŸify
, 0x9592386b, "");

313 
SYMBOL_CRC
(
cfg80211_cqm_txe_nŸify
, 0xca5c1213, "");

314 
SYMBOL_CRC
(
cfg80211_cqm_pkéoss_nŸify
, 0x8fea829d, "");

315 
SYMBOL_CRC
(
cfg80211_cqm_bóc⁄_loss_nŸify
, 0x3257ba1d, "");

316 
SYMBOL_CRC
(
cfg80211_gtk_ªkey_nŸify
, 0xb35abee5, "");

317 
SYMBOL_CRC
(
cfg80211_pmkß_ˇndid©e_nŸify
, 0x732c9196, "");

318 
SYMBOL_CRC
(
cfg80211_ch_swôch_nŸify
, 0xbbe3a236, "");

319 
SYMBOL_CRC
(
cfg80211_ch_swôch_°¨ãd_nŸify
, 0x6947337a, "");

320 
SYMBOL_CRC
(
cfg80211_bss_cﬁ‹_nŸify
, 0xf9f9cb01, "");

321 
SYMBOL_CRC
(
cfg80211_°a_›mode_ch™ge_nŸify
, 0x64d0c64a, "");

322 
SYMBOL_CRC
(
cfg80211_¥obe_°©us
, 0x986d7118, "");

323 
SYMBOL_CRC
(
cfg80211_ªp‹t_obss_bóc⁄_khz
, 0xd8f2726c, "");

324 
SYMBOL_CRC
(
cfg80211_ªp‹t_wowœn_wakeup
, 0x428cff0d, "");

325 
SYMBOL_CRC
(
cfg80211_tdls_›î_ªque°
, 0x4313407a, "");

326 
SYMBOL_CRC
(
cfg80211_·_evít
, 0x0f46b32e, "");

327 
SYMBOL_CRC
(
cfg80211_¸ô_¥Ÿo_°›≥d
, 0x243ed476, "");

328 
SYMBOL_CRC
(
cfg80211_exã∫Æ_auth_ªque°
, 0x9dd3ae34, "");

329 
SYMBOL_CRC
(
cfg80211_upd©e_owe_öfo_evít
, 0x466a7478, "");

330 
SYMBOL_CRC
(
cfg80211_scheduÀ_ch™√ls_check
, 0x657c7c5d, "");

331 
SYMBOL_CRC
(
cfg80211_rx_assoc_ª•
, 0x95bb63c1, "");

332 
SYMBOL_CRC
(
cfg80211_rx_mlme_mgmt
, 0x096b419d, "");

333 
SYMBOL_CRC
(
cfg80211_auth_timeout
, 0xa4aebb42, "");

334 
SYMBOL_CRC
(
cfg80211_assoc_Áûuª
, 0x16a97494, "");

335 
SYMBOL_CRC
(
cfg80211_tx_mlme_mgmt
, 0x41eaa027, "");

336 
SYMBOL_CRC
(
cfg80211_mich´l_mic_Áûuª
, 0xff4729c0, "");

337 
SYMBOL_CRC
(
cfg80211_rx_mgmt_ext
, 0x7fba6c96, "");

338 
SYMBOL_CRC
(
__cfg80211_ød¨_evít
, 0xe6f4127e, "");

339 
SYMBOL_CRC
(
cfg80211_ˇc_evít
, 0xa2cd24f4, "");

340 
SYMBOL_CRC
(
cfg80211_background_ˇc_ab‹t
, 0xcd713a40, "");

341 
SYMBOL_CRC
(
cfg80211_ibss_joöed
, 0xc4a67f9b, "");

342 
SYMBOL_CRC
(
cfg80211_c⁄√˘_d⁄e
, 0x944c4635, "");

343 
SYMBOL_CRC
(
cfg80211_rﬂmed
, 0x5cda3dd7, "");

344 
SYMBOL_CRC
(
cfg80211_p‹t_auth‹ized
, 0x08de502a, "");

345 
SYMBOL_CRC
(
cfg80211_disc⁄√˘ed
, 0x0240fa5d, "");

346 
SYMBOL_CRC
(
cfg80211_ch™def_¸óã
, 0x23026b4b, "");

347 
SYMBOL_CRC
(
∆80211_ch™_width_to_mhz
, 0x2c19c3c0, "");

348 
SYMBOL_CRC
(
cfg80211_ch™def_vÆid
, 0x538f32f2, "");

349 
SYMBOL_CRC
(
cfg80211_ch™def_¥im¨y
, 0x9ce5d166, "");

350 
SYMBOL_CRC
(
cfg80211_ch™def_com∑tibÀ
, 0xf7be8ee8, "");

351 
SYMBOL_CRC
(
cfg80211_ch™def_dfs_ªquúed
, 0x3516647c, "");

352 
SYMBOL_CRC
(
cfg80211_ch™def_dfs_ußbÀ
, 0x5b18bf24, "");

353 
SYMBOL_CRC
(
cfg80211_ch™def_dfs_ˇc_time
, 0xec241d15, "");

354 
SYMBOL_CRC
(
cfg80211_ch™def_ußbÀ
, 0xadd14c44, "");

355 
SYMBOL_CRC
(
cfg80211_ªg_ˇn_bóc⁄
, 0x14eaba6a, "");

356 
SYMBOL_CRC
(
cfg80211_ªg_ˇn_bóc⁄_ªœx
, 0x68787486, "");

357 
SYMBOL_CRC
(
cfg80211_™y_ußbÀ_ch™√ls
, 0x0753c8b9, "");

358 
SYMBOL_CRC
(
wdev_ch™def
, 0x57e2830a, "");

359 
SYMBOL_CRC
(
cfg80211_gë_drvöfo
, 0x354dc970, "");

360 
SYMBOL_CRC
(
cfg80211_pm§_com∂ëe
, 0x8d609178, "_gpl");

361 
SYMBOL_CRC
(
cfg80211_pm§_ªp‹t
, 0x9c78c545, "_gpl");

362 
SYMBOL_CRC
(
wùhy_locked_debugfs_ªad
, 0xeac845cd, "_gpl");

363 
SYMBOL_CRC
(
wùhy_locked_debugfs_wrôe
, 0xbe09fc11, "_gpl");

364 
SYMBOL_CRC
(
cfg80211_wext_giw«me
, 0x429929d6, "_gpl");

365 
SYMBOL_CRC
(
cfg80211_wext_siwmode
, 0xfff594d0, "_gpl");

366 
SYMBOL_CRC
(
cfg80211_wext_giwmode
, 0xf28c11b2, "_gpl");

367 
SYMBOL_CRC
(
cfg80211_wext_giwønge
, 0x593d2c8a, "_gpl");

368 
SYMBOL_CRC
(
cfg80211_wext_siwπs
, 0x8cb6de25, "_gpl");

369 
SYMBOL_CRC
(
cfg80211_wext_giwπs
, 0x985982af, "_gpl");

370 
SYMBOL_CRC
(
cfg80211_wext_siw‰ag
, 0x6c745e55, "_gpl");

371 
SYMBOL_CRC
(
cfg80211_wext_giw‰ag
, 0x610ddb37, "_gpl");

372 
SYMBOL_CRC
(
cfg80211_wext_giwªåy
, 0x2bab5317, "_gpl");

374 c⁄° 
modvîsi⁄_öfo
 
	g____vîsi⁄s
[]

375 
__u£d
 
__£˘i⁄
("__versions") = {

600 
MODULE_INFO
(
dïíds
, "");

603 
MODULE_INFO
(
§cvîsi⁄
, "6CD64C6B6350B0253921C30");

	@chan.c

12 
	~<löux/exp‹t.h
>

13 
	~<löux/bôfõld.h
>

14 
	~<√t/cfg80211.h
>

15 
	~"c‹e.h
"

16 
	~"rdev-›s.h
"

18 
boﬁ
 
	$cfg80211_vÆid_60g_‰eq
(
u32
 
‰eq
)

20  
‰eq
 >= 58320 && freq <= 70200;

21 
	}
}

23 
	$cfg80211_ch™def_¸óã
(
cfg80211_ch™_def
 *
ch™def
,

24 
õì80211_ch™√l
 *
ch™
,

25 
∆80211_ch™√l_ty≥
 
ch™_ty≥
)

27 i‡(
	`WARN_ON
(!
ch™
))

30 *
ch™def
 = (
cfg80211_ch™_def
) {

31 .
ch™
 = chan,

32 .
‰eq1_off£t
 = 
ch™
->
‰eq_off£t
,

35 
ch™_ty≥
) {

36 
NL80211_CHAN_NO_HT
:

37 
ch™def
->
width
 = 
NL80211_CHAN_WIDTH_20_NOHT
;

38 
ch™def
->
˚¡î_‰eq1
 = 
ch™
->
˚¡î_‰eq
;

40 
NL80211_CHAN_HT20
:

41 
ch™def
->
width
 = 
NL80211_CHAN_WIDTH_20
;

42 
ch™def
->
˚¡î_‰eq1
 = 
ch™
->
˚¡î_‰eq
;

44 
NL80211_CHAN_HT40PLUS
:

45 
ch™def
->
width
 = 
NL80211_CHAN_WIDTH_40
;

46 
ch™def
->
˚¡î_‰eq1
 = 
ch™
->
˚¡î_‰eq
 + 10;

48 
NL80211_CHAN_HT40MINUS
:

49 
ch™def
->
width
 = 
NL80211_CHAN_WIDTH_40
;

50 
ch™def
->
˚¡î_‰eq1
 = 
ch™
->
˚¡î_‰eq
 - 10;

53 
	`WARN_ON
(1);

55 
	}
}

56 
EXPORT_SYMBOL
(
cfg80211_ch™def_¸óã
);

58 
	scfg80211_≥r_bw_pun˘urög_vÆues
 {

59 
u8
 
	mÀn
;

60 c⁄° 
u16
 *
	mvÆid_vÆues
;

63 c⁄° 
u16
 
	gpun˘urög_vÆues_80mhz
[] = {

67 c⁄° 
u16
 
	gpun˘urög_vÆues_160mhz
[] = {

71 c⁄° 
u16
 
	gpun˘urög_vÆues_320mhz
[] = {

77 
	#CFG80211_PER_BW_VALID_PUNCTURING_VALUES
(
_bw
) \

79 .
Àn
 = 
	`ARRAY_SIZE
(
pun˘urög_vÆues_
 ## 
_bw
 ## 
mhz
), \

80 .
vÆid_vÆues
 = 
pun˘urög_vÆues_
 ## 
_bw
 ## 
mhz
 \

81 }

	)

83 c⁄° 
cfg80211_≥r_bw_pun˘urög_vÆues
 
	g≥r_bw_pun˘urög
[] = {

84 
CFG80211_PER_BW_VALID_PUNCTURING_VALUES
(80),

85 
CFG80211_PER_BW_VALID_PUNCTURING_VALUES
(160),

86 
CFG80211_PER_BW_VALID_PUNCTURING_VALUES
(320)

89 
boﬁ
 
	$vÆid_pun˘urög_bôm≠
(c⁄° 
cfg80211_ch™_def
 *
ch™def
)

91 
u32
 
idx
, 
i
, 
°¨t_‰eq
, 
¥im¨y_˚¡î
 = 
ch™def
->
ch™
->
˚¡î_‰eq
;

93 
ch™def
->
width
) {

94 
NL80211_CHAN_WIDTH_80
:

95 
idx
 = 0;

96 
°¨t_‰eq
 = 
ch™def
->
˚¡î_‰eq1
 - 40;

98 
NL80211_CHAN_WIDTH_160
:

99 
idx
 = 1;

100 
°¨t_‰eq
 = 
ch™def
->
˚¡î_‰eq1
 - 80;

102 
NL80211_CHAN_WIDTH_320
:

103 
idx
 = 2;

104 
°¨t_‰eq
 = 
ch™def
->
˚¡î_‰eq1
 - 160;

107  
ch™def
->
pun˘uªd
 == 0;

110 i‡(!
ch™def
->
pun˘uªd
)

111  
åue
;

114 i‡(
ch™def
->
pun˘uªd
 & (
u16
)
	`BIT
((
¥im¨y_˚¡î
 - 
°¨t_‰eq
) / 20))

115  
Ál£
;

117 
i
 = 0; i < 
≥r_bw_pun˘urög
[
idx
].
Àn
; i++) {

118 i‡(
≥r_bw_pun˘urög
[
idx
].
vÆid_vÆues
[
i
] =
ch™def
->
pun˘uªd
)

119  
åue
;

122  
Ál£
;

123 
	}
}

125 
boﬁ
 
	$cfg80211_edmg_ch™def_vÆid
(c⁄° 
cfg80211_ch™_def
 *
ch™def
)

127 
max_c⁄tiguous
 = 0;

128 
num_of_íabÀd
 = 0;

129 
c⁄tiguous
 = 0;

130 
i
;

132 i‡(!
ch™def
->
edmg
.
ch™√ls
 || !ch™def->edmg.
bw_c⁄fig
)

133  
Ál£
;

135 i‡(!
	`cfg80211_vÆid_60g_‰eq
(
ch™def
->
ch™
->
˚¡î_‰eq
))

136  
Ál£
;

138 
i
 = 0; i < 6; i++) {

139 i‡(
ch™def
->
edmg
.
ch™√ls
 & 
	`BIT
(
i
)) {

140 
c⁄tiguous
++;

141 
num_of_íabÀd
++;

143 
c⁄tiguous
 = 0;

146 
max_c⁄tiguous
 = 
	`max
(
c⁄tiguous
, max_contiguous);

152 
ch™def
->
edmg
.
bw_c⁄fig
) {

153 
IEEE80211_EDMG_BW_CONFIG_4
:

154 
IEEE80211_EDMG_BW_CONFIG_8
:

155 
IEEE80211_EDMG_BW_CONFIG_12
:

156 i‡(
max_c⁄tiguous
 < 1)

157  
Ál£
;

159 
IEEE80211_EDMG_BW_CONFIG_5
:

160 
IEEE80211_EDMG_BW_CONFIG_9
:

161 
IEEE80211_EDMG_BW_CONFIG_13
:

162 i‡(
max_c⁄tiguous
 < 2)

163  
Ál£
;

165 
IEEE80211_EDMG_BW_CONFIG_6
:

166 
IEEE80211_EDMG_BW_CONFIG_10
:

167 
IEEE80211_EDMG_BW_CONFIG_14
:

168 i‡(
max_c⁄tiguous
 < 3)

169  
Ál£
;

171 
IEEE80211_EDMG_BW_CONFIG_7
:

172 
IEEE80211_EDMG_BW_CONFIG_11
:

173 
IEEE80211_EDMG_BW_CONFIG_15
:

174 i‡(
max_c⁄tiguous
 < 4)

175  
Ál£
;

179  
Ál£
;

183 
ch™def
->
edmg
.
bw_c⁄fig
) {

184 
IEEE80211_EDMG_BW_CONFIG_4
:

185 
IEEE80211_EDMG_BW_CONFIG_5
:

186 
IEEE80211_EDMG_BW_CONFIG_6
:

187 
IEEE80211_EDMG_BW_CONFIG_7
:

189 
IEEE80211_EDMG_BW_CONFIG_8
:

190 
IEEE80211_EDMG_BW_CONFIG_9
:

191 
IEEE80211_EDMG_BW_CONFIG_10
:

192 
IEEE80211_EDMG_BW_CONFIG_11
:

193 i‡(
num_of_íabÀd
 < 2)

194  
Ál£
;

196 
IEEE80211_EDMG_BW_CONFIG_12
:

197 
IEEE80211_EDMG_BW_CONFIG_13
:

198 
IEEE80211_EDMG_BW_CONFIG_14
:

199 
IEEE80211_EDMG_BW_CONFIG_15
:

200 i‡(
num_of_íabÀd
 < 4 || 
max_c⁄tiguous
 < 2)

201  
Ál£
;

204  
Ál£
;

207  
åue
;

208 
	}
}

210 
	$∆80211_ch™_width_to_mhz
(
∆80211_ch™_width
 
ch™_width
)

212 
mhz
;

214 
ch™_width
) {

215 
NL80211_CHAN_WIDTH_1
:

216 
mhz
 = 1;

218 
NL80211_CHAN_WIDTH_2
:

219 
mhz
 = 2;

221 
NL80211_CHAN_WIDTH_4
:

222 
mhz
 = 4;

224 
NL80211_CHAN_WIDTH_8
:

225 
mhz
 = 8;

227 
NL80211_CHAN_WIDTH_16
:

228 
mhz
 = 16;

230 
NL80211_CHAN_WIDTH_5
:

231 
mhz
 = 5;

233 
NL80211_CHAN_WIDTH_10
:

234 
mhz
 = 10;

236 
NL80211_CHAN_WIDTH_20
:

237 
NL80211_CHAN_WIDTH_20_NOHT
:

238 
mhz
 = 20;

240 
NL80211_CHAN_WIDTH_40
:

241 
mhz
 = 40;

243 
NL80211_CHAN_WIDTH_80P80
:

244 
NL80211_CHAN_WIDTH_80
:

245 
mhz
 = 80;

247 
NL80211_CHAN_WIDTH_160
:

248 
mhz
 = 160;

250 
NL80211_CHAN_WIDTH_320
:

251 
mhz
 = 320;

254 
	`WARN_ON_ONCE
(1);

257  
mhz
;

258 
	}
}

259 
EXPORT_SYMBOL
(
∆80211_ch™_width_to_mhz
);

261 
	$cfg80211_ch™def_gë_width
(c⁄° 
cfg80211_ch™_def
 *
c
)

263  
	`∆80211_ch™_width_to_mhz
(
c
->
width
);

264 
	}
}

266 
boﬁ
 
	$cfg80211_ch™def_vÆid
(c⁄° 
cfg80211_ch™_def
 *
ch™def
)

268 
u32
 
c⁄åﬁ_‰eq
, 
›î_‰eq
;

269 
›î_width
, 
c⁄åﬁ_width
;

271 i‡(!
ch™def
->
ch™
)

272  
Ál£
;

274 i‡(
ch™def
->
‰eq1_off£t
 >= 1000)

275  
Ál£
;

277 
c⁄åﬁ_‰eq
 = 
ch™def
->
ch™
->
˚¡î_‰eq
;

279 
ch™def
->
width
) {

280 
NL80211_CHAN_WIDTH_5
:

281 
NL80211_CHAN_WIDTH_10
:

282 
NL80211_CHAN_WIDTH_20
:

283 
NL80211_CHAN_WIDTH_20_NOHT
:

284 i‡(
	`õì80211_ch™def_to_khz
(
ch™def
) !=

285 
	`õì80211_ch™√l_to_khz
(
ch™def
->
ch™
))

286  
Ál£
;

287 i‡(
ch™def
->
˚¡î_‰eq2
)

288  
Ál£
;

290 
NL80211_CHAN_WIDTH_1
:

291 
NL80211_CHAN_WIDTH_2
:

292 
NL80211_CHAN_WIDTH_4
:

293 
NL80211_CHAN_WIDTH_8
:

294 
NL80211_CHAN_WIDTH_16
:

295 i‡(
ch™def
->
ch™
->
b™d
 !
NL80211_BAND_S1GHZ
)

296  
Ál£
;

298 
c⁄åﬁ_‰eq
 = 
	`õì80211_ch™√l_to_khz
(
ch™def
->
ch™
);

299 
›î_‰eq
 = 
	`õì80211_ch™def_to_khz
(
ch™def
);

300 
c⁄åﬁ_width
 = 
	`∆80211_ch™_width_to_mhz
(

301 
	`õì80211_s1g_ch™√l_width
(

302 
ch™def
->
ch™
));

303 
›î_width
 = 
	`cfg80211_ch™def_gë_width
(
ch™def
);

305 i‡(
›î_width
 < 0 || 
c⁄åﬁ_width
 < 0)

306  
Ál£
;

307 i‡(
ch™def
->
˚¡î_‰eq2
)

308  
Ál£
;

310 i‡(
c⁄åﬁ_‰eq
 + 
	`MHZ_TO_KHZ
(
c⁄åﬁ_width
) / 2 >

311 
›î_‰eq
 + 
	`MHZ_TO_KHZ
(
›î_width
) / 2)

312  
Ál£
;

314 i‡(
c⁄åﬁ_‰eq
 - 
	`MHZ_TO_KHZ
(
c⁄åﬁ_width
) / 2 <

315 
›î_‰eq
 - 
	`MHZ_TO_KHZ
(
›î_width
) / 2)

316  
Ál£
;

318 
NL80211_CHAN_WIDTH_80P80
:

319 i‡(!
ch™def
->
˚¡î_‰eq2
)

320  
Ál£
;

322 i‡(
ch™def
->
˚¡î_‰eq1
 - ch™def->
˚¡î_‰eq2
 == 80 ||

323 
ch™def
->
˚¡î_‰eq2
 - ch™def->
˚¡î_‰eq1
 == 80)

324  
Ál£
;

327 i‡(
ch™def
->
˚¡î_‰eq2
)

328  
Ál£
;

332 
ch™def
->
width
) {

333 
NL80211_CHAN_WIDTH_5
:

334 
NL80211_CHAN_WIDTH_10
:

335 
NL80211_CHAN_WIDTH_20
:

336 
NL80211_CHAN_WIDTH_20_NOHT
:

337 
NL80211_CHAN_WIDTH_1
:

338 
NL80211_CHAN_WIDTH_2
:

339 
NL80211_CHAN_WIDTH_4
:

340 
NL80211_CHAN_WIDTH_8
:

341 
NL80211_CHAN_WIDTH_16
:

344 
NL80211_CHAN_WIDTH_320
:

345 i‡(
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 + 150 ||

346 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 + 130 ||

347 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 + 110 ||

348 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 + 90 ||

349 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 - 90 ||

350 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 - 110 ||

351 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 - 130 ||

352 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 - 150)

354 
ÁŒthrough
;

355 
NL80211_CHAN_WIDTH_160
:

356 i‡(
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 + 70 ||

357 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 + 50 ||

358 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 - 50 ||

359 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 - 70)

361 
ÁŒthrough
;

362 
NL80211_CHAN_WIDTH_80P80
:

363 
NL80211_CHAN_WIDTH_80
:

364 i‡(
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 + 30 ||

365 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 - 30)

367 
ÁŒthrough
;

368 
NL80211_CHAN_WIDTH_40
:

369 i‡(
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 + 10 ||

370 
ch™def
->
˚¡î_‰eq1
 =
c⁄åﬁ_‰eq
 - 10)

372 
ÁŒthrough
;

374  
Ál£
;

378 i‡(
ch™def
->
˚¡î_‰eq1
 == 2484 &&

379 
ch™def
->
width
 !
NL80211_CHAN_WIDTH_20_NOHT
)

380  
Ál£
;

382 i‡(
	`cfg80211_ch™def_is_edmg
(
ch™def
) &&

383 !
	`cfg80211_edmg_ch™def_vÆid
(
ch™def
))

384  
Ál£
;

386  
	`vÆid_pun˘urög_bôm≠
(
ch™def
);

387 
	}
}

388 
EXPORT_SYMBOL
(
cfg80211_ch™def_vÆid
);

390 
	$cfg80211_ch™def_¥im¨y
(c⁄° 
cfg80211_ch™_def
 *
c
,

391 
∆80211_ch™_width
 
¥im¨y_ch™_width
,

392 
u16
 *
pun˘uªd
)

394 
¥i_width
 = 
	`∆80211_ch™_width_to_mhz
(
¥im¨y_ch™_width
);

395 
width
 = 
	`cfg80211_ch™def_gë_width
(
c
);

396 
u32
 
c⁄åﬁ
 = 
c
->
ch™
->
˚¡î_‰eq
;

397 
u32
 
˚¡î
 = 
c
->
˚¡î_‰eq1
;

398 
u16
 
_pun˘
 = 0;

400 i‡(
	`WARN_ON_ONCE
(
¥i_width
 < 0 || 
width
 < 0))

404 i‡(
	`WARN_ON_ONCE
(
¥i_width
 > 
width
))

407 i‡(!
pun˘uªd
)

408 
pun˘uªd
 = &
_pun˘
;

410 *
pun˘uªd
 = 
c
->punctured;

412 
width
 > 
¥i_width
) {

413 
bôs_to_dr›
 = 
width
 / 20 / 2;

415 i‡(
c⁄åﬁ
 > 
˚¡î
) {

416 
˚¡î
 +
width
 / 4;

417 *
pun˘uªd
 >>
bôs_to_dr›
;

419 
˚¡î
 -
width
 / 4;

420 *
pun˘uªd
 &(1 << 
bôs_to_dr›
) - 1;

422 
width
 /= 2;

425  
˚¡î
;

426 
	}
}

427 
EXPORT_SYMBOL
(
cfg80211_ch™def_¥im¨y
);

429 c⁄° 
cfg80211_ch™_def
 *

430 
	$check_ch™def_¥im¨y_com∑t
(c⁄° 
cfg80211_ch™_def
 *
c1
,

431 c⁄° 
cfg80211_ch™_def
 *
c2
,

432 
∆80211_ch™_width
 
¥im¨y_ch™_width
)

434 
u16
 
pun˘_c1
 = 0, 
pun˘_c2
 = 0;

437 i‡(
	`cfg80211_ch™def_¥im¨y
(
c1
, 
¥im¨y_ch™_width
, &
pun˘_c1
) !=

438 
	`cfg80211_ch™def_¥im¨y
(
c2
, 
¥im¨y_ch™_width
, &
pun˘_c2
))

439  
	`ERR_PTR
(-
EINVAL
);

441 i‡(
pun˘_c1
 !
pun˘_c2
)

442  
	`ERR_PTR
(-
EINVAL
);

445 i‡(
c1
->
width
 =
¥im¨y_ch™_width
)

446  
c2
;

449  
NULL
;

450 
	}
}

452 c⁄° 
cfg80211_ch™_def
 *

453 
	$_cfg80211_ch™def_com∑tibÀ
(c⁄° 
cfg80211_ch™_def
 *
c1
,

454 c⁄° 
cfg80211_ch™_def
 *
c2
)

456 c⁄° 
cfg80211_ch™_def
 *
ªt
;

459 i‡(
	`cfg80211_ch™def_idítiˇl
(
c1
, 
c2
))

460  
c2
;

463 i‡(
c1
->
ch™
 !
c2
->chan)

464  
NULL
;

470 i‡(
c1
->
width
 =
c2
->width)

471  
NULL
;

477 
	#NARROW_OR_S1G
(
width
Ë((widthË=
NL80211_CHAN_WIDTH_5
 || \

478 (
width
Ë=
NL80211_CHAN_WIDTH_10
 || \

479 (
width
Ë=
NL80211_CHAN_WIDTH_1
 || \

480 (
width
Ë=
NL80211_CHAN_WIDTH_2
 || \

481 (
width
Ë=
NL80211_CHAN_WIDTH_4
 || \

482 (
width
Ë=
NL80211_CHAN_WIDTH_8
 || \

483 (
width
Ë=
NL80211_CHAN_WIDTH_16
)

	)

485 i‡(
	`NARROW_OR_S1G
(
c1
->
width
Ë|| NARROW_OR_S1G(
c2
->width))

486  
NULL
;

493 i‡(
c1
->
width
 > 
c2
->width)

494 
	`sw≠
(
c1
, 
c2
);

501 i‡(
c1
->
width
 <
NL80211_CHAN_WIDTH_20
)

502  
c2
;

504 
ªt
 = 
	`check_ch™def_¥im¨y_com∑t
(
c1
, 
c2
, 
NL80211_CHAN_WIDTH_40
);

505 i‡(
ªt
)

506  
ªt
;

508 
ªt
 = 
	`check_ch™def_¥im¨y_com∑t
(
c1
, 
c2
, 
NL80211_CHAN_WIDTH_80
);

509 i‡(
ªt
)

510  
ªt
;

517 i‡(
c1
->
width
 =
NL80211_CHAN_WIDTH_80P80
)

518  
NULL
;

520 
ªt
 = 
	`check_ch™def_¥im¨y_com∑t
(
c1
, 
c2
, 
NL80211_CHAN_WIDTH_160
);

521 i‡(
ªt
)

522  
ªt
;

529 
	`WARN_ON_ONCE
(1);

531  
NULL
;

532 
	}
}

534 c⁄° 
cfg80211_ch™_def
 *

535 
	$cfg80211_ch™def_com∑tibÀ
(c⁄° 
cfg80211_ch™_def
 *
c1
,

536 c⁄° 
cfg80211_ch™_def
 *
c2
)

538 c⁄° 
cfg80211_ch™_def
 *
ªt
;

540 
ªt
 = 
	`_cfg80211_ch™def_com∑tibÀ
(
c1
, 
c2
);

541 i‡(
	`IS_ERR
(
ªt
))

542  
NULL
;

543  
ªt
;

544 
	}
}

545 
EXPORT_SYMBOL
(
cfg80211_ch™def_com∑tibÀ
);

547 
	$cfg80211_£t_ch™s_dfs_°©e
(
wùhy
 *wùhy, 
u32
 
˚¡î_‰eq
,

548 
u32
 
b™dwidth
,

549 
∆80211_dfs_°©e
 
dfs_°©e
)

551 
õì80211_ch™√l
 *
c
;

552 
u32
 
‰eq
;

554 
‰eq
 = 
˚¡î_‰eq
 - 
b™dwidth
/2 + 10;

555 
‰eq
 <
˚¡î_‰eq
 + 
b™dwidth
/2 - 10;

556 
‰eq
 += 20) {

557 
c
 = 
	`õì80211_gë_ch™√l
(
wùhy
, 
‰eq
);

558 i‡(!
c
 || !(c->
Êags
 & 
IEEE80211_CHAN_RADAR
))

561 
c
->
dfs_°©e
 = dfs_state;

562 
c
->
dfs_°©e_íãªd
 = 
jiffõs
;

564 
	}
}

566 
	$cfg80211_£t_dfs_°©e
(
wùhy
 *wiphy,

567 c⁄° 
cfg80211_ch™_def
 *
ch™def
,

568 
∆80211_dfs_°©e
 
dfs_°©e
)

570 
width
;

572 i‡(
	`WARN_ON
(!
	`cfg80211_ch™def_vÆid
(
ch™def
)))

575 
width
 = 
	`cfg80211_ch™def_gë_width
(
ch™def
);

576 i‡(
width
 < 0)

579 
	`cfg80211_£t_ch™s_dfs_°©e
(
wùhy
, 
ch™def
->
˚¡î_‰eq1
,

580 
width
, 
dfs_°©e
);

582 i‡(!
ch™def
->
˚¡î_‰eq2
)

584 
	`cfg80211_£t_ch™s_dfs_°©e
(
wùhy
, 
ch™def
->
˚¡î_‰eq2
,

585 
width
, 
dfs_°©e
);

586 
	}
}

588 
u32
 
	$cfg80211_gë_°¨t_‰eq
(
u32
 
˚¡î_‰eq
,

589 
u32
 
b™dwidth
)

591 
u32
 
°¨t_‰eq
;

593 
b™dwidth
 = 
	`MHZ_TO_KHZ
(bandwidth);

594 i‡(
b™dwidth
 <
	`MHZ_TO_KHZ
(20))

595 
°¨t_‰eq
 = 
˚¡î_‰eq
;

597 
°¨t_‰eq
 = 
˚¡î_‰eq
 - 
b™dwidth
 / 2 + 
	`MHZ_TO_KHZ
(10);

599  
°¨t_‰eq
;

600 
	}
}

602 
u32
 
	$cfg80211_gë_íd_‰eq
(
u32
 
˚¡î_‰eq
,

603 
u32
 
b™dwidth
)

605 
u32
 
íd_‰eq
;

607 
b™dwidth
 = 
	`MHZ_TO_KHZ
(bandwidth);

608 i‡(
b™dwidth
 <
	`MHZ_TO_KHZ
(20))

609 
íd_‰eq
 = 
˚¡î_‰eq
;

611 
íd_‰eq
 = 
˚¡î_‰eq
 + 
b™dwidth
 / 2 - 
	`MHZ_TO_KHZ
(10);

613  
íd_‰eq
;

614 
	}
}

616 
boﬁ


617 
	$cfg80211_dfs_≥rmissive_check_wdev
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

618 
∆80211_i·y≥
 
i·y≥
,

619 
wúñess_dev
 *
wdev
,

620 
õì80211_ch™√l
 *
ch™
)

622 
lök_id
;

624 
	`f‹_óch_vÆid_lök
(
wdev
, 
lök_id
) {

625 
õì80211_ch™√l
 *
Ÿhî_ch™
 = 
NULL
;

626 
cfg80211_ch™_def
 
ch™def
 = {};

627 
ªt
;

630 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 ||

631 !
wdev
->
löks
[
lök_id
].
˛õ¡
.
cuºít_bss
)

634 
Ÿhî_ch™
 =

635 
wdev
->
löks
[
lök_id
].
˛õ¡
.
cuºít_bss
->
pub
.
ch™√l
;

637 i‡(!
Ÿhî_ch™
)

640 i‡(
ch™
 =
Ÿhî_ch™
)

641  
åue
;

644 
ªt
 = 
	`rdev_gë_ch™√l
(
rdev
, 
wdev
, 
lök_id
, &
ch™def
);

645 i‡(
ªt
)

648 i‡(
	`cfg80211_is_sub_ch™
(&
ch™def
, 
ch™
, 
Ál£
))

649  
åue
;

652  
Ál£
;

653 
	}
}

658 
boﬁ
 
	$cfg80211_dfs_≥rmissive_ch™
(
wùhy
 *wiphy,

659 
∆80211_i·y≥
 
i·y≥
,

660 
õì80211_ch™√l
 *
ch™
)

662 
wúñess_dev
 *
wdev
;

663 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

665 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

667 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

668 
NL80211_EXT_FEATURE_DFS_CONCURRENT
) ||

669 !(
ch™
->
Êags
 & 
IEEE80211_CHAN_DFS_CONCURRENT
))

670  
Ál£
;

673 i‡(
i·y≥
 !
NL80211_IFTYPE_P2P_GO
)

674  
Ál£
;

679 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

680 
boﬁ
 
ªt
 = 
	`cfg80211_dfs_≥rmissive_check_wdev
(
rdev
, 
i·y≥
,

681 
wdev
, 
ch™
);

682 i‡(
ªt
)

683  
ªt
;

686  
Ál£
;

687 
	}
}

689 
	$cfg80211_gë_ch™s_dfs_ªquúed
(
wùhy
 *wiphy,

690 
u32
 
˚¡î_‰eq
,

691 
u32
 
b™dwidth
,

692 
∆80211_i·y≥
 
i·y≥
)

694 
õì80211_ch™√l
 *
c
;

695 
u32
 
‰eq
, 
°¨t_‰eq
, 
íd_‰eq
;

697 
°¨t_‰eq
 = 
	`cfg80211_gë_°¨t_‰eq
(
˚¡î_‰eq
, 
b™dwidth
);

698 
íd_‰eq
 = 
	`cfg80211_gë_íd_‰eq
(
˚¡î_‰eq
, 
b™dwidth
);

700 
‰eq
 = 
°¨t_‰eq
; fªq <
íd_‰eq
; fªq +
	`MHZ_TO_KHZ
(20)) {

701 
c
 = 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
‰eq
);

702 i‡(!
c
)

703  -
EINVAL
;

705 i‡(
c
->
Êags
 & 
IEEE80211_CHAN_RADAR
 &&

706 !
	`cfg80211_dfs_≥rmissive_ch™
(
wùhy
, 
i·y≥
, 
c
))

711 
	}
}

714 
	$cfg80211_ch™def_dfs_ªquúed
(
wùhy
 *wiphy,

715 c⁄° 
cfg80211_ch™_def
 *
ch™def
,

716 
∆80211_i·y≥
 
i·y≥
)

718 
width
;

719 
ªt
;

721 i‡(
	`WARN_ON
(!
	`cfg80211_ch™def_vÆid
(
ch™def
)))

722  -
EINVAL
;

724 
i·y≥
) {

725 
NL80211_IFTYPE_ADHOC
:

726 
NL80211_IFTYPE_AP
:

727 
NL80211_IFTYPE_P2P_GO
:

728 
NL80211_IFTYPE_MESH_POINT
:

729 
width
 = 
	`cfg80211_ch™def_gë_width
(
ch™def
);

730 i‡(
width
 < 0)

731  -
EINVAL
;

733 
ªt
 = 
	`cfg80211_gë_ch™s_dfs_ªquúed
(
wùhy
,

734 
	`õì80211_ch™def_to_khz
(
ch™def
),

735 
width
, 
i·y≥
);

736 i‡(
ªt
 < 0)

737  
ªt
;

738 i‡(
ªt
 > 0)

739  
	`BIT
(
ch™def
->
width
);

741 i‡(!
ch™def
->
˚¡î_‰eq2
)

744 
ªt
 = 
	`cfg80211_gë_ch™s_dfs_ªquúed
(
wùhy
,

745 
	`MHZ_TO_KHZ
(
ch™def
->
˚¡î_‰eq2
),

746 
width
, 
i·y≥
);

747 i‡(
ªt
 < 0)

748  
ªt
;

749 i‡(
ªt
 > 0)

750  
	`BIT
(
ch™def
->
width
);

753 
NL80211_IFTYPE_STATION
:

754 
NL80211_IFTYPE_OCB
:

755 
NL80211_IFTYPE_P2P_CLIENT
:

756 
NL80211_IFTYPE_MONITOR
:

757 
NL80211_IFTYPE_AP_VLAN
:

758 
NL80211_IFTYPE_P2P_DEVICE
:

759 
NL80211_IFTYPE_NAN
:

761 
NL80211_IFTYPE_WDS
:

762 
NL80211_IFTYPE_UNSPECIFIED
:

763 
NUM_NL80211_IFTYPES
:

764 
	`WARN_ON
(1);

768 
	}
}

769 
EXPORT_SYMBOL
(
cfg80211_ch™def_dfs_ªquúed
);

771 
	$cfg80211_gë_ch™s_dfs_ußbÀ
(
wùhy
 *wiphy,

772 
u32
 
˚¡î_‰eq
,

773 
u32
 
b™dwidth
)

775 
õì80211_ch™√l
 *
c
;

776 
u32
 
‰eq
, 
°¨t_‰eq
, 
íd_‰eq
;

777 
cou¡
 = 0;

779 
°¨t_‰eq
 = 
	`cfg80211_gë_°¨t_‰eq
(
˚¡î_‰eq
, 
b™dwidth
);

780 
íd_‰eq
 = 
	`cfg80211_gë_íd_‰eq
(
˚¡î_‰eq
, 
b™dwidth
);

788 
‰eq
 = 
°¨t_‰eq
; fªq <
íd_‰eq
; fªq +
	`MHZ_TO_KHZ
(20)) {

789 
c
 = 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
‰eq
);

790 i‡(!
c
)

791  -
EINVAL
;

793 i‡(
c
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

794  -
EINVAL
;

796 i‡(
c
->
Êags
 & 
IEEE80211_CHAN_RADAR
) {

797 i‡(
c
->
dfs_°©e
 =
NL80211_DFS_UNAVAILABLE
)

798  -
EINVAL
;

800 i‡(
c
->
dfs_°©e
 =
NL80211_DFS_USABLE
)

801 
cou¡
++;

805  
cou¡
;

806 
	}
}

808 
boﬁ
 
	$cfg80211_ch™def_dfs_ußbÀ
(
wùhy
 *wiphy,

809 c⁄° 
cfg80211_ch™_def
 *
ch™def
)

811 
width
;

812 
r1
, 
r2
 = 0;

814 i‡(
	`WARN_ON
(!
	`cfg80211_ch™def_vÆid
(
ch™def
)))

815  
Ál£
;

817 
width
 = 
	`cfg80211_ch™def_gë_width
(
ch™def
);

818 i‡(
width
 < 0)

819  
Ál£
;

821 
r1
 = 
	`cfg80211_gë_ch™s_dfs_ußbÀ
(
wùhy
,

822 
	`MHZ_TO_KHZ
(
ch™def
->
˚¡î_‰eq1
),

823 
width
);

825 i‡(
r1
 < 0)

826  
Ál£
;

828 
ch™def
->
width
) {

829 
NL80211_CHAN_WIDTH_80P80
:

830 
	`WARN_ON
(!
ch™def
->
˚¡î_‰eq2
);

831 
r2
 = 
	`cfg80211_gë_ch™s_dfs_ußbÀ
(
wùhy
,

832 
	`MHZ_TO_KHZ
(
ch™def
->
˚¡î_‰eq2
),

833 
width
);

834 i‡(
r2
 < 0)

835  
Ál£
;

838 
	`WARN_ON
(
ch™def
->
˚¡î_‰eq2
);

842  (
r1
 + 
r2
 > 0);

843 
	}
}

844 
EXPORT_SYMBOL
(
cfg80211_ch™def_dfs_ußbÀ
);

850 
boﬁ
 
	$cfg80211_is_sub_ch™
(
cfg80211_ch™_def
 *
ch™def
,

851 
õì80211_ch™√l
 *
ch™
,

852 
boﬁ
 
¥im¨y_⁄ly
)

854 
width
;

855 
u32
 
‰eq
;

857 i‡(!
ch™def
->
ch™
)

858  
Ál£
;

860 i‡(
ch™def
->
ch™
->
˚¡î_‰eq
 == chan->center_freq)

861  
åue
;

863 i‡(
¥im¨y_⁄ly
)

864  
Ál£
;

866 
width
 = 
	`cfg80211_ch™def_gë_width
(
ch™def
);

867 i‡(
width
 <= 20)

868  
Ál£
;

870 
‰eq
 = 
ch™def
->
˚¡î_‰eq1
 - 
width
 / 2 + 10;

871 
‰eq
 <
ch™def
->
˚¡î_‰eq1
 + 
width
 / 2 - 10; freq += 20) {

872 i‡(
ch™
->
˚¡î_‰eq
 =
‰eq
)

873  
åue
;

876 i‡(!
ch™def
->
˚¡î_‰eq2
)

877  
Ál£
;

879 
‰eq
 = 
ch™def
->
˚¡î_‰eq2
 - 
width
 / 2 + 10;

880 
‰eq
 <
ch™def
->
˚¡î_‰eq2
 + 
width
 / 2 - 10; freq += 20) {

881 i‡(
ch™
->
˚¡î_‰eq
 =
‰eq
)

882  
åue
;

885  
Ál£
;

886 
	}
}

888 
boﬁ
 
	$cfg80211_bóc⁄ög_iÁ˚_a˘ive
(
wúñess_dev
 *
wdev
)

890 
lök
;

892 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

894 
wdev
->
i·y≥
) {

895 
NL80211_IFTYPE_AP
:

896 
NL80211_IFTYPE_P2P_GO
:

897 
	`f‹_óch_vÆid_lök
(
wdev
, 
lök
) {

898 i‡(
wdev
->
löks
[
lök
].
≠
.
bóc⁄_öãrvÆ
)

899  
åue
;

902 
NL80211_IFTYPE_ADHOC
:

903 i‡(
wdev
->
u
.
ibss
.
ssid_Àn
)

904  
åue
;

906 
NL80211_IFTYPE_MESH_POINT
:

907 i‡(
wdev
->
u
.
mesh
.
id_Àn
)

908  
åue
;

910 
NL80211_IFTYPE_STATION
:

911 
NL80211_IFTYPE_OCB
:

912 
NL80211_IFTYPE_P2P_CLIENT
:

913 
NL80211_IFTYPE_MONITOR
:

914 
NL80211_IFTYPE_AP_VLAN
:

915 
NL80211_IFTYPE_P2P_DEVICE
:

917 
NL80211_IFTYPE_NAN
:

919 
NL80211_IFTYPE_UNSPECIFIED
:

920 
NL80211_IFTYPE_WDS
:

921 
NUM_NL80211_IFTYPES
:

922 
	`WARN_ON
(1);

925  
Ál£
;

926 
	}
}

928 
boﬁ
 
	$cfg80211_wdev_⁄_sub_ch™
(
wúñess_dev
 *
wdev
,

929 
õì80211_ch™√l
 *
ch™
,

930 
boﬁ
 
¥im¨y_⁄ly
)

932 
lök
;

934 
wdev
->
i·y≥
) {

935 
NL80211_IFTYPE_AP
:

936 
NL80211_IFTYPE_P2P_GO
:

937 
	`f‹_óch_vÆid_lök
(
wdev
, 
lök
) {

938 i‡(
	`cfg80211_is_sub_ch™
(&
wdev
->
löks
[
lök
].
≠
.
ch™def
,

939 
ch™
, 
¥im¨y_⁄ly
))

940  
åue
;

943 
NL80211_IFTYPE_ADHOC
:

944  
	`cfg80211_is_sub_ch™
(&
wdev
->
u
.
ibss
.
ch™def
, 
ch™
,

945 
¥im¨y_⁄ly
);

946 
NL80211_IFTYPE_MESH_POINT
:

947  
	`cfg80211_is_sub_ch™
(&
wdev
->
u
.
mesh
.
ch™def
, 
ch™
,

948 
¥im¨y_⁄ly
);

953  
Ál£
;

954 
	}
}

956 
boﬁ
 
	$cfg80211_is_wùhy_›î_ch™
(
wùhy
 *wiphy,

957 
õì80211_ch™√l
 *
ch™
)

959 
wúñess_dev
 *
wdev
;

961 
	`lockdï_as£π_wùhy
(
wùhy
);

963 
	`li°_f‹_óch_íåy
(
wdev
, &
wùhy
->
wdev_li°
, 
li°
) {

964 i‡(!
	`cfg80211_bóc⁄ög_iÁ˚_a˘ive
(
wdev
))

967 i‡(
	`cfg80211_wdev_⁄_sub_ch™
(
wdev
, 
ch™
, 
Ál£
))

968  
åue
;

971  
Ál£
;

972 
	}
}

974 
boﬁ


975 
	$cfg80211_offch™_chaö_is_a˘ive
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

976 
õì80211_ch™√l
 *
ch™√l
)

978 i‡(!
rdev
->
background_ød¨_wdev
)

979  
Ál£
;

981 i‡(!
	`cfg80211_ch™def_vÆid
(&
rdev
->
background_ød¨_ch™def
))

982  
Ál£
;

984  
	`cfg80211_is_sub_ch™
(&
rdev
->
background_ød¨_ch™def
, 
ch™√l
,

985 
Ál£
);

986 
	}
}

988 
boﬁ
 
	$cfg80211_™y_wùhy_›î_ch™
(
wùhy
 *wiphy,

989 
õì80211_ch™√l
 *
ch™
)

991 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

993 
	`ASSERT_RTNL
();

995 i‡(!(
ch™
->
Êags
 & 
IEEE80211_CHAN_RADAR
))

996  
Ál£
;

998 
	`f‹_óch_rdev
(
rdev
) {

999 
boﬁ
 
found
;

1001 i‡(!
	`ªg_dfs_domaö_ßme
(
wùhy
, &
rdev
->wiphy))

1004 
	`wùhy_lock
(&
rdev
->
wùhy
);

1005 
found
 = 
	`cfg80211_is_wùhy_›î_ch™
(&
rdev
->
wùhy
, 
ch™
) ||

1006 
	`cfg80211_offch™_chaö_is_a˘ive
(
rdev
, 
ch™
);

1007 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1009 i‡(
found
)

1010  
åue
;

1013  
Ál£
;

1014 
	}
}

1016 
boﬁ
 
	$cfg80211_gë_ch™s_dfs_avaûabÀ
(
wùhy
 *wiphy,

1017 
u32
 
˚¡î_‰eq
,

1018 
u32
 
b™dwidth
)

1020 
õì80211_ch™√l
 *
c
;

1021 
u32
 
‰eq
, 
°¨t_‰eq
, 
íd_‰eq
;

1022 
boﬁ
 
dfs_ofÊﬂd
;

1024 
dfs_ofÊﬂd
 = 
	`wùhy_ext_„©uª_is£t
(
wùhy
,

1025 
NL80211_EXT_FEATURE_DFS_OFFLOAD
);

1027 
°¨t_‰eq
 = 
	`cfg80211_gë_°¨t_‰eq
(
˚¡î_‰eq
, 
b™dwidth
);

1028 
íd_‰eq
 = 
	`cfg80211_gë_íd_‰eq
(
˚¡î_‰eq
, 
b™dwidth
);

1035 
‰eq
 = 
°¨t_‰eq
; fªq <
íd_‰eq
; fªq +
	`MHZ_TO_KHZ
(20)) {

1036 
c
 = 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
‰eq
);

1037 i‡(!
c
)

1038  
Ál£
;

1040 i‡(
c
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

1041  
Ál£
;

1043 i‡((
c
->
Êags
 & 
IEEE80211_CHAN_RADAR
) &&

1044 (
c
->
dfs_°©e
 !
NL80211_DFS_AVAILABLE
) &&

1045 !(
c
->
dfs_°©e
 =
NL80211_DFS_USABLE
 && 
dfs_ofÊﬂd
))

1046  
Ál£
;

1049  
åue
;

1050 
	}
}

1052 
boﬁ
 
	$cfg80211_ch™def_dfs_avaûabÀ
(
wùhy
 *wiphy,

1053 c⁄° 
cfg80211_ch™_def
 *
ch™def
)

1055 
width
;

1056 
r
;

1058 i‡(
	`WARN_ON
(!
	`cfg80211_ch™def_vÆid
(
ch™def
)))

1059  
Ál£
;

1061 
width
 = 
	`cfg80211_ch™def_gë_width
(
ch™def
);

1062 i‡(
width
 < 0)

1063  
Ál£
;

1065 
r
 = 
	`cfg80211_gë_ch™s_dfs_avaûabÀ
(
wùhy
,

1066 
	`MHZ_TO_KHZ
(
ch™def
->
˚¡î_‰eq1
),

1067 
width
);

1070 i‡(!
r
)

1071  
r
;

1073 
ch™def
->
width
) {

1074 
NL80211_CHAN_WIDTH_80P80
:

1075 
	`WARN_ON
(!
ch™def
->
˚¡î_‰eq2
);

1076 
r
 = 
	`cfg80211_gë_ch™s_dfs_avaûabÀ
(
wùhy
,

1077 
	`MHZ_TO_KHZ
(
ch™def
->
˚¡î_‰eq2
),

1078 
width
);

1081 
	`WARN_ON
(
ch™def
->
˚¡î_‰eq2
);

1085  
r
;

1086 
	}
}

1088 
	$cfg80211_gë_ch™s_dfs_ˇc_time
(
wùhy
 *wiphy,

1089 
u32
 
˚¡î_‰eq
,

1090 
u32
 
b™dwidth
)

1092 
õì80211_ch™√l
 *
c
;

1093 
u32
 
°¨t_‰eq
, 
íd_‰eq
, 
‰eq
;

1094 
dfs_ˇc_ms
 = 0;

1096 
°¨t_‰eq
 = 
	`cfg80211_gë_°¨t_‰eq
(
˚¡î_‰eq
, 
b™dwidth
);

1097 
íd_‰eq
 = 
	`cfg80211_gë_íd_‰eq
(
˚¡î_‰eq
, 
b™dwidth
);

1099 
‰eq
 = 
°¨t_‰eq
; fªq <
íd_‰eq
; fªq +
	`MHZ_TO_KHZ
(20)) {

1100 
c
 = 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
‰eq
);

1101 i‡(!
c
)

1104 i‡(
c
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

1107 i‡(!(
c
->
Êags
 & 
IEEE80211_CHAN_RADAR
))

1110 i‡(
c
->
dfs_ˇc_ms
 > dfs_cac_ms)

1111 
dfs_ˇc_ms
 = 
c
->dfs_cac_ms;

1114  
dfs_ˇc_ms
;

1115 
	}
}

1118 
	$cfg80211_ch™def_dfs_ˇc_time
(
wùhy
 *wiphy,

1119 c⁄° 
cfg80211_ch™_def
 *
ch™def
)

1121 
width
;

1122 
t1
 = 0, 
t2
 = 0;

1124 i‡(
	`WARN_ON
(!
	`cfg80211_ch™def_vÆid
(
ch™def
)))

1127 
width
 = 
	`cfg80211_ch™def_gë_width
(
ch™def
);

1128 i‡(
width
 < 0)

1131 
t1
 = 
	`cfg80211_gë_ch™s_dfs_ˇc_time
(
wùhy
,

1132 
	`MHZ_TO_KHZ
(
ch™def
->
˚¡î_‰eq1
),

1133 
width
);

1135 i‡(!
ch™def
->
˚¡î_‰eq2
)

1136  
t1
;

1138 
t2
 = 
	`cfg80211_gë_ch™s_dfs_ˇc_time
(
wùhy
,

1139 
	`MHZ_TO_KHZ
(
ch™def
->
˚¡î_‰eq2
),

1140 
width
);

1142  
	`max
(
t1
, 
t2
);

1143 
	}
}

1144 
EXPORT_SYMBOL
(
cfg80211_ch™def_dfs_ˇc_time
);

1146 
boﬁ
 
	$cfg80211_£c⁄d¨y_ch™s_ok
(
wùhy
 *wiphy,

1147 
u32
 
˚¡î_‰eq
, u32 
b™dwidth
,

1148 
u32
 
¥ohibôed_Êags
, 
boﬁ
 
m⁄ô‹
)

1150 
õì80211_ch™√l
 *
c
;

1151 
u32
 
‰eq
, 
°¨t_‰eq
, 
íd_‰eq
;

1153 
°¨t_‰eq
 = 
	`cfg80211_gë_°¨t_‰eq
(
˚¡î_‰eq
, 
b™dwidth
);

1154 
íd_‰eq
 = 
	`cfg80211_gë_íd_‰eq
(
˚¡î_‰eq
, 
b™dwidth
);

1156 
‰eq
 = 
°¨t_‰eq
; fªq <
íd_‰eq
; fªq +
	`MHZ_TO_KHZ
(20)) {

1157 
c
 = 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
‰eq
);

1158 i‡(!
c
)

1159  
Ál£
;

1160 i‡(
m⁄ô‹
 && 
c
->
Êags
 & 
IEEE80211_CHAN_CAN_MONITOR
)

1162 i‡(
c
->
Êags
 & 
¥ohibôed_Êags
)

1163  
Ál£
;

1166  
åue
;

1167 
	}
}

1170 
boﬁ
 
	$cfg80211_edmg_ußbÀ
(
wùhy
 *wùhy, 
u8
 
edmg_ch™√ls
,

1171 
õì80211_edmg_bw_c⁄fig
 
edmg_bw_c⁄fig
,

1172 
¥im¨y_ch™√l
,

1173 
õì80211_edmg
 *
edmg_ˇp
)

1175 
õì80211_ch™√l
 *
ch™
;

1176 
i
, 
‰eq
;

1177 
ch™√ls_cou¡î
 = 0;

1179 i‡(!
edmg_ch™√ls
 && !
edmg_bw_c⁄fig
)

1180  
åue
;

1182 i‡((!
edmg_ch™√ls
 && 
edmg_bw_c⁄fig
) ||

1183 (
edmg_ch™√ls
 && !
edmg_bw_c⁄fig
))

1184  
Ál£
;

1186 i‡(!(
edmg_ch™√ls
 & 
	`BIT
(
¥im¨y_ch™√l
 - 1)))

1187  
Ál£
;

1190 
i
 = 0; i < 6; i++) {

1191 i‡(!(
edmg_ch™√ls
 & 
	`BIT
(
i
)))

1194 i‡(!(
edmg_ˇp
->
ch™√ls
 & 
	`BIT
(
i
)))

1195  
Ál£
;

1197 
ch™√ls_cou¡î
++;

1199 
‰eq
 = 
	`õì80211_ch™√l_to_‰equícy
(
i
 + 1,

1200 
NL80211_BAND_60GHZ
);

1201 
ch™
 = 
	`õì80211_gë_ch™√l
(
wùhy
, 
‰eq
);

1202 i‡(!
ch™
 || ch™->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

1203  
Ál£
;

1207 i‡(
ch™√ls_cou¡î
 > 4)

1208  
Ál£
;

1213 i‡((
edmg_bw_c⁄fig
 % 4Ë> (
edmg_ˇp
->
bw_c⁄fig
 % 4))

1214  
Ál£
;

1216 i‡(
edmg_bw_c⁄fig
 > 
edmg_ˇp
->
bw_c⁄fig
)

1217  
Ál£
;

1219  
åue
;

1220 
	}
}

1222 
boﬁ
 
	$_cfg80211_ch™def_ußbÀ
(
wùhy
 *wiphy,

1223 c⁄° 
cfg80211_ch™_def
 *
ch™def
,

1224 
u32
 
¥ohibôed_Êags
, 
boﬁ
 
m⁄ô‹
)

1226 
õì80211_°a_ht_ˇp
 *
ht_ˇp
;

1227 
õì80211_°a_vht_ˇp
 *
vht_ˇp
;

1228 
õì80211_edmg
 *
edmg_ˇp
;

1229 
u32
 
width
, 
c⁄åﬁ_‰eq
, 
ˇp
;

1230 
boﬁ
 
ext_nss_ˇp
, 
suµ‹t_80_80
 = 
Ál£
, 
suµ‹t_320
 = false;

1231 c⁄° 
õì80211_sb™d_i·y≥_d©a
 *
i·d
;

1232 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

1233 
i
;

1235 i‡(
	`WARN_ON
(!
	`cfg80211_ch™def_vÆid
(
ch™def
)))

1236  
Ál£
;

1238 
ht_ˇp
 = &
wùhy
->
b™ds
[
ch™def
->
ch™
->
b™d
]->ht_cap;

1239 
vht_ˇp
 = &
wùhy
->
b™ds
[
ch™def
->
ch™
->
b™d
]->vht_cap;

1240 
edmg_ˇp
 = &
wùhy
->
b™ds
[
ch™def
->
ch™
->
b™d
]->edmg_cap;

1241 
ext_nss_ˇp
 = 
	`__À16_to_˝u
(
vht_ˇp
->
vht_mcs
.
tx_highe°
) &

1242 
IEEE80211_VHT_EXT_NSS_BW_CAPABLE
;

1244 i‡(
edmg_ˇp
->
ch™√ls
 &&

1245 !
	`cfg80211_edmg_ußbÀ
(
wùhy
,

1246 
ch™def
->
edmg
.
ch™√ls
,

1247 
ch™def
->
edmg
.
bw_c⁄fig
,

1248 
ch™def
->
ch™
->
hw_vÆue
,

1249 
edmg_ˇp
))

1250  
Ál£
;

1252 
c⁄åﬁ_‰eq
 = 
ch™def
->
ch™
->
˚¡î_‰eq
;

1254 
ch™def
->
width
) {

1255 
NL80211_CHAN_WIDTH_1
:

1256 
width
 = 1;

1258 
NL80211_CHAN_WIDTH_2
:

1259 
width
 = 2;

1261 
NL80211_CHAN_WIDTH_4
:

1262 
width
 = 4;

1264 
NL80211_CHAN_WIDTH_8
:

1265 
width
 = 8;

1267 
NL80211_CHAN_WIDTH_16
:

1268 
width
 = 16;

1270 
NL80211_CHAN_WIDTH_5
:

1271 
width
 = 5;

1273 
NL80211_CHAN_WIDTH_10
:

1274 
¥ohibôed_Êags
 |
IEEE80211_CHAN_NO_10MHZ
;

1275 
width
 = 10;

1277 
NL80211_CHAN_WIDTH_20
:

1278 i‡(!
ht_ˇp
->
ht_suµ‹ãd
 &&

1279 
ch™def
->
ch™
->
b™d
 !
NL80211_BAND_6GHZ
)

1280  
Ál£
;

1281 
ÁŒthrough
;

1282 
NL80211_CHAN_WIDTH_20_NOHT
:

1283 
¥ohibôed_Êags
 |
IEEE80211_CHAN_NO_20MHZ
;

1284 
width
 = 20;

1286 
NL80211_CHAN_WIDTH_40
:

1287 
width
 = 40;

1288 i‡(
ch™def
->
ch™
->
b™d
 =
NL80211_BAND_6GHZ
)

1290 i‡(!
ht_ˇp
->
ht_suµ‹ãd
)

1291  
Ál£
;

1292 i‡(!(
ht_ˇp
->
ˇp
 & 
IEEE80211_HT_CAP_SUP_WIDTH_20_40
) ||

1293 
ht_ˇp
->
ˇp
 & 
IEEE80211_HT_CAP_40MHZ_INTOLERANT
)

1294  
Ál£
;

1295 i‡(
ch™def
->
˚¡î_‰eq1
 < 
c⁄åﬁ_‰eq
 &&

1296 
ch™def
->
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_HT40MINUS
)

1297  
Ál£
;

1298 i‡(
ch™def
->
˚¡î_‰eq1
 > 
c⁄åﬁ_‰eq
 &&

1299 
ch™def
->
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_HT40PLUS
)

1300  
Ál£
;

1302 
NL80211_CHAN_WIDTH_80P80
:

1303 
ˇp
 = 
vht_ˇp
->cap;

1304 
suµ‹t_80_80
 =

1305 (
ˇp
 & 
IEEE80211_VHT_CAP_SUPP_CHAN_WIDTH_160_80PLUS80MHZ
) ||

1306 (
ˇp
 & 
IEEE80211_VHT_CAP_SUPP_CHAN_WIDTH_160MHZ
 &&

1307 
ˇp
 & 
IEEE80211_VHT_CAP_EXT_NSS_BW_MASK
) ||

1308 (
ext_nss_ˇp
 &&

1309 
	`u32_gë_bôs
(
ˇp
, 
IEEE80211_VHT_CAP_EXT_NSS_BW_MASK
) > 1);

1310 i‡(
ch™def
->
ch™
->
b™d
 !
NL80211_BAND_6GHZ
 && !
suµ‹t_80_80
)

1311  
Ál£
;

1312 
ÁŒthrough
;

1313 
NL80211_CHAN_WIDTH_80
:

1314 
¥ohibôed_Êags
 |
IEEE80211_CHAN_NO_80MHZ
;

1315 
width
 = 80;

1316 i‡(
ch™def
->
ch™
->
b™d
 =
NL80211_BAND_6GHZ
)

1318 i‡(!
vht_ˇp
->
vht_suµ‹ãd
)

1319  
Ál£
;

1321 
NL80211_CHAN_WIDTH_160
:

1322 
¥ohibôed_Êags
 |
IEEE80211_CHAN_NO_160MHZ
;

1323 
width
 = 160;

1324 i‡(
ch™def
->
ch™
->
b™d
 =
NL80211_BAND_6GHZ
)

1326 i‡(!
vht_ˇp
->
vht_suµ‹ãd
)

1327  
Ál£
;

1328 
ˇp
 = 
vht_ˇp
->ˇ∞& 
IEEE80211_VHT_CAP_SUPP_CHAN_WIDTH_MASK
;

1329 i‡(
ˇp
 !
IEEE80211_VHT_CAP_SUPP_CHAN_WIDTH_160MHZ
 &&

1330 
ˇp
 !
IEEE80211_VHT_CAP_SUPP_CHAN_WIDTH_160_80PLUS80MHZ
 &&

1331 !(
ext_nss_ˇp
 &&

1332 (
vht_ˇp
->
ˇp
 & 
IEEE80211_VHT_CAP_EXT_NSS_BW_MASK
)))

1333  
Ál£
;

1335 
NL80211_CHAN_WIDTH_320
:

1336 
¥ohibôed_Êags
 |
IEEE80211_CHAN_NO_320MHZ
;

1337 
width
 = 320;

1339 i‡(
ch™def
->
ch™
->
b™d
 !
NL80211_BAND_6GHZ
)

1340  
Ál£
;

1342 
sb™d
 = 
wùhy
->
b™ds
[
NL80211_BAND_6GHZ
];

1343 i‡(!
sb™d
)

1344  
Ál£
;

1346 
	`f‹_óch_sb™d_i·y≥_d©a
(
sb™d
, 
i
, 
i·d
) {

1347 i‡(!
i·d
->
eht_ˇp
.
has_eht
)

1350 i‡(
i·d
->
eht_ˇp
.
eht_ˇp_ñem
.
phy_ˇp_öfo
[0] &

1351 
IEEE80211_EHT_PHY_CAP0_320MHZ_IN_6GHZ
) {

1352 
suµ‹t_320
 = 
åue
;

1357 i‡(!
suµ‹t_320
)

1358  
Ál£
;

1361 
	`WARN_ON_ONCE
(1);

1362  
Ál£
;

1376 i‡(
width
 > 20)

1377 
¥ohibôed_Êags
 |
IEEE80211_CHAN_NO_OFDM
;

1380 i‡(
width
 < 20)

1381 
¥ohibôed_Êags
 |
IEEE80211_CHAN_NO_OFDM
;

1384 i‡(!
	`cfg80211_£c⁄d¨y_ch™s_ok
(
wùhy
,

1385 
	`õì80211_ch™def_to_khz
(
ch™def
),

1386 
width
, 
¥ohibôed_Êags
, 
m⁄ô‹
))

1387  
Ál£
;

1389 i‡(!
ch™def
->
˚¡î_‰eq2
)

1390  
åue
;

1391  
	`cfg80211_£c⁄d¨y_ch™s_ok
(
wùhy
,

1392 
	`MHZ_TO_KHZ
(
ch™def
->
˚¡î_‰eq2
),

1393 
width
, 
¥ohibôed_Êags
, 
m⁄ô‹
);

1394 
	}
}

1396 
boﬁ
 
	$cfg80211_ch™def_ußbÀ
(
wùhy
 *wiphy,

1397 c⁄° 
cfg80211_ch™_def
 *
ch™def
,

1398 
u32
 
¥ohibôed_Êags
)

1400  
	`_cfg80211_ch™def_ußbÀ
(
wùhy
, 
ch™def
, 
¥ohibôed_Êags
,

1401 
Ál£
);

1402 
	}
}

1403 
EXPORT_SYMBOL
(
cfg80211_ch™def_ußbÀ
);

1405 
boﬁ
 
	$cfg80211_ú_≥rmissive_check_wdev
(
∆80211_i·y≥
 
i·y≥
,

1406 
wúñess_dev
 *
wdev
,

1407 
õì80211_ch™√l
 *
ch™
)

1409 
õì80211_ch™√l
 *
Ÿhî_ch™
 = 
NULL
;

1410 
lök_id
;

1411 
r1
, 
r2
;

1413 
	`f‹_óch_vÆid_lök
(
wdev
, 
lök_id
) {

1414 i‡(
wdev
->
i·y≥
 =
NL80211_IFTYPE_STATION
 &&

1415 
wdev
->
löks
[
lök_id
].
˛õ¡
.
cuºít_bss
)

1416 
Ÿhî_ch™
 = 
wdev
->
löks
[
lök_id
].
˛õ¡
.
cuºít_bss
->
pub
.
ch™√l
;

1425 i‡(
i·y≥
 =
NL80211_IFTYPE_P2P_GO
 &&

1426 
wdev
->
i·y≥
 =
NL80211_IFTYPE_P2P_GO
 &&

1427 
wdev
->
löks
[
lök_id
].
≠
.
bóc⁄_öãrvÆ
 &&

1428 !(
ch™
->
Êags
 & 
IEEE80211_CHAN_INDOOR_ONLY
))

1429 
Ÿhî_ch™
 = 
wdev
->
löks
[
lök_id
].
≠
.
ch™def
.
ch™
;

1431 i‡(!
Ÿhî_ch™
)

1434 i‡(
ch™
 =
Ÿhî_ch™
)

1435  
åue
;

1437 i‡(
ch™
->
b™d
 !
NL80211_BAND_5GHZ
 &&

1438 
ch™
->
b™d
 !
NL80211_BAND_6GHZ
)

1441 
r1
 = 
	`cfg80211_gë_unii
(
ch™
->
˚¡î_‰eq
);

1442 
r2
 = 
	`cfg80211_gë_unii
(
Ÿhî_ch™
->
˚¡î_‰eq
);

1444 i‡(
r1
 !-
EINVAL
 &&Ñ1 =
r2
) {

1457 i‡(
ch™
->
˚¡î_‰eq
 == 5825 &&

1458 
Ÿhî_ch™
->
˚¡î_‰eq
 != 5825)

1460  
åue
;

1464  
Ál£
;

1465 
	}
}

1476 
boﬁ
 
	$cfg80211_ú_≥rmissive_ch™
(
wùhy
 *wiphy,

1477 
∆80211_i·y≥
 
i·y≥
,

1478 
õì80211_ch™√l
 *
ch™
)

1480 
wúñess_dev
 *
wdev
;

1481 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1483 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1485 i‡(!
	`IS_ENABLED
(
CONFIG_CFG80211_REG_RELAX_NO_IR
) ||

1486 !(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_ENABLE_RELAX_NO_IR
))

1487  
Ál£
;

1490 i‡(
i·y≥
 !
NL80211_IFTYPE_P2P_GO
 &&

1491 
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

1492 
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
)

1493  
Ál£
;

1495 i‡(
	`ªguœt‹y_ödo‹_Ælowed
() &&

1496 (
ch™
->
Êags
 & 
IEEE80211_CHAN_INDOOR_ONLY
))

1497  
åue
;

1499 i‡(!(
ch™
->
Êags
 & 
IEEE80211_CHAN_IR_CONCURRENT
))

1500  
Ál£
;

1509 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

1510 
boﬁ
 
ªt
;

1512 
ªt
 = 
	`cfg80211_ú_≥rmissive_check_wdev
(
i·y≥
, 
wdev
, 
ch™
);

1513 i‡(
ªt
)

1514  
ªt
;

1517  
Ál£
;

1518 
	}
}

1520 
boﬁ
 
	$_cfg80211_ªg_ˇn_bóc⁄
(
wùhy
 *wiphy,

1521 
cfg80211_ch™_def
 *
ch™def
,

1522 
∆80211_i·y≥
 
i·y≥
,

1523 
boﬁ
 
check_no_ú
)

1525 
boﬁ
 
ªs
;

1526 
u32
 
¥ohibôed_Êags
 = 
IEEE80211_CHAN_DISABLED
;

1527 
dfs_ªquúed
;

1529 
	`åa˚_cfg80211_ªg_ˇn_bóc⁄
(
wùhy
, 
ch™def
, 
i·y≥
, 
check_no_ú
);

1531 i‡(
check_no_ú
)

1532 
¥ohibôed_Êags
 |
IEEE80211_CHAN_NO_IR
;

1534 
dfs_ªquúed
 = 
	`cfg80211_ch™def_dfs_ªquúed
(
wùhy
, 
ch™def
, 
i·y≥
);

1535 i‡(
dfs_ªquúed
 != 0)

1536 
¥ohibôed_Êags
 |
IEEE80211_CHAN_RADAR
;

1538 i‡(
dfs_ªquúed
 > 0 &&

1539 
	`cfg80211_ch™def_dfs_avaûabÀ
(
wùhy
, 
ch™def
)) {

1541 
¥ohibôed_Êags
 = 
IEEE80211_CHAN_DISABLED
;

1544 
ªs
 = 
	`cfg80211_ch™def_ußbÀ
(
wùhy
, 
ch™def
, 
¥ohibôed_Êags
);

1546 
	`åa˚_cfg80211_ªtu∫_boﬁ
(
ªs
);

1547  
ªs
;

1548 
	}
}

1550 
boﬁ
 
	$cfg80211_ªg_ˇn_bóc⁄
(
wùhy
 *wiphy,

1551 
cfg80211_ch™_def
 *
ch™def
,

1552 
∆80211_i·y≥
 
i·y≥
)

1554  
	`_cfg80211_ªg_ˇn_bóc⁄
(
wùhy
, 
ch™def
, 
i·y≥
, 
åue
);

1555 
	}
}

1556 
EXPORT_SYMBOL
(
cfg80211_ªg_ˇn_bóc⁄
);

1558 
boﬁ
 
	$cfg80211_ªg_ˇn_bóc⁄_ªœx
(
wùhy
 *wiphy,

1559 
cfg80211_ch™_def
 *
ch™def
,

1560 
∆80211_i·y≥
 
i·y≥
)

1562 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1563 
boﬁ
 
check_no_ú
;

1565 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1573 
check_no_ú
 = !
	`cfg80211_ú_≥rmissive_ch™
(
wùhy
, 
i·y≥
,

1574 
ch™def
->
ch™
);

1576  
	`_cfg80211_ªg_ˇn_bóc⁄
(
wùhy
, 
ch™def
, 
i·y≥
, 
check_no_ú
);

1577 
	}
}

1578 
EXPORT_SYMBOL
(
cfg80211_ªg_ˇn_bóc⁄_ªœx
);

1580 
	$cfg80211_£t_m⁄ô‹_ch™√l
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1581 
cfg80211_ch™_def
 *
ch™def
)

1583 i‡(!
rdev
->
›s
->
£t_m⁄ô‹_ch™√l
)

1584  -
EOPNOTSUPP
;

1585 i‡(!
	`cfg80211_has_m⁄ô‹s_⁄ly
(
rdev
))

1586  -
EBUSY
;

1588  
	`rdev_£t_m⁄ô‹_ch™√l
(
rdev
, 
ch™def
);

1589 
	}
}

1591 
boﬁ
 
	$cfg80211_™y_ußbÀ_ch™√ls
(
wùhy
 *wiphy,

1592 
sb™d_mask
,

1593 
u32
 
¥ohibôed_Êags
)

1595 
idx
;

1597 
¥ohibôed_Êags
 |
IEEE80211_CHAN_DISABLED
;

1599 
	`f‹_óch_£t_bô
(
idx
, &
sb™d_mask
, 
NUM_NL80211_BANDS
) {

1600 
õì80211_suµ‹ãd_b™d
 *
sb™d
 = 
wùhy
->
b™ds
[
idx
];

1601 
ch™idx
;

1603 i‡(!
sb™d
)

1606 
ch™idx
 = 0; ch™idx < 
sb™d
->
n_ch™√ls
; chanidx++) {

1607 
õì80211_ch™√l
 *
ch™
;

1609 
ch™
 = &
sb™d
->
ch™√ls
[
ch™idx
];

1611 i‡(
ch™
->
Êags
 & 
¥ohibôed_Êags
)

1614  
åue
;

1618  
Ál£
;

1619 
	}
}

1620 
EXPORT_SYMBOL
(
cfg80211_™y_ußbÀ_ch™√ls
);

1622 
cfg80211_ch™_def
 *
	$wdev_ch™def
(
wúñess_dev
 *
wdev
,

1623 
lök_id
)

1625 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

1627 
	`WARN_ON
(
wdev
->
vÆid_löks
 && !(wdev->vÆid_lök†& 
	`BIT
(
lök_id
)));

1628 
	`WARN_ON
(!
wdev
->
vÆid_löks
 && 
lök_id
 > 0);

1630 
wdev
->
i·y≥
) {

1631 
NL80211_IFTYPE_MESH_POINT
:

1632  &
wdev
->
u
.
mesh
.
ch™def
;

1633 
NL80211_IFTYPE_ADHOC
:

1634  &
wdev
->
u
.
ibss
.
ch™def
;

1635 
NL80211_IFTYPE_OCB
:

1636  &
wdev
->
u
.
ocb
.
ch™def
;

1637 
NL80211_IFTYPE_AP
:

1638 
NL80211_IFTYPE_P2P_GO
:

1639  &
wdev
->
löks
[
lök_id
].
≠
.
ch™def
;

1641  
NULL
;

1643 
	}
}

1644 
EXPORT_SYMBOL
(
wdev_ch™def
);

	@core.c

11 
	#¥_fmt
(
fmt
Ë
KBUILD_MODNAME
 ": " 
	)
fmt

13 
	~<löux/if.h
>

14 
	~<löux/moduÀ.h
>

15 
	~<löux/îr.h
>

16 
	~<löux/li°.h
>

17 
	~<löux/¶ab.h
>

18 
	~<löux/∆80211.h
>

19 
	~<löux/debugfs.h
>

20 
	~<löux/nŸifõr.h
>

21 
	~<löux/devi˚.h
>

22 
	~<löux/ëhîdevi˚.h
>

23 
	~<löux/π√éök.h
>

24 
	~<löux/sched.h
>

25 
	~<√t/gíëlök.h
>

26 
	~<√t/cfg80211.h
>

27 
	~"∆80211.h
"

28 
	~"c‹e.h
"

29 
	~"sysfs.h
"

30 
	~"debugfs.h
"

31 
	~"wext-com∑t.h
"

32 
	~"rdev-›s.h
"

35 
	#PHY_NAME
 "phy"

	)

37 
MODULE_AUTHOR
("Johannes Berg");

38 
MODULE_LICENSE
("GPL");

39 
MODULE_DESCRIPTION
("wireless configuration support");

40 
MODULE_ALIAS_GENL_FAMILY
(
NL80211_GENL_NAME
);

43 
LIST_HEAD
(
cfg80211_rdev_li°
);

44 
	gcfg80211_rdev_li°_gíî©i⁄
;

47 
díåy
 *
	gõì80211_debugfs_dú
;

50 
w‹kqueue_°ru˘
 *
	gcfg80211_wq
;

52 
boﬁ
 
	gcfg80211_dißbÀ_40mhz_24ghz
;

53 
moduÀ_∑øm
(
cfg80211_dißbÀ_40mhz_24ghz
, 
boﬁ
, 0644);

54 
MODULE_PARM_DESC
(
cfg80211_dißbÀ_40mhz_24ghz
,

57 
cfg80211_ªgi°îed_devi˚
 *
	$cfg80211_rdev_by_wùhy_idx
(
wùhy_idx
)

59 
cfg80211_ªgi°îed_devi˚
 *
ªsu…
 = 
NULL
, *
rdev
;

61 
	`ASSERT_RTNL
();

63 
	`f‹_óch_rdev
(
rdev
) {

64 i‡(
rdev
->
wùhy_idx
 == wiphy_idx) {

65 
ªsu…
 = 
rdev
;

70  
ªsu…
;

71 
	}
}

73 
	$gë_wùhy_idx
(
wùhy
 *wiphy)

75 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

77  
rdev
->
wùhy_idx
;

78 
	}
}

80 
wùhy
 *
	$wùhy_idx_to_wùhy
(
wùhy_idx
)

82 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

84 
	`ASSERT_RTNL
();

86 
rdev
 = 
	`cfg80211_rdev_by_wùhy_idx
(
wùhy_idx
);

87 i‡(!
rdev
)

88  
NULL
;

89  &
rdev
->
wùhy
;

90 
	}
}

92 
	$cfg80211_dev_check_«me
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

93 c⁄° *
√w«me
)

95 
cfg80211_ªgi°îed_devi˚
 *
rdev2
;

96 
wùhy_idx
, 
èkí
 = -1, 
digôs
;

98 
	`ASSERT_RTNL
();

100 i‡(
	`°æí
(
√w«me
Ë> 
NL80211_WIPHY_NAME_MAXLEN
)

101  -
EINVAL
;

104 
	`ssˇnf
(
√w«me
, 
PHY_NAME
 "%d%n", &
wùhy_idx
, &
èkí
);

105 i‡(
èkí
 =
	`°æí
(
√w«me
Ë&& 
wùhy_idx
 !
rdev
->wiphy_idx) {

107 
digôs
 = 1;

108 
wùhy_idx
 /= 10)

109 
digôs
++;

114 i‡(
èkí
 =
	`°æí
(
PHY_NAME
Ë+ 
digôs
)

115  -
EINVAL
;

119 
	`f‹_óch_rdev
(
rdev2
)

120 i‡(
	`°rcmp
(
√w«me
, 
	`wùhy_«me
(&
rdev2
->
wùhy
)) == 0)

121  -
EINVAL
;

124 
	}
}

126 
	$cfg80211_dev_ª«me
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

127 *
√w«me
)

129 
ªsu…
;

131 
	`ASSERT_RTNL
();

132 
	`lockdï_as£π_wùhy
(&
rdev
->
wùhy
);

135 i‡(
	`°rcmp
(
√w«me
, 
	`wùhy_«me
(&
rdev
->
wùhy
)) == 0)

138 
ªsu…
 = 
	`cfg80211_dev_check_«me
(
rdev
, 
√w«me
);

139 i‡(
ªsu…
 < 0)

140  
ªsu…
;

142 
ªsu…
 = 
	`devi˚_ª«me
(&
rdev
->
wùhy
.
dev
, 
√w«me
);

143 i‡(
ªsu…
)

144  
ªsu…
;

146 i‡(!
	`IS_ERR_OR_NULL
(
rdev
->
wùhy
.
debugfsdú
))

147 
	`debugfs_ª«me
(
rdev
->
wùhy
.
debugfsdú
->
d_∑ª¡
,

148 
rdev
->
wùhy
.
debugfsdú
,

149 
rdev
->
wùhy
.
debugfsdú
->
d_∑ª¡
, 
√w«me
);

151 
	`∆80211_nŸify_wùhy
(
rdev
, 
NL80211_CMD_NEW_WIPHY
);

154 
	}
}

156 
	$cfg80211_swôch_√äs
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

157 
√t
 *net)

159 
wúñess_dev
 *
wdev
;

160 
îr
 = 0;

162 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_NETNS_OK
))

163  -
EOPNOTSUPP
;

165 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

166 i‡(!
wdev
->
√tdev
)

168 
wdev
->
√tdev
->
„©uªs
 &~
NETIF_F_NETNS_LOCAL
;

169 
îr
 = 
	`dev_ch™ge_√t_«me•a˚
(
wdev
->
√tdev
, 
√t
, "wlan%d");

170 i‡(
îr
)

172 
wdev
->
√tdev
->
„©uªs
 |
NETIF_F_NETNS_LOCAL
;

175 i‡(
îr
) {

177 
√t
 = 
	`wùhy_√t
(&
rdev
->
wùhy
);

179 
	`li°_f‹_óch_íåy_c⁄töue_ªvî£
(
wdev
,

180 &
rdev
->
wùhy
.
wdev_li°
,

181 
li°
) {

182 i‡(!
wdev
->
√tdev
)

184 
wdev
->
√tdev
->
„©uªs
 &~
NETIF_F_NETNS_LOCAL
;

185 
îr
 = 
	`dev_ch™ge_√t_«me•a˚
(
wdev
->
√tdev
, 
√t
,

187 
	`WARN_ON
(
îr
);

188 
wdev
->
√tdev
->
„©uªs
 |
NETIF_F_NETNS_LOCAL
;

191  
îr
;

194 
	`wùhy_lock
(&
rdev
->
wùhy
);

195 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

196 i‡(!
wdev
->
√tdev
)

198 
	`∆80211_nŸify_iÁ˚
(
rdev
, 
wdev
, 
NL80211_CMD_DEL_INTERFACE
);

201 
	`∆80211_nŸify_wùhy
(
rdev
, 
NL80211_CMD_DEL_WIPHY
);

203 
	`wùhy_√t_£t
(&
rdev
->
wùhy
, 
√t
);

205 
îr
 = 
	`devi˚_ª«me
(&
rdev
->
wùhy
.
dev
, 
	`dev_«me
(&rdev->wiphy.dev));

206 
	`WARN_ON
(
îr
);

208 
	`∆80211_nŸify_wùhy
(
rdev
, 
NL80211_CMD_NEW_WIPHY
);

210 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

211 i‡(!
wdev
->
√tdev
)

213 
	`∆80211_nŸify_iÁ˚
(
rdev
, 
wdev
, 
NL80211_CMD_NEW_INTERFACE
);

215 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

218 
	}
}

220 
	$cfg80211_rfkûl_pﬁl
(
rfkûl
 *rfkûl, *
d©a
)

222 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
d©a
;

224 
	`wùhy_lock
(&
rdev
->
wùhy
);

225 
	`rdev_rfkûl_pﬁl
(
rdev
);

226 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

227 
	}
}

229 
	$cfg80211_°›_p2p_devi˚
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

230 
wúñess_dev
 *
wdev
)

232 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

234 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_DEVICE
))

237 i‡(!
	`wdev_ru¬ög
(
wdev
))

240 
	`rdev_°›_p2p_devi˚
(
rdev
, 
wdev
);

241 
wdev
->
is_ru¬ög
 = 
Ál£
;

243 
rdev
->
›ícou¡
--;

245 i‡(
rdev
->
sˇn_ªq
 &&Ñdev->sˇn_ªq->
wdev
 == wdev) {

246 i‡(
	`WARN_ON
(!
rdev
->
sˇn_ªq
->
nŸifõd
 &&

247 (!
rdev
->
öt_sˇn_ªq
 ||

248 !
rdev
->
öt_sˇn_ªq
->
nŸifõd
)))

249 
rdev
->
sˇn_ªq
->
öfo
.
ab‹ãd
 = 
åue
;

250 
	`___cfg80211_sˇn_d⁄e
(
rdev
, 
Ál£
);

252 
	}
}

254 
	$cfg80211_°›_«n
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

255 
wúñess_dev
 *
wdev
)

257 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

259 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_NAN
))

262 i‡(!
	`wdev_ru¬ög
(
wdev
))

265 
	`rdev_°›_«n
(
rdev
, 
wdev
);

266 
wdev
->
is_ru¬ög
 = 
Ál£
;

268 
rdev
->
›ícou¡
--;

269 
	}
}

271 
	$cfg80211_shutdown_Æl_öãrÁ˚s
(
wùhy
 *wiphy)

273 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

274 
wúñess_dev
 *
wdev
;

276 
	`ASSERT_RTNL
();

278 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

279 i‡(
wdev
->
√tdev
) {

280 
	`dev_˛o£
(
wdev
->
√tdev
);

286 
	`wùhy_lock
(
wùhy
);

288 
wdev
->
i·y≥
) {

289 
NL80211_IFTYPE_P2P_DEVICE
:

290 
	`cfg80211_°›_p2p_devi˚
(
rdev
, 
wdev
);

292 
NL80211_IFTYPE_NAN
:

293 
	`cfg80211_°›_«n
(
rdev
, 
wdev
);

299 
	`wùhy_u∆ock
(
wùhy
);

301 
	}
}

302 
EXPORT_SYMBOL_GPL
(
cfg80211_shutdown_Æl_öãrÁ˚s
);

304 
	$cfg80211_rfkûl_£t_block
(*
d©a
, 
boﬁ
 
blocked
)

306 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
d©a
;

308 i‡(!
blocked
)

311 
	`π∆_lock
();

312 
	`cfg80211_shutdown_Æl_öãrÁ˚s
(&
rdev
->
wùhy
);

313 
	`π∆_u∆ock
();

316 
	}
}

318 
	$cfg80211_rfkûl_block_w‹k
(
w‹k_°ru˘
 *
w‹k
)

320 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

322 
rdev
 = 
	`c⁄èöî_of
(
w‹k
, 
cfg80211_ªgi°îed_devi˚
,

323 
rfkûl_block
);

324 
	`cfg80211_rfkûl_£t_block
(
rdev
, 
åue
);

325 
	}
}

327 
	$cfg80211_evít_w‹k
(
w‹k_°ru˘
 *
w‹k
)

329 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

331 
rdev
 = 
	`c⁄èöî_of
(
w‹k
, 
cfg80211_ªgi°îed_devi˚
,

332 
evít_w‹k
);

334 
	`wùhy_lock
(&
rdev
->
wùhy
);

335 
	`cfg80211_¥o˚ss_rdev_evíts
(
rdev
);

336 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

337 
	}
}

339 
	$cfg80211_de°roy_iÁ˚s
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

341 
wúñess_dev
 *
wdev
, *
tmp
;

343 
	`ASSERT_RTNL
();

345 
	`li°_f‹_óch_íåy_ß„
(
wdev
, 
tmp
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

346 i‡(
wdev
->
∆_ow√r_dód
) {

347 i‡(
wdev
->
√tdev
)

348 
	`dev_˛o£
(
wdev
->
√tdev
);

350 
	`wùhy_lock
(&
rdev
->
wùhy
);

351 
	`cfg80211_Àave
(
rdev
, 
wdev
);

352 
	`cfg80211_ªmove_vútuÆ_ötf
(
rdev
, 
wdev
);

353 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

356 
	}
}

358 
	$cfg80211_de°roy_iÁ˚_wk
(
w‹k_°ru˘
 *
w‹k
)

360 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

362 
rdev
 = 
	`c⁄èöî_of
(
w‹k
, 
cfg80211_ªgi°îed_devi˚
,

363 
de°roy_w‹k
);

365 
	`π∆_lock
();

366 
	`cfg80211_de°roy_iÁ˚s
(
rdev
);

367 
	`π∆_u∆ock
();

368 
	}
}

370 
	$cfg80211_sched_sˇn_°›_wk
(
wùhy
 *wiphy,

371 
wùhy_w‹k
 *
w‹k
)

373 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

374 
cfg80211_sched_sˇn_ªque°
 *
ªq
, *
tmp
;

376 
rdev
 = 
	`c⁄èöî_of
(
w‹k
, 
cfg80211_ªgi°îed_devi˚
,

377 
sched_sˇn_°›_wk
);

379 
	`li°_f‹_óch_íåy_ß„
(
ªq
, 
tmp
, &
rdev
->
sched_sˇn_ªq_li°
, 
li°
) {

380 i‡(
ªq
->
∆_ow√r_dód
)

381 
	`cfg80211_°›_sched_sˇn_ªq
(
rdev
, 
ªq
, 
Ál£
);

383 
	}
}

385 
	$cfg80211_¥›ag©e_ød¨_dëe˘_wk
(
w‹k_°ru˘
 *
w‹k
)

387 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

389 
rdev
 = 
	`c⁄èöî_of
(
w‹k
, 
cfg80211_ªgi°îed_devi˚
,

390 
¥›ag©e_ød¨_dëe˘_wk
);

392 
	`π∆_lock
();

394 
	`ªguœt‹y_¥›ag©e_dfs_°©e
(&
rdev
->
wùhy
, &rdev->
ød¨_ch™def
,

395 
NL80211_DFS_UNAVAILABLE
,

396 
NL80211_RADAR_DETECTED
);

398 
	`π∆_u∆ock
();

399 
	}
}

401 
	$cfg80211_¥›ag©e_ˇc_d⁄e_wk
(
w‹k_°ru˘
 *
w‹k
)

403 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

405 
rdev
 = 
	`c⁄èöî_of
(
w‹k
, 
cfg80211_ªgi°îed_devi˚
,

406 
¥›ag©e_ˇc_d⁄e_wk
);

408 
	`π∆_lock
();

410 
	`ªguœt‹y_¥›ag©e_dfs_°©e
(&
rdev
->
wùhy
, &rdev->
ˇc_d⁄e_ch™def
,

411 
NL80211_DFS_AVAILABLE
,

412 
NL80211_RADAR_CAC_FINISHED
);

414 
	`π∆_u∆ock
();

415 
	}
}

417 
	$cfg80211_wùhy_w‹k
(
w‹k_°ru˘
 *
w‹k
)

419 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

420 
wùhy_w‹k
 *
wk
;

422 
rdev
 = 
	`c⁄èöî_of
(
w‹k
, 
cfg80211_ªgi°îed_devi˚
, 
wùhy_w‹k
);

424 
	`wùhy_lock
(&
rdev
->
wùhy
);

425 i‡(
rdev
->
su•íded
)

426 
out
;

428 
	`•ö_lock_úq
(&
rdev
->
wùhy_w‹k_lock
);

429 
wk
 = 
	`li°_fú°_íåy_‹_nuŒ
(&
rdev
->
wùhy_w‹k_li°
,

430 
wùhy_w‹k
, 
íåy
);

431 i‡(
wk
) {

432 
	`li°_dñ_öô
(&
wk
->
íåy
);

433 i‡(!
	`li°_em±y
(&
rdev
->
wùhy_w‹k_li°
))

434 
	`scheduÀ_w‹k
(
w‹k
);

435 
	`•ö_u∆ock_úq
(&
rdev
->
wùhy_w‹k_lock
);

437 
wk
->
	`func
(&
rdev
->
wùhy
, wk);

439 
	`•ö_u∆ock_úq
(&
rdev
->
wùhy_w‹k_lock
);

441 
out
:

442 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

443 
	}
}

447 
wùhy
 *
	$wùhy_√w_nm
(c⁄° 
cfg80211_›s
 *
›s
, 
sizeof_¥iv
,

448 c⁄° *
ªque°ed_«me
)

450 
©omic_t
 
wùhy_cou¡î
 = 
	`ATOMIC_INIT
(0);

452 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

453 
Æloc_size
;

455 
	`WARN_ON
(
›s
->
add_key
 && (!›s->
dñ_key
 || !›s->
£t_deÁu…_key
));

456 
	`WARN_ON
(
›s
->
auth
 && (!›s->
assoc
 || !›s->
dóuth
 || !›s->
dißssoc
));

457 
	`WARN_ON
(
›s
->
c⁄√˘
 && !›s->
disc⁄√˘
);

458 
	`WARN_ON
(
›s
->
joö_ibss
 && !›s->
Àave_ibss
);

459 
	`WARN_ON
(
›s
->
add_vútuÆ_ötf
 && !›s->
dñ_vútuÆ_ötf
);

460 
	`WARN_ON
(
›s
->
add_°©i⁄
 && !›s->
dñ_°©i⁄
);

461 
	`WARN_ON
(
›s
->
add_m∑th
 && !›s->
dñ_m∑th
);

462 
	`WARN_ON
(
›s
->
joö_mesh
 && !›s->
Àave_mesh
);

463 
	`WARN_ON
(
›s
->
°¨t_p2p_devi˚
 && !›s->
°›_p2p_devi˚
);

464 
	`WARN_ON
(
›s
->
°¨t_≠
 && !›s->
°›_≠
);

465 
	`WARN_ON
(
›s
->
joö_ocb
 && !›s->
Àave_ocb
);

466 
	`WARN_ON
(
›s
->
su•íd
 && !›s->
ªsume
);

467 
	`WARN_ON
(
›s
->
sched_sˇn_°¨t
 && !›s->
sched_sˇn_°›
);

468 
	`WARN_ON
(
›s
->
ªmaö_⁄_ch™√l
 && !›s->
ˇn˚l_ªmaö_⁄_ch™√l
);

469 
	`WARN_ON
(
›s
->
tdls_ch™√l_swôch
 && !›s->
tdls_ˇn˚l_ch™√l_swôch
);

470 
	`WARN_ON
(
›s
->
add_tx_ts
 && !›s->
dñ_tx_ts
);

472 
Æloc_size
 = (*
rdev
Ë+ 
sizeof_¥iv
;

474 
rdev
 = 
	`kzÆloc
(
Æloc_size
, 
GFP_KERNEL
);

475 i‡(!
rdev
)

476  
NULL
;

478 
rdev
->
›s
 = ops;

480 
rdev
->
wùhy_idx
 = 
	`©omic_öc_ªtu∫
(&
wùhy_cou¡î
);

482 i‡(
	`u∆ikñy
(
rdev
->
wùhy_idx
 < 0)) {

484 
	`©omic_dec
(&
wùhy_cou¡î
);

485 
	`k‰ì
(
rdev
);

486  
NULL
;

490 
rdev
->
wùhy_idx
--;

493 i‡(
ªque°ed_«me
 &&Ñequested_name[0]) {

494 
rv
;

496 
	`π∆_lock
();

497 
rv
 = 
	`cfg80211_dev_check_«me
(
rdev
, 
ªque°ed_«me
);

499 i‡(
rv
 < 0) {

500 
	`π∆_u∆ock
();

501 
u£_deÁu…_«me
;

504 
rv
 = 
	`dev_£t_«me
(&
rdev
->
wùhy
.
dev
, "%s", 
ªque°ed_«me
);

505 
	`π∆_u∆ock
();

506 i‡(
rv
)

507 
u£_deÁu…_«me
;

509 
rv
;

511 
u£_deÁu…_«me
:

518 
rv
 = 
	`dev_£t_«me
(&
rdev
->
wùhy
.
dev
, 
PHY_NAME
 "%d",Ñdev->
wùhy_idx
);

519 i‡(
rv
 < 0) {

520 
	`k‰ì
(
rdev
);

521  
NULL
;

525 
	`muãx_öô
(&
rdev
->
wùhy
.
mtx
);

526 
	`INIT_LIST_HEAD
(&
rdev
->
wùhy
.
wdev_li°
);

527 
	`INIT_LIST_HEAD
(&
rdev
->
bóc⁄_ªgi°øti⁄s
);

528 
	`•ö_lock_öô
(&
rdev
->
bóc⁄_ªgi°øti⁄s_lock
);

529 
	`•ö_lock_öô
(&
rdev
->
bss_lock
);

530 
	`INIT_LIST_HEAD
(&
rdev
->
bss_li°
);

531 
	`INIT_LIST_HEAD
(&
rdev
->
sched_sˇn_ªq_li°
);

532 
	`wùhy_w‹k_öô
(&
rdev
->
sˇn_d⁄e_wk
, 
__cfg80211_sˇn_d⁄e
);

533 
	`INIT_DELAYED_WORK
(&
rdev
->
dfs_upd©e_ch™√ls_wk
,

534 
cfg80211_dfs_ch™√ls_upd©e_w‹k
);

535 #ifde‡
CONFIG_CFG80211_WEXT


536 
rdev
->
wùhy
.
wext
 = &
cfg80211_wext_h™dÀr
;

539 
	`devi˚_öôülize
(&
rdev
->
wùhy
.
dev
);

540 
rdev
->
wùhy
.
dev
.
˛ass
 = &
õì80211_˛ass
;

541 
rdev
->
wùhy
.
dev
.
∂©f‹m_d©a
 =Ñdev;

542 
	`devi˚_íabÀ_async_su•íd
(&
rdev
->
wùhy
.
dev
);

544 
	`INIT_WORK
(&
rdev
->
de°roy_w‹k
, 
cfg80211_de°roy_iÁ˚_wk
);

545 
	`wùhy_w‹k_öô
(&
rdev
->
sched_sˇn_°›_wk
, 
cfg80211_sched_sˇn_°›_wk
);

546 
	`INIT_WORK
(&
rdev
->
sched_sˇn_ªs_wk
, 
cfg80211_sched_sˇn_ªsu…s_wk
);

547 
	`INIT_WORK
(&
rdev
->
¥›ag©e_ød¨_dëe˘_wk
,

548 
cfg80211_¥›ag©e_ød¨_dëe˘_wk
);

549 
	`INIT_WORK
(&
rdev
->
¥›ag©e_ˇc_d⁄e_wk
, 
cfg80211_¥›ag©e_ˇc_d⁄e_wk
);

550 
	`INIT_WORK
(&
rdev
->
mgmt_ªgi°øti⁄s_upd©e_wk
,

551 
cfg80211_mgmt_ªgi°øti⁄s_upd©e_wk
);

552 
	`•ö_lock_öô
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

554 #ifde‡
CONFIG_CFG80211_DEFAULT_PS


555 
rdev
->
wùhy
.
Êags
 |
WIPHY_FLAG_PS_ON_BY_DEFAULT
;

558 
	`wùhy_√t_£t
(&
rdev
->
wùhy
, &
öô_√t
);

560 
rdev
->
rfkûl_›s
.
£t_block
 = 
cfg80211_rfkûl_£t_block
;

561 
rdev
->
wùhy
.
rfkûl
 = 
	`rfkûl_Æloc
(
	`dev_«me
(&rdev->wùhy.
dev
),

562 &
rdev
->
wùhy
.
dev
, 
RFKILL_TYPE_WLAN
,

563 &
rdev
->
rfkûl_›s
,Ñdev);

565 i‡(!
rdev
->
wùhy
.
rfkûl
) {

566 
	`wùhy_‰ì
(&
rdev
->
wùhy
);

567  
NULL
;

570 
	`INIT_WORK
(&
rdev
->
wùhy_w‹k
, 
cfg80211_wùhy_w‹k
);

571 
	`INIT_LIST_HEAD
(&
rdev
->
wùhy_w‹k_li°
);

572 
	`•ö_lock_öô
(&
rdev
->
wùhy_w‹k_lock
);

573 
	`INIT_WORK
(&
rdev
->
rfkûl_block
, 
cfg80211_rfkûl_block_w‹k
);

574 
	`INIT_WORK
(&
rdev
->
c⁄n_w‹k
, 
cfg80211_c⁄n_w‹k
);

575 
	`INIT_WORK
(&
rdev
->
evít_w‹k
, 
cfg80211_evít_w‹k
);

576 
	`INIT_WORK
(&
rdev
->
background_ˇc_ab‹t_wk
,

577 
cfg80211_background_ˇc_ab‹t_wk
);

578 
	`INIT_DELAYED_WORK
(&
rdev
->
background_ˇc_d⁄e_wk
,

579 
cfg80211_background_ˇc_d⁄e_wk
);

581 
	`öô_waôqueue_hód
(&
rdev
->
dev_waô
);

588 
rdev
->
wùhy
.
ªåy_sh‹t
 = 7;

589 
rdev
->
wùhy
.
ªåy_l⁄g
 = 4;

590 
rdev
->
wùhy
.
‰ag_thªshﬁd
 = (
u32
) -1;

591 
rdev
->
wùhy
.
πs_thªshﬁd
 = (
u32
) -1;

592 
rdev
->
wùhy
.
covîage_˛ass
 = 0;

594 
rdev
->
wùhy
.
max_num_cß_cou¡îs
 = 1;

596 
rdev
->
wùhy
.
max_sched_sˇn_∂™s
 = 1;

597 
rdev
->
wùhy
.
max_sched_sˇn_∂™_öãrvÆ
 = 
U32_MAX
;

599  &
rdev
->
wùhy
;

600 
	}
}

601 
EXPORT_SYMBOL
(
wùhy_√w_nm
);

603 
	$wùhy_vîify_combö©i⁄s
(
wùhy
 *wiphy)

605 c⁄° 
õì80211_iÁ˚_combö©i⁄
 *
c
;

606 
i
, 
j
;

608 
i
 = 0; i < 
wùhy
->
n_iÁ˚_combö©i⁄s
; i++) {

609 
u32
 
˙t
 = 0;

610 
u16
 
Æl_i·y≥s
 = 0;

612 
c
 = &
wùhy
->
iÁ˚_combö©i⁄s
[
i
];

618 i‡(
	`WARN_ON
((
c
->
max_öãrÁ˚s
 < 2Ë&& !c->
ød¨_dëe˘_widths
))

619  -
EINVAL
;

622 i‡(
	`WARN_ON
(!
c
->
num_dif„ª¡_ch™√ls
))

623  -
EINVAL
;

626 i‡(
	`WARN_ON
(
c
->
ød¨_dëe˘_widths
 &&

627 (
c
->
num_dif„ª¡_ch™√ls
 > 1)))

628  -
EINVAL
;

630 i‡(
	`WARN_ON
(!
c
->
n_limôs
))

631  -
EINVAL
;

633 
j
 = 0; j < 
c
->
n_limôs
; j++) {

634 
u16
 
ty≥s
 = 
c
->
limôs
[
j
].types;

637 i‡(
	`WARN_ON
(
ty≥s
 & 
Æl_i·y≥s
))

638  -
EINVAL
;

639 
Æl_i·y≥s
 |
ty≥s
;

641 i‡(
	`WARN_ON
(!
c
->
limôs
[
j
].
max
))

642  -
EINVAL
;

645 i‡(
	`WARN_ON
(
wùhy
->
so·w¨e_i·y≥s
 & 
ty≥s
))

646  -
EINVAL
;

649 i‡(
	`WARN_ON
(
ty≥s
 & 
	`BIT
(
NL80211_IFTYPE_P2P_DEVICE
) &&

650 
c
->
limôs
[
j
].
max
 > 1))

651  -
EINVAL
;

654 i‡(
	`WARN_ON
(
ty≥s
 & 
	`BIT
(
NL80211_IFTYPE_NAN
) &&

655 
c
->
limôs
[
j
].
max
 > 1))

656  -
EINVAL
;

668 i‡(
	`WARN_ON
(
ty≥s
 & 
	`BIT
(
NL80211_IFTYPE_ADHOC
) &&

669 
c
->
bóc⁄_öt_mö_gcd
)) {

670  -
EINVAL
;

673 
˙t
 +
c
->
limôs
[
j
].
max
;

678 i‡(
	`WARN_ON
((
wùhy
->
öãrÁ˚_modes
 & 
ty≥s
) !=Åypes))

679  -
EINVAL
;

682 i‡(
	`WARN_ON
(
Æl_i·y≥s
 & 
	`BIT
(
NL80211_IFTYPE_WDS
)))

683  -
EINVAL
;

686 i‡(
	`WARN_ON
(
˙t
 < 
c
->
max_öãrÁ˚s
))

687  -
EINVAL
;

691 
	}
}

693 
	$wùhy_ªgi°î
(
wùhy
 *wiphy)

695 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

696 
ªs
;

697 
∆80211_b™d
 
b™d
;

698 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

699 
boﬁ
 
have_b™d
 = 
Ál£
;

700 
i
;

701 
u16
 
ifmodes
 = 
wùhy
->
öãrÁ˚_modes
;

703 #ifde‡
CONFIG_PM


704 i‡(
	`WARN_ON
(
wùhy
->
wowœn
 &&

705 (
wùhy
->
wowœn
->
Êags
 & 
WIPHY_WOWLAN_GTK_REKEY_FAILURE
) &&

706 !(
wùhy
->
wowœn
->
Êags
 & 
WIPHY_WOWLAN_SUPPORTS_GTK_REKEY
)))

707  -
EINVAL
;

708 i‡(
	`WARN_ON
(
wùhy
->
wowœn
 &&

709 !
wùhy
->
wowœn
->
Êags
 && !wùhy->wowœn->
n_∑âîns
 &&

710 !
wùhy
->
wowœn
->
t˝
))

711  -
EINVAL
;

713 i‡(
	`WARN_ON
((
wùhy
->
„©uªs
 & 
NL80211_FEATURE_TDLS_CHANNEL_SWITCH
) &&

714 (!
rdev
->
›s
->
tdls_ch™√l_swôch
 ||

715 !
rdev
->
›s
->
tdls_ˇn˚l_ch™√l_swôch
)))

716  -
EINVAL
;

718 i‡(
	`WARN_ON
((
wùhy
->
öãrÁ˚_modes
 & 
	`BIT
(
NL80211_IFTYPE_NAN
)) &&

719 (!
rdev
->
›s
->
°¨t_«n
 || !rdev->›s->
°›_«n
 ||

720 !
rdev
->
›s
->
add_«n_func
 || !rdev->›s->
dñ_«n_func
 ||

721 !(
wùhy
->
«n_suµ‹ãd_b™ds
 & 
	`BIT
(
NL80211_BAND_2GHZ
)))))

722  -
EINVAL
;

724 i‡(
	`WARN_ON
(
wùhy
->
öãrÁ˚_modes
 & 
	`BIT
(
NL80211_IFTYPE_WDS
)))

725  -
EINVAL
;

727 i‡(
	`WARN_ON
(
wùhy
->
pm§_ˇ∑
 && !wùhy->pm§_ˇ∑->
·m
.
suµ‹ãd
))

728  -
EINVAL
;

730 i‡(
wùhy
->
pm§_ˇ∑
 && wùhy->pm§_ˇ∑->
·m
.
suµ‹ãd
) {

731 i‡(
	`WARN_ON
(!
wùhy
->
pm§_ˇ∑
->
·m
.
aßp
 &&

732 !
wùhy
->
pm§_ˇ∑
->
·m
.
n⁄_aßp
))

733  -
EINVAL
;

734 i‡(
	`WARN_ON
(!
wùhy
->
pm§_ˇ∑
->
·m
.
¥ómbÀs
 ||

735 !
wùhy
->
pm§_ˇ∑
->
·m
.
b™dwidths
))

736  -
EINVAL
;

737 i‡(
	`WARN_ON
(
wùhy
->
pm§_ˇ∑
->
·m
.
¥ómbÀs
 &

738 ~(
	`BIT
(
NL80211_PREAMBLE_LEGACY
) |

739 
	`BIT
(
NL80211_PREAMBLE_HT
) |

740 
	`BIT
(
NL80211_PREAMBLE_VHT
) |

741 
	`BIT
(
NL80211_PREAMBLE_HE
) |

742 
	`BIT
(
NL80211_PREAMBLE_DMG
))))

743  -
EINVAL
;

744 i‡(
	`WARN_ON
((
wùhy
->
pm§_ˇ∑
->
·m
.
åiggî_ba£d
 ||

745 
wùhy
->
pm§_ˇ∑
->
·m
.
n⁄_åiggî_ba£d
) &&

746 !(
wùhy
->
pm§_ˇ∑
->
·m
.
¥ómbÀs
 &

747 
	`BIT
(
NL80211_PREAMBLE_HE
))))

748  -
EINVAL
;

749 i‡(
	`WARN_ON
(
wùhy
->
pm§_ˇ∑
->
·m
.
b™dwidths
 &

750 ~(
	`BIT
(
NL80211_CHAN_WIDTH_20_NOHT
) |

751 
	`BIT
(
NL80211_CHAN_WIDTH_20
) |

752 
	`BIT
(
NL80211_CHAN_WIDTH_40
) |

753 
	`BIT
(
NL80211_CHAN_WIDTH_80
) |

754 
	`BIT
(
NL80211_CHAN_WIDTH_80P80
) |

755 
	`BIT
(
NL80211_CHAN_WIDTH_160
) |

756 
	`BIT
(
NL80211_CHAN_WIDTH_5
) |

757 
	`BIT
(
NL80211_CHAN_WIDTH_10
))))

758  -
EINVAL
;

761 i‡(
	`WARN_ON
((
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
) &&

762 (
wùhy
->
ªguœt‹y_Êags
 &

763 (
REGULATORY_CUSTOM_REG
 |

764 
REGULATORY_STRICT_REG
 |

765 
REGULATORY_COUNTRY_IE_FOLLOW_POWER
 |

766 
REGULATORY_COUNTRY_IE_IGNORE
))))

767  -
EINVAL
;

769 i‡(
	`WARN_ON
(
wùhy
->
cﬂÀs˚
 &&

770 (!
wùhy
->
cﬂÀs˚
->
n_ruÀs
 ||

771 !
wùhy
->
cﬂÀs˚
->
n_∑âîns
) &&

772 (!
wùhy
->
cﬂÀs˚
->
∑âîn_mö_Àn
 ||

773 
wùhy
->
cﬂÀs˚
->
∑âîn_mö_Àn
 >

774 
wùhy
->
cﬂÀs˚
->
∑âîn_max_Àn
)))

775  -
EINVAL
;

777 i‡(
	`WARN_ON
(
wùhy
->
≠_sme_ˇ∑
 &&

778 !(
wùhy
->
Êags
 & 
WIPHY_FLAG_HAVE_AP_SME
)))

779  -
EINVAL
;

781 i‡(
	`WARN_ON
(
wùhy
->
addªs£s
 && !wùhy->
n_addªs£s
))

782  -
EINVAL
;

784 i‡(
	`WARN_ON
(
wùhy
->
addªs£s
 &&

785 !
	`is_zîo_ëhî_addr
(
wùhy
->
≥rm_addr
) &&

786 
	`memcmp
(
wùhy
->
≥rm_addr
, wùhy->
addªs£s
[0].
addr
,

787 
ETH_ALEN
)))

788  -
EINVAL
;

790 i‡(
	`WARN_ON
(
wùhy
->
max_a˛_mac_addrs
 &&

791 (!(
wùhy
->
Êags
 & 
WIPHY_FLAG_HAVE_AP_SME
) ||

792 !
rdev
->
›s
->
£t_mac_a˛
)))

793  -
EINVAL
;

798 i‡(
	`WARN_ON
(
wùhy
->
bss_£À˘_suµ‹t
 &&

799 (
wùhy
->
bss_£À˘_suµ‹t
 & ~(
	`BIT
(
__NL80211_BSS_SELECT_ATTR_AFTER_LAST
) - 2))))

800  -
EINVAL
;

802 i‡(
	`WARN_ON
(
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

803 
NL80211_EXT_FEATURE_4WAY_HANDSHAKE_STA_1X
) &&

804 (!
rdev
->
›s
->
£t_pmk
 || !rdev->›s->
dñ_pmk
)))

805  -
EINVAL
;

807 i‡(
	`WARN_ON
(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_FW_ROAM
) &&

808 
rdev
->
›s
->
upd©e_c⁄√˘_∑øms
))

809  -
EINVAL
;

811 i‡(
wùhy
->
addªs£s
)

812 
	`mem˝y
(
wùhy
->
≥rm_addr
, wùhy->
addªs£s
[0].
addr
, 
ETH_ALEN
);

815 
	`WARN_ON
(!
ifmodes
);

816 
ifmodes
 &((1 << 
NUM_NL80211_IFTYPES
) - 1) & ~1;

817 i‡(
	`WARN_ON
(
ifmodes
 !
wùhy
->
öãrÁ˚_modes
))

818 
wùhy
->
öãrÁ˚_modes
 = 
ifmodes
;

820 
ªs
 = 
	`wùhy_vîify_combö©i⁄s
(
wùhy
);

821 i‡(
ªs
)

822  
ªs
;

825 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

826 c⁄° 
õì80211_sb™d_i·y≥_d©a
 *
i·d
;

827 
u16
 
ty≥s
 = 0;

828 
boﬁ
 
have_he
 = 
Ál£
;

830 
sb™d
 = 
wùhy
->
b™ds
[
b™d
];

831 i‡(!
sb™d
)

834 
sb™d
->
b™d
 = band;

835 i‡(
	`WARN_ON
(!
sb™d
->
n_ch™√ls
))

836  -
EINVAL
;

841 i‡(
	`WARN_ON
((
b™d
 !
NL80211_BAND_60GHZ
 &&

842 
b™d
 !
NL80211_BAND_S1GHZ
) &&

843 !
sb™d
->
n_bôøãs
))

844  -
EINVAL
;

846 i‡(
	`WARN_ON
(
b™d
 =
NL80211_BAND_6GHZ
 &&

847 (
sb™d
->
ht_ˇp
.
ht_suµ‹ãd
 ||

848 
sb™d
->
vht_ˇp
.
vht_suµ‹ãd
)))

849  -
EINVAL
;

856 i‡(
cfg80211_dißbÀ_40mhz_24ghz
 &&

857 
b™d
 =
NL80211_BAND_2GHZ
 &&

858 
sb™d
->
ht_ˇp
.
ht_suµ‹ãd
) {

859 
sb™d
->
ht_ˇp
.
ˇp
 &~
IEEE80211_HT_CAP_SUP_WIDTH_20_40
;

860 
sb™d
->
ht_ˇp
.
ˇp
 &~
IEEE80211_HT_CAP_SGI_40
;

868 i‡(
	`WARN_ON
(
sb™d
->
n_bôøãs
 > 32))

869  -
EINVAL
;

871 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++) {

872 
sb™d
->
ch™√ls
[
i
].
‹ig_Êags
 =

873 
sb™d
->
ch™√ls
[
i
].
Êags
;

874 
sb™d
->
ch™√ls
[
i
].
‹ig_mag
 = 
INT_MAX
;

875 
sb™d
->
ch™√ls
[
i
].
‹ig_mpwr
 =

876 
sb™d
->
ch™√ls
[
i
].
max_powî
;

877 
sb™d
->
ch™√ls
[
i
].
b™d
 = band;

879 i‡(
	`WARN_ON
(
sb™d
->
ch™√ls
[
i
].
‰eq_off£t
 >= 1000))

880  -
EINVAL
;

883 
	`f‹_óch_sb™d_i·y≥_d©a
(
sb™d
, 
i
, 
i·d
) {

884 
boﬁ
 
has_≠
, 
has_n⁄_≠
;

885 
u32
 
≠_bôs
 = 
	`BIT
(
NL80211_IFTYPE_AP
) |

886 
	`BIT
(
NL80211_IFTYPE_P2P_GO
);

888 i‡(
	`WARN_ON
(!
i·d
->
ty≥s_mask
))

889  -
EINVAL
;

890 i‡(
	`WARN_ON
(
ty≥s
 & 
i·d
->
ty≥s_mask
))

891  -
EINVAL
;

894 i‡(
	`WARN_ON
(!
i·d
->
he_ˇp
.
has_he
))

895  -
EINVAL
;

897 
ty≥s
 |
i·d
->
ty≥s_mask
;

899 i‡(
i
 == 0)

900 
have_he
 = 
i·d
->
he_ˇp
.
has_he
;

902 
have_he
 = have_he &&

903 
i·d
->
he_ˇp
.
has_he
;

905 
has_≠
 = 
i·d
->
ty≥s_mask
 & 
≠_bôs
;

906 
has_n⁄_≠
 = 
i·d
->
ty≥s_mask
 & ~
≠_bôs
;

914 i‡(
	`WARN_ON
(
i·d
->
eht_ˇp
.
has_eht
 &&

915 
has_≠
 && 
has_n⁄_≠
))

916  -
EINVAL
;

919 i‡(
	`WARN_ON
(!
have_he
 && 
b™d
 =
NL80211_BAND_6GHZ
))

920  -
EINVAL
;

922 
have_b™d
 = 
åue
;

925 i‡(!
have_b™d
) {

926 
	`WARN_ON
(1);

927  -
EINVAL
;

930 
i
 = 0; i < 
rdev
->
wùhy
.
n_víd‹_comm™ds
; i++) {

936 i‡(
	`WARN_ON
(!
rdev
->
wùhy
.
víd‹_comm™ds
[
i
].
pﬁicy
))

937  -
EINVAL
;

938 i‡(
	`WARN_ON
(!
rdev
->
wùhy
.
víd‹_comm™ds
[
i
].
doô
 &&

939 !
rdev
->
wùhy
.
víd‹_comm™ds
[
i
].
dumpô
))

940  -
EINVAL
;

943 #ifde‡
CONFIG_PM


944 i‡(
	`WARN_ON
(
rdev
->
wùhy
.
wowœn
 &&Ñdev->wùhy.wowœn->
n_∑âîns
 &&

945 (!
rdev
->
wùhy
.
wowœn
->
∑âîn_mö_Àn
 ||

946 
rdev
->
wùhy
.
wowœn
->
∑âîn_mö_Àn
 >

947 
rdev
->
wùhy
.
wowœn
->
∑âîn_max_Àn
)))

948  -
EINVAL
;

951 i‡(!
wùhy
->
max_num_akm_suôes
)

952 
wùhy
->
max_num_akm_suôes
 = 
NL80211_MAX_NR_AKM_SUITES
;

953 i‡(
wùhy
->
max_num_akm_suôes
 < 
NL80211_MAX_NR_AKM_SUITES
 ||

954 
wùhy
->
max_num_akm_suôes
 > 
CFG80211_MAX_NUM_AKM_SUITES
)

955  -
EINVAL
;

958 
	`õì80211_£t_bôøã_Êags
(
wùhy
);

960 
rdev
->
wùhy
.
„©uªs
 |
NL80211_FEATURE_SCAN_FLUSH
;

962 
	`π∆_lock
();

963 
	`wùhy_lock
(&
rdev
->
wùhy
);

964 
ªs
 = 
	`devi˚_add
(&
rdev
->
wùhy
.
dev
);

965 i‡(
ªs
) {

966 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

967 
	`π∆_u∆ock
();

968  
ªs
;

971 
	`li°_add_rcu
(&
rdev
->
li°
, &
cfg80211_rdev_li°
);

972 
cfg80211_rdev_li°_gíî©i⁄
++;

975 
rdev
->
wùhy
.
debugfsdú
 = 
	`debugfs_¸óã_dú
(
	`wùhy_«me
(&rdev->wiphy),

976 
õì80211_debugfs_dú
);

978 
	`cfg80211_debugfs_rdev_add
(
rdev
);

979 
	`∆80211_nŸify_wùhy
(
rdev
, 
NL80211_CMD_NEW_WIPHY
);

980 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

983 
	`wùhy_ªguœt‹y_ªgi°î
(
wùhy
);

985 i‡(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_CUSTOM_REG
) {

986 
ªguœt‹y_ªque°
 
ªque°
;

988 
ªque°
.
wùhy_idx
 = 
	`gë_wùhy_idx
(
wùhy
);

989 
ªque°
.
öôüt‹
 = 
NL80211_REGDOM_SET_BY_DRIVER
;

990 
ªque°
.
Æpha2
[0] = '9';

991 
ªque°
.
Æpha2
[1] = '9';

993 
	`∆80211_£nd_ªg_ch™ge_evít
(&
ªque°
);

999 i‡(
wùhy
->
exãnded_ˇ∑bûôõs_Àn
 &&

1000 
wùhy
->
num_i·y≥_ext_ˇ∑b
 &&

1001 
wùhy
->
i·y≥_ext_ˇ∑b
) {

1002 
u8
 
suµ‹ãd_⁄_Æl
, 
j
;

1003 c⁄° 
wùhy_i·y≥_ext_ˇ∑b
 *
ˇ∑b
;

1005 
ˇ∑b
 = 
wùhy
->
i·y≥_ext_ˇ∑b
;

1006 
j
 = 0; j < 
wùhy
->
exãnded_ˇ∑bûôõs_Àn
; j++) {

1007 i‡(
ˇ∑b
[0].
exãnded_ˇ∑bûôõs_Àn
 > 
j
)

1008 
suµ‹ãd_⁄_Æl
 =

1009 
ˇ∑b
[0].
exãnded_ˇ∑bûôõs
[
j
];

1011 
suµ‹ãd_⁄_Æl
 = 0x00;

1012 
i
 = 1; i < 
wùhy
->
num_i·y≥_ext_ˇ∑b
; i++) {

1013 i‡(
j
 >
ˇ∑b
[
i
].
exãnded_ˇ∑bûôõs_Àn
) {

1014 
suµ‹ãd_⁄_Æl
 = 0x00;

1017 
suµ‹ãd_⁄_Æl
 &=

1018 
ˇ∑b
[
i
].
exãnded_ˇ∑bûôõs
[
j
];

1020 i‡(
	`WARN_ON
(
wùhy
->
exãnded_ˇ∑bûôõs
[
j
] &

1021 ~
suµ‹ãd_⁄_Æl
))

1026 
rdev
->
wùhy
.
ªgi°îed
 = 
åue
;

1027 
	`π∆_u∆ock
();

1029 
ªs
 = 
	`rfkûl_ªgi°î
(
rdev
->
wùhy
.
rfkûl
);

1030 i‡(
ªs
) {

1031 
	`rfkûl_de°roy
(
rdev
->
wùhy
.
rfkûl
);

1032 
rdev
->
wùhy
.
rfkûl
 = 
NULL
;

1033 
	`wùhy_uƒegi°î
(&
rdev
->
wùhy
);

1034  
ªs
;

1038 
	}
}

1039 
EXPORT_SYMBOL
(
wùhy_ªgi°î
);

1041 
	$wùhy_rfkûl_°¨t_pﬁlög
(
wùhy
 *wiphy)

1043 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1045 i‡(!
rdev
->
›s
->
rfkûl_pﬁl
)

1047 
rdev
->
rfkûl_›s
.
pﬁl
 = 
cfg80211_rfkûl_pﬁl
;

1048 
	`rfkûl_ªsume_pﬁlög
(
wùhy
->
rfkûl
);

1049 
	}
}

1050 
EXPORT_SYMBOL
(
wùhy_rfkûl_°¨t_pﬁlög
);

1052 
	$cfg80211_¥o˚ss_wùhy_w‹ks
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1053 
wùhy_w‹k
 *
íd
)

1055 
ru«way_limô
 = 100;

1056 
Êags
;

1058 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1060 
	`•ö_lock_úqßve
(&
rdev
->
wùhy_w‹k_lock
, 
Êags
);

1061 !
	`li°_em±y
(&
rdev
->
wùhy_w‹k_li°
)) {

1062 
wùhy_w‹k
 *
wk
;

1064 
wk
 = 
	`li°_fú°_íåy
(&
rdev
->
wùhy_w‹k_li°
,

1065 
wùhy_w‹k
, 
íåy
);

1066 
	`li°_dñ_öô
(&
wk
->
íåy
);

1067 
	`•ö_u∆ock_úqª°‹e
(&
rdev
->
wùhy_w‹k_lock
, 
Êags
);

1069 
wk
->
	`func
(&
rdev
->
wùhy
, wk);

1071 
	`•ö_lock_úqßve
(&
rdev
->
wùhy_w‹k_lock
, 
Êags
);

1073 i‡(
wk
 =
íd
)

1076 i‡(
	`WARN_ON
(--
ru«way_limô
 == 0))

1077 
	`INIT_LIST_HEAD
(&
rdev
->
wùhy_w‹k_li°
);

1079 
	`•ö_u∆ock_úqª°‹e
(&
rdev
->
wùhy_w‹k_lock
, 
Êags
);

1080 
	}
}

1082 
	$wùhy_uƒegi°î
(
wùhy
 *wiphy)

1084 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1086 
	`waô_evít
(
rdev
->
dev_waô
, ({

1087 
__cou¡
;

1088 
	`wùhy_lock
(&
rdev
->
wùhy
);

1089 
__cou¡
 = 
rdev
->
›ícou¡
;

1090 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1091 
__cou¡
 == 0; }));

1093 i‡(
rdev
->
wùhy
.
rfkûl
)

1094 
	`rfkûl_uƒegi°î
(
rdev
->
wùhy
.
rfkûl
);

1096 
	`π∆_lock
();

1097 
	`wùhy_lock
(&
rdev
->
wùhy
);

1098 
	`∆80211_nŸify_wùhy
(
rdev
, 
NL80211_CMD_DEL_WIPHY
);

1099 
rdev
->
wùhy
.
ªgi°îed
 = 
Ál£
;

1101 
	`WARN_ON
(!
	`li°_em±y
(&
rdev
->
wùhy
.
wdev_li°
));

1107 
	`debugfs_ªmove_ªcursive
(
rdev
->
wùhy
.
debugfsdú
);

1108 
	`li°_dñ_rcu
(&
rdev
->
li°
);

1109 
	`synchr⁄ize_rcu
();

1115 
	`wùhy_ªguœt‹y_dîegi°î
(
wùhy
);

1117 
cfg80211_rdev_li°_gíî©i⁄
++;

1118 
	`devi˚_dñ
(&
rdev
->
wùhy
.
dev
);

1120 #ifde‡
CONFIG_PM


1121 i‡(
rdev
->
wùhy
.
wowœn_c⁄fig
 &&Ñdev->
›s
->
£t_wakeup
)

1122 
	`rdev_£t_wakeup
(
rdev
, 
Ál£
);

1126 
	`cfg80211_¥o˚ss_wùhy_w‹ks
(
rdev
, 
NULL
);

1127 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1128 
	`π∆_u∆ock
();

1131 
	`ˇn˚l_w‹k_sync
(&
rdev
->
wùhy_w‹k
);

1133 
	`ˇn˚l_w‹k_sync
(&
rdev
->
c⁄n_w‹k
);

1134 
	`Êush_w‹k
(&
rdev
->
evít_w‹k
);

1135 
	`ˇn˚l_dñayed_w‹k_sync
(&
rdev
->
dfs_upd©e_ch™√ls_wk
);

1136 
	`ˇn˚l_dñayed_w‹k_sync
(&
rdev
->
background_ˇc_d⁄e_wk
);

1137 
	`Êush_w‹k
(&
rdev
->
de°roy_w‹k
);

1138 
	`Êush_w‹k
(&
rdev
->
¥›ag©e_ød¨_dëe˘_wk
);

1139 
	`Êush_w‹k
(&
rdev
->
¥›ag©e_ˇc_d⁄e_wk
);

1140 
	`Êush_w‹k
(&
rdev
->
mgmt_ªgi°øti⁄s_upd©e_wk
);

1141 
	`Êush_w‹k
(&
rdev
->
background_ˇc_ab‹t_wk
);

1143 
	`cfg80211_rdev_‰ì_wowœn
(
rdev
);

1144 
	`cfg80211_rdev_‰ì_cﬂÀs˚
(
rdev
);

1145 
	}
}

1146 
EXPORT_SYMBOL
(
wùhy_uƒegi°î
);

1148 
	$cfg80211_dev_‰ì
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

1150 
cfg80211_öã∫Æ_bss
 *
sˇn
, *
tmp
;

1151 
cfg80211_bóc⁄_ªgi°øti⁄
 *
ªg
, *
åeg
;

1152 
	`rfkûl_de°roy
(
rdev
->
wùhy
.
rfkûl
);

1153 
	`li°_f‹_óch_íåy_ß„
(
ªg
, 
åeg
, &
rdev
->
bóc⁄_ªgi°øti⁄s
, 
li°
) {

1154 
	`li°_dñ
(&
ªg
->
li°
);

1155 
	`k‰ì
(
ªg
);

1157 
	`li°_f‹_óch_íåy_ß„
(
sˇn
, 
tmp
, &
rdev
->
bss_li°
, 
li°
)

1158 
	`cfg80211_put_bss
(&
rdev
->
wùhy
, &
sˇn
->
pub
);

1159 
	`muãx_de°roy
(&
rdev
->
wùhy
.
mtx
);

1168 
	`k‰ì
(
	`rcu_dîe„ªn˚_øw
(
rdev
->
wùhy
.
ªgd
));

1170 
	`k‰ì
(
rdev
);

1171 
	}
}

1173 
	$wùhy_‰ì
(
wùhy
 *wiphy)

1175 
	`put_devi˚
(&
wùhy
->
dev
);

1176 
	}
}

1177 
EXPORT_SYMBOL
(
wùhy_‰ì
);

1179 
	$wùhy_rfkûl_£t_hw_°©e_ªas⁄
(
wùhy
 *wùhy, 
boﬁ
 
blocked
,

1180 
rfkûl_h¨d_block_ªas⁄s
 
ªas⁄
)

1182 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1184 i‡(
	`rfkûl_£t_hw_°©e_ªas⁄
(
wùhy
->
rfkûl
, 
blocked
, 
ªas⁄
))

1185 
	`scheduÀ_w‹k
(&
rdev
->
rfkûl_block
);

1186 
	}
}

1187 
EXPORT_SYMBOL
(
wùhy_rfkûl_£t_hw_°©e_ªas⁄
);

1189 
	$_cfg80211_uƒegi°î_wdev
(
wúñess_dev
 *
wdev
,

1190 
boﬁ
 
uƒegi°î_√tdev
)

1192 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1193 
cfg80211_cqm_c⁄fig
 *
cqm_c⁄fig
;

1194 
lök_id
;

1196 
	`ASSERT_RTNL
();

1197 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1199 
	`∆80211_nŸify_iÁ˚
(
rdev
, 
wdev
, 
NL80211_CMD_DEL_INTERFACE
);

1201 
wdev
->
ªgi°îed
 = 
Ál£
;

1203 i‡(
wdev
->
√tdev
) {

1204 
	`sysfs_ªmove_lök
(&
wdev
->
√tdev
->
dev
.
kobj
, "phy80211");

1205 i‡(
uƒegi°î_√tdev
)

1206 
	`uƒegi°î_√tdevi˚
(
wdev
->
√tdev
);

1209 
	`li°_dñ_rcu
(&
wdev
->
li°
);

1210 
	`synchr⁄ize_√t
();

1211 
rdev
->
devli°_gíî©i⁄
++;

1213 
	`cfg80211_mlme_purge_ªgi°øti⁄s
(
wdev
);

1215 
wdev
->
i·y≥
) {

1216 
NL80211_IFTYPE_P2P_DEVICE
:

1217 
	`cfg80211_°›_p2p_devi˚
(
rdev
, 
wdev
);

1219 
NL80211_IFTYPE_NAN
:

1220 
	`cfg80211_°›_«n
(
rdev
, 
wdev
);

1226 #ifde‡
CONFIG_CFG80211_WEXT


1227 
	`k‰ì_£nsôive
(
wdev
->
wext
.
keys
);

1228 
wdev
->
wext
.
keys
 = 
NULL
;

1230 
	`wùhy_w‹k_ˇn˚l
(
wdev
->
wùhy
, &wdev->
cqm_rssi_w‹k
);

1232 
cqm_c⁄fig
 = 
	`rcu_ac˚ss_poöãr
(
wdev
->cqm_config);

1233 
	`k‰ì_rcu
(
cqm_c⁄fig
, 
rcu_hód
);

1239 
	`cfg80211_¥o˚ss_wdev_evíts
(
wdev
);

1241 i‡(
wdev
->
i·y≥
 =
NL80211_IFTYPE_STATION
 ||

1242 
wdev
->
i·y≥
 =
NL80211_IFTYPE_P2P_CLIENT
) {

1243 
lök_id
 = 0;Üök_id < 
	`ARRAY_SIZE
(
wdev
->
löks
);Üink_id++) {

1244 
cfg80211_öã∫Æ_bss
 *
curbss
;

1246 
curbss
 = 
wdev
->
löks
[
lök_id
].
˛õ¡
.
cuºít_bss
;

1248 i‡(
	`WARN_ON
(
curbss
)) {

1249 
	`cfg80211_unhﬁd_bss
(
curbss
);

1250 
	`cfg80211_put_bss
(
wdev
->
wùhy
, &
curbss
->
pub
);

1251 
wdev
->
löks
[
lök_id
].
˛õ¡
.
cuºít_bss
 = 
NULL
;

1256 
wdev
->
c⁄√˘ed
 = 
Ál£
;

1257 
	}
}

1259 
	$cfg80211_uƒegi°î_wdev
(
wúñess_dev
 *
wdev
)

1261 
	`_cfg80211_uƒegi°î_wdev
(
wdev
, 
åue
);

1262 
	}
}

1263 
EXPORT_SYMBOL
(
cfg80211_uƒegi°î_wdev
);

1265 c⁄° 
devi˚_ty≥
 
	gwùhy_ty≥
 = {

1266 .
«me
 = "wlan",

1269 
	$cfg80211_upd©e_iÁ˚_num
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1270 
∆80211_i·y≥
 
i·y≥
, 
num
)

1272 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1274 
rdev
->
num_ru¬ög_iÁ˚s
 +
num
;

1275 i‡(
i·y≥
 =
NL80211_IFTYPE_MONITOR
)

1276 
rdev
->
num_ru¬ög_m⁄ô‹_iÁ˚s
 +
num
;

1277 
	}
}

1279 
	$cfg80211_Àave
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1280 
wúñess_dev
 *
wdev
)

1282 
√t_devi˚
 *
dev
 = 
wdev
->
√tdev
;

1283 
cfg80211_sched_sˇn_ªque°
 *
pos
, *
tmp
;

1285 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1287 
	`cfg80211_pm§_wdev_down
(
wdev
);

1289 
	`cfg80211_°›_background_ød¨_dëe˘i⁄
(
wdev
);

1291 
wdev
->
i·y≥
) {

1292 
NL80211_IFTYPE_ADHOC
:

1293 
	`cfg80211_Àave_ibss
(
rdev
, 
dev
, 
åue
);

1295 
NL80211_IFTYPE_P2P_CLIENT
:

1296 
NL80211_IFTYPE_STATION
:

1297 
	`li°_f‹_óch_íåy_ß„
(
pos
, 
tmp
, &
rdev
->
sched_sˇn_ªq_li°
,

1298 
li°
) {

1299 i‡(
dev
 =
pos
->dev)

1300 
	`cfg80211_°›_sched_sˇn_ªq
(
rdev
, 
pos
, 
Ál£
);

1303 #ifde‡
CONFIG_CFG80211_WEXT


1304 
	`k‰ì
(
wdev
->
wext
.
õ
);

1305 
wdev
->
wext
.
õ
 = 
NULL
;

1306 
wdev
->
wext
.
õ_Àn
 = 0;

1307 
wdev
->
wext
.
c⁄√˘
.
auth_ty≥
 = 
NL80211_AUTHTYPE_AUTOMATIC
;

1309 
	`cfg80211_disc⁄√˘
(
rdev
, 
dev
,

1310 
WLAN_REASON_DEAUTH_LEAVING
, 
åue
);

1312 
NL80211_IFTYPE_MESH_POINT
:

1313 
	`cfg80211_Àave_mesh
(
rdev
, 
dev
);

1315 
NL80211_IFTYPE_AP
:

1316 
NL80211_IFTYPE_P2P_GO
:

1317 
	`cfg80211_°›_≠
(
rdev
, 
dev
, -1, 
åue
);

1319 
NL80211_IFTYPE_OCB
:

1320 
	`cfg80211_Àave_ocb
(
rdev
, 
dev
);

1322 
NL80211_IFTYPE_P2P_DEVICE
:

1323 
NL80211_IFTYPE_NAN
:

1326 
NL80211_IFTYPE_AP_VLAN
:

1327 
NL80211_IFTYPE_MONITOR
:

1330 
NL80211_IFTYPE_UNSPECIFIED
:

1331 
NL80211_IFTYPE_WDS
:

1332 
NUM_NL80211_IFTYPES
:

1336 
	}
}

1338 
	$cfg80211_°›_iÁ˚
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

1339 
gÂ_t
 
gÂ
)

1341 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1342 
cfg80211_evít
 *
ev
;

1343 
Êags
;

1345 
	`åa˚_cfg80211_°›_iÁ˚
(
wùhy
, 
wdev
);

1347 
ev
 = 
	`kzÆloc
((*ev), 
gÂ
);

1348 i‡(!
ev
)

1351 
ev
->
ty≥
 = 
EVENT_STOPPED
;

1353 
	`•ö_lock_úqßve
(&
wdev
->
evít_lock
, 
Êags
);

1354 
	`li°_add_èû
(&
ev
->
li°
, &
wdev
->
evít_li°
);

1355 
	`•ö_u∆ock_úqª°‹e
(&
wdev
->
evít_lock
, 
Êags
);

1356 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
evít_w‹k
);

1357 
	}
}

1358 
EXPORT_SYMBOL
(
cfg80211_°›_iÁ˚
);

1360 
	$cfg80211_öô_wdev
(
wúñess_dev
 *
wdev
)

1362 
	`INIT_LIST_HEAD
(&
wdev
->
evít_li°
);

1363 
	`•ö_lock_öô
(&
wdev
->
evít_lock
);

1364 
	`INIT_LIST_HEAD
(&
wdev
->
mgmt_ªgi°øti⁄s
);

1365 
	`INIT_LIST_HEAD
(&
wdev
->
pm§_li°
);

1366 
	`•ö_lock_öô
(&
wdev
->
pm§_lock
);

1367 
	`INIT_WORK
(&
wdev
->
pm§_‰ì_wk
, 
cfg80211_pm§_‰ì_wk
);

1369 #ifde‡
CONFIG_CFG80211_WEXT


1370 
wdev
->
wext
.
deÁu…_key
 = -1;

1371 
wdev
->
wext
.
deÁu…_mgmt_key
 = -1;

1372 
wdev
->
wext
.
c⁄√˘
.
auth_ty≥
 = 
NL80211_AUTHTYPE_AUTOMATIC
;

1375 
	`wùhy_w‹k_öô
(&
wdev
->
cqm_rssi_w‹k
, 
cfg80211_cqm_rssi_nŸify_w‹k
);

1377 i‡(
wdev
->
wùhy
->
Êags
 & 
WIPHY_FLAG_PS_ON_BY_DEFAULT
)

1378 
wdev
->
ps
 = 
åue
;

1380 
wdev
->
ps
 = 
Ál£
;

1382 
wdev
->
ps_timeout
 = -1;

1384 i‡((
wdev
->
i·y≥
 =
NL80211_IFTYPE_STATION
 ||

1385 
wdev
->
i·y≥
 =
NL80211_IFTYPE_P2P_CLIENT
 ||

1386 
wdev
->
i·y≥
 =
NL80211_IFTYPE_ADHOC
Ë&& !wdev->
u£_4addr
)

1387 
wdev
->
√tdev
->
¥iv_Êags
 |
IFF_DONT_BRIDGE
;

1389 
	`INIT_WORK
(&
wdev
->
disc⁄√˘_wk
, 
cfg80211_autodisc⁄√˘_wk
);

1390 
	}
}

1392 
	$cfg80211_ªgi°î_wdev
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1393 
wúñess_dev
 *
wdev
)

1395 
	`ASSERT_RTNL
();

1396 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1405 i‡(!
wdev
->
idítifõr
)

1406 
wdev
->
idítifõr
 = ++
rdev
->
wdev_id
;

1407 
	`li°_add_rcu
(&
wdev
->
li°
, &
rdev
->
wùhy
.
wdev_li°
);

1408 
rdev
->
devli°_gíî©i⁄
++;

1409 
wdev
->
ªgi°îed
 = 
åue
;

1411 i‡(
wdev
->
√tdev
 &&

1412 
	`sysfs_¸óã_lök
(&
wdev
->
√tdev
->
dev
.
kobj
, &
rdev
->
wùhy
.dev.kobj,

1414 
	`¥_îr
("failedÅoáddÖhy80211 symlinkÅoÇetdev!\n");

1416 
	`∆80211_nŸify_iÁ˚
(
rdev
, 
wdev
, 
NL80211_CMD_NEW_INTERFACE
);

1417 
	}
}

1419 
	$cfg80211_ªgi°î_√tdevi˚
(
√t_devi˚
 *
dev
)

1421 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1422 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

1423 
ªt
;

1425 
	`ASSERT_RTNL
();

1427 i‡(
	`WARN_ON
(!
wdev
))

1428  -
EINVAL
;

1430 
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1432 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1435 
wdev
->
ªgi°îed
 = 
åue
;

1436 
wdev
->
ªgi°îög
 = 
åue
;

1437 
ªt
 = 
	`ªgi°î_√tdevi˚
(
dev
);

1438 i‡(
ªt
)

1439 
out
;

1441 
	`cfg80211_ªgi°î_wdev
(
rdev
, 
wdev
);

1442 
ªt
 = 0;

1443 
out
:

1444 
wdev
->
ªgi°îög
 = 
Ál£
;

1445 i‡(
ªt
)

1446 
wdev
->
ªgi°îed
 = 
Ál£
;

1447  
ªt
;

1448 
	}
}

1449 
EXPORT_SYMBOL
(
cfg80211_ªgi°î_√tdevi˚
);

1451 
	$cfg80211_√tdev_nŸifõr_ˇŒ
(
nŸifõr_block
 *
nb
,

1452 
°©e
, *
±r
)

1454 
√t_devi˚
 *
dev
 = 
	`√tdev_nŸifõr_öfo_to_dev
(
±r
);

1455 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1456 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

1457 
cfg80211_sched_sˇn_ªque°
 *
pos
, *
tmp
;

1459 i‡(!
wdev
)

1460  
NOTIFY_DONE
;

1462 
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1464 
	`WARN_ON
(
wdev
->
i·y≥
 =
NL80211_IFTYPE_UNSPECIFIED
);

1466 
°©e
) {

1467 
NETDEV_POST_INIT
:

1468 
	`SET_NETDEV_DEVTYPE
(
dev
, &
wùhy_ty≥
);

1469 
wdev
->
√tdev
 = 
dev
;

1471 
dev
->
„©uªs
 |
NETIF_F_NETNS_LOCAL
;

1473 
	`cfg80211_öô_wdev
(
wdev
);

1475 
NETDEV_REGISTER
:

1476 i‡(!
wdev
->
ªgi°îed
) {

1477 
	`wùhy_lock
(&
rdev
->
wùhy
);

1478 
	`cfg80211_ªgi°î_wdev
(
rdev
, 
wdev
);

1479 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1482 
NETDEV_UNREGISTER
:

1487 i‡(
wdev
->
ªgi°îed
 && !wdev->
ªgi°îög
) {

1488 
	`wùhy_lock
(&
rdev
->
wùhy
);

1489 
	`_cfg80211_uƒegi°î_wdev
(
wdev
, 
Ál£
);

1490 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1493 
NETDEV_GOING_DOWN
:

1494 
	`wùhy_lock
(&
rdev
->
wùhy
);

1495 
	`cfg80211_Àave
(
rdev
, 
wdev
);

1496 
	`cfg80211_ªmove_löks
(
wdev
);

1497 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1499 
	`ˇn˚l_w‹k_sync
(&
wdev
->
disc⁄√˘_wk
);

1500 
	`ˇn˚l_w‹k_sync
(&
wdev
->
pm§_‰ì_wk
);

1502 
NETDEV_DOWN
:

1503 
	`wùhy_lock
(&
rdev
->
wùhy
);

1504 
	`cfg80211_upd©e_iÁ˚_num
(
rdev
, 
wdev
->
i·y≥
, -1);

1505 i‡(
rdev
->
sˇn_ªq
 &&Ñdev->sˇn_ªq->
wdev
 == wdev) {

1506 i‡(
	`WARN_ON
(!
rdev
->
sˇn_ªq
->
nŸifõd
 &&

1507 (!
rdev
->
öt_sˇn_ªq
 ||

1508 !
rdev
->
öt_sˇn_ªq
->
nŸifõd
)))

1509 
rdev
->
sˇn_ªq
->
öfo
.
ab‹ãd
 = 
åue
;

1510 
	`___cfg80211_sˇn_d⁄e
(
rdev
, 
Ál£
);

1513 
	`li°_f‹_óch_íåy_ß„
(
pos
, 
tmp
,

1514 &
rdev
->
sched_sˇn_ªq_li°
, 
li°
) {

1515 i‡(
	`WARN_ON
(
pos
->
dev
 =
wdev
->
√tdev
))

1516 
	`cfg80211_°›_sched_sˇn_ªq
(
rdev
, 
pos
, 
Ál£
);

1519 
rdev
->
›ícou¡
--;

1520 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1521 
	`wake_up
(&
rdev
->
dev_waô
);

1523 
NETDEV_UP
:

1524 
	`wùhy_lock
(&
rdev
->
wùhy
);

1525 
	`cfg80211_upd©e_iÁ˚_num
(
rdev
, 
wdev
->
i·y≥
, 1);

1526 
wdev
->
i·y≥
) {

1527 #ifde‡
CONFIG_CFG80211_WEXT


1528 
NL80211_IFTYPE_ADHOC
:

1529 
	`cfg80211_ibss_wext_joö
(
rdev
, 
wdev
);

1531 
NL80211_IFTYPE_STATION
:

1532 
	`cfg80211_mgd_wext_c⁄√˘
(
rdev
, 
wdev
);

1535 #ifde‡
CONFIG_MAC80211_MESH


1536 
NL80211_IFTYPE_MESH_POINT
:

1539 
mesh_£tup
 
£tup
;

1540 
	`mem˝y
(&
£tup
, &
deÁu…_mesh_£tup
,

1541 (
£tup
));

1543 
£tup
.
mesh_id
 = 
wdev
->
u
.
mesh
.
id
;

1544 
£tup
.
mesh_id_Àn
 = 
wdev
->
u
.
mesh
.
id_up_Àn
;

1545 i‡(
wdev
->
u
.
mesh
.
id_up_Àn
)

1546 
	`__cfg80211_joö_mesh
(
rdev
, 
dev
,

1547 &
£tup
,

1548 &
deÁu…_mesh_c⁄fig
);

1555 
rdev
->
›ícou¡
++;

1561 i‡((
wdev
->
i·y≥
 =
NL80211_IFTYPE_STATION
 ||

1562 
wdev
->
i·y≥
 =
NL80211_IFTYPE_P2P_CLIENT
) &&

1563 
rdev
->
›s
->
£t_powî_mgmt
 &&

1564 
	`rdev_£t_powî_mgmt
(
rdev
, 
dev
, 
wdev
->
ps
,

1565 
wdev
->
ps_timeout
)) {

1567 
wdev
->
ps
 = 
Ál£
;

1569 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1571 
NETDEV_PRE_UP
:

1572 i‡(!
	`cfg80211_i·y≥_Ælowed
(
wdev
->
wùhy
, wdev->
i·y≥
,

1573 
wdev
->
u£_4addr
, 0))

1574  
	`nŸifõr_‰om_î∫o
(-
EOPNOTSUPP
);

1576 i‡(
	`rfkûl_blocked
(
rdev
->
wùhy
.
rfkûl
))

1577  
	`nŸifõr_‰om_î∫o
(-
ERFKILL
);

1580  
NOTIFY_DONE
;

1583 
	`wúñess_∆evít_Êush
();

1585  
NOTIFY_OK
;

1586 
	}
}

1588 
nŸifõr_block
 
	gcfg80211_√tdev_nŸifõr
 = {

1589 .
nŸifõr_ˇŒ
 = 
cfg80211_√tdev_nŸifõr_ˇŒ
,

1592 
__√t_exô
 
	$cfg80211_≥∫ë_exô
(
√t
 *net)

1594 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

1596 
	`π∆_lock
();

1597 
	`f‹_óch_rdev
(
rdev
) {

1598 i‡(
	`√t_eq
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
√t
))

1599 
	`WARN_ON
(
	`cfg80211_swôch_√äs
(
rdev
, &
öô_√t
));

1601 
	`π∆_u∆ock
();

1602 
	}
}

1604 
≥∫ë_›î©i⁄s
 
	gcfg80211_≥∫ë_›s
 = {

1605 .
exô
 = 
cfg80211_≥∫ë_exô
,

1608 
	$wùhy_w‹k_queue
(
wùhy
 *wùhy, 
wùhy_w‹k
 *
w‹k
)

1610 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1611 
Êags
;

1613 
	`•ö_lock_úqßve
(&
rdev
->
wùhy_w‹k_lock
, 
Êags
);

1614 i‡(
	`li°_em±y
(&
w‹k
->
íåy
))

1615 
	`li°_add_èû
(&
w‹k
->
íåy
, &
rdev
->
wùhy_w‹k_li°
);

1616 
	`•ö_u∆ock_úqª°‹e
(&
rdev
->
wùhy_w‹k_lock
, 
Êags
);

1618 
	`queue_w‹k
(
sy°em_unbound_wq
, &
rdev
->
wùhy_w‹k
);

1619 
	}
}

1620 
EXPORT_SYMBOL_GPL
(
wùhy_w‹k_queue
);

1622 
	$wùhy_w‹k_ˇn˚l
(
wùhy
 *wùhy, 
wùhy_w‹k
 *
w‹k
)

1624 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1625 
Êags
;

1627 
	`lockdï_as£π_hñd
(&
wùhy
->
mtx
);

1629 
	`•ö_lock_úqßve
(&
rdev
->
wùhy_w‹k_lock
, 
Êags
);

1630 i‡(!
	`li°_em±y
(&
w‹k
->
íåy
))

1631 
	`li°_dñ_öô
(&
w‹k
->
íåy
);

1632 
	`•ö_u∆ock_úqª°‹e
(&
rdev
->
wùhy_w‹k_lock
, 
Êags
);

1633 
	}
}

1634 
EXPORT_SYMBOL_GPL
(
wùhy_w‹k_ˇn˚l
);

1636 
	$wùhy_w‹k_Êush
(
wùhy
 *wùhy, 
wùhy_w‹k
 *
w‹k
)

1638 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1639 
Êags
;

1640 
boﬁ
 
run
;

1642 
	`•ö_lock_úqßve
(&
rdev
->
wùhy_w‹k_lock
, 
Êags
);

1643 
run
 = !
w‹k
 || !
	`li°_em±y
(&w‹k->
íåy
);

1644 
	`•ö_u∆ock_úqª°‹e
(&
rdev
->
wùhy_w‹k_lock
, 
Êags
);

1646 i‡(
run
)

1647 
	`cfg80211_¥o˚ss_wùhy_w‹ks
(
rdev
, 
w‹k
);

1648 
	}
}

1649 
EXPORT_SYMBOL_GPL
(
wùhy_w‹k_Êush
);

1651 
	$wùhy_dñayed_w‹k_timî
(
timî_li°
 *
t
)

1653 
wùhy_dñayed_w‹k
 *
dw‹k
 = 
	`‰om_timî
(dw‹k, 
t
, 
timî
);

1655 
	`wùhy_w‹k_queue
(
dw‹k
->
wùhy
, &dw‹k->
w‹k
);

1656 
	}
}

1657 
EXPORT_SYMBOL
(
wùhy_dñayed_w‹k_timî
);

1659 
	$wùhy_dñayed_w‹k_queue
(
wùhy
 *wiphy,

1660 
wùhy_dñayed_w‹k
 *
dw‹k
,

1661 
dñay
)

1663 i‡(!
dñay
) {

1664 
	`dñ_timî
(&
dw‹k
->
timî
);

1665 
	`wùhy_w‹k_queue
(
wùhy
, &
dw‹k
->
w‹k
);

1669 
dw‹k
->
wùhy
 = wiphy;

1670 
	`mod_timî
(&
dw‹k
->
timî
, 
jiffõs
 + 
dñay
);

1671 
	}
}

1672 
EXPORT_SYMBOL_GPL
(
wùhy_dñayed_w‹k_queue
);

1674 
	$wùhy_dñayed_w‹k_ˇn˚l
(
wùhy
 *wiphy,

1675 
wùhy_dñayed_w‹k
 *
dw‹k
)

1677 
	`lockdï_as£π_hñd
(&
wùhy
->
mtx
);

1679 
	`dñ_timî_sync
(&
dw‹k
->
timî
);

1680 
	`wùhy_w‹k_ˇn˚l
(
wùhy
, &
dw‹k
->
w‹k
);

1681 
	}
}

1682 
EXPORT_SYMBOL_GPL
(
wùhy_dñayed_w‹k_ˇn˚l
);

1684 
	$wùhy_dñayed_w‹k_Êush
(
wùhy
 *wiphy,

1685 
wùhy_dñayed_w‹k
 *
dw‹k
)

1687 
	`lockdï_as£π_hñd
(&
wùhy
->
mtx
);

1689 
	`dñ_timî_sync
(&
dw‹k
->
timî
);

1690 
	`wùhy_w‹k_Êush
(
wùhy
, &
dw‹k
->
w‹k
);

1691 
	}
}

1692 
EXPORT_SYMBOL_GPL
(
wùhy_dñayed_w‹k_Êush
);

1694 
__öô
 
	$cfg80211_öô
()

1696 
îr
;

1698 
îr
 = 
	`ªgi°î_≥∫ë_devi˚
(&
cfg80211_≥∫ë_›s
);

1699 i‡(
îr
)

1700 
out_Áû_≥∫ë
;

1702 
îr
 = 
	`wùhy_sysfs_öô
();

1703 i‡(
îr
)

1704 
out_Áû_sysfs
;

1706 
îr
 = 
	`ªgi°î_√tdevi˚_nŸifõr
(&
cfg80211_√tdev_nŸifõr
);

1707 i‡(
îr
)

1708 
out_Áû_nŸifõr
;

1710 
îr
 = 
	`∆80211_öô
();

1711 i‡(
îr
)

1712 
out_Áû_∆80211
;

1714 
õì80211_debugfs_dú
 = 
	`debugfs_¸óã_dú
("õì80211", 
NULL
);

1716 
îr
 = 
	`ªguœt‹y_öô
();

1717 i‡(
îr
)

1718 
out_Áû_ªg
;

1720 
cfg80211_wq
 = 
	`Æloc_‹dîed_w‹kqueue
("cfg80211", 
WQ_MEM_RECLAIM
);

1721 i‡(!
cfg80211_wq
) {

1722 
îr
 = -
ENOMEM
;

1723 
out_Áû_wq
;

1728 
out_Áû_wq
:

1729 
	`ªguœt‹y_exô
();

1730 
out_Áû_ªg
:

1731 
	`debugfs_ªmove
(
õì80211_debugfs_dú
);

1732 
	`∆80211_exô
();

1733 
out_Áû_∆80211
:

1734 
	`uƒegi°î_√tdevi˚_nŸifõr
(&
cfg80211_√tdev_nŸifõr
);

1735 
out_Áû_nŸifõr
:

1736 
	`wùhy_sysfs_exô
();

1737 
out_Áû_sysfs
:

1738 
	`uƒegi°î_≥∫ë_devi˚
(&
cfg80211_≥∫ë_›s
);

1739 
out_Áû_≥∫ë
:

1740  
îr
;

1741 
	}
}

1742 
fs_öôˇŒ
(
cfg80211_öô
);

1744 
__exô
 
	$cfg80211_exô
()

1746 
	`debugfs_ªmove
(
õì80211_debugfs_dú
);

1747 
	`∆80211_exô
();

1748 
	`uƒegi°î_√tdevi˚_nŸifõr
(&
cfg80211_√tdev_nŸifõr
);

1749 
	`wùhy_sysfs_exô
();

1750 
	`ªguœt‹y_exô
();

1751 
	`uƒegi°î_≥∫ë_devi˚
(&
cfg80211_≥∫ë_›s
);

1752 
	`de°roy_w‹kqueue
(
cfg80211_wq
);

1753 
	}
}

1754 
moduÀ_exô
(
cfg80211_exô
);

	@core.h

8 #i‚de‡
__NET_WIRELESS_CORE_H


9 
	#__NET_WIRELESS_CORE_H


	)

10 
	~<löux/li°.h
>

11 
	~<löux/√tdevi˚.h
>

12 
	~<löux/rbåì.h
>

13 
	~<löux/debugfs.h
>

14 
	~<löux/rfkûl.h
>

15 
	~<löux/w‹kqueue.h
>

16 
	~<löux/π√éök.h
>

17 
	~<√t/gíëlök.h
>

18 
	~<√t/cfg80211.h
>

19 
	~"ªg.h
"

22 
	#WIPHY_IDX_INVALID
 -1

	)

24 
	scfg80211_ªgi°îed_devi˚
 {

25 c⁄° 
cfg80211_›s
 *
	m›s
;

26 
li°_hód
 
	mli°
;

29 
rfkûl_›s
 
	mrfkûl_›s
;

30 
w‹k_°ru˘
 
	mrfkûl_block
;

38 
	mcou¡ry_õ_Æpha2
[2];

45 c⁄° 
õì80211_ªgdomaö
 *
	mªque°ed_ªgd
;

49 
ívú⁄mít_ˇp
 
	mív
;

52 
	mwùhy_idx
;

55 
	mdevli°_gíî©i⁄
, 
	mwdev_id
;

56 
	m›ícou¡
;

57 
waô_queue_hód_t
 
	mdev_waô
;

59 
li°_hód
 
	mbóc⁄_ªgi°øti⁄s
;

60 
•ölock_t
 
	mbóc⁄_ªgi°øti⁄s_lock
;

63 
	mnum_ru¬ög_iÁ˚s
;

64 
	mnum_ru¬ög_m⁄ô‹_iÁ˚s
;

65 
u64
 
	mcookõ_cou¡î
;

68 
•ölock_t
 
	mbss_lock
;

69 
li°_hód
 
	mbss_li°
;

70 
rb_roŸ
 
	mbss_åì
;

71 
u32
 
	mbss_gíî©i⁄
;

72 
u32
 
	mbss_íåõs
;

73 
cfg80211_sˇn_ªque°
 *
	msˇn_ªq
;

74 
cfg80211_sˇn_ªque°
 *
	möt_sˇn_ªq
;

75 
sk_buff
 *
	msˇn_msg
;

76 
li°_hód
 
	msched_sˇn_ªq_li°
;

77 
time64_t
 
	msu•íd_©
;

78 
wùhy_w‹k
 
	msˇn_d⁄e_wk
;

80 
gíl_öfo
 *
	mcur_cmd_öfo
;

82 
w‹k_°ru˘
 
	mc⁄n_w‹k
;

83 
w‹k_°ru˘
 
	mevít_w‹k
;

85 
dñayed_w‹k
 
	mdfs_upd©e_ch™√ls_wk
;

87 
wúñess_dev
 *
	mbackground_ød¨_wdev
;

88 
cfg80211_ch™_def
 
	mbackground_ød¨_ch™def
;

89 
dñayed_w‹k
 
	mbackground_ˇc_d⁄e_wk
;

90 
w‹k_°ru˘
 
	mbackground_ˇc_ab‹t_wk
;

93 
u32
 
	m¸ô_¥Ÿo_∆p‹tid
;

95 
cfg80211_cﬂÀs˚
 *
	mcﬂÀs˚
;

97 
w‹k_°ru˘
 
	mde°roy_w‹k
;

98 
wùhy_w‹k
 
	msched_sˇn_°›_wk
;

99 
w‹k_°ru˘
 
	msched_sˇn_ªs_wk
;

101 
cfg80211_ch™_def
 
	mød¨_ch™def
;

102 
w‹k_°ru˘
 
	m¥›ag©e_ød¨_dëe˘_wk
;

104 
cfg80211_ch™_def
 
	mˇc_d⁄e_ch™def
;

105 
w‹k_°ru˘
 
	m¥›ag©e_ˇc_d⁄e_wk
;

107 
w‹k_°ru˘
 
	mmgmt_ªgi°øti⁄s_upd©e_wk
;

109 
•ölock_t
 
	mmgmt_ªgi°øti⁄s_lock
;

111 
w‹k_°ru˘
 
	mwùhy_w‹k
;

112 
li°_hód
 
	mwùhy_w‹k_li°
;

114 
•ölock_t
 
	mwùhy_w‹k_lock
;

115 
boﬁ
 
	msu•íded
;

119 
wùhy
 wùhy 
__Æig√d
(
NETDEV_ALIGN
);

122 
ölöe


123 
cfg80211_ªgi°îed_devi˚
 *
	$wùhy_to_rdev
(
wùhy
 *wiphy)

125 
	`BUG_ON
(!
wùhy
);

126  
	`c⁄èöî_of
(
wùhy
, 
cfg80211_ªgi°îed_devi˚
, wiphy);

127 
	}
}

129 
ölöe
 

130 
	$cfg80211_rdev_‰ì_wowœn
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

132 #ifde‡
CONFIG_PM


133 
i
;

135 i‡(!
rdev
->
wùhy
.
wowœn_c⁄fig
)

137 
i
 = 0; i < 
rdev
->
wùhy
.
wowœn_c⁄fig
->
n_∑âîns
; i++)

138 
	`k‰ì
(
rdev
->
wùhy
.
wowœn_c⁄fig
->
∑âîns
[
i
].
mask
);

139 
	`k‰ì
(
rdev
->
wùhy
.
wowœn_c⁄fig
->
∑âîns
);

140 i‡(
rdev
->
wùhy
.
wowœn_c⁄fig
->
t˝
 &&

141 
rdev
->
wùhy
.
wowœn_c⁄fig
->
t˝
->
sock
)

142 
	`sock_ªÀa£
(
rdev
->
wùhy
.
wowœn_c⁄fig
->
t˝
->
sock
);

143 
	`k‰ì
(
rdev
->
wùhy
.
wowœn_c⁄fig
->
t˝
);

144 
	`k‰ì
(
rdev
->
wùhy
.
wowœn_c⁄fig
->
nd_c⁄fig
);

145 
	`k‰ì
(
rdev
->
wùhy
.
wowœn_c⁄fig
);

147 
	}
}

149 
ölöe
 
u64
 
	$cfg80211_assign_cookõ
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

151 
u64
 
r
 = ++
rdev
->
cookõ_cou¡î
;

153 i‡(
	`WARN_ON
(
r
 == 0))

154 
r
 = ++
rdev
->
cookõ_cou¡î
;

156  
r
;

157 
	}
}

159 
w‹kqueue_°ru˘
 *
cfg80211_wq
;

160 
li°_hód
 
cfg80211_rdev_li°
;

161 
cfg80211_rdev_li°_gíî©i⁄
;

164 
ölöe
 
	$f‹_óch_rdev_check_π∆
()

166 
	`ASSERT_RTNL
();

168 
	}
}

169 
	#f‹_óch_rdev
(
rdev
) \

170 i‡(
	`f‹_óch_rdev_check_π∆
()) {} \

171 
	`li°_f‹_óch_íåy
(
rdev
, &
cfg80211_rdev_li°
, 
li°
)

	)

173 
	scfg80211_öã∫Æ_bss
 {

174 
li°_hód
 
	mli°
;

175 
li°_hód
 
	mhiddí_li°
;

176 
rb_node
 
	mrbn
;

177 
u64
 
	mts_boŸtime
;

178 
	mts
;

179 
	mªfcou¡
;

180 
©omic_t
 
	mhﬁd
;

186 
u64
 
	m∑ª¡_tsf
;

192 
u8
 
	m∑ª¡_bssid
[
ETH_ALEN
] 
__Æig√d
(2);

195 
cfg80211_bss
 
	mpub
;

198 
ölöe
 
cfg80211_öã∫Æ_bss
 *
	$bss_‰om_pub
(
cfg80211_bss
 *
pub
)

200  
	`c⁄èöî_of
(
pub
, 
cfg80211_öã∫Æ_bss
,Öub);

201 
	}
}

203 
ölöe
 
	$cfg80211_hﬁd_bss
(
cfg80211_öã∫Æ_bss
 *
bss
)

205 
	`©omic_öc
(&
bss
->
hﬁd
);

206 i‡(
bss
->
pub
.
å™smôãd_bss
) {

207 
bss
 = 
	`c⁄èöî_of
(bss->
pub
.
å™smôãd_bss
,

208 
cfg80211_öã∫Æ_bss
, 
pub
);

209 
	`©omic_öc
(&
bss
->
hﬁd
);

211 
	}
}

213 
ölöe
 
	$cfg80211_unhﬁd_bss
(
cfg80211_öã∫Æ_bss
 *
bss
)

215 
r
 = 
	`©omic_dec_ªtu∫
(&
bss
->
hﬁd
);

216 
	`WARN_ON
(
r
 < 0);

217 i‡(
bss
->
pub
.
å™smôãd_bss
) {

218 
bss
 = 
	`c⁄èöî_of
(bss->
pub
.
å™smôãd_bss
,

219 
cfg80211_öã∫Æ_bss
, 
pub
);

220 
r
 = 
	`©omic_dec_ªtu∫
(&
bss
->
hﬁd
);

221 
	`WARN_ON
(
r
 < 0);

223 
	}
}

226 
cfg80211_ªgi°îed_devi˚
 *
cfg80211_rdev_by_wùhy_idx
(
wùhy_idx
);

227 
gë_wùhy_idx
(
wùhy
 *wiphy);

229 
wùhy
 *
wùhy_idx_to_wùhy
(
wùhy_idx
);

231 
cfg80211_swôch_√äs
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

232 
√t
 *net);

234 
cfg80211_öô_wdev
(
wúñess_dev
 *
wdev
);

235 
cfg80211_ªgi°î_wdev
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

236 
wúñess_dev
 *
wdev
);

238 
ölöe
 
boﬁ
 
	$cfg80211_has_m⁄ô‹s_⁄ly
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

240 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

242  
rdev
->
num_ru¬ög_iÁ˚s
 =rdev->
num_ru¬ög_m⁄ô‹_iÁ˚s
 &&

243 
rdev
->
num_ru¬ög_iÁ˚s
 > 0;

244 
	}
}

246 
	ecfg80211_evít_ty≥
 {

247 
	mEVENT_CONNECT_RESULT
,

248 
	mEVENT_ROAMED
,

249 
	mEVENT_DISCONNECTED
,

250 
	mEVENT_IBSS_JOINED
,

251 
	mEVENT_STOPPED
,

252 
	mEVENT_PORT_AUTHORIZED
,

255 
	scfg80211_evít
 {

256 
li°_hód
 
	mli°
;

257 
cfg80211_evít_ty≥
 
	mty≥
;

260 
cfg80211_c⁄√˘_ª•_∑øms
 
	m¸
;

261 
cfg80211_rﬂm_öfo
 
	mrm
;

263 c⁄° 
u8
 *
	mõ
;

264 
size_t
 
	mõ_Àn
;

265 
u16
 
	mªas⁄
;

266 
boﬁ
 
	mloˇŒy_gíî©ed
;

267 } 
	mdc
;

269 
u8
 
	mbssid
[
ETH_ALEN
];

270 
õì80211_ch™√l
 *
	mch™√l
;

271 } 
	mij
;

273 
u8
 
	m≥î_addr
[
ETH_ALEN
];

274 c⁄° 
u8
 *
	mtd_bôm≠
;

275 
u8
 
	mtd_bôm≠_Àn
;

276 } 
	m∑
;

280 
	scfg80211_ˇched_keys
 {

281 
key_∑øms
 
	m∑øms
[4];

282 
u8
 
	md©a
[4][
WLAN_KEY_LEN_WEP104
];

283 
	mdef
;

286 
	scfg80211_bóc⁄_ªgi°øti⁄
 {

287 
li°_hód
 
	mli°
;

288 
u32
 
	m∆p‹tid
;

291 
	scfg80211_cqm_c⁄fig
 {

292 
rcu_hód
 
	mrcu_hód
;

293 
u32
 
	mrssi_hy°
;

294 
s32
 
	mœ°_rssi_evít_vÆue
;

295 
∆80211_cqm_rssi_thªshﬁd_evít
 
	mœ°_rssi_evít_ty≥
;

296 
boﬁ
 
	mu£_ønge_≠i
;

297 
	mn_rssi_thªshﬁds
;

298 
s32
 
	mrssi_thªshﬁds
[] 
__cou¡ed_by
(
n_rssi_thªshﬁds
);

301 
cfg80211_cqm_rssi_nŸify_w‹k
(
wùhy
 *wiphy,

302 
wùhy_w‹k
 *
w‹k
);

304 
cfg80211_de°roy_iÁ˚s
(
cfg80211_ªgi°îed_devi˚
 *
rdev
);

307 
cfg80211_dev_‰ì
(
cfg80211_ªgi°îed_devi˚
 *
rdev
);

309 
cfg80211_dev_ª«me
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

310 *
√w«me
);

312 
õì80211_£t_bôøã_Êags
(
wùhy
 *wiphy);

314 
cfg80211_bss_expúe
(
cfg80211_ªgi°îed_devi˚
 *
rdev
);

315 
cfg80211_bss_age
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

316 
age_£cs
);

317 
cfg80211_upd©e_assoc_bss_íåy
(
wúñess_dev
 *
wdev
,

318 
lök
,

319 
õì80211_ch™√l
 *
ch™√l
);

322 
__cfg80211_joö_ibss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

323 
√t_devi˚
 *
dev
,

324 
cfg80211_ibss_∑øms
 *
∑øms
,

325 
cfg80211_ˇched_keys
 *
c⁄nkeys
);

326 
cfg80211_˛ór_ibss
(
√t_devi˚
 *
dev
, 
boﬁ
 
nowext
);

327 
cfg80211_Àave_ibss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

328 
√t_devi˚
 *
dev
, 
boﬁ
 
nowext
);

329 
__cfg80211_ibss_joöed
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
bssid
,

330 
õì80211_ch™√l
 *
ch™√l
);

331 
cfg80211_ibss_wext_joö
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

332 
wúñess_dev
 *
wdev
);

335 c⁄° 
mesh_c⁄fig
 
deÁu…_mesh_c⁄fig
;

336 c⁄° 
mesh_£tup
 
deÁu…_mesh_£tup
;

337 
__cfg80211_joö_mesh
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

338 
√t_devi˚
 *
dev
,

339 
mesh_£tup
 *
£tup
,

340 c⁄° 
mesh_c⁄fig
 *
c⁄f
);

341 
cfg80211_Àave_mesh
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

342 
√t_devi˚
 *
dev
);

343 
cfg80211_£t_mesh_ch™√l
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

344 
wúñess_dev
 *
wdev
,

345 
cfg80211_ch™_def
 *
ch™def
);

348 
cfg80211_joö_ocb
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

349 
√t_devi˚
 *
dev
,

350 
ocb_£tup
 *
£tup
);

351 
cfg80211_Àave_ocb
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

352 
√t_devi˚
 *
dev
);

355 
cfg80211_°›_≠
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

356 
√t_devi˚
 *
dev
, 
lök
,

357 
boﬁ
 
nŸify
);

360 
cfg80211_mlme_auth
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

361 
√t_devi˚
 *
dev
,

362 
cfg80211_auth_ªque°
 *
ªq
);

363 
cfg80211_mlme_assoc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

364 
√t_devi˚
 *
dev
,

365 
cfg80211_assoc_ªque°
 *
ªq
,

366 
√éök_ext_ack
 *
exèck
);

367 
cfg80211_mlme_dóuth
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

368 
√t_devi˚
 *
dev
, c⁄° 
u8
 *
bssid
,

369 c⁄° 
u8
 *
õ
, 
õ_Àn
, 
u16
 
ªas⁄
,

370 
boﬁ
 
loˇl_°©e_ch™ge
);

371 
cfg80211_mlme_dißssoc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

372 
√t_devi˚
 *
dev
, c⁄° 
u8
 *
≠_addr
,

373 c⁄° 
u8
 *
õ
, 
õ_Àn
, 
u16
 
ªas⁄
,

374 
boﬁ
 
loˇl_°©e_ch™ge
);

375 
cfg80211_mlme_down
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

376 
√t_devi˚
 *
dev
);

377 
cfg80211_mlme_ªgi°î_mgmt
(
wúñess_dev
 *
wdev
, 
u32
 
¢d_pid
,

378 
u16
 
‰ame_ty≥
, c⁄° 
u8
 *
m©ch_d©a
,

379 
m©ch_Àn
, 
boﬁ
 
mu…iˇ°_rx
,

380 
√éök_ext_ack
 *
exèck
);

381 
cfg80211_mgmt_ªgi°øti⁄s_upd©e_wk
(
w‹k_°ru˘
 *
wk
);

382 
cfg80211_mlme_uƒegi°î_sockë
(
wúñess_dev
 *
wdev
, 
u32
 
∆pid
);

383 
cfg80211_mlme_purge_ªgi°øti⁄s
(
wúñess_dev
 *
wdev
);

384 
cfg80211_mlme_mgmt_tx
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

385 
wúñess_dev
 *
wdev
,

386 
cfg80211_mgmt_tx_∑øms
 *
∑øms
,

387 
u64
 *
cookõ
);

388 
cfg80211_›î_™d_ht_ˇ∑
(
õì80211_ht_ˇp
 *
ht_ˇ∑
,

389 c⁄° 
õì80211_ht_ˇp
 *
ht_ˇ∑_mask
);

390 
cfg80211_›î_™d_vht_ˇ∑
(
õì80211_vht_ˇp
 *
vht_ˇ∑
,

391 c⁄° 
õì80211_vht_ˇp
 *
vht_ˇ∑_mask
);

394 
cfg80211_c⁄√˘
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

395 
√t_devi˚
 *
dev
,

396 
cfg80211_c⁄√˘_∑øms
 *
c⁄√˘
,

397 
cfg80211_ˇched_keys
 *
c⁄nkeys
,

398 c⁄° 
u8
 *
¥ev_bssid
);

399 
__cfg80211_c⁄√˘_ªsu…
(
√t_devi˚
 *
dev
,

400 
cfg80211_c⁄√˘_ª•_∑øms
 *
∑øms
,

401 
boﬁ
 
wexãv
);

402 
__cfg80211_disc⁄√˘ed
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
õ
,

403 
size_t
 
õ_Àn
, 
u16
 
ªas⁄
, 
boﬁ
 
‰om_≠
);

404 
cfg80211_disc⁄√˘
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

405 
√t_devi˚
 *
dev
, 
u16
 
ªas⁄
,

406 
boﬁ
 
wexãv
);

407 
__cfg80211_rﬂmed
(
wúñess_dev
 *
wdev
,

408 
cfg80211_rﬂm_öfo
 *
öfo
);

409 
__cfg80211_p‹t_auth‹ized
(
wúñess_dev
 *
wdev
, c⁄° 
u8
 *
≥î_addr
,

410 c⁄° 
u8
 *
td_bôm≠
, u8 
td_bôm≠_Àn
);

411 
cfg80211_mgd_wext_c⁄√˘
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

412 
wúñess_dev
 *
wdev
);

413 
cfg80211_autodisc⁄√˘_wk
(
w‹k_°ru˘
 *
w‹k
);

416 
cfg80211_c⁄n_w‹k
(
w‹k_°ru˘
 *
w‹k
);

417 
cfg80211_sme_sˇn_d⁄e
(
√t_devi˚
 *
dev
);

418 
boﬁ
 
cfg80211_sme_rx_assoc_ª•
(
wúñess_dev
 *
wdev
, 
u16
 
°©us
);

419 
cfg80211_sme_rx_auth
(
wúñess_dev
 *
wdev
, c⁄° 
u8
 *
buf
, 
size_t
 
Àn
);

420 
cfg80211_sme_dißssoc
(
wúñess_dev
 *
wdev
);

421 
cfg80211_sme_dóuth
(
wúñess_dev
 *
wdev
);

422 
cfg80211_sme_auth_timeout
(
wúñess_dev
 *
wdev
);

423 
cfg80211_sme_assoc_timeout
(
wúñess_dev
 *
wdev
);

424 
cfg80211_sme_ab™d⁄_assoc
(
wúñess_dev
 *
wdev
);

427 
boﬁ
 
cfg80211_suµ‹ãd_cùhî_suôe
(
wùhy
 *wùhy, 
u32
 
cùhî
);

428 
boﬁ
 
cfg80211_vÆid_key_idx
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

429 
key_idx
, 
boﬁ
 
∑úwi£
);

430 
cfg80211_vÆid©e_key_£âögs
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

431 
key_∑øms
 *
∑øms
, 
key_idx
,

432 
boﬁ
 
∑úwi£
, c⁄° 
u8
 *
mac_addr
);

433 
__cfg80211_sˇn_d⁄e
(
wùhy
 *wùhy, 
wùhy_w‹k
 *
wk
);

434 
___cfg80211_sˇn_d⁄e
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

435 
boﬁ
 
£nd_mesßge
);

436 
cfg80211_add_sched_sˇn_ªq
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

437 
cfg80211_sched_sˇn_ªque°
 *
ªq
);

438 
cfg80211_sched_sˇn_ªq_possibÀ
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

439 
boﬁ
 
w™t_mu…i
);

440 
cfg80211_sched_sˇn_ªsu…s_wk
(
w‹k_°ru˘
 *
w‹k
);

441 
cfg80211_°›_sched_sˇn_ªq
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

442 
cfg80211_sched_sˇn_ªque°
 *
ªq
,

443 
boﬁ
 
drivî_öôüãd
);

444 
__cfg80211_°›_sched_sˇn
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

445 
u64
 
ªqid
, 
boﬁ
 
drivî_öôüãd
);

446 
cfg80211_u∂ﬂd_c⁄√˘_keys
(
wúñess_dev
 *
wdev
);

447 
cfg80211_ch™ge_iÁ˚
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

448 
√t_devi˚
 *
dev
, 
∆80211_i·y≥
 
¡y≥
,

449 
vif_∑øms
 *
∑øms
);

450 
cfg80211_¥o˚ss_rdev_evíts
(
cfg80211_ªgi°îed_devi˚
 *
rdev
);

451 
cfg80211_¥o˚ss_wùhy_w‹ks
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

452 
wùhy_w‹k
 *
íd
);

453 
cfg80211_¥o˚ss_wdev_evíts
(
wúñess_dev
 *
wdev
);

455 
boﬁ
 
cfg80211_d€s_bw_fô_ønge
(c⁄° 
õì80211_‰eq_ønge
 *
‰eq_ønge
,

456 
u32
 
˚¡î_‰eq_khz
, u32 
bw_khz
);

458 
cfg80211_sˇn
(
cfg80211_ªgi°îed_devi˚
 *
rdev
);

460 
w‹k_°ru˘
 
cfg80211_disc⁄√˘_w‹k
;

462 
	#NL80211_BSS_USE_FOR_ALL
 (
NL80211_BSS_USE_FOR_NORMAL
 | \

463 
NL80211_BSS_USE_FOR_MLD_LINK
)

	)

465 
cfg80211_£t_dfs_°©e
(
wùhy
 *wiphy,

466 c⁄° 
cfg80211_ch™_def
 *
ch™def
,

467 
∆80211_dfs_°©e
 
dfs_°©e
);

469 
cfg80211_dfs_ch™√ls_upd©e_w‹k
(
w‹k_°ru˘
 *
w‹k
);

471 
cfg80211_sched_dfs_ch™_upd©e
(
cfg80211_ªgi°îed_devi˚
 *
rdev
);

474 
cfg80211_°¨t_background_ød¨_dëe˘i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

475 
wúñess_dev
 *
wdev
,

476 
cfg80211_ch™_def
 *
ch™def
);

478 
cfg80211_°›_background_ød¨_dëe˘i⁄
(
wúñess_dev
 *
wdev
);

480 
cfg80211_background_ˇc_d⁄e_wk
(
w‹k_°ru˘
 *
w‹k
);

482 
cfg80211_background_ˇc_ab‹t_wk
(
w‹k_°ru˘
 *
w‹k
);

484 
boﬁ
 
cfg80211_™y_wùhy_›î_ch™
(
wùhy
 *wiphy,

485 
õì80211_ch™√l
 *
ch™
);

487 
boﬁ
 
cfg80211_bóc⁄ög_iÁ˚_a˘ive
(
wúñess_dev
 *
wdev
);

489 
boﬁ
 
cfg80211_is_sub_ch™
(
cfg80211_ch™_def
 *
ch™def
,

490 
õì80211_ch™√l
 *
ch™
,

491 
boﬁ
 
¥im¨y_⁄ly
);

492 
boﬁ
 
cfg80211_wdev_⁄_sub_ch™
(
wúñess_dev
 *
wdev
,

493 
õì80211_ch™√l
 *
ch™
,

494 
boﬁ
 
¥im¨y_⁄ly
);

495 
boﬁ
 
_cfg80211_ch™def_ußbÀ
(
wùhy
 *wiphy,

496 c⁄° 
cfg80211_ch™_def
 *
ch™def
,

497 
u32
 
¥ohibôed_Êags
, 
boﬁ
 
m⁄ô‹
);

499 
ölöe
 
	$ñ≠£d_jiffõs_m£cs
(
°¨t
)

501 
íd
 = 
jiffõs
;

503 i‡(
íd
 >
°¨t
)

504  
	`jiffõs_to_m£cs
(
íd
 - 
°¨t
);

506  
	`jiffõs_to_m£cs
(
íd
 + (
ULONG_MAX
 - 
°¨t
) + 1);

507 
	}
}

509 
cfg80211_£t_m⁄ô‹_ch™√l
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

510 
cfg80211_ch™_def
 *
ch™def
);

512 
õì80211_gë_øãmask
(
õì80211_suµ‹ãd_b™d
 *
sb™d
,

513 c⁄° 
u8
 *
øãs
, 
n_øãs
,

514 
u32
 *
mask
);

516 
cfg80211_vÆid©e_bóc⁄_öt
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

517 
∆80211_i·y≥
 
i·y≥
, 
u32
 
bóc⁄_öt
);

519 
cfg80211_upd©e_iÁ˚_num
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

520 
∆80211_i·y≥
 
i·y≥
, 
num
);

522 
cfg80211_Àave
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

523 
wúñess_dev
 *
wdev
);

525 
cfg80211_°›_p2p_devi˚
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

526 
wúñess_dev
 *
wdev
);

528 
cfg80211_°›_«n
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

529 
wúñess_dev
 *
wdev
);

531 
cfg80211_öã∫Æ_bss
 *

532 
cfg80211_bss_upd©e
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

533 
cfg80211_öã∫Æ_bss
 *
tmp
,

534 
boﬁ
 
sig«l_vÆid
, 
ts
);

535 #ifde‡
CONFIG_CFG80211_DEVELOPER_WARNINGS


536 
	#CFG80211_DEV_WARN_ON
(
c⁄d
Ë
	`WARN_ON
(c⁄d)

	)

543 
	#CFG80211_DEV_WARN_ON
(
c⁄d
Ë({
boﬁ
 
__r
 = (c⁄d); __r; })

	)

546 
cfg80211_ªÀa£_pm§
(
wúñess_dev
 *
wdev
, 
u32
 
p‹tid
);

547 
cfg80211_pm§_wdev_down
(
wúñess_dev
 *
wdev
);

548 
cfg80211_pm§_‰ì_wk
(
w‹k_°ru˘
 *
w‹k
);

550 
cfg80211_ªmove_lök
(
wúñess_dev
 *
wdev
, 
lök_id
);

551 
cfg80211_ªmove_löks
(
wúñess_dev
 *
wdev
);

552 
cfg80211_ªmove_vútuÆ_ötf
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

553 
wúñess_dev
 *
wdev
);

554 
cfg80211_wdev_ªÀa£_lök_bs£s
(
wúñess_dev
 *
wdev
, 
u16
 
lök_mask
);

578 
	scfg80211_cﬁoˇãd_≠
 {

579 
li°_hód
 
	mli°
;

580 
u8
 
	mbssid
[
ETH_ALEN
];

581 
u8
 
	mssid
[
IEEE80211_MAX_SSID_LEN
];

582 
size_t
 
	mssid_Àn
;

583 
u32
 
	msh‹t_ssid
;

584 
u32
 
	m˚¡î_‰eq
;

585 
u8
 
	munsﬁicôed_¥obe
:1,

586 
	mo˘_ªcommíded
:1,

587 
	mßme_ssid
:1,

588 
	mmu…i_bss
:1,

589 
	må™smôãd_bssid
:1,

590 
	mcﬁoˇãd_ess
:1,

591 
	msh‹t_ssid_vÆid
:1;

592 
s8
 
	mpsd_20
;

595 #i‡
IS_ENABLED
(
CONFIG_CFG80211_KUNIT_TEST
)

596 
	#EXPORT_SYMBOL_IF_CFG80211_KUNIT
(
sym
Ë
	`EXPORT_SYMBOL_IF_KUNIT
(sym)

	)

597 
	#VISIBLE_IF_CFG80211_KUNIT


	)

598 
cfg80211_‰ì_cﬁoc_≠_li°
(
li°_hód
 *
cﬁoc_≠_li°
);

600 
cfg80211_∑r£_cﬁoˇãd_≠
(c⁄° 
cfg80211_bss_õs
 *
õs
,

601 
li°_hód
 *
li°
);

603 
size_t
 
cfg80211_gí_√w_õ
(c⁄° 
u8
 *
õ
, size_à
õÀn
,

604 c⁄° 
u8
 *
subõ
, 
size_t
 
subõ_Àn
,

605 
u8
 *
√w_õ
, 
size_t
 
√w_õ_Àn
);

607 
	#EXPORT_SYMBOL_IF_CFG80211_KUNIT
(
sym
)

	)

608 
	#VISIBLE_IF_CFG80211_KUNIT
 

	)

	@debugfs.c

10 
	~<löux/¶ab.h
>

11 
	~"c‹e.h
"

12 
	~"debugfs.h
"

14 
	#DEBUGFS_READONLY_FILE
(
«me
, 
buÊí
, 
fmt
, 
vÆue
...) \

15 
ssize_t
 
«me
## 
	`_ªad
(
fûe
 *fûe, 
__u£r
 *
u£rbuf
, \

16 
size_t
 
cou¡
, 
loff_t
 *
µos
) \

18 
wùhy
 *wùhy = 
fûe
->
¥iv©e_d©a
; \

19 
buf
[
buÊí
]; \

20 
ªs
; \

22 
ªs
 = 
	`s˙¥ötf
(
buf
, 
buÊí
, 
fmt
 "\n", ##
vÆue
); \

23  
	`sim∂e_ªad_‰om_buf„r
(
u£rbuf
, 
cou¡
, 
µos
, 
buf
, 
ªs
); \

26 c⁄° 
fûe_›î©i⁄s
 
«me
## 
_›s
 = { \

27 .
ªad
 = 
«me
## 
_ªad
, \

28 .
›í
 = 
sim∂e_›í
, \

29 .
Œ£ek
 = 
gíîic_fûe_Œ£ek
, \

30 }

	)

32 
DEBUGFS_READONLY_FILE
(
πs_thªshﬁd
, 20, "%d",

33 
wùhy
->
πs_thªshﬁd
);

34 
DEBUGFS_READONLY_FILE
(
‰agmíèti⁄_thªshﬁd
, 20, "%d",

35 
wùhy
->
‰ag_thªshﬁd
);

36 
DEBUGFS_READONLY_FILE
(
sh‹t_ªåy_limô
, 20, "%d",

37 
wùhy
->
ªåy_sh‹t
);

38 
DEBUGFS_READONLY_FILE
(
l⁄g_ªåy_limô
, 20, "%d",

39 
wùhy
->
ªåy_l⁄g
);

41 
	$ht_¥öt_ch™
(
õì80211_ch™√l
 *
ch™
,

42 *
buf
, 
buf_size
, 
off£t
)

44 i‡(
	`WARN_ON
(
off£t
 > 
buf_size
))

47 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

48  
	`s˙¥ötf
(
buf
 + 
off£t
,

49 
buf_size
 - 
off£t
,

51 
ch™
->
˚¡î_‰eq
);

53  
	`s˙¥ötf
(
buf
 + 
off£t
,

54 
buf_size
 - 
off£t
,

56 
ch™
->
˚¡î_‰eq
,

57 (
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_HT40MINUS
) ?

59 (
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_HT40PLUS
) ?

61 
	}
}

63 
ssize_t
 
	$ht40Ælow_m≠_ªad
(
fûe
 *file,

64 
__u£r
 *
u£r_buf
,

65 
size_t
 
cou¡
, 
loff_t
 *
µos
)

67 
wùhy
 *wùhy = 
fûe
->
¥iv©e_d©a
;

68 *
buf
;

69 
off£t
 = 0, 
buf_size
 = 
PAGE_SIZE
, 
i
;

70 
∆80211_b™d
 
b™d
;

71 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

72 
ssize_t
 
r
;

74 
buf
 = 
	`kzÆloc
(
buf_size
, 
GFP_KERNEL
);

75 i‡(!
buf
)

76  -
ENOMEM
;

78 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

79 
sb™d
 = 
wùhy
->
b™ds
[
b™d
];

80 i‡(!
sb™d
)

82 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++)

83 
off£t
 +
	`ht_¥öt_ch™
(&
sb™d
->
ch™√ls
[
i
],

84 
buf
, 
buf_size
, 
off£t
);

87 
r
 = 
	`sim∂e_ªad_‰om_buf„r
(
u£r_buf
, 
cou¡
, 
µos
, 
buf
, 
off£t
);

89 
	`k‰ì
(
buf
);

91  
r
;

92 
	}
}

94 c⁄° 
fûe_›î©i⁄s
 
	ght40Ælow_m≠_›s
 = {

95 .
ªad
 = 
ht40Ælow_m≠_ªad
,

96 .
	g›í
 = 
sim∂e_›í
,

97 .
	gŒ£ek
 = 
deÁu…_Œ£ek
,

100 
	#DEBUGFS_ADD
(
«me
) \

101 
	`debugfs_¸óã_fûe
(#«me, 0444, 
phyd
, &
rdev
->
wùhy
, &
«me
## 
_›s
)

	)

103 
	$cfg80211_debugfs_rdev_add
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

105 
díåy
 *
phyd
 = 
rdev
->
wùhy
.
debugfsdú
;

107 
	`DEBUGFS_ADD
(
πs_thªshﬁd
);

108 
	`DEBUGFS_ADD
(
‰agmíèti⁄_thªshﬁd
);

109 
	`DEBUGFS_ADD
(
sh‹t_ªåy_limô
);

110 
	`DEBUGFS_ADD
(
l⁄g_ªåy_limô
);

111 
	`DEBUGFS_ADD
(
ht40Ælow_m≠
);

112 
	}
}

114 
	sdebugfs_ªad_w‹k
 {

115 
wùhy_w‹k
 
	mw‹k
;

116 
ssize_t
 (*
h™dÀr
)(
wùhy
 *
	mwùhy
,

117 
fûe
 *
	mfûe
,

118 *
	mbuf
,

119 
size_t
 
	mcou¡
,

120 *
	md©a
);

121 
wùhy
 *
	mwùhy
;

122 
fûe
 *
	mfûe
;

123 *
	mbuf
;

124 
size_t
 
	mbufsize
;

125 *
	md©a
;

126 
ssize_t
 
	mªt
;

127 
com∂ëi⁄
 
	mcom∂ëi⁄
;

130 
	$wùhy_locked_debugfs_ªad_w‹k
(
wùhy
 *wiphy,

131 
wùhy_w‹k
 *
w‹k
)

133 
debugfs_ªad_w‹k
 *
w
 = 
	`c⁄èöî_of
(
w‹k
, 
	`ty≥of
(*w), work);

135 
w
->
ªt
 = w->
	`h™dÀr
(w->
wùhy
, w->
fûe
, w->
buf
, w->
bufsize
, w->
d©a
);

136 
	`com∂ëe
(&
w
->
com∂ëi⁄
);

137 
	}
}

139 
	$wùhy_locked_debugfs_ªad_ˇn˚l
(
díåy
 *dentry,

140 *
d©a
)

142 
debugfs_ªad_w‹k
 *
w
 = 
d©a
;

144 
	`wùhy_w‹k_ˇn˚l
(
w
->
wùhy
, &w->
w‹k
);

145 
	`com∂ëe
(&
w
->
com∂ëi⁄
);

146 
	}
}

148 
ssize_t
 
	$wùhy_locked_debugfs_ªad
(
wùhy
 *wùhy, 
fûe
 *file,

149 *
buf
, 
size_t
 
bufsize
,

150 
__u£r
 *
u£rbuf
, 
size_t
 
cou¡
,

151 
loff_t
 *
µos
,

152 
	$ssize_t
 (*
h™dÀr
)(
wùhy
 *wiphy,

153 
fûe
 *file,

154 *
buf
,

155 
size_t
 
bufsize
,

156 *
d©a
),

157 *
d©a
)

159 
debugfs_ªad_w‹k
 
w‹k
 = {

160 .
h™dÀr
 = handler,

161 .
wùhy
 = wiphy,

162 .
fûe
 = file,

163 .
buf
 = buf,

164 .
bufsize
 = bufsize,

165 .
d©a
 = data,

166 .
ªt
 = -
ENODEV
,

167 .
com∂ëi⁄
 = 
	`COMPLETION_INITIALIZER_ONSTACK
(
w‹k
.completion),

169 
debugfs_ˇn˚Œ©i⁄
 
ˇn˚Œ©i⁄
 = {

170 .
ˇn˚l
 = 
wùhy_locked_debugfs_ªad_ˇn˚l
,

171 .
ˇn˚l_d©a
 = &
w‹k
,

175 
	`mem£t
(
buf
, 0, 
bufsize
);

177 
	`wùhy_w‹k_öô
(&
w‹k
.w‹k, 
wùhy_locked_debugfs_ªad_w‹k
);

178 
	`wùhy_w‹k_queue
(
wùhy
, &
w‹k
.work);

180 
	`debugfs_íãr_ˇn˚Œ©i⁄
(
fûe
, &
ˇn˚Œ©i⁄
);

181 
	`waô_f‹_com∂ëi⁄
(&
w‹k
.
com∂ëi⁄
);

182 
	`debugfs_Àave_ˇn˚Œ©i⁄
(
fûe
, &
ˇn˚Œ©i⁄
);

184 i‡(
w‹k
.
ªt
 < 0)

185  
w‹k
.
ªt
;

187 i‡(
	`WARN_ON
(
w‹k
.
ªt
 > 
bufsize
))

188  -
EINVAL
;

190  
	`sim∂e_ªad_‰om_buf„r
(
u£rbuf
, 
cou¡
, 
µos
, 
buf
, 
w‹k
.
ªt
);

191 
	}
}

192 
EXPORT_SYMBOL_GPL
(
wùhy_locked_debugfs_ªad
);

194 
	sdebugfs_wrôe_w‹k
 {

195 
wùhy_w‹k
 
	mw‹k
;

196 
ssize_t
 (*
h™dÀr
)(
wùhy
 *
	mwùhy
,

197 
fûe
 *
	mfûe
,

198 *
	mbuf
,

199 
size_t
 
	mcou¡
,

200 *
	md©a
);

201 
wùhy
 *
	mwùhy
;

202 
fûe
 *
	mfûe
;

203 *
	mbuf
;

204 
size_t
 
	mcou¡
;

205 *
	md©a
;

206 
ssize_t
 
	mªt
;

207 
com∂ëi⁄
 
	mcom∂ëi⁄
;

210 
	$wùhy_locked_debugfs_wrôe_w‹k
(
wùhy
 *wiphy,

211 
wùhy_w‹k
 *
w‹k
)

213 
debugfs_wrôe_w‹k
 *
w
 = 
	`c⁄èöî_of
(
w‹k
, 
	`ty≥of
(*w), work);

215 
w
->
ªt
 = w->
	`h™dÀr
(w->
wùhy
, w->
fûe
, w->
buf
, w->
cou¡
, w->
d©a
);

216 
	`com∂ëe
(&
w
->
com∂ëi⁄
);

217 
	}
}

219 
	$wùhy_locked_debugfs_wrôe_ˇn˚l
(
díåy
 *dentry,

220 *
d©a
)

222 
debugfs_wrôe_w‹k
 *
w
 = 
d©a
;

224 
	`wùhy_w‹k_ˇn˚l
(
w
->
wùhy
, &w->
w‹k
);

225 
	`com∂ëe
(&
w
->
com∂ëi⁄
);

226 
	}
}

228 
ssize_t
 
	$wùhy_locked_debugfs_wrôe
(
wùhy
 *wiphy,

229 
fûe
 *fûe, *
buf
, 
size_t
 
bufsize
,

230 c⁄° 
__u£r
 *
u£rbuf
, 
size_t
 
cou¡
,

231 
	$ssize_t
 (*
h™dÀr
)(
wùhy
 *wiphy,

232 
fûe
 *file,

233 *
buf
,

234 
size_t
 
cou¡
,

235 *
d©a
),

236 *
d©a
)

238 
debugfs_wrôe_w‹k
 
w‹k
 = {

239 .
h™dÀr
 = handler,

240 .
wùhy
 = wiphy,

241 .
fûe
 = file,

242 .
buf
 = buf,

243 .
cou¡
 = count,

244 .
d©a
 = data,

245 .
ªt
 = -
ENODEV
,

246 .
com∂ëi⁄
 = 
	`COMPLETION_INITIALIZER_ONSTACK
(
w‹k
.completion),

248 
debugfs_ˇn˚Œ©i⁄
 
ˇn˚Œ©i⁄
 = {

249 .
ˇn˚l
 = 
wùhy_locked_debugfs_wrôe_ˇn˚l
,

250 .
ˇn˚l_d©a
 = &
w‹k
,

254 i‡(
cou¡
 >
bufsize
)

255  -
EINVAL
;

257 
	`mem£t
(
buf
, 0, 
bufsize
);

259 i‡(
	`c›y_‰om_u£r
(
buf
, 
u£rbuf
, 
cou¡
))

260  -
EFAULT
;

262 
	`wùhy_w‹k_öô
(&
w‹k
.w‹k, 
wùhy_locked_debugfs_wrôe_w‹k
);

263 
	`wùhy_w‹k_queue
(
wùhy
, &
w‹k
.work);

265 
	`debugfs_íãr_ˇn˚Œ©i⁄
(
fûe
, &
ˇn˚Œ©i⁄
);

266 
	`waô_f‹_com∂ëi⁄
(&
w‹k
.
com∂ëi⁄
);

267 
	`debugfs_Àave_ˇn˚Œ©i⁄
(
fûe
, &
ˇn˚Œ©i⁄
);

269  
w‹k
.
ªt
;

270 
	}
}

271 
EXPORT_SYMBOL_GPL
(
wùhy_locked_debugfs_wrôe
);

	@debugfs.h

2 #i‚de‡
__CFG80211_DEBUGFS_H


3 
	#__CFG80211_DEBUGFS_H


	)

5 #ifde‡
CONFIG_CFG80211_DEBUGFS


6 
cfg80211_debugfs_rdev_add
(
cfg80211_ªgi°îed_devi˚
 *
rdev
);

8 
ölöe


9 
	$cfg80211_debugfs_rdev_add
(
cfg80211_ªgi°îed_devi˚
 *
rdev
Ë{
	}
}

	@ethtool.c

2 
	~<löux/ut¢ame.h
>

3 
	~<√t/cfg80211.h
>

4 
	~"c‹e.h
"

5 
	~"rdev-›s.h
"

7 
	$cfg80211_gë_drvöfo
(
√t_devi˚
 *
dev
, 
ëhtoﬁ_drvöfo
 *
öfo
)

9 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

10 
devi˚
 *
pdev
 = 
	`wùhy_dev
(
wdev
->
wùhy
);

12 i‡(
pdev
->
drivî
)

13 
	`°rs˝y
(
öfo
->
drivî
, 
pdev
->drivî->
«me
,

14 (
öfo
->
drivî
));

16 
	`°rs˝y
(
öfo
->
drivî
, "N/A", (info->driver));

18 
	`°rs˝y
(
öfo
->
vîsi⁄
, 
	`öô_ut¢ame
()->
ªÀa£
, (info->version));

20 i‡(
wdev
->
wùhy
->
fw_vîsi⁄
[0])

21 
	`°rs˝y
(
öfo
->
fw_vîsi⁄
, 
wdev
->
wùhy
->fw_version,

22 (
öfo
->
fw_vîsi⁄
));

24 
	`°rs˝y
(
öfo
->
fw_vîsi⁄
, "N/A", (info->fw_version));

26 
	`°rs˝y
(
öfo
->
bus_öfo
, 
	`dev_«me
(
	`wùhy_dev
(
wdev
->
wùhy
)),

27 (
öfo
->
bus_öfo
));

28 
	}
}

29 
EXPORT_SYMBOL
(
cfg80211_gë_drvöfo
);

	@ibss.c

9 
	~<löux/ëhîdevi˚.h
>

10 
	~<löux/if_¨p.h
>

11 
	~<löux/¶ab.h
>

12 
	~<löux/exp‹t.h
>

13 
	~<√t/cfg80211.h
>

14 
	~"wext-com∑t.h
"

15 
	~"∆80211.h
"

16 
	~"rdev-›s.h
"

19 
	$__cfg80211_ibss_joöed
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
bssid
,

20 
õì80211_ch™√l
 *
ch™√l
)

22 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

23 
cfg80211_bss
 *
bss
;

24 #ifde‡
CONFIG_CFG80211_WEXT


25 
iwªq_d©a
 
wrqu
;

28 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
))

31 i‡(!
wdev
->
u
.
ibss
.
ssid_Àn
)

34 
bss
 = 
	`cfg80211_gë_bss
(
wdev
->
wùhy
, 
ch™√l
, 
bssid
, 
NULL
, 0,

35 
IEEE80211_BSS_TYPE_IBSS
, 
IEEE80211_PRIVACY_ANY
);

37 i‡(
	`WARN_ON
(!
bss
))

40 i‡(
wdev
->
u
.
ibss
.
cuºít_bss
) {

41 
	`cfg80211_unhﬁd_bss
(
wdev
->
u
.
ibss
.
cuºít_bss
);

42 
	`cfg80211_put_bss
(
wdev
->
wùhy
, &wdev->
u
.
ibss
.
cuºít_bss
->
pub
);

45 
	`cfg80211_hﬁd_bss
(
	`bss_‰om_pub
(
bss
));

46 
wdev
->
u
.
ibss
.
cuºít_bss
 = 
	`bss_‰om_pub
(
bss
);

48 
	`cfg80211_u∂ﬂd_c⁄√˘_keys
(
wdev
);

50 
	`∆80211_£nd_ibss_bssid
(
	`wùhy_to_rdev
(
wdev
->
wùhy
), 
dev
, 
bssid
,

51 
GFP_KERNEL
);

52 #ifde‡
CONFIG_CFG80211_WEXT


53 
	`mem£t
(&
wrqu
, 0, (wrqu));

54 
	`mem˝y
(
wrqu
.
≠_addr
.
ß_d©a
, 
bssid
, 
ETH_ALEN
);

55 
	`wúñess_£nd_evít
(
dev
, 
SIOCGIWAP
, &
wrqu
, 
NULL
);

57 
	}
}

59 
	$cfg80211_ibss_joöed
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
bssid
,

60 
õì80211_ch™√l
 *
ch™√l
, 
gÂ_t
 
gÂ
)

62 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

63 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

64 
cfg80211_evít
 *
ev
;

65 
Êags
;

67 
	`åa˚_cfg80211_ibss_joöed
(
dev
, 
bssid
, 
ch™√l
);

69 i‡(
	`WARN_ON
(!
ch™√l
))

72 
ev
 = 
	`kzÆloc
((*ev), 
gÂ
);

73 i‡(!
ev
)

76 
ev
->
ty≥
 = 
EVENT_IBSS_JOINED
;

77 
	`mem˝y
(
ev
->
ij
.
bssid
, bssid, 
ETH_ALEN
);

78 
ev
->
ij
.
ch™√l
 = channel;

80 
	`•ö_lock_úqßve
(&
wdev
->
evít_lock
, 
Êags
);

81 
	`li°_add_èû
(&
ev
->
li°
, &
wdev
->
evít_li°
);

82 
	`•ö_u∆ock_úqª°‹e
(&
wdev
->
evít_lock
, 
Êags
);

83 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
evít_w‹k
);

84 
	}
}

85 
EXPORT_SYMBOL
(
cfg80211_ibss_joöed
);

87 
	$__cfg80211_joö_ibss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

88 
√t_devi˚
 *
dev
,

89 
cfg80211_ibss_∑øms
 *
∑øms
,

90 
cfg80211_ˇched_keys
 *
c⁄nkeys
)

92 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

93 
îr
;

95 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

97 i‡(
wdev
->
u
.
ibss
.
ssid_Àn
)

98  -
EALREADY
;

100 i‡(!
∑øms
->
basic_øãs
) {

106 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

107 
∆80211_b™d
 
b™d
;

108 
u32
 
Êag
;

109 
j
;

111 
b™d
 = 
∑øms
->
ch™def
.
ch™
->band;

112 i‡(
b™d
 =
NL80211_BAND_5GHZ
 ||

113 
b™d
 =
NL80211_BAND_6GHZ
)

114 
Êag
 = 
IEEE80211_RATE_MANDATORY_A
;

116 
Êag
 = 
IEEE80211_RATE_MANDATORY_B
;

118 
sb™d
 = 
rdev
->
wùhy
.
b™ds
[
b™d
];

119 
j
 = 0; j < 
sb™d
->
n_bôøãs
; j++) {

120 i‡(
sb™d
->
bôøãs
[
j
].
Êags
 & 
Êag
)

121 
∑øms
->
basic_øãs
 |
	`BIT
(
j
);

125 i‡(
	`WARN_ON
(
c⁄nkeys
 && c⁄nkeys->
def
 < 0))

126  -
EINVAL
;

128 i‡(
	`WARN_ON
(
wdev
->
c⁄√˘_keys
))

129 
	`k‰ì_£nsôive
(
wdev
->
c⁄√˘_keys
);

130 
wdev
->
c⁄√˘_keys
 = 
c⁄nkeys
;

132 
wdev
->
u
.
ibss
.
ch™def
 = 
∑øms
->chandef;

133 i‡(
c⁄nkeys
) {

134 
∑øms
->
wï_keys
 = 
c⁄nkeys
->params;

135 
∑øms
->
wï_tx_key
 = 
c⁄nkeys
->
def
;

138 #ifde‡
CONFIG_CFG80211_WEXT


139 
wdev
->
wext
.
ibss
.
ch™def
 = 
∑øms
->chandef;

141 
îr
 = 
	`rdev_joö_ibss
(
rdev
, 
dev
, 
∑øms
);

142 i‡(
îr
) {

143 
wdev
->
c⁄√˘_keys
 = 
NULL
;

144  
îr
;

147 
	`mem˝y
(
wdev
->
u
.
ibss
.
ssid
, 
∑øms
->ssid,Ö¨ams->
ssid_Àn
);

148 
wdev
->
u
.
ibss
.
ssid_Àn
 = 
∑øms
->ssid_len;

151 
	}
}

153 
	$cfg80211_˛ór_ibss
(
√t_devi˚
 *
dev
, 
boﬁ
 
nowext
)

155 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

156 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

157 
i
;

159 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

161 
	`k‰ì_£nsôive
(
wdev
->
c⁄√˘_keys
);

162 
wdev
->
c⁄√˘_keys
 = 
NULL
;

164 
	`rdev_£t_qos_m≠
(
rdev
, 
dev
, 
NULL
);

170 i‡(
rdev
->
›s
->
dñ_key
)

171 
i
 = 0; i < 6; i++)

172 
	`rdev_dñ_key
(
rdev
, 
dev
, -1, 
i
, 
Ál£
, 
NULL
);

174 i‡(
wdev
->
u
.
ibss
.
cuºít_bss
) {

175 
	`cfg80211_unhﬁd_bss
(
wdev
->
u
.
ibss
.
cuºít_bss
);

176 
	`cfg80211_put_bss
(
wdev
->
wùhy
, &wdev->
u
.
ibss
.
cuºít_bss
->
pub
);

179 
wdev
->
u
.
ibss
.
cuºít_bss
 = 
NULL
;

180 
wdev
->
u
.
ibss
.
ssid_Àn
 = 0;

181 
	`mem£t
(&
wdev
->
u
.
ibss
.
ch™def
, 0, (wdev->u.ibss.chandef));

182 #ifde‡
CONFIG_CFG80211_WEXT


183 i‡(!
nowext
)

184 
wdev
->
wext
.
ibss
.
ssid_Àn
 = 0;

186 
	`cfg80211_sched_dfs_ch™_upd©e
(
rdev
);

187 
	}
}

189 
	$cfg80211_Àave_ibss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

190 
√t_devi˚
 *
dev
, 
boﬁ
 
nowext
)

192 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

193 
îr
;

195 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

197 i‡(!
wdev
->
u
.
ibss
.
ssid_Àn
)

198  -
ENOLINK
;

200 
îr
 = 
	`rdev_Àave_ibss
(
rdev
, 
dev
);

202 i‡(
îr
)

203  
îr
;

205 
wdev
->
c⁄n_ow√r_∆p‹tid
 = 0;

206 
	`cfg80211_˛ór_ibss
(
dev
, 
nowext
);

209 
	}
}

211 #ifde‡
CONFIG_CFG80211_WEXT


212 
	$cfg80211_ibss_wext_joö
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

213 
wúñess_dev
 *
wdev
)

215 
cfg80211_ˇched_keys
 *
ck
 = 
NULL
;

216 
∆80211_b™d
 
b™d
;

217 
i
, 
îr
;

219 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

221 i‡(!
wdev
->
wext
.
ibss
.
bóc⁄_öãrvÆ
)

222 
wdev
->
wext
.
ibss
.
bóc⁄_öãrvÆ
 = 100;

225 i‡(!
wdev
->
wext
.
ibss
.
ch™def
.
ch™
) {

226 
õì80211_ch™√l
 *
√w_ch™
 = 
NULL
;

228 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

229 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

230 
õì80211_ch™√l
 *
ch™
;

232 
sb™d
 = 
rdev
->
wùhy
.
b™ds
[
b™d
];

233 i‡(!
sb™d
)

236 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++) {

237 
ch™
 = &
sb™d
->
ch™√ls
[
i
];

238 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_IR
)

240 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

242 
√w_ch™
 = 
ch™
;

246 i‡(
√w_ch™
)

250 i‡(!
√w_ch™
)

251  -
EINVAL
;

253 
	`cfg80211_ch™def_¸óã
(&
wdev
->
wext
.
ibss
.
ch™def
, 
√w_ch™
,

254 
NL80211_CHAN_NO_HT
);

258 i‡(!
wdev
->
wext
.
ibss
.
ssid_Àn
)

261 i‡(!
	`√tif_ru¬ög
(
wdev
->
√tdev
))

264 i‡(
wdev
->
wext
.
keys
)

265 
wdev
->
wext
.
keys
->
def
 = wdev->wext.
deÁu…_key
;

267 
wdev
->
wext
.
ibss
.
¥ivacy
 = wdev->wext.
deÁu…_key
 != -1;

269 i‡(
wdev
->
wext
.
keys
 && wdev->wext.keys->
def
 != -1) {

270 
ck
 = 
	`kmemdup
(
wdev
->
wext
.
keys
, (*ck), 
GFP_KERNEL
);

271 i‡(!
ck
)

272  -
ENOMEM
;

273 
i
 = 0; i < 4; i++)

274 
ck
->
∑øms
[
i
].
key
 = ck->
d©a
[i];

276 
îr
 = 
	`__cfg80211_joö_ibss
(
rdev
, 
wdev
->
√tdev
,

277 &
wdev
->
wext
.
ibss
, 
ck
);

278 i‡(
îr
)

279 
	`k‰ì
(
ck
);

281  
îr
;

282 
	}
}

284 
	$cfg80211_ibss_wext_siw‰eq
(
√t_devi˚
 *
dev
,

285 
iw_ªque°_öfo
 *
öfo
,

286 
iw_‰eq
 *
wext‰eq
, *
exåa
)

288 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

289 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

290 
õì80211_ch™√l
 *
ch™
 = 
NULL
;

291 
îr
, 
‰eq
;

294 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
))

295  -
EINVAL
;

297 i‡(!
rdev
->
›s
->
joö_ibss
)

298  -
EOPNOTSUPP
;

300 
‰eq
 = 
	`cfg80211_wext_‰eq
(
wext‰eq
);

301 i‡(
‰eq
 < 0)

302  
‰eq
;

304 i‡(
‰eq
) {

305 
ch™
 = 
	`õì80211_gë_ch™√l
(
wdev
->
wùhy
, 
‰eq
);

306 i‡(!
ch™
)

307  -
EINVAL
;

308 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_IR
 ||

309 
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

310  -
EINVAL
;

313 i‡(
wdev
->
wext
.
ibss
.
ch™def
.
ch™
 == chan)

316 
îr
 = 0;

317 i‡(
wdev
->
u
.
ibss
.
ssid_Àn
)

318 
îr
 = 
	`cfg80211_Àave_ibss
(
rdev
, 
dev
, 
åue
);

320 i‡(
îr
)

321  
îr
;

323 i‡(
ch™
) {

324 
	`cfg80211_ch™def_¸óã
(&
wdev
->
wext
.
ibss
.
ch™def
, 
ch™
,

325 
NL80211_CHAN_NO_HT
);

326 
wdev
->
wext
.
ibss
.
ch™√l_fixed
 = 
åue
;

329 
wdev
->
wext
.
ibss
.
ch™√l_fixed
 = 
Ál£
;

332  
	`cfg80211_ibss_wext_joö
(
rdev
, 
wdev
);

333 
	}
}

335 
	$cfg80211_ibss_wext_giw‰eq
(
√t_devi˚
 *
dev
,

336 
iw_ªque°_öfo
 *
öfo
,

337 
iw_‰eq
 *
‰eq
, *
exåa
)

339 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

340 
õì80211_ch™√l
 *
ch™
 = 
NULL
;

343 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
))

344  -
EINVAL
;

346 i‡(
wdev
->
u
.
ibss
.
cuºít_bss
)

347 
ch™
 = 
wdev
->
u
.
ibss
.
cuºít_bss
->
pub
.
ch™√l
;

348 i‡(
wdev
->
wext
.
ibss
.
ch™def
.
ch™
)

349 
ch™
 = 
wdev
->
wext
.
ibss
.
ch™def
.chan;

351 i‡(
ch™
) {

352 
‰eq
->
m
 = 
ch™
->
˚¡î_‰eq
;

353 
‰eq
->
e
 = 6;

358  -
EINVAL
;

359 
	}
}

361 
	$cfg80211_ibss_wext_siwessid
(
√t_devi˚
 *
dev
,

362 
iw_ªque°_öfo
 *
öfo
,

363 
iw_poöt
 *
d©a
, *
ssid
)

365 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

366 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

367 
size_t
 
Àn
 = 
d©a
->
Àngth
;

368 
îr
;

371 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
))

372  -
EINVAL
;

374 i‡(!
rdev
->
›s
->
joö_ibss
)

375  -
EOPNOTSUPP
;

377 
îr
 = 0;

378 i‡(
wdev
->
u
.
ibss
.
ssid_Àn
)

379 
îr
 = 
	`cfg80211_Àave_ibss
(
rdev
, 
dev
, 
åue
);

381 i‡(
îr
)

382  
îr
;

385 i‡(
Àn
 > 0 && 
ssid
[len - 1] == '\0')

386 
Àn
--;

388 
	`mem˝y
(
wdev
->
u
.
ibss
.
ssid
, ssid, 
Àn
);

389 
wdev
->
wext
.
ibss
.
ssid
 = wdev->
u
.ibss.ssid;

390 
wdev
->
wext
.
ibss
.
ssid_Àn
 = 
Àn
;

392  
	`cfg80211_ibss_wext_joö
(
rdev
, 
wdev
);

393 
	}
}

395 
	$cfg80211_ibss_wext_giwessid
(
√t_devi˚
 *
dev
,

396 
iw_ªque°_öfo
 *
öfo
,

397 
iw_poöt
 *
d©a
, *
ssid
)

399 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

402 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
))

403  -
EINVAL
;

405 
d©a
->
Êags
 = 0;

407 i‡(
wdev
->
u
.
ibss
.
ssid_Àn
) {

408 
d©a
->
Êags
 = 1;

409 
d©a
->
Àngth
 = 
wdev
->
u
.
ibss
.
ssid_Àn
;

410 
	`mem˝y
(
ssid
, 
wdev
->
u
.
ibss
.ssid, 
d©a
->
Àngth
);

411 } i‡(
wdev
->
wext
.
ibss
.
ssid
 && wdev->wext.ibss.
ssid_Àn
) {

412 
d©a
->
Êags
 = 1;

413 
d©a
->
Àngth
 = 
wdev
->
wext
.
ibss
.
ssid_Àn
;

414 
	`mem˝y
(
ssid
, 
wdev
->
wext
.
ibss
.ssid, 
d©a
->
Àngth
);

418 
	}
}

420 
	$cfg80211_ibss_wext_siw≠
(
√t_devi˚
 *
dev
,

421 
iw_ªque°_öfo
 *
öfo
,

422 
sockaddr
 *
≠_addr
, *
exåa
)

424 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

425 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

426 
u8
 *
bssid
 = 
≠_addr
->
ß_d©a
;

427 
îr
;

430 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
))

431  -
EINVAL
;

433 i‡(!
rdev
->
›s
->
joö_ibss
)

434  -
EOPNOTSUPP
;

436 i‡(
≠_addr
->
ß_Ámûy
 !
ARPHRD_ETHER
)

437  -
EINVAL
;

440 i‡(
	`is_zîo_ëhî_addr
(
bssid
Ë|| 
	`is_brﬂdˇ°_ëhî_addr
(bssid))

441 
bssid
 = 
NULL
;

443 i‡(
bssid
 && !
	`is_vÆid_ëhî_addr
(bssid))

444  -
EINVAL
;

447 i‡(!
bssid
 && !
wdev
->
wext
.
ibss
.bssid)

451 i‡(
wdev
->
wext
.
ibss
.
bssid
 && bssid &&

452 
	`ëhî_addr_equÆ
(
bssid
, 
wdev
->
wext
.
ibss
.bssid))

455 
îr
 = 0;

456 i‡(
wdev
->
u
.
ibss
.
ssid_Àn
)

457 
îr
 = 
	`cfg80211_Àave_ibss
(
rdev
, 
dev
, 
åue
);

459 i‡(
îr
)

460  
îr
;

462 i‡(
bssid
) {

463 
	`mem˝y
(
wdev
->
wext
.
bssid
, bssid, 
ETH_ALEN
);

464 
wdev
->
wext
.
ibss
.
bssid
 = wdev->wext.bssid;

466 
wdev
->
wext
.
ibss
.
bssid
 = 
NULL
;

468  
	`cfg80211_ibss_wext_joö
(
rdev
, 
wdev
);

469 
	}
}

471 
	$cfg80211_ibss_wext_giw≠
(
√t_devi˚
 *
dev
,

472 
iw_ªque°_öfo
 *
öfo
,

473 
sockaddr
 *
≠_addr
, *
exåa
)

475 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

478 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
))

479  -
EINVAL
;

481 
≠_addr
->
ß_Ámûy
 = 
ARPHRD_ETHER
;

483 i‡(
wdev
->
u
.
ibss
.
cuºít_bss
)

484 
	`mem˝y
(
≠_addr
->
ß_d©a
, 
wdev
->
u
.
ibss
.
cuºít_bss
->
pub
.
bssid
,

485 
ETH_ALEN
);

486 i‡(
wdev
->
wext
.
ibss
.
bssid
)

487 
	`mem˝y
(
≠_addr
->
ß_d©a
, 
wdev
->
wext
.
ibss
.
bssid
, 
ETH_ALEN
);

489 
	`ëh_zîo_addr
(
≠_addr
->
ß_d©a
);

492 
	}
}

	@lib80211.c

17 
	#¥_fmt
(
fmt
Ë
KBUILD_MODNAME
 ": " 
	)
fmt

19 
	~<löux/moduÀ.h
>

20 
	~<löux/˘y≥.h
>

21 
	~<löux/õì80211.h
>

22 
	~<löux/î∫o.h
>

23 
	~<löux/öô.h
>

24 
	~<löux/¶ab.h
>

25 
	~<löux/°rög.h
>

27 
	~<√t/lib80211.h
>

29 
	#DRV_DESCRIPTION
 "comm⁄Ñoutöe†f‹ IEEE802.11 drivîs"

	)

31 
MODULE_DESCRIPTION
(
DRV_DESCRIPTION
);

32 
MODULE_AUTHOR
("John W. Linville <linville@tuxdriver.com>");

33 
MODULE_LICENSE
("GPL");

35 
	slib80211_¸y±o_Æg
 {

36 
li°_hód
 
	mli°
;

37 
lib80211_¸y±o_›s
 *
	m›s
;

40 
LIST_HEAD
(
lib80211_¸y±o_Ægs
);

41 
DEFINE_SPINLOCK
(
lib80211_¸y±o_lock
);

43 
lib80211_¸y±_deöô_íåõs
(
lib80211_¸y±_öfo
 *
öfo
,

44 
f‹˚
);

45 
lib80211_¸y±_quõscög
(
lib80211_¸y±_öfo
 *
öfo
);

46 
lib80211_¸y±_deöô_h™dÀr
(
timî_li°
 *
t
);

48 
	$lib80211_¸y±_öfo_öô
(
lib80211_¸y±_öfo
 *
öfo
, *
«me
,

49 
•ölock_t
 *
lock
)

51 
	`mem£t
(
öfo
, 0, (*info));

53 
öfo
->
«me
 =Çame;

54 
öfo
->
lock
 =Üock;

56 
	`INIT_LIST_HEAD
(&
öfo
->
¸y±_deöô_li°
);

57 
	`timî_£tup
(&
öfo
->
¸y±_deöô_timî
, 
lib80211_¸y±_deöô_h™dÀr
,

61 
	}
}

62 
EXPORT_SYMBOL
(
lib80211_¸y±_öfo_öô
);

64 
	$lib80211_¸y±_öfo_‰ì
(
lib80211_¸y±_öfo
 *
öfo
)

66 
i
;

68 
	`lib80211_¸y±_quõscög
(
öfo
);

69 
	`dñ_timî_sync
(&
öfo
->
¸y±_deöô_timî
);

70 
	`lib80211_¸y±_deöô_íåõs
(
öfo
, 1);

72 
i
 = 0; i < 
NUM_WEP_KEYS
; i++) {

73 
lib80211_¸y±_d©a
 *
¸y±
 = 
öfo
->¸y±[
i
];

74 i‡(
¸y±
) {

75 i‡(
¸y±
->
›s
) {

76 
¸y±
->
›s
->
	`deöô
(¸y±->
¥iv
);

77 
	`moduÀ_put
(
¸y±
->
›s
->
ow√r
);

79 
	`k‰ì
(
¸y±
);

80 
öfo
->
¸y±
[
i
] = 
NULL
;

83 
	}
}

84 
EXPORT_SYMBOL
(
lib80211_¸y±_öfo_‰ì
);

86 
	$lib80211_¸y±_deöô_íåõs
(
lib80211_¸y±_öfo
 *
öfo
,

87 
f‹˚
)

89 
lib80211_¸y±_d©a
 *
íåy
, *
√xt
;

90 
Êags
;

92 
	`•ö_lock_úqßve
(
öfo
->
lock
, 
Êags
);

93 
	`li°_f‹_óch_íåy_ß„
(
íåy
, 
√xt
, &
öfo
->
¸y±_deöô_li°
, 
li°
) {

94 i‡(
	`©omic_ªad
(&
íåy
->
ªf˙t
Ë!0 && !
f‹˚
)

97 
	`li°_dñ
(&
íåy
->
li°
);

99 i‡(
íåy
->
›s
) {

100 
íåy
->
›s
->
	`deöô
”¡ry->
¥iv
);

101 
	`moduÀ_put
(
íåy
->
›s
->
ow√r
);

103 
	`k‰ì
(
íåy
);

105 
	`•ö_u∆ock_úqª°‹e
(
öfo
->
lock
, 
Êags
);

106 
	}
}

109 
	$lib80211_¸y±_quõscög
(
lib80211_¸y±_öfo
 *
öfo
)

111 
Êags
;

113 
	`•ö_lock_úqßve
(
öfo
->
lock
, 
Êags
);

114 
öfo
->
¸y±_quõs˚d
 = 1;

115 
	`•ö_u∆ock_úqª°‹e
(
öfo
->
lock
, 
Êags
);

116 
	}
}

118 
	$lib80211_¸y±_deöô_h™dÀr
(
timî_li°
 *
t
)

120 
lib80211_¸y±_öfo
 *
öfo
 = 
	`‰om_timî
(öfo, 
t
,

121 
¸y±_deöô_timî
);

122 
Êags
;

124 
	`lib80211_¸y±_deöô_íåõs
(
öfo
, 0);

126 
	`•ö_lock_úqßve
(
öfo
->
lock
, 
Êags
);

127 i‡(!
	`li°_em±y
(&
öfo
->
¸y±_deöô_li°
Ë&& !öfo->
¸y±_quõs˚d
) {

128 
	`¥ötk
(
KERN_DEBUG
 "%s:ÉntriesÑemaining in delayed crypt "

129 "dñëi⁄Üi°\n", 
öfo
->
«me
);

130 
öfo
->
¸y±_deöô_timî
.
expúes
 = 
jiffõs
 + 
HZ
;

131 
	`add_timî
(&
öfo
->
¸y±_deöô_timî
);

133 
	`•ö_u∆ock_úqª°‹e
(
öfo
->
lock
, 
Êags
);

134 
	}
}

136 
	$lib80211_¸y±_dñayed_deöô
(
lib80211_¸y±_öfo
 *
öfo
,

137 
lib80211_¸y±_d©a
 **
¸y±
)

139 
lib80211_¸y±_d©a
 *
tmp
;

140 
Êags
;

142 i‡(*
¸y±
 =
NULL
)

145 
tmp
 = *
¸y±
;

146 *
¸y±
 = 
NULL
;

152 
	`•ö_lock_úqßve
(
öfo
->
lock
, 
Êags
);

153 i‡(!
öfo
->
¸y±_quõs˚d
) {

154 
	`li°_add
(&
tmp
->
li°
, &
öfo
->
¸y±_deöô_li°
);

155 i‡(!
	`timî_≥ndög
(&
öfo
->
¸y±_deöô_timî
)) {

156 
öfo
->
¸y±_deöô_timî
.
expúes
 = 
jiffõs
 + 
HZ
;

157 
	`add_timî
(&
öfo
->
¸y±_deöô_timî
);

160 
	`•ö_u∆ock_úqª°‹e
(
öfo
->
lock
, 
Êags
);

161 
	}
}

162 
EXPORT_SYMBOL
(
lib80211_¸y±_dñayed_deöô
);

164 
	$lib80211_ªgi°î_¸y±o_›s
(
lib80211_¸y±o_›s
 *
›s
)

166 
Êags
;

167 
lib80211_¸y±o_Æg
 *
Æg
;

169 
Æg
 = 
	`kzÆloc
((*Æg), 
GFP_KERNEL
);

170 i‡(
Æg
 =
NULL
)

171  -
ENOMEM
;

173 
Æg
->
›s
 = ops;

175 
	`•ö_lock_úqßve
(&
lib80211_¸y±o_lock
, 
Êags
);

176 
	`li°_add
(&
Æg
->
li°
, &
lib80211_¸y±o_Ægs
);

177 
	`•ö_u∆ock_úqª°‹e
(&
lib80211_¸y±o_lock
, 
Êags
);

179 
	`¥ötk
(
KERN_DEBUG
 "lib80211_crypt:Ñegisteredálgorithm '%s'\n",

180 
›s
->
«me
);

183 
	}
}

184 
EXPORT_SYMBOL
(
lib80211_ªgi°î_¸y±o_›s
);

186 
	$lib80211_uƒegi°î_¸y±o_›s
(
lib80211_¸y±o_›s
 *
›s
)

188 
lib80211_¸y±o_Æg
 *
Æg
;

189 
Êags
;

191 
	`•ö_lock_úqßve
(&
lib80211_¸y±o_lock
, 
Êags
);

192 
	`li°_f‹_óch_íåy
(
Æg
, &
lib80211_¸y±o_Ægs
, 
li°
) {

193 i‡(
Æg
->
›s
 == ops)

194 
found
;

196 
	`•ö_u∆ock_úqª°‹e
(&
lib80211_¸y±o_lock
, 
Êags
);

197  -
EINVAL
;

199 
found
:

200 
	`¥ötk
(
KERN_DEBUG
 "lib80211_crypt: unregisteredálgorithm '%s'\n",

201 
›s
->
«me
);

202 
	`li°_dñ
(&
Æg
->
li°
);

203 
	`•ö_u∆ock_úqª°‹e
(&
lib80211_¸y±o_lock
, 
Êags
);

204 
	`k‰ì
(
Æg
);

206 
	}
}

207 
EXPORT_SYMBOL
(
lib80211_uƒegi°î_¸y±o_›s
);

209 
lib80211_¸y±o_›s
 *
	$lib80211_gë_¸y±o_›s
(c⁄° *
«me
)

211 
lib80211_¸y±o_Æg
 *
Æg
;

212 
Êags
;

214 
	`•ö_lock_úqßve
(&
lib80211_¸y±o_lock
, 
Êags
);

215 
	`li°_f‹_óch_íåy
(
Æg
, &
lib80211_¸y±o_Ægs
, 
li°
) {

216 i‡(
	`°rcmp
(
Æg
->
›s
->
«me
,Çame) == 0)

217 
found
;

219 
	`•ö_u∆ock_úqª°‹e
(&
lib80211_¸y±o_lock
, 
Êags
);

220  
NULL
;

222 
found
:

223 
	`•ö_u∆ock_úqª°‹e
(&
lib80211_¸y±o_lock
, 
Êags
);

224  
Æg
->
›s
;

225 
	}
}

226 
EXPORT_SYMBOL
(
lib80211_gë_¸y±o_›s
);

228 *
	$lib80211_¸y±_nuŒ_öô
(
keyidx
)

231 
	}
}

233 
	$lib80211_¸y±_nuŒ_deöô
(*
¥iv
)

235 
	}
}

237 
lib80211_¸y±o_›s
 
	glib80211_¸y±_nuŒ
 = {

238 .
«me
 = "NULL",

239 .
	göô
 = 
lib80211_¸y±_nuŒ_öô
,

240 .
	gdeöô
 = 
lib80211_¸y±_nuŒ_deöô
,

241 .
	gow√r
 = 
THIS_MODULE
,

244 
__öô
 
	$lib80211_öô
()

246 
	`¥_öfo
(
DRV_DESCRIPTION
 "\n");

247  
	`lib80211_ªgi°î_¸y±o_›s
(&
lib80211_¸y±_nuŒ
);

248 
	}
}

250 
__exô
 
	$lib80211_exô
()

252 
	`lib80211_uƒegi°î_¸y±o_›s
(&
lib80211_¸y±_nuŒ
);

253 
	`BUG_ON
(!
	`li°_em±y
(&
lib80211_¸y±o_Ægs
));

254 
	}
}

256 
moduÀ_öô
(
lib80211_öô
);

257 
moduÀ_exô
(
lib80211_exô
);

	@lib80211.mod.c

1 
	~<löux/moduÀ.h
>

2 
	#INCLUDE_VERMAGIC


	)

3 
	~<löux/buûd-ß….h
>

4 
	~<löux/ñ‚Ÿe-…o.h
>

5 
	~<löux/exp‹t-öã∫Æ.h
>

6 
	~<löux/vîmagic.h
>

7 
	~<löux/compûî.h
>

9 #ifde‡
CONFIG_UNWINDER_ORC


10 
	~<asm/‹c_hódî.h
>

11 
	gORC_HEADER
;

14 
	gBUILD_SALT
;

15 
	gBUILD_LTO_INFO
;

17 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

18 
MODULE_INFO
(
«me
, 
KBUILD_MODNAME
);

20 
__visibÀ
 
moduÀ
 
__this_moduÀ


21 
__£˘i⁄
(".gnu.linkonce.this_module") = {

22 .
«me
 = 
KBUILD_MODNAME
,

23 .
	göô
 = 
öô_moduÀ
,

24 #ifde‡
CONFIG_MODULE_UNLOAD


25 .
	gexô
 = 
˛ónup_moduÀ
,

27 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

30 #ifde‡
CONFIG_MITIGATION_RETPOLINE


31 
MODULE_INFO
(
ªçﬁöe
, "Y");

34 
KSYMTAB_FUNC
(
lib80211_¸y±_öfo_öô
, "", "");

35 
KSYMTAB_FUNC
(
lib80211_¸y±_öfo_‰ì
, "", "");

36 
KSYMTAB_FUNC
(
lib80211_¸y±_dñayed_deöô
, "", "");

37 
KSYMTAB_FUNC
(
lib80211_ªgi°î_¸y±o_›s
, "", "");

38 
KSYMTAB_FUNC
(
lib80211_uƒegi°î_¸y±o_›s
, "", "");

39 
KSYMTAB_FUNC
(
lib80211_gë_¸y±o_›s
, "", "");

41 
SYMBOL_CRC
(
lib80211_¸y±_öfo_öô
, 0x32cc5960, "");

42 
SYMBOL_CRC
(
lib80211_¸y±_öfo_‰ì
, 0x91d03cf6, "");

43 
SYMBOL_CRC
(
lib80211_¸y±_dñayed_deöô
, 0x15015ca0, "");

44 
SYMBOL_CRC
(
lib80211_ªgi°î_¸y±o_›s
, 0x63fa06b8, "");

45 
SYMBOL_CRC
(
lib80211_uƒegi°î_¸y±o_›s
, 0xbb121585, "");

46 
SYMBOL_CRC
(
lib80211_gë_¸y±o_›s
, 0x04afa8ac, "");

48 c⁄° 
modvîsi⁄_öfo
 
	g____vîsi⁄s
[]

49 
__u£d
 
__£˘i⁄
("__versions") = {

70 
MODULE_INFO
(
dïíds
, "");

73 
MODULE_INFO
(
§cvîsi⁄
, "1852F8AD91D6BE1E1EF504B");

	@lib80211_crypt_ccmp.c

9 
	~<löux/kî√l.h
>

10 
	~<löux/îr.h
>

11 
	~<löux/moduÀ.h
>

12 
	~<löux/öô.h
>

13 
	~<löux/¶ab.h
>

14 
	~<löux/øndom.h
>

15 
	~<löux/skbuff.h
>

16 
	~<löux/√tdevi˚.h
>

17 
	~<löux/if_ëhî.h
>

18 
	~<löux/if_¨p.h
>

19 
	~<asm/°rög.h
>

20 
	~<löux/wúñess.h
>

22 
	~<löux/õì80211.h
>

24 
	~<löux/¸y±o.h
>

25 
	~<¸y±o/´ad.h
>

27 
	~<√t/lib80211.h
>

29 
MODULE_AUTHOR
("Jouni Malinen");

30 
MODULE_DESCRIPTION
("Host AP crypt: CCMP");

31 
MODULE_LICENSE
("GPL");

33 
	#AES_BLOCK_LEN
 16

	)

34 
	#CCMP_HDR_LEN
 8

	)

35 
	#CCMP_MIC_LEN
 8

	)

36 
	#CCMP_TK_LEN
 16

	)

37 
	#CCMP_PN_LEN
 6

	)

39 
	slib80211_ccmp_d©a
 {

40 
u8
 
	mkey
[
CCMP_TK_LEN
];

41 
	mkey_£t
;

43 
u8
 
	mtx_≤
[
CCMP_PN_LEN
];

44 
u8
 
	mrx_≤
[
CCMP_PN_LEN
];

46 
u32
 
	mdŸ11RSNASètsCCMPF‹m©Eº‹s
;

47 
u32
 
	mdŸ11RSNASètsCCMPRïœys
;

48 
u32
 
	mdŸ11RSNASètsCCMPDe¸y±Eº‹s
;

50 
	mkey_idx
;

52 
¸y±o_´ad
 *
	mtfm
;

55 
u8
 
	mtx_Ød
[2 * 
AES_BLOCK_LEN
];

56 
u8
 
	mrx_Ød
[2 * 
AES_BLOCK_LEN
];

59 *
	$lib80211_ccmp_öô
(
key_idx
)

61 
lib80211_ccmp_d©a
 *
¥iv
;

63 
¥iv
 = 
	`kzÆloc
((*¥iv), 
GFP_ATOMIC
);

64 i‡(
¥iv
 =
NULL
)

65 
Áû
;

66 
¥iv
->
key_idx
 = key_idx;

68 
¥iv
->
tfm
 = 
	`¸y±o_Æloc_´ad
("ccm◊es)", 0, 
CRYPTO_ALG_ASYNC
);

69 i‡(
	`IS_ERR
(
¥iv
->
tfm
)) {

70 
¥iv
->
tfm
 = 
NULL
;

71 
Áû
;

74  
¥iv
;

76 
Áû
:

77 i‡(
¥iv
) {

78 i‡(
¥iv
->
tfm
)

79 
	`¸y±o_‰ì_´ad
(
¥iv
->
tfm
);

80 
	`k‰ì
(
¥iv
);

83  
NULL
;

84 
	}
}

86 
	$lib80211_ccmp_deöô
(*
¥iv
)

88 
lib80211_ccmp_d©a
 *
_¥iv
 = 
¥iv
;

89 i‡(
_¥iv
 && _¥iv->
tfm
)

90 
	`¸y±o_‰ì_´ad
(
_¥iv
->
tfm
);

91 
	`k‰ì
(
¥iv
);

92 
	}
}

94 
	$ccmp_öô_iv_™d_Ød
(c⁄° 
õì80211_hdr
 *
hdr
,

95 c⁄° 
u8
 *
≤
, u8 *
iv
, u8 *
Ød
)

97 
u8
 *
pos
, 
qc
 = 0;

98 
size_t
 
Ød_Àn
;

99 
a4_ö˛uded
, 
qc_ö˛uded
;

101 
a4_ö˛uded
 = 
	`õì80211_has_a4
(
hdr
->
‰ame_c⁄åﬁ
);

102 
qc_ö˛uded
 = 
	`õì80211_is_d©a_qos
(
hdr
->
‰ame_c⁄åﬁ
);

104 
Ød_Àn
 = 22;

105 i‡(
a4_ö˛uded
)

106 
Ød_Àn
 += 6;

107 i‡(
qc_ö˛uded
) {

108 
pos
 = (
u8
 *Ë& 
hdr
->
addr4
;

109 i‡(
a4_ö˛uded
)

110 
pos
 += 6;

111 
qc
 = *
pos
 & 0x0f;

112 
Ød_Àn
 += 2;

122 
iv
[0] = 0x1;

125 
iv
[1] = 
qc
;

126 
	`mem˝y
(
iv
 + 2, 
hdr
->
addr2
, 
ETH_ALEN
);

127 
	`mem˝y
(
iv
 + 8, 
≤
, 
CCMP_PN_LEN
);

136 
pos
 = (
u8
 *Ë
hdr
;

137 
Ød
[0] = 
pos
[0] & 0x8f;

138 
Ød
[1] = 
pos
[1] & 0xc7;

139 
	`mem˝y
(
Ød
 + 2, &
hdr
->
addrs
, 3 * 
ETH_ALEN
);

140 
pos
 = (
u8
 *Ë& 
hdr
->
£q_˘æ
;

141 
Ød
[20] = 
pos
[0] & 0x0f;

142 
Ød
[21] = 0;

143 
	`mem£t
(
Ød
 + 22, 0, 8);

144 i‡(
a4_ö˛uded
)

145 
	`mem˝y
(
Ød
 + 22, 
hdr
->
addr4
, 
ETH_ALEN
);

146 i‡(
qc_ö˛uded
) {

147 
Ød
[
a4_ö˛uded
 ? 28 : 22] = 
qc
;

150  
Ød_Àn
;

151 
	}
}

153 
	$lib80211_ccmp_hdr
(
sk_buff
 *
skb
, 
hdr_Àn
,

154 
u8
 *
´skey
, 
keyÀn
, *
¥iv
)

156 
lib80211_ccmp_d©a
 *
key
 = 
¥iv
;

157 
i
;

158 
u8
 *
pos
;

160 i‡(
	`skb_hódroom
(
skb
Ë< 
CCMP_HDR_LEN
 || skb->
Àn
 < 
hdr_Àn
)

163 i‡(
´skey
 !
NULL
 && 
keyÀn
 >
CCMP_TK_LEN
)

164 
	`mem˝y
(
´skey
, 
key
->key, 
CCMP_TK_LEN
);

166 
pos
 = 
	`skb_push
(
skb
, 
CCMP_HDR_LEN
);

167 
	`memmove
(
pos
,Öo†+ 
CCMP_HDR_LEN
, 
hdr_Àn
);

168 
pos
 +
hdr_Àn
;

170 
i
 = 
CCMP_PN_LEN
 - 1;

171 
i
 >= 0) {

172 
key
->
tx_≤
[
i
]++;

173 i‡(
key
->
tx_≤
[
i
] != 0)

175 
i
--;

178 *
pos
++ = 
key
->
tx_≤
[5];

179 *
pos
++ = 
key
->
tx_≤
[4];

180 *
pos
++ = 0;

181 *
pos
++ = (
key
->
key_idx
 << 6) | (1 << 5) ;

182 *
pos
++ = 
key
->
tx_≤
[3];

183 *
pos
++ = 
key
->
tx_≤
[2];

184 *
pos
++ = 
key
->
tx_≤
[1];

185 *
pos
++ = 
key
->
tx_≤
[0];

187  
CCMP_HDR_LEN
;

188 
	}
}

190 
	$lib80211_ccmp_í¸y±
(
sk_buff
 *
skb
, 
hdr_Àn
, *
¥iv
)

192 
lib80211_ccmp_d©a
 *
key
 = 
¥iv
;

193 
õì80211_hdr
 *
hdr
;

194 
´ad_ªque°
 *
ªq
;

195 
sˇâîli°
 
sg
[2];

196 
u8
 *
Ød
 = 
key
->
tx_Ød
;

197 
u8
 
iv
[
AES_BLOCK_LEN
];

198 
Àn
, 
d©a_Àn
, 
Ød_Àn
;

199 
ªt
;

201 i‡(
	`skb_èûroom
(
skb
Ë< 
CCMP_MIC_LEN
 || skb->
Àn
 < 
hdr_Àn
)

204 
d©a_Àn
 = 
skb
->
Àn
 - 
hdr_Àn
;

205 
Àn
 = 
	`lib80211_ccmp_hdr
(
skb
, 
hdr_Àn
, 
NULL
, 0, 
¥iv
);

206 i‡(
Àn
 < 0)

209 
ªq
 = 
	`´ad_ªque°_Æloc
(
key
->
tfm
, 
GFP_ATOMIC
);

210 i‡(!
ªq
)

211  -
ENOMEM
;

213 
hdr
 = (
õì80211_hdr
 *)
skb
->
d©a
;

214 
Ød_Àn
 = 
	`ccmp_öô_iv_™d_Ød
(
hdr
, 
key
->
tx_≤
, 
iv
, 
Ød
);

216 
	`skb_put
(
skb
, 
CCMP_MIC_LEN
);

218 
	`sg_öô_èbÀ
(
sg
, 2);

219 
	`sg_£t_buf
(&
sg
[0], 
Ød
, 
Ød_Àn
);

220 
	`sg_£t_buf
(&
sg
[1], 
skb
->
d©a
 + 
hdr_Àn
 + 
CCMP_HDR_LEN
,

221 
d©a_Àn
 + 
CCMP_MIC_LEN
);

223 
	`´ad_ªque°_£t_ˇŒback
(
ªq
, 0, 
NULL
, NULL);

224 
	`´ad_ªque°_£t_ad
(
ªq
, 
Ød_Àn
);

225 
	`´ad_ªque°_£t_¸y±
(
ªq
, 
sg
, sg, 
d©a_Àn
, 
iv
);

227 
ªt
 = 
	`¸y±o_´ad_í¸y±
(
ªq
);

228 
	`´ad_ªque°_‰ì
(
ªq
);

230  
ªt
;

231 
	}
}

237 
ölöe
 
	$ccmp_ª∂ay_check
(
u8
 *
≤_n
, u8 *
≤_o
)

239 
u32
 
iv32_n
, 
iv16_n
;

240 
u32
 
iv32_o
, 
iv16_o
;

242 
iv32_n
 = (
≤_n
[0] << 24) | (pn_n[1] << 16) | (pn_n[2] << 8) |Ön_n[3];

243 
iv16_n
 = (
≤_n
[4] << 8) |Ön_n[5];

245 
iv32_o
 = (
≤_o
[0] << 24) | (pn_o[1] << 16) | (pn_o[2] << 8) |Ön_o[3];

246 
iv16_o
 = (
≤_o
[4] << 8) |Ön_o[5];

248 i‡((
s32
)
iv32_n
 - (s32)
iv32_o
 < 0 ||

249 (
iv32_n
 =
iv32_o
 && 
iv16_n
 <
iv16_o
))

252 
	}
}

254 
	$lib80211_ccmp_de¸y±
(
sk_buff
 *
skb
, 
hdr_Àn
, *
¥iv
)

256 
lib80211_ccmp_d©a
 *
key
 = 
¥iv
;

257 
u8
 
keyidx
, *
pos
;

258 
õì80211_hdr
 *
hdr
;

259 
´ad_ªque°
 *
ªq
;

260 
sˇâîli°
 
sg
[2];

261 
u8
 *
Ød
 = 
key
->
rx_Ød
;

262 
u8
 
iv
[
AES_BLOCK_LEN
];

263 
u8
 
≤
[6];

264 
Ød_Àn
, 
ªt
;

265 
size_t
 
d©a_Àn
 = 
skb
->
Àn
 - 
hdr_Àn
 - 
CCMP_HDR_LEN
;

267 i‡(
skb
->
Àn
 < 
hdr_Àn
 + 
CCMP_HDR_LEN
 + 
CCMP_MIC_LEN
) {

268 
key
->
dŸ11RSNASètsCCMPF‹m©Eº‹s
++;

272 
hdr
 = (
õì80211_hdr
 *)
skb
->
d©a
;

273 
pos
 = 
skb
->
d©a
 + 
hdr_Àn
;

274 
keyidx
 = 
pos
[3];

275 i‡(!(
keyidx
 & (1 << 5))) {

276 
	`√t_dbg_øãlimôed
("CCMP:ÑeceivedÖacket without ExtIV flag from %pM\n",

277 
hdr
->
addr2
);

278 
key
->
dŸ11RSNASètsCCMPF‹m©Eº‹s
++;

281 
keyidx
 >>= 6;

282 i‡(
key
->
key_idx
 !
keyidx
) {

283 
	`√t_dbg_øãlimôed
("CCMP: RXÅkey->key_idx=%d frame keyidx=%d\n",

284 
key
->
key_idx
, 
keyidx
);

287 i‡(!
key
->
key_£t
) {

288 
	`√t_dbg_øãlimôed
("CCMP:ÑeceivedÖacket from %pM with keyid=%dÅhat doesÇot haveá configured key\n",

289 
hdr
->
addr2
, 
keyidx
);

293 
≤
[0] = 
pos
[7];

294 
≤
[1] = 
pos
[6];

295 
≤
[2] = 
pos
[5];

296 
≤
[3] = 
pos
[4];

297 
≤
[4] = 
pos
[1];

298 
≤
[5] = 
pos
[0];

299 
pos
 += 8;

301 i‡(
	`ccmp_ª∂ay_check
(
≤
, 
key
->
rx_≤
)) {

302 #ifde‡
CONFIG_LIB80211_DEBUG


303 
	`√t_dbg_øãlimôed
("CCMP:Ñeplay detected: STA=%pMÖrevious PN %02x%02x%02x%02x%02x%02xÑeceived PN %02x%02x%02x%02x%02x%02x\n",

304 
hdr
->
addr2
,

305 
key
->
rx_≤
[0], key->rx_pn[1], key->rx_pn[2],

306 
key
->
rx_≤
[3], key->rx_pn[4], key->rx_pn[5],

307 
≤
[0],Ön[1],Ön[2],Ön[3],Ön[4],Ön[5]);

309 
key
->
dŸ11RSNASètsCCMPRïœys
++;

313 
ªq
 = 
	`´ad_ªque°_Æloc
(
key
->
tfm
, 
GFP_ATOMIC
);

314 i‡(!
ªq
)

315  -
ENOMEM
;

317 
Ød_Àn
 = 
	`ccmp_öô_iv_™d_Ød
(
hdr
, 
≤
, 
iv
, 
Ød
);

319 
	`sg_öô_èbÀ
(
sg
, 2);

320 
	`sg_£t_buf
(&
sg
[0], 
Ød
, 
Ød_Àn
);

321 
	`sg_£t_buf
(&
sg
[1], 
pos
, 
d©a_Àn
);

323 
	`´ad_ªque°_£t_ˇŒback
(
ªq
, 0, 
NULL
, NULL);

324 
	`´ad_ªque°_£t_ad
(
ªq
, 
Ød_Àn
);

325 
	`´ad_ªque°_£t_¸y±
(
ªq
, 
sg
, sg, 
d©a_Àn
, 
iv
);

327 
ªt
 = 
	`¸y±o_´ad_de¸y±
(
ªq
);

328 
	`´ad_ªque°_‰ì
(
ªq
);

330 i‡(
ªt
) {

331 
	`√t_dbg_øãlimôed
("CCMP: decrypt failed: STA=%pM (%d)\n",

332 
hdr
->
addr2
, 
ªt
);

333 
key
->
dŸ11RSNASètsCCMPDe¸y±Eº‹s
++;

337 
	`mem˝y
(
key
->
rx_≤
, 
≤
, 
CCMP_PN_LEN
);

340 
	`memmove
(
skb
->
d©a
 + 
CCMP_HDR_LEN
, skb->d©a, 
hdr_Àn
);

341 
	`skb_puŒ
(
skb
, 
CCMP_HDR_LEN
);

342 
	`skb_åim
(
skb
, skb->
Àn
 - 
CCMP_MIC_LEN
);

344  
keyidx
;

345 
	}
}

347 
	$lib80211_ccmp_£t_key
(*
key
, 
Àn
, 
u8
 * 
£q
, *
¥iv
)

349 
lib80211_ccmp_d©a
 *
d©a
 = 
¥iv
;

350 
keyidx
;

351 
¸y±o_´ad
 *
tfm
 = 
d©a
->tfm;

353 
keyidx
 = 
d©a
->
key_idx
;

354 
	`mem£t
(
d©a
, 0, (*data));

355 
d©a
->
key_idx
 = 
keyidx
;

356 
d©a
->
tfm
 =Åfm;

357 i‡(
Àn
 =
CCMP_TK_LEN
) {

358 
	`mem˝y
(
d©a
->
key
, key, 
CCMP_TK_LEN
);

359 
d©a
->
key_£t
 = 1;

360 i‡(
£q
) {

361 
d©a
->
rx_≤
[0] = 
£q
[5];

362 
d©a
->
rx_≤
[1] = 
£q
[4];

363 
d©a
->
rx_≤
[2] = 
£q
[3];

364 
d©a
->
rx_≤
[3] = 
£q
[2];

365 
d©a
->
rx_≤
[4] = 
£q
[1];

366 
d©a
->
rx_≤
[5] = 
£q
[0];

368 i‡(
	`¸y±o_´ad_£èuthsize
(
d©a
->
tfm
, 
CCMP_MIC_LEN
) ||

369 
	`¸y±o_´ad_£tkey
(
d©a
->
tfm
, d©a->
key
, 
CCMP_TK_LEN
))

371 } i‡(
Àn
 == 0)

372 
d©a
->
key_£t
 = 0;

377 
	}
}

379 
	$lib80211_ccmp_gë_key
(*
key
, 
Àn
, 
u8
 * 
£q
, *
¥iv
)

381 
lib80211_ccmp_d©a
 *
d©a
 = 
¥iv
;

383 i‡(
Àn
 < 
CCMP_TK_LEN
)

386 i‡(!
d©a
->
key_£t
)

388 
	`mem˝y
(
key
, 
d©a
->key, 
CCMP_TK_LEN
);

390 i‡(
£q
) {

391 
£q
[0] = 
d©a
->
tx_≤
[5];

392 
£q
[1] = 
d©a
->
tx_≤
[4];

393 
£q
[2] = 
d©a
->
tx_≤
[3];

394 
£q
[3] = 
d©a
->
tx_≤
[2];

395 
£q
[4] = 
d©a
->
tx_≤
[1];

396 
£q
[5] = 
d©a
->
tx_≤
[0];

399  
CCMP_TK_LEN
;

400 
	}
}

402 
	$lib80211_ccmp_¥öt_°©s
(
£q_fûe
 *
m
, *
¥iv
)

404 
lib80211_ccmp_d©a
 *
ccmp
 = 
¥iv
;

406 
	`£q_¥ötf
(
m
,

411 
ccmp
->
key_idx
, ccmp->
key_£t
,

412 
ccmp
->
tx_≤
[0], ccmp->tx_pn[1], ccmp->tx_pn[2],

413 
ccmp
->
tx_≤
[3], ccmp->tx_pn[4], ccmp->tx_pn[5],

414 
ccmp
->
rx_≤
[0], ccmp->rx_pn[1], ccmp->rx_pn[2],

415 
ccmp
->
rx_≤
[3], ccmp->rx_pn[4], ccmp->rx_pn[5],

416 
ccmp
->
dŸ11RSNASètsCCMPF‹m©Eº‹s
,

417 
ccmp
->
dŸ11RSNASètsCCMPRïœys
,

418 
ccmp
->
dŸ11RSNASètsCCMPDe¸y±Eº‹s
);

419 
	}
}

421 
lib80211_¸y±o_›s
 
	glib80211_¸y±_ccmp
 = {

422 .
«me
 = "CCMP",

423 .
	göô
 = 
lib80211_ccmp_öô
,

424 .
	gdeöô
 = 
lib80211_ccmp_deöô
,

425 .
	gí¸y±_mpdu
 = 
lib80211_ccmp_í¸y±
,

426 .
	gde¸y±_mpdu
 = 
lib80211_ccmp_de¸y±
,

427 .
	gí¸y±_msdu
 = 
NULL
,

428 .
	gde¸y±_msdu
 = 
NULL
,

429 .
	g£t_key
 = 
lib80211_ccmp_£t_key
,

430 .
	ggë_key
 = 
lib80211_ccmp_gë_key
,

431 .
	g¥öt_°©s
 = 
lib80211_ccmp_¥öt_°©s
,

432 .
	gexåa_mpdu_¥efix_Àn
 = 
CCMP_HDR_LEN
,

433 .
	gexåa_mpdu_po°fix_Àn
 = 
CCMP_MIC_LEN
,

434 .
	gow√r
 = 
THIS_MODULE
,

437 
__öô
 
	$lib80211_¸y±o_ccmp_öô
()

439  
	`lib80211_ªgi°î_¸y±o_›s
(&
lib80211_¸y±_ccmp
);

440 
	}
}

442 
__exô
 
	$lib80211_¸y±o_ccmp_exô
()

444 
	`lib80211_uƒegi°î_¸y±o_›s
(&
lib80211_¸y±_ccmp
);

445 
	}
}

447 
moduÀ_öô
(
lib80211_¸y±o_ccmp_öô
);

448 
moduÀ_exô
(
lib80211_¸y±o_ccmp_exô
);

	@lib80211_crypt_ccmp.mod.c

1 
	~<löux/moduÀ.h
>

2 
	#INCLUDE_VERMAGIC


	)

3 
	~<löux/buûd-ß….h
>

4 
	~<löux/ñ‚Ÿe-…o.h
>

5 
	~<löux/exp‹t-öã∫Æ.h
>

6 
	~<löux/vîmagic.h
>

7 
	~<löux/compûî.h
>

9 #ifde‡
CONFIG_UNWINDER_ORC


10 
	~<asm/‹c_hódî.h
>

11 
	gORC_HEADER
;

14 
	gBUILD_SALT
;

15 
	gBUILD_LTO_INFO
;

17 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

18 
MODULE_INFO
(
«me
, 
KBUILD_MODNAME
);

20 
__visibÀ
 
moduÀ
 
__this_moduÀ


21 
__£˘i⁄
(".gnu.linkonce.this_module") = {

22 .
«me
 = 
KBUILD_MODNAME
,

23 .
	göô
 = 
öô_moduÀ
,

24 #ifde‡
CONFIG_MODULE_UNLOAD


25 .
	gexô
 = 
˛ónup_moduÀ
,

27 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

30 #ifde‡
CONFIG_MITIGATION_RETPOLINE


31 
MODULE_INFO
(
ªçﬁöe
, "Y");

36 c⁄° 
modvîsi⁄_öfo
 
	g____vîsi⁄s
[]

37 
__u£d
 
__£˘i⁄
("__versions") = {

70 
MODULE_INFO
(
dïíds
, "lib80211");

73 
MODULE_INFO
(
§cvîsi⁄
, "BD0032DF38975FD45B0C9A2");

	@lib80211_crypt_tkip.c

9 
	#¥_fmt
(
fmt
Ë
KBUILD_MODNAME
 ": " 
	)
fmt

11 
	~<löux/îr.h
>

12 
	~<löux/fùs.h
>

13 
	~<löux/moduÀ.h
>

14 
	~<löux/öô.h
>

15 
	~<löux/¶ab.h
>

16 
	~<löux/øndom.h
>

17 
	~<löux/sˇâîli°.h
>

18 
	~<löux/skbuff.h
>

19 
	~<löux/√tdevi˚.h
>

20 
	~<löux/mm.h
>

21 
	~<löux/if_ëhî.h
>

22 
	~<löux/if_¨p.h
>

23 
	~<asm/°rög.h
>

25 
	~<löux/wúñess.h
>

26 
	~<löux/õì80211.h
>

27 
	~<√t/iw_h™dÀr.h
>

29 
	~<¸y±o/¨c4.h
>

30 
	~<¸y±o/hash.h
>

31 
	~<löux/¸y±o.h
>

32 
	~<löux/¸c32.h
>

34 
	~<√t/lib80211.h
>

36 
MODULE_AUTHOR
("Jouni Malinen");

37 
MODULE_DESCRIPTION
("lib80211 crypt: TKIP");

38 
MODULE_LICENSE
("GPL");

40 
	#TKIP_HDR_LEN
 8

	)

42 
	slib80211_tkù_d©a
 {

43 
	#TKIP_KEY_LEN
 32

	)

44 
u8
 
	mkey
[
TKIP_KEY_LEN
];

45 
	mkey_£t
;

47 
u32
 
	mtx_iv32
;

48 
u16
 
	mtx_iv16
;

49 
u16
 
	mtx_âak
[5];

50 
	mtx_pha£1_d⁄e
;

52 
u32
 
	mrx_iv32
;

53 
u16
 
	mrx_iv16
;

54 
u16
 
	mrx_âak
[5];

55 
	mrx_pha£1_d⁄e
;

56 
u32
 
	mrx_iv32_√w
;

57 
u16
 
	mrx_iv16_√w
;

59 
u32
 
	mdŸ11RSNASètsTKIPRïœys
;

60 
u32
 
	mdŸ11RSNASètsTKIPICVEº‹s
;

61 
u32
 
	mdŸ11RSNASètsTKIPLoˇlMICFaûuªs
;

63 
	mkey_idx
;

65 
¨c4_˘x
 
	mrx_˘x_¨c4
;

66 
¨c4_˘x
 
	mtx_˘x_¨c4
;

67 
¸y±o_shash
 *
	mrx_tfm_mich´l
;

68 
¸y±o_shash
 *
	mtx_tfm_mich´l
;

71 
u8
 
	mrx_hdr
[16], 
	mtx_hdr
[16];

73 
	mÊags
;

76 
	$lib80211_tkù_£t_Êags
(
Êags
, *
¥iv
)

78 
lib80211_tkù_d©a
 *
_¥iv
 = 
¥iv
;

79 
ﬁd_Êags
 = 
_¥iv
->
Êags
;

80 
_¥iv
->
Êags
 = flags;

81  
ﬁd_Êags
;

82 
	}
}

84 
	$lib80211_tkù_gë_Êags
(*
¥iv
)

86 
lib80211_tkù_d©a
 *
_¥iv
 = 
¥iv
;

87  
_¥iv
->
Êags
;

88 
	}
}

90 *
	$lib80211_tkù_öô
(
key_idx
)

92 
lib80211_tkù_d©a
 *
¥iv
;

94 i‡(
fùs_íabÀd
)

95  
NULL
;

97 
¥iv
 = 
	`kzÆloc
((*¥iv), 
GFP_ATOMIC
);

98 i‡(
¥iv
 =
NULL
)

99 
Áû
;

101 
¥iv
->
key_idx
 = key_idx;

103 
¥iv
->
tx_tfm_mich´l
 = 
	`¸y±o_Æloc_shash
("michael_mic", 0, 0);

104 i‡(
	`IS_ERR
(
¥iv
->
tx_tfm_mich´l
)) {

105 
¥iv
->
tx_tfm_mich´l
 = 
NULL
;

106 
Áû
;

109 
¥iv
->
rx_tfm_mich´l
 = 
	`¸y±o_Æloc_shash
("michael_mic", 0, 0);

110 i‡(
	`IS_ERR
(
¥iv
->
rx_tfm_mich´l
)) {

111 
¥iv
->
rx_tfm_mich´l
 = 
NULL
;

112 
Áû
;

115  
¥iv
;

117 
Áû
:

118 i‡(
¥iv
) {

119 
	`¸y±o_‰ì_shash
(
¥iv
->
tx_tfm_mich´l
);

120 
	`¸y±o_‰ì_shash
(
¥iv
->
rx_tfm_mich´l
);

121 
	`k‰ì
(
¥iv
);

124  
NULL
;

125 
	}
}

127 
	$lib80211_tkù_deöô
(*
¥iv
)

129 
lib80211_tkù_d©a
 *
_¥iv
 = 
¥iv
;

130 i‡(
_¥iv
) {

131 
	`¸y±o_‰ì_shash
(
_¥iv
->
tx_tfm_mich´l
);

132 
	`¸y±o_‰ì_shash
(
_¥iv
->
rx_tfm_mich´l
);

134 
	`k‰ì_£nsôive
(
¥iv
);

135 
	}
}

137 
ölöe
 
u16
 
	$RŸR1
(
u16
 
vÆ
)

139  (
vÆ
 >> 1) | (val << 15);

140 
	}
}

142 
ölöe
 
u8
 
	$Lo8
(
u16
 
vÆ
)

144  
vÆ
 & 0xff;

145 
	}
}

147 
ölöe
 
u8
 
	$Hi8
(
u16
 
vÆ
)

149  
vÆ
 >> 8;

150 
	}
}

152 
ölöe
 
u16
 
	$Lo16
(
u32
 
vÆ
)

154  
vÆ
 & 0xffff;

155 
	}
}

157 
ölöe
 
u16
 
	$Hi16
(
u32
 
vÆ
)

159  
vÆ
 >> 16;

160 
	}
}

162 
ölöe
 
u16
 
	$Mk16
(
u8
 
hi
, u8 
lo
)

164  
lo
 | (((
u16
Ë
hi
) << 8);

165 
	}
}

167 
ölöe
 
u16
 
	$Mk16_À
(
__À16
 * 
v
)

169  
	`À16_to_˝u
(*
v
);

170 
	}
}

172 c⁄° 
u16
 
	gSbox
[256] = {

207 
ölöe
 
u16
 
	$_S_
(
u16
 
v
)

209 
u16
 
t
 = 
Sbox
[
	`Hi8
(
v
)];

210  
Sbox
[
	`Lo8
(
v
)] ^ ((
t
 << 8) | (t >> 8));

211 
	}
}

213 
	#PHASE1_LOOP_COUNT
 8

	)

215 
	$tkù_mixög_pha£1
(
u16
 * 
TTAK
, c⁄° 
u8
 * 
TK
, c⁄° u8 * 
TA
,

216 
u32
 
IV32
)

218 
i
, 
j
;

221 
TTAK
[0] = 
	`Lo16
(
IV32
);

222 
TTAK
[1] = 
	`Hi16
(
IV32
);

223 
TTAK
[2] = 
	`Mk16
(
TA
[1], TA[0]);

224 
TTAK
[3] = 
	`Mk16
(
TA
[3], TA[2]);

225 
TTAK
[4] = 
	`Mk16
(
TA
[5], TA[4]);

227 
i
 = 0; i < 
PHASE1_LOOP_COUNT
; i++) {

228 
j
 = 2 * (
i
 & 1);

229 
TTAK
[0] +
	`_S_
(TTAK[4] ^ 
	`Mk16
(
TK
[1 + 
j
], TK[0 + j]));

230 
TTAK
[1] +
	`_S_
(TTAK[0] ^ 
	`Mk16
(
TK
[5 + 
j
], TK[4 + j]));

231 
TTAK
[2] +
	`_S_
(TTAK[1] ^ 
	`Mk16
(
TK
[9 + 
j
], TK[8 + j]));

232 
TTAK
[3] +
	`_S_
(TTAK[2] ^ 
	`Mk16
(
TK
[13 + 
j
], TK[12 + j]));

233 
TTAK
[4] +
	`_S_
(TTAK[3] ^ 
	`Mk16
(
TK
[1 + 
j
], TK[0 + j])Ë+ 
i
;

235 
	}
}

237 
	$tkù_mixög_pha£2
(
u8
 * 
WEPSìd
, c⁄° u8 * 
TK
, c⁄° 
u16
 * 
TTAK
,

238 
u16
 
IV16
)

242 
u16
 *
PPK
 = (u16 *Ë& 
WEPSìd
[4];

245 
PPK
[0] = 
TTAK
[0];

246 
PPK
[1] = 
TTAK
[1];

247 
PPK
[2] = 
TTAK
[2];

248 
PPK
[3] = 
TTAK
[3];

249 
PPK
[4] = 
TTAK
[4];

250 
PPK
[5] = 
TTAK
[4] + 
IV16
;

253 
PPK
[0] +
	`_S_
(PPK[5] ^ 
	`Mk16_À
((
__À16
 *Ë& 
TK
[0]));

254 
PPK
[1] +
	`_S_
(PPK[0] ^ 
	`Mk16_À
((
__À16
 *Ë& 
TK
[2]));

255 
PPK
[2] +
	`_S_
(PPK[1] ^ 
	`Mk16_À
((
__À16
 *Ë& 
TK
[4]));

256 
PPK
[3] +
	`_S_
(PPK[2] ^ 
	`Mk16_À
((
__À16
 *Ë& 
TK
[6]));

257 
PPK
[4] +
	`_S_
(PPK[3] ^ 
	`Mk16_À
((
__À16
 *Ë& 
TK
[8]));

258 
PPK
[5] +
	`_S_
(PPK[4] ^ 
	`Mk16_À
((
__À16
 *Ë& 
TK
[10]));

260 
PPK
[0] +
	`RŸR1
(PPK[5] ^ 
	`Mk16_À
((
__À16
 *Ë& 
TK
[12]));

261 
PPK
[1] +
	`RŸR1
(PPK[0] ^ 
	`Mk16_À
((
__À16
 *Ë& 
TK
[14]));

262 
PPK
[2] +
	`RŸR1
(PPK[1]);

263 
PPK
[3] +
	`RŸR1
(PPK[2]);

264 
PPK
[4] +
	`RŸR1
(PPK[3]);

265 
PPK
[5] +
	`RŸR1
(PPK[4]);

269 
WEPSìd
[0] = 
	`Hi8
(
IV16
);

270 
WEPSìd
[1] = (
	`Hi8
(
IV16
) | 0x20) & 0x7F;

271 
WEPSìd
[2] = 
	`Lo8
(
IV16
);

272 
WEPSìd
[3] = 
	`Lo8
((
PPK
[5] ^ 
	`Mk16_À
((
__À16
 *Ë& 
TK
[0])) >> 1);

274 #ifde‡
__BIG_ENDIAN


276 
i
;

277 
i
 = 0; i < 6; i++)

278 
PPK
[
i
] = (PPK[i] << 8) | (PPK[i] >> 8);

281 
	}
}

283 
	$lib80211_tkù_hdr
(
sk_buff
 *
skb
, 
hdr_Àn
,

284 
u8
 * 
rc4key
, 
keyÀn
, *
¥iv
)

286 
lib80211_tkù_d©a
 *
tkey
 = 
¥iv
;

287 
u8
 *
pos
;

288 
õì80211_hdr
 *
hdr
;

290 
hdr
 = (
õì80211_hdr
 *)
skb
->
d©a
;

292 i‡(
	`skb_hódroom
(
skb
Ë< 
TKIP_HDR_LEN
 || skb->
Àn
 < 
hdr_Àn
)

295 i‡(
rc4key
 =
NULL
 || 
keyÀn
 < 16)

298 i‡(!
tkey
->
tx_pha£1_d⁄e
) {

299 
	`tkù_mixög_pha£1
(
tkey
->
tx_âak
,Åkey->
key
, 
hdr
->
addr2
,

300 
tkey
->
tx_iv32
);

301 
tkey
->
tx_pha£1_d⁄e
 = 1;

303 
	`tkù_mixög_pha£2
(
rc4key
, 
tkey
->
key
,Åkey->
tx_âak
,Åkey->
tx_iv16
);

305 
pos
 = 
	`skb_push
(
skb
, 
TKIP_HDR_LEN
);

306 
	`memmove
(
pos
,Öo†+ 
TKIP_HDR_LEN
, 
hdr_Àn
);

307 
pos
 +
hdr_Àn
;

309 *
pos
++ = *
rc4key
;

310 *
pos
++ = *(
rc4key
 + 1);

311 *
pos
++ = *(
rc4key
 + 2);

312 *
pos
++ = (
tkey
->
key_idx
 << 6) | (1 << 5) ;

313 *
pos
++ = 
tkey
->
tx_iv32
 & 0xff;

314 *
pos
++ = (
tkey
->
tx_iv32
 >> 8) & 0xff;

315 *
pos
++ = (
tkey
->
tx_iv32
 >> 16) & 0xff;

316 *
pos
++ = (
tkey
->
tx_iv32
 >> 24) & 0xff;

318 
tkey
->
tx_iv16
++;

319 i‡(
tkey
->
tx_iv16
 == 0) {

320 
tkey
->
tx_pha£1_d⁄e
 = 0;

321 
tkey
->
tx_iv32
++;

324  
TKIP_HDR_LEN
;

325 
	}
}

327 
	$lib80211_tkù_í¸y±
(
sk_buff
 *
skb
, 
hdr_Àn
, *
¥iv
)

329 
lib80211_tkù_d©a
 *
tkey
 = 
¥iv
;

330 
Àn
;

331 
u8
 
rc4key
[16], *
pos
, *
icv
;

332 
u32
 
¸c
;

334 i‡(
tkey
->
Êags
 & 
IEEE80211_CRYPTO_TKIP_COUNTERMEASURES
) {

335 
õì80211_hdr
 *
hdr
 = (õì80211_hd∏*)
skb
->
d©a
;

336 
	`√t_dbg_øãlimôed
("TKIP countermeasures: dropped TXÖacketÅo %pM\n",

337 
hdr
->
addr1
);

341 i‡(
	`skb_èûroom
(
skb
Ë< 4 || skb->
Àn
 < 
hdr_Àn
)

344 
Àn
 = 
skb
->À¿- 
hdr_Àn
;

345 
pos
 = 
skb
->
d©a
 + 
hdr_Àn
;

347 i‡((
	`lib80211_tkù_hdr
(
skb
, 
hdr_Àn
, 
rc4key
, 16, 
¥iv
)) < 0)

350 
¸c
 = ~
	`¸c32_À
(~0, 
pos
, 
Àn
);

351 
icv
 = 
	`skb_put
(
skb
, 4);

352 
icv
[0] = 
¸c
;

353 
icv
[1] = 
¸c
 >> 8;

354 
icv
[2] = 
¸c
 >> 16;

355 
icv
[3] = 
¸c
 >> 24;

357 
	`¨c4_£tkey
(&
tkey
->
tx_˘x_¨c4
, 
rc4key
, 16);

358 
	`¨c4_¸y±
(&
tkey
->
tx_˘x_¨c4
, 
pos
,Öos, 
Àn
 + 4);

361 
	}
}

367 
ölöe
 
	$tkù_ª∂ay_check
(
u32
 
iv32_n
, 
u16
 
iv16_n
,

368 
u32
 
iv32_o
, 
u16
 
iv16_o
)

370 i‡((
s32
)
iv32_n
 - (s32)
iv32_o
 < 0 ||

371 (
iv32_n
 =
iv32_o
 && 
iv16_n
 <
iv16_o
))

374 
	}
}

376 
	$lib80211_tkù_de¸y±
(
sk_buff
 *
skb
, 
hdr_Àn
, *
¥iv
)

378 
lib80211_tkù_d©a
 *
tkey
 = 
¥iv
;

379 
u8
 
rc4key
[16];

380 
u8
 
keyidx
, *
pos
;

381 
u32
 
iv32
;

382 
u16
 
iv16
;

383 
õì80211_hdr
 *
hdr
;

384 
u8
 
icv
[4];

385 
u32
 
¸c
;

386 
∂í
;

388 
hdr
 = (
õì80211_hdr
 *)
skb
->
d©a
;

390 i‡(
tkey
->
Êags
 & 
IEEE80211_CRYPTO_TKIP_COUNTERMEASURES
) {

391 
	`√t_dbg_øãlimôed
("TKIP countermeasures: droppedÑeceivedÖacket from %pM\n",

392 
hdr
->
addr2
);

396 i‡(
skb
->
Àn
 < 
hdr_Àn
 + 
TKIP_HDR_LEN
 + 4)

399 
pos
 = 
skb
->
d©a
 + 
hdr_Àn
;

400 
keyidx
 = 
pos
[3];

401 i‡(!(
keyidx
 & (1 << 5))) {

402 
	`√t_dbg_øãlimôed
("TKIP:ÑeceivedÖacket without ExtIV flag from %pM\n",

403 
hdr
->
addr2
);

406 
keyidx
 >>= 6;

407 i‡(
tkey
->
key_idx
 !
keyidx
) {

408 
	`√t_dbg_øãlimôed
("TKIP: RXÅkey->key_idx=%d frame keyidx=%d\n",

409 
tkey
->
key_idx
, 
keyidx
);

412 i‡(!
tkey
->
key_£t
) {

413 
	`√t_dbg_øãlimôed
("TKIP:ÑeceivedÖacket from %pM with keyid=%dÅhat doesÇot haveá configured key\n",

414 
hdr
->
addr2
, 
keyidx
);

417 
iv16
 = (
pos
[0] << 8) |Öos[2];

418 
iv32
 = 
pos
[4] | (pos[5] << 8) | (pos[6] << 16) | (pos[7] << 24);

419 
pos
 +
TKIP_HDR_LEN
;

421 i‡(
	`tkù_ª∂ay_check
(
iv32
, 
iv16
, 
tkey
->
rx_iv32
,Åkey->
rx_iv16
)) {

422 #ifde‡
CONFIG_LIB80211_DEBUG


423 
	`√t_dbg_øãlimôed
("TKIP:Ñeplay detected: STA=%pMÖrevious TSC %08x%04xÑeceived TSC %08x%04x\n",

424 
hdr
->
addr2
, 
tkey
->
rx_iv32
,Åkey->
rx_iv16
,

425 
iv32
, 
iv16
);

427 
tkey
->
dŸ11RSNASètsTKIPRïœys
++;

431 i‡(
iv32
 !
tkey
->
rx_iv32
 || !tkey->
rx_pha£1_d⁄e
) {

432 
	`tkù_mixög_pha£1
(
tkey
->
rx_âak
,Åkey->
key
, 
hdr
->
addr2
, 
iv32
);

433 
tkey
->
rx_pha£1_d⁄e
 = 1;

435 
	`tkù_mixög_pha£2
(
rc4key
, 
tkey
->
key
,Åkey->
rx_âak
, 
iv16
);

437 
∂í
 = 
skb
->
Àn
 - 
hdr_Àn
 - 12;

439 
	`¨c4_£tkey
(&
tkey
->
rx_˘x_¨c4
, 
rc4key
, 16);

440 
	`¨c4_¸y±
(&
tkey
->
rx_˘x_¨c4
, 
pos
,Öos, 
∂í
 + 4);

442 
¸c
 = ~
	`¸c32_À
(~0, 
pos
, 
∂í
);

443 
icv
[0] = 
¸c
;

444 
icv
[1] = 
¸c
 >> 8;

445 
icv
[2] = 
¸c
 >> 16;

446 
icv
[3] = 
¸c
 >> 24;

447 i‡(
	`memcmp
(
icv
, 
pos
 + 
∂í
, 4) != 0) {

448 i‡(
iv32
 !
tkey
->
rx_iv32
) {

451 
tkey
->
rx_pha£1_d⁄e
 = 0;

453 #ifde‡
CONFIG_LIB80211_DEBUG


454 
	`√t_dbg_øãlimôed
("TKIP: ICVÉrror detected: STA=%pM\n",

455 
hdr
->
addr2
);

457 
tkey
->
dŸ11RSNASètsTKIPICVEº‹s
++;

463 
tkey
->
rx_iv32_√w
 = 
iv32
;

464 
tkey
->
rx_iv16_√w
 = 
iv16
;

467 
	`memmove
(
skb
->
d©a
 + 
TKIP_HDR_LEN
, skb->d©a, 
hdr_Àn
);

468 
	`skb_puŒ
(
skb
, 
TKIP_HDR_LEN
);

469 
	`skb_åim
(
skb
, skb->
Àn
 - 4);

471  
keyidx
;

472 
	}
}

474 
	$mich´l_mic
(
¸y±o_shash
 *
tfm_mich´l
, 
u8
 *
key
, u8 *
hdr
,

475 
u8
 *
d©a
, 
size_t
 
d©a_Àn
, u8 *
mic
)

477 
	`SHASH_DESC_ON_STACK
(
desc
, 
tfm_mich´l
);

478 
îr
;

480 i‡(
tfm_mich´l
 =
NULL
) {

481 
	`¥_w¨n
("%s():Åfm_mich´»=NULL\n", 
__func__
);

485 
desc
->
tfm
 = 
tfm_mich´l
;

487 i‡(
	`¸y±o_shash_£tkey
(
tfm_mich´l
, 
key
, 8))

490 
îr
 = 
	`¸y±o_shash_öô
(
desc
);

491 i‡(
îr
)

492 
out
;

493 
îr
 = 
	`¸y±o_shash_upd©e
(
desc
, 
hdr
, 16);

494 i‡(
îr
)

495 
out
;

496 
îr
 = 
	`¸y±o_shash_upd©e
(
desc
, 
d©a
, 
d©a_Àn
);

497 i‡(
îr
)

498 
out
;

499 
îr
 = 
	`¸y±o_shash_föÆ
(
desc
, 
mic
);

501 
out
:

502 
	`shash_desc_zîo
(
desc
);

503  
îr
;

504 
	}
}

506 
	$mich´l_mic_hdr
(
sk_buff
 *
skb
, 
u8
 * 
hdr
)

508 
õì80211_hdr
 *
hdr11
;

510 
hdr11
 = (
õì80211_hdr
 *)
skb
->
d©a
;

512 
	`À16_to_˝u
(
hdr11
->
‰ame_c⁄åﬁ
) &

513 (
IEEE80211_FCTL_FROMDS
 | 
IEEE80211_FCTL_TODS
)) {

514 
IEEE80211_FCTL_TODS
:

515 
	`mem˝y
(
hdr
, 
hdr11
->
addr3
, 
ETH_ALEN
);

516 
	`mem˝y
(
hdr
 + 
ETH_ALEN
, 
hdr11
->
addr2
, ETH_ALEN);

518 
IEEE80211_FCTL_FROMDS
:

519 
	`mem˝y
(
hdr
, 
hdr11
->
addr1
, 
ETH_ALEN
);

520 
	`mem˝y
(
hdr
 + 
ETH_ALEN
, 
hdr11
->
addr3
, ETH_ALEN);

522 
IEEE80211_FCTL_FROMDS
 | 
IEEE80211_FCTL_TODS
:

523 
	`mem˝y
(
hdr
, 
hdr11
->
addr3
, 
ETH_ALEN
);

524 
	`mem˝y
(
hdr
 + 
ETH_ALEN
, 
hdr11
->
addr4
, ETH_ALEN);

527 
	`mem˝y
(
hdr
, 
hdr11
->
addr1
, 
ETH_ALEN
);

528 
	`mem˝y
(
hdr
 + 
ETH_ALEN
, 
hdr11
->
addr2
, ETH_ALEN);

532 i‡(
	`õì80211_is_d©a_qos
(
hdr11
->
‰ame_c⁄åﬁ
)) {

533 
hdr
[12] = 
	`À16_to_˝u
(*((
__À16
 *)
	`õì80211_gë_qos_˘l
(
hdr11
)))

534 & 
IEEE80211_QOS_CTL_TID_MASK
;

536 
hdr
[12] = 0;

538 
hdr
[13] = hdr[14] = hdr[15] = 0;

539 
	}
}

541 
	$lib80211_mich´l_mic_add
(
sk_buff
 *
skb
, 
hdr_Àn
,

542 *
¥iv
)

544 
lib80211_tkù_d©a
 *
tkey
 = 
¥iv
;

545 
u8
 *
pos
;

547 i‡(
	`skb_èûroom
(
skb
Ë< 8 || skb->
Àn
 < 
hdr_Àn
) {

548 
	`¥ötk
(
KERN_DEBUG
 "InvalidÖacket for Michael MICádd "

550 
	`skb_èûroom
(
skb
), 
hdr_Àn
, skb->
Àn
);

554 
	`mich´l_mic_hdr
(
skb
, 
tkey
->
tx_hdr
);

555 
pos
 = 
	`skb_put
(
skb
, 8);

556 i‡(
	`mich´l_mic
(
tkey
->
tx_tfm_mich´l
, &tkey->
key
[16],Åkey->
tx_hdr
,

557 
skb
->
d©a
 + 
hdr_Àn
, skb->
Àn
 - 8 - hdr_Àn, 
pos
))

561 
	}
}

563 
	$lib80211_mich´l_mic_Áûuª
(
√t_devi˚
 *
dev
,

564 
õì80211_hdr
 *
hdr
,

565 
keyidx
)

567 
iwªq_d©a
 
wrqu
;

568 
iw_mich´lmicÁûuª
 
ev
;

571 
	`mem£t
(&
ev
, 0, (ev));

572 
ev
.
Êags
 = 
keyidx
 & 
IW_MICFAILURE_KEY_ID
;

573 i‡(
hdr
->
addr1
[0] & 0x01)

574 
ev
.
Êags
 |
IW_MICFAILURE_GROUP
;

576 
ev
.
Êags
 |
IW_MICFAILURE_PAIRWISE
;

577 
ev
.
§c_addr
.
ß_Ámûy
 = 
ARPHRD_ETHER
;

578 
	`mem˝y
(
ev
.
§c_addr
.
ß_d©a
, 
hdr
->
addr2
, 
ETH_ALEN
);

579 
	`mem£t
(&
wrqu
, 0, (wrqu));

580 
wrqu
.
d©a
.
Àngth
 = (
ev
);

581 
	`wúñess_£nd_evít
(
dev
, 
IWEVMICHAELMICFAILURE
, &
wrqu
, (*)&
ev
);

582 
	}
}

584 
	$lib80211_mich´l_mic_vîify
(
sk_buff
 *
skb
, 
keyidx
,

585 
hdr_Àn
, *
¥iv
)

587 
lib80211_tkù_d©a
 *
tkey
 = 
¥iv
;

588 
u8
 
mic
[8];

590 i‡(!
tkey
->
key_£t
)

593 
	`mich´l_mic_hdr
(
skb
, 
tkey
->
rx_hdr
);

594 i‡(
	`mich´l_mic
(
tkey
->
rx_tfm_mich´l
, &tkey->
key
[24],Åkey->
rx_hdr
,

595 
skb
->
d©a
 + 
hdr_Àn
, skb->
Àn
 - 8 - hdr_Àn, 
mic
))

597 i‡(
	`memcmp
(
mic
, 
skb
->
d©a
 + skb->
Àn
 - 8, 8) != 0) {

598 
õì80211_hdr
 *
hdr
;

599 
hdr
 = (
õì80211_hdr
 *)
skb
->
d©a
;

600 
	`¥ötk
(
KERN_DEBUG
 "%s: Michael MIC verification failed for "

602 
skb
->
dev
 ? skb->dev->
«me
 : "N/A", 
hdr
->
addr2
,

603 
keyidx
);

604 i‡(
skb
->
dev
)

605 
	`lib80211_mich´l_mic_Áûuª
(
skb
->
dev
, 
hdr
, 
keyidx
);

606 
tkey
->
dŸ11RSNASètsTKIPLoˇlMICFaûuªs
++;

612 
tkey
->
rx_iv32
 =Åkey->
rx_iv32_√w
;

613 
tkey
->
rx_iv16
 =Åkey->
rx_iv16_√w
;

615 
	`skb_åim
(
skb
, skb->
Àn
 - 8);

618 
	}
}

620 
	$lib80211_tkù_£t_key
(*
key
, 
Àn
, 
u8
 * 
£q
, *
¥iv
)

622 
lib80211_tkù_d©a
 *
tkey
 = 
¥iv
;

623 
keyidx
;

624 
¸y±o_shash
 *
tfm
 = 
tkey
->
tx_tfm_mich´l
;

625 
¨c4_˘x
 *
tfm2
 = &
tkey
->
tx_˘x_¨c4
;

626 
¸y±o_shash
 *
tfm3
 = 
tkey
->
rx_tfm_mich´l
;

627 
¨c4_˘x
 *
tfm4
 = &
tkey
->
rx_˘x_¨c4
;

629 
keyidx
 = 
tkey
->
key_idx
;

630 
	`mem£t
(
tkey
, 0, (*tkey));

631 
tkey
->
key_idx
 = 
keyidx
;

632 
tkey
->
tx_tfm_mich´l
 = 
tfm
;

633 
tkey
->
tx_˘x_¨c4
 = *
tfm2
;

634 
tkey
->
rx_tfm_mich´l
 = 
tfm3
;

635 
tkey
->
rx_˘x_¨c4
 = *
tfm4
;

636 i‡(
Àn
 =
TKIP_KEY_LEN
) {

637 
	`mem˝y
(
tkey
->
key
, key, 
TKIP_KEY_LEN
);

638 
tkey
->
key_£t
 = 1;

639 
tkey
->
tx_iv16
 = 1;

640 i‡(
£q
) {

641 
tkey
->
rx_iv32
 = (
£q
[5] << 24) | (seq[4] << 16) |

642 (
£q
[3] << 8) | seq[2];

643 
tkey
->
rx_iv16
 = (
£q
[1] << 8) | seq[0];

645 } i‡(
Àn
 == 0)

646 
tkey
->
key_£t
 = 0;

651 
	}
}

653 
	$lib80211_tkù_gë_key
(*
key
, 
Àn
, 
u8
 * 
£q
, *
¥iv
)

655 
lib80211_tkù_d©a
 *
tkey
 = 
¥iv
;

657 i‡(
Àn
 < 
TKIP_KEY_LEN
)

660 i‡(!
tkey
->
key_£t
)

662 
	`mem˝y
(
key
, 
tkey
->key, 
TKIP_KEY_LEN
);

664 i‡(
£q
) {

671 
£q
[0] = 
tkey
->
tx_iv16
;

672 
£q
[1] = 
tkey
->
tx_iv16
 >> 8;

673 
£q
[2] = 
tkey
->
tx_iv32
;

674 
£q
[3] = 
tkey
->
tx_iv32
 >> 8;

675 
£q
[4] = 
tkey
->
tx_iv32
 >> 16;

676 
£q
[5] = 
tkey
->
tx_iv32
 >> 24;

679  
TKIP_KEY_LEN
;

680 
	}
}

682 
	$lib80211_tkù_¥öt_°©s
(
£q_fûe
 *
m
, *
¥iv
)

684 
lib80211_tkù_d©a
 *
tkù
 = 
¥iv
;

685 
	`£q_¥ötf
(
m
,

690 
tkù
->
key_idx
,Åkù->
key_£t
,

691 (
tkù
->
tx_iv32
 >> 24) & 0xff,

692 (
tkù
->
tx_iv32
 >> 16) & 0xff,

693 (
tkù
->
tx_iv32
 >> 8) & 0xff,

694 
tkù
->
tx_iv32
 & 0xff,

695 (
tkù
->
tx_iv16
 >> 8) & 0xff,

696 
tkù
->
tx_iv16
 & 0xff,

697 (
tkù
->
rx_iv32
 >> 24) & 0xff,

698 (
tkù
->
rx_iv32
 >> 16) & 0xff,

699 (
tkù
->
rx_iv32
 >> 8) & 0xff,

700 
tkù
->
rx_iv32
 & 0xff,

701 (
tkù
->
rx_iv16
 >> 8) & 0xff,

702 
tkù
->
rx_iv16
 & 0xff,

703 
tkù
->
dŸ11RSNASètsTKIPRïœys
,

704 
tkù
->
dŸ11RSNASètsTKIPICVEº‹s
,

705 
tkù
->
dŸ11RSNASètsTKIPLoˇlMICFaûuªs
);

706 
	}
}

708 
lib80211_¸y±o_›s
 
	glib80211_¸y±_tkù
 = {

709 .
«me
 = "TKIP",

710 .
	göô
 = 
lib80211_tkù_öô
,

711 .
	gdeöô
 = 
lib80211_tkù_deöô
,

712 .
	gí¸y±_mpdu
 = 
lib80211_tkù_í¸y±
,

713 .
	gde¸y±_mpdu
 = 
lib80211_tkù_de¸y±
,

714 .
	gí¸y±_msdu
 = 
lib80211_mich´l_mic_add
,

715 .
	gde¸y±_msdu
 = 
lib80211_mich´l_mic_vîify
,

716 .
	g£t_key
 = 
lib80211_tkù_£t_key
,

717 .
	ggë_key
 = 
lib80211_tkù_gë_key
,

718 .
	g¥öt_°©s
 = 
lib80211_tkù_¥öt_°©s
,

719 .
	gexåa_mpdu_¥efix_Àn
 = 4 + 4,

720 .
	gexåa_mpdu_po°fix_Àn
 = 4,

721 .
	gexåa_msdu_po°fix_Àn
 = 8,

722 .
	ggë_Êags
 = 
lib80211_tkù_gë_Êags
,

723 .
	g£t_Êags
 = 
lib80211_tkù_£t_Êags
,

724 .
	gow√r
 = 
THIS_MODULE
,

727 
__öô
 
	$lib80211_¸y±o_tkù_öô
()

729  
	`lib80211_ªgi°î_¸y±o_›s
(&
lib80211_¸y±_tkù
);

730 
	}
}

732 
__exô
 
	$lib80211_¸y±o_tkù_exô
()

734 
	`lib80211_uƒegi°î_¸y±o_›s
(&
lib80211_¸y±_tkù
);

735 
	}
}

737 
moduÀ_öô
(
lib80211_¸y±o_tkù_öô
);

738 
moduÀ_exô
(
lib80211_¸y±o_tkù_exô
);

	@lib80211_crypt_tkip.mod.c

1 
	~<löux/moduÀ.h
>

2 
	#INCLUDE_VERMAGIC


	)

3 
	~<löux/buûd-ß….h
>

4 
	~<löux/ñ‚Ÿe-…o.h
>

5 
	~<löux/exp‹t-öã∫Æ.h
>

6 
	~<löux/vîmagic.h
>

7 
	~<löux/compûî.h
>

9 #ifde‡
CONFIG_UNWINDER_ORC


10 
	~<asm/‹c_hódî.h
>

11 
	gORC_HEADER
;

14 
	gBUILD_SALT
;

15 
	gBUILD_LTO_INFO
;

17 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

18 
MODULE_INFO
(
«me
, 
KBUILD_MODNAME
);

20 
__visibÀ
 
moduÀ
 
__this_moduÀ


21 
__£˘i⁄
(".gnu.linkonce.this_module") = {

22 .
«me
 = 
KBUILD_MODNAME
,

23 .
	göô
 = 
öô_moduÀ
,

24 #ifde‡
CONFIG_MODULE_UNLOAD


25 .
	gexô
 = 
˛ónup_moduÀ
,

27 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

30 #ifde‡
CONFIG_MITIGATION_RETPOLINE


31 
MODULE_INFO
(
ªçﬁöe
, "Y");

36 c⁄° 
modvîsi⁄_öfo
 
	g____vîsi⁄s
[]

37 
__u£d
 
__£˘i⁄
("__versions") = {

70 
MODULE_INFO
(
dïíds
, "libarc4,lib80211");

73 
MODULE_INFO
(
§cvîsi⁄
, "AC70624B059A66F8BC37BD1");

	@lib80211_crypt_wep.c

9 
	~<löux/îr.h
>

10 
	~<löux/fùs.h
>

11 
	~<löux/moduÀ.h
>

12 
	~<löux/öô.h
>

13 
	~<löux/¶ab.h
>

14 
	~<löux/øndom.h
>

15 
	~<löux/sˇâîli°.h
>

16 
	~<löux/skbuff.h
>

17 
	~<löux/mm.h
>

18 
	~<asm/°rög.h
>

20 
	~<√t/lib80211.h
>

22 
	~<¸y±o/¨c4.h
>

23 
	~<löux/¸c32.h
>

25 
MODULE_AUTHOR
("Jouni Malinen");

26 
MODULE_DESCRIPTION
("lib80211 crypt: WEP");

27 
MODULE_LICENSE
("GPL");

29 
	slib80211_wï_d©a
 {

30 
u32
 
	miv
;

31 
	#WEP_KEY_LEN
 13

	)

32 
u8
 
	mkey
[
WEP_KEY_LEN
 + 1];

33 
u8
 
	mkey_Àn
;

34 
u8
 
	mkey_idx
;

35 
¨c4_˘x
 
	mtx_˘x
;

36 
¨c4_˘x
 
	mrx_˘x
;

39 *
	$lib80211_wï_öô
(
keyidx
)

41 
lib80211_wï_d©a
 *
¥iv
;

43 i‡(
fùs_íabÀd
)

44  
NULL
;

46 
¥iv
 = 
	`kzÆloc
((*¥iv), 
GFP_ATOMIC
);

47 i‡(
¥iv
 =
NULL
)

48  
NULL
;

49 
¥iv
->
key_idx
 = 
keyidx
;

52 
	`gë_øndom_byãs
(&
¥iv
->
iv
, 4);

54  
¥iv
;

55 
	}
}

57 
	$lib80211_wï_deöô
(*
¥iv
)

59 
	`k‰ì_£nsôive
(
¥iv
);

60 
	}
}

63 
	$lib80211_wï_buûd_iv
(
sk_buff
 *
skb
, 
hdr_Àn
,

64 
u8
 *
key
, 
keyÀn
, *
¥iv
)

66 
lib80211_wï_d©a
 *
wï
 = 
¥iv
;

67 
u32
 
kÀn
;

68 
u8
 *
pos
;

70 i‡(
	`skb_hódroom
(
skb
Ë< 4 || skb->
Àn
 < 
hdr_Àn
)

73 
pos
 = 
	`skb_push
(
skb
, 4);

74 
	`memmove
(
pos
,Öo†+ 4, 
hdr_Àn
);

75 
pos
 +
hdr_Àn
;

77 
kÀn
 = 3 + 
wï
->
key_Àn
;

79 
wï
->
iv
++;

84 i‡((
wï
->
iv
 & 0xff00) == 0xff00) {

85 
u8
 
B
 = (
wï
->
iv
 >> 16) & 0xff;

86 i‡(
B
 >3 && B < 
kÀn
)

87 
wï
->
iv
 += 0x0100;

91 *
pos
++ = (
wï
->
iv
 >> 16) & 0xff;

92 *
pos
++ = (
wï
->
iv
 >> 8) & 0xff;

93 *
pos
++ = 
wï
->
iv
 & 0xff;

94 *
pos
++ = 
wï
->
key_idx
 << 6;

97 
	}
}

105 
	$lib80211_wï_í¸y±
(
sk_buff
 *
skb
, 
hdr_Àn
, *
¥iv
)

107 
lib80211_wï_d©a
 *
wï
 = 
¥iv
;

108 
u32
 
¸c
, 
kÀn
, 
Àn
;

109 
u8
 *
pos
, *
icv
;

110 
u8
 
key
[
WEP_KEY_LEN
 + 3];

113 i‡(
	`skb_èûroom
(
skb
) < 4)

117 i‡(
	`lib80211_wï_buûd_iv
(
skb
, 
hdr_Àn
, 
NULL
, 0, 
¥iv
))

121 
	`skb_c›y_‰om_löór_d©a_off£t
(
skb
, 
hdr_Àn
, 
key
, 3);

124 
	`mem˝y
(
key
 + 3, 
wï
->key, wï->
key_Àn
);

126 
Àn
 = 
skb
->À¿- 
hdr_Àn
 - 4;

127 
pos
 = 
skb
->
d©a
 + 
hdr_Àn
 + 4;

128 
kÀn
 = 3 + 
wï
->
key_Àn
;

131 
¸c
 = ~
	`¸c32_À
(~0, 
pos
, 
Àn
);

132 
icv
 = 
	`skb_put
(
skb
, 4);

133 
icv
[0] = 
¸c
;

134 
icv
[1] = 
¸c
 >> 8;

135 
icv
[2] = 
¸c
 >> 16;

136 
icv
[3] = 
¸c
 >> 24;

138 
	`¨c4_£tkey
(&
wï
->
tx_˘x
, 
key
, 
kÀn
);

139 
	`¨c4_¸y±
(&
wï
->
tx_˘x
, 
pos
,Öos, 
Àn
 + 4);

142 
	}
}

151 
	$lib80211_wï_de¸y±
(
sk_buff
 *
skb
, 
hdr_Àn
, *
¥iv
)

153 
lib80211_wï_d©a
 *
wï
 = 
¥iv
;

154 
u32
 
¸c
, 
kÀn
, 
∂í
;

155 
u8
 
key
[
WEP_KEY_LEN
 + 3];

156 
u8
 
keyidx
, *
pos
, 
icv
[4];

158 i‡(
skb
->
Àn
 < 
hdr_Àn
 + 8)

161 
pos
 = 
skb
->
d©a
 + 
hdr_Àn
;

162 
key
[0] = *
pos
++;

163 
key
[1] = *
pos
++;

164 
key
[2] = *
pos
++;

165 
keyidx
 = *
pos
++ >> 6;

166 i‡(
keyidx
 !
wï
->
key_idx
)

169 
kÀn
 = 3 + 
wï
->
key_Àn
;

172 
	`mem˝y
(
key
 + 3, 
wï
->key, wï->
key_Àn
);

175 
∂í
 = 
skb
->
Àn
 - 
hdr_Àn
 - 8;

177 
	`¨c4_£tkey
(&
wï
->
rx_˘x
, 
key
, 
kÀn
);

178 
	`¨c4_¸y±
(&
wï
->
rx_˘x
, 
pos
,Öos, 
∂í
 + 4);

180 
¸c
 = ~
	`¸c32_À
(~0, 
pos
, 
∂í
);

181 
icv
[0] = 
¸c
;

182 
icv
[1] = 
¸c
 >> 8;

183 
icv
[2] = 
¸c
 >> 16;

184 
icv
[3] = 
¸c
 >> 24;

185 i‡(
	`memcmp
(
icv
, 
pos
 + 
∂í
, 4) != 0) {

191 
	`memmove
(
skb
->
d©a
 + 4, skb->d©a, 
hdr_Àn
);

192 
	`skb_puŒ
(
skb
, 4);

193 
	`skb_åim
(
skb
, skb->
Àn
 - 4);

196 
	}
}

198 
	$lib80211_wï_£t_key
(*
key
, 
Àn
, 
u8
 * 
£q
, *
¥iv
)

200 
lib80211_wï_d©a
 *
wï
 = 
¥iv
;

202 i‡(
Àn
 < 0 ||Üí > 
WEP_KEY_LEN
)

205 
	`mem˝y
(
wï
->
key
, key, 
Àn
);

206 
wï
->
key_Àn
 = 
Àn
;

209 
	}
}

211 
	$lib80211_wï_gë_key
(*
key
, 
Àn
, 
u8
 * 
£q
, *
¥iv
)

213 
lib80211_wï_d©a
 *
wï
 = 
¥iv
;

215 i‡(
Àn
 < 
wï
->
key_Àn
)

218 
	`mem˝y
(
key
, 
wï
->key, wï->
key_Àn
);

220  
wï
->
key_Àn
;

221 
	}
}

223 
	$lib80211_wï_¥öt_°©s
(
£q_fûe
 *
m
, *
¥iv
)

225 
lib80211_wï_d©a
 *
wï
 = 
¥iv
;

226 
	`£q_¥ötf
(
m
, "key[%d]álg=WEPÜí=%d\n", 
wï
->
key_idx
, wï->
key_Àn
);

227 
	}
}

229 
lib80211_¸y±o_›s
 
	glib80211_¸y±_wï
 = {

230 .
«me
 = "WEP",

231 .
	göô
 = 
lib80211_wï_öô
,

232 .
	gdeöô
 = 
lib80211_wï_deöô
,

233 .
	gí¸y±_mpdu
 = 
lib80211_wï_í¸y±
,

234 .
	gde¸y±_mpdu
 = 
lib80211_wï_de¸y±
,

235 .
	gí¸y±_msdu
 = 
NULL
,

236 .
	gde¸y±_msdu
 = 
NULL
,

237 .
	g£t_key
 = 
lib80211_wï_£t_key
,

238 .
	ggë_key
 = 
lib80211_wï_gë_key
,

239 .
	g¥öt_°©s
 = 
lib80211_wï_¥öt_°©s
,

240 .
	gexåa_mpdu_¥efix_Àn
 = 4,

241 .
	gexåa_mpdu_po°fix_Àn
 = 4,

242 .
	gow√r
 = 
THIS_MODULE
,

245 
__öô
 
	$lib80211_¸y±o_wï_öô
()

247  
	`lib80211_ªgi°î_¸y±o_›s
(&
lib80211_¸y±_wï
);

248 
	}
}

250 
__exô
 
	$lib80211_¸y±o_wï_exô
()

252 
	`lib80211_uƒegi°î_¸y±o_›s
(&
lib80211_¸y±_wï
);

253 
	}
}

255 
moduÀ_öô
(
lib80211_¸y±o_wï_öô
);

256 
moduÀ_exô
(
lib80211_¸y±o_wï_exô
);

	@lib80211_crypt_wep.mod.c

1 
	~<löux/moduÀ.h
>

2 
	#INCLUDE_VERMAGIC


	)

3 
	~<löux/buûd-ß….h
>

4 
	~<löux/ñ‚Ÿe-…o.h
>

5 
	~<löux/exp‹t-öã∫Æ.h
>

6 
	~<löux/vîmagic.h
>

7 
	~<löux/compûî.h
>

9 #ifde‡
CONFIG_UNWINDER_ORC


10 
	~<asm/‹c_hódî.h
>

11 
	gORC_HEADER
;

14 
	gBUILD_SALT
;

15 
	gBUILD_LTO_INFO
;

17 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

18 
MODULE_INFO
(
«me
, 
KBUILD_MODNAME
);

20 
__visibÀ
 
moduÀ
 
__this_moduÀ


21 
__£˘i⁄
(".gnu.linkonce.this_module") = {

22 .
«me
 = 
KBUILD_MODNAME
,

23 .
	göô
 = 
öô_moduÀ
,

24 #ifde‡
CONFIG_MODULE_UNLOAD


25 .
	gexô
 = 
˛ónup_moduÀ
,

27 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

30 #ifde‡
CONFIG_MITIGATION_RETPOLINE


31 
MODULE_INFO
(
ªçﬁöe
, "Y");

36 c⁄° 
modvîsi⁄_öfo
 
	g____vîsi⁄s
[]

37 
__u£d
 
__£˘i⁄
("__versions") = {

60 
MODULE_INFO
(
dïíds
, "libarc4,lib80211");

63 
MODULE_INFO
(
§cvîsi⁄
, "DB34BFAB7A0F44F7CC83CB3");

	@mesh.c

6 
	~<löux/õì80211.h
>

7 
	~<löux/exp‹t.h
>

8 
	~<√t/cfg80211.h
>

9 
	~"∆80211.h
"

10 
	~"c‹e.h
"

11 
	~"rdev-›s.h
"

14 
	#MESH_TTL
 31

	)

15 
	#MESH_DEFAULT_ELEMENT_TTL
 31

	)

16 
	#MESH_MAX_RETR
 3

	)

17 
	#MESH_RET_T
 100

	)

18 
	#MESH_CONF_T
 100

	)

19 
	#MESH_HOLD_T
 100

	)

21 
	#MESH_PATH_TIMEOUT
 5000

	)

22 
	#MESH_RANN_INTERVAL
 5000

	)

23 
	#MESH_PATH_TO_ROOT_TIMEOUT
 6000

	)

24 
	#MESH_ROOT_INTERVAL
 5000

	)

25 
	#MESH_ROOT_CONFIRMATION_INTERVAL
 2000

	)

26 
	#MESH_DEFAULT_PLINK_TIMEOUT
 1800

	)

32 
	#MESH_PREQ_MIN_INT
 10

	)

33 
	#MESH_PERR_MIN_INT
 100

	)

34 
	#MESH_DIAM_TRAVERSAL_TIME
 50

	)

36 
	#MESH_RSSI_THRESHOLD
 0

	)

43 
	#MESH_PATH_REFRESH_TIME
 1000

	)

44 
	#MESH_MIN_DISCOVERY_TIMEOUT
 (2 * 
MESH_DIAM_TRAVERSAL_TIME
)

	)

47 
	#MESH_MAX_ESTAB_PLINKS
 32

	)

49 
	#MESH_MAX_PREQ_RETRIES
 4

	)

51 
	#MESH_SYNC_NEIGHBOR_OFFSET_MAX
 50

	)

53 
	#MESH_DEFAULT_BEACON_INTERVAL
 1000

	)

54 
	#MESH_DEFAULT_DTIM_PERIOD
 2

	)

55 
	#MESH_DEFAULT_AWAKE_WINDOW
 10

	)

57 c⁄° 
mesh_c⁄fig
 
	gdeÁu…_mesh_c⁄fig
 = {

58 .
dŸ11MeshRëryTimeout
 = 
MESH_RET_T
,

59 .
	gdŸ11MeshC⁄fúmTimeout
 = 
MESH_CONF_T
,

60 .
	gdŸ11MeshHﬁdögTimeout
 = 
MESH_HOLD_T
,

61 .
	gdŸ11MeshMaxRërõs
 = 
MESH_MAX_RETR
,

62 .
	gdŸ11MeshTTL
 = 
MESH_TTL
,

63 .
	gñemít_âl
 = 
MESH_DEFAULT_ELEMENT_TTL
,

64 .
	gauto_›í_∂öks
 = 
åue
,

65 .
	gdŸ11MeshMaxPìrLöks
 = 
MESH_MAX_ESTAB_PLINKS
,

66 .
	gdŸ11MeshNbrOff£tMaxNeighb‹
 = 
MESH_SYNC_NEIGHBOR_OFFSET_MAX
,

67 .
	gdŸ11MeshHWMPa˘iveP©hTimeout
 = 
MESH_PATH_TIMEOUT
,

68 .
	gdŸ11MeshHWMP¥eqMöI¡îvÆ
 = 
MESH_PREQ_MIN_INT
,

69 .
	gdŸ11MeshHWMP≥ºMöI¡îvÆ
 = 
MESH_PERR_MIN_INT
,

70 .
	gdŸ11MeshHWMP√tDümëîTøvîßlTime
 = 
MESH_DIAM_TRAVERSAL_TIME
,

71 .
	gdŸ11MeshHWMPmaxPREQªåõs
 = 
MESH_MAX_PREQ_RETRIES
,

72 .
	g∑th_ª‰esh_time
 = 
MESH_PATH_REFRESH_TIME
,

73 .
	gmö_discovîy_timeout
 = 
MESH_MIN_DISCOVERY_TIMEOUT
,

74 .
	gdŸ11MeshHWMPR™nI¡îvÆ
 = 
MESH_RANN_INTERVAL
,

75 .
	gdŸ11MeshG©eA¬oun˚mítPrŸocﬁ
 = 
Ál£
,

76 .
	gdŸ11MeshF‹w¨dög
 = 
åue
,

77 .
	grssi_thªshﬁd
 = 
MESH_RSSI_THRESHOLD
,

78 .
	ght_›mode
 = 
IEEE80211_HT_OP_MODE_PROTECTION_NONHT_MIXED
,

79 .
	gdŸ11MeshHWMPa˘iveP©hToRoŸTimeout
 = 
MESH_PATH_TO_ROOT_TIMEOUT
,

80 .
	gdŸ11MeshHWMProŸI¡îvÆ
 = 
MESH_ROOT_INTERVAL
,

81 .
	gdŸ11MeshHWMPc⁄fúm©i⁄I¡îvÆ
 = 
MESH_ROOT_CONFIRMATION_INTERVAL
,

82 .
	gpowî_mode
 = 
NL80211_MESH_POWER_ACTIVE
,

83 .
	gdŸ11MeshAwakeWödowDuøti⁄
 = 
MESH_DEFAULT_AWAKE_WINDOW
,

84 .
	g∂ök_timeout
 = 
MESH_DEFAULT_PLINK_TIMEOUT
,

85 .
	gdŸ11MeshNﬁó∫
 = 
Ál£
,

88 c⁄° 
mesh_£tup
 
	gdeÁu…_mesh_£tup
 = {

90 .
sync_mëhod
 = 
IEEE80211_SYNC_METHOD_NEIGHBOR_OFFSET
,

91 .
	g∑th_£l_¥Ÿo
 = 
IEEE80211_PATH_PROTOCOL_HWMP
,

92 .
	g∑th_mëric
 = 
IEEE80211_PATH_METRIC_AIRTIME
,

93 .
	gauth_id
 = 0,

94 .
	gõ
 = 
NULL
,

95 .
	gõ_Àn
 = 0,

96 .
	gis_£cuª
 = 
Ál£
,

97 .
	gu£r_mpm
 = 
Ál£
,

98 .
	gbóc⁄_öãrvÆ
 = 
MESH_DEFAULT_BEACON_INTERVAL
,

99 .
	gdtim_≥riod
 = 
MESH_DEFAULT_DTIM_PERIOD
,

102 
	$__cfg80211_joö_mesh
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

103 
√t_devi˚
 *
dev
,

104 
mesh_£tup
 *
£tup
,

105 c⁄° 
mesh_c⁄fig
 *
c⁄f
)

107 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

108 
îr
;

110 
	`BUILD_BUG_ON
(
IEEE80211_MAX_SSID_LEN
 !
IEEE80211_MAX_MESH_ID_LEN
);

112 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

114 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
)

115  -
EOPNOTSUPP
;

117 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_MESH_AUTH
) &&

118 
£tup
->
is_£cuª
)

119  -
EOPNOTSUPP
;

121 i‡(
wdev
->
u
.
mesh
.
id_Àn
)

122  -
EALREADY
;

124 i‡(!
£tup
->
mesh_id_Àn
)

125  -
EINVAL
;

127 i‡(!
rdev
->
›s
->
joö_mesh
)

128  -
EOPNOTSUPP
;

130 i‡(!
£tup
->
ch™def
.
ch™
) {

132 
£tup
->
ch™def
 = 
wdev
->
u
.
mesh
.
¥e£t_ch™def
;

135 i‡(!
£tup
->
ch™def
.
ch™
) {

137 
∆80211_b™d
 
b™d
;

139 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

140 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

141 
õì80211_ch™√l
 *
ch™
;

142 
i
;

144 
sb™d
 = 
rdev
->
wùhy
.
b™ds
[
b™d
];

145 i‡(!
sb™d
)

148 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++) {

149 
ch™
 = &
sb™d
->
ch™√ls
[
i
];

150 i‡(
ch™
->
Êags
 & (
IEEE80211_CHAN_NO_IR
 |

151 
IEEE80211_CHAN_DISABLED
 |

152 
IEEE80211_CHAN_RADAR
))

154 
£tup
->
ch™def
.
ch™
 = chan;

158 i‡(
£tup
->
ch™def
.
ch™
)

163 i‡(!
£tup
->
ch™def
.
ch™
)

164  -
EINVAL
;

166 
£tup
->
ch™def
.
width
 = 
NL80211_CHAN_WIDTH_20_NOHT
;

167 
£tup
->
ch™def
.
˚¡î_‰eq1
 = sëup->ch™def.
ch™
->
˚¡î_‰eq
;

174 i‡(!
£tup
->
basic_øãs
) {

175 
õì80211_suµ‹ãd_b™d
 *
sb™d
 =

176 
rdev
->
wùhy
.
b™ds
[
£tup
->
ch™def
.
ch™
->
b™d
];

178 i‡(
£tup
->
ch™def
.
ch™
->
b™d
 =
NL80211_BAND_2GHZ
) {

179 
i
;

188 
i
 = 0; i < 
sb™d
->
n_bôøãs
; i++) {

189 i‡(
sb™d
->
bôøãs
[
i
].
bôøã
 == 10) {

190 
£tup
->
basic_øãs
 = 
	`BIT
(
i
);

195 
£tup
->
basic_øãs
 = 
	`õì80211_m™d©‹y_øãs
(
sb™d
);

199 
îr
 = 
	`cfg80211_ch™def_dfs_ªquúed
(&
rdev
->
wùhy
,

200 &
£tup
->
ch™def
,

201 
NL80211_IFTYPE_MESH_POINT
);

202 i‡(
îr
 < 0)

203  
îr
;

204 i‡(
îr
 > 0 && !
£tup
->
u£r•a˚_h™dÀs_dfs
)

205  -
EINVAL
;

207 i‡(!
	`cfg80211_ªg_ˇn_bóc⁄
(&
rdev
->
wùhy
, &
£tup
->
ch™def
,

208 
NL80211_IFTYPE_MESH_POINT
))

209  -
EINVAL
;

211 
îr
 = 
	`rdev_joö_mesh
(
rdev
, 
dev
, 
c⁄f
, 
£tup
);

212 i‡(!
îr
) {

213 
	`mem˝y
(
wdev
->
u
.
mesh
.
id
, 
£tup
->
mesh_id
, sëup->
mesh_id_Àn
);

214 
wdev
->
u
.
mesh
.
id_Àn
 = 
£tup
->
mesh_id_Àn
;

215 
wdev
->
u
.
mesh
.
ch™def
 = 
£tup
->chandef;

216 
wdev
->
u
.
mesh
.
bóc⁄_öãrvÆ
 = 
£tup
->beacon_interval;

219  
îr
;

220 
	}
}

222 
	$cfg80211_£t_mesh_ch™√l
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

223 
wúñess_dev
 *
wdev
,

224 
cfg80211_ch™_def
 *
ch™def
)

226 
îr
;

235 i‡(
rdev
->
›s
->
libîès_£t_mesh_ch™√l
) {

236 i‡(
ch™def
->
width
 !
NL80211_CHAN_WIDTH_20_NOHT
)

237  -
EINVAL
;

239 i‡(!
	`√tif_ru¬ög
(
wdev
->
√tdev
))

240  -
ENETDOWN
;

242 
îr
 = 
	`rdev_libîès_£t_mesh_ch™√l
(
rdev
, 
wdev
->
√tdev
,

243 
ch™def
->
ch™
);

244 i‡(!
îr
)

245 
wdev
->
u
.
mesh
.
ch™def
 = *chandef;

247  
îr
;

250 i‡(
wdev
->
u
.
mesh
.
id_Àn
)

251  -
EBUSY
;

253 
wdev
->
u
.
mesh
.
¥e£t_ch™def
 = *
ch™def
;

255 
	}
}

257 
	$cfg80211_Àave_mesh
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

258 
√t_devi˚
 *
dev
)

260 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

261 
îr
;

263 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

265 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
)

266  -
EOPNOTSUPP
;

268 i‡(!
rdev
->
›s
->
Àave_mesh
)

269  -
EOPNOTSUPP
;

271 i‡(!
wdev
->
u
.
mesh
.
id_Àn
)

272  -
ENOTCONN
;

274 
îr
 = 
	`rdev_Àave_mesh
(
rdev
, 
dev
);

275 i‡(!
îr
) {

276 
wdev
->
c⁄n_ow√r_∆p‹tid
 = 0;

277 
wdev
->
u
.
mesh
.
id_Àn
 = 0;

278 
wdev
->
u
.
mesh
.
bóc⁄_öãrvÆ
 = 0;

279 
	`mem£t
(&
wdev
->
u
.
mesh
.
ch™def
, 0,

280 (
wdev
->
u
.
mesh
.
ch™def
));

281 
	`rdev_£t_qos_m≠
(
rdev
, 
dev
, 
NULL
);

282 
	`cfg80211_sched_dfs_ch™_upd©e
(
rdev
);

285  
îr
;

286 
	}
}

	@mlme.c

10 
	~<löux/kî√l.h
>

11 
	~<löux/moduÀ.h
>

12 
	~<löux/ëhîdevi˚.h
>

13 
	~<löux/√tdevi˚.h
>

14 
	~<löux/∆80211.h
>

15 
	~<löux/¶ab.h
>

16 
	~<löux/wúñess.h
>

17 
	~<√t/cfg80211.h
>

18 
	~<√t/iw_h™dÀr.h
>

19 
	~"c‹e.h
"

20 
	~"∆80211.h
"

21 
	~"rdev-›s.h
"

24 
	$cfg80211_rx_assoc_ª•
(
√t_devi˚
 *
dev
,

25 c⁄° 
cfg80211_rx_assoc_ª•_d©a
 *
d©a
)

27 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

28 
wùhy
 *wùhy = 
wdev
->wiphy;

29 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

30 
õì80211_mgmt
 *
mgmt
 = (õì80211_mgmà*)
d©a
->
buf
;

31 
cfg80211_c⁄√˘_ª•_∑øms
 
¸
 = {

32 .
timeout_ªas⁄
 = 
NL80211_TIMEOUT_UNSPECIFIED
,

33 .
ªq_õ
 = 
d©a
->
ªq_õs
,

34 .
ªq_õ_Àn
 = 
d©a
->
ªq_õs_Àn
,

35 .
ª•_õ
 = 
mgmt
->
u
.
assoc_ª•
.
v¨übÀ
,

36 .
ª•_õ_Àn
 = 
d©a
->
Àn
 -

37 
	`off£tof
(
õì80211_mgmt
,

38 
u
.
assoc_ª•
.
v¨übÀ
),

39 .
°©us
 = 
	`À16_to_˝u
(
mgmt
->
u
.
assoc_ª•
.
°©us_code
),

40 .
≠_mld_addr
 = 
d©a
->ap_mld_addr,

42 
lök_id
;

44 
lök_id
 = 0;Üök_id < 
	`ARRAY_SIZE
(
d©a
->
löks
);Üink_id++) {

45 
¸
.
löks
[
lök_id
].
°©us
 = 
d©a
->links[link_id].status;

46 
¸
.
löks
[
lök_id
].
bss
 = 
d©a
->links[link_id].bss;

48 
	`WARN_ON_ONCE
(
¸
.
löks
[
lök_id
].
°©us
 !
WLAN_STATUS_SUCCESS
 &&

49 (!
¸
.
≠_mld_addr
 || !¸.
löks
[
lök_id
].
bss
));

51 i‡(!
¸
.
löks
[
lök_id
].
bss
)

53 
¸
.
löks
[
lök_id
].
bssid
 = 
d©a
->löks[lök_id].
bss
->bssid;

54 
¸
.
löks
[
lök_id
].
addr
 = 
d©a
->links[link_id].addr;

56 
	`WARN_ON
(
¸
.
≠_mld_addr
 &&

57 !
	`is_vÆid_ëhî_addr
(
¸
.
löks
[
lök_id
].
addr
));

59 
	`BUG_ON
(!
¸
.
löks
[
lök_id
].
bss
->
ch™√l
);

61 i‡(
¸
.
löks
[
lök_id
].
bss
->
ch™√l
->
b™d
 =
NL80211_BAND_S1GHZ
) {

62 
	`WARN_ON
(
lök_id
);

63 
¸
.
ª•_õ
 = (
u8
 *)&
mgmt
->
u
.
s1g_assoc_ª•
.
v¨übÀ
;

64 
¸
.
ª•_õ_Àn
 = 
d©a
->
Àn
 -

65 
	`off£tof
(
õì80211_mgmt
,

66 
u
.
s1g_assoc_ª•
.
v¨übÀ
);

69 i‡(
¸
.
≠_mld_addr
)

70 
¸
.
vÆid_löks
 |
	`BIT
(
lök_id
);

73 
	`åa˚_cfg80211_£nd_rx_assoc
(
dev
, 
d©a
);

81 i‡(
	`cfg80211_sme_rx_assoc_ª•
(
wdev
, 
¸
.
°©us
)) {

82 
lök_id
 = 0;Üök_id < 
	`ARRAY_SIZE
(
d©a
->
löks
);Üink_id++) {

83 
cfg80211_bss
 *
bss
 = 
d©a
->
löks
[
lök_id
].bss;

85 i‡(!
bss
)

88 
	`cfg80211_unhﬁd_bss
(
	`bss_‰om_pub
(
bss
));

89 
	`cfg80211_put_bss
(
wùhy
, 
bss
);

94 
	`∆80211_£nd_rx_assoc
(
rdev
, 
dev
, 
d©a
);

96 
	`__cfg80211_c⁄√˘_ªsu…
(
dev
, &
¸
, cr.
°©us
 =
WLAN_STATUS_SUCCESS
);

97 
	}
}

98 
EXPORT_SYMBOL
(
cfg80211_rx_assoc_ª•
);

100 
	$cfg80211_¥o˚ss_auth
(
wúñess_dev
 *
wdev
,

101 c⁄° 
u8
 *
buf
, 
size_t
 
Àn
)

103 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

105 
	`∆80211_£nd_rx_auth
(
rdev
, 
wdev
->
√tdev
, 
buf
, 
Àn
, 
GFP_KERNEL
);

106 
	`cfg80211_sme_rx_auth
(
wdev
, 
buf
, 
Àn
);

107 
	}
}

109 
	$cfg80211_¥o˚ss_dóuth
(
wúñess_dev
 *
wdev
,

110 c⁄° 
u8
 *
buf
, 
size_t
 
Àn
,

111 
boﬁ
 
ªc⁄√˘
)

113 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

114 
õì80211_mgmt
 *
mgmt
 = (õì80211_mgmà*)
buf
;

115 c⁄° 
u8
 *
bssid
 = 
mgmt
->bssid;

116 
u16
 
ªas⁄_code
 = 
	`À16_to_˝u
(
mgmt
->
u
.
dóuth
.reason_code);

117 
boﬁ
 
‰om_≠
 = !
	`ëhî_addr_equÆ
(
mgmt
->
ß
, 
wdev
->
√tdev
->
dev_addr
);

119 
	`∆80211_£nd_dóuth
(
rdev
, 
wdev
->
√tdev
, 
buf
, 
Àn
, 
ªc⁄√˘
, 
GFP_KERNEL
);

121 i‡(!
wdev
->
c⁄√˘ed
 || !
	`ëhî_addr_equÆ
(wdev->
u
.
˛õ¡
.
c⁄√˘ed_addr
, 
bssid
))

124 
	`__cfg80211_disc⁄√˘ed
(
wdev
->
√tdev
, 
NULL
, 0, 
ªas⁄_code
, 
‰om_≠
);

125 
	`cfg80211_sme_dóuth
(
wdev
);

126 
	}
}

128 
	$cfg80211_¥o˚ss_dißssoc
(
wúñess_dev
 *
wdev
,

129 c⁄° 
u8
 *
buf
, 
size_t
 
Àn
,

130 
boﬁ
 
ªc⁄√˘
)

132 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

133 
õì80211_mgmt
 *
mgmt
 = (õì80211_mgmà*)
buf
;

134 c⁄° 
u8
 *
bssid
 = 
mgmt
->bssid;

135 
u16
 
ªas⁄_code
 = 
	`À16_to_˝u
(
mgmt
->
u
.
dißssoc
.reason_code);

136 
boﬁ
 
‰om_≠
 = !
	`ëhî_addr_equÆ
(
mgmt
->
ß
, 
wdev
->
√tdev
->
dev_addr
);

138 
	`∆80211_£nd_dißssoc
(
rdev
, 
wdev
->
√tdev
, 
buf
, 
Àn
, 
ªc⁄√˘
,

139 
GFP_KERNEL
);

141 i‡(
	`WARN_ON
(!
wdev
->
c⁄√˘ed
 ||

142 !
	`ëhî_addr_equÆ
(
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
, 
bssid
)))

145 
	`__cfg80211_disc⁄√˘ed
(
wdev
->
√tdev
, 
NULL
, 0, 
ªas⁄_code
, 
‰om_≠
);

146 
	`cfg80211_sme_dißssoc
(
wdev
);

147 
	}
}

149 
	$cfg80211_rx_mlme_mgmt
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
buf
, 
size_t
 
Àn
)

151 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

152 
õì80211_mgmt
 *
mgmt
 = (*)
buf
;

154 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

156 
	`åa˚_cfg80211_rx_mlme_mgmt
(
dev
, 
buf
, 
Àn
);

158 i‡(
	`WARN_ON
(
Àn
 < 2))

161 i‡(
	`õì80211_is_auth
(
mgmt
->
‰ame_c⁄åﬁ
))

162 
	`cfg80211_¥o˚ss_auth
(
wdev
, 
buf
, 
Àn
);

163 i‡(
	`õì80211_is_dóuth
(
mgmt
->
‰ame_c⁄åﬁ
))

164 
	`cfg80211_¥o˚ss_dóuth
(
wdev
, 
buf
, 
Àn
, 
Ál£
);

165 i‡(
	`õì80211_is_dißssoc
(
mgmt
->
‰ame_c⁄åﬁ
))

166 
	`cfg80211_¥o˚ss_dißssoc
(
wdev
, 
buf
, 
Àn
, 
Ál£
);

167 
	}
}

168 
EXPORT_SYMBOL
(
cfg80211_rx_mlme_mgmt
);

170 
	$cfg80211_auth_timeout
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
addr
)

172 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

173 
wùhy
 *wùhy = 
wdev
->wiphy;

174 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

176 
	`åa˚_cfg80211_£nd_auth_timeout
(
dev
, 
addr
);

178 
	`∆80211_£nd_auth_timeout
(
rdev
, 
dev
, 
addr
, 
GFP_KERNEL
);

179 
	`cfg80211_sme_auth_timeout
(
wdev
);

180 
	}
}

181 
EXPORT_SYMBOL
(
cfg80211_auth_timeout
);

183 
	$cfg80211_assoc_Áûuª
(
√t_devi˚
 *
dev
,

184 
cfg80211_assoc_Áûuª
 *
d©a
)

186 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

187 
wùhy
 *wùhy = 
wdev
->wiphy;

188 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

189 c⁄° 
u8
 *
addr
 = 
d©a
->
≠_mld_addr
 ?: d©a->
bss
[0]->
bssid
;

190 
i
;

192 
	`åa˚_cfg80211_£nd_assoc_Áûuª
(
dev
, 
d©a
);

194 i‡(
d©a
->
timeout
) {

195 
	`∆80211_£nd_assoc_timeout
(
rdev
, 
dev
, 
addr
, 
GFP_KERNEL
);

196 
	`cfg80211_sme_assoc_timeout
(
wdev
);

198 
	`cfg80211_sme_ab™d⁄_assoc
(
wdev
);

201 
i
 = 0; i < 
	`ARRAY_SIZE
(
d©a
->
bss
); i++) {

202 
cfg80211_bss
 *
bss
 = 
d©a
->bss[
i
];

204 i‡(!
bss
)

207 
	`cfg80211_unhﬁd_bss
(
	`bss_‰om_pub
(
bss
));

208 
	`cfg80211_put_bss
(
wùhy
, 
bss
);

210 
	}
}

211 
EXPORT_SYMBOL
(
cfg80211_assoc_Áûuª
);

213 
	$cfg80211_tx_mlme_mgmt
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
buf
, 
size_t
 
Àn
,

214 
boﬁ
 
ªc⁄√˘
)

216 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

217 
õì80211_mgmt
 *
mgmt
 = (*)
buf
;

219 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

221 
	`åa˚_cfg80211_tx_mlme_mgmt
(
dev
, 
buf
, 
Àn
, 
ªc⁄√˘
);

223 i‡(
	`WARN_ON
(
Àn
 < 2))

226 i‡(
	`õì80211_is_dóuth
(
mgmt
->
‰ame_c⁄åﬁ
))

227 
	`cfg80211_¥o˚ss_dóuth
(
wdev
, 
buf
, 
Àn
, 
ªc⁄√˘
);

229 
	`cfg80211_¥o˚ss_dißssoc
(
wdev
, 
buf
, 
Àn
, 
ªc⁄√˘
);

230 
	}
}

231 
EXPORT_SYMBOL
(
cfg80211_tx_mlme_mgmt
);

233 
	$cfg80211_mich´l_mic_Áûuª
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
addr
,

234 
∆80211_key_ty≥
 
key_ty≥
, 
key_id
,

235 c⁄° 
u8
 *
tsc
, 
gÂ_t
 
gÂ
)

237 
wùhy
 *wùhy = 
dev
->
õì80211_±r
->wiphy;

238 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

239 #ifde‡
CONFIG_CFG80211_WEXT


240 
iwªq_d©a
 
wrqu
;

241 *
buf
 = 
	`kmÆloc
(128, 
gÂ
);

243 i‡(
buf
) {

244 
	`mem£t
(&
wrqu
, 0, (wrqu));

245 
wrqu
.
d©a
.
Àngth
 =

246 
	`•rötf
(
buf
, "MLME-MICHAELMICFAILURE."

248 
key_id
, 
key_ty≥
 =
NL80211_KEYTYPE_GROUP


249 ? "brﬂd" : "uni", 
addr
);

250 
	`wúñess_£nd_evít
(
dev
, 
IWEVCUSTOM
, &
wrqu
, 
buf
);

251 
	`k‰ì
(
buf
);

255 
	`åa˚_cfg80211_mich´l_mic_Áûuª
(
dev
, 
addr
, 
key_ty≥
, 
key_id
, 
tsc
);

256 
	`∆80211_mich´l_mic_Áûuª
(
rdev
, 
dev
, 
addr
, 
key_ty≥
, 
key_id
, 
tsc
, 
gÂ
);

257 
	}
}

258 
EXPORT_SYMBOL
(
cfg80211_mich´l_mic_Áûuª
);

261 
	$cfg80211_mlme_auth
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

262 
√t_devi˚
 *
dev
,

263 
cfg80211_auth_ªque°
 *
ªq
)

265 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

267 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

269 i‡(!
ªq
->
bss
)

270  -
ENOENT
;

272 i‡(
ªq
->
lök_id
 >= 0 &&

273 !(
wdev
->
wùhy
->
Êags
 & 
WIPHY_FLAG_SUPPORTS_MLO
))

274  -
EINVAL
;

276 i‡(
ªq
->
auth_ty≥
 =
NL80211_AUTHTYPE_SHARED_KEY
) {

277 i‡(!
ªq
->
key
 || !ªq->
key_Àn
 ||

278 
ªq
->
key_idx
 < 0 ||Ñeq->key_idx > 3)

279  -
EINVAL
;

282 i‡(
wdev
->
c⁄√˘ed
 &&

283 
	`ëhî_addr_equÆ
(
ªq
->
bss
->
bssid
, 
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
))

284  -
EALREADY
;

286 i‡(
	`ëhî_addr_equÆ
(
ªq
->
bss
->
bssid
, 
dev
->
dev_addr
) ||

287 (
ªq
->
lök_id
 >= 0 &&

288 
	`ëhî_addr_equÆ
(
ªq
->
≠_mld_addr
, 
dev
->
dev_addr
)))

289  -
EINVAL
;

291  
	`rdev_auth
(
rdev
, 
dev
, 
ªq
);

292 
	}
}

295 
	$cfg80211_›î_™d_ht_ˇ∑
(
õì80211_ht_ˇp
 *
ht_ˇ∑
,

296 c⁄° 
õì80211_ht_ˇp
 *
ht_ˇ∑_mask
)

298 
i
;

299 
u8
 *
p1
, *
p2
;

300 i‡(!
ht_ˇ∑_mask
) {

301 
	`mem£t
(
ht_ˇ∑
, 0, (*ht_capa));

305 
p1
 = (
u8
*)(
ht_ˇ∑
);

306 
p2
 = (
u8
*)(
ht_ˇ∑_mask
);

307 
i
 = 0; i < (*
ht_ˇ∑
); i++)

308 
p1
[
i
] &
p2
[i];

309 
	}
}

312 
	$cfg80211_›î_™d_vht_ˇ∑
(
õì80211_vht_ˇp
 *
vht_ˇ∑
,

313 c⁄° 
õì80211_vht_ˇp
 *
vht_ˇ∑_mask
)

315 
i
;

316 
u8
 *
p1
, *
p2
;

317 i‡(!
vht_ˇ∑_mask
) {

318 
	`mem£t
(
vht_ˇ∑
, 0, (*vht_capa));

322 
p1
 = (
u8
*)(
vht_ˇ∑
);

323 
p2
 = (
u8
*)(
vht_ˇ∑_mask
);

324 
i
 = 0; i < (*
vht_ˇ∑
); i++)

325 
p1
[
i
] &
p2
[i];

326 
	}
}

329 
	$cfg80211_mlme_check_mlo_com∑t
(c⁄° 
õì80211_mu…i_lök_ñem
 *
mÀ_a
,

330 c⁄° 
õì80211_mu…i_lök_ñem
 *
mÀ_b
,

331 
√éök_ext_ack
 *
exèck
)

333 c⁄° 
õì80211_mÀ_basic_comm⁄_öfo
 *
comm⁄_a
, *
comm⁄_b
;

335 
comm⁄_a
 = (c⁄° *)
mÀ_a
->
v¨übÀ
;

336 
comm⁄_b
 = (c⁄° *)
mÀ_b
->
v¨übÀ
;

338 i‡(
	`memcmp
(
comm⁄_a
->
mld_mac_addr
, 
comm⁄_b
->mld_mac_addr, 
ETH_ALEN
)) {

339 
	`NL_SET_ERR_MSG
(
exèck
, "AP MLDáddress mismatch");

340  -
EINVAL
;

343 i‡(
	`õì80211_mÀ_gë_eml_med_sync_dñay
((c⁄° 
u8
 *)
mÀ_a
) !=

344 
	`õì80211_mÀ_gë_eml_med_sync_dñay
((c⁄° 
u8
 *)
mÀ_b
)) {

345 
	`NL_SET_ERR_MSG
(
exèck
, "link EML medium sync delay mismatch");

346  -
EINVAL
;

349 i‡(
	`õì80211_mÀ_gë_eml_ˇp
((c⁄° 
u8
 *)
mÀ_a
) !=

350 
	`õì80211_mÀ_gë_eml_ˇp
((c⁄° 
u8
 *)
mÀ_b
)) {

351 
	`NL_SET_ERR_MSG
(
exèck
, "link EML capabilities mismatch");

352  -
EINVAL
;

355 i‡(
	`õì80211_mÀ_gë_mld_ˇ∑_›
((c⁄° 
u8
 *)
mÀ_a
) !=

356 
	`õì80211_mÀ_gë_mld_ˇ∑_›
((c⁄° 
u8
 *)
mÀ_b
)) {

357 
	`NL_SET_ERR_MSG
(
exèck
, "link MLD capabilities/ops mismatch");

358  -
EINVAL
;

362 
	}
}

364 
	$cfg80211_mlme_check_mlo
(
√t_devi˚
 *
dev
,

365 
cfg80211_assoc_ªque°
 *
ªq
,

366 
√éök_ext_ack
 *
exèck
)

368 c⁄° 
õì80211_mu…i_lök_ñem
 *
mÀs
[
	`ARRAY_SIZE
(
ªq
->
löks
)] = {};

369 
i
;

371 i‡(
ªq
->
lök_id
 < 0)

374 i‡(!
ªq
->
löks
[ªq->
lök_id
].
bss
) {

375 
	`NL_SET_ERR_MSG
(
exèck
, "no BSS forássocÜink");

376  -
EINVAL
;

379 
	`rcu_ªad_lock
();

380 
i
 = 0; i < 
	`ARRAY_SIZE
(
ªq
->
löks
); i++) {

381 c⁄° 
cfg80211_bss_õs
 *
õs
;

382 c⁄° 
ñemít
 *
ml
;

384 i‡(!
ªq
->
löks
[
i
].
bss
)

387 i‡(
	`ëhî_addr_equÆ
(
ªq
->
löks
[
i
].
bss
->
bssid
, 
dev
->
dev_addr
)) {

388 
	`NL_SET_ERR_MSG
(
exèck
, "BSSID mustÇot be ouráddress");

389 
ªq
->
löks
[
i
].
îr‹
 = -
EINVAL
;

390 
îr‹
;

393 
õs
 = 
	`rcu_dîe„ªn˚
(
ªq
->
löks
[
i
].
bss
->ies);

394 
ml
 = 
	`cfg80211_föd_ext_ñem
(
WLAN_EID_EXT_EHT_MULTI_LINK
,

395 
õs
->
d©a
, ies->
Àn
);

396 i‡(!
ml
) {

397 
	`NL_SET_ERR_MSG
(
exèck
, "MLO BSS w/o MLÉlement");

398 
ªq
->
löks
[
i
].
îr‹
 = -
EINVAL
;

399 
îr‹
;

402 i‡(!
	`õì80211_mÀ_ty≥_ok
(
ml
->
d©a
 + 1,

403 
IEEE80211_ML_CONTROL_TYPE_BASIC
,

404 
ml
->
d©Æí
 - 1)) {

405 
	`NL_SET_ERR_MSG
(
exèck
, "BSS with invalid MLÉlement");

406 
ªq
->
löks
[
i
].
îr‹
 = -
EINVAL
;

407 
îr‹
;

410 
mÀs
[
i
] = (c⁄° *)(
ml
->
d©a
 + 1);

412 i‡(
	`õì80211_mÀ_gë_lök_id
((c⁄° 
u8
 *)
mÀs
[
i
]) != i) {

413 
	`NL_SET_ERR_MSG
(
exèck
, "link ID mismatch");

414 
ªq
->
löks
[
i
].
îr‹
 = -
EINVAL
;

415 
îr‹
;

419 i‡(
	`WARN_ON
(!
mÀs
[
ªq
->
lök_id
]))

420 
îr‹
;

422 
i
 = 0; i < 
	`ARRAY_SIZE
(
ªq
->
löks
); i++) {

423 i‡(
i
 =
ªq
->
lök_id
 || !ªq->
löks
[i].
bss
)

426 i‡(
	`WARN_ON
(!
mÀs
[
i
]))

427 
îr‹
;

429 i‡(
	`cfg80211_mlme_check_mlo_com∑t
(
mÀs
[
ªq
->
lök_id
], mÀs[
i
],

430 
exèck
)) {

431 
ªq
->
löks
[
i
].
îr‹
 = -
EINVAL
;

432 
îr‹
;

436 
	`rcu_ªad_u∆ock
();

438 
îr‹
:

439 
	`rcu_ªad_u∆ock
();

440  -
EINVAL
;

441 
	}
}

444 
	$cfg80211_mlme_assoc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

445 
√t_devi˚
 *
dev
,

446 
cfg80211_assoc_ªque°
 *
ªq
,

447 
√éök_ext_ack
 *
exèck
)

449 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

450 
îr
;

452 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

454 
îr
 = 
	`cfg80211_mlme_check_mlo
(
dev
, 
ªq
, 
exèck
);

455 i‡(
îr
)

456  
îr
;

458 i‡(
wdev
->
c⁄√˘ed
 &&

459 (!
ªq
->
¥ev_bssid
 ||

460 !
	`ëhî_addr_equÆ
(
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
, 
ªq
->
¥ev_bssid
)))

461  -
EALREADY
;

463 i‡((
ªq
->
bss
 && 
	`ëhî_addr_equÆ
‘eq->bss->
bssid
, 
dev
->
dev_addr
)) ||

464 (
ªq
->
lök_id
 >= 0 &&

465 
	`ëhî_addr_equÆ
(
ªq
->
≠_mld_addr
, 
dev
->
dev_addr
)))

466  -
EINVAL
;

468 
	`cfg80211_›î_™d_ht_ˇ∑
(&
ªq
->
ht_ˇ∑_mask
,

469 
rdev
->
wùhy
.
ht_ˇ∑_mod_mask
);

470 
	`cfg80211_›î_™d_vht_ˇ∑
(&
ªq
->
vht_ˇ∑_mask
,

471 
rdev
->
wùhy
.
vht_ˇ∑_mod_mask
);

473 
îr
 = 
	`rdev_assoc
(
rdev
, 
dev
, 
ªq
);

474 i‡(!
îr
) {

475 
lök_id
;

477 i‡(
ªq
->
bss
) {

478 
	`cfg80211_ªf_bss
(&
rdev
->
wùhy
, 
ªq
->
bss
);

479 
	`cfg80211_hﬁd_bss
(
	`bss_‰om_pub
(
ªq
->
bss
));

482 
lök_id
 = 0;Üök_id < 
	`ARRAY_SIZE
(
ªq
->
löks
);Üink_id++) {

483 i‡(!
ªq
->
löks
[
lök_id
].
bss
)

485 
	`cfg80211_ªf_bss
(&
rdev
->
wùhy
, 
ªq
->
löks
[
lök_id
].
bss
);

486 
	`cfg80211_hﬁd_bss
(
	`bss_‰om_pub
(
ªq
->
löks
[
lök_id
].
bss
));

489  
îr
;

490 
	}
}

492 
	$cfg80211_mlme_dóuth
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

493 
√t_devi˚
 *
dev
, c⁄° 
u8
 *
bssid
,

494 c⁄° 
u8
 *
õ
, 
õ_Àn
, 
u16
 
ªas⁄
,

495 
boﬁ
 
loˇl_°©e_ch™ge
)

497 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

498 
cfg80211_dóuth_ªque°
 
ªq
 = {

499 .
bssid
 = bssid,

500 .
ªas⁄_code
 = 
ªas⁄
,

501 .
õ
 = ie,

502 .
õ_Àn
 = ie_len,

503 .
loˇl_°©e_ch™ge
 =Üocal_state_change,

506 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

508 i‡(
loˇl_°©e_ch™ge
 &&

509 (!
wdev
->
c⁄√˘ed
 ||

510 !
	`ëhî_addr_equÆ
(
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
, 
bssid
)))

513 i‡(
	`ëhî_addr_equÆ
(
wdev
->
disc⁄√˘_bssid
, 
bssid
) ||

514 (
wdev
->
c⁄√˘ed
 &&

515 
	`ëhî_addr_equÆ
(
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
, 
bssid
)))

516 
wdev
->
c⁄n_ow√r_∆p‹tid
 = 0;

518  
	`rdev_dóuth
(
rdev
, 
dev
, &
ªq
);

519 
	}
}

521 
	$cfg80211_mlme_dißssoc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

522 
√t_devi˚
 *
dev
, c⁄° 
u8
 *
≠_addr
,

523 c⁄° 
u8
 *
õ
, 
õ_Àn
, 
u16
 
ªas⁄
,

524 
boﬁ
 
loˇl_°©e_ch™ge
)

526 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

527 
cfg80211_dißssoc_ªque°
 
ªq
 = {

528 .
ªas⁄_code
 = 
ªas⁄
,

529 .
loˇl_°©e_ch™ge
 =Üocal_state_change,

530 .
õ
 = ie,

531 .
õ_Àn
 = ie_len,

532 .
≠_addr
 =áp_addr,

534 
îr
;

536 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

538 i‡(!
wdev
->
c⁄√˘ed
)

539  -
ENOTCONN
;

541 i‡(
	`memcmp
(
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
, 
≠_addr
, 
ETH_ALEN
))

542  -
ENOTCONN
;

544 
îr
 = 
	`rdev_dißssoc
(
rdev
, 
dev
, &
ªq
);

545 i‡(
îr
)

546  
îr
;

549 
	`WARN_ON
(
wdev
->
c⁄√˘ed
);

551 
	}
}

553 
	$cfg80211_mlme_down
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

554 
√t_devi˚
 *
dev
)

556 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

557 
u8
 
bssid
[
ETH_ALEN
];

559 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

561 i‡(!
rdev
->
›s
->
dóuth
)

564 i‡(!
wdev
->
c⁄√˘ed
)

567 
	`mem˝y
(
bssid
, 
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
, 
ETH_ALEN
);

568 
	`cfg80211_mlme_dóuth
(
rdev
, 
dev
, 
bssid
, 
NULL
, 0,

569 
WLAN_REASON_DEAUTH_LEAVING
, 
Ál£
);

570 
	}
}

572 
	scfg80211_mgmt_ªgi°øti⁄
 {

573 
li°_hód
 
	mli°
;

574 
wúñess_dev
 *
	mwdev
;

576 
u32
 
	m∆p‹tid
;

578 
	mm©ch_Àn
;

580 
__À16
 
	m‰ame_ty≥
;

582 
boﬁ
 
	mmu…iˇ°_rx
;

584 
u8
 
	mm©ch
[];

587 
	$cfg80211_mgmt_ªgi°øti⁄s_upd©e
(
wúñess_dev
 *
wdev
)

589 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

590 
wúñess_dev
 *
tmp
;

591 
cfg80211_mgmt_ªgi°øti⁄
 *
ªg
;

592 
mgmt_‰ame_ªgs
 
upd
 = {};

594 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

596 
	`•ö_lock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

597 i‡(!
wdev
->
mgmt_ªgi°øti⁄s_√ed_upd©e
) {

598 
	`•ö_u∆ock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

602 
	`rcu_ªad_lock
();

603 
	`li°_f‹_óch_íåy_rcu
(
tmp
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

604 
	`li°_f‹_óch_íåy
(
ªg
, &
tmp
->
mgmt_ªgi°øti⁄s
, 
li°
) {

605 
u32
 
mask
 = 
	`BIT
(
	`À16_to_˝u
(
ªg
->
‰ame_ty≥
) >> 4);

606 
u32
 
mˇ°_mask
 = 0;

608 i‡(
ªg
->
mu…iˇ°_rx
)

609 
mˇ°_mask
 = 
mask
;

611 
upd
.
globÆ_°y≥s
 |
mask
;

612 
upd
.
globÆ_mˇ°_°y≥s
 |
mˇ°_mask
;

614 i‡(
tmp
 =
wdev
) {

615 
upd
.
öãrÁ˚_°y≥s
 |
mask
;

616 
upd
.
öãrÁ˚_mˇ°_°y≥s
 |
mˇ°_mask
;

620 
	`rcu_ªad_u∆ock
();

622 
wdev
->
mgmt_ªgi°øti⁄s_√ed_upd©e
 = 0;

623 
	`•ö_u∆ock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

625 
	`rdev_upd©e_mgmt_‰ame_ªgi°øti⁄s
(
rdev
, 
wdev
, &
upd
);

626 
	}
}

628 
	$cfg80211_mgmt_ªgi°øti⁄s_upd©e_wk
(
w‹k_°ru˘
 *
wk
)

630 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

631 
wúñess_dev
 *
wdev
;

633 
rdev
 = 
	`c⁄èöî_of
(
wk
, 
cfg80211_ªgi°îed_devi˚
,

634 
mgmt_ªgi°øti⁄s_upd©e_wk
);

636 
	`wùhy_lock
(&
rdev
->
wùhy
);

637 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
)

638 
	`cfg80211_mgmt_ªgi°øti⁄s_upd©e
(
wdev
);

639 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

640 
	}
}

642 
	$cfg80211_mlme_ªgi°î_mgmt
(
wúñess_dev
 *
wdev
, 
u32
 
¢d_p‹tid
,

643 
u16
 
‰ame_ty≥
, c⁄° 
u8
 *
m©ch_d©a
,

644 
m©ch_Àn
, 
boﬁ
 
mu…iˇ°_rx
,

645 
√éök_ext_ack
 *
exèck
)

647 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

648 
cfg80211_mgmt_ªgi°øti⁄
 *
ªg
, *
ƒeg
;

649 
îr
 = 0;

650 
u16
 
mgmt_ty≥
;

651 
boﬁ
 
upd©e_mu…iˇ°
 = 
Ál£
;

653 i‡(!
wdev
->
wùhy
->
mgmt_°y≥s
)

654  -
EOPNOTSUPP
;

656 i‡((
‰ame_ty≥
 & 
IEEE80211_FCTL_FTYPE
Ë!
IEEE80211_FTYPE_MGMT
) {

657 
	`NL_SET_ERR_MSG
(
exèck
, "frameÅypeÇot management");

658  -
EINVAL
;

661 i‡(
‰ame_ty≥
 & ~(
IEEE80211_FCTL_FTYPE
 | 
IEEE80211_FCTL_STYPE
)) {

662 
	`NL_SET_ERR_MSG
(
exèck
, "Invalid frameÅype");

663  -
EINVAL
;

666 
mgmt_ty≥
 = (
‰ame_ty≥
 & 
IEEE80211_FCTL_STYPE
) >> 4;

667 i‡(!(
wdev
->
wùhy
->
mgmt_°y≥s
[wdev->
i·y≥
].
rx
 & 
	`BIT
(
mgmt_ty≥
))) {

668 
	`NL_SET_ERR_MSG
(
exèck
,

670  -
EINVAL
;

681 i‡(
wdev
->
i·y≥
 =
NL80211_IFTYPE_STATION
 &&

682 (
‰ame_ty≥
 & 
IEEE80211_FCTL_STYPE
Ë=
IEEE80211_STYPE_AUTH
 &&

683 !(
m©ch_d©a
 && 
m©ch_Àn
 >= 2)) {

684 
	`NL_SET_ERR_MSG
(
exèck
,

686  -
EINVAL
;

689 
ƒeg
 = 
	`kzÆloc
((*
ªg
Ë+ 
m©ch_Àn
, 
GFP_KERNEL
);

690 i‡(!
ƒeg
)

691  -
ENOMEM
;

693 
	`•ö_lock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

695 
	`li°_f‹_óch_íåy
(
ªg
, &
wdev
->
mgmt_ªgi°øti⁄s
, 
li°
) {

696 
mÀn
 = 
	`mö
(
m©ch_Àn
, 
ªg
->match_len);

698 i‡(
‰ame_ty≥
 !
	`À16_to_˝u
(
ªg
->frame_type))

701 i‡(
	`memcmp
(
ªg
->
m©ch
, 
m©ch_d©a
, 
mÀn
) == 0) {

702 i‡(
ªg
->
mu…iˇ°_rx
 != multicast_rx) {

703 
upd©e_mu…iˇ°
 = 
åue
;

704 
ªg
->
mu…iˇ°_rx
 = multicast_rx;

707 
	`NL_SET_ERR_MSG
(
exèck
, "Matchálready configured");

708 
îr
 = -
EALREADY
;

713 i‡(
îr
)

714 
out
;

716 i‡(
upd©e_mu…iˇ°
) {

717 
	`k‰ì
(
ƒeg
);

719 
	`mem˝y
(
ƒeg
->
m©ch
, 
m©ch_d©a
, 
m©ch_Àn
);

720 
ƒeg
->
m©ch_Àn
 = match_len;

721 
ƒeg
->
∆p‹tid
 = 
¢d_p‹tid
;

722 
ƒeg
->
‰ame_ty≥
 = 
	`˝u_to_À16
(frame_type);

723 
ƒeg
->
wdev
 = wdev;

724 
ƒeg
->
mu…iˇ°_rx
 = multicast_rx;

725 
	`li°_add
(&
ƒeg
->
li°
, &
wdev
->
mgmt_ªgi°øti⁄s
);

727 
wdev
->
mgmt_ªgi°øti⁄s_√ed_upd©e
 = 1;

728 
	`•ö_u∆ock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

730 
	`cfg80211_mgmt_ªgi°øti⁄s_upd©e
(
wdev
);

734 
out
:

735 
	`k‰ì
(
ƒeg
);

736 
	`•ö_u∆ock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

738  
îr
;

739 
	}
}

741 
	$cfg80211_mlme_uƒegi°î_sockë
(
wúñess_dev
 *
wdev
, 
u32
 
∆p‹tid
)

743 
wùhy
 *wùhy = 
wdev
->wiphy;

744 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

745 
cfg80211_mgmt_ªgi°øti⁄
 *
ªg
, *
tmp
;

747 
	`•ö_lock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

749 
	`li°_f‹_óch_íåy_ß„
(
ªg
, 
tmp
, &
wdev
->
mgmt_ªgi°øti⁄s
, 
li°
) {

750 i‡(
ªg
->
∆p‹tid
 !=Çlportid)

753 
	`li°_dñ
(&
ªg
->
li°
);

754 
	`k‰ì
(
ªg
);

756 
wdev
->
mgmt_ªgi°øti⁄s_√ed_upd©e
 = 1;

757 
	`scheduÀ_w‹k
(&
rdev
->
mgmt_ªgi°øti⁄s_upd©e_wk
);

760 
	`•ö_u∆ock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

762 i‡(
∆p‹tid
 && 
rdev
->
¸ô_¥Ÿo_∆p‹tid
 ==Çlportid) {

763 
rdev
->
¸ô_¥Ÿo_∆p‹tid
 = 0;

764 
	`rdev_¸ô_¥Ÿo_°›
(
rdev
, 
wdev
);

767 i‡(
∆p‹tid
 =
wdev
->
≠_u√x≥˘ed_∆p‹tid
)

768 
wdev
->
≠_u√x≥˘ed_∆p‹tid
 = 0;

769 
	}
}

771 
	$cfg80211_mlme_purge_ªgi°øti⁄s
(
wúñess_dev
 *
wdev
)

773 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

774 
cfg80211_mgmt_ªgi°øti⁄
 *
ªg
, *
tmp
;

776 
	`•ö_lock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

777 
	`li°_f‹_óch_íåy_ß„
(
ªg
, 
tmp
, &
wdev
->
mgmt_ªgi°øti⁄s
, 
li°
) {

778 
	`li°_dñ
(&
ªg
->
li°
);

779 
	`k‰ì
(
ªg
);

781 
wdev
->
mgmt_ªgi°øti⁄s_√ed_upd©e
 = 1;

782 
	`•ö_u∆ock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

784 
	`cfg80211_mgmt_ªgi°øti⁄s_upd©e
(
wdev
);

785 
	}
}

787 
boﬁ
 
	$cfg80211_Ælowed_addªss
(
wúñess_dev
 *
wdev
, c⁄° 
u8
 *
addr
)

789 
i
;

791 
	`f‹_óch_vÆid_lök
(
wdev
, 
i
) {

792 i‡(
	`ëhî_addr_equÆ
(
addr
, 
wdev
->
löks
[
i
].addr))

793  
åue
;

796  
	`ëhî_addr_equÆ
(
addr
, 
	`wdev_addªss
(
wdev
));

797 
	}
}

799 
boﬁ
 
	$cfg80211_Ælowed_øndom_addªss
(
wúñess_dev
 *
wdev
,

800 c⁄° 
õì80211_mgmt
 *
mgmt
)

802 i‡(
	`õì80211_is_auth
(
mgmt
->
‰ame_c⁄åﬁ
) ||

803 
	`õì80211_is_dóuth
(
mgmt
->
‰ame_c⁄åﬁ
)) {

807 i‡(
	`wùhy_ext_„©uª_is£t
(

808 
wdev
->
wùhy
,

809 
NL80211_EXT_FEATURE_AUTH_AND_DEAUTH_RANDOM_TA
))

810  
åue
;

811 } i‡(
	`õì80211_is_a˘i⁄
(
mgmt
->
‰ame_c⁄åﬁ
) &&

812 
mgmt
->
u
.
a˘i⁄
.
ˇãg‹y
 =
WLAN_CATEGORY_PUBLIC
) {

816 i‡(!
wdev
->
c⁄√˘ed
 &&

817 
	`wùhy_ext_„©uª_is£t
(

818 
wdev
->
wùhy
,

819 
NL80211_EXT_FEATURE_MGMT_TX_RANDOM_TA
))

820  
åue
;

822 i‡(
wdev
->
c⁄√˘ed
 &&

823 
	`wùhy_ext_„©uª_is£t
(

824 
wdev
->
wùhy
,

825 
NL80211_EXT_FEATURE_MGMT_TX_RANDOM_TA_CONNECTED
))

826  
åue
;

829  
Ál£
;

830 
	}
}

832 
	$cfg80211_mlme_mgmt_tx
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

833 
wúñess_dev
 *
wdev
,

834 
cfg80211_mgmt_tx_∑øms
 *
∑øms
, 
u64
 *
cookõ
)

836 c⁄° 
õì80211_mgmt
 *
mgmt
;

837 
u16
 
°y≥
;

839 
	`lockdï_as£π_wùhy
(&
rdev
->
wùhy
);

841 i‡(!
wdev
->
wùhy
->
mgmt_°y≥s
)

842  -
EOPNOTSUPP
;

844 i‡(!
rdev
->
›s
->
mgmt_tx
)

845  -
EOPNOTSUPP
;

847 i‡(
∑øms
->
Àn
 < 24 + 1)

848  -
EINVAL
;

850 
mgmt
 = (c⁄° 
õì80211_mgmt
 *)
∑øms
->
buf
;

852 i‡(!
	`õì80211_is_mgmt
(
mgmt
->
‰ame_c⁄åﬁ
))

853  -
EINVAL
;

855 
°y≥
 = 
	`À16_to_˝u
(
mgmt
->
‰ame_c⁄åﬁ
Ë& 
IEEE80211_FCTL_STYPE
;

856 i‡(!(
wdev
->
wùhy
->
mgmt_°y≥s
[wdev->
i·y≥
].
tx
 & 
	`BIT
(
°y≥
 >> 4)))

857  -
EINVAL
;

859 i‡(
	`õì80211_is_a˘i⁄
(
mgmt
->
‰ame_c⁄åﬁ
) &&

860 
mgmt
->
u
.
a˘i⁄
.
ˇãg‹y
 !
WLAN_CATEGORY_PUBLIC
) {

861 
îr
 = 0;

863 
wdev
->
i·y≥
) {

864 
NL80211_IFTYPE_ADHOC
:

869 i‡(!
wdev
->
u
.
ibss
.
cuºít_bss
 ||

870 !
	`ëhî_addr_equÆ
(
wdev
->
u
.
ibss
.
cuºít_bss
->
pub
.
bssid
,

871 
mgmt
->
bssid
)) {

872 
îr
 = -
ENOTCONN
;

876 
NL80211_IFTYPE_STATION
:

877 
NL80211_IFTYPE_P2P_CLIENT
:

878 i‡(!
wdev
->
c⁄√˘ed
) {

879 
îr
 = -
ENOTCONN
;

885 i‡(!
	`ëhî_addr_equÆ
(
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
,

886 
mgmt
->
bssid
)) {

887 
îr
 = -
ENOTCONN
;

892 i‡(!
	`ëhî_addr_equÆ
(
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
,

893 
mgmt
->
da
)) {

894 
îr
 = -
ENOTCONN
;

898 
NL80211_IFTYPE_AP
:

899 
NL80211_IFTYPE_P2P_GO
:

900 
NL80211_IFTYPE_AP_VLAN
:

901 i‡(!
	`ëhî_addr_equÆ
(
mgmt
->
bssid
, 
	`wdev_addªss
(
wdev
)) &&

902 (
∑øms
->
lök_id
 < 0 ||

903 !
	`ëhî_addr_equÆ
(
mgmt
->
bssid
,

904 
wdev
->
löks
[
∑øms
->
lök_id
].
addr
)))

905 
îr
 = -
EINVAL
;

907 
NL80211_IFTYPE_MESH_POINT
:

908 i‡(!
	`ëhî_addr_equÆ
(
mgmt
->
ß
, mgmt->
bssid
)) {

909 
îr
 = -
EINVAL
;

917 
NL80211_IFTYPE_P2P_DEVICE
:

922 
NL80211_IFTYPE_NAN
:

924 
îr
 = -
EOPNOTSUPP
;

928 i‡(
îr
)

929  
îr
;

932 i‡(!
	`cfg80211_Ælowed_addªss
(
wdev
, 
mgmt
->
ß
) &&

933 !
	`cfg80211_Ælowed_øndom_addªss
(
wdev
, 
mgmt
))

934  -
EINVAL
;

937  
	`rdev_mgmt_tx
(
rdev
, 
wdev
, 
∑øms
, 
cookõ
);

938 
	}
}

940 
boﬁ
 
	$cfg80211_rx_mgmt_ext
(
wúñess_dev
 *
wdev
,

941 
cfg80211_rx_öfo
 *
öfo
)

943 
wùhy
 *wùhy = 
wdev
->wiphy;

944 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

945 
cfg80211_mgmt_ªgi°øti⁄
 *
ªg
;

946 c⁄° 
õì80211_txrx_°y≥s
 *
°y≥s
 =

947 &
wùhy
->
mgmt_°y≥s
[
wdev
->
i·y≥
];

948 
õì80211_mgmt
 *
mgmt
 = (*)
öfo
->
buf
;

949 c⁄° 
u8
 *
d©a
;

950 
d©a_Àn
;

951 
boﬁ
 
ªsu…
 = 
Ál£
;

952 
__À16
 
·y≥
 = 
mgmt
->
‰ame_c⁄åﬁ
 &

953 
	`˝u_to_À16
(
IEEE80211_FCTL_FTYPE
 | 
IEEE80211_FCTL_STYPE
);

954 
u16
 
°y≥
;

956 
	`åa˚_cfg80211_rx_mgmt
(
wdev
, 
öfo
);

957 
°y≥
 = (
	`À16_to_˝u
(
mgmt
->
‰ame_c⁄åﬁ
Ë& 
IEEE80211_FCTL_STYPE
) >> 4;

959 i‡(!(
°y≥s
->
rx
 & 
	`BIT
(
°y≥
))) {

960 
	`åa˚_cfg80211_ªtu∫_boﬁ
(
Ál£
);

961  
Ál£
;

964 
d©a
 = 
öfo
->
buf
 + 
	`õì80211_hdæí
(
mgmt
->
‰ame_c⁄åﬁ
);

965 
d©a_Àn
 = 
öfo
->
Àn
 - 
	`õì80211_hdæí
(
mgmt
->
‰ame_c⁄åﬁ
);

967 
	`•ö_lock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

969 
	`li°_f‹_óch_íåy
(
ªg
, &
wdev
->
mgmt_ªgi°øti⁄s
, 
li°
) {

970 i‡(
ªg
->
‰ame_ty≥
 !
·y≥
)

973 i‡(
ªg
->
m©ch_Àn
 > 
d©a_Àn
)

976 i‡(
	`memcmp
(
ªg
->
m©ch
, 
d©a
,Ñeg->
m©ch_Àn
))

982 i‡(
	`∆80211_£nd_mgmt
(
rdev
, 
wdev
, 
ªg
->
∆p‹tid
, 
öfo
,

983 
GFP_ATOMIC
))

986 
ªsu…
 = 
åue
;

990 
	`•ö_u∆ock_bh
(&
rdev
->
mgmt_ªgi°øti⁄s_lock
);

992 
	`åa˚_cfg80211_ªtu∫_boﬁ
(
ªsu…
);

993  
ªsu…
;

994 
	}
}

995 
EXPORT_SYMBOL
(
cfg80211_rx_mgmt_ext
);

997 
	$cfg80211_sched_dfs_ch™_upd©e
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

999 
	`ˇn˚l_dñayed_w‹k
(&
rdev
->
dfs_upd©e_ch™√ls_wk
);

1000 
	`queue_dñayed_w‹k
(
cfg80211_wq
, &
rdev
->
dfs_upd©e_ch™√ls_wk
, 0);

1001 
	}
}

1003 
	$cfg80211_dfs_ch™√ls_upd©e_w‹k
(
w‹k_°ru˘
 *
w‹k
)

1005 
dñayed_w‹k
 *dñayed_w‹k = 
	`to_dñayed_w‹k
(
w‹k
);

1006 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

1007 
cfg80211_ch™_def
 
ch™def
;

1008 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

1009 
õì80211_ch™√l
 *
c
;

1010 
wùhy
 *wiphy;

1011 
boﬁ
 
check_agaö
 = 
Ál£
;

1012 
timeout
, 
√xt_time
 = 0;

1013 
time_dfs_upd©e
;

1014 
∆80211_ød¨_evít
 
ød¨_evít
;

1015 
b™did
, 
i
;

1017 
rdev
 = 
	`c⁄èöî_of
(
dñayed_w‹k
, 
cfg80211_ªgi°îed_devi˚
,

1018 
dfs_upd©e_ch™√ls_wk
);

1019 
wùhy
 = &
rdev
->wiphy;

1021 
	`π∆_lock
();

1022 
b™did
 = 0; b™did < 
NUM_NL80211_BANDS
; bandid++) {

1023 
sb™d
 = 
wùhy
->
b™ds
[
b™did
];

1024 i‡(!
sb™d
)

1027 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++) {

1028 
c
 = &
sb™d
->
ch™√ls
[
i
];

1030 i‡(!(
c
->
Êags
 & 
IEEE80211_CHAN_RADAR
))

1033 i‡(
c
->
dfs_°©e
 !
NL80211_DFS_UNAVAILABLE
 &&

1034 
c
->
dfs_°©e
 !
NL80211_DFS_AVAILABLE
)

1037 i‡(
c
->
dfs_°©e
 =
NL80211_DFS_UNAVAILABLE
) {

1038 
time_dfs_upd©e
 = 
IEEE80211_DFS_MIN_NOP_TIME_MS
;

1039 
ød¨_evít
 = 
NL80211_RADAR_NOP_FINISHED
;

1041 i‡(
	`ªguœt‹y_¥e_ˇc_Ælowed
(
wùhy
) ||

1042 
	`cfg80211_™y_wùhy_›î_ch™
(
wùhy
, 
c
))

1045 
time_dfs_upd©e
 = 
REG_PRE_CAC_EXPIRY_GRACE_MS
;

1046 
ød¨_evít
 = 
NL80211_RADAR_PRE_CAC_EXPIRED
;

1049 
timeout
 = 
c
->
dfs_°©e_íãªd
 +

1050 
	`m£cs_to_jiffõs
(
time_dfs_upd©e
);

1052 i‡(
	`time_a·î_eq
(
jiffõs
, 
timeout
)) {

1053 
c
->
dfs_°©e
 = 
NL80211_DFS_USABLE
;

1054 
c
->
dfs_°©e_íãªd
 = 
jiffõs
;

1056 
	`cfg80211_ch™def_¸óã
(&
ch™def
, 
c
,

1057 
NL80211_CHAN_NO_HT
);

1059 
	`∆80211_ød¨_nŸify
(
rdev
, &
ch™def
,

1060 
ød¨_evít
, 
NULL
,

1061 
GFP_ATOMIC
);

1063 
	`ªguœt‹y_¥›ag©e_dfs_°©e
(
wùhy
, &
ch™def
,

1064 
c
->
dfs_°©e
,

1065 
ød¨_evít
);

1069 i‡(!
check_agaö
)

1070 
√xt_time
 = 
timeout
 - 
jiffõs
;

1072 
√xt_time
 = 
	`mö
“ext_time, 
timeout
 - 
jiffõs
);

1073 
check_agaö
 = 
åue
;

1076 
	`π∆_u∆ock
();

1079 i‡(
check_agaö
)

1080 
	`queue_dñayed_w‹k
(
cfg80211_wq
, &
rdev
->
dfs_upd©e_ch™√ls_wk
,

1081 
√xt_time
);

1082 
	}
}

1085 
	$__cfg80211_ød¨_evít
(
wùhy
 *wiphy,

1086 
cfg80211_ch™_def
 *
ch™def
,

1087 
boﬁ
 
offch™
, 
gÂ_t
 
gÂ
)

1089 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1091 
	`åa˚_cfg80211_ød¨_evít
(
wùhy
, 
ch™def
, 
offch™
);

1097 
	`cfg80211_£t_dfs_°©e
(
wùhy
, 
ch™def
, 
NL80211_DFS_UNAVAILABLE
);

1099 i‡(
offch™
)

1100 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
background_ˇc_ab‹t_wk
);

1102 
	`cfg80211_sched_dfs_ch™_upd©e
(
rdev
);

1104 
	`∆80211_ød¨_nŸify
(
rdev
, 
ch™def
, 
NL80211_RADAR_DETECTED
, 
NULL
, 
gÂ
);

1106 
	`mem˝y
(&
rdev
->
ød¨_ch™def
, 
ch™def
, (
cfg80211_ch™_def
));

1107 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
¥›ag©e_ød¨_dëe˘_wk
);

1108 
	}
}

1109 
EXPORT_SYMBOL
(
__cfg80211_ød¨_evít
);

1111 
	$cfg80211_ˇc_evít
(
√t_devi˚
 *
√tdev
,

1112 c⁄° 
cfg80211_ch™_def
 *
ch™def
,

1113 
∆80211_ød¨_evít
 
evít
, 
gÂ_t
 
gÂ
)

1115 
wúñess_dev
 *
wdev
 = 
√tdev
->
õì80211_±r
;

1116 
wùhy
 *wùhy = 
wdev
->wiphy;

1117 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1118 
timeout
;

1121 i‡(
wdev
->
vÆid_löks
)

1124 
	`åa˚_cfg80211_ˇc_evít
(
√tdev
, 
evít
);

1126 i‡(
	`WARN_ON
(!
wdev
->
ˇc_°¨ãd
 && 
evít
 !
NL80211_RADAR_CAC_STARTED
))

1129 
evít
) {

1130 
NL80211_RADAR_CAC_FINISHED
:

1131 
timeout
 = 
wdev
->
ˇc_°¨t_time
 +

1132 
	`m£cs_to_jiffõs
(
wdev
->
ˇc_time_ms
);

1133 
	`WARN_ON
(!
	`time_a·î_eq
(
jiffõs
, 
timeout
));

1134 
	`cfg80211_£t_dfs_°©e
(
wùhy
, 
ch™def
, 
NL80211_DFS_AVAILABLE
);

1135 
	`mem˝y
(&
rdev
->
ˇc_d⁄e_ch™def
, 
ch™def
,

1136 (
cfg80211_ch™_def
));

1137 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
¥›ag©e_ˇc_d⁄e_wk
);

1138 
	`cfg80211_sched_dfs_ch™_upd©e
(
rdev
);

1139 
ÁŒthrough
;

1140 
NL80211_RADAR_CAC_ABORTED
:

1141 
wdev
->
ˇc_°¨ãd
 = 
Ál£
;

1143 
NL80211_RADAR_CAC_STARTED
:

1144 
wdev
->
ˇc_°¨ãd
 = 
åue
;

1147 
	`WARN_ON
(1);

1151 
	`∆80211_ød¨_nŸify
(
rdev
, 
ch™def
, 
evít
, 
√tdev
, 
gÂ
);

1152 
	}
}

1153 
EXPORT_SYMBOL
(
cfg80211_ˇc_evít
);

1156 
	$__cfg80211_background_ˇc_evít
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1157 
wúñess_dev
 *
wdev
,

1158 c⁄° 
cfg80211_ch™_def
 *
ch™def
,

1159 
∆80211_ød¨_evít
 
evít
)

1161 
wùhy
 *wùhy = &
rdev
->wiphy;

1162 
√t_devi˚
 *
√tdev
;

1164 
	`lockdï_as£π_wùhy
(&
rdev
->
wùhy
);

1166 i‡(!
	`cfg80211_ch™def_vÆid
(
ch™def
))

1169 i‡(!
rdev
->
background_ød¨_wdev
)

1172 
evít
) {

1173 
NL80211_RADAR_CAC_FINISHED
:

1174 
	`cfg80211_£t_dfs_°©e
(
wùhy
, 
ch™def
, 
NL80211_DFS_AVAILABLE
);

1175 
	`mem˝y
(&
rdev
->
ˇc_d⁄e_ch™def
, 
ch™def
, (*chandef));

1176 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
¥›ag©e_ˇc_d⁄e_wk
);

1177 
	`cfg80211_sched_dfs_ch™_upd©e
(
rdev
);

1178 
wdev
 = 
rdev
->
background_ød¨_wdev
;

1180 
NL80211_RADAR_CAC_ABORTED
:

1181 i‡(!
	`ˇn˚l_dñayed_w‹k
(&
rdev
->
background_ˇc_d⁄e_wk
))

1183 
wdev
 = 
rdev
->
background_ød¨_wdev
;

1185 
NL80211_RADAR_CAC_STARTED
:

1191 
√tdev
 = 
wdev
 ? wdev->√tdev : 
NULL
;

1192 
	`∆80211_ød¨_nŸify
(
rdev
, 
ch™def
, 
evít
, 
√tdev
, 
GFP_KERNEL
);

1193 
	}
}

1196 
	$cfg80211_background_ˇc_evít
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1197 c⁄° 
cfg80211_ch™_def
 *
ch™def
,

1198 
∆80211_ød¨_evít
 
evít
)

1200 
	`wùhy_lock
(&
rdev
->
wùhy
);

1201 
	`__cfg80211_background_ˇc_evít
(
rdev
,Ñdev->
background_ød¨_wdev
,

1202 
ch™def
, 
evít
);

1203 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1204 
	}
}

1206 
	$cfg80211_background_ˇc_d⁄e_wk
(
w‹k_°ru˘
 *
w‹k
)

1208 
dñayed_w‹k
 *dñayed_w‹k = 
	`to_dñayed_w‹k
(
w‹k
);

1209 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

1211 
rdev
 = 
	`c⁄èöî_of
(
dñayed_w‹k
, 
cfg80211_ªgi°îed_devi˚
,

1212 
background_ˇc_d⁄e_wk
);

1213 
	`cfg80211_background_ˇc_evít
(
rdev
, &rdev->
background_ød¨_ch™def
,

1214 
NL80211_RADAR_CAC_FINISHED
);

1215 
	}
}

1217 
	$cfg80211_background_ˇc_ab‹t_wk
(
w‹k_°ru˘
 *
w‹k
)

1219 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

1221 
rdev
 = 
	`c⁄èöî_of
(
w‹k
, 
cfg80211_ªgi°îed_devi˚
,

1222 
background_ˇc_ab‹t_wk
);

1223 
	`cfg80211_background_ˇc_evít
(
rdev
, &rdev->
background_ød¨_ch™def
,

1224 
NL80211_RADAR_CAC_ABORTED
);

1225 
	}
}

1227 
	$cfg80211_background_ˇc_ab‹t
(
wùhy
 *wiphy)

1229 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1231 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
background_ˇc_ab‹t_wk
);

1232 
	}
}

1233 
EXPORT_SYMBOL
(
cfg80211_background_ˇc_ab‹t
);

1236 
	$cfg80211_°¨t_background_ød¨_dëe˘i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1237 
wúñess_dev
 *
wdev
,

1238 
cfg80211_ch™_def
 *
ch™def
)

1240 
ˇc_time_ms
;

1241 
îr
;

1243 
	`lockdï_as£π_wùhy
(&
rdev
->
wùhy
);

1245 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

1246 
NL80211_EXT_FEATURE_RADAR_BACKGROUND
))

1247  -
EOPNOTSUPP
;

1250 i‡(
rdev
->
background_ød¨_wdev
 &&Ñdev->background_ød¨_wdev !
wdev
)

1251  -
EBUSY
;

1254 i‡(
rdev
->
background_ød¨_wdev
 =
wdev
 &&

1255 
	`dñayed_w‹k_≥ndög
(&
rdev
->
background_ˇc_d⁄e_wk
))

1256  -
EBUSY
;

1258 
îr
 = 
	`rdev_£t_ød¨_background
(
rdev
, 
ch™def
);

1259 i‡(
îr
)

1260  
îr
;

1262 
ˇc_time_ms
 = 
	`cfg80211_ch™def_dfs_ˇc_time
(&
rdev
->
wùhy
, 
ch™def
);

1263 i‡(!
ˇc_time_ms
)

1264 
ˇc_time_ms
 = 
IEEE80211_DFS_MIN_CAC_TIME_MS
;

1266 
rdev
->
background_ød¨_ch™def
 = *
ch™def
;

1267 
rdev
->
background_ød¨_wdev
 = 
wdev
;

1269 
	`__cfg80211_background_ˇc_evít
(
rdev
, 
wdev
, 
ch™def
,

1270 
NL80211_RADAR_CAC_STARTED
);

1271 
	`queue_dñayed_w‹k
(
cfg80211_wq
, &
rdev
->
background_ˇc_d⁄e_wk
,

1272 
	`m£cs_to_jiffõs
(
ˇc_time_ms
));

1275 
	}
}

1277 
	$cfg80211_°›_background_ød¨_dëe˘i⁄
(
wúñess_dev
 *
wdev
)

1279 
wùhy
 *wùhy = 
wdev
->wiphy;

1280 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1282 
	`lockdï_as£π_wùhy
(
wùhy
);

1284 i‡(
wdev
 !
rdev
->
background_ød¨_wdev
)

1287 
	`rdev_£t_ød¨_background
(
rdev
, 
NULL
);

1288 
rdev
->
background_ød¨_wdev
 = 
NULL
;

1290 
	`__cfg80211_background_ˇc_evít
(
rdev
, 
wdev
,

1291 &
rdev
->
background_ød¨_ch™def
,

1292 
NL80211_RADAR_CAC_ABORTED
);

1293 
	}
}

	@nl80211.c

11 
	~<löux/if.h
>

12 
	~<löux/moduÀ.h
>

13 
	~<löux/îr.h
>

14 
	~<löux/¶ab.h
>

15 
	~<löux/li°.h
>

16 
	~<löux/if_ëhî.h
>

17 
	~<löux/õì80211.h
>

18 
	~<löux/∆80211.h
>

19 
	~<löux/π√éök.h
>

20 
	~<löux/√éök.h
>

21 
	~<löux/no•ec.h
>

22 
	~<löux/ëhîdevi˚.h
>

23 
	~<löux/if_vœn.h
>

24 
	~<√t/√t_«me•a˚.h
>

25 
	~<√t/gíëlök.h
>

26 
	~<√t/cfg80211.h
>

27 
	~<√t/sock.h
>

28 
	~<√t/öë_c⁄√˘i⁄_sock.h
>

29 
	~"c‹e.h
"

30 
	~"∆80211.h
"

31 
	~"ªg.h
"

32 
	~"rdev-›s.h
"

33 
	~"thªad_«me.h
"

35 
∆80211_¸y±o_£âögs
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

36 
gíl_öfo
 *
öfo
,

37 
cfg80211_¸y±o_£âögs
 *
£âögs
,

38 
cùhî_limô
);

41 
gíl_Ámûy
 
	g∆80211_Ám
;

44 
	e∆80211_mu…iˇ°_groups
 {

45 
	mNL80211_MCGRP_CONFIG
,

46 
	mNL80211_MCGRP_SCAN
,

47 
	mNL80211_MCGRP_REGULATORY
,

48 
	mNL80211_MCGRP_MLME
,

49 
	mNL80211_MCGRP_VENDOR
,

50 
	mNL80211_MCGRP_NAN
,

51 
	mNL80211_MCGRP_TESTMODE


54 c⁄° 
gíl_mu…iˇ°_group
 
	g∆80211_mcgΩs
[] = {

55 [
NL80211_MCGRP_CONFIG
] = { .
«me
 = 
NL80211_MULTICAST_GROUP_CONFIG
 },

56 [
NL80211_MCGRP_SCAN
] = { .
«me
 = 
NL80211_MULTICAST_GROUP_SCAN
 },

57 [
NL80211_MCGRP_REGULATORY
] = { .
«me
 = 
NL80211_MULTICAST_GROUP_REG
 },

58 [
NL80211_MCGRP_MLME
] = { .
«me
 = 
NL80211_MULTICAST_GROUP_MLME
 },

59 [
NL80211_MCGRP_VENDOR
] = { .
«me
 = 
NL80211_MULTICAST_GROUP_VENDOR
 },

60 [
NL80211_MCGRP_NAN
] = { .
«me
 = 
NL80211_MULTICAST_GROUP_NAN
 },

61 #ifde‡
CONFIG_NL80211_TESTMODE


62 [
NL80211_MCGRP_TESTMODE
] = { .
«me
 = 
NL80211_MULTICAST_GROUP_TESTMODE
 }

68 
wúñess_dev
 *

69 
	$__cfg80211_wdev_‰om_©ås
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

70 
√t
 *
√äs
, 
∆©å
 **
©ås
)

72 
wúñess_dev
 *
ªsu…
 = 
NULL
;

73 
boﬁ
 
have_ifidx
 = 
©ås
[
NL80211_ATTR_IFINDEX
];

74 
boﬁ
 
have_wdev_id
 = 
©ås
[
NL80211_ATTR_WDEV
];

75 
u64
 
wdev_id
 = 0;

76 
wùhy_idx
 = -1;

77 
ifidx
 = -1;

79 i‡(!
have_ifidx
 && !
have_wdev_id
)

80  
	`ERR_PTR
(-
EINVAL
);

82 i‡(
have_ifidx
)

83 
ifidx
 = 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_IFINDEX
]);

84 i‡(
have_wdev_id
) {

85 
wdev_id
 = 
	`∆a_gë_u64
(
©ås
[
NL80211_ATTR_WDEV
]);

86 
wùhy_idx
 = 
wdev_id
 >> 32;

89 i‡(
rdev
) {

90 
wúñess_dev
 *
wdev
;

92 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

94 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

95 i‡(
have_ifidx
 && 
wdev
->
√tdev
 &&

96 
wdev
->
√tdev
->
ifödex
 =
ifidx
) {

97 
ªsu…
 = 
wdev
;

100 i‡(
have_wdev_id
 && 
wdev
->
idítifõr
 =(
u32
)
wdev_id
) {

101 
ªsu…
 = 
wdev
;

106  
ªsu…
 ?: 
	`ERR_PTR
(-
ENODEV
);

109 
	`ASSERT_RTNL
();

111 
	`f‹_óch_rdev
(
rdev
) {

112 
wúñess_dev
 *
wdev
;

114 i‡(
	`wùhy_√t
(&
rdev
->
wùhy
Ë!
√äs
)

117 i‡(
have_wdev_id
 && 
rdev
->
wùhy_idx
 != wiphy_idx)

120 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

121 i‡(
have_ifidx
 && 
wdev
->
√tdev
 &&

122 
wdev
->
√tdev
->
ifödex
 =
ifidx
) {

123 
ªsu…
 = 
wdev
;

126 i‡(
have_wdev_id
 && 
wdev
->
idítifõr
 =(
u32
)
wdev_id
) {

127 
ªsu…
 = 
wdev
;

132 i‡(
ªsu…
)

136 i‡(
ªsu…
)

137  
ªsu…
;

138  
	`ERR_PTR
(-
ENODEV
);

139 
	}
}

141 
cfg80211_ªgi°îed_devi˚
 *

142 
	$__cfg80211_rdev_‰om_©ås
(
√t
 *
√äs
, 
∆©å
 **
©ås
)

144 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
NULL
, *
tmp
;

145 
√t_devi˚
 *
√tdev
;

147 
	`ASSERT_RTNL
();

149 i‡(!
©ås
[
NL80211_ATTR_WIPHY
] &&

150 !
©ås
[
NL80211_ATTR_IFINDEX
] &&

151 !
©ås
[
NL80211_ATTR_WDEV
])

152  
	`ERR_PTR
(-
EINVAL
);

154 i‡(
©ås
[
NL80211_ATTR_WIPHY
])

155 
rdev
 = 
	`cfg80211_rdev_by_wùhy_idx
(

156 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_WIPHY
]));

158 i‡(
©ås
[
NL80211_ATTR_WDEV
]) {

159 
u64
 
wdev_id
 = 
	`∆a_gë_u64
(
©ås
[
NL80211_ATTR_WDEV
]);

160 
wúñess_dev
 *
wdev
;

161 
boﬁ
 
found
 = 
Ál£
;

163 
tmp
 = 
	`cfg80211_rdev_by_wùhy_idx
(
wdev_id
 >> 32);

164 i‡(
tmp
) {

166 
	`li°_f‹_óch_íåy
(
wdev
, &
tmp
->
wùhy
.
wdev_li°
, 
li°
) {

167 i‡(
wdev
->
idítifõr
 !(
u32
)
wdev_id
)

169 
found
 = 
åue
;

173 i‡(!
found
)

174 
tmp
 = 
NULL
;

176 i‡(
rdev
 && 
tmp
 !=Ñdev)

177  
	`ERR_PTR
(-
EINVAL
);

178 
rdev
 = 
tmp
;

182 i‡(
©ås
[
NL80211_ATTR_IFINDEX
]) {

183 
ifödex
 = 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_IFINDEX
]);

185 
√tdev
 = 
	`__dev_gë_by_ödex
(
√äs
, 
ifödex
);

186 i‡(
√tdev
) {

187 i‡(
√tdev
->
õì80211_±r
)

188 
tmp
 = 
	`wùhy_to_rdev
(

189 
√tdev
->
õì80211_±r
->
wùhy
);

191 
tmp
 = 
NULL
;

194 i‡(!
tmp
)

195  
	`ERR_PTR
(-
EINVAL
);

198 i‡(
rdev
 && 
tmp
 !=Ñdev)

199  
	`ERR_PTR
(-
EINVAL
);

201 
rdev
 = 
tmp
;

205 i‡(!
rdev
)

206  
	`ERR_PTR
(-
ENODEV
);

208 i‡(
√äs
 !
	`wùhy_√t
(&
rdev
->
wùhy
))

209  
	`ERR_PTR
(-
ENODEV
);

211  
rdev
;

212 
	}
}

221 
cfg80211_ªgi°îed_devi˚
 *

222 
	$cfg80211_gë_dev_‰om_öfo
(
√t
 *
√äs
, 
gíl_öfo
 *
öfo
)

224  
	`__cfg80211_rdev_‰om_©ås
(
√äs
, 
öfo
->
©ås
);

225 
	}
}

227 
	$vÆid©e_bóc⁄_hód
(c⁄° 
∆©å
 *
©å
,

228 
√éök_ext_ack
 *
exèck
)

230 c⁄° 
u8
 *
d©a
 = 
	`∆a_d©a
(
©å
);

231 
Àn
 = 
	`∆a_Àn
(
©å
);

232 c⁄° 
ñemít
 *
ñem
;

233 c⁄° 
õì80211_mgmt
 *
mgmt
 = (*)
d©a
;

234 
fixedÀn
, 
hdæí
;

235 
boﬁ
 
s1g_b˙
;

237 i‡(
Àn
 < 
	`off£to„nd
(
	`ty≥of
(*
mgmt
), 
‰ame_c⁄åﬁ
))

238 
îr
;

240 
s1g_b˙
 = 
	`õì80211_is_s1g_bóc⁄
(
mgmt
->
‰ame_c⁄åﬁ
);

241 i‡(
s1g_b˙
) {

242 
fixedÀn
 = 
	`off£tof
(
õì80211_ext
,

243 
u
.
s1g_bóc⁄
.
v¨übÀ
);

244 
hdæí
 = 
	`off£tof
(
õì80211_ext
, 
u
.
s1g_bóc⁄
);

246 
fixedÀn
 = 
	`off£tof
(
õì80211_mgmt
,

247 
u
.
bóc⁄
.
v¨übÀ
);

248 
hdæí
 = 
	`off£tof
(
õì80211_mgmt
, 
u
.
bóc⁄
);

251 i‡(
Àn
 < 
fixedÀn
)

252 
îr
;

254 i‡(
	`õì80211_hdæí
(
mgmt
->
‰ame_c⁄åﬁ
Ë!
hdæí
)

255 
îr
;

257 
d©a
 +
fixedÀn
;

258 
Àn
 -
fixedÀn
;

260 
	`f‹_óch_ñemít
(
ñem
, 
d©a
, 
Àn
) {

264 i‡(
	`f‹_óch_ñemít_com∂ëed
(
ñem
, 
d©a
, 
Àn
))

267 
îr
:

268 
	`NL_SET_ERR_MSG_ATTR
(
exèck
, 
©å
, "malformed beacon head");

269  -
EINVAL
;

270 
	}
}

272 
	$vÆid©e_õ_©å
(c⁄° 
∆©å
 *
©å
,

273 
√éök_ext_ack
 *
exèck
)

275 c⁄° 
u8
 *
d©a
 = 
	`∆a_d©a
(
©å
);

276 
Àn
 = 
	`∆a_Àn
(
©å
);

277 c⁄° 
ñemít
 *
ñem
;

279 
	`f‹_óch_ñemít
(
ñem
, 
d©a
, 
Àn
) {

283 i‡(
	`f‹_óch_ñemít_com∂ëed
(
ñem
, 
d©a
, 
Àn
))

286 
	`NL_SET_ERR_MSG_ATTR
(
exèck
, 
©å
, "malformed informationÉlements");

287  -
EINVAL
;

288 
	}
}

290 
	$vÆid©e_he_ˇ∑
(c⁄° 
∆©å
 *
©å
,

291 
√éök_ext_ack
 *
exèck
)

293 i‡(!
	`õì80211_he_ˇ∑_size_ok
(
	`∆a_d©a
(
©å
), 
	`∆a_Àn
(attr)))

294  -
EINVAL
;

297 
	}
}

300 c⁄° 
∆a_pﬁicy
 
	g∆80211_pﬁicy
[
NUM_NL80211_ATTR
];

302 c⁄° 
∆a_pﬁicy


303 
	g∆80211_·m_ª•⁄dî_pﬁicy
[
NL80211_FTM_RESP_ATTR_MAX
 + 1] = {

304 [
NL80211_FTM_RESP_ATTR_ENABLED
] = { .
ty≥
 = 
NLA_FLAG
, },

305 [
NL80211_FTM_RESP_ATTR_LCI
] = { .
ty≥
 = 
NLA_BINARY
,

306 .
	gÀn
 = 
U8_MAX
 },

307 [
NL80211_FTM_RESP_ATTR_CIVICLOC
] = { .
ty≥
 = 
NLA_BINARY
,

308 .
	gÀn
 = 
U8_MAX
 },

311 c⁄° 
∆a_pﬁicy


312 
	g∆80211_pm§_·m_ªq_©å_pﬁicy
[
NL80211_PMSR_FTM_REQ_ATTR_MAX
 + 1] = {

313 [
NL80211_PMSR_FTM_REQ_ATTR_ASAP
] = { .
ty≥
 = 
NLA_FLAG
 },

314 [
NL80211_PMSR_FTM_REQ_ATTR_PREAMBLE
] = { .
ty≥
 = 
NLA_U32
 },

315 [
NL80211_PMSR_FTM_REQ_ATTR_NUM_BURSTS_EXP
] =

316 
NLA_POLICY_MAX
(
NLA_U8
, 15),

317 [
NL80211_PMSR_FTM_REQ_ATTR_BURST_PERIOD
] = { .
ty≥
 = 
NLA_U16
 },

318 [
NL80211_PMSR_FTM_REQ_ATTR_BURST_DURATION
] =

319 
NLA_POLICY_MAX
(
NLA_U8
, 15),

320 [
NL80211_PMSR_FTM_REQ_ATTR_FTMS_PER_BURST
] =

321 
NLA_POLICY_MAX
(
NLA_U8
, 31),

322 [
NL80211_PMSR_FTM_REQ_ATTR_NUM_FTMR_RETRIES
] = { .
ty≥
 = 
NLA_U8
 },

323 [
NL80211_PMSR_FTM_REQ_ATTR_REQUEST_LCI
] = { .
ty≥
 = 
NLA_FLAG
 },

324 [
NL80211_PMSR_FTM_REQ_ATTR_REQUEST_CIVICLOC
] = { .
ty≥
 = 
NLA_FLAG
 },

325 [
NL80211_PMSR_FTM_REQ_ATTR_TRIGGER_BASED
] = { .
ty≥
 = 
NLA_FLAG
 },

326 [
NL80211_PMSR_FTM_REQ_ATTR_NON_TRIGGER_BASED
] = { .
ty≥
 = 
NLA_FLAG
 },

327 [
NL80211_PMSR_FTM_REQ_ATTR_LMR_FEEDBACK
] = { .
ty≥
 = 
NLA_FLAG
 },

328 [
NL80211_PMSR_FTM_REQ_ATTR_BSS_COLOR
] = { .
ty≥
 = 
NLA_U8
 },

331 c⁄° 
∆a_pﬁicy


332 
	g∆80211_pm§_ªq_d©a_pﬁicy
[
NL80211_PMSR_TYPE_MAX
 + 1] = {

333 [
NL80211_PMSR_TYPE_FTM
] =

334 
NLA_POLICY_NESTED
(
∆80211_pm§_·m_ªq_©å_pﬁicy
),

337 c⁄° 
∆a_pﬁicy


338 
	g∆80211_pm§_ªq_©å_pﬁicy
[
NL80211_PMSR_REQ_ATTR_MAX
 + 1] = {

339 [
NL80211_PMSR_REQ_ATTR_DATA
] =

340 
NLA_POLICY_NESTED
(
∆80211_pm§_ªq_d©a_pﬁicy
),

341 [
NL80211_PMSR_REQ_ATTR_GET_AP_TSF
] = { .
ty≥
 = 
NLA_FLAG
 },

344 c⁄° 
∆a_pﬁicy


345 
	g∆80211_pm§_≥î_©å_pﬁicy
[
NL80211_PMSR_PEER_ATTR_MAX
 + 1] = {

346 [
NL80211_PMSR_PEER_ATTR_ADDR
] = 
NLA_POLICY_ETH_ADDR
,

347 [
NL80211_PMSR_PEER_ATTR_CHAN
] = 
NLA_POLICY_NESTED
(
∆80211_pﬁicy
),

348 [
NL80211_PMSR_PEER_ATTR_REQ
] =

349 
NLA_POLICY_NESTED
(
∆80211_pm§_ªq_©å_pﬁicy
),

350 [
NL80211_PMSR_PEER_ATTR_RESP
] = { .
ty≥
 = 
NLA_REJECT
 },

353 c⁄° 
∆a_pﬁicy


354 
	g∆80211_pm§_©å_pﬁicy
[
NL80211_PMSR_ATTR_MAX
 + 1] = {

355 [
NL80211_PMSR_ATTR_MAX_PEERS
] = { .
ty≥
 = 
NLA_REJECT
 },

356 [
NL80211_PMSR_ATTR_REPORT_AP_TSF
] = { .
ty≥
 = 
NLA_REJECT
 },

357 [
NL80211_PMSR_ATTR_RANDOMIZE_MAC_ADDR
] = { .
ty≥
 = 
NLA_REJECT
 },

358 [
NL80211_PMSR_ATTR_TYPE_CAPA
] = { .
ty≥
 = 
NLA_REJECT
 },

359 [
NL80211_PMSR_ATTR_PEERS
] =

360 
NLA_POLICY_NESTED_ARRAY
(
∆80211_pm§_≥î_©å_pﬁicy
),

363 c⁄° 
∆a_pﬁicy


364 
	ghe_obss_pd_pﬁicy
[
NL80211_HE_OBSS_PD_ATTR_MAX
 + 1] = {

365 [
NL80211_HE_OBSS_PD_ATTR_MIN_OFFSET
] =

366 
NLA_POLICY_RANGE
(
NLA_U8
, 1, 20),

367 [
NL80211_HE_OBSS_PD_ATTR_MAX_OFFSET
] =

368 
NLA_POLICY_RANGE
(
NLA_U8
, 1, 20),

369 [
NL80211_HE_OBSS_PD_ATTR_NON_SRG_MAX_OFFSET
] =

370 
NLA_POLICY_RANGE
(
NLA_U8
, 1, 20),

371 [
NL80211_HE_OBSS_PD_ATTR_BSS_COLOR_BITMAP
] =

372 
NLA_POLICY_EXACT_LEN
(8),

373 [
NL80211_HE_OBSS_PD_ATTR_PARTIAL_BSSID_BITMAP
] =

374 
NLA_POLICY_EXACT_LEN
(8),

375 [
NL80211_HE_OBSS_PD_ATTR_SR_CTRL
] = { .
ty≥
 = 
NLA_U8
 },

378 c⁄° 
∆a_pﬁicy


379 
	ghe_bss_cﬁ‹_pﬁicy
[
NL80211_HE_BSS_COLOR_ATTR_MAX
 + 1] = {

380 [
NL80211_HE_BSS_COLOR_ATTR_COLOR
] = 
NLA_POLICY_RANGE
(
NLA_U8
, 1, 63),

381 [
NL80211_HE_BSS_COLOR_ATTR_DISABLED
] = { .
ty≥
 = 
NLA_FLAG
 },

382 [
NL80211_HE_BSS_COLOR_ATTR_PARTIAL
] = { .
ty≥
 = 
NLA_FLAG
 },

385 c⁄° 
∆a_pﬁicy
 
	g∆80211_tx©å_pﬁicy
[
NL80211_TXRATE_MAX
 + 1] = {

386 [
NL80211_TXRATE_LEGACY
] = { .
ty≥
 = 
NLA_BINARY
,

387 .
	gÀn
 = 
NL80211_MAX_SUPP_RATES
 },

388 [
NL80211_TXRATE_HT
] = { .
ty≥
 = 
NLA_BINARY
,

389 .
	gÀn
 = 
NL80211_MAX_SUPP_HT_RATES
 },

390 [
NL80211_TXRATE_VHT
] = 
NLA_POLICY_EXACT_LEN_WARN
((
∆80211_txøã_vht
)),

391 [
NL80211_TXRATE_GI
] = { .
ty≥
 = 
NLA_U8
 },

392 [
NL80211_TXRATE_HE
] = 
NLA_POLICY_EXACT_LEN
((
∆80211_txøã_he
)),

393 [
NL80211_TXRATE_HE_GI
] = 
NLA_POLICY_RANGE
(
NLA_U8
,

394 
NL80211_RATE_INFO_HE_GI_0_8
,

395 
NL80211_RATE_INFO_HE_GI_3_2
),

396 [
NL80211_TXRATE_HE_LTF
] = 
NLA_POLICY_RANGE
(
NLA_U8
,

397 
NL80211_RATE_INFO_HE_1XLTF
,

398 
NL80211_RATE_INFO_HE_4XLTF
),

401 c⁄° 
∆a_pﬁicy


402 
	g∆80211_tid_c⁄fig_©å_pﬁicy
[
NL80211_TID_CONFIG_ATTR_MAX
 + 1] = {

403 [
NL80211_TID_CONFIG_ATTR_VIF_SUPP
] = { .
ty≥
 = 
NLA_U64
 },

404 [
NL80211_TID_CONFIG_ATTR_PEER_SUPP
] = { .
ty≥
 = 
NLA_U64
 },

405 [
NL80211_TID_CONFIG_ATTR_OVERRIDE
] = { .
ty≥
 = 
NLA_FLAG
 },

406 [
NL80211_TID_CONFIG_ATTR_TIDS
] = 
NLA_POLICY_RANGE
(
NLA_U16
, 1, 0xff),

407 [
NL80211_TID_CONFIG_ATTR_NOACK
] =

408 
NLA_POLICY_MAX
(
NLA_U8
, 
NL80211_TID_CONFIG_DISABLE
),

409 [
NL80211_TID_CONFIG_ATTR_RETRY_SHORT
] = 
NLA_POLICY_MIN
(
NLA_U8
, 1),

410 [
NL80211_TID_CONFIG_ATTR_RETRY_LONG
] = 
NLA_POLICY_MIN
(
NLA_U8
, 1),

411 [
NL80211_TID_CONFIG_ATTR_AMPDU_CTRL
] =

412 
NLA_POLICY_MAX
(
NLA_U8
, 
NL80211_TID_CONFIG_DISABLE
),

413 [
NL80211_TID_CONFIG_ATTR_RTSCTS_CTRL
] =

414 
NLA_POLICY_MAX
(
NLA_U8
, 
NL80211_TID_CONFIG_DISABLE
),

415 [
NL80211_TID_CONFIG_ATTR_AMSDU_CTRL
] =

416 
NLA_POLICY_MAX
(
NLA_U8
, 
NL80211_TID_CONFIG_DISABLE
),

417 [
NL80211_TID_CONFIG_ATTR_TX_RATE_TYPE
] =

418 
NLA_POLICY_MAX
(
NLA_U8
, 
NL80211_TX_RATE_FIXED
),

419 [
NL80211_TID_CONFIG_ATTR_TX_RATE
] =

420 
NLA_POLICY_NESTED
(
∆80211_tx©å_pﬁicy
),

423 c⁄° 
∆a_pﬁicy


424 
	g∆80211_fûs_discovîy_pﬁicy
[
NL80211_FILS_DISCOVERY_ATTR_MAX
 + 1] = {

425 [
NL80211_FILS_DISCOVERY_ATTR_INT_MIN
] = 
NLA_POLICY_MAX
(
NLA_U32
, 10000),

426 [
NL80211_FILS_DISCOVERY_ATTR_INT_MAX
] = 
NLA_POLICY_MAX
(
NLA_U32
, 10000),

427 [
NL80211_FILS_DISCOVERY_ATTR_TMPL
] =

428 
NLA_POLICY_RANGE
(
NLA_BINARY
,

429 
NL80211_FILS_DISCOVERY_TMPL_MIN_LEN
,

430 
IEEE80211_MAX_DATA_LEN
),

433 c⁄° 
∆a_pﬁicy


434 
	g∆80211_unsﬁ_bˇ°_¥obe_ª•_pﬁicy
[
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_MAX
 + 1] = {

435 [
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_INT
] = 
NLA_POLICY_MAX
(
NLA_U32
, 20),

436 [
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_TMPL
] = { .
ty≥
 = 
NLA_BINARY
,

437 .
	gÀn
 = 
IEEE80211_MAX_DATA_LEN
 }

440 c⁄° 
∆a_pﬁicy


441 
	gßr_•ecs_pﬁicy
[
NL80211_SAR_ATTR_SPECS_MAX
 + 1] = {

442 [
NL80211_SAR_ATTR_SPECS_POWER
] = { .
ty≥
 = 
NLA_S32
 },

443 [
NL80211_SAR_ATTR_SPECS_RANGE_INDEX
] = {.
ty≥
 = 
NLA_U32
 },

446 c⁄° 
∆a_pﬁicy


447 
	gßr_pﬁicy
[
NL80211_SAR_ATTR_MAX
 + 1] = {

448 [
NL80211_SAR_ATTR_TYPE
] = 
NLA_POLICY_MAX
(
NLA_U32
, 
NUM_NL80211_SAR_TYPE
),

449 [
NL80211_SAR_ATTR_SPECS
] = 
NLA_POLICY_NESTED_ARRAY
(
ßr_•ecs_pﬁicy
),

452 c⁄° 
∆a_pﬁicy


453 
	g∆80211_mbssid_c⁄fig_pﬁicy
[
NL80211_MBSSID_CONFIG_ATTR_MAX
 + 1] = {

454 [
NL80211_MBSSID_CONFIG_ATTR_MAX_INTERFACES
] = 
NLA_POLICY_MIN
(
NLA_U8
, 2),

455 [
NL80211_MBSSID_CONFIG_ATTR_MAX_EMA_PROFILE_PERIODICITY
] =

456 
NLA_POLICY_MIN
(
NLA_U8
, 1),

457 [
NL80211_MBSSID_CONFIG_ATTR_INDEX
] = { .
ty≥
 = 
NLA_U8
 },

458 [
NL80211_MBSSID_CONFIG_ATTR_TX_IFINDEX
] = { .
ty≥
 = 
NLA_U32
 },

459 [
NL80211_MBSSID_CONFIG_ATTR_EMA
] = { .
ty≥
 = 
NLA_FLAG
 },

462 c⁄° 
∆a_pﬁicy


463 
	g∆80211_°a_wme_pﬁicy
[
NL80211_STA_WME_MAX
 + 1] = {

464 [
NL80211_STA_WME_UAPSD_QUEUES
] = { .
ty≥
 = 
NLA_U8
 },

465 [
NL80211_STA_WME_MAX_SP
] = { .
ty≥
 = 
NLA_U8
 },

468 c⁄° 
√éök_ønge_vÆid©i⁄
 
	g∆80211_pun˘_bôm≠_ønge
 = {

469 .
mö
 = 0,

470 .
	gmax
 = 0xffff,

473 c⁄° 
∆a_pﬁicy
 
	g∆80211_pﬁicy
[
NUM_NL80211_ATTR
] = {

474 [0] = { .
°ri˘_°¨t_ty≥
 = 
NL80211_ATTR_HE_OBSS_PD
 },

475 [
NL80211_ATTR_WIPHY
] = { .
ty≥
 = 
NLA_U32
 },

476 [
NL80211_ATTR_WIPHY_NAME
] = { .
ty≥
 = 
NLA_NUL_STRING
,

477 .
	gÀn
 = 20-1 },

478 [
NL80211_ATTR_WIPHY_TXQ_PARAMS
] = { .
ty≥
 = 
NLA_NESTED
 },

480 [
NL80211_ATTR_WIPHY_FREQ
] = { .
ty≥
 = 
NLA_U32
 },

481 [
NL80211_ATTR_WIPHY_CHANNEL_TYPE
] = { .
ty≥
 = 
NLA_U32
 },

482 [
NL80211_ATTR_WIPHY_EDMG_CHANNELS
] = 
NLA_POLICY_RANGE
(
NLA_U8
,

483 
NL80211_EDMG_CHANNELS_MIN
,

484 
NL80211_EDMG_CHANNELS_MAX
),

485 [
NL80211_ATTR_WIPHY_EDMG_BW_CONFIG
] = 
NLA_POLICY_RANGE
(
NLA_U8
,

486 
NL80211_EDMG_BW_CONFIG_MIN
,

487 
NL80211_EDMG_BW_CONFIG_MAX
),

489 [
NL80211_ATTR_CHANNEL_WIDTH
] = { .
ty≥
 = 
NLA_U32
 },

490 [
NL80211_ATTR_CENTER_FREQ1
] = { .
ty≥
 = 
NLA_U32
 },

491 [
NL80211_ATTR_CENTER_FREQ1_OFFSET
] = 
NLA_POLICY_RANGE
(
NLA_U32
, 0, 999),

492 [
NL80211_ATTR_CENTER_FREQ2
] = { .
ty≥
 = 
NLA_U32
 },

494 [
NL80211_ATTR_WIPHY_RETRY_SHORT
] = 
NLA_POLICY_MIN
(
NLA_U8
, 1),

495 [
NL80211_ATTR_WIPHY_RETRY_LONG
] = 
NLA_POLICY_MIN
(
NLA_U8
, 1),

496 [
NL80211_ATTR_WIPHY_FRAG_THRESHOLD
] = { .
ty≥
 = 
NLA_U32
 },

497 [
NL80211_ATTR_WIPHY_RTS_THRESHOLD
] = { .
ty≥
 = 
NLA_U32
 },

498 [
NL80211_ATTR_WIPHY_COVERAGE_CLASS
] = { .
ty≥
 = 
NLA_U8
 },

499 [
NL80211_ATTR_WIPHY_DYN_ACK
] = { .
ty≥
 = 
NLA_FLAG
 },

501 [
NL80211_ATTR_IFTYPE
] = 
NLA_POLICY_MAX
(
NLA_U32
, 
NL80211_IFTYPE_MAX
),

502 [
NL80211_ATTR_IFINDEX
] = { .
ty≥
 = 
NLA_U32
 },

503 [
NL80211_ATTR_IFNAME
] = { .
ty≥
 = 
NLA_NUL_STRING
, .
	gÀn
 = 
IFNAMSIZ
-1 },

505 [
NL80211_ATTR_MAC
] = 
NLA_POLICY_EXACT_LEN_WARN
(
ETH_ALEN
),

506 [
NL80211_ATTR_PREV_BSSID
] = 
NLA_POLICY_EXACT_LEN_WARN
(
ETH_ALEN
),

508 [
NL80211_ATTR_KEY
] = { .
ty≥
 = 
NLA_NESTED
, },

509 [
NL80211_ATTR_KEY_DATA
] = { .
ty≥
 = 
NLA_BINARY
,

510 .
	gÀn
 = 
WLAN_MAX_KEY_LEN
 },

511 [
NL80211_ATTR_KEY_IDX
] = 
NLA_POLICY_MAX
(
NLA_U8
, 7),

512 [
NL80211_ATTR_KEY_CIPHER
] = { .
ty≥
 = 
NLA_U32
 },

513 [
NL80211_ATTR_KEY_DEFAULT
] = { .
ty≥
 = 
NLA_FLAG
 },

514 [
NL80211_ATTR_KEY_SEQ
] = { .
ty≥
 = 
NLA_BINARY
, .
	gÀn
 = 16 },

515 [
NL80211_ATTR_KEY_TYPE
] =

516 
NLA_POLICY_MAX
(
NLA_U32
, 
NUM_NL80211_KEYTYPES
),

518 [
NL80211_ATTR_BEACON_INTERVAL
] = { .
ty≥
 = 
NLA_U32
 },

519 [
NL80211_ATTR_DTIM_PERIOD
] = { .
ty≥
 = 
NLA_U32
 },

520 [
NL80211_ATTR_BEACON_HEAD
] =

521 
NLA_POLICY_VALIDATE_FN
(
NLA_BINARY
, 
vÆid©e_bóc⁄_hód
,

522 
IEEE80211_MAX_DATA_LEN
),

523 [
NL80211_ATTR_BEACON_TAIL
] =

524 
NLA_POLICY_VALIDATE_FN
(
NLA_BINARY
, 
vÆid©e_õ_©å
,

525 
IEEE80211_MAX_DATA_LEN
),

526 [
NL80211_ATTR_STA_AID
] =

527 
NLA_POLICY_RANGE
(
NLA_U16
, 1, 
IEEE80211_MAX_AID
),

528 [
NL80211_ATTR_STA_FLAGS
] = { .
ty≥
 = 
NLA_NESTED
 },

529 [
NL80211_ATTR_STA_LISTEN_INTERVAL
] = { .
ty≥
 = 
NLA_U16
 },

530 [
NL80211_ATTR_STA_SUPPORTED_RATES
] = { .
ty≥
 = 
NLA_BINARY
,

531 .
	gÀn
 = 
NL80211_MAX_SUPP_RATES
 },

532 [
NL80211_ATTR_STA_PLINK_ACTION
] =

533 
NLA_POLICY_MAX
(
NLA_U8
, 
NUM_NL80211_PLINK_ACTIONS
 - 1),

534 [
NL80211_ATTR_STA_TX_POWER_SETTING
] =

535 
NLA_POLICY_RANGE
(
NLA_U8
,

536 
NL80211_TX_POWER_AUTOMATIC
,

537 
NL80211_TX_POWER_FIXED
),

538 [
NL80211_ATTR_STA_TX_POWER
] = { .
ty≥
 = 
NLA_S16
 },

539 [
NL80211_ATTR_STA_VLAN
] = { .
ty≥
 = 
NLA_U32
 },

540 [
NL80211_ATTR_MNTR_FLAGS
] = { },

541 [
NL80211_ATTR_MESH_ID
] = { .
ty≥
 = 
NLA_BINARY
,

542 .
	gÀn
 = 
IEEE80211_MAX_MESH_ID_LEN
 },

543 [
NL80211_ATTR_MPATH_NEXT_HOP
] = 
NLA_POLICY_ETH_ADDR_COMPAT
,

546 [
NL80211_ATTR_REG_ALPHA2
] = 
NLA_POLICY_RANGE
(
NLA_BINARY
, 2, 3),

547 [
NL80211_ATTR_REG_RULES
] = { .
ty≥
 = 
NLA_NESTED
 },

549 [
NL80211_ATTR_BSS_CTS_PROT
] = { .
ty≥
 = 
NLA_U8
 },

550 [
NL80211_ATTR_BSS_SHORT_PREAMBLE
] = { .
ty≥
 = 
NLA_U8
 },

551 [
NL80211_ATTR_BSS_SHORT_SLOT_TIME
] = { .
ty≥
 = 
NLA_U8
 },

552 [
NL80211_ATTR_BSS_BASIC_RATES
] = { .
ty≥
 = 
NLA_BINARY
,

553 .
	gÀn
 = 
NL80211_MAX_SUPP_RATES
 },

554 [
NL80211_ATTR_BSS_HT_OPMODE
] = { .
ty≥
 = 
NLA_U16
 },

556 [
NL80211_ATTR_MESH_CONFIG
] = { .
ty≥
 = 
NLA_NESTED
 },

557 [
NL80211_ATTR_SUPPORT_MESH_AUTH
] = { .
ty≥
 = 
NLA_FLAG
 },

559 [
NL80211_ATTR_HT_CAPABILITY
] = 
NLA_POLICY_EXACT_LEN_WARN
(
NL80211_HT_CAPABILITY_LEN
),

561 [
NL80211_ATTR_MGMT_SUBTYPE
] = { .
ty≥
 = 
NLA_U8
 },

562 [
NL80211_ATTR_IE
] = 
NLA_POLICY_VALIDATE_FN
(
NLA_BINARY
,

563 
vÆid©e_õ_©å
,

564 
IEEE80211_MAX_DATA_LEN
),

565 [
NL80211_ATTR_SCAN_FREQUENCIES
] = { .
ty≥
 = 
NLA_NESTED
 },

566 [
NL80211_ATTR_SCAN_SSIDS
] = { .
ty≥
 = 
NLA_NESTED
 },

568 [
NL80211_ATTR_SSID
] = { .
ty≥
 = 
NLA_BINARY
,

569 .
	gÀn
 = 
IEEE80211_MAX_SSID_LEN
 },

570 [
NL80211_ATTR_AUTH_TYPE
] = { .
ty≥
 = 
NLA_U32
 },

571 [
NL80211_ATTR_REASON_CODE
] = { .
ty≥
 = 
NLA_U16
 },

572 [
NL80211_ATTR_FREQ_FIXED
] = { .
ty≥
 = 
NLA_FLAG
 },

573 [
NL80211_ATTR_TIMED_OUT
] = { .
ty≥
 = 
NLA_FLAG
 },

574 [
NL80211_ATTR_USE_MFP
] = 
NLA_POLICY_RANGE
(
NLA_U32
,

575 
NL80211_MFP_NO
,

576 
NL80211_MFP_OPTIONAL
),

577 [
NL80211_ATTR_STA_FLAGS2
] =

578 
NLA_POLICY_EXACT_LEN_WARN
((
∆80211_°a_Êag_upd©e
)),

579 [
NL80211_ATTR_CONTROL_PORT
] = { .
ty≥
 = 
NLA_FLAG
 },

580 [
NL80211_ATTR_CONTROL_PORT_ETHERTYPE
] = { .
ty≥
 = 
NLA_U16
 },

581 [
NL80211_ATTR_CONTROL_PORT_NO_ENCRYPT
] = { .
ty≥
 = 
NLA_FLAG
 },

582 [
NL80211_ATTR_CONTROL_PORT_OVER_NL80211
] = { .
ty≥
 = 
NLA_FLAG
 },

583 [
NL80211_ATTR_PRIVACY
] = { .
ty≥
 = 
NLA_FLAG
 },

584 [
NL80211_ATTR_STATUS_CODE
] = { .
ty≥
 = 
NLA_U16
 },

585 [
NL80211_ATTR_CIPHER_SUITE_GROUP
] = { .
ty≥
 = 
NLA_U32
 },

586 [
NL80211_ATTR_WPA_VERSIONS
] =

587 
NLA_POLICY_RANGE
(
NLA_U32
, 0,

588 
NL80211_WPA_VERSION_1
 |

589 
NL80211_WPA_VERSION_2
 |

590 
NL80211_WPA_VERSION_3
),

591 [
NL80211_ATTR_PID
] = { .
ty≥
 = 
NLA_U32
 },

592 [
NL80211_ATTR_4ADDR
] = { .
ty≥
 = 
NLA_U8
 },

593 [
NL80211_ATTR_PMKID
] = 
NLA_POLICY_EXACT_LEN_WARN
(
WLAN_PMKID_LEN
),

594 [
NL80211_ATTR_DURATION
] = { .
ty≥
 = 
NLA_U32
 },

595 [
NL80211_ATTR_COOKIE
] = { .
ty≥
 = 
NLA_U64
 },

596 [
NL80211_ATTR_TX_RATES
] = { .
ty≥
 = 
NLA_NESTED
 },

597 [
NL80211_ATTR_FRAME
] = { .
ty≥
 = 
NLA_BINARY
,

598 .
	gÀn
 = 
IEEE80211_MAX_DATA_LEN
 },

599 [
NL80211_ATTR_FRAME_MATCH
] = { .
ty≥
 = 
NLA_BINARY
, },

600 [
NL80211_ATTR_PS_STATE
] = 
NLA_POLICY_RANGE
(
NLA_U32
,

601 
NL80211_PS_DISABLED
,

602 
NL80211_PS_ENABLED
),

603 [
NL80211_ATTR_CQM
] = { .
ty≥
 = 
NLA_NESTED
, },

604 [
NL80211_ATTR_LOCAL_STATE_CHANGE
] = { .
ty≥
 = 
NLA_FLAG
 },

605 [
NL80211_ATTR_AP_ISOLATE
] = { .
ty≥
 = 
NLA_U8
 },

606 [
NL80211_ATTR_WIPHY_TX_POWER_SETTING
] = { .
ty≥
 = 
NLA_U32
 },

607 [
NL80211_ATTR_WIPHY_TX_POWER_LEVEL
] = { .
ty≥
 = 
NLA_U32
 },

608 [
NL80211_ATTR_FRAME_TYPE
] = { .
ty≥
 = 
NLA_U16
 },

609 [
NL80211_ATTR_WIPHY_ANTENNA_TX
] = { .
ty≥
 = 
NLA_U32
 },

610 [
NL80211_ATTR_WIPHY_ANTENNA_RX
] = { .
ty≥
 = 
NLA_U32
 },

611 [
NL80211_ATTR_MCAST_RATE
] = { .
ty≥
 = 
NLA_U32
 },

612 [
NL80211_ATTR_OFFCHANNEL_TX_OK
] = { .
ty≥
 = 
NLA_FLAG
 },

613 [
NL80211_ATTR_KEY_DEFAULT_TYPES
] = { .
ty≥
 = 
NLA_NESTED
 },

614 [
NL80211_ATTR_WOWLAN_TRIGGERS
] = { .
ty≥
 = 
NLA_NESTED
 },

615 [
NL80211_ATTR_STA_PLINK_STATE
] =

616 
NLA_POLICY_MAX
(
NLA_U8
, 
NUM_NL80211_PLINK_STATES
 - 1),

617 [
NL80211_ATTR_MEASUREMENT_DURATION
] = { .
ty≥
 = 
NLA_U16
 },

618 [
NL80211_ATTR_MEASUREMENT_DURATION_MANDATORY
] = { .
ty≥
 = 
NLA_FLAG
 },

619 [
NL80211_ATTR_MESH_PEER_AID
] =

620 
NLA_POLICY_RANGE
(
NLA_U16
, 1, 
IEEE80211_MAX_AID
),

621 [
NL80211_ATTR_SCHED_SCAN_INTERVAL
] = { .
ty≥
 = 
NLA_U32
 },

622 [
NL80211_ATTR_REKEY_DATA
] = { .
ty≥
 = 
NLA_NESTED
 },

623 [
NL80211_ATTR_SCAN_SUPP_RATES
] = { .
ty≥
 = 
NLA_NESTED
 },

624 [
NL80211_ATTR_HIDDEN_SSID
] =

625 
NLA_POLICY_RANGE
(
NLA_U32
,

626 
NL80211_HIDDEN_SSID_NOT_IN_USE
,

627 
NL80211_HIDDEN_SSID_ZERO_CONTENTS
),

628 [
NL80211_ATTR_IE_PROBE_RESP
] =

629 
NLA_POLICY_VALIDATE_FN
(
NLA_BINARY
, 
vÆid©e_õ_©å
,

630 
IEEE80211_MAX_DATA_LEN
),

631 [
NL80211_ATTR_IE_ASSOC_RESP
] =

632 
NLA_POLICY_VALIDATE_FN
(
NLA_BINARY
, 
vÆid©e_õ_©å
,

633 
IEEE80211_MAX_DATA_LEN
),

634 [
NL80211_ATTR_ROAM_SUPPORT
] = { .
ty≥
 = 
NLA_FLAG
 },

635 [
NL80211_ATTR_STA_WME
] = 
NLA_POLICY_NESTED
(
∆80211_°a_wme_pﬁicy
),

636 [
NL80211_ATTR_SCHED_SCAN_MATCH
] = { .
ty≥
 = 
NLA_NESTED
 },

637 [
NL80211_ATTR_TX_NO_CCK_RATE
] = { .
ty≥
 = 
NLA_FLAG
 },

638 [
NL80211_ATTR_TDLS_ACTION
] = { .
ty≥
 = 
NLA_U8
 },

639 [
NL80211_ATTR_TDLS_DIALOG_TOKEN
] = { .
ty≥
 = 
NLA_U8
 },

640 [
NL80211_ATTR_TDLS_OPERATION
] = { .
ty≥
 = 
NLA_U8
 },

641 [
NL80211_ATTR_TDLS_SUPPORT
] = { .
ty≥
 = 
NLA_FLAG
 },

642 [
NL80211_ATTR_TDLS_EXTERNAL_SETUP
] = { .
ty≥
 = 
NLA_FLAG
 },

643 [
NL80211_ATTR_TDLS_INITIATOR
] = { .
ty≥
 = 
NLA_FLAG
 },

644 [
NL80211_ATTR_DONT_WAIT_FOR_ACK
] = { .
ty≥
 = 
NLA_FLAG
 },

645 [
NL80211_ATTR_PROBE_RESP
] = { .
ty≥
 = 
NLA_BINARY
,

646 .
	gÀn
 = 
IEEE80211_MAX_DATA_LEN
 },

647 [
NL80211_ATTR_DFS_REGION
] = { .
ty≥
 = 
NLA_U8
 },

648 [
NL80211_ATTR_DISABLE_HT
] = { .
ty≥
 = 
NLA_FLAG
 },

649 [
NL80211_ATTR_HT_CAPABILITY_MASK
] = {

650 .
Àn
 = 
NL80211_HT_CAPABILITY_LEN


652 [
NL80211_ATTR_NOACK_MAP
] = { .
ty≥
 = 
NLA_U16
 },

653 [
NL80211_ATTR_INACTIVITY_TIMEOUT
] = { .
ty≥
 = 
NLA_U16
 },

654 [
NL80211_ATTR_BG_SCAN_PERIOD
] = { .
ty≥
 = 
NLA_U16
 },

655 [
NL80211_ATTR_WDEV
] = { .
ty≥
 = 
NLA_U64
 },

656 [
NL80211_ATTR_USER_REG_HINT_TYPE
] = { .
ty≥
 = 
NLA_U32
 },

659 [
NL80211_ATTR_AUTH_DATA
] = 
NLA_POLICY_MIN_LEN
(4),

661 [
NL80211_ATTR_VHT_CAPABILITY
] = 
NLA_POLICY_EXACT_LEN_WARN
(
NL80211_VHT_CAPABILITY_LEN
),

662 [
NL80211_ATTR_SCAN_FLAGS
] = { .
ty≥
 = 
NLA_U32
 },

663 [
NL80211_ATTR_P2P_CTWINDOW
] = 
NLA_POLICY_MAX
(
NLA_U8
, 127),

664 [
NL80211_ATTR_P2P_OPPPS
] = 
NLA_POLICY_MAX
(
NLA_U8
, 1),

665 [
NL80211_ATTR_LOCAL_MESH_POWER_MODE
] =

666 
NLA_POLICY_RANGE
(
NLA_U32
,

667 
NL80211_MESH_POWER_UNKNOWN
 + 1,

668 
NL80211_MESH_POWER_MAX
),

669 [
NL80211_ATTR_ACL_POLICY
] = {. 
ty≥
 = 
NLA_U32
 },

670 [
NL80211_ATTR_MAC_ADDRS
] = { .
ty≥
 = 
NLA_NESTED
 },

671 [
NL80211_ATTR_STA_CAPABILITY
] = { .
ty≥
 = 
NLA_U16
 },

672 [
NL80211_ATTR_STA_EXT_CAPABILITY
] = { .
ty≥
 = 
NLA_BINARY
, },

673 [
NL80211_ATTR_SPLIT_WIPHY_DUMP
] = { .
ty≥
 = 
NLA_FLAG
, },

674 [
NL80211_ATTR_DISABLE_VHT
] = { .
ty≥
 = 
NLA_FLAG
 },

675 [
NL80211_ATTR_VHT_CAPABILITY_MASK
] = {

676 .
Àn
 = 
NL80211_VHT_CAPABILITY_LEN
,

678 [
NL80211_ATTR_MDID
] = { .
ty≥
 = 
NLA_U16
 },

679 [
NL80211_ATTR_IE_RIC
] = { .
ty≥
 = 
NLA_BINARY
,

680 .
	gÀn
 = 
IEEE80211_MAX_DATA_LEN
 },

681 [
NL80211_ATTR_CRIT_PROT_ID
] = { .
ty≥
 = 
NLA_U16
 },

682 [
NL80211_ATTR_MAX_CRIT_PROT_DURATION
] =

683 
NLA_POLICY_MAX
(
NLA_U16
, 
NL80211_CRIT_PROTO_MAX_DURATION
),

684 [
NL80211_ATTR_PEER_AID
] =

685 
NLA_POLICY_RANGE
(
NLA_U16
, 1, 
IEEE80211_MAX_AID
),

686 [
NL80211_ATTR_CH_SWITCH_COUNT
] = { .
ty≥
 = 
NLA_U32
 },

687 [
NL80211_ATTR_CH_SWITCH_BLOCK_TX
] = { .
ty≥
 = 
NLA_FLAG
 },

688 [
NL80211_ATTR_CSA_IES
] = { .
ty≥
 = 
NLA_NESTED
 },

689 [
NL80211_ATTR_CNTDWN_OFFS_BEACON
] = { .
ty≥
 = 
NLA_BINARY
 },

690 [
NL80211_ATTR_CNTDWN_OFFS_PRESP
] = { .
ty≥
 = 
NLA_BINARY
 },

691 [
NL80211_ATTR_STA_SUPPORTED_CHANNELS
] = 
NLA_POLICY_MIN_LEN
(2),

696 [
NL80211_ATTR_STA_SUPPORTED_OPER_CLASSES
] =

697 
NLA_POLICY_RANGE
(
NLA_BINARY
, 2, 253),

698 [
NL80211_ATTR_HANDLE_DFS
] = { .
ty≥
 = 
NLA_FLAG
 },

699 [
NL80211_ATTR_OPMODE_NOTIF
] = { .
ty≥
 = 
NLA_U8
 },

700 [
NL80211_ATTR_VENDOR_ID
] = { .
ty≥
 = 
NLA_U32
 },

701 [
NL80211_ATTR_VENDOR_SUBCMD
] = { .
ty≥
 = 
NLA_U32
 },

702 [
NL80211_ATTR_VENDOR_DATA
] = { .
ty≥
 = 
NLA_BINARY
 },

703 [
NL80211_ATTR_QOS_MAP
] = 
NLA_POLICY_RANGE
(
NLA_BINARY
,

704 
IEEE80211_QOS_MAP_LEN_MIN
,

705 
IEEE80211_QOS_MAP_LEN_MAX
),

706 [
NL80211_ATTR_MAC_HINT
] = 
NLA_POLICY_EXACT_LEN_WARN
(
ETH_ALEN
),

707 [
NL80211_ATTR_WIPHY_FREQ_HINT
] = { .
ty≥
 = 
NLA_U32
 },

708 [
NL80211_ATTR_TDLS_PEER_CAPABILITY
] = { .
ty≥
 = 
NLA_U32
 },

709 [
NL80211_ATTR_SOCKET_OWNER
] = { .
ty≥
 = 
NLA_FLAG
 },

710 [
NL80211_ATTR_CSA_C_OFFSETS_TX
] = { .
ty≥
 = 
NLA_BINARY
 },

711 [
NL80211_ATTR_USE_RRM
] = { .
ty≥
 = 
NLA_FLAG
 },

712 [
NL80211_ATTR_TSID
] = 
NLA_POLICY_MAX
(
NLA_U8
, 
IEEE80211_NUM_TIDS
 - 1),

713 [
NL80211_ATTR_USER_PRIO
] =

714 
NLA_POLICY_MAX
(
NLA_U8
, 
IEEE80211_NUM_UPS
 - 1),

715 [
NL80211_ATTR_ADMITTED_TIME
] = { .
ty≥
 = 
NLA_U16
 },

716 [
NL80211_ATTR_SMPS_MODE
] = { .
ty≥
 = 
NLA_U8
 },

717 [
NL80211_ATTR_OPER_CLASS
] = { .
ty≥
 = 
NLA_U8
 },

718 [
NL80211_ATTR_MAC_MASK
] = 
NLA_POLICY_EXACT_LEN_WARN
(
ETH_ALEN
),

719 [
NL80211_ATTR_WIPHY_SELF_MANAGED_REG
] = { .
ty≥
 = 
NLA_FLAG
 },

720 [
NL80211_ATTR_NETNS_FD
] = { .
ty≥
 = 
NLA_U32
 },

721 [
NL80211_ATTR_SCHED_SCAN_DELAY
] = { .
ty≥
 = 
NLA_U32
 },

722 [
NL80211_ATTR_REG_INDOOR
] = { .
ty≥
 = 
NLA_FLAG
 },

723 [
NL80211_ATTR_PBSS
] = { .
ty≥
 = 
NLA_FLAG
 },

724 [
NL80211_ATTR_BSS_SELECT
] = { .
ty≥
 = 
NLA_NESTED
 },

725 [
NL80211_ATTR_STA_SUPPORT_P2P_PS
] =

726 
NLA_POLICY_MAX
(
NLA_U8
, 
NUM_NL80211_P2P_PS_STATUS
 - 1),

727 [
NL80211_ATTR_MU_MIMO_GROUP_DATA
] = {

728 .
Àn
 = 
VHT_MUMIMO_GROUPS_DATA_LEN


730 [
NL80211_ATTR_MU_MIMO_FOLLOW_MAC_ADDR
] = 
NLA_POLICY_EXACT_LEN_WARN
(
ETH_ALEN
),

731 [
NL80211_ATTR_NAN_MASTER_PREF
] = 
NLA_POLICY_MIN
(
NLA_U8
, 1),

732 [
NL80211_ATTR_BANDS
] = { .
ty≥
 = 
NLA_U32
 },

733 [
NL80211_ATTR_NAN_FUNC
] = { .
ty≥
 = 
NLA_NESTED
 },

734 [
NL80211_ATTR_FILS_KEK
] = { .
ty≥
 = 
NLA_BINARY
,

735 .
	gÀn
 = 
FILS_MAX_KEK_LEN
 },

736 [
NL80211_ATTR_FILS_NONCES
] = 
NLA_POLICY_EXACT_LEN_WARN
(2 * 
FILS_NONCE_LEN
),

737 [
NL80211_ATTR_MULTICAST_TO_UNICAST_ENABLED
] = { .
ty≥
 = 
NLA_FLAG
, },

738 [
NL80211_ATTR_BSSID
] = 
NLA_POLICY_EXACT_LEN_WARN
(
ETH_ALEN
),

739 [
NL80211_ATTR_SCHED_SCAN_RELATIVE_RSSI
] = { .
ty≥
 = 
NLA_S8
 },

740 [
NL80211_ATTR_SCHED_SCAN_RSSI_ADJUST
] = {

741 .
Àn
 = (
∆80211_bss_£À˘_rssi_adju°
)

743 [
NL80211_ATTR_TIMEOUT_REASON
] = { .
ty≥
 = 
NLA_U32
 },

744 [
NL80211_ATTR_FILS_ERP_USERNAME
] = { .
ty≥
 = 
NLA_BINARY
,

745 .
	gÀn
 = 
FILS_ERP_MAX_USERNAME_LEN
 },

746 [
NL80211_ATTR_FILS_ERP_REALM
] = { .
ty≥
 = 
NLA_BINARY
,

747 .
	gÀn
 = 
FILS_ERP_MAX_REALM_LEN
 },

748 [
NL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
] = { .
ty≥
 = 
NLA_U16
 },

749 [
NL80211_ATTR_FILS_ERP_RRK
] = { .
ty≥
 = 
NLA_BINARY
,

750 .
	gÀn
 = 
FILS_ERP_MAX_RRK_LEN
 },

751 [
NL80211_ATTR_FILS_CACHE_ID
] = 
NLA_POLICY_EXACT_LEN_WARN
(2),

752 [
NL80211_ATTR_PMK
] = { .
ty≥
 = 
NLA_BINARY
, .
	gÀn
 = 
PMK_MAX_LEN
 },

753 [
NL80211_ATTR_PMKR0_NAME
] = 
NLA_POLICY_EXACT_LEN
(
WLAN_PMK_NAME_LEN
),

754 [
NL80211_ATTR_SCHED_SCAN_MULTI
] = { .
ty≥
 = 
NLA_FLAG
 },

755 [
NL80211_ATTR_EXTERNAL_AUTH_SUPPORT
] = { .
ty≥
 = 
NLA_FLAG
 },

757 [
NL80211_ATTR_TXQ_LIMIT
] = { .
ty≥
 = 
NLA_U32
 },

758 [
NL80211_ATTR_TXQ_MEMORY_LIMIT
] = { .
ty≥
 = 
NLA_U32
 },

759 [
NL80211_ATTR_TXQ_QUANTUM
] = { .
ty≥
 = 
NLA_U32
 },

760 [
NL80211_ATTR_HE_CAPABILITY
] =

761 
NLA_POLICY_VALIDATE_FN
(
NLA_BINARY
, 
vÆid©e_he_ˇ∑
,

762 
NL80211_HE_MAX_CAPABILITY_LEN
),

763 [
NL80211_ATTR_FTM_RESPONDER
] =

764 
NLA_POLICY_NESTED
(
∆80211_·m_ª•⁄dî_pﬁicy
),

765 [
NL80211_ATTR_TIMEOUT
] = 
NLA_POLICY_MIN
(
NLA_U32
, 1),

766 [
NL80211_ATTR_PEER_MEASUREMENTS
] =

767 
NLA_POLICY_NESTED
(
∆80211_pm§_©å_pﬁicy
),

768 [
NL80211_ATTR_AIRTIME_WEIGHT
] = 
NLA_POLICY_MIN
(
NLA_U16
, 1),

769 [
NL80211_ATTR_SAE_PASSWORD
] = { .
ty≥
 = 
NLA_BINARY
,

770 .
	gÀn
 = 
SAE_PASSWORD_MAX_LEN
 },

771 [
NL80211_ATTR_TWT_RESPONDER
] = { .
ty≥
 = 
NLA_FLAG
 },

772 [
NL80211_ATTR_HE_OBSS_PD
] = 
NLA_POLICY_NESTED
(
he_obss_pd_pﬁicy
),

773 [
NL80211_ATTR_VLAN_ID
] = 
NLA_POLICY_RANGE
(
NLA_U16
, 1, 
VLAN_N_VID
 - 2),

774 [
NL80211_ATTR_HE_BSS_COLOR
] = 
NLA_POLICY_NESTED
(
he_bss_cﬁ‹_pﬁicy
),

775 [
NL80211_ATTR_TID_CONFIG
] =

776 
NLA_POLICY_NESTED_ARRAY
(
∆80211_tid_c⁄fig_©å_pﬁicy
),

777 [
NL80211_ATTR_CONTROL_PORT_NO_PREAUTH
] = { .
ty≥
 = 
NLA_FLAG
 },

778 [
NL80211_ATTR_PMK_LIFETIME
] = 
NLA_POLICY_MIN
(
NLA_U32
, 1),

779 [
NL80211_ATTR_PMK_REAUTH_THRESHOLD
] = 
NLA_POLICY_RANGE
(
NLA_U8
, 1, 100),

780 [
NL80211_ATTR_RECEIVE_MULTICAST
] = { .
ty≥
 = 
NLA_FLAG
 },

781 [
NL80211_ATTR_WIPHY_FREQ_OFFSET
] = 
NLA_POLICY_RANGE
(
NLA_U32
, 0, 999),

782 [
NL80211_ATTR_SCAN_FREQ_KHZ
] = { .
ty≥
 = 
NLA_NESTED
 },

783 [
NL80211_ATTR_HE_6GHZ_CAPABILITY
] =

784 
NLA_POLICY_EXACT_LEN
((
õì80211_he_6ghz_ˇ∑
)),

785 [
NL80211_ATTR_FILS_DISCOVERY
] =

786 
NLA_POLICY_NESTED
(
∆80211_fûs_discovîy_pﬁicy
),

787 [
NL80211_ATTR_UNSOL_BCAST_PROBE_RESP
] =

788 
NLA_POLICY_NESTED
(
∆80211_unsﬁ_bˇ°_¥obe_ª•_pﬁicy
),

789 [
NL80211_ATTR_S1G_CAPABILITY
] =

790 
NLA_POLICY_EXACT_LEN
(
IEEE80211_S1G_CAPABILITY_LEN
),

791 [
NL80211_ATTR_S1G_CAPABILITY_MASK
] =

792 
NLA_POLICY_EXACT_LEN
(
IEEE80211_S1G_CAPABILITY_LEN
),

793 [
NL80211_ATTR_SAE_PWE
] =

794 
NLA_POLICY_RANGE
(
NLA_U8
, 
NL80211_SAE_PWE_HUNT_AND_PECK
,

795 
NL80211_SAE_PWE_BOTH
),

796 [
NL80211_ATTR_RECONNECT_REQUESTED
] = { .
ty≥
 = 
NLA_REJECT
 },

797 [
NL80211_ATTR_SAR_SPEC
] = 
NLA_POLICY_NESTED
(
ßr_pﬁicy
),

798 [
NL80211_ATTR_DISABLE_HE
] = { .
ty≥
 = 
NLA_FLAG
 },

799 [
NL80211_ATTR_OBSS_COLOR_BITMAP
] = { .
ty≥
 = 
NLA_U64
 },

800 [
NL80211_ATTR_COLOR_CHANGE_COUNT
] = { .
ty≥
 = 
NLA_U8
 },

801 [
NL80211_ATTR_COLOR_CHANGE_COLOR
] = { .
ty≥
 = 
NLA_U8
 },

802 [
NL80211_ATTR_COLOR_CHANGE_ELEMS
] = 
NLA_POLICY_NESTED
(
∆80211_pﬁicy
),

803 [
NL80211_ATTR_MBSSID_CONFIG
] =

804 
NLA_POLICY_NESTED
(
∆80211_mbssid_c⁄fig_pﬁicy
),

805 [
NL80211_ATTR_MBSSID_ELEMS
] = { .
ty≥
 = 
NLA_NESTED
 },

806 [
NL80211_ATTR_RADAR_BACKGROUND
] = { .
ty≥
 = 
NLA_FLAG
 },

807 [
NL80211_ATTR_AP_SETTINGS_FLAGS
] = { .
ty≥
 = 
NLA_U32
 },

808 [
NL80211_ATTR_EHT_CAPABILITY
] =

809 
NLA_POLICY_RANGE
(
NLA_BINARY
,

810 
NL80211_EHT_MIN_CAPABILITY_LEN
,

811 
NL80211_EHT_MAX_CAPABILITY_LEN
),

812 [
NL80211_ATTR_DISABLE_EHT
] = { .
ty≥
 = 
NLA_FLAG
 },

813 [
NL80211_ATTR_MLO_LINKS
] =

814 
NLA_POLICY_NESTED_ARRAY
(
∆80211_pﬁicy
),

815 [
NL80211_ATTR_MLO_LINK_ID
] =

816 
NLA_POLICY_RANGE
(
NLA_U8
, 0, 
IEEE80211_MLD_MAX_NUM_LINKS
),

817 [
NL80211_ATTR_MLD_ADDR
] = 
NLA_POLICY_EXACT_LEN
(
ETH_ALEN
),

818 [
NL80211_ATTR_MLO_SUPPORT
] = { .
ty≥
 = 
NLA_FLAG
 },

819 [
NL80211_ATTR_MAX_NUM_AKM_SUITES
] = { .
ty≥
 = 
NLA_REJECT
 },

820 [
NL80211_ATTR_PUNCT_BITMAP
] =

821 
NLA_POLICY_FULL_RANGE
(
NLA_U32
, &
∆80211_pun˘_bôm≠_ønge
),

823 [
NL80211_ATTR_MAX_HW_TIMESTAMP_PEERS
] = { .
ty≥
 = 
NLA_U16
 },

824 [
NL80211_ATTR_HW_TIMESTAMP_ENABLED
] = { .
ty≥
 = 
NLA_FLAG
 },

825 [
NL80211_ATTR_EMA_RNR_ELEMS
] = { .
ty≥
 = 
NLA_NESTED
 },

826 [
NL80211_ATTR_MLO_LINK_DISABLED
] = { .
ty≥
 = 
NLA_FLAG
 },

827 [
NL80211_ATTR_BSS_DUMP_INCLUDE_USE_DATA
] = { .
ty≥
 = 
NLA_FLAG
 },

828 [
NL80211_ATTR_MLO_TTLM_DLINK
] = 
NLA_POLICY_EXACT_LEN
((
u16
) * 8),

829 [
NL80211_ATTR_MLO_TTLM_ULINK
] = 
NLA_POLICY_EXACT_LEN
((
u16
) * 8),

830 [
NL80211_ATTR_ASSOC_SPP_AMSDU
] = { .
ty≥
 = 
NLA_FLAG
 },

834 c⁄° 
∆a_pﬁicy
 
	g∆80211_key_pﬁicy
[
NL80211_KEY_MAX
 + 1] = {

835 [
NL80211_KEY_DATA
] = { .
ty≥
 = 
NLA_BINARY
, .
	gÀn
 = 
WLAN_MAX_KEY_LEN
 },

836 [
NL80211_KEY_IDX
] = { .
ty≥
 = 
NLA_U8
 },

837 [
NL80211_KEY_CIPHER
] = { .
ty≥
 = 
NLA_U32
 },

838 [
NL80211_KEY_SEQ
] = { .
ty≥
 = 
NLA_BINARY
, .
	gÀn
 = 16 },

839 [
NL80211_KEY_DEFAULT
] = { .
ty≥
 = 
NLA_FLAG
 },

840 [
NL80211_KEY_DEFAULT_MGMT
] = { .
ty≥
 = 
NLA_FLAG
 },

841 [
NL80211_KEY_TYPE
] = 
NLA_POLICY_MAX
(
NLA_U32
, 
NUM_NL80211_KEYTYPES
 - 1),

842 [
NL80211_KEY_DEFAULT_TYPES
] = { .
ty≥
 = 
NLA_NESTED
 },

843 [
NL80211_KEY_MODE
] = 
NLA_POLICY_RANGE
(
NLA_U8
, 0, 
NL80211_KEY_SET_TX
),

847 c⁄° 
∆a_pﬁicy


848 
	g∆80211_key_deÁu…_pﬁicy
[
NUM_NL80211_KEY_DEFAULT_TYPES
] = {

849 [
NL80211_KEY_DEFAULT_TYPE_UNICAST
] = { .
ty≥
 = 
NLA_FLAG
 },

850 [
NL80211_KEY_DEFAULT_TYPE_MULTICAST
] = { .
ty≥
 = 
NLA_FLAG
 },

853 #ifde‡
CONFIG_PM


855 c⁄° 
∆a_pﬁicy


856 
	g∆80211_wowœn_pﬁicy
[
NUM_NL80211_WOWLAN_TRIG
] = {

857 [
NL80211_WOWLAN_TRIG_ANY
] = { .
ty≥
 = 
NLA_FLAG
 },

858 [
NL80211_WOWLAN_TRIG_DISCONNECT
] = { .
ty≥
 = 
NLA_FLAG
 },

859 [
NL80211_WOWLAN_TRIG_MAGIC_PKT
] = { .
ty≥
 = 
NLA_FLAG
 },

860 [
NL80211_WOWLAN_TRIG_PKT_PATTERN
] = { .
ty≥
 = 
NLA_NESTED
 },

861 [
NL80211_WOWLAN_TRIG_GTK_REKEY_FAILURE
] = { .
ty≥
 = 
NLA_FLAG
 },

862 [
NL80211_WOWLAN_TRIG_EAP_IDENT_REQUEST
] = { .
ty≥
 = 
NLA_FLAG
 },

863 [
NL80211_WOWLAN_TRIG_4WAY_HANDSHAKE
] = { .
ty≥
 = 
NLA_FLAG
 },

864 [
NL80211_WOWLAN_TRIG_RFKILL_RELEASE
] = { .
ty≥
 = 
NLA_FLAG
 },

865 [
NL80211_WOWLAN_TRIG_TCP_CONNECTION
] = { .
ty≥
 = 
NLA_NESTED
 },

866 [
NL80211_WOWLAN_TRIG_NET_DETECT
] = { .
ty≥
 = 
NLA_NESTED
 },

869 c⁄° 
∆a_pﬁicy


870 
	g∆80211_wowœn_t˝_pﬁicy
[
NUM_NL80211_WOWLAN_TCP
] = {

871 [
NL80211_WOWLAN_TCP_SRC_IPV4
] = { .
ty≥
 = 
NLA_U32
 },

872 [
NL80211_WOWLAN_TCP_DST_IPV4
] = { .
ty≥
 = 
NLA_U32
 },

873 [
NL80211_WOWLAN_TCP_DST_MAC
] = 
NLA_POLICY_EXACT_LEN_WARN
(
ETH_ALEN
),

874 [
NL80211_WOWLAN_TCP_SRC_PORT
] = { .
ty≥
 = 
NLA_U16
 },

875 [
NL80211_WOWLAN_TCP_DST_PORT
] = { .
ty≥
 = 
NLA_U16
 },

876 [
NL80211_WOWLAN_TCP_DATA_PAYLOAD
] = 
NLA_POLICY_MIN_LEN
(1),

877 [
NL80211_WOWLAN_TCP_DATA_PAYLOAD_SEQ
] = {

878 .
Àn
 = (
∆80211_wowœn_t˝_d©a_£q
)

880 [
NL80211_WOWLAN_TCP_DATA_PAYLOAD_TOKEN
] = {

881 .
Àn
 = (
∆80211_wowœn_t˝_d©a_tokí
)

883 [
NL80211_WOWLAN_TCP_DATA_INTERVAL
] = { .
ty≥
 = 
NLA_U32
 },

884 [
NL80211_WOWLAN_TCP_WAKE_PAYLOAD
] = 
NLA_POLICY_MIN_LEN
(1),

885 [
NL80211_WOWLAN_TCP_WAKE_MASK
] = 
NLA_POLICY_MIN_LEN
(1),

890 c⁄° 
∆a_pﬁicy


891 
	g∆80211_cﬂÀs˚_pﬁicy
[
NUM_NL80211_ATTR_COALESCE_RULE
] = {

892 [
NL80211_ATTR_COALESCE_RULE_DELAY
] = { .
ty≥
 = 
NLA_U32
 },

893 [
NL80211_ATTR_COALESCE_RULE_CONDITION
] =

894 
NLA_POLICY_RANGE
(
NLA_U32
,

895 
NL80211_COALESCE_CONDITION_MATCH
,

896 
NL80211_COALESCE_CONDITION_NO_MATCH
),

897 [
NL80211_ATTR_COALESCE_RULE_PKT_PATTERN
] = { .
ty≥
 = 
NLA_NESTED
 },

901 c⁄° 
∆a_pﬁicy


902 
	g∆80211_ªkey_pﬁicy
[
NUM_NL80211_REKEY_DATA
] = {

903 [
NL80211_REKEY_DATA_KEK
] = {

904 .
ty≥
 = 
NLA_BINARY
,

905 .
	gÀn
 = 
NL80211_KEK_EXT_LEN


907 [
NL80211_REKEY_DATA_KCK
] = {

908 .
ty≥
 = 
NLA_BINARY
,

909 .
	gÀn
 = 
NL80211_KCK_EXT_LEN_32


911 [
NL80211_REKEY_DATA_REPLAY_CTR
] = 
NLA_POLICY_EXACT_LEN
(
NL80211_REPLAY_CTR_LEN
),

912 [
NL80211_REKEY_DATA_AKM
] = { .
ty≥
 = 
NLA_U32
 },

915 c⁄° 
∆a_pﬁicy


916 
	g∆80211_m©ch_pﬁicy
[
NL80211_SCHED_SCAN_MATCH_ATTR_MAX
 + 1] = {

917 [
NL80211_SCHED_SCAN_MATCH_ATTR_SSID
] = { .
ty≥
 = 
NLA_BINARY
,

918 .
	gÀn
 = 
IEEE80211_MAX_SSID_LEN
 },

919 [
NL80211_SCHED_SCAN_MATCH_ATTR_BSSID
] = 
NLA_POLICY_EXACT_LEN_WARN
(
ETH_ALEN
),

920 [
NL80211_SCHED_SCAN_MATCH_ATTR_RSSI
] = { .
ty≥
 = 
NLA_U32
 },

923 c⁄° 
∆a_pﬁicy


924 
	g∆80211_∂™_pﬁicy
[
NL80211_SCHED_SCAN_PLAN_MAX
 + 1] = {

925 [
NL80211_SCHED_SCAN_PLAN_INTERVAL
] = { .
ty≥
 = 
NLA_U32
 },

926 [
NL80211_SCHED_SCAN_PLAN_ITERATIONS
] = { .
ty≥
 = 
NLA_U32
 },

929 c⁄° 
∆a_pﬁicy


930 
	g∆80211_bss_£À˘_pﬁicy
[
NL80211_BSS_SELECT_ATTR_MAX
 + 1] = {

931 [
NL80211_BSS_SELECT_ATTR_RSSI
] = { .
ty≥
 = 
NLA_FLAG
 },

932 [
NL80211_BSS_SELECT_ATTR_BAND_PREF
] = { .
ty≥
 = 
NLA_U32
 },

933 [
NL80211_BSS_SELECT_ATTR_RSSI_ADJUST
] = {

934 .
Àn
 = (
∆80211_bss_£À˘_rssi_adju°
)

939 c⁄° 
∆a_pﬁicy


940 
	g∆80211_«n_func_pﬁicy
[
NL80211_NAN_FUNC_ATTR_MAX
 + 1] = {

941 [
NL80211_NAN_FUNC_TYPE
] =

942 
NLA_POLICY_MAX
(
NLA_U8
, 
NL80211_NAN_FUNC_MAX_TYPE
),

943 [
NL80211_NAN_FUNC_SERVICE_ID
] = {

944 .
Àn
 = 
NL80211_NAN_FUNC_SERVICE_ID_LEN
 },

945 [
NL80211_NAN_FUNC_PUBLISH_TYPE
] = { .
ty≥
 = 
NLA_U8
 },

946 [
NL80211_NAN_FUNC_PUBLISH_BCAST
] = { .
ty≥
 = 
NLA_FLAG
 },

947 [
NL80211_NAN_FUNC_SUBSCRIBE_ACTIVE
] = { .
ty≥
 = 
NLA_FLAG
 },

948 [
NL80211_NAN_FUNC_FOLLOW_UP_ID
] = { .
ty≥
 = 
NLA_U8
 },

949 [
NL80211_NAN_FUNC_FOLLOW_UP_REQ_ID
] = { .
ty≥
 = 
NLA_U8
 },

950 [
NL80211_NAN_FUNC_FOLLOW_UP_DEST
] = 
NLA_POLICY_EXACT_LEN_WARN
(
ETH_ALEN
),

951 [
NL80211_NAN_FUNC_CLOSE_RANGE
] = { .
ty≥
 = 
NLA_FLAG
 },

952 [
NL80211_NAN_FUNC_TTL
] = { .
ty≥
 = 
NLA_U32
 },

953 [
NL80211_NAN_FUNC_SERVICE_INFO
] = { .
ty≥
 = 
NLA_BINARY
,

954 .
	gÀn
 = 
NL80211_NAN_FUNC_SERVICE_SPEC_INFO_MAX_LEN
 },

955 [
NL80211_NAN_FUNC_SRF
] = { .
ty≥
 = 
NLA_NESTED
 },

956 [
NL80211_NAN_FUNC_RX_MATCH_FILTER
] = { .
ty≥
 = 
NLA_NESTED
 },

957 [
NL80211_NAN_FUNC_TX_MATCH_FILTER
] = { .
ty≥
 = 
NLA_NESTED
 },

958 [
NL80211_NAN_FUNC_INSTANCE_ID
] = { .
ty≥
 = 
NLA_U8
 },

959 [
NL80211_NAN_FUNC_TERM_REASON
] = { .
ty≥
 = 
NLA_U8
 },

963 c⁄° 
∆a_pﬁicy


964 
	g∆80211_«n_§f_pﬁicy
[
NL80211_NAN_SRF_ATTR_MAX
 + 1] = {

965 [
NL80211_NAN_SRF_INCLUDE
] = { .
ty≥
 = 
NLA_FLAG
 },

966 [
NL80211_NAN_SRF_BF
] = { .
ty≥
 = 
NLA_BINARY
,

967 .
	gÀn
 = 
NL80211_NAN_FUNC_SRF_MAX_LEN
 },

968 [
NL80211_NAN_SRF_BF_IDX
] = { .
ty≥
 = 
NLA_U8
 },

969 [
NL80211_NAN_SRF_MAC_ADDRS
] = { .
ty≥
 = 
NLA_NESTED
 },

973 c⁄° 
∆a_pﬁicy


974 
	g∆80211_∑ckë_∑âîn_pﬁicy
[
MAX_NL80211_PKTPAT
 + 1] = {

975 [
NL80211_PKTPAT_MASK
] = { .
ty≥
 = 
NLA_BINARY
, },

976 [
NL80211_PKTPAT_PATTERN
] = { .
ty≥
 = 
NLA_BINARY
, },

977 [
NL80211_PKTPAT_OFFSET
] = { .
ty≥
 = 
NLA_U32
 },

980 
	$∆80211_¥ï¨e_wdev_dump
(
√éök_ˇŒback
 *
cb
,

981 
cfg80211_ªgi°îed_devi˚
 **
rdev
,

982 
wúñess_dev
 **
wdev
,

983 
∆©å
 **
©åbuf
)

985 
îr
;

987 i‡(!
cb
->
¨gs
[0]) {

988 
∆©å
 **
©åbuf_‰ì
 = 
NULL
;

990 i‡(!
©åbuf
) {

991 
©åbuf
 = 
	`kˇŒoc
(
NUM_NL80211_ATTR
, (*attrbuf),

992 
GFP_KERNEL
);

993 i‡(!
©åbuf
)

994  -
ENOMEM
;

995 
©åbuf_‰ì
 = 
©åbuf
;

998 
îr
 = 
	`∆msg_∑r£_dïªˇãd
(
cb
->
∆h
,

999 
GENL_HDRLEN
 + 
∆80211_Ám
.
hdrsize
,

1000 
©åbuf
, 
∆80211_Ám
.
max©å
,

1001 
∆80211_pﬁicy
, 
NULL
);

1002 i‡(
îr
) {

1003 
	`k‰ì
(
©åbuf_‰ì
);

1004  
îr
;

1007 
	`π∆_lock
();

1008 *
wdev
 = 
	`__cfg80211_wdev_‰om_©ås
(
NULL
, 
	`sock_√t
(
cb
->
skb
->
sk
),

1009 
©åbuf
);

1010 
	`k‰ì
(
©åbuf_‰ì
);

1011 i‡(
	`IS_ERR
(*
wdev
)) {

1012 
	`π∆_u∆ock
();

1013  
	`PTR_ERR
(*
wdev
);

1015 *
rdev
 = 
	`wùhy_to_rdev
((*
wdev
)->
wùhy
);

1016 
	`muãx_lock
(&(*
rdev
)->
wùhy
.
mtx
);

1017 
	`π∆_u∆ock
();

1019 
cb
->
¨gs
[0] = (*
rdev
)->
wùhy_idx
 + 1;

1020 
cb
->
¨gs
[1] = (*
wdev
)->
idítifõr
;

1023 
wùhy
 *wiphy;

1024 
wúñess_dev
 *
tmp
;

1026 
	`π∆_lock
();

1027 
wùhy
 = 
	`wùhy_idx_to_wùhy
(
cb
->
¨gs
[0] - 1);

1028 i‡(!
wùhy
) {

1029 
	`π∆_u∆ock
();

1030  -
ENODEV
;

1032 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1033 *
wdev
 = 
NULL
;

1035 
	`li°_f‹_óch_íåy
(
tmp
, &(*
rdev
)->
wùhy
.
wdev_li°
, 
li°
) {

1036 i‡(
tmp
->
idítifõr
 =
cb
->
¨gs
[1]) {

1037 *
wdev
 = 
tmp
;

1042 i‡(!*
wdev
) {

1043 
	`π∆_u∆ock
();

1044  -
ENODEV
;

1046 
	`muãx_lock
(&(*
rdev
)->
wùhy
.
mtx
);

1047 
	`π∆_u∆ock
();

1051 
	}
}

1054 *
	$∆80211hdr_put
(
sk_buff
 *
skb
, 
u32
 
p‹tid
, u32 
£q
,

1055 
Êags
, 
u8
 
cmd
)

1058  
	`gílmsg_put
(
skb
, 
p‹tid
, 
£q
, &
∆80211_Ám
, 
Êags
, 
cmd
);

1059 
	}
}

1061 
	$∆80211_msg_put_wmm_ruÀs
(
sk_buff
 *
msg
,

1062 c⁄° 
õì80211_ªg_ruÀ
 *
ruÀ
)

1064 
j
;

1065 
∆©å
 *
∆_wmm_ruÀs
 =

1066 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_FREQUENCY_ATTR_WMM
);

1068 i‡(!
∆_wmm_ruÀs
)

1069 
∆a_put_Áûuª
;

1071 
j
 = 0; j < 
IEEE80211_NUM_ACS
; j++) {

1072 
∆©å
 *
∆_wmm_ruÀ
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
j
);

1074 i‡(!
∆_wmm_ruÀ
)

1075 
∆a_put_Áûuª
;

1077 i‡(
	`∆a_put_u16
(
msg
, 
NL80211_WMMR_CW_MIN
,

1078 
ruÀ
->
wmm_ruÀ
.
˛õ¡
[
j
].
cw_mö
) ||

1079 
	`∆a_put_u16
(
msg
, 
NL80211_WMMR_CW_MAX
,

1080 
ruÀ
->
wmm_ruÀ
.
˛õ¡
[
j
].
cw_max
) ||

1081 
	`∆a_put_u8
(
msg
, 
NL80211_WMMR_AIFSN
,

1082 
ruÀ
->
wmm_ruÀ
.
˛õ¡
[
j
].
aif¢
) ||

1083 
	`∆a_put_u16
(
msg
, 
NL80211_WMMR_TXOP
,

1084 
ruÀ
->
wmm_ruÀ
.
˛õ¡
[
j
].
cŸ
))

1085 
∆a_put_Áûuª
;

1087 
	`∆a_√°_íd
(
msg
, 
∆_wmm_ruÀ
);

1089 
	`∆a_√°_íd
(
msg
, 
∆_wmm_ruÀs
);

1093 
∆a_put_Áûuª
:

1094  -
ENOBUFS
;

1095 
	}
}

1097 
	$∆80211_msg_put_ch™√l
(
sk_buff
 *
msg
, 
wùhy
 *wiphy,

1098 
õì80211_ch™√l
 *
ch™
,

1099 
boﬁ
 
œrge
)

1104 i‡(!
œrge
 && 
ch™
->
Êags
 &

1105 (
IEEE80211_CHAN_NO_10MHZ
 | 
IEEE80211_CHAN_NO_20MHZ
))

1107 i‡(!
œrge
 && 
ch™
->
‰eq_off£t
)

1110 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_FREQUENCY_ATTR_FREQ
,

1111 
ch™
->
˚¡î_‰eq
))

1112 
∆a_put_Áûuª
;

1114 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_FREQUENCY_ATTR_OFFSET
, 
ch™
->
‰eq_off£t
))

1115 
∆a_put_Áûuª
;

1117 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_PSD
) &&

1118 
	`∆a_put_s8
(
msg
, 
NL80211_FREQUENCY_ATTR_PSD
, 
ch™
->
psd
))

1119 
∆a_put_Áûuª
;

1121 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
) &&

1122 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_DISABLED
))

1123 
∆a_put_Áûuª
;

1124 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_IR
) {

1125 i‡(
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_IR
))

1126 
∆a_put_Áûuª
;

1127 i‡(
	`∆a_put_Êag
(
msg
, 
__NL80211_FREQUENCY_ATTR_NO_IBSS
))

1128 
∆a_put_Áûuª
;

1130 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_RADAR
) {

1131 i‡(
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_RADAR
))

1132 
∆a_put_Áûuª
;

1133 i‡(
œrge
) {

1134 
u32
 
time
;

1136 
time
 = 
	`ñ≠£d_jiffõs_m£cs
(
ch™
->
dfs_°©e_íãªd
);

1138 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_FREQUENCY_ATTR_DFS_STATE
,

1139 
ch™
->
dfs_°©e
))

1140 
∆a_put_Áûuª
;

1141 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_FREQUENCY_ATTR_DFS_TIME
,

1142 
time
))

1143 
∆a_put_Áûuª
;

1144 i‡(
	`∆a_put_u32
(
msg
,

1145 
NL80211_FREQUENCY_ATTR_DFS_CAC_TIME
,

1146 
ch™
->
dfs_ˇc_ms
))

1147 
∆a_put_Áûuª
;

1151 i‡(
œrge
) {

1152 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_HT40MINUS
) &&

1153 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_HT40_MINUS
))

1154 
∆a_put_Áûuª
;

1155 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_HT40PLUS
) &&

1156 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_HT40_PLUS
))

1157 
∆a_put_Áûuª
;

1158 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_80MHZ
) &&

1159 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_80MHZ
))

1160 
∆a_put_Áûuª
;

1161 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_160MHZ
) &&

1162 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_160MHZ
))

1163 
∆a_put_Áûuª
;

1164 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_INDOOR_ONLY
) &&

1165 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_INDOOR_ONLY
))

1166 
∆a_put_Áûuª
;

1167 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_IR_CONCURRENT
) &&

1168 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_IR_CONCURRENT
))

1169 
∆a_put_Áûuª
;

1170 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_20MHZ
) &&

1171 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_20MHZ
))

1172 
∆a_put_Áûuª
;

1173 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_10MHZ
) &&

1174 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_10MHZ
))

1175 
∆a_put_Áûuª
;

1176 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_HE
) &&

1177 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_HE
))

1178 
∆a_put_Áûuª
;

1179 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_1MHZ
) &&

1180 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_1MHZ
))

1181 
∆a_put_Áûuª
;

1182 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_2MHZ
) &&

1183 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_2MHZ
))

1184 
∆a_put_Áûuª
;

1185 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_4MHZ
) &&

1186 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_4MHZ
))

1187 
∆a_put_Áûuª
;

1188 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_8MHZ
) &&

1189 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_8MHZ
))

1190 
∆a_put_Áûuª
;

1191 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_16MHZ
) &&

1192 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_16MHZ
))

1193 
∆a_put_Áûuª
;

1194 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_320MHZ
) &&

1195 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_320MHZ
))

1196 
∆a_put_Áûuª
;

1197 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_EHT
) &&

1198 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_EHT
))

1199 
∆a_put_Áûuª
;

1200 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_DFS_CONCURRENT
) &&

1201 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_DFS_CONCURRENT
))

1202 
∆a_put_Áûuª
;

1203 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_6GHZ_VLP_CLIENT
) &&

1204 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_6GHZ_VLP_CLIENT
))

1205 
∆a_put_Áûuª
;

1206 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_6GHZ_AFC_CLIENT
) &&

1207 
	`∆a_put_Êag
(
msg
, 
NL80211_FREQUENCY_ATTR_NO_6GHZ_AFC_CLIENT
))

1208 
∆a_put_Áûuª
;

1211 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_FREQUENCY_ATTR_MAX_TX_POWER
,

1212 
	`DBM_TO_MBM
(
ch™
->
max_powî
)))

1213 
∆a_put_Áûuª
;

1215 i‡(
œrge
) {

1216 c⁄° 
õì80211_ªg_ruÀ
 *
ruÀ
 =

1217 
	`‰eq_ªg_öfo
(
wùhy
, 
	`MHZ_TO_KHZ
(
ch™
->
˚¡î_‰eq
));

1219 i‡(!
	`IS_ERR_OR_NULL
(
ruÀ
Ë&&ÑuÀ->
has_wmm
) {

1220 i‡(
	`∆80211_msg_put_wmm_ruÀs
(
msg
, 
ruÀ
))

1221 
∆a_put_Áûuª
;

1227 
∆a_put_Áûuª
:

1228  -
ENOBUFS
;

1229 
	}
}

1231 
boﬁ
 
	$∆80211_put_txq_°©s
(
sk_buff
 *
msg
,

1232 
cfg80211_txq_°©s
 *
txq°©s
,

1233 
©åty≥
)

1235 
∆©å
 *
txq©å
;

1237 
	#PUT_TXQVAL_U32
(
©å
, 
memb
) do { \

1238 i‡(
txq°©s
->
fûÀd
 & 
	`BIT
(
NL80211_TXQ_STATS_
 ## 
©å
) && \

1239 
	`∆a_put_u32
(
msg
, 
NL80211_TXQ_STATS_
 ## 
©å
, 
txq°©s
->
memb
)) \

1240  
Ál£
; \

1241 } 0)

	)

1243 
txq©å
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
©åty≥
);

1244 i‡(!
txq©å
)

1245  
Ál£
;

1247 
	`PUT_TXQVAL_U32
(
BACKLOG_BYTES
, 
backlog_byãs
);

1248 
	`PUT_TXQVAL_U32
(
BACKLOG_PACKETS
, 
backlog_∑ckës
);

1249 
	`PUT_TXQVAL_U32
(
FLOWS
, 
Êows
);

1250 
	`PUT_TXQVAL_U32
(
DROPS
, 
dr›s
);

1251 
	`PUT_TXQVAL_U32
(
ECN_MARKS
, 
e˙_m¨ks
);

1252 
	`PUT_TXQVAL_U32
(
OVERLIMIT
, 
ovîlimô
);

1253 
	`PUT_TXQVAL_U32
(
OVERMEMORY
, 
ovîmem‹y
);

1254 
	`PUT_TXQVAL_U32
(
COLLISIONS
, 
cﬁlisi⁄s
);

1255 
	`PUT_TXQVAL_U32
(
TX_BYTES
, 
tx_byãs
);

1256 
	`PUT_TXQVAL_U32
(
TX_PACKETS
, 
tx_∑ckës
);

1257 
	`PUT_TXQVAL_U32
(
MAX_FLOWS
, 
max_Êows
);

1258 
	`∆a_√°_íd
(
msg
, 
txq©å
);

1260 #unde‡
PUT_TXQVAL_U32


1261  
åue
;

1262 
	}
}

1277 
	$∆80211_lök_id
(
∆©å
 **
©ås
)

1279 
∆©å
 *
lökid
 = 
©ås
[
NL80211_ATTR_MLO_LINK_ID
];

1281 i‡(!
lökid
)

1284  
	`∆a_gë_u8
(
lökid
);

1285 
	}
}

1287 
	$∆80211_lök_id_‹_övÆid
(
∆©å
 **
©ås
)

1289 
∆©å
 *
lökid
 = 
©ås
[
NL80211_ATTR_MLO_LINK_ID
];

1291 i‡(!
lökid
)

1294  
	`∆a_gë_u8
(
lökid
);

1295 
	}
}

1297 
	skey_∑r£
 {

1298 
key_∑øms
 
	mp
;

1299 
	midx
;

1300 
	mty≥
;

1301 
boﬁ
 
	mdef
, 
	mdefmgmt
, 
	mdefbóc⁄
;

1302 
boﬁ
 
	mdef_uni
, 
	mdef_mu…i
;

1305 
	$∆80211_∑r£_key_√w
(
gíl_öfo
 *
öfo
, 
∆©å
 *
key
,

1306 
key_∑r£
 *
k
)

1308 
∆©å
 *
tb
[
NL80211_KEY_MAX
 + 1];

1309 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
NL80211_KEY_MAX
, 
key
,

1310 
∆80211_key_pﬁicy
,

1311 
öfo
->
exèck
);

1312 i‡(
îr
)

1313  
îr
;

1315 
k
->
def
 = !!
tb
[
NL80211_KEY_DEFAULT
];

1316 
k
->
defmgmt
 = !!
tb
[
NL80211_KEY_DEFAULT_MGMT
];

1317 
k
->
defbóc⁄
 = !!
tb
[
NL80211_KEY_DEFAULT_BEACON
];

1319 i‡(
k
->
def
) {

1320 
k
->
def_uni
 = 
åue
;

1321 
k
->
def_mu…i
 = 
åue
;

1323 i‡(
k
->
defmgmt
 || k->
defbóc⁄
)

1324 
k
->
def_mu…i
 = 
åue
;

1326 i‡(
tb
[
NL80211_KEY_IDX
])

1327 
k
->
idx
 = 
	`∆a_gë_u8
(
tb
[
NL80211_KEY_IDX
]);

1329 i‡(
tb
[
NL80211_KEY_DATA
]) {

1330 
k
->
p
.
key
 = 
	`∆a_d©a
(
tb
[
NL80211_KEY_DATA
]);

1331 
k
->
p
.
key_Àn
 = 
	`∆a_Àn
(
tb
[
NL80211_KEY_DATA
]);

1334 i‡(
tb
[
NL80211_KEY_SEQ
]) {

1335 
k
->
p
.
£q
 = 
	`∆a_d©a
(
tb
[
NL80211_KEY_SEQ
]);

1336 
k
->
p
.
£q_Àn
 = 
	`∆a_Àn
(
tb
[
NL80211_KEY_SEQ
]);

1339 i‡(
tb
[
NL80211_KEY_CIPHER
])

1340 
k
->
p
.
cùhî
 = 
	`∆a_gë_u32
(
tb
[
NL80211_KEY_CIPHER
]);

1342 i‡(
tb
[
NL80211_KEY_TYPE
])

1343 
k
->
ty≥
 = 
	`∆a_gë_u32
(
tb
[
NL80211_KEY_TYPE
]);

1345 i‡(
tb
[
NL80211_KEY_DEFAULT_TYPES
]) {

1346 
∆©å
 *
kdt
[
NUM_NL80211_KEY_DEFAULT_TYPES
];

1348 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
kdt
,

1349 
NUM_NL80211_KEY_DEFAULT_TYPES
 - 1,

1350 
tb
[
NL80211_KEY_DEFAULT_TYPES
],

1351 
∆80211_key_deÁu…_pﬁicy
,

1352 
öfo
->
exèck
);

1353 i‡(
îr
)

1354  
îr
;

1356 
k
->
def_uni
 = 
kdt
[
NL80211_KEY_DEFAULT_TYPE_UNICAST
];

1357 
k
->
def_mu…i
 = 
kdt
[
NL80211_KEY_DEFAULT_TYPE_MULTICAST
];

1360 i‡(
tb
[
NL80211_KEY_MODE
])

1361 
k
->
p
.
mode
 = 
	`∆a_gë_u8
(
tb
[
NL80211_KEY_MODE
]);

1364 
	}
}

1366 
	$∆80211_∑r£_key_ﬁd
(
gíl_öfo
 *
öfo
, 
key_∑r£
 *
k
)

1368 i‡(
öfo
->
©ås
[
NL80211_ATTR_KEY_DATA
]) {

1369 
k
->
p
.
key
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_KEY_DATA
]);

1370 
k
->
p
.
key_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_KEY_DATA
]);

1373 i‡(
öfo
->
©ås
[
NL80211_ATTR_KEY_SEQ
]) {

1374 
k
->
p
.
£q
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_KEY_SEQ
]);

1375 
k
->
p
.
£q_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_KEY_SEQ
]);

1378 i‡(
öfo
->
©ås
[
NL80211_ATTR_KEY_IDX
])

1379 
k
->
idx
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_KEY_IDX
]);

1381 i‡(
öfo
->
©ås
[
NL80211_ATTR_KEY_CIPHER
])

1382 
k
->
p
.
cùhî
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_KEY_CIPHER
]);

1384 
k
->
def
 = !!
öfo
->
©ås
[
NL80211_ATTR_KEY_DEFAULT
];

1385 
k
->
defmgmt
 = !!
öfo
->
©ås
[
NL80211_ATTR_KEY_DEFAULT_MGMT
];

1387 i‡(
k
->
def
) {

1388 
k
->
def_uni
 = 
åue
;

1389 
k
->
def_mu…i
 = 
åue
;

1391 i‡(
k
->
defmgmt
)

1392 
k
->
def_mu…i
 = 
åue
;

1394 i‡(
öfo
->
©ås
[
NL80211_ATTR_KEY_TYPE
])

1395 
k
->
ty≥
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_KEY_TYPE
]);

1397 i‡(
öfo
->
©ås
[
NL80211_ATTR_KEY_DEFAULT_TYPES
]) {

1398 
∆©å
 *
kdt
[
NUM_NL80211_KEY_DEFAULT_TYPES
];

1399 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
kdt
,

1400 
NUM_NL80211_KEY_DEFAULT_TYPES
 - 1,

1401 
öfo
->
©ås
[
NL80211_ATTR_KEY_DEFAULT_TYPES
],

1402 
∆80211_key_deÁu…_pﬁicy
,

1403 
öfo
->
exèck
);

1404 i‡(
îr
)

1405  
îr
;

1407 
k
->
def_uni
 = 
kdt
[
NL80211_KEY_DEFAULT_TYPE_UNICAST
];

1408 
k
->
def_mu…i
 = 
kdt
[
NL80211_KEY_DEFAULT_TYPE_MULTICAST
];

1412 
	}
}

1414 
	$∆80211_∑r£_key
(
gíl_öfo
 *
öfo
, 
key_∑r£
 *
k
)

1416 
îr
;

1418 
	`mem£t
(
k
, 0, (*k));

1419 
k
->
idx
 = -1;

1420 
k
->
ty≥
 = -1;

1422 i‡(
öfo
->
©ås
[
NL80211_ATTR_KEY
])

1423 
îr
 = 
	`∆80211_∑r£_key_√w
(
öfo
, info->
©ås
[
NL80211_ATTR_KEY
], 
k
);

1425 
îr
 = 
	`∆80211_∑r£_key_ﬁd
(
öfo
, 
k
);

1427 i‡(
îr
)

1428  
îr
;

1430 i‡((
k
->
def
 ? 1 : 0Ë+ (k->
defmgmt
 ? 1 : 0) +

1431 (
k
->
defbóc⁄
 ? 1 : 0) > 1) {

1432 
	`GENL_SET_ERR_MSG
(
öfo
,

1434  -
EINVAL
;

1437 i‡(
k
->
defmgmt
 || k->
defbóc⁄
) {

1438 i‡(
k
->
def_uni
 || !k->
def_mu…i
) {

1439 
	`GENL_SET_ERR_MSG
(
öfo
,

1441  -
EINVAL
;

1445 i‡(
k
->
idx
 != -1) {

1446 i‡(
k
->
defmgmt
) {

1447 i‡(
k
->
idx
 < 4 || k->idx > 5) {

1448 
	`GENL_SET_ERR_MSG
(
öfo
,

1450  -
EINVAL
;

1452 } i‡(
k
->
defbóc⁄
) {

1453 i‡(
k
->
idx
 < 6 || k->idx > 7) {

1454 
	`GENL_SET_ERR_MSG
(
öfo
,

1456  -
EINVAL
;

1458 } i‡(
k
->
def
) {

1459 i‡(
k
->
idx
 < 0 || k->idx > 3) {

1460 
	`GENL_SET_ERR_MSG
(
öfo
, "def key idxÇot 0-3");

1461  -
EINVAL
;

1464 i‡(
k
->
idx
 < 0 || k->idx > 7) {

1465 
	`GENL_SET_ERR_MSG
(
öfo
, "key idxÇot 0-7");

1466  -
EINVAL
;

1472 
	}
}

1474 
cfg80211_ˇched_keys
 *

1475 
	$∆80211_∑r£_c⁄nkeys
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1476 
gíl_öfo
 *
öfo
, 
boﬁ
 *
no_ht
)

1478 
∆©å
 *
keys
 = 
öfo
->
©ås
[
NL80211_ATTR_KEYS
];

1479 
key_∑r£
 
∑r£
;

1480 
∆©å
 *
key
;

1481 
cfg80211_ˇched_keys
 *
ªsu…
;

1482 
ªm
, 
îr
, 
def
 = 0;

1483 
boﬁ
 
have_key
 = 
Ál£
;

1485 
	`∆a_f‹_óch_√°ed
(
key
, 
keys
, 
ªm
) {

1486 
have_key
 = 
åue
;

1490 i‡(!
have_key
)

1491  
NULL
;

1493 
ªsu…
 = 
	`kzÆloc
((*ªsu…), 
GFP_KERNEL
);

1494 i‡(!
ªsu…
)

1495  
	`ERR_PTR
(-
ENOMEM
);

1497 
ªsu…
->
def
 = -1;

1499 
	`∆a_f‹_óch_√°ed
(
key
, 
keys
, 
ªm
) {

1500 
	`mem£t
(&
∑r£
, 0, (parse));

1501 
∑r£
.
idx
 = -1;

1503 
îr
 = 
	`∆80211_∑r£_key_√w
(
öfo
, 
key
, &
∑r£
);

1504 i‡(
îr
)

1505 
îr‹
;

1506 
îr
 = -
EINVAL
;

1507 i‡(!
∑r£
.
p
.
key
)

1508 
îr‹
;

1509 i‡(
∑r£
.
idx
 < 0 ||Öarse.idx > 3) {

1510 
	`GENL_SET_ERR_MSG
(
öfo
, "key index out ofÑange [0-3]");

1511 
îr‹
;

1513 i‡(
∑r£
.
def
) {

1514 i‡(
def
) {

1515 
	`GENL_SET_ERR_MSG
(
öfo
,

1517 
îr‹
;

1519 
def
 = 1;

1520 
ªsu…
->
def
 = 
∑r£
.
idx
;

1521 i‡(!
∑r£
.
def_uni
 || !∑r£.
def_mu…i
)

1522 
îr‹
;

1523 } i‡(
∑r£
.
defmgmt
)

1524 
îr‹
;

1525 
îr
 = 
	`cfg80211_vÆid©e_key_£âögs
(
rdev
, &
∑r£
.
p
,

1526 
∑r£
.
idx
, 
Ál£
, 
NULL
);

1527 i‡(
îr
)

1528 
îr‹
;

1529 i‡(
∑r£
.
p
.
cùhî
 !
WLAN_CIPHER_SUITE_WEP40
 &&

1530 
∑r£
.
p
.
cùhî
 !
WLAN_CIPHER_SUITE_WEP104
) {

1531 
	`GENL_SET_ERR_MSG
(
öfo
, "connect key must be WEP");

1532 
îr
 = -
EINVAL
;

1533 
îr‹
;

1535 
ªsu…
->
∑øms
[
∑r£
.
idx
].
cùhî
 =Ö¨£.
p
.cipher;

1536 
ªsu…
->
∑øms
[
∑r£
.
idx
].
key_Àn
 =Ö¨£.
p
.key_len;

1537 
ªsu…
->
∑øms
[
∑r£
.
idx
].
key
 =Ñesu…->
d©a
[parse.idx];

1538 
	`mem˝y
(
ªsu…
->
d©a
[
∑r£
.
idx
],Ö¨£.
p
.
key
,Ö¨£.p.
key_Àn
);

1541 i‡(
no_ht
)

1542 *
no_ht
 = 
åue
;

1545 i‡(
ªsu…
->
def
 < 0) {

1546 
îr
 = -
EINVAL
;

1547 
	`GENL_SET_ERR_MSG
(
öfo
, "needá default/TX key");

1548 
îr‹
;

1551  
ªsu…
;

1552 
îr‹
:

1553 
	`k‰ì
(
ªsu…
);

1554  
	`ERR_PTR
(
îr
);

1555 
	}
}

1557 
	$∆80211_key_Ælowed
(
wúñess_dev
 *
wdev
)

1559 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

1561 
wdev
->
i·y≥
) {

1562 
NL80211_IFTYPE_AP
:

1563 
NL80211_IFTYPE_AP_VLAN
:

1564 
NL80211_IFTYPE_P2P_GO
:

1565 
NL80211_IFTYPE_MESH_POINT
:

1567 
NL80211_IFTYPE_ADHOC
:

1568 i‡(
wdev
->
u
.
ibss
.
cuºít_bss
)

1570  -
ENOLINK
;

1571 
NL80211_IFTYPE_STATION
:

1572 
NL80211_IFTYPE_P2P_CLIENT
:

1573 i‡(
wdev
->
c⁄√˘ed
)

1575  -
ENOLINK
;

1576 
NL80211_IFTYPE_NAN
:

1577 i‡(
	`wùhy_ext_„©uª_is£t
(
wdev
->
wùhy
,

1578 
NL80211_EXT_FEATURE_SECURE_NAN
))

1580  -
EINVAL
;

1581 
NL80211_IFTYPE_UNSPECIFIED
:

1582 
NL80211_IFTYPE_OCB
:

1583 
NL80211_IFTYPE_MONITOR
:

1584 
NL80211_IFTYPE_P2P_DEVICE
:

1585 
NL80211_IFTYPE_WDS
:

1586 
NUM_NL80211_IFTYPES
:

1587  -
EINVAL
;

1591 
	}
}

1593 
õì80211_ch™√l
 *
	$∆80211_gë_vÆid_ch™
(
wùhy
 *wiphy,

1594 
u32
 
‰eq
)

1596 
õì80211_ch™√l
 *
ch™
;

1598 
ch™
 = 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
‰eq
);

1599 i‡(!
ch™
 || ch™->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

1600  
NULL
;

1601  
ch™
;

1602 
	}
}

1604 
	$∆80211_put_i·y≥s
(
sk_buff
 *
msg
, 
u32
 
©å
, 
u16
 
ifmodes
)

1606 
∆©å
 *
∆_modes
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
©å
);

1607 
i
;

1609 i‡(!
∆_modes
)

1610 
∆a_put_Áûuª
;

1612 
i
 = 0;

1613 
ifmodes
) {

1614 i‡((
ifmodes
 & 1Ë&& 
	`∆a_put_Êag
(
msg
, 
i
))

1615 
∆a_put_Áûuª
;

1616 
ifmodes
 >>= 1;

1617 
i
++;

1620 
	`∆a_√°_íd
(
msg
, 
∆_modes
);

1623 
∆a_put_Áûuª
:

1624  -
ENOBUFS
;

1625 
	}
}

1627 
	$∆80211_put_iÁ˚_combö©i⁄s
(
wùhy
 *wiphy,

1628 
sk_buff
 *
msg
,

1629 
boﬁ
 
œrge
)

1631 
∆©å
 *
∆_combis
;

1632 
i
, 
j
;

1634 
∆_combis
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

1635 
NL80211_ATTR_INTERFACE_COMBINATIONS
);

1636 i‡(!
∆_combis
)

1637 
∆a_put_Áûuª
;

1639 
i
 = 0; i < 
wùhy
->
n_iÁ˚_combö©i⁄s
; i++) {

1640 c⁄° 
õì80211_iÁ˚_combö©i⁄
 *
c
;

1641 
∆©å
 *
∆_combi
, *
∆_limôs
;

1643 
c
 = &
wùhy
->
iÁ˚_combö©i⁄s
[
i
];

1645 
∆_combi
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
i
 + 1);

1646 i‡(!
∆_combi
)

1647 
∆a_put_Áûuª
;

1649 
∆_limôs
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

1650 
NL80211_IFACE_COMB_LIMITS
);

1651 i‡(!
∆_limôs
)

1652 
∆a_put_Áûuª
;

1654 
j
 = 0; j < 
c
->
n_limôs
; j++) {

1655 
∆©å
 *
∆_limô
;

1657 
∆_limô
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
j
 + 1);

1658 i‡(!
∆_limô
)

1659 
∆a_put_Áûuª
;

1660 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_IFACE_LIMIT_MAX
,

1661 
c
->
limôs
[
j
].
max
))

1662 
∆a_put_Áûuª
;

1663 i‡(
	`∆80211_put_i·y≥s
(
msg
, 
NL80211_IFACE_LIMIT_TYPES
,

1664 
c
->
limôs
[
j
].
ty≥s
))

1665 
∆a_put_Áûuª
;

1666 
	`∆a_√°_íd
(
msg
, 
∆_limô
);

1669 
	`∆a_√°_íd
(
msg
, 
∆_limôs
);

1671 i‡(
c
->
bóc⁄_öt_ö‰a_m©ch
 &&

1672 
	`∆a_put_Êag
(
msg
, 
NL80211_IFACE_COMB_STA_AP_BI_MATCH
))

1673 
∆a_put_Áûuª
;

1674 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_IFACE_COMB_NUM_CHANNELS
,

1675 
c
->
num_dif„ª¡_ch™√ls
) ||

1676 
	`∆a_put_u32
(
msg
, 
NL80211_IFACE_COMB_MAXNUM
,

1677 
c
->
max_öãrÁ˚s
))

1678 
∆a_put_Áûuª
;

1679 i‡(
œrge
 &&

1680 (
	`∆a_put_u32
(
msg
, 
NL80211_IFACE_COMB_RADAR_DETECT_WIDTHS
,

1681 
c
->
ød¨_dëe˘_widths
) ||

1682 
	`∆a_put_u32
(
msg
, 
NL80211_IFACE_COMB_RADAR_DETECT_REGIONS
,

1683 
c
->
ød¨_dëe˘_ªgi⁄s
)))

1684 
∆a_put_Áûuª
;

1685 i‡(
c
->
bóc⁄_öt_mö_gcd
 &&

1686 
	`∆a_put_u32
(
msg
, 
NL80211_IFACE_COMB_BI_MIN_GCD
,

1687 
c
->
bóc⁄_öt_mö_gcd
))

1688 
∆a_put_Áûuª
;

1690 
	`∆a_√°_íd
(
msg
, 
∆_combi
);

1693 
	`∆a_√°_íd
(
msg
, 
∆_combis
);

1696 
∆a_put_Áûuª
:

1697  -
ENOBUFS
;

1698 
	}
}

1700 #ifde‡
CONFIG_PM


1701 
	$∆80211_£nd_wowœn_t˝_ˇps
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1702 
sk_buff
 *
msg
)

1704 c⁄° 
wùhy_wowœn_t˝_suµ‹t
 *
t˝
 = 
rdev
->
wùhy
.
wowœn
->tcp;

1705 
∆©å
 *
∆_t˝
;

1707 i‡(!
t˝
)

1710 
∆_t˝
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

1711 
NL80211_WOWLAN_TRIG_TCP_CONNECTION
);

1712 i‡(!
∆_t˝
)

1713  -
ENOBUFS
;

1715 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_WOWLAN_TCP_DATA_PAYLOAD
,

1716 
t˝
->
d©a_∑ylﬂd_max
))

1717  -
ENOBUFS
;

1719 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_WOWLAN_TCP_DATA_PAYLOAD
,

1720 
t˝
->
d©a_∑ylﬂd_max
))

1721  -
ENOBUFS
;

1723 i‡(
t˝
->
£q
 && 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TCP_DATA_PAYLOAD_SEQ
))

1724  -
ENOBUFS
;

1726 i‡(
t˝
->
tok
 && 
	`∆a_put
(
msg
, 
NL80211_WOWLAN_TCP_DATA_PAYLOAD_TOKEN
,

1727 (*
t˝
->
tok
),Åcp->tok))

1728  -
ENOBUFS
;

1730 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_WOWLAN_TCP_DATA_INTERVAL
,

1731 
t˝
->
d©a_öãrvÆ_max
))

1732  -
ENOBUFS
;

1734 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_WOWLAN_TCP_WAKE_PAYLOAD
,

1735 
t˝
->
wake_∑ylﬂd_max
))

1736  -
ENOBUFS
;

1738 
	`∆a_√°_íd
(
msg
, 
∆_t˝
);

1740 
	}
}

1742 
	$∆80211_£nd_wowœn
(
sk_buff
 *
msg
,

1743 
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1744 
boﬁ
 
œrge
)

1746 
∆©å
 *
∆_wowœn
;

1748 i‡(!
rdev
->
wùhy
.
wowœn
)

1751 
∆_wowœn
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

1752 
NL80211_ATTR_WOWLAN_TRIGGERS_SUPPORTED
);

1753 i‡(!
∆_wowœn
)

1754  -
ENOBUFS
;

1756 i‡(((
rdev
->
wùhy
.
wowœn
->
Êags
 & 
WIPHY_WOWLAN_ANY
) &&

1757 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_ANY
)) ||

1758 ((
rdev
->
wùhy
.
wowœn
->
Êags
 & 
WIPHY_WOWLAN_DISCONNECT
) &&

1759 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_DISCONNECT
)) ||

1760 ((
rdev
->
wùhy
.
wowœn
->
Êags
 & 
WIPHY_WOWLAN_MAGIC_PKT
) &&

1761 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_MAGIC_PKT
)) ||

1762 ((
rdev
->
wùhy
.
wowœn
->
Êags
 & 
WIPHY_WOWLAN_SUPPORTS_GTK_REKEY
) &&

1763 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_GTK_REKEY_SUPPORTED
)) ||

1764 ((
rdev
->
wùhy
.
wowœn
->
Êags
 & 
WIPHY_WOWLAN_GTK_REKEY_FAILURE
) &&

1765 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_GTK_REKEY_FAILURE
)) ||

1766 ((
rdev
->
wùhy
.
wowœn
->
Êags
 & 
WIPHY_WOWLAN_EAP_IDENTITY_REQ
) &&

1767 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_EAP_IDENT_REQUEST
)) ||

1768 ((
rdev
->
wùhy
.
wowœn
->
Êags
 & 
WIPHY_WOWLAN_4WAY_HANDSHAKE
) &&

1769 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_4WAY_HANDSHAKE
)) ||

1770 ((
rdev
->
wùhy
.
wowœn
->
Êags
 & 
WIPHY_WOWLAN_RFKILL_RELEASE
) &&

1771 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_RFKILL_RELEASE
)))

1772  -
ENOBUFS
;

1774 i‡(
rdev
->
wùhy
.
wowœn
->
n_∑âîns
) {

1775 
∆80211_∑âîn_suµ‹t
 
∑t
 = {

1776 .
max_∑âîns
 = 
rdev
->
wùhy
.
wowœn
->
n_∑âîns
,

1777 .
mö_∑âîn_Àn
 = 
rdev
->
wùhy
.
wowœn
->
∑âîn_mö_Àn
,

1778 .
max_∑âîn_Àn
 = 
rdev
->
wùhy
.
wowœn
->
∑âîn_max_Àn
,

1779 .
max_pkt_off£t
 = 
rdev
->
wùhy
.
wowœn
->max_pkt_offset,

1782 i‡(
	`∆a_put
(
msg
, 
NL80211_WOWLAN_TRIG_PKT_PATTERN
,

1783 (
∑t
), &pat))

1784  -
ENOBUFS
;

1787 i‡((
rdev
->
wùhy
.
wowœn
->
Êags
 & 
WIPHY_WOWLAN_NET_DETECT
) &&

1788 
	`∆a_put_u32
(
msg
, 
NL80211_WOWLAN_TRIG_NET_DETECT
,

1789 
rdev
->
wùhy
.
wowœn
->
max_nd_m©ch_£ts
))

1790  -
ENOBUFS
;

1792 i‡(
œrge
 && 
	`∆80211_£nd_wowœn_t˝_ˇps
(
rdev
, 
msg
))

1793  -
ENOBUFS
;

1795 
	`∆a_√°_íd
(
msg
, 
∆_wowœn
);

1798 
	}
}

1801 
	$∆80211_£nd_cﬂÀs˚
(
sk_buff
 *
msg
,

1802 
cfg80211_ªgi°îed_devi˚
 *
rdev
)

1804 
∆80211_cﬂÀs˚_ruÀ_suµ‹t
 
ruÀ
;

1806 i‡(!
rdev
->
wùhy
.
cﬂÀs˚
)

1809 
ruÀ
.
max_ruÀs
 = 
rdev
->
wùhy
.
cﬂÀs˚
->
n_ruÀs
;

1810 
ruÀ
.
max_dñay
 = 
rdev
->
wùhy
.
cﬂÀs˚
->max_delay;

1811 
ruÀ
.
∑t
.
max_∑âîns
 = 
rdev
->
wùhy
.
cﬂÀs˚
->
n_∑âîns
;

1812 
ruÀ
.
∑t
.
mö_∑âîn_Àn
 = 
rdev
->
wùhy
.
cﬂÀs˚
->
∑âîn_mö_Àn
;

1813 
ruÀ
.
∑t
.
max_∑âîn_Àn
 = 
rdev
->
wùhy
.
cﬂÀs˚
->
∑âîn_max_Àn
;

1814 
ruÀ
.
∑t
.
max_pkt_off£t
 = 
rdev
->
wùhy
.
cﬂÀs˚
->max_pkt_offset;

1816 i‡(
	`∆a_put
(
msg
, 
NL80211_ATTR_COALESCE_RULE
, (
ruÀ
), &rule))

1817  -
ENOBUFS
;

1820 
	}
}

1823 
	$∆80211_£nd_i·y≥_d©a
(
sk_buff
 *
msg
,

1824 c⁄° 
õì80211_suµ‹ãd_b™d
 *
sb™d
,

1825 c⁄° 
õì80211_sb™d_i·y≥_d©a
 *
i·d©a
)

1827 c⁄° 
õì80211_°a_he_ˇp
 *
he_ˇp
 = &
i·d©a
->he_cap;

1828 c⁄° 
õì80211_°a_eht_ˇp
 *
eht_ˇp
 = &
i·d©a
->eht_cap;

1830 i‡(
	`∆80211_put_i·y≥s
(
msg
, 
NL80211_BAND_IFTYPE_ATTR_IFTYPES
,

1831 
i·d©a
->
ty≥s_mask
))

1832  -
ENOBUFS
;

1834 i‡(
he_ˇp
->
has_he
) {

1835 i‡(
	`∆a_put
(
msg
, 
NL80211_BAND_IFTYPE_ATTR_HE_CAP_MAC
,

1836 (
he_ˇp
->
he_ˇp_ñem
.
mac_ˇp_öfo
),

1837 
he_ˇp
->
he_ˇp_ñem
.
mac_ˇp_öfo
) ||

1838 
	`∆a_put
(
msg
, 
NL80211_BAND_IFTYPE_ATTR_HE_CAP_PHY
,

1839 (
he_ˇp
->
he_ˇp_ñem
.
phy_ˇp_öfo
),

1840 
he_ˇp
->
he_ˇp_ñem
.
phy_ˇp_öfo
) ||

1841 
	`∆a_put
(
msg
, 
NL80211_BAND_IFTYPE_ATTR_HE_CAP_MCS_SET
,

1842 (
he_ˇp
->
he_mcs_nss_suµ
),

1843 &
he_ˇp
->
he_mcs_nss_suµ
) ||

1844 
	`∆a_put
(
msg
, 
NL80211_BAND_IFTYPE_ATTR_HE_CAP_PPE
,

1845 (
he_ˇp
->
µe_thªs
), he_cap->ppe_thres))

1846  -
ENOBUFS
;

1849 i‡(
eht_ˇp
->
has_eht
 && 
he_ˇp
->
has_he
) {

1850 
u8
 
mcs_nss_size
, 
µe_thªsh_size
;

1851 
u16
 
µe_thªs_hdr
;

1852 
boﬁ
 
is_≠
;

1854 
is_≠
 = 
i·d©a
->
ty≥s_mask
 & 
	`BIT
(
NL80211_IFTYPE_AP
) ||

1855 
i·d©a
->
ty≥s_mask
 & 
	`BIT
(
NL80211_IFTYPE_P2P_GO
);

1857 
mcs_nss_size
 =

1858 
	`õì80211_eht_mcs_nss_size
(&
he_ˇp
->
he_ˇp_ñem
,

1859 &
eht_ˇp
->
eht_ˇp_ñem
,

1860 
is_≠
);

1862 
µe_thªs_hdr
 = 
	`gë_u«lig√d_À16
(&
eht_ˇp
->
eht_µe_thªs
[0]);

1863 
µe_thªsh_size
 =

1864 
	`õì80211_eht_µe_size
(
µe_thªs_hdr
,

1865 
eht_ˇp
->
eht_ˇp_ñem
.
phy_ˇp_öfo
);

1867 i‡(
	`∆a_put
(
msg
, 
NL80211_BAND_IFTYPE_ATTR_EHT_CAP_MAC
,

1868 (
eht_ˇp
->
eht_ˇp_ñem
.
mac_ˇp_öfo
),

1869 
eht_ˇp
->
eht_ˇp_ñem
.
mac_ˇp_öfo
) ||

1870 
	`∆a_put
(
msg
, 
NL80211_BAND_IFTYPE_ATTR_EHT_CAP_PHY
,

1871 (
eht_ˇp
->
eht_ˇp_ñem
.
phy_ˇp_öfo
),

1872 
eht_ˇp
->
eht_ˇp_ñem
.
phy_ˇp_öfo
) ||

1873 
	`∆a_put
(
msg
, 
NL80211_BAND_IFTYPE_ATTR_EHT_CAP_MCS_SET
,

1874 
mcs_nss_size
, &
eht_ˇp
->
eht_mcs_nss_suµ
) ||

1875 
	`∆a_put
(
msg
, 
NL80211_BAND_IFTYPE_ATTR_EHT_CAP_PPE
,

1876 
µe_thªsh_size
, 
eht_ˇp
->
eht_µe_thªs
))

1877  -
ENOBUFS
;

1880 i‡(
sb™d
->
b™d
 =
NL80211_BAND_6GHZ
 &&

1881 
	`∆a_put
(
msg
, 
NL80211_BAND_IFTYPE_ATTR_HE_6GHZ_CAPA
,

1882 (
i·d©a
->
he_6ghz_ˇ∑
),

1883 &
i·d©a
->
he_6ghz_ˇ∑
))

1884  -
ENOBUFS
;

1886 i‡(
i·d©a
->
víd‹_ñems
.
d©a
 && i·d©a->víd‹_ñems.
Àn
 &&

1887 
	`∆a_put
(
msg
, 
NL80211_BAND_IFTYPE_ATTR_VENDOR_ELEMS
,

1888 
i·d©a
->
víd‹_ñems
.
Àn
, i·d©a->víd‹_ñems.
d©a
))

1889  -
ENOBUFS
;

1892 
	}
}

1894 
	$∆80211_£nd_b™d_øãöfo
(
sk_buff
 *
msg
,

1895 
õì80211_suµ‹ãd_b™d
 *
sb™d
,

1896 
boﬁ
 
œrge
)

1898 
∆©å
 *
∆_øãs
, *
∆_øã
;

1899 
õì80211_øã
 *
øã
;

1900 
i
;

1903 i‡(
sb™d
->
ht_ˇp
.
ht_suµ‹ãd
 &&

1904 (
	`∆a_put
(
msg
, 
NL80211_BAND_ATTR_HT_MCS_SET
,

1905 (
sb™d
->
ht_ˇp
.
mcs
),

1906 &
sb™d
->
ht_ˇp
.
mcs
) ||

1907 
	`∆a_put_u16
(
msg
, 
NL80211_BAND_ATTR_HT_CAPA
,

1908 
sb™d
->
ht_ˇp
.
ˇp
) ||

1909 
	`∆a_put_u8
(
msg
, 
NL80211_BAND_ATTR_HT_AMPDU_FACTOR
,

1910 
sb™d
->
ht_ˇp
.
ampdu_Á˘‹
) ||

1911 
	`∆a_put_u8
(
msg
, 
NL80211_BAND_ATTR_HT_AMPDU_DENSITY
,

1912 
sb™d
->
ht_ˇp
.
ampdu_dísôy
)))

1913  -
ENOBUFS
;

1916 i‡(
sb™d
->
vht_ˇp
.
vht_suµ‹ãd
 &&

1917 (
	`∆a_put
(
msg
, 
NL80211_BAND_ATTR_VHT_MCS_SET
,

1918 (
sb™d
->
vht_ˇp
.
vht_mcs
),

1919 &
sb™d
->
vht_ˇp
.
vht_mcs
) ||

1920 
	`∆a_put_u32
(
msg
, 
NL80211_BAND_ATTR_VHT_CAPA
,

1921 
sb™d
->
vht_ˇp
.
ˇp
)))

1922  -
ENOBUFS
;

1924 i‡(
œrge
 && 
sb™d
->
n_i·y≥_d©a
) {

1925 
∆©å
 *
∆_i·y≥_d©a
 =

1926 
	`∆a_√°_°¨t_noÊag
(
msg
,

1927 
NL80211_BAND_ATTR_IFTYPE_DATA
);

1928 c⁄° 
õì80211_sb™d_i·y≥_d©a
 *
i·d
;

1929 
îr
;

1931 i‡(!
∆_i·y≥_d©a
)

1932  -
ENOBUFS
;

1934 
	`f‹_óch_sb™d_i·y≥_d©a
(
sb™d
, 
i
, 
i·d
) {

1935 
∆©å
 *
i·d©a
;

1937 
i·d©a
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
i
 + 1);

1938 i‡(!
i·d©a
)

1939  -
ENOBUFS
;

1941 
îr
 = 
	`∆80211_£nd_i·y≥_d©a
(
msg
, 
sb™d
, 
i·d
);

1942 i‡(
îr
)

1943  
îr
;

1945 
	`∆a_√°_íd
(
msg
, 
i·d©a
);

1948 
	`∆a_√°_íd
(
msg
, 
∆_i·y≥_d©a
);

1952 i‡(
œrge
 && 
sb™d
->
edmg_ˇp
.
ch™√ls
 &&

1953 (
	`∆a_put_u8
(
msg
, 
NL80211_BAND_ATTR_EDMG_CHANNELS
,

1954 
sb™d
->
edmg_ˇp
.
ch™√ls
) ||

1955 
	`∆a_put_u8
(
msg
, 
NL80211_BAND_ATTR_EDMG_BW_CONFIG
,

1956 
sb™d
->
edmg_ˇp
.
bw_c⁄fig
)))

1958  -
ENOBUFS
;

1961 
∆_øãs
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_BAND_ATTR_RATES
);

1962 i‡(!
∆_øãs
)

1963  -
ENOBUFS
;

1965 
i
 = 0; i < 
sb™d
->
n_bôøãs
; i++) {

1966 
∆_øã
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
i
);

1967 i‡(!
∆_øã
)

1968  -
ENOBUFS
;

1970 
øã
 = &
sb™d
->
bôøãs
[
i
];

1971 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_BITRATE_ATTR_RATE
,

1972 
øã
->
bôøã
))

1973  -
ENOBUFS
;

1974 i‡((
øã
->
Êags
 & 
IEEE80211_RATE_SHORT_PREAMBLE
) &&

1975 
	`∆a_put_Êag
(
msg
,

1976 
NL80211_BITRATE_ATTR_2GHZ_SHORTPREAMBLE
))

1977  -
ENOBUFS
;

1979 
	`∆a_√°_íd
(
msg
, 
∆_øã
);

1982 
	`∆a_√°_íd
(
msg
, 
∆_øãs
);

1985 i‡(
sb™d
->
b™d
 =
NL80211_BAND_S1GHZ
 && sb™d->
s1g_ˇp
.
s1g
 &&

1986 (
	`∆a_put
(
msg
, 
NL80211_BAND_ATTR_S1G_CAPA
,

1987 (
sb™d
->
s1g_ˇp
.
ˇp
),

1988 
sb™d
->
s1g_ˇp
.
ˇp
) ||

1989 
	`∆a_put
(
msg
, 
NL80211_BAND_ATTR_S1G_MCS_NSS_SET
,

1990 (
sb™d
->
s1g_ˇp
.
nss_mcs
),

1991 
sb™d
->
s1g_ˇp
.
nss_mcs
)))

1992  -
ENOBUFS
;

1995 
	}
}

1998 
	$∆80211_£nd_mgmt_°y≥s
(
sk_buff
 *
msg
,

1999 c⁄° 
õì80211_txrx_°y≥s
 *
mgmt_°y≥s
)

2001 
u16
 
°y≥s
;

2002 
∆©å
 *
∆_·y≥s
, *
∆_ifs
;

2003 
∆80211_i·y≥
 
i·
;

2004 
i
;

2006 i‡(!
mgmt_°y≥s
)

2009 
∆_ifs
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_TX_FRAME_TYPES
);

2010 i‡(!
∆_ifs
)

2011  -
ENOBUFS
;

2013 
i·
 = 0; i· < 
NUM_NL80211_IFTYPES
; ift++) {

2014 
∆_·y≥s
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
i·
);

2015 i‡(!
∆_·y≥s
)

2016  -
ENOBUFS
;

2017 
i
 = 0;

2018 
°y≥s
 = 
mgmt_°y≥s
[
i·
].
tx
;

2019 
°y≥s
) {

2020 i‡((
°y≥s
 & 1) &&

2021 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_FRAME_TYPE
,

2022 (
i
 << 4Ë| 
IEEE80211_FTYPE_MGMT
))

2023  -
ENOBUFS
;

2024 
°y≥s
 >>= 1;

2025 
i
++;

2027 
	`∆a_√°_íd
(
msg
, 
∆_·y≥s
);

2030 
	`∆a_√°_íd
(
msg
, 
∆_ifs
);

2032 
∆_ifs
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_RX_FRAME_TYPES
);

2033 i‡(!
∆_ifs
)

2034  -
ENOBUFS
;

2036 
i·
 = 0; i· < 
NUM_NL80211_IFTYPES
; ift++) {

2037 
∆_·y≥s
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
i·
);

2038 i‡(!
∆_·y≥s
)

2039  -
ENOBUFS
;

2040 
i
 = 0;

2041 
°y≥s
 = 
mgmt_°y≥s
[
i·
].
rx
;

2042 
°y≥s
) {

2043 i‡((
°y≥s
 & 1) &&

2044 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_FRAME_TYPE
,

2045 (
i
 << 4Ë| 
IEEE80211_FTYPE_MGMT
))

2046  -
ENOBUFS
;

2047 
°y≥s
 >>= 1;

2048 
i
++;

2050 
	`∆a_√°_íd
(
msg
, 
∆_·y≥s
);

2052 
	`∆a_√°_íd
(
msg
, 
∆_ifs
);

2055 
	}
}

2057 
	#CMD
(
›
, 
n
) \

2059 i‡(
rdev
->
›s
->
›
) { \

2060 
i
++; \

2061 i‡(
	`∆a_put_u32
(
msg
, 
i
, 
NL80211_CMD_
 ## 
n
)) \

2062 
∆a_put_Áûuª
; \

2064 } 0)

	)

2066 
	$∆80211_add_comm™ds_un•lô
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

2067 
sk_buff
 *
msg
)

2069 
i
 = 0;

2076 
	`CMD
(
add_vútuÆ_ötf
, 
NEW_INTERFACE
);

2077 
	`CMD
(
ch™ge_vútuÆ_ötf
, 
SET_INTERFACE
);

2078 
	`CMD
(
add_key
, 
NEW_KEY
);

2079 
	`CMD
(
°¨t_≠
, 
START_AP
);

2080 
	`CMD
(
add_°©i⁄
, 
NEW_STATION
);

2081 
	`CMD
(
add_m∑th
, 
NEW_MPATH
);

2082 
	`CMD
(
upd©e_mesh_c⁄fig
, 
SET_MESH_CONFIG
);

2083 
	`CMD
(
ch™ge_bss
, 
SET_BSS
);

2084 
	`CMD
(
auth
, 
AUTHENTICATE
);

2085 
	`CMD
(
assoc
, 
ASSOCIATE
);

2086 
	`CMD
(
dóuth
, 
DEAUTHENTICATE
);

2087 
	`CMD
(
dißssoc
, 
DISASSOCIATE
);

2088 
	`CMD
(
joö_ibss
, 
JOIN_IBSS
);

2089 
	`CMD
(
joö_mesh
, 
JOIN_MESH
);

2090 
	`CMD
(
£t_pmkß
, 
SET_PMKSA
);

2091 
	`CMD
(
dñ_pmkß
, 
DEL_PMKSA
);

2092 
	`CMD
(
Êush_pmkß
, 
FLUSH_PMKSA
);

2093 i‡(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_HAS_REMAIN_ON_CHANNEL
)

2094 
	`CMD
(
ªmaö_⁄_ch™√l
, 
REMAIN_ON_CHANNEL
);

2095 
	`CMD
(
£t_bôøã_mask
, 
SET_TX_BITRATE_MASK
);

2096 
	`CMD
(
mgmt_tx
, 
FRAME
);

2097 
	`CMD
(
mgmt_tx_ˇn˚l_waô
, 
FRAME_WAIT_CANCEL
);

2098 i‡(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_NETNS_OK
) {

2099 
i
++;

2100 i‡(
	`∆a_put_u32
(
msg
, 
i
, 
NL80211_CMD_SET_WIPHY_NETNS
))

2101 
∆a_put_Áûuª
;

2103 i‡(
rdev
->
›s
->
£t_m⁄ô‹_ch™√l
 ||Ñdev->›s->
°¨t_≠
 ||

2104 
rdev
->
›s
->
joö_mesh
) {

2105 
i
++;

2106 i‡(
	`∆a_put_u32
(
msg
, 
i
, 
NL80211_CMD_SET_CHANNEL
))

2107 
∆a_put_Áûuª
;

2109 i‡(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_TDLS
) {

2110 
	`CMD
(
tdls_mgmt
, 
TDLS_MGMT
);

2111 
	`CMD
(
tdls_›î
, 
TDLS_OPER
);

2113 i‡(
rdev
->
wùhy
.
max_sched_sˇn_ªqs
)

2114 
	`CMD
(
sched_sˇn_°¨t
, 
START_SCHED_SCAN
);

2115 
	`CMD
(
¥obe_˛õ¡
, 
PROBE_CLIENT
);

2116 
	`CMD
(
£t_nﬂck_m≠
, 
SET_NOACK_MAP
);

2117 i‡(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_REPORTS_OBSS
) {

2118 
i
++;

2119 i‡(
	`∆a_put_u32
(
msg
, 
i
, 
NL80211_CMD_REGISTER_BEACONS
))

2120 
∆a_put_Áûuª
;

2122 
	`CMD
(
°¨t_p2p_devi˚
, 
START_P2P_DEVICE
);

2123 
	`CMD
(
£t_mˇ°_øã
, 
SET_MCAST_RATE
);

2124 #ifde‡
CONFIG_NL80211_TESTMODE


2125 
	`CMD
(
ã°mode_cmd
, 
TESTMODE
);

2128 i‡(
rdev
->
›s
->
c⁄√˘
 ||Ñdev->›s->
auth
) {

2129 
i
++;

2130 i‡(
	`∆a_put_u32
(
msg
, 
i
, 
NL80211_CMD_CONNECT
))

2131 
∆a_put_Áûuª
;

2134 i‡(
rdev
->
›s
->
disc⁄√˘
 ||Ñdev->›s->
dóuth
) {

2135 
i
++;

2136 i‡(
	`∆a_put_u32
(
msg
, 
i
, 
NL80211_CMD_DISCONNECT
))

2137 
∆a_put_Áûuª
;

2140  
i
;

2141 
∆a_put_Áûuª
:

2142  -
ENOBUFS
;

2143 
	}
}

2146 
	$∆80211_£nd_pm§_·m_ˇ∑
(c⁄° 
cfg80211_pm§_ˇ∑bûôõs
 *
ˇp
,

2147 
sk_buff
 *
msg
)

2149 
∆©å
 *
·m
;

2151 i‡(!
ˇp
->
·m
.
suµ‹ãd
)

2154 
·m
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_PMSR_TYPE_FTM
);

2155 i‡(!
·m
)

2156  -
ENOBUFS
;

2158 i‡(
ˇp
->
·m
.
aßp
 && 
	`∆a_put_Êag
(
msg
, 
NL80211_PMSR_FTM_CAPA_ATTR_ASAP
))

2159  -
ENOBUFS
;

2160 i‡(
ˇp
->
·m
.
n⁄_aßp
 &&

2161 
	`∆a_put_Êag
(
msg
, 
NL80211_PMSR_FTM_CAPA_ATTR_NON_ASAP
))

2162  -
ENOBUFS
;

2163 i‡(
ˇp
->
·m
.
ªque°_lci
 &&

2164 
	`∆a_put_Êag
(
msg
, 
NL80211_PMSR_FTM_CAPA_ATTR_REQ_LCI
))

2165  -
ENOBUFS
;

2166 i‡(
ˇp
->
·m
.
ªque°_civi˛oc
 &&

2167 
	`∆a_put_Êag
(
msg
, 
NL80211_PMSR_FTM_CAPA_ATTR_REQ_CIVICLOC
))

2168  -
ENOBUFS
;

2169 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_PMSR_FTM_CAPA_ATTR_PREAMBLES
,

2170 
ˇp
->
·m
.
¥ómbÀs
))

2171  -
ENOBUFS
;

2172 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_PMSR_FTM_CAPA_ATTR_BANDWIDTHS
,

2173 
ˇp
->
·m
.
b™dwidths
))

2174  -
ENOBUFS
;

2175 i‡(
ˇp
->
·m
.
max_bur°s_exp⁄ít
 >= 0 &&

2176 
	`∆a_put_u32
(
msg
, 
NL80211_PMSR_FTM_CAPA_ATTR_MAX_BURSTS_EXPONENT
,

2177 
ˇp
->
·m
.
max_bur°s_exp⁄ít
))

2178  -
ENOBUFS
;

2179 i‡(
ˇp
->
·m
.
max_·ms_≥r_bur°
 &&

2180 
	`∆a_put_u32
(
msg
, 
NL80211_PMSR_FTM_CAPA_ATTR_MAX_FTMS_PER_BURST
,

2181 
ˇp
->
·m
.
max_·ms_≥r_bur°
))

2182  -
ENOBUFS
;

2183 i‡(
ˇp
->
·m
.
åiggî_ba£d
 &&

2184 
	`∆a_put_Êag
(
msg
, 
NL80211_PMSR_FTM_CAPA_ATTR_TRIGGER_BASED
))

2185  -
ENOBUFS
;

2186 i‡(
ˇp
->
·m
.
n⁄_åiggî_ba£d
 &&

2187 
	`∆a_put_Êag
(
msg
, 
NL80211_PMSR_FTM_CAPA_ATTR_NON_TRIGGER_BASED
))

2188  -
ENOBUFS
;

2190 
	`∆a_√°_íd
(
msg
, 
·m
);

2192 
	}
}

2194 
	$∆80211_£nd_pm§_ˇ∑
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

2195 
sk_buff
 *
msg
)

2197 c⁄° 
cfg80211_pm§_ˇ∑bûôõs
 *
ˇp
 = 
rdev
->
wùhy
.
pm§_ˇ∑
;

2198 
∆©å
 *
pm§
, *
ˇps
;

2200 i‡(!
ˇp
)

2208 
pm§
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_PEER_MEASUREMENTS
);

2209 i‡(!
pm§
)

2210  -
ENOBUFS
;

2212 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_PMSR_ATTR_MAX_PEERS
, 
ˇp
->
max_≥îs
))

2213  -
ENOBUFS
;

2215 i‡(
ˇp
->
ªp‹t_≠_tsf
 &&

2216 
	`∆a_put_Êag
(
msg
, 
NL80211_PMSR_ATTR_REPORT_AP_TSF
))

2217  -
ENOBUFS
;

2219 i‡(
ˇp
->
øndomize_mac_addr
 &&

2220 
	`∆a_put_Êag
(
msg
, 
NL80211_PMSR_ATTR_RANDOMIZE_MAC_ADDR
))

2221  -
ENOBUFS
;

2223 
ˇps
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_PMSR_ATTR_TYPE_CAPA
);

2224 i‡(!
ˇps
)

2225  -
ENOBUFS
;

2227 i‡(
	`∆80211_£nd_pm§_·m_ˇ∑
(
ˇp
, 
msg
))

2228  -
ENOBUFS
;

2230 
	`∆a_√°_íd
(
msg
, 
ˇps
);

2231 
	`∆a_√°_íd
(
msg
, 
pm§
);

2234 
	}
}

2237 
	$∆80211_put_i·y≥_akm_suôes
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

2238 
sk_buff
 *
msg
)

2240 
i
;

2241 
∆©å
 *
√°ed
, *
√°ed_akms
;

2242 c⁄° 
wùhy_i·y≥_akm_suôes
 *
i·y≥_akms
;

2244 i‡(!
rdev
->
wùhy
.
num_i·y≥_akm_suôes
 ||

2245 !
rdev
->
wùhy
.
i·y≥_akm_suôes
)

2248 
√°ed
 = 
	`∆a_√°_°¨t
(
msg
, 
NL80211_ATTR_IFTYPE_AKM_SUITES
);

2249 i‡(!
√°ed
)

2250  -
ENOBUFS
;

2252 
i
 = 0; i < 
rdev
->
wùhy
.
num_i·y≥_akm_suôes
; i++) {

2253 
√°ed_akms
 = 
	`∆a_√°_°¨t
(
msg
, 
i
 + 1);

2254 i‡(!
√°ed_akms
)

2255  -
ENOBUFS
;

2257 
i·y≥_akms
 = &
rdev
->
wùhy
.
i·y≥_akm_suôes
[
i
];

2259 i‡(
	`∆80211_put_i·y≥s
(
msg
, 
NL80211_IFTYPE_AKM_ATTR_IFTYPES
,

2260 
i·y≥_akms
->
i·y≥s_mask
))

2261  -
ENOBUFS
;

2263 i‡(
	`∆a_put
(
msg
, 
NL80211_IFTYPE_AKM_ATTR_SUITES
,

2264 (
u32
Ë* 
i·y≥_akms
->
n_akm_suôes
,

2265 
i·y≥_akms
->
akm_suôes
)) {

2266  -
ENOBUFS
;

2268 
	`∆a_√°_íd
(
msg
, 
√°ed_akms
);

2271 
	`∆a_√°_íd
(
msg
, 
√°ed
);

2274 
	}
}

2277 
	$∆80211_put_tid_c⁄fig_suµ‹t
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

2278 
sk_buff
 *
msg
)

2280 
∆©å
 *
suµ
;

2282 i‡(!
rdev
->
wùhy
.
tid_c⁄fig_suµ‹t
.
vif
 &&

2283 !
rdev
->
wùhy
.
tid_c⁄fig_suµ‹t
.
≥î
)

2286 
suµ
 = 
	`∆a_√°_°¨t
(
msg
, 
NL80211_ATTR_TID_CONFIG
);

2287 i‡(!
suµ
)

2288  -
ENOSPC
;

2290 i‡(
rdev
->
wùhy
.
tid_c⁄fig_suµ‹t
.
vif
 &&

2291 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_TID_CONFIG_ATTR_VIF_SUPP
,

2292 
rdev
->
wùhy
.
tid_c⁄fig_suµ‹t
.
vif
,

2293 
NL80211_TID_CONFIG_ATTR_PAD
))

2294 
Áû
;

2296 i‡(
rdev
->
wùhy
.
tid_c⁄fig_suµ‹t
.
≥î
 &&

2297 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_TID_CONFIG_ATTR_PEER_SUPP
,

2298 
rdev
->
wùhy
.
tid_c⁄fig_suµ‹t
.
≥î
,

2299 
NL80211_TID_CONFIG_ATTR_PAD
))

2300 
Áû
;

2303 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_TID_CONFIG_ATTR_RETRY_SHORT
,

2304 
rdev
->
wùhy
.
tid_c⁄fig_suµ‹t
.
max_ªåy
))

2305 
Áû
;

2306 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_TID_CONFIG_ATTR_RETRY_LONG
,

2307 
rdev
->
wùhy
.
tid_c⁄fig_suµ‹t
.
max_ªåy
))

2308 
Áû
;

2310 
	`∆a_√°_íd
(
msg
, 
suµ
);

2313 
Áû
:

2314 
	`∆a_√°_ˇn˚l
(
msg
, 
suµ
);

2315  -
ENOBUFS
;

2316 
	}
}

2319 
	$∆80211_put_ßr_•ecs
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

2320 
sk_buff
 *
msg
)

2322 
∆©å
 *
ßr_ˇ∑
, *
•ecs
, *
sub_‰eq_ønge
;

2323 
u8
 
num_‰eq_ønges
;

2324 
i
;

2326 i‡(!
rdev
->
wùhy
.
ßr_ˇ∑
)

2329 
num_‰eq_ønges
 = 
rdev
->
wùhy
.
ßr_ˇ∑
->num_freq_ranges;

2331 
ßr_ˇ∑
 = 
	`∆a_√°_°¨t
(
msg
, 
NL80211_ATTR_SAR_SPEC
);

2332 i‡(!
ßr_ˇ∑
)

2333  -
ENOSPC
;

2335 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_SAR_ATTR_TYPE
, 
rdev
->
wùhy
.
ßr_ˇ∑
->
ty≥
))

2336 
Áû
;

2338 
•ecs
 = 
	`∆a_√°_°¨t
(
msg
, 
NL80211_SAR_ATTR_SPECS
);

2339 i‡(!
•ecs
)

2340 
Áû
;

2343 
i
 = 0; i < 
num_‰eq_ønges
; i++) {

2344 
sub_‰eq_ønge
 = 
	`∆a_√°_°¨t
(
msg
, 
i
 + 1);

2345 i‡(!
sub_‰eq_ønge
)

2346 
Áû
;

2348 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_SAR_ATTR_SPECS_START_FREQ
,

2349 
rdev
->
wùhy
.
ßr_ˇ∑
->
‰eq_ønges
[
i
].
°¨t_‰eq
))

2350 
Áû
;

2352 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_SAR_ATTR_SPECS_END_FREQ
,

2353 
rdev
->
wùhy
.
ßr_ˇ∑
->
‰eq_ønges
[
i
].
íd_‰eq
))

2354 
Áû
;

2356 
	`∆a_√°_íd
(
msg
, 
sub_‰eq_ønge
);

2359 
	`∆a_√°_íd
(
msg
, 
•ecs
);

2360 
	`∆a_√°_íd
(
msg
, 
ßr_ˇ∑
);

2363 
Áû
:

2364 
	`∆a_√°_ˇn˚l
(
msg
, 
ßr_ˇ∑
);

2365  -
ENOBUFS
;

2366 
	}
}

2368 
	$∆80211_put_mbssid_suµ‹t
(
wùhy
 *wùhy, 
sk_buff
 *
msg
)

2370 
∆©å
 *
c⁄fig
;

2372 i‡(!
wùhy
->
mbssid_max_öãrÁ˚s
)

2375 
c⁄fig
 = 
	`∆a_√°_°¨t
(
msg
, 
NL80211_ATTR_MBSSID_CONFIG
);

2376 i‡(!
c⁄fig
)

2377  -
ENOBUFS
;

2379 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_MBSSID_CONFIG_ATTR_MAX_INTERFACES
,

2380 
wùhy
->
mbssid_max_öãrÁ˚s
))

2381 
Áû
;

2383 i‡(
wùhy
->
ema_max_¥ofûe_≥riodicôy
 &&

2384 
	`∆a_put_u8
(
msg
,

2385 
NL80211_MBSSID_CONFIG_ATTR_MAX_EMA_PROFILE_PERIODICITY
,

2386 
wùhy
->
ema_max_¥ofûe_≥riodicôy
))

2387 
Áû
;

2389 
	`∆a_√°_íd
(
msg
, 
c⁄fig
);

2392 
Áû
:

2393 
	`∆a_√°_ˇn˚l
(
msg
, 
c⁄fig
);

2394  -
ENOBUFS
;

2395 
	}
}

2397 
	s∆80211_dump_wùhy_°©e
 {

2398 
s64
 
	mfûãr_wùhy
;

2399 
	m°¨t
;

2400 
	m•lô_°¨t
, 
	mb™d_°¨t
, 
	mch™_°¨t
, 
	mˇ∑_°¨t
;

2401 
boﬁ
 
	m•lô
;

2404 
	$∆80211_£nd_wùhy
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

2405 
∆80211_comm™ds
 
cmd
,

2406 
sk_buff
 *
msg
, 
u32
 
p‹tid
, u32 
£q
,

2407 
Êags
, 
∆80211_dump_wùhy_°©e
 *
°©e
)

2409 *
hdr
;

2410 
∆©å
 *
∆_b™ds
, *
∆_b™d
;

2411 
∆©å
 *
∆_‰eqs
, *
∆_‰eq
;

2412 
∆©å
 *
∆_cmds
;

2413 
∆80211_b™d
 
b™d
;

2414 
õì80211_ch™√l
 *
ch™
;

2415 
i
;

2416 c⁄° 
õì80211_txrx_°y≥s
 *
mgmt_°y≥s
 =

2417 
rdev
->
wùhy
.
mgmt_°y≥s
;

2418 
u32
 
„©uªs
;

2420 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
p‹tid
, 
£q
, 
Êags
, 
cmd
);

2421 i‡(!
hdr
)

2422  -
ENOBUFS
;

2424 i‡(
	`WARN_ON
(!
°©e
))

2425  -
EINVAL
;

2427 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

2428 
	`∆a_put_°rög
(
msg
, 
NL80211_ATTR_WIPHY_NAME
,

2429 
	`wùhy_«me
(&
rdev
->
wùhy
)) ||

2430 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_GENERATION
,

2431 
cfg80211_rdev_li°_gíî©i⁄
))

2432 
∆a_put_Áûuª
;

2434 i‡(
cmd
 !
NL80211_CMD_NEW_WIPHY
)

2435 
föish
;

2437 
°©e
->
•lô_°¨t
) {

2439 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_WIPHY_RETRY_SHORT
,

2440 
rdev
->
wùhy
.
ªåy_sh‹t
) ||

2441 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_WIPHY_RETRY_LONG
,

2442 
rdev
->
wùhy
.
ªåy_l⁄g
) ||

2443 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_FRAG_THRESHOLD
,

2444 
rdev
->
wùhy
.
‰ag_thªshﬁd
) ||

2445 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_RTS_THRESHOLD
,

2446 
rdev
->
wùhy
.
πs_thªshﬁd
) ||

2447 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_WIPHY_COVERAGE_CLASS
,

2448 
rdev
->
wùhy
.
covîage_˛ass
) ||

2449 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MAX_NUM_SCAN_SSIDS
,

2450 
rdev
->
wùhy
.
max_sˇn_ssids
) ||

2451 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MAX_NUM_SCHED_SCAN_SSIDS
,

2452 
rdev
->
wùhy
.
max_sched_sˇn_ssids
) ||

2453 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_MAX_SCAN_IE_LEN
,

2454 
rdev
->
wùhy
.
max_sˇn_õ_Àn
) ||

2455 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_MAX_SCHED_SCAN_IE_LEN
,

2456 
rdev
->
wùhy
.
max_sched_sˇn_õ_Àn
) ||

2457 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MAX_MATCH_SETS
,

2458 
rdev
->
wùhy
.
max_m©ch_£ts
))

2459 
∆a_put_Áûuª
;

2461 i‡((
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_IBSS_RSN
) &&

2462 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_SUPPORT_IBSS_RSN
))

2463 
∆a_put_Áûuª
;

2464 i‡((
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_MESH_AUTH
) &&

2465 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_SUPPORT_MESH_AUTH
))

2466 
∆a_put_Áûuª
;

2467 i‡((
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_AP_UAPSD
) &&

2468 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_SUPPORT_AP_UAPSD
))

2469 
∆a_put_Áûuª
;

2470 i‡((
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_FW_ROAM
) &&

2471 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_ROAM_SUPPORT
))

2472 
∆a_put_Áûuª
;

2473 i‡((
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_TDLS
) &&

2474 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_TDLS_SUPPORT
))

2475 
∆a_put_Áûuª
;

2476 i‡((
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_TDLS_EXTERNAL_SETUP
) &&

2477 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_TDLS_EXTERNAL_SETUP
))

2478 
∆a_put_Áûuª
;

2479 
°©e
->
•lô_°¨t
++;

2480 i‡(
°©e
->
•lô
)

2482 
ÁŒthrough
;

2484 i‡(
	`∆a_put
(
msg
, 
NL80211_ATTR_CIPHER_SUITES
,

2485 (
u32
Ë* 
rdev
->
wùhy
.
n_cùhî_suôes
,

2486 
rdev
->
wùhy
.
cùhî_suôes
))

2487 
∆a_put_Áûuª
;

2489 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MAX_NUM_PMKIDS
,

2490 
rdev
->
wùhy
.
max_num_pmkids
))

2491 
∆a_put_Áûuª
;

2493 i‡((
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_CONTROL_PORT_PROTOCOL
) &&

2494 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_CONTROL_PORT_ETHERTYPE
))

2495 
∆a_put_Áûuª
;

2497 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_ANTENNA_AVAIL_TX
,

2498 
rdev
->
wùhy
.
avaûabÀ_™ã¬as_tx
) ||

2499 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_ANTENNA_AVAIL_RX
,

2500 
rdev
->
wùhy
.
avaûabÀ_™ã¬as_rx
))

2501 
∆a_put_Áûuª
;

2503 i‡((
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_AP_PROBE_RESP_OFFLOAD
) &&

2504 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_PROBE_RESP_OFFLOAD
,

2505 
rdev
->
wùhy
.
¥obe_ª•_ofÊﬂd
))

2506 
∆a_put_Áûuª
;

2508 i‡((
rdev
->
wùhy
.
avaûabÀ_™ã¬as_tx
 ||

2509 
rdev
->
wùhy
.
avaûabÀ_™ã¬as_rx
) &&

2510 
rdev
->
›s
->
gë_™ã¬a
) {

2511 
u32
 
tx_™t
 = 0, 
rx_™t
 = 0;

2512 
ªs
;

2514 
ªs
 = 
	`rdev_gë_™ã¬a
(
rdev
, &
tx_™t
, &
rx_™t
);

2515 i‡(!
ªs
) {

2516 i‡(
	`∆a_put_u32
(
msg
,

2517 
NL80211_ATTR_WIPHY_ANTENNA_TX
,

2518 
tx_™t
) ||

2519 
	`∆a_put_u32
(
msg
,

2520 
NL80211_ATTR_WIPHY_ANTENNA_RX
,

2521 
rx_™t
))

2522 
∆a_put_Áûuª
;

2526 
°©e
->
•lô_°¨t
++;

2527 i‡(
°©e
->
•lô
)

2529 
ÁŒthrough
;

2531 i‡(
	`∆80211_put_i·y≥s
(
msg
, 
NL80211_ATTR_SUPPORTED_IFTYPES
,

2532 
rdev
->
wùhy
.
öãrÁ˚_modes
))

2533 
∆a_put_Áûuª
;

2534 
°©e
->
•lô_°¨t
++;

2535 i‡(
°©e
->
•lô
)

2537 
ÁŒthrough
;

2539 
∆_b™ds
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

2540 
NL80211_ATTR_WIPHY_BANDS
);

2541 i‡(!
∆_b™ds
)

2542 
∆a_put_Áûuª
;

2544 
b™d
 = 
°©e
->
b™d_°¨t
;

2545 
b™d
 < (
°©e
->
•lô
 ?

2546 
NUM_NL80211_BANDS
 :

2547 
NL80211_BAND_60GHZ
 + 1);

2548 
b™d
++) {

2549 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

2552 i‡(
b™d
 > 
NL80211_BAND_5GHZ
 && !
°©e
->
•lô
)

2555 
sb™d
 = 
rdev
->
wùhy
.
b™ds
[
b™d
];

2557 i‡(!
sb™d
)

2560 
∆_b™d
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
b™d
);

2561 i‡(!
∆_b™d
)

2562 
∆a_put_Áûuª
;

2564 
°©e
->
ch™_°¨t
) {

2566 i‡(
	`∆80211_£nd_b™d_øãöfo
(
msg
, 
sb™d
,

2567 
°©e
->
•lô
))

2568 
∆a_put_Áûuª
;

2569 
°©e
->
ch™_°¨t
++;

2570 i‡(
°©e
->
•lô
)

2572 
ÁŒthrough
;

2575 
∆_‰eqs
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

2576 
NL80211_BAND_ATTR_FREQS
);

2577 i‡(!
∆_‰eqs
)

2578 
∆a_put_Áûuª
;

2580 
i
 = 
°©e
->
ch™_°¨t
 - 1;

2581 
i
 < 
sb™d
->
n_ch™√ls
;

2582 
i
++) {

2583 
∆_‰eq
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

2584 
i
);

2585 i‡(!
∆_‰eq
)

2586 
∆a_put_Áûuª
;

2588 
ch™
 = &
sb™d
->
ch™√ls
[
i
];

2590 i‡(
	`∆80211_msg_put_ch™√l
(

2591 
msg
, &
rdev
->
wùhy
, 
ch™
,

2592 
°©e
->
•lô
))

2593 
∆a_put_Áûuª
;

2595 
	`∆a_√°_íd
(
msg
, 
∆_‰eq
);

2596 i‡(
°©e
->
•lô
)

2599 i‡(
i
 < 
sb™d
->
n_ch™√ls
)

2600 
°©e
->
ch™_°¨t
 = 
i
 + 2;

2602 
°©e
->
ch™_°¨t
 = 0;

2603 
	`∆a_√°_íd
(
msg
, 
∆_‰eqs
);

2606 
	`∆a_√°_íd
(
msg
, 
∆_b™d
);

2608 i‡(
°©e
->
•lô
) {

2610 i‡(
°©e
->
ch™_°¨t
)

2611 
b™d
--;

2615 
	`∆a_√°_íd
(
msg
, 
∆_b™ds
);

2617 i‡(
b™d
 < 
NUM_NL80211_BANDS
)

2618 
°©e
->
b™d_°¨t
 = 
b™d
 + 1;

2620 
°©e
->
b™d_°¨t
 = 0;

2623 i‡(
°©e
->
b™d_°¨t
 =0 && sèã->
ch™_°¨t
 == 0)

2624 
°©e
->
•lô_°¨t
++;

2625 i‡(
°©e
->
•lô
)

2627 
ÁŒthrough
;

2629 
∆_cmds
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

2630 
NL80211_ATTR_SUPPORTED_COMMANDS
);

2631 i‡(!
∆_cmds
)

2632 
∆a_put_Áûuª
;

2634 
i
 = 
	`∆80211_add_comm™ds_un•lô
(
rdev
, 
msg
);

2635 i‡(
i
 < 0)

2636 
∆a_put_Áûuª
;

2637 i‡(
°©e
->
•lô
) {

2638 
	`CMD
(
¸ô_¥Ÿo_°¨t
, 
CRIT_PROTOCOL_START
);

2639 
	`CMD
(
¸ô_¥Ÿo_°›
, 
CRIT_PROTOCOL_STOP
);

2640 i‡(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_HAS_CHANNEL_SWITCH
)

2641 
	`CMD
(
ch™√l_swôch
, 
CHANNEL_SWITCH
);

2642 
	`CMD
(
£t_qos_m≠
, 
SET_QOS_MAP
);

2643 i‡(
rdev
->
wùhy
.
„©uªs
 &

2644 
NL80211_FEATURE_SUPPORTS_WMM_ADMISSION
)

2645 
	`CMD
(
add_tx_ts
, 
ADD_TX_TS
);

2646 
	`CMD
(
£t_mu…iˇ°_to_uniˇ°
, 
SET_MULTICAST_TO_UNICAST
);

2647 
	`CMD
(
upd©e_c⁄√˘_∑øms
, 
UPDATE_CONNECT_PARAMS
);

2648 
	`CMD
(
upd©e_·_õs
, 
UPDATE_FT_IES
);

2649 i‡(
rdev
->
wùhy
.
ßr_ˇ∑
)

2650 
	`CMD
(
£t_ßr_•ecs
, 
SET_SAR_SPECS
);

2652 #unde‡
CMD


2654 
	`∆a_√°_íd
(
msg
, 
∆_cmds
);

2655 
°©e
->
•lô_°¨t
++;

2656 i‡(
°©e
->
•lô
)

2658 
ÁŒthrough
;

2660 i‡(
rdev
->
›s
->
ªmaö_⁄_ch™√l
 &&

2661 (
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_HAS_REMAIN_ON_CHANNEL
) &&

2662 
	`∆a_put_u32
(
msg
,

2663 
NL80211_ATTR_MAX_REMAIN_ON_CHANNEL_DURATION
,

2664 
rdev
->
wùhy
.
max_ªmaö_⁄_ch™√l_duøti⁄
))

2665 
∆a_put_Áûuª
;

2667 i‡((
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_OFFCHAN_TX
) &&

2668 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_OFFCHANNEL_TX_OK
))

2669 
∆a_put_Áûuª
;

2671 
°©e
->
•lô_°¨t
++;

2672 i‡(
°©e
->
•lô
)

2674 
ÁŒthrough
;

2676 #ifde‡
CONFIG_PM


2677 i‡(
	`∆80211_£nd_wowœn
(
msg
, 
rdev
, 
°©e
->
•lô
))

2678 
∆a_put_Áûuª
;

2679 
°©e
->
•lô_°¨t
++;

2680 i‡(
°©e
->
•lô
)

2683 
°©e
->
•lô_°¨t
++;

2685 
ÁŒthrough
;

2687 i‡(
	`∆80211_put_i·y≥s
(
msg
, 
NL80211_ATTR_SOFTWARE_IFTYPES
,

2688 
rdev
->
wùhy
.
so·w¨e_i·y≥s
))

2689 
∆a_put_Áûuª
;

2691 i‡(
	`∆80211_put_iÁ˚_combö©i⁄s
(&
rdev
->
wùhy
, 
msg
,

2692 
°©e
->
•lô
))

2693 
∆a_put_Áûuª
;

2695 
°©e
->
•lô_°¨t
++;

2696 i‡(
°©e
->
•lô
)

2698 
ÁŒthrough
;

2700 i‡((
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_HAVE_AP_SME
) &&

2701 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_DEVICE_AP_SME
,

2702 
rdev
->
wùhy
.
≠_sme_ˇ∑
))

2703 
∆a_put_Áûuª
;

2705 
„©uªs
 = 
rdev
->
wùhy
.features;

2711 i‡(
°©e
->
•lô
)

2712 
„©uªs
 |
NL80211_FEATURE_ADVERTISE_CHAN_LIMITS
;

2713 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_FEATURE_FLAGS
, 
„©uªs
))

2714 
∆a_put_Áûuª
;

2716 i‡(
rdev
->
wùhy
.
ht_ˇ∑_mod_mask
 &&

2717 
	`∆a_put
(
msg
, 
NL80211_ATTR_HT_CAPABILITY_MASK
,

2718 (*
rdev
->
wùhy
.
ht_ˇ∑_mod_mask
),

2719 
rdev
->
wùhy
.
ht_ˇ∑_mod_mask
))

2720 
∆a_put_Áûuª
;

2722 i‡(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_HAVE_AP_SME
 &&

2723 
rdev
->
wùhy
.
max_a˛_mac_addrs
 &&

2724 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_MAC_ACL_MAX
,

2725 
rdev
->
wùhy
.
max_a˛_mac_addrs
))

2726 
∆a_put_Áûuª
;

2738 i‡(
°©e
->
•lô
)

2739 
°©e
->
•lô_°¨t
++;

2741 
°©e
->
•lô_°¨t
 = 0;

2744 i‡(
	`∆80211_£nd_mgmt_°y≥s
(
msg
, 
mgmt_°y≥s
))

2745 
∆a_put_Áûuª
;

2747 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_MAX_NUM_SCHED_SCAN_PLANS
,

2748 
rdev
->
wùhy
.
max_sched_sˇn_∂™s
) ||

2749 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_MAX_SCAN_PLAN_INTERVAL
,

2750 
rdev
->
wùhy
.
max_sched_sˇn_∂™_öãrvÆ
) ||

2751 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_MAX_SCAN_PLAN_ITERATIONS
,

2752 
rdev
->
wùhy
.
max_sched_sˇn_∂™_ôî©i⁄s
))

2753 
∆a_put_Áûuª
;

2755 i‡(
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs
 &&

2756 (
	`∆a_put
(
msg
, 
NL80211_ATTR_EXT_CAPA
,

2757 
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs_Àn
,

2758 
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs
) ||

2759 
	`∆a_put
(
msg
, 
NL80211_ATTR_EXT_CAPA_MASK
,

2760 
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs_Àn
,

2761 
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs_mask
)))

2762 
∆a_put_Áûuª
;

2764 i‡(
rdev
->
wùhy
.
vht_ˇ∑_mod_mask
 &&

2765 
	`∆a_put
(
msg
, 
NL80211_ATTR_VHT_CAPABILITY_MASK
,

2766 (*
rdev
->
wùhy
.
vht_ˇ∑_mod_mask
),

2767 
rdev
->
wùhy
.
vht_ˇ∑_mod_mask
))

2768 
∆a_put_Áûuª
;

2770 i‡(
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
,

2771 
rdev
->
wùhy
.
≥rm_addr
))

2772 
∆a_put_Áûuª
;

2774 i‡(!
	`is_zîo_ëhî_addr
(
rdev
->
wùhy
.
addr_mask
) &&

2775 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC_MASK
, 
ETH_ALEN
,

2776 
rdev
->
wùhy
.
addr_mask
))

2777 
∆a_put_Áûuª
;

2779 i‡(
rdev
->
wùhy
.
n_addªs£s
 > 1) {

2780 *
©å
;

2782 
©å
 = 
	`∆a_√°_°¨t
(
msg
, 
NL80211_ATTR_MAC_ADDRS
);

2783 i‡(!
©å
)

2784 
∆a_put_Áûuª
;

2786 
i
 = 0; i < 
rdev
->
wùhy
.
n_addªs£s
; i++)

2787 i‡(
	`∆a_put
(
msg
, 
i
 + 1, 
ETH_ALEN
,

2788 
rdev
->
wùhy
.
addªs£s
[
i
].
addr
))

2789 
∆a_put_Áûuª
;

2791 
	`∆a_√°_íd
(
msg
, 
©å
);

2794 
°©e
->
•lô_°¨t
++;

2797 i‡(
	`∆80211_£nd_cﬂÀs˚
(
msg
, 
rdev
))

2798 
∆a_put_Áûuª
;

2800 i‡((
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_5_10_MHZ
) &&

2801 (
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_SUPPORT_5_MHZ
) ||

2802 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_SUPPORT_10_MHZ
)))

2803 
∆a_put_Áûuª
;

2805 i‡(
rdev
->
wùhy
.
max_≠_assoc_°a
 &&

2806 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_MAX_AP_ASSOC_STA
,

2807 
rdev
->
wùhy
.
max_≠_assoc_°a
))

2808 
∆a_put_Áûuª
;

2810 
°©e
->
•lô_°¨t
++;

2813 i‡(
rdev
->
wùhy
.
n_víd‹_comm™ds
) {

2814 c⁄° 
∆80211_víd‹_cmd_öfo
 *
öfo
;

2815 
∆©å
 *
√°ed
;

2817 
√°ed
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

2818 
NL80211_ATTR_VENDOR_DATA
);

2819 i‡(!
√°ed
)

2820 
∆a_put_Áûuª
;

2822 
i
 = 0; i < 
rdev
->
wùhy
.
n_víd‹_comm™ds
; i++) {

2823 
öfo
 = &
rdev
->
wùhy
.
víd‹_comm™ds
[
i
].info;

2824 i‡(
	`∆a_put
(
msg
, 
i
 + 1, (*
öfo
), info))

2825 
∆a_put_Áûuª
;

2827 
	`∆a_√°_íd
(
msg
, 
√°ed
);

2830 i‡(
rdev
->
wùhy
.
n_víd‹_evíts
) {

2831 c⁄° 
∆80211_víd‹_cmd_öfo
 *
öfo
;

2832 
∆©å
 *
√°ed
;

2834 
√°ed
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

2835 
NL80211_ATTR_VENDOR_EVENTS
);

2836 i‡(!
√°ed
)

2837 
∆a_put_Áûuª
;

2839 
i
 = 0; i < 
rdev
->
wùhy
.
n_víd‹_evíts
; i++) {

2840 
öfo
 = &
rdev
->
wùhy
.
víd‹_evíts
[
i
];

2841 i‡(
	`∆a_put
(
msg
, 
i
 + 1, (*
öfo
), info))

2842 
∆a_put_Áûuª
;

2844 
	`∆a_√°_íd
(
msg
, 
√°ed
);

2846 
°©e
->
•lô_°¨t
++;

2849 i‡(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_HAS_CHANNEL_SWITCH
 &&

2850 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MAX_CSA_COUNTERS
,

2851 
rdev
->
wùhy
.
max_num_cß_cou¡îs
))

2852 
∆a_put_Áûuª
;

2854 i‡(
rdev
->
wùhy
.
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
 &&

2855 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_WIPHY_SELF_MANAGED_REG
))

2856 
∆a_put_Áûuª
;

2858 i‡(
rdev
->
wùhy
.
max_sched_sˇn_ªqs
 &&

2859 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_SCHED_SCAN_MAX_REQS
,

2860 
rdev
->
wùhy
.
max_sched_sˇn_ªqs
))

2861 
∆a_put_Áûuª
;

2863 i‡(
	`∆a_put
(
msg
, 
NL80211_ATTR_EXT_FEATURES
,

2864 (
rdev
->
wùhy
.
ext_„©uªs
),

2865 
rdev
->
wùhy
.
ext_„©uªs
))

2866 
∆a_put_Áûuª
;

2868 i‡(
rdev
->
wùhy
.
bss_£À˘_suµ‹t
) {

2869 
∆©å
 *
√°ed
;

2870 
u32
 
bss_£À˘_suµ‹t
 = 
rdev
->
wùhy
.bss_select_support;

2872 
√°ed
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

2873 
NL80211_ATTR_BSS_SELECT
);

2874 i‡(!
√°ed
)

2875 
∆a_put_Áûuª
;

2877 
i
 = 0;

2878 
bss_£À˘_suµ‹t
) {

2879 i‡((
bss_£À˘_suµ‹t
 & 1) &&

2880 
	`∆a_put_Êag
(
msg
, 
i
))

2881 
∆a_put_Áûuª
;

2882 
i
++;

2883 
bss_£À˘_suµ‹t
 >>= 1;

2885 
	`∆a_√°_íd
(
msg
, 
√°ed
);

2888 
°©e
->
•lô_°¨t
++;

2891 i‡(
rdev
->
wùhy
.
num_i·y≥_ext_ˇ∑b
 &&

2892 
rdev
->
wùhy
.
i·y≥_ext_ˇ∑b
) {

2893 
∆©å
 *
√°ed_ext_ˇ∑b
, *
√°ed
;

2895 
√°ed
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

2896 
NL80211_ATTR_IFTYPE_EXT_CAPA
);

2897 i‡(!
√°ed
)

2898 
∆a_put_Áûuª
;

2900 
i
 = 
°©e
->
ˇ∑_°¨t
;

2901 
i
 < 
rdev
->
wùhy
.
num_i·y≥_ext_ˇ∑b
; i++) {

2902 c⁄° 
wùhy_i·y≥_ext_ˇ∑b
 *
ˇ∑b
;

2904 
ˇ∑b
 = &
rdev
->
wùhy
.
i·y≥_ext_ˇ∑b
[
i
];

2906 
√°ed_ext_ˇ∑b
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

2907 
i
);

2908 i‡(!
√°ed_ext_ˇ∑b
 ||

2909 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFTYPE
,

2910 
ˇ∑b
->
i·y≥
) ||

2911 
	`∆a_put
(
msg
, 
NL80211_ATTR_EXT_CAPA
,

2912 
ˇ∑b
->
exãnded_ˇ∑bûôõs_Àn
,

2913 
ˇ∑b
->
exãnded_ˇ∑bûôõs
) ||

2914 
	`∆a_put
(
msg
, 
NL80211_ATTR_EXT_CAPA_MASK
,

2915 
ˇ∑b
->
exãnded_ˇ∑bûôõs_Àn
,

2916 
ˇ∑b
->
exãnded_ˇ∑bûôõs_mask
))

2917 
∆a_put_Áûuª
;

2919 i‡(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_MLO
 &&

2920 (
	`∆a_put_u16
(
msg
,

2921 
NL80211_ATTR_EML_CAPABILITY
,

2922 
ˇ∑b
->
eml_ˇ∑bûôõs
) ||

2923 
	`∆a_put_u16
(
msg
,

2924 
NL80211_ATTR_MLD_CAPA_AND_OPS
,

2925 
ˇ∑b
->
mld_ˇ∑_™d_›s
)))

2926 
∆a_put_Áûuª
;

2928 
	`∆a_√°_íd
(
msg
, 
√°ed_ext_ˇ∑b
);

2929 i‡(
°©e
->
•lô
)

2932 
	`∆a_√°_íd
(
msg
, 
√°ed
);

2933 i‡(
i
 < 
rdev
->
wùhy
.
num_i·y≥_ext_ˇ∑b
) {

2934 
°©e
->
ˇ∑_°¨t
 = 
i
 + 1;

2939 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_BANDS
,

2940 
rdev
->
wùhy
.
«n_suµ‹ãd_b™ds
))

2941 
∆a_put_Áûuª
;

2943 i‡(
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

2944 
NL80211_EXT_FEATURE_TXQS
)) {

2945 
cfg80211_txq_°©s
 
txq°©s
 = {};

2946 
ªs
;

2948 
ªs
 = 
	`rdev_gë_txq_°©s
(
rdev
, 
NULL
, &
txq°©s
);

2949 i‡(!
ªs
 &&

2950 !
	`∆80211_put_txq_°©s
(
msg
, &
txq°©s
,

2951 
NL80211_ATTR_TXQ_STATS
))

2952 
∆a_put_Áûuª
;

2954 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_TXQ_LIMIT
,

2955 
rdev
->
wùhy
.
txq_limô
))

2956 
∆a_put_Áûuª
;

2957 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_TXQ_MEMORY_LIMIT
,

2958 
rdev
->
wùhy
.
txq_mem‹y_limô
))

2959 
∆a_put_Áûuª
;

2960 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_TXQ_QUANTUM
,

2961 
rdev
->
wùhy
.
txq_qu™tum
))

2962 
∆a_put_Áûuª
;

2965 
°©e
->
•lô_°¨t
++;

2968 i‡(
	`∆80211_£nd_pm§_ˇ∑
(
rdev
, 
msg
))

2969 
∆a_put_Áûuª
;

2971 
°©e
->
•lô_°¨t
++;

2974 i‡(
rdev
->
wùhy
.
akm_suôes
 &&

2975 
	`∆a_put
(
msg
, 
NL80211_ATTR_AKM_SUITES
,

2976 (
u32
Ë* 
rdev
->
wùhy
.
n_akm_suôes
,

2977 
rdev
->
wùhy
.
akm_suôes
))

2978 
∆a_put_Áûuª
;

2980 i‡(
	`∆80211_put_i·y≥_akm_suôes
(
rdev
, 
msg
))

2981 
∆a_put_Áûuª
;

2983 i‡(
	`∆80211_put_tid_c⁄fig_suµ‹t
(
rdev
, 
msg
))

2984 
∆a_put_Áûuª
;

2985 
°©e
->
•lô_°¨t
++;

2988 i‡(
	`∆80211_put_ßr_•ecs
(
rdev
, 
msg
))

2989 
∆a_put_Áûuª
;

2991 i‡(
	`∆80211_put_mbssid_suµ‹t
(&
rdev
->
wùhy
, 
msg
))

2992 
∆a_put_Áûuª
;

2994 i‡(
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_MAX_NUM_AKM_SUITES
,

2995 
rdev
->
wùhy
.
max_num_akm_suôes
))

2996 
∆a_put_Áûuª
;

2998 i‡(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_MLO
)

2999 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_MLO_SUPPORT
);

3001 i‡(
rdev
->
wùhy
.
hw_time°amp_max_≥îs
 &&

3002 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_MAX_HW_TIMESTAMP_PEERS
,

3003 
rdev
->
wùhy
.
hw_time°amp_max_≥îs
))

3004 
∆a_put_Áûuª
;

3007 
°©e
->
•lô_°¨t
 = 0;

3010 
föish
:

3011 
	`gílmsg_íd
(
msg
, 
hdr
);

3014 
∆a_put_Áûuª
:

3015 
	`gílmsg_ˇn˚l
(
msg
, 
hdr
);

3016  -
EMSGSIZE
;

3017 
	}
}

3019 
	$∆80211_dump_wùhy_∑r£
(
sk_buff
 *
skb
,

3020 
√éök_ˇŒback
 *
cb
,

3021 
∆80211_dump_wùhy_°©e
 *
°©e
)

3023 
∆©å
 **
tb
 = 
	`kˇŒoc
(
NUM_NL80211_ATTR
, (*tb), 
GFP_KERNEL
);

3024 
ªt
;

3026 i‡(!
tb
)

3027  -
ENOMEM
;

3029 
ªt
 = 
	`∆msg_∑r£_dïªˇãd
(
cb
->
∆h
,

3030 
GENL_HDRLEN
 + 
∆80211_Ám
.
hdrsize
,

3031 
tb
, 
∆80211_Ám
.
max©å
,

3032 
∆80211_pﬁicy
, 
NULL
);

3034 i‡(
ªt
) {

3035 
ªt
 = 0;

3036 
out
;

3039 
°©e
->
•lô
 = 
tb
[
NL80211_ATTR_SPLIT_WIPHY_DUMP
];

3040 i‡(
tb
[
NL80211_ATTR_WIPHY
])

3041 
°©e
->
fûãr_wùhy
 = 
	`∆a_gë_u32
(
tb
[
NL80211_ATTR_WIPHY
]);

3042 i‡(
tb
[
NL80211_ATTR_WDEV
])

3043 
°©e
->
fûãr_wùhy
 = 
	`∆a_gë_u64
(
tb
[
NL80211_ATTR_WDEV
]) >> 32;

3044 i‡(
tb
[
NL80211_ATTR_IFINDEX
]) {

3045 
√t_devi˚
 *
√tdev
;

3046 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3047 
ifidx
 = 
	`∆a_gë_u32
(
tb
[
NL80211_ATTR_IFINDEX
]);

3049 
√tdev
 = 
	`__dev_gë_by_ödex
(
	`sock_√t
(
skb
->
sk
), 
ifidx
);

3050 i‡(!
√tdev
) {

3051 
ªt
 = -
ENODEV
;

3052 
out
;

3054 i‡(
√tdev
->
õì80211_±r
) {

3055 
rdev
 = 
	`wùhy_to_rdev
(

3056 
√tdev
->
õì80211_±r
->
wùhy
);

3057 
°©e
->
fûãr_wùhy
 = 
rdev
->
wùhy_idx
;

3061 
ªt
 = 0;

3062 
out
:

3063 
	`k‰ì
(
tb
);

3064  
ªt
;

3065 
	}
}

3067 
	$∆80211_dump_wùhy
(
sk_buff
 *
skb
, 
√éök_ˇŒback
 *
cb
)

3069 
idx
 = 0, 
ªt
;

3070 
∆80211_dump_wùhy_°©e
 *
°©e
 = (*)
cb
->
¨gs
[0];

3071 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3073 
	`π∆_lock
();

3074 i‡(!
°©e
) {

3075 
°©e
 = 
	`kzÆloc
((*°©e), 
GFP_KERNEL
);

3076 i‡(!
°©e
) {

3077 
	`π∆_u∆ock
();

3078  -
ENOMEM
;

3080 
°©e
->
fûãr_wùhy
 = -1;

3081 
ªt
 = 
	`∆80211_dump_wùhy_∑r£
(
skb
, 
cb
, 
°©e
);

3082 i‡(
ªt
) {

3083 
	`k‰ì
(
°©e
);

3084 
	`π∆_u∆ock
();

3085  
ªt
;

3087 
cb
->
¨gs
[0] = ()
°©e
;

3090 
	`f‹_óch_rdev
(
rdev
) {

3091 i‡(!
	`√t_eq
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
	`sock_√t
(
skb
->
sk
)))

3093 i‡(++
idx
 <
°©e
->
°¨t
)

3095 i‡(
°©e
->
fûãr_wùhy
 != -1 &&

3096 
°©e
->
fûãr_wùhy
 !
rdev
->
wùhy_idx
)

3098 
	`wùhy_lock
(&
rdev
->
wùhy
);

3101 
ªt
 = 
	`∆80211_£nd_wùhy
(
rdev
, 
NL80211_CMD_NEW_WIPHY
,

3102 
skb
,

3103 
	`NETLINK_CB
(
cb
->
skb
).
p‹tid
,

3104 
cb
->
∆h
->
∆msg_£q
,

3105 
NLM_F_MULTI
, 
°©e
);

3106 i‡(
ªt
 < 0) {

3120 i‡((
ªt
 =-
ENOBUFS
 ||Ñë =-
EMSGSIZE
) &&

3121 !
skb
->
Àn
 && !
°©e
->
•lô
 &&

3122 
cb
->
mö_dump_Æloc
 < 4096) {

3123 
cb
->
mö_dump_Æloc
 = 4096;

3124 
°©e
->
•lô_°¨t
 = 0;

3125 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

3126 
	`π∆_u∆ock
();

3129 
idx
--;

3132 } 
°©e
->
•lô_°¨t
 > 0);

3133 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

3136 
	`π∆_u∆ock
();

3138 
°©e
->
°¨t
 = 
idx
;

3140  
skb
->
Àn
;

3141 
	}
}

3143 
	$∆80211_dump_wùhy_d⁄e
(
√éök_ˇŒback
 *
cb
)

3145 
	`k‰ì
((*)
cb
->
¨gs
[0]);

3147 
	}
}

3149 
	$∆80211_gë_wùhy
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

3151 
sk_buff
 *
msg
;

3152 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

3153 
∆80211_dump_wùhy_°©e
 
°©e
 = {};

3155 
msg
 = 
	`∆msg_√w
(4096, 
GFP_KERNEL
);

3156 i‡(!
msg
)

3157  -
ENOMEM
;

3159 i‡(
	`∆80211_£nd_wùhy
(
rdev
, 
NL80211_CMD_NEW_WIPHY
, 
msg
,

3160 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

3161 &
°©e
) < 0) {

3162 
	`∆msg_‰ì
(
msg
);

3163  -
ENOBUFS
;

3166  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

3167 
	}
}

3169 c⁄° 
∆a_pﬁicy
 
	gtxq_∑øms_pﬁicy
[
NL80211_TXQ_ATTR_MAX
 + 1] = {

3170 [
NL80211_TXQ_ATTR_QUEUE
] = { .
ty≥
 = 
NLA_U8
 },

3171 [
NL80211_TXQ_ATTR_TXOP
] = { .
ty≥
 = 
NLA_U16
 },

3172 [
NL80211_TXQ_ATTR_CWMIN
] = { .
ty≥
 = 
NLA_U16
 },

3173 [
NL80211_TXQ_ATTR_CWMAX
] = { .
ty≥
 = 
NLA_U16
 },

3174 [
NL80211_TXQ_ATTR_AIFS
] = { .
ty≥
 = 
NLA_U8
 },

3177 
	$∑r£_txq_∑øms
(
∆©å
 *
tb
[],

3178 
õì80211_txq_∑øms
 *
txq_∑øms
)

3180 
u8
 
ac
;

3182 i‡(!
tb
[
NL80211_TXQ_ATTR_AC
] || !tb[
NL80211_TXQ_ATTR_TXOP
] ||

3183 !
tb
[
NL80211_TXQ_ATTR_CWMIN
] || !tb[
NL80211_TXQ_ATTR_CWMAX
] ||

3184 !
tb
[
NL80211_TXQ_ATTR_AIFS
])

3185  -
EINVAL
;

3187 
ac
 = 
	`∆a_gë_u8
(
tb
[
NL80211_TXQ_ATTR_AC
]);

3188 
txq_∑øms
->
tx›
 = 
	`∆a_gë_u16
(
tb
[
NL80211_TXQ_ATTR_TXOP
]);

3189 
txq_∑øms
->
cwmö
 = 
	`∆a_gë_u16
(
tb
[
NL80211_TXQ_ATTR_CWMIN
]);

3190 
txq_∑øms
->
cwmax
 = 
	`∆a_gë_u16
(
tb
[
NL80211_TXQ_ATTR_CWMAX
]);

3191 
txq_∑øms
->
aifs
 = 
	`∆a_gë_u8
(
tb
[
NL80211_TXQ_ATTR_AIFS
]);

3193 i‡(
ac
 >
NL80211_NUM_ACS
)

3194  -
EINVAL
;

3195 
txq_∑øms
->
ac
 = 
	`¨øy_ödex_no•ec
◊c, 
NL80211_NUM_ACS
);

3197 
	}
}

3199 
boﬁ
 
	$∆80211_ˇn_£t_dev_ch™√l
(
wúñess_dev
 *
wdev
)

3216  !
wdev
 ||

3217 
wdev
->
i·y≥
 =
NL80211_IFTYPE_AP
 ||

3218 
wdev
->
i·y≥
 =
NL80211_IFTYPE_MESH_POINT
 ||

3219 
wdev
->
i·y≥
 =
NL80211_IFTYPE_MONITOR
 ||

3220 
wdev
->
i·y≥
 =
NL80211_IFTYPE_P2P_GO
;

3221 
	}
}

3223 
	$_∆80211_∑r£_ch™def
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

3224 
gíl_öfo
 *
öfo
, 
boﬁ
 
m⁄ô‹
,

3225 
cfg80211_ch™_def
 *
ch™def
)

3227 
√éök_ext_ack
 *
exèck
 = 
öfo
->extack;

3228 
∆©å
 **
©ås
 = 
öfo
->attrs;

3229 
u32
 
c⁄åﬁ_‰eq
;

3231 i‡(!
©ås
[
NL80211_ATTR_WIPHY_FREQ
]) {

3232 
	`NL_SET_ERR_MSG_ATTR
(
exèck
, 
©ås
[
NL80211_ATTR_WIPHY_FREQ
],

3234  -
EINVAL
;

3237 
c⁄åﬁ_‰eq
 = 
	`MHZ_TO_KHZ
(

3238 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
]));

3239 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ_OFFSET
])

3240 
c⁄åﬁ_‰eq
 +=

3241 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ_OFFSET
]);

3243 
	`mem£t
(
ch™def
, 0, (*chandef));

3244 
ch™def
->
ch™
 = 
	`õì80211_gë_ch™√l_khz
(&
rdev
->
wùhy
, 
c⁄åﬁ_‰eq
);

3245 
ch™def
->
width
 = 
NL80211_CHAN_WIDTH_20_NOHT
;

3246 
ch™def
->
˚¡î_‰eq1
 = 
	`KHZ_TO_MHZ
(
c⁄åﬁ_‰eq
);

3247 
ch™def
->
‰eq1_off£t
 = 
c⁄åﬁ_‰eq
 % 1000;

3248 
ch™def
->
˚¡î_‰eq2
 = 0;

3250 i‡(!
ch™def
->
ch™
) {

3251 
	`NL_SET_ERR_MSG_ATTR
(
exèck
, 
©ås
[
NL80211_ATTR_WIPHY_FREQ
],

3253  -
EINVAL
;

3256 i‡(
©ås
[
NL80211_ATTR_WIPHY_CHANNEL_TYPE
]) {

3257 
∆80211_ch™√l_ty≥
 
ch™ty≥
;

3259 
ch™ty≥
 = 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_WIPHY_CHANNEL_TYPE
]);

3261 
ch™ty≥
) {

3262 
NL80211_CHAN_NO_HT
:

3263 
NL80211_CHAN_HT20
:

3264 
NL80211_CHAN_HT40PLUS
:

3265 
NL80211_CHAN_HT40MINUS
:

3266 
	`cfg80211_ch™def_¸óã
(
ch™def
, ch™def->
ch™
,

3267 
ch™ty≥
);

3269 i‡(
©ås
[
NL80211_ATTR_CENTER_FREQ1
] &&

3270 
ch™def
->
˚¡î_‰eq1
 !
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_CENTER_FREQ1
])) {

3271 
	`NL_SET_ERR_MSG_ATTR
(
exèck
,

3272 
©ås
[
NL80211_ATTR_CENTER_FREQ1
],

3274  -
EINVAL
;

3277 i‡(
©ås
[
NL80211_ATTR_CENTER_FREQ2
] &&

3278 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_CENTER_FREQ2
])) {

3279 
	`NL_SET_ERR_MSG_ATTR
(
exèck
,

3280 
©ås
[
NL80211_ATTR_CENTER_FREQ2
],

3282  -
EINVAL
;

3286 
	`NL_SET_ERR_MSG_ATTR
(
exèck
,

3287 
©ås
[
NL80211_ATTR_WIPHY_CHANNEL_TYPE
],

3289  -
EINVAL
;

3291 } i‡(
©ås
[
NL80211_ATTR_CHANNEL_WIDTH
]) {

3292 
ch™def
->
width
 =

3293 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_CHANNEL_WIDTH
]);

3294 i‡(
ch™def
->
ch™
->
b™d
 =
NL80211_BAND_S1GHZ
) {

3296 i‡(
ch™def
->
width
 !
	`õì80211_s1g_ch™√l_width
(ch™def->
ch™
)) {

3297 
	`NL_SET_ERR_MSG_ATTR
(
exèck
,

3298 
©ås
[
NL80211_ATTR_CHANNEL_WIDTH
],

3300  -
EINVAL
;

3303 i‡(
©ås
[
NL80211_ATTR_CENTER_FREQ1
]) {

3304 
ch™def
->
˚¡î_‰eq1
 =

3305 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_CENTER_FREQ1
]);

3306 i‡(
©ås
[
NL80211_ATTR_CENTER_FREQ1_OFFSET
])

3307 
ch™def
->
‰eq1_off£t
 = 
	`∆a_gë_u32
(

3308 
©ås
[
NL80211_ATTR_CENTER_FREQ1_OFFSET
]);

3310 
ch™def
->
‰eq1_off£t
 = 0;

3312 i‡(
©ås
[
NL80211_ATTR_CENTER_FREQ2
])

3313 
ch™def
->
˚¡î_‰eq2
 =

3314 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_CENTER_FREQ2
]);

3317 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_EDMG_CHANNELS
]) {

3318 
ch™def
->
edmg
.
ch™√ls
 =

3319 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_EDMG_CHANNELS
]);

3321 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_EDMG_BW_CONFIG
])

3322 
ch™def
->
edmg
.
bw_c⁄fig
 =

3323 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_EDMG_BW_CONFIG
]);

3325 
ch™def
->
edmg
.
bw_c⁄fig
 = 0;

3326 
ch™def
->
edmg
.
ch™√ls
 = 0;

3329 i‡(
öfo
->
©ås
[
NL80211_ATTR_PUNCT_BITMAP
]) {

3330 
ch™def
->
pun˘uªd
 =

3331 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_PUNCT_BITMAP
]);

3333 i‡(
ch™def
->
pun˘uªd
 &&

3334 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

3335 
NL80211_EXT_FEATURE_PUNCT
)) {

3336 
	`NL_SET_ERR_MSG
(
exèck
,

3338  -
EINVAL
;

3342 i‡(!
	`cfg80211_ch™def_vÆid
(
ch™def
)) {

3343 
	`NL_SET_ERR_MSG
(
exèck
, "invalid channel definition");

3344  -
EINVAL
;

3347 i‡(!
	`_cfg80211_ch™def_ußbÀ
(&
rdev
->
wùhy
, 
ch™def
,

3348 
IEEE80211_CHAN_DISABLED
,

3349 
m⁄ô‹
)) {

3350 
	`NL_SET_ERR_MSG
(
exèck
, "(extension) channel is disabled");

3351  -
EINVAL
;

3354 i‡((
ch™def
->
width
 =
NL80211_CHAN_WIDTH_5
 ||

3355 
ch™def
->
width
 =
NL80211_CHAN_WIDTH_10
) &&

3356 !(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_5_10_MHZ
)) {

3357 
	`NL_SET_ERR_MSG
(
exèck
, "5/10 MHzÇot supported");

3358  -
EINVAL
;

3362 
	}
}

3364 
	$∆80211_∑r£_ch™def
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

3365 
gíl_öfo
 *
öfo
,

3366 
cfg80211_ch™_def
 *
ch™def
)

3368  
	`_∆80211_∑r£_ch™def
(
rdev
, 
öfo
, 
Ál£
, 
ch™def
);

3369 
	}
}

3371 
	$__∆80211_£t_ch™√l
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

3372 
√t_devi˚
 *
dev
,

3373 
gíl_öfo
 *
öfo
,

3374 
_lök_id
)

3376 
cfg80211_ch™_def
 
ch™def
;

3377 
ªsu…
;

3378 
∆80211_i·y≥
 
i·y≥
 = 
NL80211_IFTYPE_MONITOR
;

3379 
wúñess_dev
 *
wdev
 = 
NULL
;

3380 
lök_id
 = 
_lök_id
;

3382 i‡(
dev
)

3383 
wdev
 = 
dev
->
õì80211_±r
;

3384 i‡(!
	`∆80211_ˇn_£t_dev_ch™√l
(
wdev
))

3385  -
EOPNOTSUPP
;

3386 i‡(
wdev
)

3387 
i·y≥
 = 
wdev
->iftype;

3389 i‡(
lök_id
 < 0) {

3390 i‡(
wdev
 && wdev->
vÆid_löks
)

3391  -
EINVAL
;

3392 
lök_id
 = 0;

3395 
ªsu…
 = 
	`_∆80211_∑r£_ch™def
(
rdev
, 
öfo
,

3396 
i·y≥
 =
NL80211_IFTYPE_MONITOR
,

3397 &
ch™def
);

3398 i‡(
ªsu…
)

3399  
ªsu…
;

3401 
i·y≥
) {

3402 
NL80211_IFTYPE_AP
:

3403 
NL80211_IFTYPE_P2P_GO
:

3404 i‡(!
	`cfg80211_ªg_ˇn_bóc⁄_ªœx
(&
rdev
->
wùhy
, &
ch™def
,

3405 
i·y≥
))

3406  -
EINVAL
;

3407 i‡(
wdev
->
löks
[
lök_id
].
≠
.
bóc⁄_öãrvÆ
) {

3408 
õì80211_ch™√l
 *
cur_ch™
;

3410 i‡(!
dev
 || !
rdev
->
›s
->
£t_≠_ch™width
 ||

3411 !(
rdev
->
wùhy
.
„©uªs
 &

3412 
NL80211_FEATURE_AP_MODE_CHAN_WIDTH_CHANGE
))

3413  -
EBUSY
;

3416 
cur_ch™
 = 
wdev
->
löks
[
lök_id
].
≠
.
ch™def
.
ch™
;

3417 i‡(
ch™def
.
ch™
 !
cur_ch™
)

3418  -
EBUSY
;

3420 
ªsu…
 = 
	`rdev_£t_≠_ch™width
(
rdev
, 
dev
, 
lök_id
,

3421 &
ch™def
);

3422 i‡(
ªsu…
)

3423  
ªsu…
;

3424 
wdev
->
löks
[
lök_id
].
≠
.
ch™def
 = chandef;

3426 
wdev
->
u
.
≠
.
¥e£t_ch™def
 = 
ch™def
;

3429 
NL80211_IFTYPE_MESH_POINT
:

3430  
	`cfg80211_£t_mesh_ch™√l
(
rdev
, 
wdev
, &
ch™def
);

3431 
NL80211_IFTYPE_MONITOR
:

3432  
	`cfg80211_£t_m⁄ô‹_ch™√l
(
rdev
, &
ch™def
);

3437  -
EINVAL
;

3438 
	}
}

3440 
	$∆80211_£t_ch™√l
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

3442 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

3443 
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

3444 
√t_devi˚
 *
√tdev
 = 
öfo
->
u£r_±r
[1];

3445 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

3446 
	`¥_öfo
("\n\n");

3448 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3449  
	`__∆80211_£t_ch™√l
(
rdev
, 
√tdev
, 
öfo
, 
lök_id
);

3450 
	}
}

3452 
	$∆80211_£t_wùhy
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

3454 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
NULL
;

3455 
√t_devi˚
 *
√tdev
 = 
NULL
;

3456 
wúñess_dev
 *
wdev
;

3457 
ªsu…
 = 0, 
ªm_txq_∑øms
 = 0;

3458 
∆©å
 *
∆_txq_∑øms
;

3459 
u32
 
ch™ged
;

3460 
u8
 
ªåy_sh‹t
 = 0, 
ªåy_l⁄g
 = 0;

3461 
u32
 
‰ag_thªshﬁd
 = 0, 
πs_thªshﬁd
 = 0;

3462 
u8
 
covîage_˛ass
 = 0;

3463 
u32
 
txq_limô
 = 0, 
txq_mem‹y_limô
 = 0, 
txq_qu™tum
 = 0;

3465 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

3467 
	`π∆_lock
();

3478 i‡(
öfo
->
©ås
[
NL80211_ATTR_IFINDEX
]) {

3479 
ifödex
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_IFINDEX
]);

3481 
√tdev
 = 
	`__dev_gë_by_ödex
(
	`gíl_öfo_√t
(
öfo
), 
ifödex
);

3482 i‡(
√tdev
 &&Çëdev->
õì80211_±r
)

3483 
rdev
 = 
	`wùhy_to_rdev
(
√tdev
->
õì80211_±r
->
wùhy
);

3485 
√tdev
 = 
NULL
;

3488 i‡(!
√tdev
) {

3489 
rdev
 = 
	`__cfg80211_rdev_‰om_©ås
(
	`gíl_öfo_√t
(
öfo
),

3490 
öfo
->
©ås
);

3491 i‡(
	`IS_ERR
(
rdev
)) {

3492 
	`π∆_u∆ock
();

3493 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3494  
	`PTR_ERR
(
rdev
);

3496 
wdev
 = 
NULL
;

3497 
√tdev
 = 
NULL
;

3498 
ªsu…
 = 0;

3500 
wdev
 = 
√tdev
->
õì80211_±r
;

3502 
	`wùhy_lock
(&
rdev
->
wùhy
);

3509 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_NAME
])

3510 
ªsu…
 = 
	`cfg80211_dev_ª«me
(

3511 
rdev
, 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_NAME
]));

3512 
	`π∆_u∆ock
();

3514 i‡(
ªsu…
) {

3515 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3516 
out
;

3519 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_TXQ_PARAMS
]) {

3520 
õì80211_txq_∑øms
 
txq_∑øms
;

3521 
∆©å
 *
tb
[
NL80211_TXQ_ATTR_MAX
 + 1];

3523 i‡(!
rdev
->
›s
->
£t_txq_∑øms
) {

3524 
ªsu…
 = -
EOPNOTSUPP
;

3525 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3526 
out
;

3529 i‡(!
√tdev
) {

3530 
ªsu…
 = -
EINVAL
;

3531 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3532 
out
;

3535 i‡(
√tdev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

3536 
√tdev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

3537 
ªsu…
 = -
EINVAL
;

3538 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3539 
out
;

3542 i‡(!
	`√tif_ru¬ög
(
√tdev
)) {

3543 
ªsu…
 = -
ENETDOWN
;

3544 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3545 
out
;

3548 
	`∆a_f‹_óch_√°ed
(
∆_txq_∑øms
,

3549 
öfo
->
©ås
[
NL80211_ATTR_WIPHY_TXQ_PARAMS
],

3550 
ªm_txq_∑øms
) {

3551 
ªsu…
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
,

3552 
NL80211_TXQ_ATTR_MAX
,

3553 
∆_txq_∑øms
,

3554 
txq_∑øms_pﬁicy
,

3555 
öfo
->
exèck
);

3556 i‡(
ªsu…
) {

3557 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3558 
out
;

3560 
ªsu…
 = 
	`∑r£_txq_∑øms
(
tb
, &
txq_∑øms
);

3561 i‡(
ªsu…
) {

3562 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3563 
out
;

3566 
txq_∑øms
.
lök_id
 =

3567 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

3569 i‡(
txq_∑øms
.
lök_id
 >= 0 &&

3570 !(
√tdev
->
õì80211_±r
->
vÆid_löks
 &

3571 
	`BIT
(
txq_∑øms
.
lök_id
)))

3572 
ªsu…
 = -
ENOLINK
;

3573 i‡(
txq_∑øms
.
lök_id
 >= 0 &&

3574 !
√tdev
->
õì80211_±r
->
vÆid_löks
)

3575 
ªsu…
 = -
EINVAL
;

3577 
ªsu…
 = 
	`rdev_£t_txq_∑øms
(
rdev
, 
√tdev
,

3578 &
txq_∑øms
);

3579 i‡(
ªsu…
) {

3580 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3581 
out
;

3586 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
]) {

3587 
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

3589 i‡(
wdev
) {

3590 
ªsu…
 = 
	`__∆80211_£t_ch™√l
(

3591 
rdev
,

3592 
	`∆80211_ˇn_£t_dev_ch™√l
(
wdev
Ë? 
√tdev
 : 
NULL
,

3593 
öfo
, 
lök_id
);

3595 
ªsu…
 = 
	`__∆80211_£t_ch™√l
(
rdev
, 
√tdev
, 
öfo
, 
lök_id
);

3598 i‡(
ªsu…
) {

3599 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3600 
out
;

3604 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_TX_POWER_SETTING
]) {

3605 
wúñess_dev
 *
txp_wdev
 = 
wdev
;

3606 
∆80211_tx_powî_£âög
 
ty≥
;

3607 
idx
, 
mbm
 = 0;

3609 i‡(!(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_VIF_TXPOWER
))

3610 
txp_wdev
 = 
NULL
;

3612 i‡(!
rdev
->
›s
->
£t_tx_powî
) {

3613 
ªsu…
 = -
EOPNOTSUPP
;

3614 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3615 
out
;

3618 
idx
 = 
NL80211_ATTR_WIPHY_TX_POWER_SETTING
;

3619 
ty≥
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
idx
]);

3621 i‡(!
öfo
->
©ås
[
NL80211_ATTR_WIPHY_TX_POWER_LEVEL
] &&

3622 (
ty≥
 !
NL80211_TX_POWER_AUTOMATIC
)) {

3623 
ªsu…
 = -
EINVAL
;

3624 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3625 
out
;

3628 i‡(
ty≥
 !
NL80211_TX_POWER_AUTOMATIC
) {

3629 
idx
 = 
NL80211_ATTR_WIPHY_TX_POWER_LEVEL
;

3630 
mbm
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
idx
]);

3633 
ªsu…
 = 
	`rdev_£t_tx_powî
(
rdev
, 
txp_wdev
, 
ty≥
, 
mbm
);

3634 i‡(
ªsu…
) {

3635 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3636 
out
;

3640 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_ANTENNA_TX
] &&

3641 
öfo
->
©ås
[
NL80211_ATTR_WIPHY_ANTENNA_RX
]) {

3642 
u32
 
tx_™t
, 
rx_™t
;

3644 i‡((!
rdev
->
wùhy
.
avaûabÀ_™ã¬as_tx
 &&

3645 !
rdev
->
wùhy
.
avaûabÀ_™ã¬as_rx
) ||

3646 !
rdev
->
›s
->
£t_™ã¬a
) {

3647 
ªsu…
 = -
EOPNOTSUPP
;

3648 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3649 
out
;

3652 
tx_™t
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_ANTENNA_TX
]);

3653 
rx_™t
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_ANTENNA_RX
]);

3657 i‡((~
tx_™t
 && (tx_™à& ~
rdev
->
wùhy
.
avaûabÀ_™ã¬as_tx
)) ||

3658 (~
rx_™t
 && (rx_™à& ~
rdev
->
wùhy
.
avaûabÀ_™ã¬as_rx
))) {

3659 
ªsu…
 = -
EINVAL
;

3660 
out
;

3663 
tx_™t
 =Åx_™à& 
rdev
->
wùhy
.
avaûabÀ_™ã¬as_tx
;

3664 
rx_™t
 =Ñx_™à& 
rdev
->
wùhy
.
avaûabÀ_™ã¬as_rx
;

3666 
ªsu…
 = 
	`rdev_£t_™ã¬a
(
rdev
, 
tx_™t
, 
rx_™t
);

3667 i‡(
ªsu…
) {

3668 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3669 
out
;

3673 
ch™ged
 = 0;

3675 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_RETRY_SHORT
]) {

3676 
ªåy_sh‹t
 = 
	`∆a_gë_u8
(

3677 
öfo
->
©ås
[
NL80211_ATTR_WIPHY_RETRY_SHORT
]);

3679 
ch™ged
 |
WIPHY_PARAM_RETRY_SHORT
;

3682 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_RETRY_LONG
]) {

3683 
ªåy_l⁄g
 = 
	`∆a_gë_u8
(

3684 
öfo
->
©ås
[
NL80211_ATTR_WIPHY_RETRY_LONG
]);

3686 
ch™ged
 |
WIPHY_PARAM_RETRY_LONG
;

3689 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FRAG_THRESHOLD
]) {

3690 
‰ag_thªshﬁd
 = 
	`∆a_gë_u32
(

3691 
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FRAG_THRESHOLD
]);

3692 i‡(
‰ag_thªshﬁd
 < 256) {

3693 
ªsu…
 = -
EINVAL
;

3694 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3695 
out
;

3698 i‡(
‰ag_thªshﬁd
 !(
u32
) -1) {

3705 
‰ag_thªshﬁd
 &= ~0x1;

3707 
ch™ged
 |
WIPHY_PARAM_FRAG_THRESHOLD
;

3710 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_RTS_THRESHOLD
]) {

3711 
πs_thªshﬁd
 = 
	`∆a_gë_u32
(

3712 
öfo
->
©ås
[
NL80211_ATTR_WIPHY_RTS_THRESHOLD
]);

3713 
ch™ged
 |
WIPHY_PARAM_RTS_THRESHOLD
;

3716 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_COVERAGE_CLASS
]) {

3717 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_DYN_ACK
]) {

3718 
ªsu…
 = -
EINVAL
;

3719 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3720 
out
;

3723 
covîage_˛ass
 = 
	`∆a_gë_u8
(

3724 
öfo
->
©ås
[
NL80211_ATTR_WIPHY_COVERAGE_CLASS
]);

3725 
ch™ged
 |
WIPHY_PARAM_COVERAGE_CLASS
;

3728 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_DYN_ACK
]) {

3729 i‡(!(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_ACKTO_ESTIMATION
)) {

3730 
ªsu…
 = -
EOPNOTSUPP
;

3731 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3732 
out
;

3735 
ch™ged
 |
WIPHY_PARAM_DYN_ACK
;

3738 i‡(
öfo
->
©ås
[
NL80211_ATTR_TXQ_LIMIT
]) {

3739 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

3740 
NL80211_EXT_FEATURE_TXQS
)) {

3741 
ªsu…
 = -
EOPNOTSUPP
;

3742 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3743 
out
;

3745 
txq_limô
 = 
	`∆a_gë_u32
(

3746 
öfo
->
©ås
[
NL80211_ATTR_TXQ_LIMIT
]);

3747 
ch™ged
 |
WIPHY_PARAM_TXQ_LIMIT
;

3750 i‡(
öfo
->
©ås
[
NL80211_ATTR_TXQ_MEMORY_LIMIT
]) {

3751 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

3752 
NL80211_EXT_FEATURE_TXQS
)) {

3753 
ªsu…
 = -
EOPNOTSUPP
;

3754 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3755 
out
;

3757 
txq_mem‹y_limô
 = 
	`∆a_gë_u32
(

3758 
öfo
->
©ås
[
NL80211_ATTR_TXQ_MEMORY_LIMIT
]);

3759 
ch™ged
 |
WIPHY_PARAM_TXQ_MEMORY_LIMIT
;

3762 i‡(
öfo
->
©ås
[
NL80211_ATTR_TXQ_QUANTUM
]) {

3763 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

3764 
NL80211_EXT_FEATURE_TXQS
)) {

3765 
ªsu…
 = -
EOPNOTSUPP
;

3766 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3767 
out
;

3769 
txq_qu™tum
 = 
	`∆a_gë_u32
(

3770 
öfo
->
©ås
[
NL80211_ATTR_TXQ_QUANTUM
]);

3771 
ch™ged
 |
WIPHY_PARAM_TXQ_QUANTUM
;

3774 i‡(
ch™ged
) {

3775 
u8
 
ﬁd_ªåy_sh‹t
, 
ﬁd_ªåy_l⁄g
;

3776 
u32
 
ﬁd_‰ag_thªshﬁd
, 
ﬁd_πs_thªshﬁd
;

3777 
u8
 
ﬁd_covîage_˛ass
;

3778 
u32
 
ﬁd_txq_limô
, 
ﬁd_txq_mem‹y_limô
, 
ﬁd_txq_qu™tum
;

3780 i‡(!
rdev
->
›s
->
£t_wùhy_∑øms
) {

3781 
ªsu…
 = -
EOPNOTSUPP
;

3782 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3783 
out
;

3786 
ﬁd_ªåy_sh‹t
 = 
rdev
->
wùhy
.
ªåy_sh‹t
;

3787 
ﬁd_ªåy_l⁄g
 = 
rdev
->
wùhy
.
ªåy_l⁄g
;

3788 
ﬁd_‰ag_thªshﬁd
 = 
rdev
->
wùhy
.
‰ag_thªshﬁd
;

3789 
ﬁd_πs_thªshﬁd
 = 
rdev
->
wùhy
.
πs_thªshﬁd
;

3790 
ﬁd_covîage_˛ass
 = 
rdev
->
wùhy
.
covîage_˛ass
;

3791 
ﬁd_txq_limô
 = 
rdev
->
wùhy
.
txq_limô
;

3792 
ﬁd_txq_mem‹y_limô
 = 
rdev
->
wùhy
.
txq_mem‹y_limô
;

3793 
ﬁd_txq_qu™tum
 = 
rdev
->
wùhy
.
txq_qu™tum
;

3795 i‡(
ch™ged
 & 
WIPHY_PARAM_RETRY_SHORT
)

3796 
rdev
->
wùhy
.
ªåy_sh‹t
 =Ñetry_short;

3797 i‡(
ch™ged
 & 
WIPHY_PARAM_RETRY_LONG
)

3798 
rdev
->
wùhy
.
ªåy_l⁄g
 =Ñetry_long;

3799 i‡(
ch™ged
 & 
WIPHY_PARAM_FRAG_THRESHOLD
)

3800 
rdev
->
wùhy
.
‰ag_thªshﬁd
 = frag_threshold;

3801 i‡(
ch™ged
 & 
WIPHY_PARAM_RTS_THRESHOLD
)

3802 
rdev
->
wùhy
.
πs_thªshﬁd
 =Ñts_threshold;

3803 i‡(
ch™ged
 & 
WIPHY_PARAM_COVERAGE_CLASS
)

3804 
rdev
->
wùhy
.
covîage_˛ass
 = coverage_class;

3805 i‡(
ch™ged
 & 
WIPHY_PARAM_TXQ_LIMIT
)

3806 
rdev
->
wùhy
.
txq_limô
 =Åxq_limit;

3807 i‡(
ch™ged
 & 
WIPHY_PARAM_TXQ_MEMORY_LIMIT
)

3808 
rdev
->
wùhy
.
txq_mem‹y_limô
 =Åxq_memory_limit;

3809 i‡(
ch™ged
 & 
WIPHY_PARAM_TXQ_QUANTUM
)

3810 
rdev
->
wùhy
.
txq_qu™tum
 =Åxq_quantum;

3812 
ªsu…
 = 
	`rdev_£t_wùhy_∑øms
(
rdev
, 
ch™ged
);

3813 i‡(
ªsu…
) {

3814 
rdev
->
wùhy
.
ªåy_sh‹t
 = 
ﬁd_ªåy_sh‹t
;

3815 
rdev
->
wùhy
.
ªåy_l⁄g
 = 
ﬁd_ªåy_l⁄g
;

3816 
rdev
->
wùhy
.
‰ag_thªshﬁd
 = 
ﬁd_‰ag_thªshﬁd
;

3817 
rdev
->
wùhy
.
πs_thªshﬁd
 = 
ﬁd_πs_thªshﬁd
;

3818 
rdev
->
wùhy
.
covîage_˛ass
 = 
ﬁd_covîage_˛ass
;

3819 
rdev
->
wùhy
.
txq_limô
 = 
ﬁd_txq_limô
;

3820 
rdev
->
wùhy
.
txq_mem‹y_limô
 = 
ﬁd_txq_mem‹y_limô
;

3821 
rdev
->
wùhy
.
txq_qu™tum
 = 
ﬁd_txq_qu™tum
;

3822 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3823 
out
;

3827 
ªsu…
 = 0;

3829 
out
:

3830 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

3831 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

3832  
ªsu…
;

3833 
	}
}

3835 
	$∆80211_£nd_ch™def
(
sk_buff
 *
msg
, c⁄° 
cfg80211_ch™_def
 *
ch™def
)

3837 i‡(
	`WARN_ON
(!
	`cfg80211_ch™def_vÆid
(
ch™def
)))

3838  -
EINVAL
;

3840 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_FREQ
,

3841 
ch™def
->
ch™
->
˚¡î_‰eq
))

3842  -
ENOBUFS
;

3843 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_FREQ_OFFSET
,

3844 
ch™def
->
ch™
->
‰eq_off£t
))

3845  -
ENOBUFS
;

3846 
ch™def
->
width
) {

3847 
NL80211_CHAN_WIDTH_20_NOHT
:

3848 
NL80211_CHAN_WIDTH_20
:

3849 
NL80211_CHAN_WIDTH_40
:

3850 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_CHANNEL_TYPE
,

3851 
	`cfg80211_gë_ch™def_ty≥
(
ch™def
)))

3852  -
ENOBUFS
;

3857 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_CHANNEL_WIDTH
, 
ch™def
->
width
))

3858  -
ENOBUFS
;

3859 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_CENTER_FREQ1
, 
ch™def
->
˚¡î_‰eq1
))

3860  -
ENOBUFS
;

3861 i‡(
ch™def
->
˚¡î_‰eq2
 &&

3862 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_CENTER_FREQ2
, 
ch™def
->
˚¡î_‰eq2
))

3863  -
ENOBUFS
;

3864 i‡(
ch™def
->
pun˘uªd
 &&

3865 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_PUNCT_BITMAP
, 
ch™def
->
pun˘uªd
))

3866  -
ENOBUFS
;

3869 
	}
}

3870 
EXPORT_SYMBOL
(
∆80211_£nd_ch™def
);

3872 
	$∆80211_£nd_iÁ˚
(
sk_buff
 *
msg
, 
u32
 
p‹tid
, u32 
£q
, 
Êags
,

3873 
cfg80211_ªgi°îed_devi˚
 *
rdev
,

3874 
wúñess_dev
 *
wdev
,

3875 
∆80211_comm™ds
 
cmd
)

3877 
√t_devi˚
 *
dev
 = 
wdev
->
√tdev
;

3878 *
hdr
;

3880 
	`lockdï_as£π_wùhy
(&
rdev
->
wùhy
);

3882 
	`WARN_ON
(
cmd
 !
NL80211_CMD_NEW_INTERFACE
 &&

3883 
cmd
 !
NL80211_CMD_DEL_INTERFACE
 &&

3884 
cmd
 !
NL80211_CMD_SET_INTERFACE
);

3886 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
p‹tid
, 
£q
, 
Êags
, 
cmd
);

3887 i‡(!
hdr
)

3890 i‡(
dev
 &&

3891 (
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

3892 
	`∆a_put_°rög
(
msg
, 
NL80211_ATTR_IFNAME
, 
dev
->
«me
)))

3893 
∆a_put_Áûuª
;

3895 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

3896 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFTYPE
, 
wdev
->
i·y≥
) ||

3897 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

3898 
NL80211_ATTR_PAD
) ||

3899 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
	`wdev_addªss
(
wdev
)) ||

3900 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_GENERATION
,

3901 
rdev
->
devli°_gíî©i⁄
 ^

3902 (
cfg80211_rdev_li°_gíî©i⁄
 << 2)) ||

3903 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_4ADDR
, 
wdev
->
u£_4addr
))

3904 
∆a_put_Áûuª
;

3906 i‡(
rdev
->
›s
->
gë_ch™√l
 && !
wdev
->
vÆid_löks
) {

3907 
cfg80211_ch™_def
 
ch™def
 = {};

3908 
ªt
;

3910 
ªt
 = 
	`rdev_gë_ch™√l
(
rdev
, 
wdev
, 0, &
ch™def
);

3911 i‡(
ªt
 =0 && 
	`∆80211_£nd_ch™def
(
msg
, &
ch™def
))

3912 
∆a_put_Áûuª
;

3915 i‡(
rdev
->
›s
->
gë_tx_powî
) {

3916 
dbm
, 
ªt
;

3918 
ªt
 = 
	`rdev_gë_tx_powî
(
rdev
, 
wdev
, &
dbm
);

3919 i‡(
ªt
 == 0 &&

3920 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_TX_POWER_LEVEL
,

3921 
	`DBM_TO_MBM
(
dbm
)))

3922 
∆a_put_Áûuª
;

3925 
wdev
->
i·y≥
) {

3926 
NL80211_IFTYPE_AP
:

3927 
NL80211_IFTYPE_P2P_GO
:

3928 i‡(
wdev
->
u
.
≠
.
ssid_Àn
 &&

3929 
	`∆a_put
(
msg
, 
NL80211_ATTR_SSID
, 
wdev
->
u
.
≠
.
ssid_Àn
,

3930 
wdev
->
u
.
≠
.
ssid
))

3931 
∆a_put_Áûuª
;

3933 
NL80211_IFTYPE_STATION
:

3934 
NL80211_IFTYPE_P2P_CLIENT
:

3935 i‡(
wdev
->
u
.
˛õ¡
.
ssid_Àn
 &&

3936 
	`∆a_put
(
msg
, 
NL80211_ATTR_SSID
, 
wdev
->
u
.
˛õ¡
.
ssid_Àn
,

3937 
wdev
->
u
.
˛õ¡
.
ssid
))

3938 
∆a_put_Áûuª
;

3940 
NL80211_IFTYPE_ADHOC
:

3941 i‡(
wdev
->
u
.
ibss
.
ssid_Àn
 &&

3942 
	`∆a_put
(
msg
, 
NL80211_ATTR_SSID
, 
wdev
->
u
.
ibss
.
ssid_Àn
,

3943 
wdev
->
u
.
ibss
.
ssid
))

3944 
∆a_put_Áûuª
;

3951 i‡(
rdev
->
›s
->
gë_txq_°©s
) {

3952 
cfg80211_txq_°©s
 
txq°©s
 = {};

3953 
ªt
 = 
	`rdev_gë_txq_°©s
(
rdev
, 
wdev
, &
txq°©s
);

3955 i‡(
ªt
 == 0 &&

3956 !
	`∆80211_put_txq_°©s
(
msg
, &
txq°©s
,

3957 
NL80211_ATTR_TXQ_STATS
))

3958 
∆a_put_Áûuª
;

3961 i‡(
wdev
->
vÆid_löks
) {

3962 
lök_id
;

3963 
∆©å
 *
löks
 = 
	`∆a_√°_°¨t
(
msg
,

3964 
NL80211_ATTR_MLO_LINKS
);

3966 i‡(!
löks
)

3967 
∆a_put_Áûuª
;

3969 
	`f‹_óch_vÆid_lök
(
wdev
, 
lök_id
) {

3970 
∆©å
 *
lök
 = 
	`∆a_√°_°¨t
(
msg
, 
lök_id
 + 1);

3971 
cfg80211_ch™_def
 
ch™def
 = {};

3972 
ªt
;

3974 i‡(!
lök
)

3975 
∆a_put_Áûuª
;

3977 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MLO_LINK_ID
, 
lök_id
))

3978 
∆a_put_Áûuª
;

3979 i‡(
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
,

3980 
wdev
->
löks
[
lök_id
].
addr
))

3981 
∆a_put_Áûuª
;

3983 
ªt
 = 
	`rdev_gë_ch™√l
(
rdev
, 
wdev
, 
lök_id
, &
ch™def
);

3984 i‡(
ªt
 =0 && 
	`∆80211_£nd_ch™def
(
msg
, &
ch™def
))

3985 
∆a_put_Áûuª
;

3987 
	`∆a_√°_íd
(
msg
, 
lök
);

3990 
	`∆a_√°_íd
(
msg
, 
löks
);

3993 
	`gílmsg_íd
(
msg
, 
hdr
);

3996 
∆a_put_Áûuª
:

3997 
	`gílmsg_ˇn˚l
(
msg
, 
hdr
);

3998  -
EMSGSIZE
;

3999 
	}
}

4001 
	$∆80211_dump_öãrÁ˚
(
sk_buff
 *
skb
, 
√éök_ˇŒback
 *
cb
)

4003 
wp_idx
 = 0;

4004 
if_idx
 = 0;

4005 
wp_°¨t
 = 
cb
->
¨gs
[0];

4006 
if_°¨t
 = 
cb
->
¨gs
[1];

4007 
fûãr_wùhy
 = -1;

4008 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

4009 
wúñess_dev
 *
wdev
;

4010 
ªt
;

4012 
	`π∆_lock
();

4013 i‡(!
cb
->
¨gs
[2]) {

4014 
∆80211_dump_wùhy_°©e
 
°©e
 = {

4015 .
fûãr_wùhy
 = -1,

4018 
ªt
 = 
	`∆80211_dump_wùhy_∑r£
(
skb
, 
cb
, &
°©e
);

4019 i‡(
ªt
)

4020 
out_u∆ock
;

4022 
fûãr_wùhy
 = 
°©e
.filter_wiphy;

4028 i‡(
fûãr_wùhy
 >= 0)

4029 
cb
->
¨gs
[2] = 
fûãr_wùhy
 + 1;

4031 
cb
->
¨gs
[2] = -1;

4032 } i‡(
cb
->
¨gs
[2] > 0) {

4033 
fûãr_wùhy
 = 
cb
->
¨gs
[2] - 1;

4036 
	`f‹_óch_rdev
(
rdev
) {

4037 i‡(!
	`√t_eq
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
	`sock_√t
(
skb
->
sk
)))

4039 i‡(
wp_idx
 < 
wp_°¨t
) {

4040 
wp_idx
++;

4044 i‡(
fûãr_wùhy
 >0 && fûãr_wùhy !
rdev
->
wùhy_idx
)

4047 
if_idx
 = 0;

4049 
	`wùhy_lock
(&
rdev
->
wùhy
);

4050 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

4051 i‡(
if_idx
 < 
if_°¨t
) {

4052 
if_idx
++;

4055 i‡(
	`∆80211_£nd_iÁ˚
(
skb
, 
	`NETLINK_CB
(
cb
->skb).
p‹tid
,

4056 
cb
->
∆h
->
∆msg_£q
, 
NLM_F_MULTI
,

4057 
rdev
, 
wdev
,

4058 
NL80211_CMD_NEW_INTERFACE
) < 0) {

4059 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

4060 
out
;

4062 
if_idx
++;

4064 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

4066 
if_°¨t
 = 0;

4067 
wp_idx
++;

4069 
out
:

4070 
cb
->
¨gs
[0] = 
wp_idx
;

4071 
cb
->
¨gs
[1] = 
if_idx
;

4073 
ªt
 = 
skb
->
Àn
;

4074 
out_u∆ock
:

4075 
	`π∆_u∆ock
();

4077  
ªt
;

4078 
	}
}

4080 
	$∆80211_gë_öãrÁ˚
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

4082 
sk_buff
 *
msg
;

4083 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

4084 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

4086 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

4088 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

4089 i‡(!
msg
) {

4090 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4091  -
ENOMEM
;

4094 i‡(
	`∆80211_£nd_iÁ˚
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

4095 
rdev
, 
wdev
, 
NL80211_CMD_NEW_INTERFACE
) < 0) {

4096 
	`∆msg_‰ì
(
msg
);

4097 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4098  -
ENOBUFS
;

4101 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

4102  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

4103 
	}
}

4105 c⁄° 
∆a_pﬁicy
 
	gm¡r_Êags_pﬁicy
[
NL80211_MNTR_FLAG_MAX
 + 1] = {

4106 [
NL80211_MNTR_FLAG_FCSFAIL
] = { .
ty≥
 = 
NLA_FLAG
 },

4107 [
NL80211_MNTR_FLAG_PLCPFAIL
] = { .
ty≥
 = 
NLA_FLAG
 },

4108 [
NL80211_MNTR_FLAG_CONTROL
] = { .
ty≥
 = 
NLA_FLAG
 },

4109 [
NL80211_MNTR_FLAG_OTHER_BSS
] = { .
ty≥
 = 
NLA_FLAG
 },

4110 [
NL80211_MNTR_FLAG_COOK_FRAMES
] = { .
ty≥
 = 
NLA_FLAG
 },

4111 [
NL80211_MNTR_FLAG_ACTIVE
] = { .
ty≥
 = 
NLA_FLAG
 },

4114 
	$∑r£_m⁄ô‹_Êags
(
∆©å
 *
∆a
, 
u32
 *
m¡rÊags
)

4116 
∆©å
 *
Êags
[
NL80211_MNTR_FLAG_MAX
 + 1];

4117 
Êag
;

4119 *
m¡rÊags
 = 0;

4121 i‡(!
∆a
)

4122  -
EINVAL
;

4124 i‡(
	`∆a_∑r£_√°ed_dïªˇãd
(
Êags
, 
NL80211_MNTR_FLAG_MAX
, 
∆a
, 
m¡r_Êags_pﬁicy
, 
NULL
))

4125  -
EINVAL
;

4127 
Êag
 = 1; fœg <
NL80211_MNTR_FLAG_MAX
; flag++)

4128 i‡(
Êags
[
Êag
])

4129 *
m¡rÊags
 |(1<<
Êag
);

4131 *
m¡rÊags
 |
MONITOR_FLAG_CHANGED
;

4134 
	}
}

4136 
	$∆80211_∑r£_m⁄_›ti⁄s
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

4137 
∆80211_i·y≥
 
ty≥
,

4138 
gíl_öfo
 *
öfo
,

4139 
vif_∑øms
 *
∑øms
)

4141 
boﬁ
 
ch™ge
 = 
Ál£
;

4142 
îr
;

4144 i‡(
öfo
->
©ås
[
NL80211_ATTR_MNTR_FLAGS
]) {

4145 i‡(
ty≥
 !
NL80211_IFTYPE_MONITOR
)

4146  -
EINVAL
;

4148 
îr
 = 
	`∑r£_m⁄ô‹_Êags
(
öfo
->
©ås
[
NL80211_ATTR_MNTR_FLAGS
],

4149 &
∑øms
->
Êags
);

4150 i‡(
îr
)

4151  
îr
;

4153 
ch™ge
 = 
åue
;

4156 i‡(
∑øms
->
Êags
 & 
MONITOR_FLAG_ACTIVE
 &&

4157 !(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_ACTIVE_MONITOR
))

4158  -
EOPNOTSUPP
;

4160 i‡(
öfo
->
©ås
[
NL80211_ATTR_MU_MIMO_GROUP_DATA
]) {

4161 c⁄° 
u8
 *
mumimo_groups
;

4162 
u32
 
ˇp_Êag
 = 
NL80211_EXT_FEATURE_MU_MIMO_AIR_SNIFFER
;

4164 i‡(
ty≥
 !
NL80211_IFTYPE_MONITOR
)

4165  -
EINVAL
;

4167 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
, 
ˇp_Êag
))

4168  -
EOPNOTSUPP
;

4170 
mumimo_groups
 =

4171 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MU_MIMO_GROUP_DATA
]);

4174 i‡((
mumimo_groups
[0] & 
	`BIT
(0)) ||

4175 (
mumimo_groups
[
VHT_MUMIMO_GROUPS_DATA_LEN
 - 1] & 
	`BIT
(7)))

4176  -
EINVAL
;

4178 
∑øms
->
vht_mumimo_groups
 = 
mumimo_groups
;

4179 
ch™ge
 = 
åue
;

4182 i‡(
öfo
->
©ås
[
NL80211_ATTR_MU_MIMO_FOLLOW_MAC_ADDR
]) {

4183 
u32
 
ˇp_Êag
 = 
NL80211_EXT_FEATURE_MU_MIMO_AIR_SNIFFER
;

4185 i‡(
ty≥
 !
NL80211_IFTYPE_MONITOR
)

4186  -
EINVAL
;

4188 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
, 
ˇp_Êag
))

4189  -
EOPNOTSUPP
;

4191 
∑øms
->
vht_mumimo_fﬁlow_addr
 =

4192 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MU_MIMO_FOLLOW_MAC_ADDR
]);

4193 
ch™ge
 = 
åue
;

4196  
ch™ge
 ? 1 : 0;

4197 
	}
}

4199 
	$∆80211_vÆid_4addr
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

4200 
√t_devi˚
 *
√tdev
, 
u8
 
u£_4addr
,

4201 
∆80211_i·y≥
 
i·y≥
)

4203 i‡(!
u£_4addr
) {

4204 i‡(
√tdev
 && 
	`√tif_is_bridge_p‹t
(netdev))

4205  -
EBUSY
;

4209 
i·y≥
) {

4210 
NL80211_IFTYPE_AP_VLAN
:

4211 i‡(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_4ADDR_AP
)

4214 
NL80211_IFTYPE_STATION
:

4215 i‡(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_4ADDR_STATION
)

4222  -
EOPNOTSUPP
;

4223 
	}
}

4225 
	$∆80211_£t_öãrÁ˚
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

4227 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

4228 
vif_∑øms
 
∑øms
;

4229 
îr
;

4230 
∆80211_i·y≥
 
Ÿy≥
, 
¡y≥
;

4231 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

4232 
boﬁ
 
ch™ge
 = 
Ál£
;

4234 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

4236 
	`mem£t
(&
∑øms
, 0, (params));

4238 
Ÿy≥
 = 
¡y≥
 = 
dev
->
õì80211_±r
->
i·y≥
;

4240 i‡(
öfo
->
©ås
[
NL80211_ATTR_IFTYPE
]) {

4241 
¡y≥
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_IFTYPE
]);

4242 i‡(
Ÿy≥
 !
¡y≥
)

4243 
ch™ge
 = 
åue
;

4246 i‡(
öfo
->
©ås
[
NL80211_ATTR_MESH_ID
]) {

4247 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

4249 i‡(
¡y≥
 !
NL80211_IFTYPE_MESH_POINT
) {

4250 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4251  -
EINVAL
;

4253 i‡(
Ÿy≥
 !
NL80211_IFTYPE_MESH_POINT
) {

4254 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4255  -
EINVAL
;

4257 i‡(
	`√tif_ru¬ög
(
dev
)) {

4258 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4259  -
EBUSY
;

4262 
wdev
->
u
.
mesh
.
id_up_Àn
 =

4263 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_MESH_ID
]);

4264 
	`mem˝y
(
wdev
->
u
.
mesh
.
id
,

4265 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MESH_ID
]),

4266 
wdev
->
u
.
mesh
.
id_up_Àn
);

4269 i‡(
öfo
->
©ås
[
NL80211_ATTR_4ADDR
]) {

4270 
∑øms
.
u£_4addr
 = !!
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_4ADDR
]);

4271 
ch™ge
 = 
åue
;

4272 
îr
 = 
	`∆80211_vÆid_4addr
(
rdev
, 
dev
, 
∑øms
.
u£_4addr
, 
¡y≥
);

4273 i‡(
îr
) {

4274 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4275  
îr
;

4278 
∑øms
.
u£_4addr
 = -1;

4281 
îr
 = 
	`∆80211_∑r£_m⁄_›ti⁄s
(
rdev
, 
¡y≥
, 
öfo
, &
∑øms
);

4282 i‡(
îr
 < 0) {

4283 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4284  
îr
;

4286 i‡(
îr
 > 0)

4287 
ch™ge
 = 
åue
;

4289 i‡(
ch™ge
)

4290 
îr
 = 
	`cfg80211_ch™ge_iÁ˚
(
rdev
, 
dev
, 
¡y≥
, &
∑øms
);

4292 
îr
 = 0;

4294 i‡(!
îr
 && 
∑øms
.
u£_4addr
 != -1)

4295 
dev
->
õì80211_±r
->
u£_4addr
 = 
∑øms
.use_4addr;

4297 i‡(
ch™ge
 && !
îr
) {

4298 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

4300 
	`∆80211_nŸify_iÁ˚
(
rdev
, 
wdev
, 
NL80211_CMD_SET_INTERFACE
);

4303 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

4304  
îr
;

4305 
	}
}

4307 
	$_∆80211_√w_öãrÁ˚
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

4309 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

4310 
vif_∑øms
 
∑øms
;

4311 
wúñess_dev
 *
wdev
;

4312 
sk_buff
 *
msg
;

4313 
îr
;

4314 
∆80211_i·y≥
 
ty≥
 = 
NL80211_IFTYPE_UNSPECIFIED
;

4316 
	`mem£t
(&
∑øms
, 0, (params));

4318 i‡(!
öfo
->
©ås
[
NL80211_ATTR_IFNAME
])

4319  -
EINVAL
;

4321 i‡(
öfo
->
©ås
[
NL80211_ATTR_IFTYPE
])

4322 
ty≥
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_IFTYPE
]);

4324 i‡(!
rdev
->
›s
->
add_vútuÆ_ötf
)

4325  -
EOPNOTSUPP
;

4327 i‡((
ty≥
 =
NL80211_IFTYPE_P2P_DEVICE
 ||Åy≥ =
NL80211_IFTYPE_NAN
 ||

4328 
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_MAC_ON_CREATE
) &&

4329 
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

4330 
	`∆a_mem˝y
(
∑øms
.
maˇddr
, 
öfo
->
©ås
[
NL80211_ATTR_MAC
],

4331 
ETH_ALEN
);

4332 i‡(!
	`is_vÆid_ëhî_addr
(
∑øms
.
maˇddr
))

4333  -
EADDRNOTAVAIL
;

4336 i‡(
öfo
->
©ås
[
NL80211_ATTR_4ADDR
]) {

4337 
∑øms
.
u£_4addr
 = !!
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_4ADDR
]);

4338 
îr
 = 
	`∆80211_vÆid_4addr
(
rdev
, 
NULL
, 
∑øms
.
u£_4addr
, 
ty≥
);

4339 i‡(
îr
)

4340  
îr
;

4343 i‡(!
	`cfg80211_i·y≥_Ælowed
(&
rdev
->
wùhy
, 
ty≥
, 
∑øms
.
u£_4addr
, 0))

4344  -
EOPNOTSUPP
;

4346 
îr
 = 
	`∆80211_∑r£_m⁄_›ti⁄s
(
rdev
, 
ty≥
, 
öfo
, &
∑øms
);

4347 i‡(
îr
 < 0)

4348  
îr
;

4350 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

4351 i‡(!
msg
)

4352  -
ENOMEM
;

4354 
wdev
 = 
	`rdev_add_vútuÆ_ötf
(
rdev
,

4355 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IFNAME
]),

4356 
NET_NAME_USER
, 
ty≥
, &
∑øms
);

4357 i‡(
	`WARN_ON
(!
wdev
)) {

4358 
	`∆msg_‰ì
(
msg
);

4359  -
EPROTO
;

4360 } i‡(
	`IS_ERR
(
wdev
)) {

4361 
	`∆msg_‰ì
(
msg
);

4362  
	`PTR_ERR
(
wdev
);

4365 i‡(
öfo
->
©ås
[
NL80211_ATTR_SOCKET_OWNER
])

4366 
wdev
->
ow√r_∆p‹tid
 = 
öfo
->
¢d_p‹tid
;

4368 
ty≥
) {

4369 
NL80211_IFTYPE_MESH_POINT
:

4370 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MESH_ID
])

4372 
wdev
->
u
.
mesh
.
id_up_Àn
 =

4373 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_MESH_ID
]);

4374 
	`mem˝y
(
wdev
->
u
.
mesh
.
id
,

4375 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MESH_ID
]),

4376 
wdev
->
u
.
mesh
.
id_up_Àn
);

4378 
NL80211_IFTYPE_NAN
:

4379 
NL80211_IFTYPE_P2P_DEVICE
:

4384 
	`cfg80211_öô_wdev
(
wdev
);

4385 
	`cfg80211_ªgi°î_wdev
(
rdev
, 
wdev
);

4391 i‡(
	`∆80211_£nd_iÁ˚
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

4392 
rdev
, 
wdev
, 
NL80211_CMD_NEW_INTERFACE
) < 0) {

4393 
	`∆msg_‰ì
(
msg
);

4394  -
ENOBUFS
;

4397  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

4398 
	}
}

4400 
	$∆80211_√w_öãrÁ˚
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

4402 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

4403 
ªt
;

4405 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

4408 
	`cfg80211_de°roy_iÁ˚s
(
rdev
);

4410 
	`wùhy_lock
(&
rdev
->
wùhy
);

4411 
ªt
 = 
	`_∆80211_√w_öãrÁ˚
(
skb
, 
öfo
);

4412 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

4414 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

4415  
ªt
;

4416 
	}
}

4418 
	$∆80211_dñ_öãrÁ˚
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

4420 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

4421 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

4423 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

4425 i‡(!
rdev
->
›s
->
dñ_vútuÆ_ötf
) {

4426 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4427  -
EOPNOTSUPP
;

4439 
	`muãx_u∆ock
(&
rdev
->
wùhy
.
mtx
);

4448 i‡(!
wdev
->
√tdev
)

4449 
öfo
->
u£r_±r
[1] = 
NULL
;

4451 
	`dev_˛o£
(
wdev
->
√tdev
);

4453 
	`muãx_lock
(&
rdev
->
wùhy
.
mtx
);

4455 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4456  
	`cfg80211_ªmove_vútuÆ_ötf
(
rdev
, 
wdev
);

4457 
	}
}

4459 
	$∆80211_£t_nﬂck_m≠
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

4461 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

4462 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

4463 
u16
 
nﬂck_m≠
;

4465 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

4467 i‡(!
öfo
->
©ås
[
NL80211_ATTR_NOACK_MAP
]) {

4468 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4469  -
EINVAL
;

4472 i‡(!
rdev
->
›s
->
£t_nﬂck_m≠
) {

4473 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4474  -
EOPNOTSUPP
;

4477 
nﬂck_m≠
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_NOACK_MAP
]);

4479 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4480  
	`rdev_£t_nﬂck_m≠
(
rdev
, 
dev
, 
nﬂck_m≠
);

4481 
	}
}

4483 
	$∆80211_vÆid©e_key_lök_id
(
gíl_öfo
 *
öfo
,

4484 
wúñess_dev
 *
wdev
,

4485 
lök_id
, 
boﬁ
 
∑úwi£
)

4487 i‡(
∑úwi£
) {

4488 i‡(
lök_id
 != -1) {

4489 
	`GENL_SET_ERR_MSG
(
öfo
,

4491  -
EINVAL
;

4497 i‡(
wdev
->
vÆid_löks
) {

4498 i‡(
lök_id
 == -1) {

4499 
	`GENL_SET_ERR_MSG
(
öfo
,

4501  -
EINVAL
;

4503 i‡(!(
wdev
->
vÆid_löks
 & 
	`BIT
(
lök_id
))) {

4504 
	`GENL_SET_ERR_MSG
(
öfo
, "invalidÜink ID for MLO group key");

4505  -
EINVAL
;

4507 } i‡(
lök_id
 != -1) {

4508 
	`GENL_SET_ERR_MSG
(
öfo
, "link IDÇotállowed forÇon-MLO group key");

4509  -
EINVAL
;

4513 
	}
}

4515 
	sgë_key_cookõ
 {

4516 
sk_buff
 *
	mmsg
;

4517 
	mîr‹
;

4518 
	midx
;

4521 
	$gë_key_ˇŒback
(*
c
, 
key_∑øms
 *
∑øms
)

4523 
∆©å
 *
key
;

4524 
gë_key_cookõ
 *
cookõ
 = 
c
;

4526 i‡((
∑øms
->
key
 &&

4527 
	`∆a_put
(
cookõ
->
msg
, 
NL80211_ATTR_KEY_DATA
,

4528 
∑øms
->
key_Àn
,Ö¨ams->
key
)) ||

4529 (
∑øms
->
£q
 &&

4530 
	`∆a_put
(
cookõ
->
msg
, 
NL80211_ATTR_KEY_SEQ
,

4531 
∑øms
->
£q_Àn
,Ö¨ams->
£q
)) ||

4532 (
∑øms
->
cùhî
 &&

4533 
	`∆a_put_u32
(
cookõ
->
msg
, 
NL80211_ATTR_KEY_CIPHER
,

4534 
∑øms
->
cùhî
)))

4535 
∆a_put_Áûuª
;

4537 
key
 = 
	`∆a_√°_°¨t_noÊag
(
cookõ
->
msg
, 
NL80211_ATTR_KEY
);

4538 i‡(!
key
)

4539 
∆a_put_Áûuª
;

4541 i‡((
∑øms
->
key
 &&

4542 
	`∆a_put
(
cookõ
->
msg
, 
NL80211_KEY_DATA
,

4543 
∑øms
->
key_Àn
,Ö¨ams->
key
)) ||

4544 (
∑øms
->
£q
 &&

4545 
	`∆a_put
(
cookõ
->
msg
, 
NL80211_KEY_SEQ
,

4546 
∑øms
->
£q_Àn
,Ö¨ams->
£q
)) ||

4547 (
∑øms
->
cùhî
 &&

4548 
	`∆a_put_u32
(
cookõ
->
msg
, 
NL80211_KEY_CIPHER
,

4549 
∑øms
->
cùhî
)))

4550 
∆a_put_Áûuª
;

4552 i‡(
	`∆a_put_u8
(
cookõ
->
msg
, 
NL80211_KEY_IDX
, cookõ->
idx
))

4553 
∆a_put_Áûuª
;

4555 
	`∆a_√°_íd
(
cookõ
->
msg
, 
key
);

4558 
∆a_put_Áûuª
:

4559 
cookõ
->
îr‹
 = 1;

4560 
	}
}

4562 
	$∆80211_gë_key
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

4564 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

4565 
îr
;

4566 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

4567 
u8
 
key_idx
 = 0;

4568 c⁄° 
u8
 *
mac_addr
 = 
NULL
;

4569 
boﬁ
 
∑úwi£
;

4570 
gë_key_cookõ
 
cookõ
 = {

4571 .
îr‹
 = 0,

4573 *
hdr
;

4574 
sk_buff
 *
msg
;

4575 
boﬁ
 
bigtk_suµ‹t
 = 
Ál£
;

4576 
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

4577 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

4579 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

4581 i‡(
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

4582 
NL80211_EXT_FEATURE_BEACON_PROTECTION
))

4583 
bigtk_suµ‹t
 = 
åue
;

4585 i‡((
wdev
->
i·y≥
 =
NL80211_IFTYPE_STATION
 ||

4586 
wdev
->
i·y≥
 =
NL80211_IFTYPE_P2P_CLIENT
) &&

4587 
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

4588 
NL80211_EXT_FEATURE_BEACON_PROTECTION_CLIENT
))

4589 
bigtk_suµ‹t
 = 
åue
;

4591 i‡(
öfo
->
©ås
[
NL80211_ATTR_KEY_IDX
]) {

4592 
key_idx
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_KEY_IDX
]);

4594 i‡(
key_idx
 >6 && key_idx <7 && !
bigtk_suµ‹t
) {

4595 
	`GENL_SET_ERR_MSG
(
öfo
, "BIGTKÇot supported");

4596 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4597  -
EINVAL
;

4601 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
])

4602 
mac_addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

4604 
∑úwi£
 = !!
mac_addr
;

4605 i‡(
öfo
->
©ås
[
NL80211_ATTR_KEY_TYPE
]) {

4606 
u32
 
kt
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_KEY_TYPE
]);

4608 i‡(
kt
 !
NL80211_KEYTYPE_GROUP
 &&

4609 
kt
 !
NL80211_KEYTYPE_PAIRWISE
) {

4610 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4611  -
EINVAL
;

4613 
∑úwi£
 = 
kt
 =
NL80211_KEYTYPE_PAIRWISE
;

4616 i‡(!
rdev
->
›s
->
gë_key
) {

4617 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4618  -
EOPNOTSUPP
;

4621 i‡(!
∑úwi£
 && 
mac_addr
 && !(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_IBSS_RSN
)) {

4622 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4623  -
ENOENT
;

4626 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

4627 i‡(!
msg
) {

4628 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4629  -
ENOMEM
;

4632 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

4633 
NL80211_CMD_NEW_KEY
);

4634 i‡(!
hdr
) {

4635 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4636 
∆a_put_Áûuª
;

4639 
cookõ
.
msg
 = msg;

4640 
cookõ
.
idx
 = 
key_idx
;

4642 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

4643 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_KEY_IDX
, 
key_idx
)) {

4644 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4645 
∆a_put_Áûuª
;

4647 i‡(
mac_addr
 &&

4648 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
mac_addr
)) {

4649 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4650 
∆a_put_Áûuª
;

4653 
îr
 = 
	`∆80211_vÆid©e_key_lök_id
(
öfo
, 
wdev
, 
lök_id
, 
∑úwi£
);

4654 i‡(
îr
) {

4655 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4656 
‰ì_msg
;

4659 
îr
 = 
	`rdev_gë_key
(
rdev
, 
dev
, 
lök_id
, 
key_idx
, 
∑úwi£
, 
mac_addr
,

4660 &
cookõ
, 
gë_key_ˇŒback
);

4662 i‡(
îr
) {

4663 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4664 
‰ì_msg
;

4667 i‡(
cookõ
.
îr‹
) {

4668 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4669 
∆a_put_Áûuª
;

4672 
	`gílmsg_íd
(
msg
, 
hdr
);

4673 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4674  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

4676 
∆a_put_Áûuª
:

4677 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4678 
îr
 = -
ENOBUFS
;

4679 
‰ì_msg
:

4680 
	`∆msg_‰ì
(
msg
);

4681 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4682  
îr
;

4683 
	}
}

4685 
	$∆80211_£t_key
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

4687 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

4688 
key_∑r£
 
key
;

4689 
îr
;

4690 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

4691 
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

4692 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

4694 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

4696 
îr
 = 
	`∆80211_∑r£_key
(
öfo
, &
key
);

4697 i‡(
îr
) {

4698 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4699  
îr
;

4702 i‡(
key
.
idx
 < 0) {

4703 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4704  -
EINVAL
;

4710 i‡(!
key
.
def
 && !key.
defmgmt
 && !key.
defbóc⁄
 &&

4711 !(
key
.
p
.
mode
 =
NL80211_KEY_SET_TX
)) {

4712 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4713  -
EINVAL
;

4716 i‡(
key
.
def
) {

4717 i‡(!
rdev
->
›s
->
£t_deÁu…_key
) {

4718 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4719  -
EOPNOTSUPP
;

4722 
îr
 = 
	`∆80211_key_Ælowed
(
wdev
);

4723 i‡(
îr
) {

4724 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4725  
îr
;

4728 
îr
 = 
	`∆80211_vÆid©e_key_lök_id
(
öfo
, 
wdev
, 
lök_id
, 
Ál£
);

4729 i‡(
îr
) {

4730 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4731  
îr
;

4734 
îr
 = 
	`rdev_£t_deÁu…_key
(
rdev
, 
dev
, 
lök_id
, 
key
.
idx
,

4735 
key
.
def_uni
, key.
def_mu…i
);

4737 i‡(
îr
) {

4738 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4739  
îr
;

4742 #ifde‡
CONFIG_CFG80211_WEXT


4743 
wdev
->
wext
.
deÁu…_key
 = 
key
.
idx
;

4745 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4747 } i‡(
key
.
defmgmt
) {

4748 i‡(
key
.
def_uni
 || !key.
def_mu…i
) {

4749 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4750  -
EINVAL
;

4753 i‡(!
rdev
->
›s
->
£t_deÁu…_mgmt_key
) {

4754 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4755  -
EOPNOTSUPP
;

4758 
îr
 = 
	`∆80211_key_Ælowed
(
wdev
);

4759 i‡(
îr
) {

4760 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4761  
îr
;

4764 
îr
 = 
	`∆80211_vÆid©e_key_lök_id
(
öfo
, 
wdev
, 
lök_id
, 
Ál£
);

4765 i‡(
îr
) {

4766 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4767  
îr
;

4770 
îr
 = 
	`rdev_£t_deÁu…_mgmt_key
(
rdev
, 
dev
, 
lök_id
, 
key
.
idx
);

4771 i‡(
îr
) {

4772 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4773  
îr
;

4776 #ifde‡
CONFIG_CFG80211_WEXT


4777 
wdev
->
wext
.
deÁu…_mgmt_key
 = 
key
.
idx
;

4779 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4781 } i‡(
key
.
defbóc⁄
) {

4782 i‡(
key
.
def_uni
 || !key.
def_mu…i
) {

4783 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4784  -
EINVAL
;

4787 i‡(!
rdev
->
›s
->
£t_deÁu…_bóc⁄_key
) {

4788 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4789  -
EOPNOTSUPP
;

4792 
îr
 = 
	`∆80211_key_Ælowed
(
wdev
);

4793 i‡(
îr
) {

4794 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4795  
îr
;

4798 
îr
 = 
	`∆80211_vÆid©e_key_lök_id
(
öfo
, 
wdev
, 
lök_id
, 
Ál£
);

4799 i‡(
îr
) {

4800 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4801  
îr
;

4804 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4805  
	`rdev_£t_deÁu…_bóc⁄_key
(
rdev
, 
dev
, 
lök_id
, 
key
.
idx
);

4806 } i‡(
key
.
p
.
mode
 =
NL80211_KEY_SET_TX
 &&

4807 
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

4808 
NL80211_EXT_FEATURE_EXT_KEY_ID
)) {

4809 
u8
 *
mac_addr
 = 
NULL
;

4811 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
])

4812 
mac_addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

4814 i‡(!
mac_addr
 || 
key
.
idx
 < 0 || key.idx > 1) {

4815 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4816  -
EINVAL
;

4819 
îr
 = 
	`∆80211_vÆid©e_key_lök_id
(
öfo
, 
wdev
, 
lök_id
, 
åue
);

4820 i‡(
îr
) {

4821 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4822  
îr
;

4825 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4826  
	`rdev_add_key
(
rdev
, 
dev
, 
lök_id
, 
key
.
idx
,

4827 
NL80211_KEYTYPE_PAIRWISE
,

4828 
mac_addr
, &
key
.
p
);

4831 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4832  -
EINVAL
;

4833 
	}
}

4835 
	$∆80211_√w_key
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

4837 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

4838 
îr
;

4839 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

4840 
key_∑r£
 
key
;

4841 c⁄° 
u8
 *
mac_addr
 = 
NULL
;

4842 
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

4843 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

4845 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

4847 
îr
 = 
	`∆80211_∑r£_key
(
öfo
, &
key
);

4848 i‡(
îr
) {

4849 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4850  
îr
;

4853 i‡(!
key
.
p
.key) {

4854 
	`GENL_SET_ERR_MSG
(
öfo
, "no key");

4855 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4856  -
EINVAL
;

4859 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
])

4860 
mac_addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

4862 i‡(
key
.
ty≥
 == -1) {

4863 i‡(
mac_addr
)

4864 
key
.
ty≥
 = 
NL80211_KEYTYPE_PAIRWISE
;

4866 
key
.
ty≥
 = 
NL80211_KEYTYPE_GROUP
;

4870 i‡(
key
.
ty≥
 !
NL80211_KEYTYPE_PAIRWISE
 &&

4871 
key
.
ty≥
 !
NL80211_KEYTYPE_GROUP
) {

4872 
	`GENL_SET_ERR_MSG
(
öfo
, "keyÅypeÇotÖairwise or group");

4873 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4874  -
EINVAL
;

4877 i‡(
key
.
ty≥
 =
NL80211_KEYTYPE_GROUP
 &&

4878 
öfo
->
©ås
[
NL80211_ATTR_VLAN_ID
])

4879 
key
.
p
.
vœn_id
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_VLAN_ID
]);

4881 i‡(!
rdev
->
›s
->
add_key
) {

4882 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4883  -
EOPNOTSUPP
;

4886 i‡(
	`cfg80211_vÆid©e_key_£âögs
(
rdev
, &
key
.
p
, key.
idx
,

4887 
key
.
ty≥
 =
NL80211_KEYTYPE_PAIRWISE
,

4888 
mac_addr
)) {

4889 
	`GENL_SET_ERR_MSG
(
öfo
, "key setting validation failed");

4890  -
EINVAL
;

4893 
îr
 = 
	`∆80211_key_Ælowed
(
wdev
);

4894 i‡(
îr
)

4895 
	`GENL_SET_ERR_MSG
(
öfo
, "keyÇotállowed");

4897 i‡(!
îr
)

4898 
îr
 = 
	`∆80211_vÆid©e_key_lök_id
(
öfo
, 
wdev
, 
lök_id
,

4899 
key
.
ty≥
 =
NL80211_KEYTYPE_PAIRWISE
);

4901 i‡(!
îr
) {

4902 
îr
 = 
	`rdev_add_key
(
rdev
, 
dev
, 
lök_id
, 
key
.
idx
,

4903 
key
.
ty≥
 =
NL80211_KEYTYPE_PAIRWISE
,

4904 
mac_addr
, &
key
.
p
);

4905 i‡(
îr
)

4906 
	`GENL_SET_ERR_MSG
(
öfo
, "keyáddition failed");

4909 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

4910  
îr
;

4911 
	}
}

4913 
	$∆80211_dñ_key
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

4915 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

4916 
îr
;

4917 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

4918 
u8
 *
mac_addr
 = 
NULL
;

4919 
key_∑r£
 
key
;

4920 
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

4921 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

4923 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

4925 
îr
 = 
	`∆80211_∑r£_key
(
öfo
, &
key
);

4926 i‡(
îr
) {

4927 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4928  
îr
;

4931 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
])

4932 
mac_addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

4934 i‡(
key
.
ty≥
 == -1) {

4935 i‡(
mac_addr
)

4936 
key
.
ty≥
 = 
NL80211_KEYTYPE_PAIRWISE
;

4938 
key
.
ty≥
 = 
NL80211_KEYTYPE_GROUP
;

4942 i‡(
key
.
ty≥
 !
NL80211_KEYTYPE_PAIRWISE
 &&

4943 
key
.
ty≥
 !
NL80211_KEYTYPE_GROUP
) {

4944 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4945  -
EINVAL
;

4948 i‡(!
	`cfg80211_vÆid_key_idx
(
rdev
, 
key
.
idx
,

4949 
key
.
ty≥
 =
NL80211_KEYTYPE_PAIRWISE
)) {

4950 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4951  -
EINVAL
;

4954 i‡(!
rdev
->
›s
->
dñ_key
) {

4955 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

4956  -
EOPNOTSUPP
;

4959 
îr
 = 
	`∆80211_key_Ælowed
(
wdev
);

4961 i‡(
key
.
ty≥
 =
NL80211_KEYTYPE_GROUP
 && 
mac_addr
 &&

4962 !(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_IBSS_RSN
))

4963 
îr
 = -
ENOENT
;

4965 i‡(!
îr
)

4966 
îr
 = 
	`∆80211_vÆid©e_key_lök_id
(
öfo
, 
wdev
, 
lök_id
,

4967 
key
.
ty≥
 =
NL80211_KEYTYPE_PAIRWISE
);

4969 i‡(!
îr
)

4970 
îr
 = 
	`rdev_dñ_key
(
rdev
, 
dev
, 
lök_id
, 
key
.
idx
,

4971 
key
.
ty≥
 =
NL80211_KEYTYPE_PAIRWISE
,

4972 
mac_addr
);

4974 #ifde‡
CONFIG_CFG80211_WEXT


4975 i‡(!
îr
) {

4976 i‡(
key
.
idx
 =
wdev
->
wext
.
deÁu…_key
)

4977 
wdev
->
wext
.
deÁu…_key
 = -1;

4978 i‡(
key
.
idx
 =
wdev
->
wext
.
deÁu…_mgmt_key
)

4979 
wdev
->
wext
.
deÁu…_mgmt_key
 = -1;

4983 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

4984  
îr
;

4985 
	}
}

4988 
	$vÆid©e_a˛_mac_addrs
(
∆©å
 *
∆_©å
)

4990 
∆©å
 *
©å
;

4991 
n_íåõs
 = 0, 
tmp
;

4993 
	`∆a_f‹_óch_√°ed
(
©å
, 
∆_©å
, 
tmp
) {

4994 i‡(
	`∆a_Àn
(
©å
Ë!
ETH_ALEN
)

4995  -
EINVAL
;

4997 
n_íåõs
++;

5000  
n_íåõs
;

5001 
	}
}

5008 
cfg80211_a˛_d©a
 *
	$∑r£_a˛_d©a
(
wùhy
 *wiphy,

5009 
gíl_öfo
 *
öfo
)

5011 
∆80211_a˛_pﬁicy
 
a˛_pﬁicy
;

5012 
∆©å
 *
©å
;

5013 
cfg80211_a˛_d©a
 *
a˛
;

5014 
i
 = 0, 
n_íåõs
, 
tmp
;

5016 i‡(!
wùhy
->
max_a˛_mac_addrs
)

5017  
	`ERR_PTR
(-
EOPNOTSUPP
);

5019 i‡(!
öfo
->
©ås
[
NL80211_ATTR_ACL_POLICY
])

5020  
	`ERR_PTR
(-
EINVAL
);

5022 
a˛_pﬁicy
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_ACL_POLICY
]);

5023 i‡(
a˛_pﬁicy
 !
NL80211_ACL_POLICY_ACCEPT_UNLESS_LISTED
 &&

5024 
a˛_pﬁicy
 !
NL80211_ACL_POLICY_DENY_UNLESS_LISTED
)

5025  
	`ERR_PTR
(-
EINVAL
);

5027 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC_ADDRS
])

5028  
	`ERR_PTR
(-
EINVAL
);

5030 
n_íåõs
 = 
	`vÆid©e_a˛_mac_addrs
(
öfo
->
©ås
[
NL80211_ATTR_MAC_ADDRS
]);

5031 i‡(
n_íåõs
 < 0)

5032  
	`ERR_PTR
(
n_íåõs
);

5034 i‡(
n_íåõs
 > 
wùhy
->
max_a˛_mac_addrs
)

5035  
	`ERR_PTR
(-
EOPNOTSUPP
);

5037 
a˛
 = 
	`kzÆloc
(
	`°ru˘_size
◊˛, 
mac_addrs
, 
n_íåõs
), 
GFP_KERNEL
);

5038 i‡(!
a˛
)

5039  
	`ERR_PTR
(-
ENOMEM
);

5040 
a˛
->
n_a˛_íåõs
 = 
n_íåõs
;

5042 
	`∆a_f‹_óch_√°ed
(
©å
, 
öfo
->
©ås
[
NL80211_ATTR_MAC_ADDRS
], 
tmp
) {

5043 
	`mem˝y
(
a˛
->
mac_addrs
[
i
].
addr
, 
	`∆a_d©a
(
©å
), 
ETH_ALEN
);

5044 
i
++;

5046 
a˛
->
a˛_pﬁicy
 =ácl_policy;

5048  
a˛
;

5049 
	}
}

5051 
	$∆80211_£t_mac_a˛
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

5053 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

5054 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

5055 
cfg80211_a˛_d©a
 *
a˛
;

5056 
îr
;

5058 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

5060 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

5061 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

5062 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

5063  -
EOPNOTSUPP
;

5066 i‡(!
dev
->
õì80211_±r
->
löks
[0].
≠
.
bóc⁄_öãrvÆ
) {

5067 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

5068  -
EINVAL
;

5071 
a˛
 = 
	`∑r£_a˛_d©a
(&
rdev
->
wùhy
, 
öfo
);

5072 i‡(
	`IS_ERR
(
a˛
)) {

5073 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

5074  
	`PTR_ERR
(
a˛
);

5077 
îr
 = 
	`rdev_£t_mac_a˛
(
rdev
, 
dev
, 
a˛
);

5079 
	`k‰ì
(
a˛
);

5081 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

5082  
îr
;

5083 
	}
}

5085 
u32
 
	$øã£t_to_mask
(
õì80211_suµ‹ãd_b™d
 *
sb™d
,

5086 
u8
 *
øãs
, u8 
øãs_Àn
)

5088 
u8
 
i
;

5089 
u32
 
mask
 = 0;

5091 
i
 = 0; i < 
øãs_Àn
; i++) {

5092 
øã
 = (
øãs
[
i
] & 0x7f) * 5;

5093 
ridx
;

5095 
ridx
 = 0;Ñidx < 
sb™d
->
n_bôøãs
;Ñidx++) {

5096 
õì80211_øã
 *
§©e
 =

5097 &
sb™d
->
bôøãs
[
ridx
];

5098 i‡(
øã
 =
§©e
->
bôøã
) {

5099 
mask
 |1 << 
ridx
;

5103 i‡(
ridx
 =
sb™d
->
n_bôøãs
)

5107  
mask
;

5108 
	}
}

5110 
boﬁ
 
	$ht_øã£t_to_mask
(
õì80211_suµ‹ãd_b™d
 *
sb™d
,

5111 
u8
 *
øãs
, u8 
øãs_Àn
,

5112 
u8
 
mcs
[
IEEE80211_HT_MCS_MASK_LEN
])

5114 
u8
 
i
;

5116 
	`mem£t
(
mcs
, 0, 
IEEE80211_HT_MCS_MASK_LEN
);

5118 
i
 = 0; i < 
øãs_Àn
; i++) {

5119 
ridx
, 
rbô
;

5121 
ridx
 = 
øãs
[
i
] / 8;

5122 
rbô
 = 
	`BIT
(
øãs
[
i
] % 8);

5125 i‡((
ridx
 < 0Ë|| (ridx >
IEEE80211_HT_MCS_MASK_LEN
))

5126  
Ál£
;

5129 
ridx
 = 
	`¨øy_ödex_no•ec
‘idx, 
IEEE80211_HT_MCS_MASK_LEN
);

5130 i‡(
sb™d
->
ht_ˇp
.
mcs
.
rx_mask
[
ridx
] & 
rbô
)

5131 
mcs
[
ridx
] |
rbô
;

5133  
Ál£
;

5136  
åue
;

5137 
	}
}

5139 
u16
 
	$vht_mcs_m≠_to_mcs_mask
(
u8
 
vht_mcs_m≠
)

5141 
u16
 
mcs_mask
 = 0;

5143 
vht_mcs_m≠
) {

5144 
IEEE80211_VHT_MCS_NOT_SUPPORTED
:

5146 
IEEE80211_VHT_MCS_SUPPORT_0_7
:

5147 
mcs_mask
 = 0x00FF;

5149 
IEEE80211_VHT_MCS_SUPPORT_0_8
:

5150 
mcs_mask
 = 0x01FF;

5152 
IEEE80211_VHT_MCS_SUPPORT_0_9
:

5153 
mcs_mask
 = 0x03FF;

5159  
mcs_mask
;

5160 
	}
}

5162 
	$vht_buûd_mcs_mask
(
u16
 
vht_mcs_m≠
,

5163 
u16
 
vht_mcs_mask
[
NL80211_VHT_NSS_MAX
])

5165 
u8
 
nss
;

5167 
nss
 = 0;Çs†< 
NL80211_VHT_NSS_MAX
;Çss++) {

5168 
vht_mcs_mask
[
nss
] = 
	`vht_mcs_m≠_to_mcs_mask
(
vht_mcs_m≠
 & 0x03);

5169 
vht_mcs_m≠
 >>= 2;

5171 
	}
}

5173 
boﬁ
 
	$vht_£t_mcs_mask
(
õì80211_suµ‹ãd_b™d
 *
sb™d
,

5174 
∆80211_txøã_vht
 *
txøã
,

5175 
u16
 
mcs
[
NL80211_VHT_NSS_MAX
])

5177 
u16
 
tx_mcs_m≠
 = 
	`À16_to_˝u
(
sb™d
->
vht_ˇp
.
vht_mcs
.tx_mcs_map);

5178 
u16
 
tx_mcs_mask
[
NL80211_VHT_NSS_MAX
] = {};

5179 
u8
 
i
;

5181 i‡(!
sb™d
->
vht_ˇp
.
vht_suµ‹ãd
)

5182  
Ál£
;

5184 
	`mem£t
(
mcs
, 0, (
u16
Ë* 
NL80211_VHT_NSS_MAX
);

5187 
	`vht_buûd_mcs_mask
(
tx_mcs_m≠
, 
tx_mcs_mask
);

5189 
i
 = 0; i < 
NL80211_VHT_NSS_MAX
; i++) {

5190 i‡((
tx_mcs_mask
[
i
] & 
txøã
->
mcs
[i]) ==Åxrate->mcs[i])

5191 
mcs
[
i
] = 
txøã
->mcs[i];

5193  
Ál£
;

5196  
åue
;

5197 
	}
}

5199 
u16
 
	$he_mcs_m≠_to_mcs_mask
(
u8
 
he_mcs_m≠
)

5201 
he_mcs_m≠
) {

5202 
IEEE80211_HE_MCS_NOT_SUPPORTED
:

5204 
IEEE80211_HE_MCS_SUPPORT_0_7
:

5206 
IEEE80211_HE_MCS_SUPPORT_0_9
:

5208 
IEEE80211_HE_MCS_SUPPORT_0_11
:

5214 
	}
}

5216 
	$he_buûd_mcs_mask
(
u16
 
he_mcs_m≠
,

5217 
u16
 
he_mcs_mask
[
NL80211_HE_NSS_MAX
])

5219 
u8
 
nss
;

5221 
nss
 = 0;Çs†< 
NL80211_HE_NSS_MAX
;Çss++) {

5222 
he_mcs_mask
[
nss
] = 
	`he_mcs_m≠_to_mcs_mask
(
he_mcs_m≠
 & 0x03);

5223 
he_mcs_m≠
 >>= 2;

5225 
	}
}

5227 
u16
 
	$he_gë_txmcsm≠
(
gíl_öfo
 *
öfo
, 
lök_id
,

5228 c⁄° 
õì80211_°a_he_ˇp
 *
he_ˇp
)

5230 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

5231 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

5232 
cfg80211_ch™_def
 *
ch™def
;

5233 
__À16
 
tx_mcs
;

5235 
ch™def
 = 
	`wdev_ch™def
(
wdev
, 
lök_id
);

5236 i‡(!
ch™def
) {

5241  
	`À16_to_˝u
(
he_ˇp
->
he_mcs_nss_suµ
.
tx_mcs_80
);

5244 
ch™def
->
width
) {

5245 
NL80211_CHAN_WIDTH_80P80
:

5246 
tx_mcs
 = 
he_ˇp
->
he_mcs_nss_suµ
.
tx_mcs_80p80
;

5248 
NL80211_CHAN_WIDTH_160
:

5249 
tx_mcs
 = 
he_ˇp
->
he_mcs_nss_suµ
.
tx_mcs_160
;

5252 
tx_mcs
 = 
he_ˇp
->
he_mcs_nss_suµ
.
tx_mcs_80
;

5256  
	`À16_to_˝u
(
tx_mcs
);

5257 
	}
}

5259 
boﬁ
 
	$he_£t_mcs_mask
(
gíl_öfo
 *
öfo
,

5260 
wúñess_dev
 *
wdev
,

5261 
õì80211_suµ‹ãd_b™d
 *
sb™d
,

5262 
∆80211_txøã_he
 *
txøã
,

5263 
u16
 
mcs
[
NL80211_HE_NSS_MAX
],

5264 
lök_id
)

5266 c⁄° 
õì80211_°a_he_ˇp
 *
he_ˇp
;

5267 
u16
 
tx_mcs_mask
[
NL80211_HE_NSS_MAX
] = {};

5268 
u16
 
tx_mcs_m≠
 = 0;

5269 
u8
 
i
;

5271 
he_ˇp
 = 
	`õì80211_gë_he_i·y≥_ˇp
(
sb™d
, 
wdev
->
i·y≥
);

5272 i‡(!
he_ˇp
)

5273  
Ál£
;

5275 
	`mem£t
(
mcs
, 0, (
u16
Ë* 
NL80211_HE_NSS_MAX
);

5277 
tx_mcs_m≠
 = 
	`he_gë_txmcsm≠
(
öfo
, 
lök_id
, 
he_ˇp
);

5280 
	`he_buûd_mcs_mask
(
tx_mcs_m≠
, 
tx_mcs_mask
);

5282 
i
 = 0; i < 
NL80211_HE_NSS_MAX
; i++) {

5283 i‡((
tx_mcs_mask
[
i
] & 
txøã
->
mcs
[i]) ==Åxrate->mcs[i])

5284 
mcs
[
i
] = 
txøã
->mcs[i];

5286  
Ál£
;

5289  
åue
;

5290 
	}
}

5292 
	$∆80211_∑r£_tx_bôøã_mask
(
gíl_öfo
 *
öfo
,

5293 
∆©å
 *
©ås
[],

5294 
∆80211_©ås
 
©å
,

5295 
cfg80211_bôøã_mask
 *
mask
,

5296 
√t_devi˚
 *
dev
,

5297 
boﬁ
 
deÁu…_Æl_íabÀd
,

5298 
lök_id
)

5300 
∆©å
 *
tb
[
NL80211_TXRATE_MAX
 + 1];

5301 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

5302 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

5303 
ªm
, 
i
;

5304 
∆©å
 *
tx_øãs
;

5305 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

5306 
u16
 
vht_tx_mcs_m≠
, 
he_tx_mcs_m≠
;

5308 
	`mem£t
(
mask
, 0, (*mask));

5310 
i
 = 0; i < 
NUM_NL80211_BANDS
; i++) {

5311 c⁄° 
õì80211_°a_he_ˇp
 *
he_ˇp
;

5313 i‡(!
deÁu…_Æl_íabÀd
)

5316 
sb™d
 = 
rdev
->
wùhy
.
b™ds
[
i
];

5318 i‡(!
sb™d
)

5321 
mask
->
c⁄åﬁ
[
i
].
Àgacy
 = (1 << 
sb™d
->
n_bôøãs
) - 1;

5322 
	`mem˝y
(
mask
->
c⁄åﬁ
[
i
].
ht_mcs
,

5323 
sb™d
->
ht_ˇp
.
mcs
.
rx_mask
,

5324 (
mask
->
c⁄åﬁ
[
i
].
ht_mcs
));

5326 i‡(
sb™d
->
vht_ˇp
.
vht_suµ‹ãd
) {

5327 
vht_tx_mcs_m≠
 = 
	`À16_to_˝u
(
sb™d
->
vht_ˇp
.
vht_mcs
.
tx_mcs_m≠
);

5328 
	`vht_buûd_mcs_mask
(
vht_tx_mcs_m≠
, 
mask
->
c⁄åﬁ
[
i
].
vht_mcs
);

5331 
he_ˇp
 = 
	`õì80211_gë_he_i·y≥_ˇp
(
sb™d
, 
wdev
->
i·y≥
);

5332 i‡(!
he_ˇp
)

5335 
he_tx_mcs_m≠
 = 
	`he_gë_txmcsm≠
(
öfo
, 
lök_id
, 
he_ˇp
);

5336 
	`he_buûd_mcs_mask
(
he_tx_mcs_m≠
, 
mask
->
c⁄åﬁ
[
i
].
he_mcs
);

5338 
mask
->
c⁄åﬁ
[
i
].
he_gi
 = 0xFF;

5339 
mask
->
c⁄åﬁ
[
i
].
he_…f
 = 0xFF;

5343 i‡(!
©ås
[
©å
])

5344 
out
;

5349 
	`BUILD_BUG_ON
(
NL80211_MAX_SUPP_HT_RATES
 > 
IEEE80211_HT_MCS_MASK_LEN
 * 8);

5350 
	`∆a_f‹_óch_√°ed
(
tx_øãs
, 
©ås
[
©å
], 
ªm
) {

5351 
∆80211_b™d
 
b™d
 = 
	`∆a_ty≥
(
tx_øãs
);

5352 
îr
;

5354 i‡(
b™d
 < 0 || b™d >
NUM_NL80211_BANDS
)

5355  -
EINVAL
;

5356 
sb™d
 = 
rdev
->
wùhy
.
b™ds
[
b™d
];

5357 i‡(
sb™d
 =
NULL
)

5358  -
EINVAL
;

5359 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
NL80211_TXRATE_MAX
,

5360 
tx_øãs
,

5361 
∆80211_tx©å_pﬁicy
,

5362 
öfo
->
exèck
);

5363 i‡(
îr
)

5364  
îr
;

5365 i‡(
tb
[
NL80211_TXRATE_LEGACY
]) {

5366 
mask
->
c⁄åﬁ
[
b™d
].
Àgacy
 = 
	`øã£t_to_mask
(

5367 
sb™d
,

5368 
	`∆a_d©a
(
tb
[
NL80211_TXRATE_LEGACY
]),

5369 
	`∆a_Àn
(
tb
[
NL80211_TXRATE_LEGACY
]));

5370 i‡((
mask
->
c⁄åﬁ
[
b™d
].
Àgacy
 == 0) &&

5371 
	`∆a_Àn
(
tb
[
NL80211_TXRATE_LEGACY
]))

5372  -
EINVAL
;

5374 i‡(
tb
[
NL80211_TXRATE_HT
]) {

5375 i‡(!
	`ht_øã£t_to_mask
(

5376 
sb™d
,

5377 
	`∆a_d©a
(
tb
[
NL80211_TXRATE_HT
]),

5378 
	`∆a_Àn
(
tb
[
NL80211_TXRATE_HT
]),

5379 
mask
->
c⁄åﬁ
[
b™d
].
ht_mcs
))

5380  -
EINVAL
;

5383 i‡(
tb
[
NL80211_TXRATE_VHT
]) {

5384 i‡(!
	`vht_£t_mcs_mask
(

5385 
sb™d
,

5386 
	`∆a_d©a
(
tb
[
NL80211_TXRATE_VHT
]),

5387 
mask
->
c⁄åﬁ
[
b™d
].
vht_mcs
))

5388  -
EINVAL
;

5391 i‡(
tb
[
NL80211_TXRATE_GI
]) {

5392 
mask
->
c⁄åﬁ
[
b™d
].
gi
 =

5393 
	`∆a_gë_u8
(
tb
[
NL80211_TXRATE_GI
]);

5394 i‡(
mask
->
c⁄åﬁ
[
b™d
].
gi
 > 
NL80211_TXRATE_FORCE_LGI
)

5395  -
EINVAL
;

5397 i‡(
tb
[
NL80211_TXRATE_HE
] &&

5398 !
	`he_£t_mcs_mask
(
öfo
, 
wdev
, 
sb™d
,

5399 
	`∆a_d©a
(
tb
[
NL80211_TXRATE_HE
]),

5400 
mask
->
c⁄åﬁ
[
b™d
].
he_mcs
,

5401 
lök_id
))

5402  -
EINVAL
;

5404 i‡(
tb
[
NL80211_TXRATE_HE_GI
])

5405 
mask
->
c⁄åﬁ
[
b™d
].
he_gi
 =

5406 
	`∆a_gë_u8
(
tb
[
NL80211_TXRATE_HE_GI
]);

5407 i‡(
tb
[
NL80211_TXRATE_HE_LTF
])

5408 
mask
->
c⁄åﬁ
[
b™d
].
he_…f
 =

5409 
	`∆a_gë_u8
(
tb
[
NL80211_TXRATE_HE_LTF
]);

5411 i‡(
mask
->
c⁄åﬁ
[
b™d
].
Àgacy
 == 0) {

5415 i‡(!(
rdev
->
wùhy
.
b™ds
[
b™d
]->
ht_ˇp
.
ht_suµ‹ãd
 ||

5416 
rdev
->
wùhy
.
b™ds
[
b™d
]->
vht_ˇp
.
vht_suµ‹ãd
 ||

5417 
	`õì80211_gë_he_i·y≥_ˇp
(
sb™d
, 
wdev
->
i·y≥
)))

5418  -
EINVAL
;

5420 
i
 = 0; i < 
IEEE80211_HT_MCS_MASK_LEN
; i++)

5421 i‡(
mask
->
c⁄åﬁ
[
b™d
].
ht_mcs
[
i
])

5422 
out
;

5424 
i
 = 0; i < 
NL80211_VHT_NSS_MAX
; i++)

5425 i‡(
mask
->
c⁄åﬁ
[
b™d
].
vht_mcs
[
i
])

5426 
out
;

5428 
i
 = 0; i < 
NL80211_HE_NSS_MAX
; i++)

5429 i‡(
mask
->
c⁄åﬁ
[
b™d
].
he_mcs
[
i
])

5430 
out
;

5433  -
EINVAL
;

5437 
out
:

5439 
	}
}

5441 
	$vÆid©e_bóc⁄_tx_øã
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

5442 
∆80211_b™d
 
b™d
,

5443 
cfg80211_bôøã_mask
 *
bóc⁄_øã
)

5445 
u32
 
cou¡_ht
, 
cou¡_vht
, 
cou¡_he
, 
i
;

5446 
u32
 
øã
 = 
bóc⁄_øã
->
c⁄åﬁ
[
b™d
].
Àgacy
;

5449 i‡(
	`hweight32
(
øã
) > 1)

5450  -
EINVAL
;

5452 
cou¡_ht
 = 0;

5453 
i
 = 0; i < 
IEEE80211_HT_MCS_MASK_LEN
; i++) {

5454 i‡(
	`hweight8
(
bóc⁄_øã
->
c⁄åﬁ
[
b™d
].
ht_mcs
[
i
]) > 1) {

5455  -
EINVAL
;

5456 } i‡(
bóc⁄_øã
->
c⁄åﬁ
[
b™d
].
ht_mcs
[
i
]) {

5457 
cou¡_ht
++;

5458 i‡(
cou¡_ht
 > 1)

5459  -
EINVAL
;

5461 i‡(
cou¡_ht
 && 
øã
)

5462  -
EINVAL
;

5465 
cou¡_vht
 = 0;

5466 
i
 = 0; i < 
NL80211_VHT_NSS_MAX
; i++) {

5467 i‡(
	`hweight16
(
bóc⁄_øã
->
c⁄åﬁ
[
b™d
].
vht_mcs
[
i
]) > 1) {

5468  -
EINVAL
;

5469 } i‡(
bóc⁄_øã
->
c⁄åﬁ
[
b™d
].
vht_mcs
[
i
]) {

5470 
cou¡_vht
++;

5471 i‡(
cou¡_vht
 > 1)

5472  -
EINVAL
;

5474 i‡(
cou¡_vht
 && 
øã
)

5475  -
EINVAL
;

5478 
cou¡_he
 = 0;

5479 
i
 = 0; i < 
NL80211_HE_NSS_MAX
; i++) {

5480 i‡(
	`hweight16
(
bóc⁄_øã
->
c⁄åﬁ
[
b™d
].
he_mcs
[
i
]) > 1) {

5481  -
EINVAL
;

5482 } i‡(
bóc⁄_øã
->
c⁄åﬁ
[
b™d
].
he_mcs
[
i
]) {

5483 
cou¡_he
++;

5484 i‡(
cou¡_he
 > 1)

5485  -
EINVAL
;

5487 i‡(
cou¡_he
 && 
øã
)

5488  -
EINVAL
;

5491 i‡((
cou¡_ht
 && 
cou¡_vht
 && 
cou¡_he
) ||

5492 (!
øã
 && !
cou¡_ht
 && !
cou¡_vht
 && !
cou¡_he
))

5493  -
EINVAL
;

5495 i‡(
øã
 &&

5496 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

5497 
NL80211_EXT_FEATURE_BEACON_RATE_LEGACY
))

5498  -
EINVAL
;

5499 i‡(
cou¡_ht
 &&

5500 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

5501 
NL80211_EXT_FEATURE_BEACON_RATE_HT
))

5502  -
EINVAL
;

5503 i‡(
cou¡_vht
 &&

5504 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

5505 
NL80211_EXT_FEATURE_BEACON_RATE_VHT
))

5506  -
EINVAL
;

5507 i‡(
cou¡_he
 &&

5508 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

5509 
NL80211_EXT_FEATURE_BEACON_RATE_HE
))

5510  -
EINVAL
;

5513 
	}
}

5515 
	$∆80211_∑r£_mbssid_c⁄fig
(
wùhy
 *wiphy,

5516 
√t_devi˚
 *
dev
,

5517 
∆©å
 *
©ås
,

5518 
cfg80211_mbssid_c⁄fig
 *
c⁄fig
,

5519 
u8
 
num_ñems
)

5521 
∆©å
 *
tb
[
NL80211_MBSSID_CONFIG_ATTR_MAX
 + 1];

5523 i‡(!
wùhy
->
mbssid_max_öãrÁ˚s
)

5524  -
EOPNOTSUPP
;

5526 i‡(
	`∆a_∑r£_√°ed
(
tb
, 
NL80211_MBSSID_CONFIG_ATTR_MAX
, 
©ås
, 
NULL
,

5527 
NULL
) ||

5528 !
tb
[
NL80211_MBSSID_CONFIG_ATTR_INDEX
])

5529  -
EINVAL
;

5531 
c⁄fig
->
ema
 = 
	`∆a_gë_Êag
(
tb
[
NL80211_MBSSID_CONFIG_ATTR_EMA
]);

5532 i‡(
c⁄fig
->
ema
) {

5533 i‡(!
wùhy
->
ema_max_¥ofûe_≥riodicôy
)

5534  -
EOPNOTSUPP
;

5536 i‡(
num_ñems
 > 
wùhy
->
ema_max_¥ofûe_≥riodicôy
)

5537  -
EINVAL
;

5540 
c⁄fig
->
ödex
 = 
	`∆a_gë_u8
(
tb
[
NL80211_MBSSID_CONFIG_ATTR_INDEX
]);

5541 i‡(
c⁄fig
->
ödex
 >
wùhy
->
mbssid_max_öãrÁ˚s
 ||

5542 (!
c⁄fig
->
ödex
 && !
num_ñems
))

5543  -
EINVAL
;

5545 i‡(
tb
[
NL80211_MBSSID_CONFIG_ATTR_TX_IFINDEX
]) {

5546 
u32
 
tx_ifödex
 =

5547 
	`∆a_gë_u32
(
tb
[
NL80211_MBSSID_CONFIG_ATTR_TX_IFINDEX
]);

5549 i‡((!
c⁄fig
->
ödex
 && 
tx_ifödex
 !
dev
->
ifödex
) ||

5550 (
c⁄fig
->
ödex
 && 
tx_ifödex
 =
dev
->
ifödex
))

5551  -
EINVAL
;

5553 i‡(
tx_ifödex
 !
dev
->
ifödex
) {

5554 
√t_devi˚
 *
tx_√tdev
 =

5555 
	`dev_gë_by_ödex
(
	`wùhy_√t
(
wùhy
), 
tx_ifödex
);

5557 i‡(!
tx_√tdev
 || !tx_√tdev->
õì80211_±r
 ||

5558 
tx_√tdev
->
õì80211_±r
->
wùhy
 != wiphy ||

5559 
tx_√tdev
->
õì80211_±r
->
i·y≥
 !=

5560 
NL80211_IFTYPE_AP
) {

5561 
	`dev_put
(
tx_√tdev
);

5562  -
EINVAL
;

5565 
c⁄fig
->
tx_wdev
 = 
tx_√tdev
->
õì80211_±r
;

5567 
c⁄fig
->
tx_wdev
 = 
dev
->
õì80211_±r
;

5569 } i‡(!
c⁄fig
->
ödex
) {

5570 
c⁄fig
->
tx_wdev
 = 
dev
->
õì80211_±r
;

5572  -
EINVAL
;

5576 
	}
}

5578 
cfg80211_mbssid_ñems
 *

5579 
	$∆80211_∑r£_mbssid_ñems
(
wùhy
 *wùhy, 
∆©å
 *
©ås
)

5581 
∆©å
 *
∆_ñems
;

5582 
cfg80211_mbssid_ñems
 *
ñems
;

5583 
ªm_ñems
;

5584 
u8
 
i
 = 0, 
num_ñems
 = 0;

5586 i‡(!
wùhy
->
mbssid_max_öãrÁ˚s
)

5587  
	`ERR_PTR
(-
EINVAL
);

5589 
	`∆a_f‹_óch_√°ed
(
∆_ñems
, 
©ås
, 
ªm_ñems
) {

5590 i‡(
num_ñems
 >= 255)

5591  
	`ERR_PTR
(-
EINVAL
);

5592 
num_ñems
++;

5595 
ñems
 = 
	`kzÆloc
(
	`°ru˘_size
”Àms, 
ñem
, 
num_ñems
), 
GFP_KERNEL
);

5596 i‡(!
ñems
)

5597  
	`ERR_PTR
(-
ENOMEM
);

5598 
ñems
->
˙t
 = 
num_ñems
;

5600 
	`∆a_f‹_óch_√°ed
(
∆_ñems
, 
©ås
, 
ªm_ñems
) {

5601 
ñems
->
ñem
[
i
].
d©a
 = 
	`∆a_d©a
(
∆_ñems
);

5602 
ñems
->
ñem
[
i
].
Àn
 = 
	`∆a_Àn
(
∆_ñems
);

5603 
i
++;

5605  
ñems
;

5606 
	}
}

5608 
cfg80211_∫r_ñems
 *

5609 
	$∆80211_∑r£_∫r_ñems
(
wùhy
 *wùhy, 
∆©å
 *
©ås
,

5610 
√éök_ext_ack
 *
exèck
)

5612 
∆©å
 *
∆_ñems
;

5613 
cfg80211_∫r_ñems
 *
ñems
;

5614 
ªm_ñems
;

5615 
u8
 
i
 = 0, 
num_ñems
 = 0;

5617 
	`∆a_f‹_óch_√°ed
(
∆_ñems
, 
©ås
, 
ªm_ñems
) {

5618 
ªt
;

5620 
ªt
 = 
	`vÆid©e_õ_©å
(
∆_ñems
, 
exèck
);

5621 i‡(
ªt
)

5622  
	`ERR_PTR
(
ªt
);

5624 
num_ñems
++;

5627 
ñems
 = 
	`kzÆloc
(
	`°ru˘_size
”Àms, 
ñem
, 
num_ñems
), 
GFP_KERNEL
);

5628 i‡(!
ñems
)

5629  
	`ERR_PTR
(-
ENOMEM
);

5630 
ñems
->
˙t
 = 
num_ñems
;

5632 
	`∆a_f‹_óch_√°ed
(
∆_ñems
, 
©ås
, 
ªm_ñems
) {

5633 
ñems
->
ñem
[
i
].
d©a
 = 
	`∆a_d©a
(
∆_ñems
);

5634 
ñems
->
ñem
[
i
].
Àn
 = 
	`∆a_Àn
(
∆_ñems
);

5635 
i
++;

5637  
ñems
;

5638 
	}
}

5640 
	$∆80211_∑r£_he_bss_cﬁ‹
(
∆©å
 *
©ås
,

5641 
cfg80211_he_bss_cﬁ‹
 *
he_bss_cﬁ‹
)

5643 
∆©å
 *
tb
[
NL80211_HE_BSS_COLOR_ATTR_MAX
 + 1];

5644 
îr
;

5646 
îr
 = 
	`∆a_∑r£_√°ed
(
tb
, 
NL80211_HE_BSS_COLOR_ATTR_MAX
, 
©ås
,

5647 
he_bss_cﬁ‹_pﬁicy
, 
NULL
);

5648 i‡(
îr
)

5649  
îr
;

5651 i‡(!
tb
[
NL80211_HE_BSS_COLOR_ATTR_COLOR
])

5652  -
EINVAL
;

5654 
he_bss_cﬁ‹
->
cﬁ‹
 =

5655 
	`∆a_gë_u8
(
tb
[
NL80211_HE_BSS_COLOR_ATTR_COLOR
]);

5656 
he_bss_cﬁ‹
->
íabÀd
 =

5657 !
	`∆a_gë_Êag
(
tb
[
NL80211_HE_BSS_COLOR_ATTR_DISABLED
]);

5658 
he_bss_cﬁ‹
->
∑πül
 =

5659 
	`∆a_gë_Êag
(
tb
[
NL80211_HE_BSS_COLOR_ATTR_PARTIAL
]);

5662 
	}
}

5664 
	$∆80211_∑r£_bóc⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

5665 
∆©å
 *
©ås
[],

5666 
cfg80211_bóc⁄_d©a
 *
b˙
,

5667 
√éök_ext_ack
 *
exèck
)

5669 
boﬁ
 
haveöfo
 = 
Ál£
;

5670 
îr
;

5672 
	`mem£t
(
b˙
, 0, (*bcn));

5674 
b˙
->
lök_id
 = 
	`∆80211_lök_id
(
©ås
);

5676 i‡(
©ås
[
NL80211_ATTR_BEACON_HEAD
]) {

5677 
b˙
->
hód
 = 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_BEACON_HEAD
]);

5678 
b˙
->
hód_Àn
 = 
	`∆a_Àn
(
©ås
[
NL80211_ATTR_BEACON_HEAD
]);

5679 i‡(!
b˙
->
hód_Àn
)

5680  -
EINVAL
;

5681 
haveöfo
 = 
åue
;

5684 i‡(
©ås
[
NL80211_ATTR_BEACON_TAIL
]) {

5685 
b˙
->
èû
 = 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_BEACON_TAIL
]);

5686 
b˙
->
èû_Àn
 = 
	`∆a_Àn
(
©ås
[
NL80211_ATTR_BEACON_TAIL
]);

5687 
haveöfo
 = 
åue
;

5690 i‡(!
haveöfo
)

5691  -
EINVAL
;

5693 i‡(
©ås
[
NL80211_ATTR_IE
]) {

5694 
b˙
->
bóc⁄_õs
 = 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_IE
]);

5695 
b˙
->
bóc⁄_õs_Àn
 = 
	`∆a_Àn
(
©ås
[
NL80211_ATTR_IE
]);

5698 i‡(
©ås
[
NL80211_ATTR_IE_PROBE_RESP
]) {

5699 
b˙
->
¥obîe•_õs
 =

5700 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_IE_PROBE_RESP
]);

5701 
b˙
->
¥obîe•_õs_Àn
 =

5702 
	`∆a_Àn
(
©ås
[
NL80211_ATTR_IE_PROBE_RESP
]);

5705 i‡(
©ås
[
NL80211_ATTR_IE_ASSOC_RESP
]) {

5706 
b˙
->
asso¸e•_õs
 =

5707 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_IE_ASSOC_RESP
]);

5708 
b˙
->
asso¸e•_õs_Àn
 =

5709 
	`∆a_Àn
(
©ås
[
NL80211_ATTR_IE_ASSOC_RESP
]);

5712 i‡(
©ås
[
NL80211_ATTR_PROBE_RESP
]) {

5713 
b˙
->
¥obe_ª•
 = 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_PROBE_RESP
]);

5714 
b˙
->
¥obe_ª•_Àn
 = 
	`∆a_Àn
(
©ås
[
NL80211_ATTR_PROBE_RESP
]);

5717 i‡(
©ås
[
NL80211_ATTR_FTM_RESPONDER
]) {

5718 
∆©å
 *
tb
[
NL80211_FTM_RESP_ATTR_MAX
 + 1];

5720 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
,

5721 
NL80211_FTM_RESP_ATTR_MAX
,

5722 
©ås
[
NL80211_ATTR_FTM_RESPONDER
],

5723 
NULL
, NULL);

5724 i‡(
îr
)

5725  
îr
;

5727 i‡(
tb
[
NL80211_FTM_RESP_ATTR_ENABLED
] &&

5728 
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

5729 
NL80211_EXT_FEATURE_ENABLE_FTM_RESPONDER
))

5730 
b˙
->
·m_ª•⁄dî
 = 1;

5732  -
EOPNOTSUPP
;

5734 i‡(
tb
[
NL80211_FTM_RESP_ATTR_LCI
]) {

5735 
b˙
->
lci
 = 
	`∆a_d©a
(
tb
[
NL80211_FTM_RESP_ATTR_LCI
]);

5736 
b˙
->
lci_Àn
 = 
	`∆a_Àn
(
tb
[
NL80211_FTM_RESP_ATTR_LCI
]);

5739 i‡(
tb
[
NL80211_FTM_RESP_ATTR_CIVICLOC
]) {

5740 
b˙
->
civi˛oc
 = 
	`∆a_d©a
(
tb
[
NL80211_FTM_RESP_ATTR_CIVICLOC
]);

5741 
b˙
->
civi˛oc_Àn
 = 
	`∆a_Àn
(
tb
[
NL80211_FTM_RESP_ATTR_CIVICLOC
]);

5744 
b˙
->
·m_ª•⁄dî
 = -1;

5747 i‡(
©ås
[
NL80211_ATTR_HE_BSS_COLOR
]) {

5748 
îr
 = 
	`∆80211_∑r£_he_bss_cﬁ‹
(
©ås
[
NL80211_ATTR_HE_BSS_COLOR
],

5749 &
b˙
->
he_bss_cﬁ‹
);

5750 i‡(
îr
)

5751  
îr
;

5752 
b˙
->
he_bss_cﬁ‹_vÆid
 = 
åue
;

5755 i‡(
©ås
[
NL80211_ATTR_MBSSID_ELEMS
]) {

5756 
cfg80211_mbssid_ñems
 *
mbssid
 =

5757 
	`∆80211_∑r£_mbssid_ñems
(&
rdev
->
wùhy
,

5758 
©ås
[
NL80211_ATTR_MBSSID_ELEMS
]);

5760 i‡(
	`IS_ERR
(
mbssid
))

5761  
	`PTR_ERR
(
mbssid
);

5763 
b˙
->
mbssid_õs
 = 
mbssid
;

5765 i‡(
b˙
->
mbssid_õs
 && 
©ås
[
NL80211_ATTR_EMA_RNR_ELEMS
]) {

5766 
cfg80211_∫r_ñems
 *
∫r
 =

5767 
	`∆80211_∑r£_∫r_ñems
(&
rdev
->
wùhy
,

5768 
©ås
[
NL80211_ATTR_EMA_RNR_ELEMS
],

5769 
exèck
);

5771 i‡(
	`IS_ERR
(
∫r
))

5772  
	`PTR_ERR
(
∫r
);

5774 i‡(
∫r
 &&Ñƒ->
˙t
 < 
b˙
->
mbssid_õs
->cnt)

5775  -
EINVAL
;

5777 
b˙
->
∫r_õs
 = 
∫r
;

5782 
	}
}

5784 
	$∆80211_∑r£_he_obss_pd
(
∆©å
 *
©ås
,

5785 
õì80211_he_obss_pd
 *
he_obss_pd
)

5787 
∆©å
 *
tb
[
NL80211_HE_OBSS_PD_ATTR_MAX
 + 1];

5788 
îr
;

5790 
îr
 = 
	`∆a_∑r£_√°ed
(
tb
, 
NL80211_HE_OBSS_PD_ATTR_MAX
, 
©ås
,

5791 
he_obss_pd_pﬁicy
, 
NULL
);

5792 i‡(
îr
)

5793  
îr
;

5795 i‡(!
tb
[
NL80211_HE_OBSS_PD_ATTR_SR_CTRL
])

5796  -
EINVAL
;

5798 
he_obss_pd
->
§_˘æ
 = 
	`∆a_gë_u8
(
tb
[
NL80211_HE_OBSS_PD_ATTR_SR_CTRL
]);

5800 i‡(
tb
[
NL80211_HE_OBSS_PD_ATTR_MIN_OFFSET
])

5801 
he_obss_pd
->
mö_off£t
 =

5802 
	`∆a_gë_u8
(
tb
[
NL80211_HE_OBSS_PD_ATTR_MIN_OFFSET
]);

5803 i‡(
tb
[
NL80211_HE_OBSS_PD_ATTR_MAX_OFFSET
])

5804 
he_obss_pd
->
max_off£t
 =

5805 
	`∆a_gë_u8
(
tb
[
NL80211_HE_OBSS_PD_ATTR_MAX_OFFSET
]);

5806 i‡(
tb
[
NL80211_HE_OBSS_PD_ATTR_NON_SRG_MAX_OFFSET
])

5807 
he_obss_pd
->
n⁄_§g_max_off£t
 =

5808 
	`∆a_gë_u8
(
tb
[
NL80211_HE_OBSS_PD_ATTR_NON_SRG_MAX_OFFSET
]);

5810 i‡(
he_obss_pd
->
mö_off£t
 > he_obss_pd->
max_off£t
)

5811  -
EINVAL
;

5813 i‡(
tb
[
NL80211_HE_OBSS_PD_ATTR_BSS_COLOR_BITMAP
])

5814 
	`mem˝y
(
he_obss_pd
->
bss_cﬁ‹_bôm≠
,

5815 
	`∆a_d©a
(
tb
[
NL80211_HE_OBSS_PD_ATTR_BSS_COLOR_BITMAP
]),

5816 (
he_obss_pd
->
bss_cﬁ‹_bôm≠
));

5818 i‡(
tb
[
NL80211_HE_OBSS_PD_ATTR_PARTIAL_BSSID_BITMAP
])

5819 
	`mem˝y
(
he_obss_pd
->
∑πül_bssid_bôm≠
,

5820 
	`∆a_d©a
(
tb
[
NL80211_HE_OBSS_PD_ATTR_PARTIAL_BSSID_BITMAP
]),

5821 (
he_obss_pd
->
∑πül_bssid_bôm≠
));

5823 
he_obss_pd
->
íabÀ
 = 
åue
;

5826 
	}
}

5828 
	$∆80211_∑r£_fûs_discovîy
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

5829 
∆©å
 *
©ås
,

5830 
cfg80211_fûs_discovîy
 *
fd
)

5832 
∆©å
 *
tb
[
NL80211_FILS_DISCOVERY_ATTR_MAX
 + 1];

5833 
ªt
;

5835 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

5836 
NL80211_EXT_FEATURE_FILS_DISCOVERY
))

5837  -
EINVAL
;

5839 
ªt
 = 
	`∆a_∑r£_√°ed
(
tb
, 
NL80211_FILS_DISCOVERY_ATTR_MAX
, 
©ås
,

5840 
NULL
, NULL);

5841 i‡(
ªt
)

5842  
ªt
;

5844 i‡(!
tb
[
NL80211_FILS_DISCOVERY_ATTR_INT_MIN
] &&

5845 !
tb
[
NL80211_FILS_DISCOVERY_ATTR_INT_MAX
] &&

5846 !
tb
[
NL80211_FILS_DISCOVERY_ATTR_TMPL
]) {

5847 
fd
->
upd©e
 = 
åue
;

5851 i‡(!
tb
[
NL80211_FILS_DISCOVERY_ATTR_INT_MIN
] ||

5852 !
tb
[
NL80211_FILS_DISCOVERY_ATTR_INT_MAX
] ||

5853 !
tb
[
NL80211_FILS_DISCOVERY_ATTR_TMPL
])

5854  -
EINVAL
;

5856 
fd
->
tm∂_Àn
 = 
	`∆a_Àn
(
tb
[
NL80211_FILS_DISCOVERY_ATTR_TMPL
]);

5857 
fd
->
tm∂
 = 
	`∆a_d©a
(
tb
[
NL80211_FILS_DISCOVERY_ATTR_TMPL
]);

5858 
fd
->
mö_öãrvÆ
 = 
	`∆a_gë_u32
(
tb
[
NL80211_FILS_DISCOVERY_ATTR_INT_MIN
]);

5859 
fd
->
max_öãrvÆ
 = 
	`∆a_gë_u32
(
tb
[
NL80211_FILS_DISCOVERY_ATTR_INT_MAX
]);

5860 
fd
->
upd©e
 = 
åue
;

5862 
	}
}

5865 
	$∆80211_∑r£_unsﬁ_bˇ°_¥obe_ª•
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

5866 
∆©å
 *
©ås
,

5867 
cfg80211_unsﬁ_bˇ°_¥obe_ª•
 *
¥e•
)

5869 
∆©å
 *
tb
[
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_MAX
 + 1];

5870 
ªt
;

5872 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

5873 
NL80211_EXT_FEATURE_UNSOL_BCAST_PROBE_RESP
))

5874  -
EINVAL
;

5876 
ªt
 = 
	`∆a_∑r£_√°ed
(
tb
, 
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_MAX
,

5877 
©ås
, 
NULL
, NULL);

5878 i‡(
ªt
)

5879  
ªt
;

5881 i‡(!
tb
[
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_INT
] &&

5882 !
tb
[
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_TMPL
]) {

5883 
¥e•
->
upd©e
 = 
åue
;

5887 i‡(!
tb
[
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_INT
] ||

5888 !
tb
[
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_TMPL
])

5889  -
EINVAL
;

5891 
¥e•
->
tm∂
 = 
	`∆a_d©a
(
tb
[
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_TMPL
]);

5892 
¥e•
->
tm∂_Àn
 = 
	`∆a_Àn
(
tb
[
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_TMPL
]);

5893 
¥e•
->
öãrvÆ
 = 
	`∆a_gë_u32
(
tb
[
NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_INT
]);

5894 
¥e•
->
upd©e
 = 
åue
;

5896 
	}
}

5898 
	$∆80211_check_≠_øã_£À˘‹s
(
cfg80211_≠_£âögs
 *
∑øms
,

5899 c⁄° 
ñemít
 *
øãs
)

5901 
i
;

5903 i‡(!
øãs
)

5906 
i
 = 0; i < 
øãs
->
d©Æí
; i++) {

5907 i‡(
øãs
->
d©a
[
i
] =
BSS_MEMBERSHIP_SELECTOR_HT_PHY
)

5908 
∑øms
->
ht_ªquúed
 = 
åue
;

5909 i‡(
øãs
->
d©a
[
i
] =
BSS_MEMBERSHIP_SELECTOR_VHT_PHY
)

5910 
∑øms
->
vht_ªquúed
 = 
åue
;

5911 i‡(
øãs
->
d©a
[
i
] =
BSS_MEMBERSHIP_SELECTOR_HE_PHY
)

5912 
∑øms
->
he_ªquúed
 = 
åue
;

5913 i‡(
øãs
->
d©a
[
i
] =
BSS_MEMBERSHIP_SELECTOR_SAE_H2E
)

5914 
∑øms
->
ße_h2e_ªquúed
 = 
åue
;

5916 
	}
}

5923 
	$∆80211_ˇlcuœã_≠_∑øms
(
cfg80211_≠_£âögs
 *
∑øms
)

5925 c⁄° 
cfg80211_bóc⁄_d©a
 *
b˙
 = &
∑øms
->
bóc⁄
;

5926 
size_t
 
õs_Àn
 = 
b˙
->
èû_Àn
;

5927 c⁄° 
u8
 *
õs
 = 
b˙
->
èû
;

5928 c⁄° 
ñemít
 *
øãs
;

5929 c⁄° 
ñemít
 *
ˇp
;

5931 
øãs
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_SUPP_RATES
, 
õs
, 
õs_Àn
);

5932 
	`∆80211_check_≠_øã_£À˘‹s
(
∑øms
, 
øãs
);

5934 
øãs
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_EXT_SUPP_RATES
, 
õs
, 
õs_Àn
);

5935 
	`∆80211_check_≠_øã_£À˘‹s
(
∑øms
, 
øãs
);

5937 
ˇp
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_HT_CAPABILITY
, 
õs
, 
õs_Àn
);

5938 i‡(
ˇp
 && c≠->
d©Æí
 >(*
∑øms
->
ht_ˇp
))

5939 
∑øms
->
ht_ˇp
 = (*)
ˇp
->
d©a
;

5940 
ˇp
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_VHT_CAPABILITY
, 
õs
, 
õs_Àn
);

5941 i‡(
ˇp
 && c≠->
d©Æí
 >(*
∑øms
->
vht_ˇp
))

5942 
∑øms
->
vht_ˇp
 = (*)
ˇp
->
d©a
;

5943 
ˇp
 = 
	`cfg80211_föd_ext_ñem
(
WLAN_EID_EXT_HE_CAPABILITY
, 
õs
, 
õs_Àn
);

5944 i‡(
ˇp
 && c≠->
d©Æí
 >(*
∑øms
->
he_ˇp
) + 1)

5945 
∑øms
->
he_ˇp
 = (*)(
ˇp
->
d©a
 + 1);

5946 
ˇp
 = 
	`cfg80211_föd_ext_ñem
(
WLAN_EID_EXT_HE_OPERATION
, 
õs
, 
õs_Àn
);

5947 i‡(
ˇp
 && c≠->
d©Æí
 >(*
∑øms
->
he_›î
) + 1)

5948 
∑øms
->
he_›î
 = (*)(
ˇp
->
d©a
 + 1);

5949 
ˇp
 = 
	`cfg80211_föd_ext_ñem
(
WLAN_EID_EXT_EHT_CAPABILITY
, 
õs
, 
õs_Àn
);

5950 i‡(
ˇp
) {

5951 i‡(!
ˇp
->
d©Æí
)

5952  -
EINVAL
;

5953 
∑øms
->
eht_ˇp
 = (*)(
ˇp
->
d©a
 + 1);

5954 i‡(!
	`õì80211_eht_ˇ∑_size_ok
((c⁄° 
u8
 *)
∑øms
->
he_ˇp
,

5955 (c⁄° 
u8
 *)
∑øms
->
eht_ˇp
,

5956 
ˇp
->
d©Æí
 - 1, 
åue
))

5957  -
EINVAL
;

5959 
ˇp
 = 
	`cfg80211_föd_ext_ñem
(
WLAN_EID_EXT_EHT_OPERATION
, 
õs
, 
õs_Àn
);

5960 i‡(
ˇp
) {

5961 i‡(!
ˇp
->
d©Æí
)

5962  -
EINVAL
;

5963 
∑øms
->
eht_›î
 = (*)(
ˇp
->
d©a
 + 1);

5964 i‡(!
	`õì80211_eht_›î_size_ok
((c⁄° 
u8
 *)
∑øms
->
eht_›î
,

5965 
ˇp
->
d©Æí
 - 1))

5966  -
EINVAL
;

5969 
	}
}

5971 
boﬁ
 
	$∆80211_gë_≠_ch™√l
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

5972 
cfg80211_≠_£âögs
 *
∑øms
)

5974 
wúñess_dev
 *
wdev
;

5976 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

5977 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

5978 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
)

5981 i‡(!
wdev
->
u
.
≠
.
¥e£t_ch™def
.
ch™
)

5984 
∑øms
->
ch™def
 = 
wdev
->
u
.
≠
.
¥e£t_ch™def
;

5985  
åue
;

5988  
Ál£
;

5989 
	}
}

5991 
boﬁ
 
	$∆80211_vÆid_auth_ty≥
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

5992 
∆80211_auth_ty≥
 
auth_ty≥
,

5993 
∆80211_comm™ds
 
cmd
)

5995 i‡(
auth_ty≥
 > 
NL80211_AUTHTYPE_MAX
)

5996  
Ál£
;

5998 
cmd
) {

5999 
NL80211_CMD_AUTHENTICATE
:

6000 i‡(!(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_SAE
) &&

6001 
auth_ty≥
 =
NL80211_AUTHTYPE_SAE
)

6002  
Ál£
;

6003 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

6004 
NL80211_EXT_FEATURE_FILS_STA
) &&

6005 (
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_SK
 ||

6006 
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_SK_PFS
 ||

6007 
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_PK
))

6008  
Ál£
;

6009  
åue
;

6010 
NL80211_CMD_CONNECT
:

6011 i‡(!(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_SAE
) &&

6012 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

6013 
NL80211_EXT_FEATURE_SAE_OFFLOAD
) &&

6014 
auth_ty≥
 =
NL80211_AUTHTYPE_SAE
)

6015  
Ál£
;

6018 i‡(
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_SK_PFS
 ||

6019 
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_PK
)

6020  
Ál£
;

6021 i‡(!
	`wùhy_ext_„©uª_is£t
(

6022 &
rdev
->
wùhy
,

6023 
NL80211_EXT_FEATURE_FILS_SK_OFFLOAD
) &&

6024 
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_SK
)

6025  
Ál£
;

6026  
åue
;

6027 
NL80211_CMD_START_AP
:

6028 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

6029 
NL80211_EXT_FEATURE_SAE_OFFLOAD_AP
) &&

6030 
auth_ty≥
 =
NL80211_AUTHTYPE_SAE
)

6031  
Ál£
;

6033 i‡(
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_SK
 ||

6034 
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_SK_PFS
 ||

6035 
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_PK
)

6036  
Ál£
;

6037  
åue
;

6039  
Ál£
;

6041 
	}
}

6043 
	$∆80211_£nd_≠_°¨ãd
(
wúñess_dev
 *
wdev
,

6044 
lök_id
)

6046 
wùhy
 *wùhy = 
wdev
->wiphy;

6047 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

6048 
sk_buff
 *
msg
;

6049 *
hdr
;

6051 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

6052 i‡(!
msg
)

6055 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_START_AP
);

6056 i‡(!
hdr
)

6057 
out
;

6059 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

6060 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
wdev
->
√tdev
->
ifödex
) ||

6061 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

6062 
NL80211_ATTR_PAD
) ||

6063 (
wdev
->
u
.
≠
.
ssid_Àn
 &&

6064 
	`∆a_put
(
msg
, 
NL80211_ATTR_SSID
, 
wdev
->
u
.
≠
.
ssid_Àn
,

6065 
wdev
->
u
.
≠
.
ssid
)) ||

6066 (
wdev
->
vÆid_löks
 &&

6067 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MLO_LINK_ID
, 
lök_id
)))

6068 
out
;

6070 
	`gílmsg_íd
(
msg
, 
hdr
);

6072 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(
wùhy
), 
msg
, 0,

6073 
NL80211_MCGRP_MLME
, 
GFP_KERNEL
);

6075 
out
:

6076 
	`∆msg_‰ì
(
msg
);

6077 
	}
}

6079 
	$∆80211_vÆid©e_≠_phy_›î©i⁄
(
cfg80211_≠_£âögs
 *
∑øms
)

6081 
õì80211_ch™√l
 *
ch™√l
 = 
∑øms
->
ch™def
.
ch™
;

6083 i‡((
∑øms
->
he_ˇp
 ||Ö¨ams->
he_›î
) &&

6084 (
ch™√l
->
Êags
 & 
IEEE80211_CHAN_NO_HE
))

6085  -
EOPNOTSUPP
;

6087 i‡((
∑øms
->
eht_ˇp
 ||Ö¨ams->
eht_›î
) &&

6088 (
ch™√l
->
Êags
 & 
IEEE80211_CHAN_NO_EHT
))

6089  -
EOPNOTSUPP
;

6092 
	}
}

6094 
	$∆80211_°¨t_≠
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

6096 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

6097 
lök_id
 = 
	`∆80211_lök_id
(
öfo
->
©ås
);

6098 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

6099 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

6100 
cfg80211_≠_£âögs
 *
∑øms
;

6101 
îr
;

6103 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

6105 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

6106 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

6107 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6108  -
EOPNOTSUPP
;

6111 i‡(!
rdev
->
›s
->
°¨t_≠
) {

6112 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6113  -
EOPNOTSUPP
;

6116 i‡(
wdev
->
löks
[
lök_id
].
≠
.
bóc⁄_öãrvÆ
) {

6117 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6118  -
EALREADY
;

6122 i‡(!
öfo
->
©ås
[
NL80211_ATTR_BEACON_INTERVAL
] ||

6123 !
öfo
->
©ås
[
NL80211_ATTR_DTIM_PERIOD
] ||

6124 !
öfo
->
©ås
[
NL80211_ATTR_BEACON_HEAD
]) {

6125 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6126  -
EINVAL
;

6129 
∑øms
 = 
	`kzÆloc
((*∑øms), 
GFP_KERNEL
);

6130 i‡(!
∑øms
) {

6131 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6132  -
ENOMEM
;

6135 
îr
 = 
	`∆80211_∑r£_bóc⁄
(
rdev
, 
öfo
->
©ås
, &
∑øms
->
bóc⁄
,

6136 
öfo
->
exèck
);

6137 i‡(
îr
) {

6138 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6139 
out
;

6142 
∑øms
->
bóc⁄_öãrvÆ
 =

6143 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_BEACON_INTERVAL
]);

6144 
∑øms
->
dtim_≥riod
 =

6145 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_DTIM_PERIOD
]);

6147 
îr
 = 
	`cfg80211_vÆid©e_bóc⁄_öt
(
rdev
, 
dev
->
õì80211_±r
->
i·y≥
,

6148 
∑øms
->
bóc⁄_öãrvÆ
);

6149 i‡(
îr
) {

6150 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6151 
out
;

6161 i‡(
öfo
->
©ås
[
NL80211_ATTR_SSID
]) {

6162 
∑øms
->
ssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

6163 
∑øms
->
ssid_Àn
 =

6164 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

6165 i‡(
∑øms
->
ssid_Àn
 == 0) {

6166 
îr
 = -
EINVAL
;

6167 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6168 
out
;

6171 i‡(
wdev
->
u
.
≠
.
ssid_Àn
 &&

6172 (
wdev
->
u
.
≠
.
ssid_Àn
 !
∑øms
->ssid_len ||

6173 
	`memcmp
(
wdev
->
u
.
≠
.
ssid
, 
∑øms
->ssid,Ö¨ams->
ssid_Àn
))) {

6175 
îr
 = -
EINVAL
;

6176 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6177 
out
;

6179 } i‡(
wdev
->
vÆid_löks
) {

6181 
îr
 = -
EINVAL
;

6182 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6183 
out
;

6186 i‡(
öfo
->
©ås
[
NL80211_ATTR_HIDDEN_SSID
])

6187 
∑øms
->
hiddí_ssid
 = 
	`∆a_gë_u32
(

6188 
öfo
->
©ås
[
NL80211_ATTR_HIDDEN_SSID
]);

6190 
∑øms
->
¥ivacy
 = !!
öfo
->
©ås
[
NL80211_ATTR_PRIVACY
];

6192 i‡(
öfo
->
©ås
[
NL80211_ATTR_AUTH_TYPE
]) {

6193 
∑øms
->
auth_ty≥
 = 
	`∆a_gë_u32
(

6194 
öfo
->
©ås
[
NL80211_ATTR_AUTH_TYPE
]);

6195 i‡(!
	`∆80211_vÆid_auth_ty≥
(
rdev
, 
∑øms
->
auth_ty≥
,

6196 
NL80211_CMD_START_AP
)) {

6197 
îr
 = -
EINVAL
;

6198 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6199 
out
;

6202 
∑øms
->
auth_ty≥
 = 
NL80211_AUTHTYPE_AUTOMATIC
;

6204 
îr
 = 
	`∆80211_¸y±o_£âögs
(
rdev
, 
öfo
, &
∑øms
->
¸y±o
,

6205 
NL80211_MAX_NR_CIPHER_SUITES
);

6206 i‡(
îr
) {

6207 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6208 
out
;

6211 i‡(
öfo
->
©ås
[
NL80211_ATTR_INACTIVITY_TIMEOUT
]) {

6212 i‡(!(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_INACTIVITY_TIMER
)) {

6213 
îr
 = -
EOPNOTSUPP
;

6214 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6215 
out
;

6217 
∑øms
->
öa˘ivôy_timeout
 = 
	`∆a_gë_u16
(

6218 
öfo
->
©ås
[
NL80211_ATTR_INACTIVITY_TIMEOUT
]);

6221 i‡(
öfo
->
©ås
[
NL80211_ATTR_P2P_CTWINDOW
]) {

6222 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

6223 
îr
 = -
EINVAL
;

6224 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6225 
out
;

6227 
∑øms
->
p2p_˘wödow
 =

6228 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_P2P_CTWINDOW
]);

6229 i‡(
∑øms
->
p2p_˘wödow
 != 0 &&

6230 !(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_P2P_GO_CTWIN
)) {

6231 
îr
 = -
EINVAL
;

6232 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6233 
out
;

6237 i‡(
öfo
->
©ås
[
NL80211_ATTR_P2P_OPPPS
]) {

6238 
u8
 
tmp
;

6240 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

6241 
îr
 = -
EINVAL
;

6242 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6243 
out
;

6245 
tmp
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_P2P_OPPPS
]);

6246 
∑øms
->
p2p_›p_ps
 = 
tmp
;

6247 i‡(
∑øms
->
p2p_›p_ps
 != 0 &&

6248 !(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_P2P_GO_OPPPS
)) {

6249 
îr
 = -
EINVAL
;

6250 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6251 
out
;

6255 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
]) {

6256 
îr
 = 
	`∆80211_∑r£_ch™def
(
rdev
, 
öfo
, &
∑øms
->
ch™def
);

6257 i‡(
îr
) {

6258 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6259 
out
;

6261 } i‡(
wdev
->
vÆid_löks
) {

6263 
îr
 = -
EINVAL
;

6264 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6265 
out
;

6266 } i‡(
wdev
->
u
.
≠
.
¥e£t_ch™def
.
ch™
) {

6267 
∑øms
->
ch™def
 = 
wdev
->
u
.
≠
.
¥e£t_ch™def
;

6268 } i‡(!
	`∆80211_gë_≠_ch™√l
(
rdev
, 
∑øms
)) {

6269 
îr
 = -
EINVAL
;

6270 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6271 
out
;

6274 i‡(!
	`cfg80211_ªg_ˇn_bóc⁄_ªœx
(&
rdev
->
wùhy
, &
∑øms
->
ch™def
,

6275 
wdev
->
i·y≥
)) {

6276 
îr
 = -
EINVAL
;

6277 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6278 
out
;

6281 i‡(
öfo
->
©ås
[
NL80211_ATTR_TX_RATES
]) {

6282 
îr
 = 
	`∆80211_∑r£_tx_bôøã_mask
(
öfo
, info->
©ås
,

6283 
NL80211_ATTR_TX_RATES
,

6284 &
∑øms
->
bóc⁄_øã
,

6285 
dev
, 
Ál£
, 
lök_id
);

6286 i‡(
îr
) {

6287 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6288 
out
;

6291 
îr
 = 
	`vÆid©e_bóc⁄_tx_øã
(
rdev
, 
∑øms
->
ch™def
.
ch™
->
b™d
,

6292 &
∑øms
->
bóc⁄_øã
);

6293 i‡(
îr
) {

6294 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6295 
out
;

6299 i‡(
öfo
->
©ås
[
NL80211_ATTR_SMPS_MODE
]) {

6300 
∑øms
->
smps_mode
 =

6301 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_SMPS_MODE
]);

6302 
∑øms
->
smps_mode
) {

6303 
NL80211_SMPS_OFF
:

6304 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6306 
NL80211_SMPS_STATIC
:

6307 i‡(!(
rdev
->
wùhy
.
„©uªs
 &

6308 
NL80211_FEATURE_STATIC_SMPS
)) {

6309 
îr
 = -
EINVAL
;

6310 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6311 
out
;

6313 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6315 
NL80211_SMPS_DYNAMIC
:

6316 i‡(!(
rdev
->
wùhy
.
„©uªs
 &

6317 
NL80211_FEATURE_DYNAMIC_SMPS
)) {

6318 
îr
 = -
EINVAL
;

6319 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6320 
out
;

6322 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6325 
îr
 = -
EINVAL
;

6326 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6327 
out
;

6330 
∑øms
->
smps_mode
 = 
NL80211_SMPS_OFF
;

6333 
∑øms
->
pbss
 = 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_PBSS
]);

6334 i‡(
∑øms
->
pbss
 && !
rdev
->
wùhy
.
b™ds
[
NL80211_BAND_60GHZ
]) {

6335 
îr
 = -
EOPNOTSUPP
;

6336 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6337 
out
;

6340 i‡(
öfo
->
©ås
[
NL80211_ATTR_ACL_POLICY
]) {

6341 
∑øms
->
a˛
 = 
	`∑r£_a˛_d©a
(&
rdev
->
wùhy
, 
öfo
);

6342 i‡(
	`IS_ERR
(
∑øms
->
a˛
)) {

6343 
îr
 = 
	`PTR_ERR
(
∑øms
->
a˛
);

6344 
∑øms
->
a˛
 = 
NULL
;

6345 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6346 
out
;

6350 
∑øms
->
twt_ª•⁄dî
 =

6351 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_TWT_RESPONDER
]);

6353 i‡(
öfo
->
©ås
[
NL80211_ATTR_HE_OBSS_PD
]) {

6354 
îr
 = 
	`∆80211_∑r£_he_obss_pd
(

6355 
öfo
->
©ås
[
NL80211_ATTR_HE_OBSS_PD
],

6356 &
∑øms
->
he_obss_pd
);

6357 i‡(
îr
) {

6358 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6359 
out
;

6363 i‡(
öfo
->
©ås
[
NL80211_ATTR_FILS_DISCOVERY
]) {

6364 
îr
 = 
	`∆80211_∑r£_fûs_discovîy
(
rdev
,

6365 
öfo
->
©ås
[
NL80211_ATTR_FILS_DISCOVERY
],

6366 &
∑øms
->
fûs_discovîy
);

6367 i‡(
îr
) {

6368 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6369 
out
;

6373 i‡(
öfo
->
©ås
[
NL80211_ATTR_UNSOL_BCAST_PROBE_RESP
]) {

6374 
îr
 = 
	`∆80211_∑r£_unsﬁ_bˇ°_¥obe_ª•
(

6375 
rdev
, 
öfo
->
©ås
[
NL80211_ATTR_UNSOL_BCAST_PROBE_RESP
],

6376 &
∑øms
->
unsﬁ_bˇ°_¥obe_ª•
);

6377 i‡(
îr
) {

6378 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6379 
out
;

6383 i‡(
öfo
->
©ås
[
NL80211_ATTR_MBSSID_CONFIG
]) {

6384 
îr
 = 
	`∆80211_∑r£_mbssid_c⁄fig
(&
rdev
->
wùhy
, 
dev
,

6385 
öfo
->
©ås
[
NL80211_ATTR_MBSSID_CONFIG
],

6386 &
∑øms
->
mbssid_c⁄fig
,

6387 
∑øms
->
bóc⁄
.
mbssid_õs
 ?

6388 
∑øms
->
bóc⁄
.
mbssid_õs
->
˙t
 :

6390 i‡(
îr
) {

6391 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6392 
out
;

6396 i‡(!
∑øms
->
mbssid_c⁄fig
.
ema
 &&Ö¨ams->
bóc⁄
.
∫r_õs
) {

6397 
îr
 = -
EINVAL
;

6398 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6399 
out
;

6402 
îr
 = 
	`∆80211_ˇlcuœã_≠_∑øms
(
∑øms
);

6403 i‡(
îr
) {

6404 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6405 
out
;

6408 
îr
 = 
	`∆80211_vÆid©e_≠_phy_›î©i⁄
(
∑øms
);

6409 i‡(
îr
) {

6410 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6411 
out
;

6414 i‡(
öfo
->
©ås
[
NL80211_ATTR_AP_SETTINGS_FLAGS
])

6415 
∑øms
->
Êags
 = 
	`∆a_gë_u32
(

6416 
öfo
->
©ås
[
NL80211_ATTR_AP_SETTINGS_FLAGS
]);

6417 i‡(
öfo
->
©ås
[
NL80211_ATTR_EXTERNAL_AUTH_SUPPORT
])

6418 
∑øms
->
Êags
 |
NL80211_AP_SETTINGS_EXTERNAL_AUTH_SUPPORT
;

6420 i‡(
wdev
->
c⁄n_ow√r_∆p‹tid
 &&

6421 
öfo
->
©ås
[
NL80211_ATTR_SOCKET_OWNER
] &&

6422 
wdev
->
c⁄n_ow√r_∆p‹tid
 !
öfo
->
¢d_p‹tid
) {

6423 
îr
 = -
EINVAL
;

6424 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6425 
out
;

6430 
îr
 = 
	`rdev_°¨t_≠
(
rdev
, 
dev
, 
∑øms
);

6431 i‡(!
îr
) {

6432 
wdev
->
löks
[
lök_id
].
≠
.
bóc⁄_öãrvÆ
 = 
∑øms
->beacon_interval;

6433 
wdev
->
löks
[
lök_id
].
≠
.
ch™def
 = 
∑øms
->chandef;

6434 
wdev
->
u
.
≠
.
ssid_Àn
 = 
∑øms
->ssid_len;

6435 
	`mem˝y
(
wdev
->
u
.
≠
.
ssid
, 
∑øms
->ssid,

6436 
∑øms
->
ssid_Àn
);

6438 i‡(
öfo
->
©ås
[
NL80211_ATTR_SOCKET_OWNER
])

6439 
wdev
->
c⁄n_ow√r_∆p‹tid
 = 
öfo
->
¢d_p‹tid
;

6441 
	`∆80211_£nd_≠_°¨ãd
(
wdev
, 
lök_id
);

6443 
out
:

6444 
	`k‰ì
(
∑øms
->
a˛
);

6445 
	`k‰ì
(
∑øms
->
bóc⁄
.
mbssid_õs
);

6446 i‡(
∑øms
->
mbssid_c⁄fig
.
tx_wdev
 &&

6447 
∑øms
->
mbssid_c⁄fig
.
tx_wdev
->
√tdev
 &&

6448 
∑øms
->
mbssid_c⁄fig
.
tx_wdev
->
√tdev
 !
dev
)

6449 
	`dev_put
(
∑øms
->
mbssid_c⁄fig
.
tx_wdev
->
√tdev
);

6450 
	`k‰ì
(
∑øms
->
bóc⁄
.
∫r_õs
);

6451 
	`k‰ì
(
∑øms
);

6453 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6454  
îr
;

6455 
	}
}

6457 
	$∆80211_£t_bóc⁄
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

6459 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

6460 
lök_id
 = 
	`∆80211_lök_id
(
öfo
->
©ås
);

6461 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

6462 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

6463 
cfg80211_≠_upd©e
 *
∑øms
;

6464 
∆©å
 *
©å
;

6465 
îr
;

6467 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

6469 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

6470 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

6471 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6472  -
EOPNOTSUPP
;

6475 i‡(!
rdev
->
›s
->
ch™ge_bóc⁄
) {

6476 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6477  -
EOPNOTSUPP
;

6480 i‡(!
wdev
->
löks
[
lök_id
].
≠
.
bóc⁄_öãrvÆ
) {

6481 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6482  -
EINVAL
;

6485 
∑øms
 = 
	`kzÆloc
((*∑øms), 
GFP_KERNEL
);

6486 i‡(!
∑øms
) {

6487 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6488  -
ENOMEM
;

6491 
îr
 = 
	`∆80211_∑r£_bóc⁄
(
rdev
, 
öfo
->
©ås
, &
∑øms
->
bóc⁄
,

6492 
öfo
->
exèck
);

6493 i‡(
îr
) {

6494 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6495 
out
;

6498 
©å
 = 
öfo
->
©ås
[
NL80211_ATTR_FILS_DISCOVERY
];

6499 i‡(
©å
) {

6500 
îr
 = 
	`∆80211_∑r£_fûs_discovîy
(
rdev
, 
©å
,

6501 &
∑øms
->
fûs_discovîy
);

6502 i‡(
îr
) {

6503 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6504 
out
;

6508 
©å
 = 
öfo
->
©ås
[
NL80211_ATTR_UNSOL_BCAST_PROBE_RESP
];

6509 i‡(
©å
) {

6510 
îr
 = 
	`∆80211_∑r£_unsﬁ_bˇ°_¥obe_ª•
(
rdev
, 
©å
,

6511 &
∑øms
->
unsﬁ_bˇ°_¥obe_ª•
);

6512 i‡(
îr
) {

6513 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6514 
out
;

6518 
îr
 = 
	`rdev_ch™ge_bóc⁄
(
rdev
, 
dev
, 
∑øms
);

6520 
out
:

6521 
	`k‰ì
(
∑øms
->
bóc⁄
.
mbssid_õs
);

6522 
	`k‰ì
(
∑øms
->
bóc⁄
.
∫r_õs
);

6523 
	`k‰ì
(
∑øms
);

6524 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6525  
îr
;

6526 
	}
}

6528 
	$∆80211_°›_≠
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

6530 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

6531 
lök_id
 = 
	`∆80211_lök_id
(
öfo
->
©ås
);

6532 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

6533 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

6535 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

6536  
	`cfg80211_°›_≠
(
rdev
, 
dev
, 
lök_id
, 
Ál£
);

6537 
	}
}

6539 c⁄° 
∆a_pﬁicy
 
	g°a_Êags_pﬁicy
[
NL80211_STA_FLAG_MAX
 + 1] = {

6540 [
NL80211_STA_FLAG_AUTHORIZED
] = { .
ty≥
 = 
NLA_FLAG
 },

6541 [
NL80211_STA_FLAG_SHORT_PREAMBLE
] = { .
ty≥
 = 
NLA_FLAG
 },

6542 [
NL80211_STA_FLAG_WME
] = { .
ty≥
 = 
NLA_FLAG
 },

6543 [
NL80211_STA_FLAG_MFP
] = { .
ty≥
 = 
NLA_FLAG
 },

6544 [
NL80211_STA_FLAG_AUTHENTICATED
] = { .
ty≥
 = 
NLA_FLAG
 },

6545 [
NL80211_STA_FLAG_TDLS_PEER
] = { .
ty≥
 = 
NLA_FLAG
 },

6548 
	$∑r£_°©i⁄_Êags
(
gíl_öfo
 *
öfo
,

6549 
∆80211_i·y≥
 
i·y≥
,

6550 
°©i⁄_∑ømëîs
 *
∑øms
)

6552 
∆©å
 *
Êags
[
NL80211_STA_FLAG_MAX
 + 1];

6553 
∆©å
 *
∆a
;

6554 
Êag
;

6560 
∆a
 = 
öfo
->
©ås
[
NL80211_ATTR_STA_FLAGS2
];

6561 i‡(
∆a
) {

6562 
∆80211_°a_Êag_upd©e
 *
°a_Êags
;

6564 
°a_Êags
 = 
	`∆a_d©a
(
∆a
);

6565 
∑øms
->
°a_Êags_mask
 = 
°a_Êags
->
mask
;

6566 
∑øms
->
°a_Êags_£t
 = 
°a_Êags
->
£t
;

6567 
∑øms
->
°a_Êags_£t
 &∑øms->
°a_Êags_mask
;

6568 i‡((
∑øms
->
°a_Êags_mask
 |

6569 
∑øms
->
°a_Êags_£t
Ë& 
	`BIT
(
__NL80211_STA_FLAG_INVALID
))

6570  -
EINVAL
;

6576 
∆a
 = 
öfo
->
©ås
[
NL80211_ATTR_STA_FLAGS
];

6577 i‡(!
∆a
)

6580 i‡(
	`∆a_∑r£_√°ed_dïªˇãd
(
Êags
, 
NL80211_STA_FLAG_MAX
, 
∆a
, 
°a_Êags_pﬁicy
, 
öfo
->
exèck
))

6581  -
EINVAL
;

6589 
i·y≥
) {

6590 
NL80211_IFTYPE_AP
:

6591 
NL80211_IFTYPE_AP_VLAN
:

6592 
NL80211_IFTYPE_P2P_GO
:

6593 
∑øms
->
°a_Êags_mask
 = 
	`BIT
(
NL80211_STA_FLAG_AUTHORIZED
) |

6594 
	`BIT
(
NL80211_STA_FLAG_SHORT_PREAMBLE
) |

6595 
	`BIT
(
NL80211_STA_FLAG_WME
) |

6596 
	`BIT
(
NL80211_STA_FLAG_MFP
);

6598 
NL80211_IFTYPE_P2P_CLIENT
:

6599 
NL80211_IFTYPE_STATION
:

6600 
∑øms
->
°a_Êags_mask
 = 
	`BIT
(
NL80211_STA_FLAG_AUTHORIZED
) |

6601 
	`BIT
(
NL80211_STA_FLAG_TDLS_PEER
);

6603 
NL80211_IFTYPE_MESH_POINT
:

6604 
∑øms
->
°a_Êags_mask
 = 
	`BIT
(
NL80211_STA_FLAG_AUTHENTICATED
) |

6605 
	`BIT
(
NL80211_STA_FLAG_MFP
) |

6606 
	`BIT
(
NL80211_STA_FLAG_AUTHORIZED
);

6609  -
EINVAL
;

6612 
Êag
 = 1; fœg <
NL80211_STA_FLAG_MAX
; flag++) {

6613 i‡(
Êags
[
Êag
]) {

6614 
∑øms
->
°a_Êags_£t
 |(1<<
Êag
);

6617 i‡(
Êag
 > 
NL80211_STA_FLAG_MAX_OLD_API
)

6618  -
EINVAL
;

6623 
	}
}

6625 
boﬁ
 
	$∆80211_put_°a_øã
(
sk_buff
 *
msg
, 
øã_öfo
 *
öfo
, 
©å
)

6627 
∆©å
 *
øã
;

6628 
u32
 
bôøã
;

6629 
u16
 
bôøã_com∑t
;

6630 
∆80211_øã_öfo
 
øã_Êg
;

6632 
øã
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
©å
);

6633 i‡(!
øã
)

6634  
Ál£
;

6637 
bôøã
 = 
	`cfg80211_ˇlcuœã_bôøã
(
öfo
);

6639 
bôøã_com∑t
 = 
bôøã
 < (1UL << 16) ? bitrate : 0;

6640 i‡(
bôøã
 > 0 &&

6641 
	`∆a_put_u32
(
msg
, 
NL80211_RATE_INFO_BITRATE32
, 
bôøã
))

6642  
Ál£
;

6643 i‡(
bôøã_com∑t
 > 0 &&

6644 
	`∆a_put_u16
(
msg
, 
NL80211_RATE_INFO_BITRATE
, 
bôøã_com∑t
))

6645  
Ál£
;

6647 
öfo
->
bw
) {

6648 
RATE_INFO_BW_1
:

6649 
øã_Êg
 = 
NL80211_RATE_INFO_1_MHZ_WIDTH
;

6651 
RATE_INFO_BW_2
:

6652 
øã_Êg
 = 
NL80211_RATE_INFO_2_MHZ_WIDTH
;

6654 
RATE_INFO_BW_4
:

6655 
øã_Êg
 = 
NL80211_RATE_INFO_4_MHZ_WIDTH
;

6657 
RATE_INFO_BW_5
:

6658 
øã_Êg
 = 
NL80211_RATE_INFO_5_MHZ_WIDTH
;

6660 
RATE_INFO_BW_8
:

6661 
øã_Êg
 = 
NL80211_RATE_INFO_8_MHZ_WIDTH
;

6663 
RATE_INFO_BW_10
:

6664 
øã_Êg
 = 
NL80211_RATE_INFO_10_MHZ_WIDTH
;

6666 
RATE_INFO_BW_16
:

6667 
øã_Êg
 = 
NL80211_RATE_INFO_16_MHZ_WIDTH
;

6670 
	`WARN_ON
(1);

6671 
ÁŒthrough
;

6672 
RATE_INFO_BW_20
:

6673 
øã_Êg
 = 0;

6675 
RATE_INFO_BW_40
:

6676 
øã_Êg
 = 
NL80211_RATE_INFO_40_MHZ_WIDTH
;

6678 
RATE_INFO_BW_80
:

6679 
øã_Êg
 = 
NL80211_RATE_INFO_80_MHZ_WIDTH
;

6681 
RATE_INFO_BW_160
:

6682 
øã_Êg
 = 
NL80211_RATE_INFO_160_MHZ_WIDTH
;

6684 
RATE_INFO_BW_HE_RU
:

6685 
øã_Êg
 = 0;

6686 
	`WARN_ON
(!(
öfo
->
Êags
 & 
RATE_INFO_FLAGS_HE_MCS
));

6688 
RATE_INFO_BW_320
:

6689 
øã_Êg
 = 
NL80211_RATE_INFO_320_MHZ_WIDTH
;

6691 
RATE_INFO_BW_EHT_RU
:

6692 
øã_Êg
 = 0;

6693 
	`WARN_ON
(!(
öfo
->
Êags
 & 
RATE_INFO_FLAGS_EHT_MCS
));

6697 i‡(
øã_Êg
 && 
	`∆a_put_Êag
(
msg
,Ñate_flg))

6698  
Ál£
;

6700 i‡(
öfo
->
Êags
 & 
RATE_INFO_FLAGS_MCS
) {

6701 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_MCS
, 
öfo
->
mcs
))

6702  
Ál£
;

6703 i‡(
öfo
->
Êags
 & 
RATE_INFO_FLAGS_SHORT_GI
 &&

6704 
	`∆a_put_Êag
(
msg
, 
NL80211_RATE_INFO_SHORT_GI
))

6705  
Ál£
;

6706 } i‡(
öfo
->
Êags
 & 
RATE_INFO_FLAGS_VHT_MCS
) {

6707 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_VHT_MCS
, 
öfo
->
mcs
))

6708  
Ál£
;

6709 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_VHT_NSS
, 
öfo
->
nss
))

6710  
Ál£
;

6711 i‡(
öfo
->
Êags
 & 
RATE_INFO_FLAGS_SHORT_GI
 &&

6712 
	`∆a_put_Êag
(
msg
, 
NL80211_RATE_INFO_SHORT_GI
))

6713  
Ál£
;

6714 } i‡(
öfo
->
Êags
 & 
RATE_INFO_FLAGS_HE_MCS
) {

6715 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_HE_MCS
, 
öfo
->
mcs
))

6716  
Ál£
;

6717 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_HE_NSS
, 
öfo
->
nss
))

6718  
Ál£
;

6719 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_HE_GI
, 
öfo
->
he_gi
))

6720  
Ál£
;

6721 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_HE_DCM
, 
öfo
->
he_dcm
))

6722  
Ál£
;

6723 i‡(
öfo
->
bw
 =
RATE_INFO_BW_HE_RU
 &&

6724 
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_HE_RU_ALLOC
,

6725 
öfo
->
he_ru_Æloc
))

6726  
Ál£
;

6727 } i‡(
öfo
->
Êags
 & 
RATE_INFO_FLAGS_S1G_MCS
) {

6728 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_S1G_MCS
, 
öfo
->
mcs
))

6729  
Ál£
;

6730 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_S1G_NSS
, 
öfo
->
nss
))

6731  
Ál£
;

6732 i‡(
öfo
->
Êags
 & 
RATE_INFO_FLAGS_SHORT_GI
 &&

6733 
	`∆a_put_Êag
(
msg
, 
NL80211_RATE_INFO_SHORT_GI
))

6734  
Ál£
;

6735 } i‡(
öfo
->
Êags
 & 
RATE_INFO_FLAGS_EHT_MCS
) {

6736 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_EHT_MCS
, 
öfo
->
mcs
))

6737  
Ál£
;

6738 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_EHT_NSS
, 
öfo
->
nss
))

6739  
Ál£
;

6740 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_EHT_GI
, 
öfo
->
eht_gi
))

6741  
Ál£
;

6742 i‡(
öfo
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

6743 
	`∆a_put_u8
(
msg
, 
NL80211_RATE_INFO_EHT_RU_ALLOC
,

6744 
öfo
->
eht_ru_Æloc
))

6745  
Ál£
;

6748 
	`∆a_√°_íd
(
msg
, 
øã
);

6749  
åue
;

6750 
	}
}

6752 
boﬁ
 
	$∆80211_put_sig«l
(
sk_buff
 *
msg
, 
u8
 
mask
, 
s8
 *
sig«l
,

6753 
id
)

6755 *
©å
;

6756 
i
 = 0;

6758 i‡(!
mask
)

6759  
åue
;

6761 
©å
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
id
);

6762 i‡(!
©å
)

6763  
Ál£
;

6765 
i
 = 0; i < 
IEEE80211_MAX_CHAINS
; i++) {

6766 i‡(!(
mask
 & 
	`BIT
(
i
)))

6769 i‡(
	`∆a_put_u8
(
msg
, 
i
, 
sig«l
[i]))

6770  
Ál£
;

6773 
	`∆a_√°_íd
(
msg
, 
©å
);

6775  
åue
;

6776 
	}
}

6778 
	$∆80211_£nd_°©i⁄
(
sk_buff
 *
msg
, 
u32
 
cmd
, u32 
p‹tid
,

6779 
u32
 
£q
, 
Êags
,

6780 
cfg80211_ªgi°îed_devi˚
 *
rdev
,

6781 
√t_devi˚
 *
dev
,

6782 c⁄° 
u8
 *
mac_addr
, 
°©i⁄_öfo
 *
söfo
)

6784 *
hdr
;

6785 
∆©å
 *
söfﬂâr
, *
bss_∑øm
;

6787 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
p‹tid
, 
£q
, 
Êags
, 
cmd
);

6788 i‡(!
hdr
) {

6789 
	`cfg80211_söfo_ªÀa£_c⁄ã¡
(
söfo
);

6793 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

6794 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
mac_addr
) ||

6795 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_GENERATION
, 
söfo
->
gíî©i⁄
))

6796 
∆a_put_Áûuª
;

6798 
söfﬂâr
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_STA_INFO
);

6799 i‡(!
söfﬂâr
)

6800 
∆a_put_Áûuª
;

6802 
	#PUT_SINFO
(
©å
, 
memb
, 
ty≥
) do { \

6803 
	`BUILD_BUG_ON
((
ty≥
Ë=(
u64
)); \

6804 i‡(
söfo
->
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_
 ## 
©å
) && \

6805 
∆a_put_
 ## 
	`ty≥
(
msg
, 
NL80211_STA_INFO_
 ## 
©å
, \

6806 
söfo
->
memb
)) \

6807 
∆a_put_Áûuª
; \

6808 } 0)

	)

6809 
	#PUT_SINFO_U64
(
©å
, 
memb
) do { \

6810 i‡(
söfo
->
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_
 ## 
©å
) && \

6811 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_STA_INFO_
 ## 
©å
, \

6812 
söfo
->
memb
, 
NL80211_STA_INFO_PAD
)) \

6813 
∆a_put_Áûuª
; \

6814 } 0)

	)

6816 
	`PUT_SINFO
(
CONNECTED_TIME
, 
c⁄√˘ed_time
, 
u32
);

6817 
	`PUT_SINFO
(
INACTIVE_TIME
, 
öa˘ive_time
, 
u32
);

6818 
	`PUT_SINFO_U64
(
ASSOC_AT_BOOTTIME
, 
assoc_©
);

6820 i‡(
söfo
->
fûÀd
 & (
	`BIT_ULL
(
NL80211_STA_INFO_RX_BYTES
) |

6821 
	`BIT_ULL
(
NL80211_STA_INFO_RX_BYTES64
)) &&

6822 
	`∆a_put_u32
(
msg
, 
NL80211_STA_INFO_RX_BYTES
,

6823 (
u32
)
söfo
->
rx_byãs
))

6824 
∆a_put_Áûuª
;

6826 i‡(
söfo
->
fûÀd
 & (
	`BIT_ULL
(
NL80211_STA_INFO_TX_BYTES
) |

6827 
	`BIT_ULL
(
NL80211_STA_INFO_TX_BYTES64
)) &&

6828 
	`∆a_put_u32
(
msg
, 
NL80211_STA_INFO_TX_BYTES
,

6829 (
u32
)
söfo
->
tx_byãs
))

6830 
∆a_put_Áûuª
;

6832 
	`PUT_SINFO_U64
(
RX_BYTES64
, 
rx_byãs
);

6833 
	`PUT_SINFO_U64
(
TX_BYTES64
, 
tx_byãs
);

6834 
	`PUT_SINFO
(
LLID
, 
Œid
, 
u16
);

6835 
	`PUT_SINFO
(
PLID
, 
∂id
, 
u16
);

6836 
	`PUT_SINFO
(
PLINK_STATE
, 
∂ök_°©e
, 
u8
);

6837 
	`PUT_SINFO_U64
(
RX_DURATION
, 
rx_duøti⁄
);

6838 
	`PUT_SINFO_U64
(
TX_DURATION
, 
tx_duøti⁄
);

6840 i‡(
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

6841 
NL80211_EXT_FEATURE_AIRTIME_FAIRNESS
))

6842 
	`PUT_SINFO
(
AIRTIME_WEIGHT
, 
aútime_weight
, 
u16
);

6844 
rdev
->
wùhy
.
sig«l_ty≥
) {

6845 
CFG80211_SIGNAL_TYPE_MBM
:

6846 
	`PUT_SINFO
(
SIGNAL
, 
sig«l
, 
u8
);

6847 
	`PUT_SINFO
(
SIGNAL_AVG
, 
sig«l_avg
, 
u8
);

6852 i‡(
söfo
->
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_CHAIN_SIGNAL
)) {

6853 i‡(!
	`∆80211_put_sig«l
(
msg
, 
söfo
->
chaös
,

6854 
söfo
->
chaö_sig«l
,

6855 
NL80211_STA_INFO_CHAIN_SIGNAL
))

6856 
∆a_put_Áûuª
;

6858 i‡(
söfo
->
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_CHAIN_SIGNAL_AVG
)) {

6859 i‡(!
	`∆80211_put_sig«l
(
msg
, 
söfo
->
chaös
,

6860 
söfo
->
chaö_sig«l_avg
,

6861 
NL80211_STA_INFO_CHAIN_SIGNAL_AVG
))

6862 
∆a_put_Áûuª
;

6864 i‡(
söfo
->
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_TX_BITRATE
)) {

6865 i‡(!
	`∆80211_put_°a_øã
(
msg
, &
söfo
->
txøã
,

6866 
NL80211_STA_INFO_TX_BITRATE
))

6867 
∆a_put_Áûuª
;

6869 i‡(
söfo
->
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_RX_BITRATE
)) {

6870 i‡(!
	`∆80211_put_°a_øã
(
msg
, &
söfo
->
rxøã
,

6871 
NL80211_STA_INFO_RX_BITRATE
))

6872 
∆a_put_Áûuª
;

6875 
	`PUT_SINFO
(
RX_PACKETS
, 
rx_∑ckës
, 
u32
);

6876 
	`PUT_SINFO
(
TX_PACKETS
, 
tx_∑ckës
, 
u32
);

6877 
	`PUT_SINFO
(
TX_RETRIES
, 
tx_ªåõs
, 
u32
);

6878 
	`PUT_SINFO
(
TX_FAILED
, 
tx_Áûed
, 
u32
);

6879 
	`PUT_SINFO
(
EXPECTED_THROUGHPUT
, 
ex≥˘ed_throughput
, 
u32
);

6880 
	`PUT_SINFO
(
AIRTIME_LINK_METRIC
, 
aútime_lök_mëric
, 
u32
);

6881 
	`PUT_SINFO
(
BEACON_LOSS
, 
bóc⁄_loss_cou¡
, 
u32
);

6882 
	`PUT_SINFO
(
LOCAL_PM
, 
loˇl_pm
, 
u32
);

6883 
	`PUT_SINFO
(
PEER_PM
, 
≥î_pm
, 
u32
);

6884 
	`PUT_SINFO
(
NONPEER_PM
, 
n⁄≥î_pm
, 
u32
);

6885 
	`PUT_SINFO
(
CONNECTED_TO_GATE
, 
c⁄√˘ed_to_g©e
, 
u8
);

6886 
	`PUT_SINFO
(
CONNECTED_TO_AS
, 
c⁄√˘ed_to_as
, 
u8
);

6888 i‡(
söfo
->
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_BSS_PARAM
)) {

6889 
bss_∑øm
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

6890 
NL80211_STA_INFO_BSS_PARAM
);

6891 i‡(!
bss_∑øm
)

6892 
∆a_put_Áûuª
;

6894 i‡(((
söfo
->
bss_∑øm
.
Êags
 & 
BSS_PARAM_FLAGS_CTS_PROT
) &&

6895 
	`∆a_put_Êag
(
msg
, 
NL80211_STA_BSS_PARAM_CTS_PROT
)) ||

6896 ((
söfo
->
bss_∑øm
.
Êags
 & 
BSS_PARAM_FLAGS_SHORT_PREAMBLE
) &&

6897 
	`∆a_put_Êag
(
msg
, 
NL80211_STA_BSS_PARAM_SHORT_PREAMBLE
)) ||

6898 ((
söfo
->
bss_∑øm
.
Êags
 & 
BSS_PARAM_FLAGS_SHORT_SLOT_TIME
) &&

6899 
	`∆a_put_Êag
(
msg
, 
NL80211_STA_BSS_PARAM_SHORT_SLOT_TIME
)) ||

6900 
	`∆a_put_u8
(
msg
, 
NL80211_STA_BSS_PARAM_DTIM_PERIOD
,

6901 
söfo
->
bss_∑øm
.
dtim_≥riod
) ||

6902 
	`∆a_put_u16
(
msg
, 
NL80211_STA_BSS_PARAM_BEACON_INTERVAL
,

6903 
söfo
->
bss_∑øm
.
bóc⁄_öãrvÆ
))

6904 
∆a_put_Áûuª
;

6906 
	`∆a_√°_íd
(
msg
, 
bss_∑øm
);

6908 i‡((
söfo
->
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_STA_FLAGS
)) &&

6909 
	`∆a_put
(
msg
, 
NL80211_STA_INFO_STA_FLAGS
,

6910 (
∆80211_°a_Êag_upd©e
),

6911 &
söfo
->
°a_Êags
))

6912 
∆a_put_Áûuª
;

6914 
	`PUT_SINFO_U64
(
T_OFFSET
, 
t_off£t
);

6915 
	`PUT_SINFO_U64
(
RX_DROP_MISC
, 
rx_dr›≥d_misc
);

6916 
	`PUT_SINFO_U64
(
BEACON_RX
, 
rx_bóc⁄
);

6917 
	`PUT_SINFO
(
BEACON_SIGNAL_AVG
, 
rx_bóc⁄_sig«l_avg
, 
u8
);

6918 
	`PUT_SINFO
(
RX_MPDUS
, 
rx_mpdu_cou¡
, 
u32
);

6919 
	`PUT_SINFO
(
FCS_ERROR_COUNT
, 
fcs_îr_cou¡
, 
u32
);

6920 i‡(
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

6921 
NL80211_EXT_FEATURE_ACK_SIGNAL_SUPPORT
)) {

6922 
	`PUT_SINFO
(
ACK_SIGNAL
, 
ack_sig«l
, 
u8
);

6923 
	`PUT_SINFO
(
ACK_SIGNAL_AVG
, 
avg_ack_sig«l
, 
s8
);

6926 #unde‡
PUT_SINFO


6927 #unde‡
PUT_SINFO_U64


6929 i‡(
söfo
->
≥πid
) {

6930 
∆©å
 *
tidßâr
;

6931 
tid
;

6933 
tidßâr
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

6934 
NL80211_STA_INFO_TID_STATS
);

6935 i‡(!
tidßâr
)

6936 
∆a_put_Áûuª
;

6938 
tid
 = 0;Åid < 
IEEE80211_NUM_TIDS
 + 1;Åid++) {

6939 
cfg80211_tid_°©s
 *
tid°©s
;

6940 
∆©å
 *
tid©å
;

6942 
tid°©s
 = &
söfo
->
≥πid
[
tid
];

6944 i‡(!
tid°©s
->
fûÀd
)

6947 
tid©å
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
tid
 + 1);

6948 i‡(!
tid©å
)

6949 
∆a_put_Áûuª
;

6951 
	#PUT_TIDVAL_U64
(
©å
, 
memb
) do { \

6952 i‡(
tid°©s
->
fûÀd
 & 
	`BIT
(
NL80211_TID_STATS_
 ## 
©å
) && \

6953 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_TID_STATS_
 ## 
©å
, \

6954 
tid°©s
->
memb
, 
NL80211_TID_STATS_PAD
)) \

6955 
∆a_put_Áûuª
; \

6956 } 0)

	)

6958 
	`PUT_TIDVAL_U64
(
RX_MSDU
, 
rx_msdu
);

6959 
	`PUT_TIDVAL_U64
(
TX_MSDU
, 
tx_msdu
);

6960 
	`PUT_TIDVAL_U64
(
TX_MSDU_RETRIES
, 
tx_msdu_ªåõs
);

6961 
	`PUT_TIDVAL_U64
(
TX_MSDU_FAILED
, 
tx_msdu_Áûed
);

6963 #unde‡
PUT_TIDVAL_U64


6964 i‡((
tid°©s
->
fûÀd
 &

6965 
	`BIT
(
NL80211_TID_STATS_TXQ_STATS
)) &&

6966 !
	`∆80211_put_txq_°©s
(
msg
, &
tid°©s
->
txq_°©s
,

6967 
NL80211_TID_STATS_TXQ_STATS
))

6968 
∆a_put_Áûuª
;

6970 
	`∆a_√°_íd
(
msg
, 
tid©å
);

6973 
	`∆a_√°_íd
(
msg
, 
tidßâr
);

6976 
	`∆a_√°_íd
(
msg
, 
söfﬂâr
);

6978 i‡(
söfo
->
assoc_ªq_õs_Àn
 &&

6979 
	`∆a_put
(
msg
, 
NL80211_ATTR_IE
, 
söfo
->
assoc_ªq_õs_Àn
,

6980 
söfo
->
assoc_ªq_õs
))

6981 
∆a_put_Áûuª
;

6983 i‡(
söfo
->
assoc_ª•_õs_Àn
 &&

6984 
	`∆a_put
(
msg
, 
NL80211_ATTR_RESP_IE
, 
söfo
->
assoc_ª•_õs_Àn
,

6985 
söfo
->
assoc_ª•_õs
))

6986 
∆a_put_Áûuª
;

6988 i‡(
söfo
->
mlo_∑øms_vÆid
) {

6989 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MLO_LINK_ID
,

6990 
söfo
->
assoc_lök_id
))

6991 
∆a_put_Áûuª
;

6993 i‡(!
	`is_zîo_ëhî_addr
(
söfo
->
mld_addr
) &&

6994 
	`∆a_put
(
msg
, 
NL80211_ATTR_MLD_ADDR
, 
ETH_ALEN
,

6995 
söfo
->
mld_addr
))

6996 
∆a_put_Áûuª
;

6999 
	`cfg80211_söfo_ªÀa£_c⁄ã¡
(
söfo
);

7000 
	`gílmsg_íd
(
msg
, 
hdr
);

7003 
∆a_put_Áûuª
:

7004 
	`cfg80211_söfo_ªÀa£_c⁄ã¡
(
söfo
);

7005 
	`gílmsg_ˇn˚l
(
msg
, 
hdr
);

7006  -
EMSGSIZE
;

7007 
	}
}

7009 
	$∆80211_dump_°©i⁄
(
sk_buff
 *
skb
,

7010 
√éök_ˇŒback
 *
cb
)

7012 
°©i⁄_öfo
 
söfo
;

7013 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

7014 
wúñess_dev
 *
wdev
;

7015 
u8
 
mac_addr
[
ETH_ALEN
];

7016 
°a_idx
 = 
cb
->
¨gs
[2];

7017 
îr
;

7019 
îr
 = 
	`∆80211_¥ï¨e_wdev_dump
(
cb
, &
rdev
, &
wdev
, 
NULL
);

7020 i‡(
îr
)

7021  
îr
;

7023 
	`__acquúe
(&
rdev
->
wùhy
.
mtx
);

7025 i‡(!
wdev
->
√tdev
) {

7026 
îr
 = -
EINVAL
;

7027 
out_îr
;

7030 i‡(!
rdev
->
›s
->
dump_°©i⁄
) {

7031 
îr
 = -
EOPNOTSUPP
;

7032 
out_îr
;

7036 
	`mem£t
(&
söfo
, 0, (sinfo));

7037 
îr
 = 
	`rdev_dump_°©i⁄
(
rdev
, 
wdev
->
√tdev
, 
°a_idx
,

7038 
mac_addr
, &
söfo
);

7039 i‡(
îr
 =-
ENOENT
)

7041 i‡(
îr
)

7042 
out_îr
;

7044 i‡(
	`∆80211_£nd_°©i⁄
(
skb
, 
NL80211_CMD_NEW_STATION
,

7045 
	`NETLINK_CB
(
cb
->
skb
).
p‹tid
,

7046 
cb
->
∆h
->
∆msg_£q
, 
NLM_F_MULTI
,

7047 
rdev
, 
wdev
->
√tdev
, 
mac_addr
,

7048 &
söfo
) < 0)

7049 
out
;

7051 
°a_idx
++;

7054 
out
:

7055 
cb
->
¨gs
[2] = 
°a_idx
;

7056 
îr
 = 
skb
->
Àn
;

7057 
out_îr
:

7058 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

7060  
îr
;

7061 
	}
}

7063 
	$∆80211_gë_°©i⁄
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

7065 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

7066 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

7067 
°©i⁄_öfo
 
söfo
;

7068 
sk_buff
 *
msg
;

7069 
u8
 *
mac_addr
 = 
NULL
;

7070 
îr
;

7072 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

7074 
	`mem£t
(&
söfo
, 0, (sinfo));

7076 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

7077 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7078  -
EINVAL
;

7081 
mac_addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

7083 i‡(!
rdev
->
›s
->
gë_°©i⁄
) {

7084 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7085  -
EOPNOTSUPP
;

7088 
îr
 = 
	`rdev_gë_°©i⁄
(
rdev
, 
dev
, 
mac_addr
, &
söfo
);

7089 i‡(
îr
) {

7090 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7091  
îr
;

7094 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

7095 i‡(!
msg
) {

7096 
	`cfg80211_söfo_ªÀa£_c⁄ã¡
(&
söfo
);

7097 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7098  -
ENOMEM
;

7101 i‡(
	`∆80211_£nd_°©i⁄
(
msg
, 
NL80211_CMD_NEW_STATION
,

7102 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

7103 
rdev
, 
dev
, 
mac_addr
, &
söfo
) < 0) {

7104 
	`∆msg_‰ì
(
msg
);

7105 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7106  -
ENOBUFS
;

7109 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7110  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

7111 
	}
}

7113 
	$cfg80211_check_°©i⁄_ch™ge
(
wùhy
 *wiphy,

7114 
°©i⁄_∑ømëîs
 *
∑øms
,

7115 
cfg80211_°©i⁄_ty≥
 
°©y≥
)

7117 i‡(
∑øms
->
li°í_öãrvÆ
 != -1 &&

7118 
°©y≥
 !
CFG80211_STA_AP_CLIENT_UNASSOC
)

7119  -
EINVAL
;

7121 i‡(
∑øms
->
suµ‹t_p2p_ps
 != -1 &&

7122 
°©y≥
 !
CFG80211_STA_AP_CLIENT_UNASSOC
)

7123  -
EINVAL
;

7125 i‡(
∑øms
->
aid
 &&

7126 !(
∑øms
->
°a_Êags_£t
 & 
	`BIT
(
NL80211_STA_FLAG_TDLS_PEER
)) &&

7127 
°©y≥
 !
CFG80211_STA_AP_CLIENT_UNASSOC
)

7128  -
EINVAL
;

7131 
	`BUILD_BUG_ON
(
NL80211_STA_FLAG_MAX
 != 8);

7133 
°©y≥
) {

7134 
CFG80211_STA_MESH_PEER_KERNEL
:

7135 
CFG80211_STA_MESH_PEER_USER
:

7141 i‡(
∑øms
->
°a_Êags_mask
 &

7142 ~(
	`BIT
(
NL80211_STA_FLAG_AUTHENTICATED
) |

7143 
	`BIT
(
NL80211_STA_FLAG_MFP
) |

7144 
	`BIT
(
NL80211_STA_FLAG_AUTHORIZED
)))

7145  -
EINVAL
;

7147 
CFG80211_STA_TDLS_PEER_SETUP
:

7148 
CFG80211_STA_TDLS_PEER_ACTIVE
:

7149 i‡(!(
∑øms
->
°a_Êags_£t
 & 
	`BIT
(
NL80211_STA_FLAG_TDLS_PEER
)))

7150  -
EINVAL
;

7152 
∑øms
->
°a_Êags_mask
 &~
	`BIT
(
NL80211_STA_FLAG_TDLS_PEER
);

7156 i‡(
∑øms
->
∂ök_a˘i⁄
 !
NL80211_PLINK_ACTION_NO_ACTION
)

7157  -
EINVAL
;

7158 i‡(
∑øms
->
loˇl_pm
)

7159  -
EINVAL
;

7160 i‡(
∑øms
->
°a_modify_mask
 & 
STATION_PARAM_APPLY_PLINK_STATE
)

7161  -
EINVAL
;

7164 i‡(
°©y≥
 !
CFG80211_STA_TDLS_PEER_SETUP
 &&

7165 
°©y≥
 !
CFG80211_STA_TDLS_PEER_ACTIVE
) {

7167 i‡(
∑øms
->
°a_Êags_£t
 & 
	`BIT
(
NL80211_STA_FLAG_TDLS_PEER
))

7168  -
EINVAL
;

7174 
∑øms
->
°a_Êags_mask
 &~
	`BIT
(
NL80211_STA_FLAG_TDLS_PEER
);

7177 i‡(
°©y≥
 !
CFG80211_STA_TDLS_PEER_SETUP
 &&

7178 
°©y≥
 !
CFG80211_STA_AP_CLIENT_UNASSOC
) {

7180 i‡(
∑øms
->
°a_modify_mask
 & 
STATION_PARAM_APPLY_UAPSD
)

7181  -
EINVAL
;

7182 i‡(
∑øms
->
°a_modify_mask
 & 
STATION_PARAM_APPLY_CAPABILITY
)

7183  -
EINVAL
;

7184 i‡(
∑øms
->
lök_°a_∑øms
.
suµ‹ãd_øãs
)

7185  -
EINVAL
;

7186 i‡(
∑øms
->
ext_ˇ∑b
 ||Ö¨ams->
lök_°a_∑øms
.
ht_ˇ∑
 ||

7187 
∑øms
->
lök_°a_∑øms
.
vht_ˇ∑
 ||

7188 
∑øms
->
lök_°a_∑øms
.
he_ˇ∑
 ||

7189 
∑øms
->
lök_°a_∑øms
.
eht_ˇ∑
)

7190  -
EINVAL
;

7191 i‡(
∑øms
->
°a_Êags_mask
 & 
	`BIT
(
NL80211_STA_FLAG_SPP_AMSDU
))

7192  -
EINVAL
;

7195 i‡(
°©y≥
 !
CFG80211_STA_AP_CLIENT
 &&

7196 
°©y≥
 !
CFG80211_STA_AP_CLIENT_UNASSOC
) {

7197 i‡(
∑øms
->
vœn
)

7198  -
EINVAL
;

7201 
°©y≥
) {

7202 
CFG80211_STA_AP_MLME_CLIENT
:

7204 i‡(!(
∑øms
->
°a_Êags_mask
 & 
	`BIT
(
NL80211_STA_FLAG_AUTHORIZED
)))

7205  -
EOPNOTSUPP
;

7207 
CFG80211_STA_AP_CLIENT
:

7208 
CFG80211_STA_AP_CLIENT_UNASSOC
:

7210 i‡(
∑øms
->
°a_Êags_mask
 &

7211 ~(
	`BIT
(
NL80211_STA_FLAG_AUTHORIZED
) |

7212 
	`BIT
(
NL80211_STA_FLAG_AUTHENTICATED
) |

7213 
	`BIT
(
NL80211_STA_FLAG_ASSOCIATED
) |

7214 
	`BIT
(
NL80211_STA_FLAG_SHORT_PREAMBLE
) |

7215 
	`BIT
(
NL80211_STA_FLAG_WME
) |

7216 
	`BIT
(
NL80211_STA_FLAG_MFP
) |

7217 
	`BIT
(
NL80211_STA_FLAG_SPP_AMSDU
)))

7218  -
EINVAL
;

7221 i‡(!(
wùhy
->
„©uªs
 & 
NL80211_FEATURE_FULL_AP_CLIENT_STATE
) &&

7222 
∑øms
->
°a_Êags_mask
 &

7223 (
	`BIT
(
NL80211_STA_FLAG_AUTHENTICATED
) |

7224 
	`BIT
(
NL80211_STA_FLAG_ASSOCIATED
)))

7225  -
EINVAL
;

7227 
CFG80211_STA_IBSS
:

7228 
CFG80211_STA_AP_STA
:

7230 i‡(
∑øms
->
°a_Êags_mask
 & ~
	`BIT
(
NL80211_STA_FLAG_AUTHORIZED
))

7231  -
EINVAL
;

7233 
CFG80211_STA_TDLS_PEER_SETUP
:

7235 i‡(
∑øms
->
°a_Êags_mask
 & ~(
	`BIT
(
NL80211_STA_FLAG_AUTHORIZED
) |

7236 
	`BIT
(
NL80211_STA_FLAG_WME
)))

7237  -
EINVAL
;

7239 i‡(
∑øms
->
°a_Êags_£t
 & 
	`BIT
(
NL80211_STA_FLAG_AUTHORIZED
) &&

7240 !
∑øms
->
lök_°a_∑øms
.
suµ‹ãd_øãs
)

7241  -
EINVAL
;

7243 
CFG80211_STA_TDLS_PEER_ACTIVE
:

7245  -
EINVAL
;

7246 
CFG80211_STA_MESH_PEER_KERNEL
:

7247 i‡(
∑øms
->
°a_modify_mask
 & 
STATION_PARAM_APPLY_PLINK_STATE
)

7248  -
EINVAL
;

7250 
CFG80211_STA_MESH_PEER_USER
:

7251 i‡(
∑øms
->
∂ök_a˘i⁄
 !
NL80211_PLINK_ACTION_NO_ACTION
 &&

7252 
∑øms
->
∂ök_a˘i⁄
 !
NL80211_PLINK_ACTION_BLOCK
)

7253  -
EINVAL
;

7262 i‡(
°©y≥
 !
CFG80211_STA_AP_CLIENT_UNASSOC
 &&

7263 
°©y≥
 !
CFG80211_STA_TDLS_PEER_SETUP
)

7264 
∑øms
->
lök_°a_∑øms
.
›mode_nŸif_u£d
 = 
Ál£
;

7267 
	}
}

7268 
EXPORT_SYMBOL
(
cfg80211_check_°©i⁄_ch™ge
);

7273 
√t_devi˚
 *
	$gë_vœn
(
gíl_öfo
 *
öfo
,

7274 
cfg80211_ªgi°îed_devi˚
 *
rdev
)

7276 
∆©å
 *
vœ«âr
 = 
öfo
->
©ås
[
NL80211_ATTR_STA_VLAN
];

7277 
√t_devi˚
 *
v
;

7278 
ªt
;

7280 i‡(!
vœ«âr
)

7281  
NULL
;

7283 
v
 = 
	`dev_gë_by_ödex
(
	`gíl_öfo_√t
(
öfo
), 
	`∆a_gë_u32
(
vœ«âr
));

7284 i‡(!
v
)

7285  
	`ERR_PTR
(-
ENODEV
);

7287 i‡(!
v
->
õì80211_±r
 || v->õì80211_±r->
wùhy
 !&
rdev
->wiphy) {

7288 
ªt
 = -
EINVAL
;

7289 
îr‹
;

7292 i‡(
v
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_AP_VLAN
 &&

7293 
v
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

7294 
v
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

7295 
ªt
 = -
EINVAL
;

7296 
îr‹
;

7299 i‡(!
	`√tif_ru¬ög
(
v
)) {

7300 
ªt
 = -
ENETDOWN
;

7301 
îr‹
;

7304  
v
;

7305 
îr‹
:

7306 
	`dev_put
(
v
);

7307  
	`ERR_PTR
(
ªt
);

7308 
	}
}

7310 
	$∆80211_∑r£_°a_wme
(
gíl_öfo
 *
öfo
,

7311 
°©i⁄_∑ømëîs
 *
∑øms
)

7313 
∆©å
 *
tb
[
NL80211_STA_WME_MAX
 + 1];

7314 
∆©å
 *
∆a
;

7315 
îr
;

7318 i‡(!
öfo
->
©ås
[
NL80211_ATTR_STA_WME
])

7321 
∆a
 = 
öfo
->
©ås
[
NL80211_ATTR_STA_WME
];

7322 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
NL80211_STA_WME_MAX
, 
∆a
,

7323 
∆80211_°a_wme_pﬁicy
,

7324 
öfo
->
exèck
);

7325 i‡(
îr
)

7326  
îr
;

7328 i‡(
tb
[
NL80211_STA_WME_UAPSD_QUEUES
])

7329 
∑øms
->
u≠sd_queues
 = 
	`∆a_gë_u8
(

7330 
tb
[
NL80211_STA_WME_UAPSD_QUEUES
]);

7331 i‡(
∑øms
->
u≠sd_queues
 & ~
IEEE80211_WMM_IE_STA_QOSINFO_AC_MASK
)

7332  -
EINVAL
;

7334 i‡(
tb
[
NL80211_STA_WME_MAX_SP
])

7335 
∑øms
->
max_•
 = 
	`∆a_gë_u8
(
tb
[
NL80211_STA_WME_MAX_SP
]);

7337 i‡(
∑øms
->
max_•
 & ~
IEEE80211_WMM_IE_STA_QOSINFO_SP_MASK
)

7338  -
EINVAL
;

7340 
∑øms
->
°a_modify_mask
 |
STATION_PARAM_APPLY_UAPSD
;

7343 
	}
}

7345 
	$∆80211_∑r£_°a_ch™√l_öfo
(
gíl_öfo
 *
öfo
,

7346 
°©i⁄_∑ømëîs
 *
∑øms
)

7348 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_CHANNELS
]) {

7349 
∑øms
->
suµ‹ãd_ch™√ls
 =

7350 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_CHANNELS
]);

7351 
∑øms
->
suµ‹ãd_ch™√ls_Àn
 =

7352 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_CHANNELS
]);

7358 i‡(
∑øms
->
suµ‹ãd_ch™√ls_Àn
 % 2)

7359  -
EINVAL
;

7362 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_OPER_CLASSES
]) {

7363 
∑øms
->
suµ‹ãd_›î_˛as£s
 =

7364 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_OPER_CLASSES
]);

7365 
∑øms
->
suµ‹ãd_›î_˛as£s_Àn
 =

7366 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_OPER_CLASSES
]);

7369 
	}
}

7371 
	$∆80211_£t_°©i⁄_tdls
(
gíl_öfo
 *
öfo
,

7372 
°©i⁄_∑ømëîs
 *
∑øms
)

7374 
îr
;

7376 i‡(
öfo
->
©ås
[
NL80211_ATTR_PEER_AID
])

7377 
∑øms
->
aid
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_PEER_AID
]);

7378 i‡(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
])

7379 
∑øms
->
lök_°a_∑øms
.
ht_ˇ∑
 =

7380 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
]);

7381 i‡(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY
])

7382 
∑øms
->
lök_°a_∑øms
.
vht_ˇ∑
 =

7383 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY
]);

7384 i‡(
öfo
->
©ås
[
NL80211_ATTR_HE_CAPABILITY
]) {

7385 
∑øms
->
lök_°a_∑øms
.
he_ˇ∑
 =

7386 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HE_CAPABILITY
]);

7387 
∑øms
->
lök_°a_∑øms
.
he_ˇ∑_Àn
 =

7388 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_HE_CAPABILITY
]);

7390 i‡(
öfo
->
©ås
[
NL80211_ATTR_EHT_CAPABILITY
]) {

7391 
∑øms
->
lök_°a_∑øms
.
eht_ˇ∑
 =

7392 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_EHT_CAPABILITY
]);

7393 
∑øms
->
lök_°a_∑øms
.
eht_ˇ∑_Àn
 =

7394 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_EHT_CAPABILITY
]);

7396 i‡(!
	`õì80211_eht_ˇ∑_size_ok
((c⁄° 
u8
 *)
∑øms
->
lök_°a_∑øms
.
he_ˇ∑
,

7397 (c⁄° 
u8
 *)
∑øms
->
lök_°a_∑øms
.
eht_ˇ∑
,

7398 
∑øms
->
lök_°a_∑øms
.
eht_ˇ∑_Àn
,

7399 
Ál£
))

7400  -
EINVAL
;

7404 
îr
 = 
	`∆80211_∑r£_°a_ch™√l_öfo
(
öfo
, 
∑øms
);

7405 i‡(
îr
)

7406  
îr
;

7408  
	`∆80211_∑r£_°a_wme
(
öfo
, 
∑øms
);

7409 
	}
}

7411 
	$∆80211_∑r£_°a_txpowî_£âög
(
gíl_öfo
 *
öfo
,

7412 
°a_txpwr
 *
txpwr
,

7413 
boﬁ
 *
txpwr_£t
)

7415 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

7416 
idx
;

7418 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_TX_POWER_SETTING
]) {

7419 i‡(!
rdev
->
›s
->
£t_tx_powî
 ||

7420 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

7421 
NL80211_EXT_FEATURE_STA_TX_PWR
))

7422  -
EOPNOTSUPP
;

7424 
idx
 = 
NL80211_ATTR_STA_TX_POWER_SETTING
;

7425 
txpwr
->
ty≥
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
idx
]);

7427 i‡(
txpwr
->
ty≥
 =
NL80211_TX_POWER_LIMITED
) {

7428 
idx
 = 
NL80211_ATTR_STA_TX_POWER
;

7430 i‡(
öfo
->
©ås
[
idx
])

7431 
txpwr
->
powî
 = 
	`∆a_gë_s16
(
öfo
->
©ås
[
idx
]);

7433  -
EINVAL
;

7436 *
txpwr_£t
 = 
åue
;

7438 *
txpwr_£t
 = 
Ál£
;

7442 
	}
}

7444 
	$∆80211_£t_°©i⁄
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

7446 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

7447 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

7448 
°©i⁄_∑ømëîs
 
∑øms
;

7449 
u8
 *
mac_addr
;

7450 
îr
;

7452 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7454 
	`mem£t
(&
∑øms
, 0, (params));

7456 i‡(!
rdev
->
›s
->
ch™ge_°©i⁄
) {

7457 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7458  -
EOPNOTSUPP
;

7466 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_AID
])

7467 
∑øms
.
aid
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_STA_AID
]);

7469 i‡(
öfo
->
©ås
[
NL80211_ATTR_VLAN_ID
])

7470 
∑øms
.
vœn_id
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_VLAN_ID
]);

7472 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_LISTEN_INTERVAL
])

7473 
∑øms
.
li°í_öãrvÆ
 =

7474 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_STA_LISTEN_INTERVAL
]);

7476 
∑øms
.
li°í_öãrvÆ
 = -1;

7478 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORT_P2P_PS
])

7479 
∑øms
.
suµ‹t_p2p_ps
 =

7480 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORT_P2P_PS
]);

7482 
∑øms
.
suµ‹t_p2p_ps
 = -1;

7484 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

7485 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7486  -
EINVAL
;

7489 
∑øms
.
lök_°a_∑øms
.
lök_id
 =

7490 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

7492 i‡(
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
]) {

7498 i‡(
∑øms
.
lök_°a_∑øms
.
lök_id
 < 0) {

7499 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7500  -
EINVAL
;

7503 
mac_addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
]);

7504 
∑øms
.
lök_°a_∑øms
.
mld_mac
 = 
mac_addr
;

7505 
∑øms
.
lök_°a_∑øms
.
lök_mac
 =

7506 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

7507 i‡(!
	`is_vÆid_ëhî_addr
(
∑øms
.
lök_°a_∑øms
.
lök_mac
)) {

7508 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7509  -
EINVAL
;

7512 
mac_addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

7516 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_RATES
]) {

7517 
∑øms
.
lök_°a_∑øms
.
suµ‹ãd_øãs
 =

7518 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_RATES
]);

7519 
∑øms
.
lök_°a_∑øms
.
suµ‹ãd_øãs_Àn
 =

7520 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_RATES
]);

7523 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_CAPABILITY
]) {

7524 
∑øms
.
ˇ∑bûôy
 =

7525 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_STA_CAPABILITY
]);

7526 
∑øms
.
°a_modify_mask
 |
STATION_PARAM_APPLY_CAPABILITY
;

7529 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_EXT_CAPABILITY
]) {

7530 
∑øms
.
ext_ˇ∑b
 =

7531 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_STA_EXT_CAPABILITY
]);

7532 
∑øms
.
ext_ˇ∑b_Àn
 =

7533 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_STA_EXT_CAPABILITY
]);

7536 i‡(
	`∑r£_°©i⁄_Êags
(
öfo
, 
dev
->
õì80211_±r
->
i·y≥
, &
∑øms
)) {

7537 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7538  -
EINVAL
;

7541 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_PLINK_ACTION
])

7542 
∑øms
.
∂ök_a˘i⁄
 =

7543 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_STA_PLINK_ACTION
]);

7545 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_PLINK_STATE
]) {

7546 
∑øms
.
∂ök_°©e
 =

7547 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_STA_PLINK_STATE
]);

7548 i‡(
öfo
->
©ås
[
NL80211_ATTR_MESH_PEER_AID
])

7549 
∑øms
.
≥î_aid
 = 
	`∆a_gë_u16
(

7550 
öfo
->
©ås
[
NL80211_ATTR_MESH_PEER_AID
]);

7551 
∑øms
.
°a_modify_mask
 |
STATION_PARAM_APPLY_PLINK_STATE
;

7554 i‡(
öfo
->
©ås
[
NL80211_ATTR_LOCAL_MESH_POWER_MODE
])

7555 
∑øms
.
loˇl_pm
 = 
	`∆a_gë_u32
(

7556 
öfo
->
©ås
[
NL80211_ATTR_LOCAL_MESH_POWER_MODE
]);

7558 i‡(
öfo
->
©ås
[
NL80211_ATTR_OPMODE_NOTIF
]) {

7559 
∑øms
.
lök_°a_∑øms
.
›mode_nŸif_u£d
 = 
åue
;

7560 
∑øms
.
lök_°a_∑øms
.
›mode_nŸif
 =

7561 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_OPMODE_NOTIF
]);

7564 i‡(
öfo
->
©ås
[
NL80211_ATTR_HE_6GHZ_CAPABILITY
])

7565 
∑øms
.
lök_°a_∑øms
.
he_6ghz_ˇ∑
 =

7566 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HE_6GHZ_CAPABILITY
]);

7568 i‡(
öfo
->
©ås
[
NL80211_ATTR_AIRTIME_WEIGHT
])

7569 
∑øms
.
aútime_weight
 =

7570 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_AIRTIME_WEIGHT
]);

7572 i‡(
∑øms
.
aútime_weight
 &&

7573 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

7574 
NL80211_EXT_FEATURE_AIRTIME_FAIRNESS
)) {

7575 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7576  -
EOPNOTSUPP
;

7579 
îr
 = 
	`∆80211_∑r£_°a_txpowî_£âög
(
öfo
,

7580 &
∑øms
.
lök_°a_∑øms
.
txpwr
,

7581 &
∑øms
.
lök_°a_∑øms
.
txpwr_£t
);

7582 i‡(
îr
) {

7583 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7584  
îr
;

7588 
îr
 = 
	`∆80211_£t_°©i⁄_tdls
(
öfo
, &
∑øms
);

7589 i‡(
îr
) {

7590 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7591  
îr
;

7594 
∑øms
.
vœn
 = 
	`gë_vœn
(
öfo
, 
rdev
);

7595 i‡(
	`IS_ERR
(
∑øms
.
vœn
)) {

7596 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7597  
	`PTR_ERR
(
∑øms
.
vœn
);

7600 
dev
->
õì80211_±r
->
i·y≥
) {

7601 
NL80211_IFTYPE_AP
:

7602 
NL80211_IFTYPE_AP_VLAN
:

7603 
NL80211_IFTYPE_P2P_GO
:

7604 
NL80211_IFTYPE_P2P_CLIENT
:

7605 
NL80211_IFTYPE_STATION
:

7606 
NL80211_IFTYPE_ADHOC
:

7607 
NL80211_IFTYPE_MESH_POINT
:

7608 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7611 
îr
 = -
EOPNOTSUPP
;

7612 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7613 
out_put_vœn
;

7617 
îr
 = 
	`rdev_ch™ge_°©i⁄
(
rdev
, 
dev
, 
mac_addr
, &
∑øms
);

7619 
out_put_vœn
:

7620 
	`dev_put
(
∑øms
.
vœn
);

7622 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

7623  
îr
;

7624 
	}
}

7626 
	$∆80211_√w_°©i⁄
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

7628 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

7629 
îr
;

7630 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

7631 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

7632 
°©i⁄_∑ømëîs
 
∑øms
;

7633 
u8
 *
mac_addr
 = 
NULL
;

7634 
u32
 
auth_assoc
 = 
	`BIT
(
NL80211_STA_FLAG_AUTHENTICATED
) |

7635 
	`BIT
(
NL80211_STA_FLAG_ASSOCIATED
);

7637 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

7639 
	`mem£t
(&
∑øms
, 0, (params));

7641 i‡(!
rdev
->
›s
->
add_°©i⁄
) {

7642 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7643  -
EOPNOTSUPP
;

7646 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

7647 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7648  -
EINVAL
;

7651 i‡(!
öfo
->
©ås
[
NL80211_ATTR_STA_LISTEN_INTERVAL
]) {

7652 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7653  -
EINVAL
;

7656 i‡(!
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_RATES
]) {

7657 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7658  -
EINVAL
;

7661 i‡(!
öfo
->
©ås
[
NL80211_ATTR_STA_AID
] &&

7662 !
öfo
->
©ås
[
NL80211_ATTR_PEER_AID
]) {

7663 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7664  -
EINVAL
;

7667 
∑øms
.
lök_°a_∑øms
.
lök_id
 =

7668 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

7670 i‡(
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
]) {

7671 
mac_addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
]);

7672 
∑øms
.
lök_°a_∑øms
.
mld_mac
 = 
mac_addr
;

7673 
∑øms
.
lök_°a_∑øms
.
lök_mac
 =

7674 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

7675 i‡(!
	`is_vÆid_ëhî_addr
(
∑øms
.
lök_°a_∑øms
.
lök_mac
)) {

7676 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7677  -
EINVAL
;

7680 
mac_addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

7683 
∑øms
.
lök_°a_∑øms
.
suµ‹ãd_øãs
 =

7684 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_RATES
]);

7685 
∑øms
.
lök_°a_∑øms
.
suµ‹ãd_øãs_Àn
 =

7686 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_RATES
]);

7687 
∑øms
.
li°í_öãrvÆ
 =

7688 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_STA_LISTEN_INTERVAL
]);

7690 i‡(
öfo
->
©ås
[
NL80211_ATTR_VLAN_ID
])

7691 
∑øms
.
vœn_id
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_VLAN_ID
]);

7693 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORT_P2P_PS
]) {

7694 
∑øms
.
suµ‹t_p2p_ps
 =

7695 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORT_P2P_PS
]);

7701 
∑øms
.
suµ‹t_p2p_ps
 =

7702 
dev
->
õì80211_±r
->
i·y≥
 =
NL80211_IFTYPE_P2P_GO
;

7705 i‡(
öfo
->
©ås
[
NL80211_ATTR_PEER_AID
])

7706 
∑øms
.
aid
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_PEER_AID
]);

7708 
∑øms
.
aid
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_STA_AID
]);

7710 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_CAPABILITY
]) {

7711 
∑øms
.
ˇ∑bûôy
 =

7712 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_STA_CAPABILITY
]);

7713 
∑øms
.
°a_modify_mask
 |
STATION_PARAM_APPLY_CAPABILITY
;

7716 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_EXT_CAPABILITY
]) {

7717 
∑øms
.
ext_ˇ∑b
 =

7718 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_STA_EXT_CAPABILITY
]);

7719 
∑øms
.
ext_ˇ∑b_Àn
 =

7720 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_STA_EXT_CAPABILITY
]);

7723 i‡(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
])

7724 
∑øms
.
lök_°a_∑øms
.
ht_ˇ∑
 =

7725 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
]);

7727 i‡(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY
])

7728 
∑øms
.
lök_°a_∑øms
.
vht_ˇ∑
 =

7729 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY
]);

7731 i‡(
öfo
->
©ås
[
NL80211_ATTR_HE_CAPABILITY
]) {

7732 
∑øms
.
lök_°a_∑øms
.
he_ˇ∑
 =

7733 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HE_CAPABILITY
]);

7734 
∑øms
.
lök_°a_∑øms
.
he_ˇ∑_Àn
 =

7735 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_HE_CAPABILITY
]);

7737 i‡(
öfo
->
©ås
[
NL80211_ATTR_EHT_CAPABILITY
]) {

7738 
∑øms
.
lök_°a_∑øms
.
eht_ˇ∑
 =

7739 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_EHT_CAPABILITY
]);

7740 
∑øms
.
lök_°a_∑øms
.
eht_ˇ∑_Àn
 =

7741 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_EHT_CAPABILITY
]);

7743 i‡(!
	`õì80211_eht_ˇ∑_size_ok
((c⁄° 
u8
 *)
∑øms
.
lök_°a_∑øms
.
he_ˇ∑
,

7744 (c⁄° 
u8
 *)
∑øms
.
lök_°a_∑øms
.
eht_ˇ∑
,

7745 
∑øms
.
lök_°a_∑øms
.
eht_ˇ∑_Àn
,

7746 
Ál£
)) {

7747 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7748  -
EINVAL
;

7753 i‡(
öfo
->
©ås
[
NL80211_ATTR_HE_6GHZ_CAPABILITY
])

7754 
∑øms
.
lök_°a_∑øms
.
he_6ghz_ˇ∑
 =

7755 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HE_6GHZ_CAPABILITY
]);

7757 i‡(
öfo
->
©ås
[
NL80211_ATTR_OPMODE_NOTIF
]) {

7758 
∑øms
.
lök_°a_∑øms
.
›mode_nŸif_u£d
 = 
åue
;

7759 
∑øms
.
lök_°a_∑øms
.
›mode_nŸif
 =

7760 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_OPMODE_NOTIF
]);

7763 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_PLINK_ACTION
])

7764 
∑øms
.
∂ök_a˘i⁄
 =

7765 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_STA_PLINK_ACTION
]);

7767 i‡(
öfo
->
©ås
[
NL80211_ATTR_AIRTIME_WEIGHT
])

7768 
∑øms
.
aútime_weight
 =

7769 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_AIRTIME_WEIGHT
]);

7771 i‡(
∑øms
.
aútime_weight
 &&

7772 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

7773 
NL80211_EXT_FEATURE_AIRTIME_FAIRNESS
)) {

7774 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7775  -
EOPNOTSUPP
;

7778 
îr
 = 
	`∆80211_∑r£_°a_txpowî_£âög
(
öfo
,

7779 &
∑øms
.
lök_°a_∑øms
.
txpwr
,

7780 &
∑øms
.
lök_°a_∑øms
.
txpwr_£t
);

7781 i‡(
îr
) {

7782 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7783  
îr
;

7786 
îr
 = 
	`∆80211_∑r£_°a_ch™√l_öfo
(
öfo
, &
∑øms
);

7787 i‡(
îr
) {

7788 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7789  
îr
;

7792 
îr
 = 
	`∆80211_∑r£_°a_wme
(
öfo
, &
∑øms
);

7793 i‡(
îr
) {

7794 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7795  
îr
;

7798 i‡(
	`∑r£_°©i⁄_Êags
(
öfo
, 
dev
->
õì80211_±r
->
i·y≥
, &
∑øms
)) {

7799 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7800  -
EINVAL
;

7808 i‡(!(
∑øms
.
°a_Êags_£t
 & 
	`BIT
(
NL80211_STA_FLAG_WME
))) {

7809 
∑øms
.
lök_°a_∑øms
.
ht_ˇ∑
 = 
NULL
;

7810 
∑øms
.
lök_°a_∑øms
.
vht_ˇ∑
 = 
NULL
;

7813 i‡(
∑øms
.
lök_°a_∑øms
.
he_ˇ∑_Àn
 ||

7814 
∑øms
.
lök_°a_∑øms
.
he_6ghz_ˇ∑
 ||

7815 
∑øms
.
lök_°a_∑øms
.
eht_ˇ∑_Àn
) {

7816 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7817  -
EINVAL
;

7822 i‡(
∑øms
.
lök_°a_∑øms
.
he_6ghz_ˇ∑
 &&

7823 (
∑øms
.
lök_°a_∑øms
.
ht_ˇ∑
 ||Ö¨ams.lök_°a_∑øms.
vht_ˇ∑
)) {

7824 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7825  -
EINVAL
;

7829 
	`BUILD_BUG_ON
(
NL80211_STA_FLAG_MAX
 != 8);

7831 
dev
->
õì80211_±r
->
i·y≥
) {

7832 
NL80211_IFTYPE_AP
:

7833 
NL80211_IFTYPE_AP_VLAN
:

7834 
NL80211_IFTYPE_P2P_GO
:

7836 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_AP_UAPSD
) ||

7837 !(
∑øms
.
°a_Êags_£t
 & 
	`BIT
(
NL80211_STA_FLAG_WME
)))

7838 
∑øms
.
°a_modify_mask
 &~
STATION_PARAM_APPLY_UAPSD
;

7841 i‡((
∑øms
.
°a_Êags_£t
 & 
	`BIT
(
NL80211_STA_FLAG_TDLS_PEER
)) ||

7842 
öfo
->
©ås
[
NL80211_ATTR_PEER_AID
]) {

7843 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7844  -
EINVAL
;

7847 
∑øms
.
°a_Êags_mask
 &~
	`BIT
(
NL80211_STA_FLAG_TDLS_PEER
);

7850 i‡(!(
rdev
->
wùhy
.
„©uªs
 &

7851 
NL80211_FEATURE_FULL_AP_CLIENT_STATE
) &&

7852 
∑øms
.
°a_Êags_mask
 & 
auth_assoc
) {

7853 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7854  -
EINVAL
;

7857 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

7858 
NL80211_EXT_FEATURE_SPP_AMSDU_SUPPORT
) &&

7859 
∑øms
.
°a_Êags_mask
 & 
	`BIT
(
NL80211_STA_FLAG_SPP_AMSDU
)) {

7860 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7861  -
EINVAL
;

7874 i‡(!(
∑øms
.
°a_Êags_mask
 & 
auth_assoc
)) {

7875 
∑øms
.
°a_Êags_mask
 |
auth_assoc
;

7876 
∑øms
.
°a_Êags_£t
 |
auth_assoc
;

7880 
∑øms
.
vœn
 = 
	`gë_vœn
(
öfo
, 
rdev
);

7881 i‡(
	`IS_ERR
(
∑øms
.
vœn
)) {

7882 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7883  
	`PTR_ERR
(
∑øms
.
vœn
);

7885 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7887 
NL80211_IFTYPE_MESH_POINT
:

7889 
∑øms
.
°a_modify_mask
 &~
STATION_PARAM_APPLY_UAPSD
;

7892 i‡(
∑øms
.
°a_Êags_mask
 & 
	`BIT
(
NL80211_STA_FLAG_ASSOCIATED
)) {

7893 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7894  -
EINVAL
;

7897 i‡((
∑øms
.
°a_Êags_£t
 & 
	`BIT
(
NL80211_STA_FLAG_TDLS_PEER
)) ||

7898 
öfo
->
©ås
[
NL80211_ATTR_PEER_AID
]) {

7899 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7900  -
EINVAL
;

7902 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7904 
NL80211_IFTYPE_STATION
:

7905 
NL80211_IFTYPE_P2P_CLIENT
:

7907 
∑øms
.
°a_modify_mask
 &~
STATION_PARAM_APPLY_UAPSD
;

7910 i‡(
∑øms
.
°a_Êags_mask
 &

7911 (
	`BIT
(
NL80211_STA_FLAG_ASSOCIATED
) |

7912 
	`BIT
(
NL80211_STA_FLAG_AUTHENTICATED
))) {

7913 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7914  -
EINVAL
;

7917 i‡(!(
∑øms
.
°a_Êags_£t
 & 
	`BIT
(
NL80211_STA_FLAG_TDLS_PEER
))) {

7918 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7919  -
EINVAL
;

7922 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_TDLS
)) {

7923 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7924  -
EOPNOTSUPP
;

7927 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_TDLS_EXTERNAL_SETUP
)) {

7928 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7929  -
EOPNOTSUPP
;

7935 
∑øms
.
°a_Êags_mask
 &~
	`BIT
(
NL80211_STA_FLAG_AUTHORIZED
);

7936 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7939 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7940  -
EOPNOTSUPP
;

7945 i‡(
wdev
->
vÆid_löks
) {

7946 i‡(
∑øms
.
lök_°a_∑øms
.
lök_id
 < 0) {

7947 
îr
 = -
EINVAL
;

7948 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7949 
out
;

7951 i‡(!(
wdev
->
vÆid_löks
 & 
	`BIT
(
∑øms
.
lök_°a_∑øms
.
lök_id
))) {

7952 
îr
 = -
ENOLINK
;

7953 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7954 
out
;

7957 i‡(
∑øms
.
lök_°a_∑øms
.
lök_id
 >= 0) {

7958 
îr
 = -
EINVAL
;

7959 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7960 
out
;

7963 
îr
 = 
	`rdev_add_°©i⁄
(
rdev
, 
dev
, 
mac_addr
, &
∑øms
);

7964 
out
:

7965 
	`dev_put
(
∑øms
.
vœn
);

7966 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7967  
îr
;

7968 
	}
}

7970 
	$∆80211_dñ_°©i⁄
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

7972 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

7973 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

7974 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

7975 
°©i⁄_dñ_∑ømëîs
 
∑øms
;

7976 
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

7978 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

7979 
	`mem£t
(&
∑øms
, 0, (params));

7981 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
])

7982 
∑øms
.
mac
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

7984 
wdev
->
i·y≥
) {

7985 
NL80211_IFTYPE_AP
:

7986 
NL80211_IFTYPE_AP_VLAN
:

7987 
NL80211_IFTYPE_MESH_POINT
:

7988 
NL80211_IFTYPE_P2P_GO
:

7990 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7992 
NL80211_IFTYPE_ADHOC
:

7994 i‡(
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

7995 
NL80211_EXT_FEATURE_DEL_IBSS_STA
)) {

7996 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

7999 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8000  -
EINVAL
;

8002 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8003  -
EINVAL
;

8006 i‡(!
rdev
->
›s
->
dñ_°©i⁄
) {

8007 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8008  -
EOPNOTSUPP
;

8011 i‡(
öfo
->
©ås
[
NL80211_ATTR_MGMT_SUBTYPE
]) {

8012 
∑øms
.
subty≥
 =

8013 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_MGMT_SUBTYPE
]);

8014 i‡(
∑øms
.
subty≥
 !
IEEE80211_STYPE_DISASSOC
 >> 4 &&

8015 
∑øms
.
subty≥
 !
IEEE80211_STYPE_DEAUTH
 >> 4) {

8016 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8017  -
EINVAL
;

8021 
∑øms
.
subty≥
 = 
IEEE80211_STYPE_DEAUTH
 >> 4;

8024 i‡(
öfo
->
©ås
[
NL80211_ATTR_REASON_CODE
]) {

8025 
∑øms
.
ªas⁄_code
 =

8026 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_REASON_CODE
]);

8027 i‡(
∑øms
.
ªas⁄_code
 == 0) {

8028 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8029  -
EINVAL
;

8033 
∑øms
.
ªas⁄_code
 = 
WLAN_REASON_PREV_AUTH_NOT_VALID
;

8037 i‡(!
wdev
->
vÆid_löks
 && 
lök_id
 != -1) {

8038 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8039  -
EINVAL
;

8043 i‡(
wdev
->
vÆid_löks
 && 
lök_id
 >= 0 &&

8044 !(
wdev
->
vÆid_löks
 & 
	`BIT
(
lök_id
))) {

8045 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8046  -
EINVAL
;

8049 
∑øms
.
lök_id
 =Üink_id;

8051 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8052  
	`rdev_dñ_°©i⁄
(
rdev
, 
dev
, &
∑øms
);

8053 
	}
}

8055 
	$∆80211_£nd_m∑th
(
sk_buff
 *
msg
, 
u32
 
p‹tid
, u32 
£q
,

8056 
Êags
, 
√t_devi˚
 *
dev
,

8057 
u8
 *
d°
, u8 *
√xt_h›
,

8058 
m∑th_öfo
 *
pöfo
)

8060 *
hdr
;

8061 
∆©å
 *
pöfﬂâr
;

8063 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
p‹tid
, 
£q
, 
Êags
, 
NL80211_CMD_NEW_MPATH
);

8064 i‡(!
hdr
)

8067 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

8068 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
d°
) ||

8069 
	`∆a_put
(
msg
, 
NL80211_ATTR_MPATH_NEXT_HOP
, 
ETH_ALEN
, 
√xt_h›
) ||

8070 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_GENERATION
, 
pöfo
->
gíî©i⁄
))

8071 
∆a_put_Áûuª
;

8073 
pöfﬂâr
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_MPATH_INFO
);

8074 i‡(!
pöfﬂâr
)

8075 
∆a_put_Áûuª
;

8076 i‡((
pöfo
->
fûÀd
 & 
MPATH_INFO_FRAME_QLEN
) &&

8077 
	`∆a_put_u32
(
msg
, 
NL80211_MPATH_INFO_FRAME_QLEN
,

8078 
pöfo
->
‰ame_qÀn
))

8079 
∆a_put_Áûuª
;

8080 i‡(((
pöfo
->
fûÀd
 & 
MPATH_INFO_SN
) &&

8081 
	`∆a_put_u32
(
msg
, 
NL80211_MPATH_INFO_SN
, 
pöfo
->
¢
)) ||

8082 ((
pöfo
->
fûÀd
 & 
MPATH_INFO_METRIC
) &&

8083 
	`∆a_put_u32
(
msg
, 
NL80211_MPATH_INFO_METRIC
,

8084 
pöfo
->
mëric
)) ||

8085 ((
pöfo
->
fûÀd
 & 
MPATH_INFO_EXPTIME
) &&

8086 
	`∆a_put_u32
(
msg
, 
NL80211_MPATH_INFO_EXPTIME
,

8087 
pöfo
->
ex±ime
)) ||

8088 ((
pöfo
->
fûÀd
 & 
MPATH_INFO_FLAGS
) &&

8089 
	`∆a_put_u8
(
msg
, 
NL80211_MPATH_INFO_FLAGS
,

8090 
pöfo
->
Êags
)) ||

8091 ((
pöfo
->
fûÀd
 & 
MPATH_INFO_DISCOVERY_TIMEOUT
) &&

8092 
	`∆a_put_u32
(
msg
, 
NL80211_MPATH_INFO_DISCOVERY_TIMEOUT
,

8093 
pöfo
->
discovîy_timeout
)) ||

8094 ((
pöfo
->
fûÀd
 & 
MPATH_INFO_DISCOVERY_RETRIES
) &&

8095 
	`∆a_put_u8
(
msg
, 
NL80211_MPATH_INFO_DISCOVERY_RETRIES
,

8096 
pöfo
->
discovîy_ªåõs
)) ||

8097 ((
pöfo
->
fûÀd
 & 
MPATH_INFO_HOP_COUNT
) &&

8098 
	`∆a_put_u8
(
msg
, 
NL80211_MPATH_INFO_HOP_COUNT
,

8099 
pöfo
->
h›_cou¡
)) ||

8100 ((
pöfo
->
fûÀd
 & 
MPATH_INFO_PATH_CHANGE
) &&

8101 
	`∆a_put_u32
(
msg
, 
NL80211_MPATH_INFO_PATH_CHANGE
,

8102 
pöfo
->
∑th_ch™ge_cou¡
)))

8103 
∆a_put_Áûuª
;

8105 
	`∆a_√°_íd
(
msg
, 
pöfﬂâr
);

8107 
	`gílmsg_íd
(
msg
, 
hdr
);

8110 
∆a_put_Áûuª
:

8111 
	`gílmsg_ˇn˚l
(
msg
, 
hdr
);

8112  -
EMSGSIZE
;

8113 
	}
}

8115 
	$∆80211_dump_m∑th
(
sk_buff
 *
skb
,

8116 
√éök_ˇŒback
 *
cb
)

8118 
m∑th_öfo
 
pöfo
;

8119 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

8120 
wúñess_dev
 *
wdev
;

8121 
u8
 
d°
[
ETH_ALEN
];

8122 
u8
 
√xt_h›
[
ETH_ALEN
];

8123 
∑th_idx
 = 
cb
->
¨gs
[2];

8124 
îr
;

8126 
îr
 = 
	`∆80211_¥ï¨e_wdev_dump
(
cb
, &
rdev
, &
wdev
, 
NULL
);

8127 i‡(
îr
)

8128  
îr
;

8130 
	`__acquúe
(&
rdev
->
wùhy
.
mtx
);

8132 i‡(!
rdev
->
›s
->
dump_m∑th
) {

8133 
îr
 = -
EOPNOTSUPP
;

8134 
out_îr
;

8137 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
) {

8138 
îr
 = -
EOPNOTSUPP
;

8139 
out_îr
;

8143 
îr
 = 
	`rdev_dump_m∑th
(
rdev
, 
wdev
->
√tdev
, 
∑th_idx
, 
d°
,

8144 
√xt_h›
, &
pöfo
);

8145 i‡(
îr
 =-
ENOENT
)

8147 i‡(
îr
)

8148 
out_îr
;

8150 i‡(
	`∆80211_£nd_m∑th
(
skb
, 
	`NETLINK_CB
(
cb
->skb).
p‹tid
,

8151 
cb
->
∆h
->
∆msg_£q
, 
NLM_F_MULTI
,

8152 
wdev
->
√tdev
, 
d°
, 
√xt_h›
,

8153 &
pöfo
) < 0)

8154 
out
;

8156 
∑th_idx
++;

8159 
out
:

8160 
cb
->
¨gs
[2] = 
∑th_idx
;

8161 
îr
 = 
skb
->
Àn
;

8162 
out_îr
:

8163 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

8164  
îr
;

8165 
	}
}

8167 
	$∆80211_gë_m∑th
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

8169 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

8170 
îr
;

8171 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

8172 
m∑th_öfo
 
pöfo
;

8173 
sk_buff
 *
msg
;

8174 
u8
 *
d°
 = 
NULL
;

8175 
u8
 
√xt_h›
[
ETH_ALEN
];

8177 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

8179 
	`mem£t
(&
pöfo
, 0, (pinfo));

8181 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

8182 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8183  -
EINVAL
;

8186 
d°
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

8188 i‡(!
rdev
->
›s
->
gë_m∑th
) {

8189 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8190  -
EOPNOTSUPP
;

8193 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
) {

8194 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8195  -
EOPNOTSUPP
;

8198 
îr
 = 
	`rdev_gë_m∑th
(
rdev
, 
dev
, 
d°
, 
√xt_h›
, &
pöfo
);

8199 i‡(
îr
) {

8200 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8201  
îr
;

8204 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

8205 i‡(!
msg
) {

8206 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8207  -
ENOMEM
;

8210 i‡(
	`∆80211_£nd_m∑th
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

8211 
dev
, 
d°
, 
√xt_h›
, &
pöfo
) < 0) {

8212 
	`∆msg_‰ì
(
msg
);

8213 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8214  -
ENOBUFS
;

8217 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8218  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

8219 
	}
}

8221 
	$∆80211_£t_m∑th
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

8223 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

8224 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

8225 
u8
 *
d°
 = 
NULL
;

8226 
u8
 *
√xt_h›
 = 
NULL
;

8228 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

8230 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

8231 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8232  -
EINVAL
;

8235 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MPATH_NEXT_HOP
]) {

8236 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8237  -
EINVAL
;

8240 
d°
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

8241 
√xt_h›
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MPATH_NEXT_HOP
]);

8243 i‡(!
rdev
->
›s
->
ch™ge_m∑th
) {

8244 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8245  -
EOPNOTSUPP
;

8248 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
) {

8249 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8250  -
EOPNOTSUPP
;

8253 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8254  
	`rdev_ch™ge_m∑th
(
rdev
, 
dev
, 
d°
, 
√xt_h›
);

8255 
	}
}

8257 
	$∆80211_√w_m∑th
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

8259 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

8260 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

8261 
u8
 *
d°
 = 
NULL
;

8262 
u8
 *
√xt_h›
 = 
NULL
;

8264 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

8266 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

8267 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8268  -
EINVAL
;

8271 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MPATH_NEXT_HOP
]) {

8272 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8273  -
EINVAL
;

8276 
d°
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

8277 
√xt_h›
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MPATH_NEXT_HOP
]);

8279 i‡(!
rdev
->
›s
->
add_m∑th
) {

8280 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8281  -
EOPNOTSUPP
;

8284 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
) {

8285 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8286  -
EOPNOTSUPP
;

8289 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8290  
	`rdev_add_m∑th
(
rdev
, 
dev
, 
d°
, 
√xt_h›
);

8291 
	}
}

8293 
	$∆80211_dñ_m∑th
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

8295 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

8296 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

8297 
u8
 *
d°
 = 
NULL
;

8299 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

8301 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
])

8302 
d°
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

8304 i‡(!
rdev
->
›s
->
dñ_m∑th
) {

8305 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8306  -
EOPNOTSUPP
;

8309 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
) {

8310 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8311  -
EOPNOTSUPP
;

8314 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8315  
	`rdev_dñ_m∑th
(
rdev
, 
dev
, 
d°
);

8316 
	}
}

8318 
	$∆80211_gë_mµ
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

8320 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

8321 
îr
;

8322 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

8323 
m∑th_öfo
 
pöfo
;

8324 
sk_buff
 *
msg
;

8325 
u8
 *
d°
 = 
NULL
;

8326 
u8
 
mµ
[
ETH_ALEN
];

8328 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

8330 
	`mem£t
(&
pöfo
, 0, (pinfo));

8332 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

8333 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8334  -
EINVAL
;

8337 
d°
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

8339 i‡(!
rdev
->
›s
->
gë_mµ
) {

8340 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8341  -
EOPNOTSUPP
;

8344 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
) {

8345 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8346  -
EOPNOTSUPP
;

8349 
îr
 = 
	`rdev_gë_mµ
(
rdev
, 
dev
, 
d°
, 
mµ
, &
pöfo
);

8350 i‡(
îr
) {

8351 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8352  
îr
;

8355 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

8356 i‡(!
msg
) {

8357 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8358  -
ENOMEM
;

8361 i‡(
	`∆80211_£nd_m∑th
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

8362 
dev
, 
d°
, 
mµ
, &
pöfo
) < 0) {

8363 
	`∆msg_‰ì
(
msg
);

8364 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8365  -
ENOBUFS
;

8368 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8369  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

8370 
	}
}

8372 
	$∆80211_dump_mµ
(
sk_buff
 *
skb
,

8373 
√éök_ˇŒback
 *
cb
)

8375 
m∑th_öfo
 
pöfo
;

8376 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

8377 
wúñess_dev
 *
wdev
;

8378 
u8
 
d°
[
ETH_ALEN
];

8379 
u8
 
mµ
[
ETH_ALEN
];

8380 
∑th_idx
 = 
cb
->
¨gs
[2];

8381 
îr
;

8383 
îr
 = 
	`∆80211_¥ï¨e_wdev_dump
(
cb
, &
rdev
, &
wdev
, 
NULL
);

8384 i‡(
îr
)

8385  
îr
;

8387 
	`__acquúe
(&
rdev
->
wùhy
.
mtx
);

8389 i‡(!
rdev
->
›s
->
dump_mµ
) {

8390 
îr
 = -
EOPNOTSUPP
;

8391 
out_îr
;

8394 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
) {

8395 
îr
 = -
EOPNOTSUPP
;

8396 
out_îr
;

8400 
îr
 = 
	`rdev_dump_mµ
(
rdev
, 
wdev
->
√tdev
, 
∑th_idx
, 
d°
,

8401 
mµ
, &
pöfo
);

8402 i‡(
îr
 =-
ENOENT
)

8404 i‡(
îr
)

8405 
out_îr
;

8407 i‡(
	`∆80211_£nd_m∑th
(
skb
, 
	`NETLINK_CB
(
cb
->skb).
p‹tid
,

8408 
cb
->
∆h
->
∆msg_£q
, 
NLM_F_MULTI
,

8409 
wdev
->
√tdev
, 
d°
, 
mµ
,

8410 &
pöfo
) < 0)

8411 
out
;

8413 
∑th_idx
++;

8416 
out
:

8417 
cb
->
¨gs
[2] = 
∑th_idx
;

8418 
îr
 = 
skb
->
Àn
;

8419 
out_îr
:

8420 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

8421  
îr
;

8422 
	}
}

8424 
	$∆80211_£t_bss
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

8426 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

8427 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

8428 
bss_∑ømëîs
 
∑øms
;

8430 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

8432 
	`mem£t
(&
∑øms
, 0, (params));

8433 
∑øms
.
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

8435 
∑øms
.
u£_˘s_¥Ÿ
 = -1;

8436 
∑øms
.
u£_sh‹t_¥ómbÀ
 = -1;

8437 
∑øms
.
u£_sh‹t_¶Ÿ_time
 = -1;

8438 
∑øms
.
≠_isﬁ©e
 = -1;

8439 
∑øms
.
ht_›mode
 = -1;

8440 
∑øms
.
p2p_˘wödow
 = -1;

8441 
∑øms
.
p2p_›p_ps
 = -1;

8443 i‡(
öfo
->
©ås
[
NL80211_ATTR_BSS_CTS_PROT
])

8444 
∑øms
.
u£_˘s_¥Ÿ
 =

8445 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_BSS_CTS_PROT
]);

8446 i‡(
öfo
->
©ås
[
NL80211_ATTR_BSS_SHORT_PREAMBLE
])

8447 
∑øms
.
u£_sh‹t_¥ómbÀ
 =

8448 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_BSS_SHORT_PREAMBLE
]);

8449 i‡(
öfo
->
©ås
[
NL80211_ATTR_BSS_SHORT_SLOT_TIME
])

8450 
∑øms
.
u£_sh‹t_¶Ÿ_time
 =

8451 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_BSS_SHORT_SLOT_TIME
]);

8452 i‡(
öfo
->
©ås
[
NL80211_ATTR_BSS_BASIC_RATES
]) {

8453 
∑øms
.
basic_øãs
 =

8454 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_BSS_BASIC_RATES
]);

8455 
∑øms
.
basic_øãs_Àn
 =

8456 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_BSS_BASIC_RATES
]);

8458 i‡(
öfo
->
©ås
[
NL80211_ATTR_AP_ISOLATE
])

8459 
∑øms
.
≠_isﬁ©e
 = !!
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_AP_ISOLATE
]);

8460 i‡(
öfo
->
©ås
[
NL80211_ATTR_BSS_HT_OPMODE
])

8461 
∑øms
.
ht_›mode
 =

8462 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_BSS_HT_OPMODE
]);

8464 i‡(
öfo
->
©ås
[
NL80211_ATTR_P2P_CTWINDOW
]) {

8465 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

8466 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8467  -
EINVAL
;

8469 
∑øms
.
p2p_˘wödow
 =

8470 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_P2P_CTWINDOW
]);

8471 i‡(
∑øms
.
p2p_˘wödow
 != 0 &&

8472 !(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_P2P_GO_CTWIN
)) {

8473 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8474  -
EINVAL
;

8478 i‡(
öfo
->
©ås
[
NL80211_ATTR_P2P_OPPPS
]) {

8479 
u8
 
tmp
;

8481 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

8482 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8483  -
EINVAL
;

8485 
tmp
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_P2P_OPPPS
]);

8486 
∑øms
.
p2p_›p_ps
 = 
tmp
;

8487 i‡(
∑øms
.
p2p_›p_ps
 &&

8488 !(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_P2P_GO_OPPPS
)) {

8489 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8490  -
EINVAL
;

8494 i‡(!
rdev
->
›s
->
ch™ge_bss
) {

8495 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8496  -
EOPNOTSUPP
;

8499 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

8500 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

8501 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8502  -
EOPNOTSUPP
;

8505 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8506  
	`rdev_ch™ge_bss
(
rdev
, 
dev
, &
∑øms
);

8507 
	}
}

8509 
	$∆80211_ªq_£t_ªg
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

8511 *
d©a
 = 
NULL
;

8512 
boﬁ
 
is_ödo‹
;

8513 
∆80211_u£r_ªg_höt_ty≥
 
u£r_ªg_höt_ty≥
;

8514 
u32
 
ow√r_∆p‹tid
;

8516 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

8524 i‡(
	`u∆ikñy
(!
	`rcu_ac˚ss_poöãr
(
cfg80211_ªgdomaö
))) {

8525 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8526  -
EINPROGRESS
;

8529 i‡(
öfo
->
©ås
[
NL80211_ATTR_USER_REG_HINT_TYPE
])

8530 
u£r_ªg_höt_ty≥
 =

8531 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_USER_REG_HINT_TYPE
]);

8533 
u£r_ªg_höt_ty≥
 = 
NL80211_USER_REG_HINT_USER
;

8535 
u£r_ªg_höt_ty≥
) {

8536 
NL80211_USER_REG_HINT_USER
:

8537 
NL80211_USER_REG_HINT_CELL_BASE
:

8538 i‡(!
öfo
->
©ås
[
NL80211_ATTR_REG_ALPHA2
]) {

8539 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8540  -
EINVAL
;

8543 
d©a
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_REG_ALPHA2
]);

8544 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8545  
	`ªguœt‹y_höt_u£r
(
d©a
, 
u£r_ªg_höt_ty≥
);

8546 
NL80211_USER_REG_HINT_INDOOR
:

8547 i‡(
öfo
->
©ås
[
NL80211_ATTR_SOCKET_OWNER
]) {

8548 
ow√r_∆p‹tid
 = 
öfo
->
¢d_p‹tid
;

8549 
is_ödo‹
 = !!
öfo
->
©ås
[
NL80211_ATTR_REG_INDOOR
];

8551 
ow√r_∆p‹tid
 = 0;

8552 
is_ödo‹
 = 
åue
;

8555 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8556  
	`ªguœt‹y_höt_ödo‹
(
is_ödo‹
, 
ow√r_∆p‹tid
);

8558 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8559  -
EINVAL
;

8561 
	}
}

8563 
	$∆80211_ªlﬂd_ªgdb
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

8565 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

8566 
	`¥_öfo
("\n\n");

8567 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8568  
	`ªg_ªlﬂd_ªgdb
();

8569 
	}
}

8571 
	$∆80211_gë_mesh_c⁄fig
(
sk_buff
 *
skb
,

8572 
gíl_öfo
 *
öfo
)

8574 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

8575 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

8576 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

8577 
mesh_c⁄fig
 
cur_∑øms
;

8578 
îr
 = 0;

8579 *
hdr
;

8580 
∆©å
 *
pöfﬂâr
;

8581 
sk_buff
 *
msg
;

8583 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

8585 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
) {

8586 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8587  -
EOPNOTSUPP
;

8590 i‡(!
rdev
->
›s
->
gë_mesh_c⁄fig
) {

8591 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8592  -
EOPNOTSUPP
;

8596 i‡(!
wdev
->
u
.
mesh
.
id_Àn
)

8597 
	`mem˝y
(&
cur_∑øms
, &
deÁu…_mesh_c⁄fig
, (cur_params));

8599 
îr
 = 
	`rdev_gë_mesh_c⁄fig
(
rdev
, 
dev
, &
cur_∑øms
);

8601 i‡(
îr
) {

8602 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8603  
îr
;

8607 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

8608 i‡(!
msg
) {

8609 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8610  -
ENOMEM
;

8612 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

8613 
NL80211_CMD_GET_MESH_CONFIG
);

8614 i‡(!
hdr
) {

8615 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8616 
out
;

8618 
pöfﬂâr
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_MESH_CONFIG
);

8619 i‡(!
pöfﬂâr
) {

8620 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8621 
∆a_put_Áûuª
;

8623 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

8624 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_RETRY_TIMEOUT
,

8625 
cur_∑øms
.
dŸ11MeshRëryTimeout
) ||

8626 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_CONFIRM_TIMEOUT
,

8627 
cur_∑øms
.
dŸ11MeshC⁄fúmTimeout
) ||

8628 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_HOLDING_TIMEOUT
,

8629 
cur_∑øms
.
dŸ11MeshHﬁdögTimeout
) ||

8630 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_MAX_PEER_LINKS
,

8631 
cur_∑øms
.
dŸ11MeshMaxPìrLöks
) ||

8632 
	`∆a_put_u8
(
msg
, 
NL80211_MESHCONF_MAX_RETRIES
,

8633 
cur_∑øms
.
dŸ11MeshMaxRërõs
) ||

8634 
	`∆a_put_u8
(
msg
, 
NL80211_MESHCONF_TTL
,

8635 
cur_∑øms
.
dŸ11MeshTTL
) ||

8636 
	`∆a_put_u8
(
msg
, 
NL80211_MESHCONF_ELEMENT_TTL
,

8637 
cur_∑øms
.
ñemít_âl
) ||

8638 
	`∆a_put_u8
(
msg
, 
NL80211_MESHCONF_AUTO_OPEN_PLINKS
,

8639 
cur_∑øms
.
auto_›í_∂öks
) ||

8640 
	`∆a_put_u32
(
msg
, 
NL80211_MESHCONF_SYNC_OFFSET_MAX_NEIGHBOR
,

8641 
cur_∑øms
.
dŸ11MeshNbrOff£tMaxNeighb‹
) ||

8642 
	`∆a_put_u8
(
msg
, 
NL80211_MESHCONF_HWMP_MAX_PREQ_RETRIES
,

8643 
cur_∑øms
.
dŸ11MeshHWMPmaxPREQªåõs
) ||

8644 
	`∆a_put_u32
(
msg
, 
NL80211_MESHCONF_PATH_REFRESH_TIME
,

8645 
cur_∑øms
.
∑th_ª‰esh_time
) ||

8646 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_MIN_DISCOVERY_TIMEOUT
,

8647 
cur_∑øms
.
mö_discovîy_timeout
) ||

8648 
	`∆a_put_u32
(
msg
, 
NL80211_MESHCONF_HWMP_ACTIVE_PATH_TIMEOUT
,

8649 
cur_∑øms
.
dŸ11MeshHWMPa˘iveP©hTimeout
) ||

8650 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_HWMP_PREQ_MIN_INTERVAL
,

8651 
cur_∑øms
.
dŸ11MeshHWMP¥eqMöI¡îvÆ
) ||

8652 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_HWMP_PERR_MIN_INTERVAL
,

8653 
cur_∑øms
.
dŸ11MeshHWMP≥ºMöI¡îvÆ
) ||

8654 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_HWMP_NET_DIAM_TRVS_TIME
,

8655 
cur_∑øms
.
dŸ11MeshHWMP√tDümëîTøvîßlTime
) ||

8656 
	`∆a_put_u8
(
msg
, 
NL80211_MESHCONF_HWMP_ROOTMODE
,

8657 
cur_∑øms
.
dŸ11MeshHWMPRoŸMode
) ||

8658 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_HWMP_RANN_INTERVAL
,

8659 
cur_∑øms
.
dŸ11MeshHWMPR™nI¡îvÆ
) ||

8660 
	`∆a_put_u8
(
msg
, 
NL80211_MESHCONF_GATE_ANNOUNCEMENTS
,

8661 
cur_∑øms
.
dŸ11MeshG©eA¬oun˚mítPrŸocﬁ
) ||

8662 
	`∆a_put_u8
(
msg
, 
NL80211_MESHCONF_FORWARDING
,

8663 
cur_∑øms
.
dŸ11MeshF‹w¨dög
) ||

8664 
	`∆a_put_s32
(
msg
, 
NL80211_MESHCONF_RSSI_THRESHOLD
,

8665 
cur_∑øms
.
rssi_thªshﬁd
) ||

8666 
	`∆a_put_u32
(
msg
, 
NL80211_MESHCONF_HT_OPMODE
,

8667 
cur_∑øms
.
ht_›mode
) ||

8668 
	`∆a_put_u32
(
msg
, 
NL80211_MESHCONF_HWMP_PATH_TO_ROOT_TIMEOUT
,

8669 
cur_∑øms
.
dŸ11MeshHWMPa˘iveP©hToRoŸTimeout
) ||

8670 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_HWMP_ROOT_INTERVAL
,

8671 
cur_∑øms
.
dŸ11MeshHWMProŸI¡îvÆ
) ||

8672 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_HWMP_CONFIRMATION_INTERVAL
,

8673 
cur_∑øms
.
dŸ11MeshHWMPc⁄fúm©i⁄I¡îvÆ
) ||

8674 
	`∆a_put_u32
(
msg
, 
NL80211_MESHCONF_POWER_MODE
,

8675 
cur_∑øms
.
powî_mode
) ||

8676 
	`∆a_put_u16
(
msg
, 
NL80211_MESHCONF_AWAKE_WINDOW
,

8677 
cur_∑øms
.
dŸ11MeshAwakeWödowDuøti⁄
) ||

8678 
	`∆a_put_u32
(
msg
, 
NL80211_MESHCONF_PLINK_TIMEOUT
,

8679 
cur_∑øms
.
∂ök_timeout
) ||

8680 
	`∆a_put_u8
(
msg
, 
NL80211_MESHCONF_CONNECTED_TO_GATE
,

8681 
cur_∑øms
.
dŸ11MeshC⁄√˘edToMeshG©e
) ||

8682 
	`∆a_put_u8
(
msg
, 
NL80211_MESHCONF_NOLEARN
,

8683 
cur_∑øms
.
dŸ11MeshNﬁó∫
) ||

8684 
	`∆a_put_u8
(
msg
, 
NL80211_MESHCONF_CONNECTED_TO_AS
,

8685 
cur_∑øms
.
dŸ11MeshC⁄√˘edToAuthSîvî
)) {

8686 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8687 
∆a_put_Áûuª
;

8689 
	`∆a_√°_íd
(
msg
, 
pöfﬂâr
);

8690 
	`gílmsg_íd
(
msg
, 
hdr
);

8691 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8692  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

8694 
∆a_put_Áûuª
:

8695 
out
:

8696 
	`∆msg_‰ì
(
msg
);

8697 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8698  -
ENOBUFS
;

8699 
	}
}

8701 c⁄° 
∆a_pﬁicy


8702 
	g∆80211_meshc⁄f_∑øms_pﬁicy
[
NL80211_MESHCONF_ATTR_MAX
+1] = {

8703 [
NL80211_MESHCONF_RETRY_TIMEOUT
] =

8704 
NLA_POLICY_RANGE
(
NLA_U16
, 1, 255),

8705 [
NL80211_MESHCONF_CONFIRM_TIMEOUT
] =

8706 
NLA_POLICY_RANGE
(
NLA_U16
, 1, 255),

8707 [
NL80211_MESHCONF_HOLDING_TIMEOUT
] =

8708 
NLA_POLICY_RANGE
(
NLA_U16
, 1, 255),

8709 [
NL80211_MESHCONF_MAX_PEER_LINKS
] =

8710 
NLA_POLICY_RANGE
(
NLA_U16
, 0, 255),

8711 [
NL80211_MESHCONF_MAX_RETRIES
] = 
NLA_POLICY_MAX
(
NLA_U8
, 16),

8712 [
NL80211_MESHCONF_TTL
] = 
NLA_POLICY_MIN
(
NLA_U8
, 1),

8713 [
NL80211_MESHCONF_ELEMENT_TTL
] = 
NLA_POLICY_MIN
(
NLA_U8
, 1),

8714 [
NL80211_MESHCONF_AUTO_OPEN_PLINKS
] = 
NLA_POLICY_MAX
(
NLA_U8
, 1),

8715 [
NL80211_MESHCONF_SYNC_OFFSET_MAX_NEIGHBOR
] =

8716 
NLA_POLICY_RANGE
(
NLA_U32
, 1, 255),

8717 [
NL80211_MESHCONF_HWMP_MAX_PREQ_RETRIES
] = { .
ty≥
 = 
NLA_U8
 },

8718 [
NL80211_MESHCONF_PATH_REFRESH_TIME
] = { .
ty≥
 = 
NLA_U32
 },

8719 [
NL80211_MESHCONF_MIN_DISCOVERY_TIMEOUT
] = 
NLA_POLICY_MIN
(
NLA_U16
, 1),

8720 [
NL80211_MESHCONF_HWMP_ACTIVE_PATH_TIMEOUT
] = { .
ty≥
 = 
NLA_U32
 },

8721 [
NL80211_MESHCONF_HWMP_PREQ_MIN_INTERVAL
] =

8722 
NLA_POLICY_MIN
(
NLA_U16
, 1),

8723 [
NL80211_MESHCONF_HWMP_PERR_MIN_INTERVAL
] =

8724 
NLA_POLICY_MIN
(
NLA_U16
, 1),

8725 [
NL80211_MESHCONF_HWMP_NET_DIAM_TRVS_TIME
] =

8726 
NLA_POLICY_MIN
(
NLA_U16
, 1),

8727 [
NL80211_MESHCONF_HWMP_ROOTMODE
] = 
NLA_POLICY_MAX
(
NLA_U8
, 4),

8728 [
NL80211_MESHCONF_HWMP_RANN_INTERVAL
] =

8729 
NLA_POLICY_MIN
(
NLA_U16
, 1),

8730 [
NL80211_MESHCONF_GATE_ANNOUNCEMENTS
] = 
NLA_POLICY_MAX
(
NLA_U8
, 1),

8731 [
NL80211_MESHCONF_FORWARDING
] = 
NLA_POLICY_MAX
(
NLA_U8
, 1),

8732 [
NL80211_MESHCONF_RSSI_THRESHOLD
] =

8733 
NLA_POLICY_RANGE
(
NLA_S32
, -255, 0),

8734 [
NL80211_MESHCONF_HT_OPMODE
] = { .
ty≥
 = 
NLA_U16
 },

8735 [
NL80211_MESHCONF_HWMP_PATH_TO_ROOT_TIMEOUT
] = { .
ty≥
 = 
NLA_U32
 },

8736 [
NL80211_MESHCONF_HWMP_ROOT_INTERVAL
] =

8737 
NLA_POLICY_MIN
(
NLA_U16
, 1),

8738 [
NL80211_MESHCONF_HWMP_CONFIRMATION_INTERVAL
] =

8739 
NLA_POLICY_MIN
(
NLA_U16
, 1),

8740 [
NL80211_MESHCONF_POWER_MODE
] =

8741 
NLA_POLICY_RANGE
(
NLA_U32
,

8742 
NL80211_MESH_POWER_ACTIVE
,

8743 
NL80211_MESH_POWER_MAX
),

8744 [
NL80211_MESHCONF_AWAKE_WINDOW
] = { .
ty≥
 = 
NLA_U16
 },

8745 [
NL80211_MESHCONF_PLINK_TIMEOUT
] = { .
ty≥
 = 
NLA_U32
 },

8746 [
NL80211_MESHCONF_CONNECTED_TO_GATE
] = 
NLA_POLICY_RANGE
(
NLA_U8
, 0, 1),

8747 [
NL80211_MESHCONF_NOLEARN
] = 
NLA_POLICY_RANGE
(
NLA_U8
, 0, 1),

8748 [
NL80211_MESHCONF_CONNECTED_TO_AS
] = 
NLA_POLICY_RANGE
(
NLA_U8
, 0, 1),

8751 c⁄° 
∆a_pﬁicy


8752 
	g∆80211_mesh_£tup_∑øms_pﬁicy
[
NL80211_MESH_SETUP_ATTR_MAX
+1] = {

8753 [
NL80211_MESH_SETUP_ENABLE_VENDOR_SYNC
] = { .
ty≥
 = 
NLA_U8
 },

8754 [
NL80211_MESH_SETUP_ENABLE_VENDOR_PATH_SEL
] = { .
ty≥
 = 
NLA_U8
 },

8755 [
NL80211_MESH_SETUP_ENABLE_VENDOR_METRIC
] = { .
ty≥
 = 
NLA_U8
 },

8756 [
NL80211_MESH_SETUP_USERSPACE_AUTH
] = { .
ty≥
 = 
NLA_FLAG
 },

8757 [
NL80211_MESH_SETUP_AUTH_PROTOCOL
] = { .
ty≥
 = 
NLA_U8
 },

8758 [
NL80211_MESH_SETUP_USERSPACE_MPM
] = { .
ty≥
 = 
NLA_FLAG
 },

8759 [
NL80211_MESH_SETUP_IE
] =

8760 
NLA_POLICY_VALIDATE_FN
(
NLA_BINARY
, 
vÆid©e_õ_©å
,

8761 
IEEE80211_MAX_DATA_LEN
),

8762 [
NL80211_MESH_SETUP_USERSPACE_AMPE
] = { .
ty≥
 = 
NLA_FLAG
 },

8765 
	$∆80211_∑r£_mesh_c⁄fig
(
gíl_öfo
 *
öfo
,

8766 
mesh_c⁄fig
 *
cfg
,

8767 
u32
 *
mask_out
)

8769 
∆©å
 *
tb
[
NL80211_MESHCONF_ATTR_MAX
 + 1];

8770 
u32
 
mask
 = 0;

8771 
u16
 
ht_›mode
;

8773 
	#FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
∑øm
, 
mask
, 
©å
, 
‚
) \

8775 i‡(
tb
[
©å
]) { \

8776 
cfg
->
∑øm
 = 
	`‚
(
tb
[
©å
]); \

8777 
mask
 |
	`BIT
((
©å
) - 1); \

8779 } 0)

	)

8781 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MESH_CONFIG
])

8782  -
EINVAL
;

8783 i‡(
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
NL80211_MESHCONF_ATTR_MAX
, 
öfo
->
©ås
[
NL80211_ATTR_MESH_CONFIG
], 
∆80211_meshc⁄f_∑øms_pﬁicy
, info->
exèck
))

8784  -
EINVAL
;

8788 
	`BUILD_BUG_ON
(
NL80211_MESHCONF_ATTR_MAX
 > 32);

8791 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshRëryTimeout
, 
mask
,

8792 
NL80211_MESHCONF_RETRY_TIMEOUT
, 
∆a_gë_u16
);

8793 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshC⁄fúmTimeout
, 
mask
,

8794 
NL80211_MESHCONF_CONFIRM_TIMEOUT
,

8795 
∆a_gë_u16
);

8796 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshHﬁdögTimeout
, 
mask
,

8797 
NL80211_MESHCONF_HOLDING_TIMEOUT
,

8798 
∆a_gë_u16
);

8799 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshMaxPìrLöks
, 
mask
,

8800 
NL80211_MESHCONF_MAX_PEER_LINKS
,

8801 
∆a_gë_u16
);

8802 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshMaxRërõs
, 
mask
,

8803 
NL80211_MESHCONF_MAX_RETRIES
, 
∆a_gë_u8
);

8804 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshTTL
, 
mask
,

8805 
NL80211_MESHCONF_TTL
, 
∆a_gë_u8
);

8806 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
ñemít_âl
, 
mask
,

8807 
NL80211_MESHCONF_ELEMENT_TTL
, 
∆a_gë_u8
);

8808 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
auto_›í_∂öks
, 
mask
,

8809 
NL80211_MESHCONF_AUTO_OPEN_PLINKS
,

8810 
∆a_gë_u8
);

8811 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshNbrOff£tMaxNeighb‹
,

8812 
mask
,

8813 
NL80211_MESHCONF_SYNC_OFFSET_MAX_NEIGHBOR
,

8814 
∆a_gë_u32
);

8815 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshHWMPmaxPREQªåõs
, 
mask
,

8816 
NL80211_MESHCONF_HWMP_MAX_PREQ_RETRIES
,

8817 
∆a_gë_u8
);

8818 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
∑th_ª‰esh_time
, 
mask
,

8819 
NL80211_MESHCONF_PATH_REFRESH_TIME
,

8820 
∆a_gë_u32
);

8821 i‡(
mask
 & 
	`BIT
(
NL80211_MESHCONF_PATH_REFRESH_TIME
) &&

8822 (
cfg
->
∑th_ª‰esh_time
 < 1 || cfg->path_refresh_time > 65535))

8823  -
EINVAL
;

8824 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
mö_discovîy_timeout
, 
mask
,

8825 
NL80211_MESHCONF_MIN_DISCOVERY_TIMEOUT
,

8826 
∆a_gë_u16
);

8827 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshHWMPa˘iveP©hTimeout
,

8828 
mask
,

8829 
NL80211_MESHCONF_HWMP_ACTIVE_PATH_TIMEOUT
,

8830 
∆a_gë_u32
);

8831 i‡(
mask
 & 
	`BIT
(
NL80211_MESHCONF_HWMP_ACTIVE_PATH_TIMEOUT
) &&

8832 (
cfg
->
dŸ11MeshHWMPa˘iveP©hTimeout
 < 1 ||

8833 
cfg
->
dŸ11MeshHWMPa˘iveP©hTimeout
 > 65535))

8834  -
EINVAL
;

8835 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshHWMP¥eqMöI¡îvÆ
, 
mask
,

8836 
NL80211_MESHCONF_HWMP_PREQ_MIN_INTERVAL
,

8837 
∆a_gë_u16
);

8838 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshHWMP≥ºMöI¡îvÆ
, 
mask
,

8839 
NL80211_MESHCONF_HWMP_PERR_MIN_INTERVAL
,

8840 
∆a_gë_u16
);

8841 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
,

8842 
dŸ11MeshHWMP√tDümëîTøvîßlTime
, 
mask
,

8843 
NL80211_MESHCONF_HWMP_NET_DIAM_TRVS_TIME
,

8844 
∆a_gë_u16
);

8845 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshHWMPRoŸMode
, 
mask
,

8846 
NL80211_MESHCONF_HWMP_ROOTMODE
, 
∆a_gë_u8
);

8847 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshHWMPR™nI¡îvÆ
, 
mask
,

8848 
NL80211_MESHCONF_HWMP_RANN_INTERVAL
,

8849 
∆a_gë_u16
);

8850 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshG©eA¬oun˚mítPrŸocﬁ
,

8851 
mask
, 
NL80211_MESHCONF_GATE_ANNOUNCEMENTS
,

8852 
∆a_gë_u8
);

8853 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshF‹w¨dög
, 
mask
,

8854 
NL80211_MESHCONF_FORWARDING
, 
∆a_gë_u8
);

8855 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
rssi_thªshﬁd
, 
mask
,

8856 
NL80211_MESHCONF_RSSI_THRESHOLD
,

8857 
∆a_gë_s32
);

8858 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshC⁄√˘edToMeshG©e
, 
mask
,

8859 
NL80211_MESHCONF_CONNECTED_TO_GATE
,

8860 
∆a_gë_u8
);

8861 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshC⁄√˘edToAuthSîvî
, 
mask
,

8862 
NL80211_MESHCONF_CONNECTED_TO_AS
,

8863 
∆a_gë_u8
);

8868 i‡(
tb
[
NL80211_MESHCONF_HT_OPMODE
]) {

8869 
ht_›mode
 = 
	`∆a_gë_u16
(
tb
[
NL80211_MESHCONF_HT_OPMODE
]);

8871 i‡(
ht_›mode
 & ~(
IEEE80211_HT_OP_MODE_PROTECTION
 |

8872 
IEEE80211_HT_OP_MODE_NON_GF_STA_PRSNT
 |

8873 
IEEE80211_HT_OP_MODE_NON_HT_STA_PRSNT
))

8874  -
EINVAL
;

8877 
ht_›mode
 &~
IEEE80211_HT_OP_MODE_NON_HT_STA_PRSNT
;

8879 
cfg
->
ht_›mode
 = ht_opmode;

8880 
mask
 |(1 << (
NL80211_MESHCONF_HT_OPMODE
 - 1));

8882 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
,

8883 
dŸ11MeshHWMPa˘iveP©hToRoŸTimeout
, 
mask
,

8884 
NL80211_MESHCONF_HWMP_PATH_TO_ROOT_TIMEOUT
,

8885 
∆a_gë_u32
);

8886 i‡(
mask
 & 
	`BIT
(
NL80211_MESHCONF_HWMP_PATH_TO_ROOT_TIMEOUT
) &&

8887 (
cfg
->
dŸ11MeshHWMPa˘iveP©hToRoŸTimeout
 < 1 ||

8888 
cfg
->
dŸ11MeshHWMPa˘iveP©hToRoŸTimeout
 > 65535))

8889  -
EINVAL
;

8890 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshHWMProŸI¡îvÆ
, 
mask
,

8891 
NL80211_MESHCONF_HWMP_ROOT_INTERVAL
,

8892 
∆a_gë_u16
);

8893 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshHWMPc⁄fúm©i⁄I¡îvÆ
,

8894 
mask
,

8895 
NL80211_MESHCONF_HWMP_CONFIRMATION_INTERVAL
,

8896 
∆a_gë_u16
);

8897 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
powî_mode
, 
mask
,

8898 
NL80211_MESHCONF_POWER_MODE
, 
∆a_gë_u32
);

8899 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshAwakeWödowDuøti⁄
, 
mask
,

8900 
NL80211_MESHCONF_AWAKE_WINDOW
, 
∆a_gë_u16
);

8901 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
∂ök_timeout
, 
mask
,

8902 
NL80211_MESHCONF_PLINK_TIMEOUT
, 
∆a_gë_u32
);

8903 
	`FILL_IN_MESH_PARAM_IF_SET
(
tb
, 
cfg
, 
dŸ11MeshNﬁó∫
, 
mask
,

8904 
NL80211_MESHCONF_NOLEARN
, 
∆a_gë_u8
);

8905 i‡(
mask_out
)

8906 *
mask_out
 = 
mask
;

8910 #unde‡
FILL_IN_MESH_PARAM_IF_SET


8911 
	}
}

8913 
	$∆80211_∑r£_mesh_£tup
(
gíl_öfo
 *
öfo
,

8914 
mesh_£tup
 *
£tup
)

8916 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

8917 
∆©å
 *
tb
[
NL80211_MESH_SETUP_ATTR_MAX
 + 1];

8919 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MESH_SETUP
])

8920  -
EINVAL
;

8921 i‡(
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
NL80211_MESH_SETUP_ATTR_MAX
, 
öfo
->
©ås
[
NL80211_ATTR_MESH_SETUP
], 
∆80211_mesh_£tup_∑øms_pﬁicy
, info->
exèck
))

8922  -
EINVAL
;

8924 i‡(
tb
[
NL80211_MESH_SETUP_ENABLE_VENDOR_SYNC
])

8925 
£tup
->
sync_mëhod
 =

8926 (
	`∆a_gë_u8
(
tb
[
NL80211_MESH_SETUP_ENABLE_VENDOR_SYNC
])) ?

8927 
IEEE80211_SYNC_METHOD_VENDOR
 :

8928 
IEEE80211_SYNC_METHOD_NEIGHBOR_OFFSET
;

8930 i‡(
tb
[
NL80211_MESH_SETUP_ENABLE_VENDOR_PATH_SEL
])

8931 
£tup
->
∑th_£l_¥Ÿo
 =

8932 (
	`∆a_gë_u8
(
tb
[
NL80211_MESH_SETUP_ENABLE_VENDOR_PATH_SEL
])) ?

8933 
IEEE80211_PATH_PROTOCOL_VENDOR
 :

8934 
IEEE80211_PATH_PROTOCOL_HWMP
;

8936 i‡(
tb
[
NL80211_MESH_SETUP_ENABLE_VENDOR_METRIC
])

8937 
£tup
->
∑th_mëric
 =

8938 (
	`∆a_gë_u8
(
tb
[
NL80211_MESH_SETUP_ENABLE_VENDOR_METRIC
])) ?

8939 
IEEE80211_PATH_METRIC_VENDOR
 :

8940 
IEEE80211_PATH_METRIC_AIRTIME
;

8942 i‡(
tb
[
NL80211_MESH_SETUP_IE
]) {

8943 
∆©å
 *
õ©å
 =

8944 
tb
[
NL80211_MESH_SETUP_IE
];

8945 
£tup
->
õ
 = 
	`∆a_d©a
(
õ©å
);

8946 
£tup
->
õ_Àn
 = 
	`∆a_Àn
(
õ©å
);

8948 i‡(
tb
[
NL80211_MESH_SETUP_USERSPACE_MPM
] &&

8949 !(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_USERSPACE_MPM
))

8950  -
EINVAL
;

8951 
£tup
->
u£r_mpm
 = 
	`∆a_gë_Êag
(
tb
[
NL80211_MESH_SETUP_USERSPACE_MPM
]);

8952 
£tup
->
is_authítiˇãd
 = 
	`∆a_gë_Êag
(
tb
[
NL80211_MESH_SETUP_USERSPACE_AUTH
]);

8953 
£tup
->
is_£cuª
 = 
	`∆a_gë_Êag
(
tb
[
NL80211_MESH_SETUP_USERSPACE_AMPE
]);

8954 i‡(
£tup
->
is_£cuª
)

8955 
£tup
->
u£r_mpm
 = 
åue
;

8957 i‡(
tb
[
NL80211_MESH_SETUP_AUTH_PROTOCOL
]) {

8958 i‡(!
£tup
->
u£r_mpm
)

8959  -
EINVAL
;

8960 
£tup
->
auth_id
 =

8961 
	`∆a_gë_u8
(
tb
[
NL80211_MESH_SETUP_AUTH_PROTOCOL
]);

8965 
	}
}

8967 
	$∆80211_upd©e_mesh_c⁄fig
(
sk_buff
 *
skb
,

8968 
gíl_öfo
 *
öfo
)

8970 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

8971 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

8972 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

8973 
mesh_c⁄fig
 
cfg
 = {};

8974 
u32
 
mask
;

8975 
îr
;

8977 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

8979 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
) {

8980 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8981  -
EOPNOTSUPP
;

8984 i‡(!
rdev
->
›s
->
upd©e_mesh_c⁄fig
) {

8985 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8986  -
EOPNOTSUPP
;

8989 
îr
 = 
	`∆80211_∑r£_mesh_c⁄fig
(
öfo
, &
cfg
, &
mask
);

8990 i‡(
îr
) {

8991 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

8992  
îr
;

8995 i‡(!
wdev
->
u
.
mesh
.
id_Àn
)

8996 
îr
 = -
ENOLINK
;

8998 i‡(!
îr
)

8999 
îr
 = 
	`rdev_upd©e_mesh_c⁄fig
(
rdev
, 
dev
, 
mask
, &
cfg
);

9001 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9002  
îr
;

9003 
	}
}

9005 
	$∆80211_put_ªgdom
(c⁄° 
õì80211_ªgdomaö
 *
ªgdom
,

9006 
sk_buff
 *
msg
)

9008 
∆©å
 *
∆_ªg_ruÀs
;

9009 
i
;

9011 i‡(
	`∆a_put_°rög
(
msg
, 
NL80211_ATTR_REG_ALPHA2
, 
ªgdom
->
Æpha2
) ||

9012 (
ªgdom
->
dfs_ªgi⁄
 &&

9013 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_DFS_REGION
, 
ªgdom
->
dfs_ªgi⁄
)))

9014 
∆a_put_Áûuª
;

9016 
∆_ªg_ruÀs
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_REG_RULES
);

9017 i‡(!
∆_ªg_ruÀs
)

9018 
∆a_put_Áûuª
;

9020 
i
 = 0; i < 
ªgdom
->
n_ªg_ruÀs
; i++) {

9021 
∆©å
 *
∆_ªg_ruÀ
;

9022 c⁄° 
õì80211_ªg_ruÀ
 *
ªg_ruÀ
;

9023 c⁄° 
õì80211_‰eq_ønge
 *
‰eq_ønge
;

9024 c⁄° 
õì80211_powî_ruÀ
 *
powî_ruÀ
;

9025 
max_b™dwidth_khz
;

9027 
ªg_ruÀ
 = &
ªgdom
->
ªg_ruÀs
[
i
];

9028 
‰eq_ønge
 = &
ªg_ruÀ
->freq_range;

9029 
powî_ruÀ
 = &
ªg_ruÀ
->power_rule;

9031 
∆_ªg_ruÀ
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
i
);

9032 i‡(!
∆_ªg_ruÀ
)

9033 
∆a_put_Áûuª
;

9035 
max_b™dwidth_khz
 = 
‰eq_ønge
->max_bandwidth_khz;

9036 i‡(!
max_b™dwidth_khz
)

9037 
max_b™dwidth_khz
 = 
	`ªg_gë_max_b™dwidth
(
ªgdom
,

9038 
ªg_ruÀ
);

9040 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_REG_RULE_FLAGS
,

9041 
ªg_ruÀ
->
Êags
) ||

9042 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_FREQ_RANGE_START
,

9043 
‰eq_ønge
->
°¨t_‰eq_khz
) ||

9044 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_FREQ_RANGE_END
,

9045 
‰eq_ønge
->
íd_‰eq_khz
) ||

9046 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_FREQ_RANGE_MAX_BW
,

9047 
max_b™dwidth_khz
) ||

9048 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_POWER_RULE_MAX_ANT_GAIN
,

9049 
powî_ruÀ
->
max_™ã¬a_gaö
) ||

9050 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_POWER_RULE_MAX_EIRP
,

9051 
powî_ruÀ
->
max_eúp
) ||

9052 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_DFS_CAC_TIME
,

9053 
ªg_ruÀ
->
dfs_ˇc_ms
))

9054 
∆a_put_Áûuª
;

9056 i‡((
ªg_ruÀ
->
Êags
 & 
NL80211_RRF_PSD
) &&

9057 
	`∆a_put_s8
(
msg
, 
NL80211_ATTR_POWER_RULE_PSD
,

9058 
ªg_ruÀ
->
psd
))

9059 
∆a_put_Áûuª
;

9061 
	`∆a_√°_íd
(
msg
, 
∆_ªg_ruÀ
);

9064 
	`∆a_√°_íd
(
msg
, 
∆_ªg_ruÀs
);

9067 
∆a_put_Áûuª
:

9068  -
EMSGSIZE
;

9069 
	}
}

9071 
	$∆80211_gë_ªg_do
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

9073 c⁄° 
õì80211_ªgdomaö
 *
ªgdom
 = 
NULL
;

9074 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

9075 
wùhy
 *wùhy = 
NULL
;

9076 
sk_buff
 *
msg
;

9077 
îr
 = -
EMSGSIZE
;

9078 *
hdr
;

9080 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9082 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

9083 i‡(!
msg
) {

9084 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9085  -
ENOBUFS
;

9088 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

9089 
NL80211_CMD_GET_REG
);

9090 i‡(!
hdr
) {

9091 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9092 
put_Áûuª
;

9095 
	`π∆_lock
();

9097 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY
]) {

9098 
boﬁ
 
£lf_m™aged
;

9100 
rdev
 = 
	`cfg80211_gë_dev_‰om_öfo
(
	`gíl_öfo_√t
(
öfo
), info);

9101 i‡(
	`IS_ERR
(
rdev
)) {

9102 
îr
 = 
	`PTR_ERR
(
rdev
);

9103 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9104 
∆a_put_Áûuª
;

9107 
wùhy
 = &
rdev
->wiphy;

9108 
£lf_m™aged
 = 
wùhy
->
ªguœt‹y_Êags
 &

9109 
REGULATORY_WIPHY_SELF_MANAGED
;

9111 
	`rcu_ªad_lock
();

9113 
ªgdom
 = 
	`gë_wùhy_ªgdom
(
wùhy
);

9116 i‡(
	`WARN_ON
(!
ªgdom
 && 
£lf_m™aged
)) {

9117 
îr
 = -
EINVAL
;

9118 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9119 
∆a_put_Áûuª_rcu
;

9122 i‡(
ªgdom
 &&

9123 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
	`gë_wùhy_idx
(
wùhy
))) {

9124 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9125 
∆a_put_Áûuª_rcu
;

9128 
	`rcu_ªad_lock
();

9131 i‡(!
wùhy
 && 
	`ªg_œ°_ªque°_˚Œ_ba£
() &&

9132 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_USER_REG_HINT_TYPE
,

9133 
NL80211_USER_REG_HINT_CELL_BASE
)) {

9134 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9135 
∆a_put_Áûuª_rcu
;

9138 i‡(!
ªgdom
)

9139 
ªgdom
 = 
	`rcu_dîe„ªn˚
(
cfg80211_ªgdomaö
);

9141 i‡(
	`∆80211_put_ªgdom
(
ªgdom
, 
msg
)) {

9142 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9143 
∆a_put_Áûuª_rcu
;

9146 
	`rcu_ªad_u∆ock
();

9148 
	`gílmsg_íd
(
msg
, 
hdr
);

9149 
	`π∆_u∆ock
();

9150 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9151  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

9153 
∆a_put_Áûuª_rcu
:

9154 
	`rcu_ªad_u∆ock
();

9155 
∆a_put_Áûuª
:

9156 
	`π∆_u∆ock
();

9157 
put_Áûuª
:

9158 
	`∆msg_‰ì
(
msg
);

9159 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9160  
îr
;

9161 
	}
}

9163 
	$∆80211_£nd_ªgdom
(
sk_buff
 *
msg
, 
√éök_ˇŒback
 *
cb
,

9164 
u32
 
£q
, 
Êags
, 
wùhy
 *wiphy,

9165 c⁄° 
õì80211_ªgdomaö
 *
ªgdom
)

9167 *
hdr
 = 
	`∆80211hdr_put
(
msg
, 
	`NETLINK_CB
(
cb
->
skb
).
p‹tid
, 
£q
, 
Êags
,

9168 
NL80211_CMD_GET_REG
);

9170 i‡(!
hdr
)

9173 
	`gíl_dump_check_c⁄si°ít
(
cb
, 
hdr
);

9175 i‡(
	`∆80211_put_ªgdom
(
ªgdom
, 
msg
))

9176 
∆a_put_Áûuª
;

9178 i‡(!
wùhy
 && 
	`ªg_œ°_ªque°_˚Œ_ba£
() &&

9179 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_USER_REG_HINT_TYPE
,

9180 
NL80211_USER_REG_HINT_CELL_BASE
))

9181 
∆a_put_Áûuª
;

9183 i‡(
wùhy
 &&

9184 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
	`gë_wùhy_idx
(
wùhy
)))

9185 
∆a_put_Áûuª
;

9187 i‡(
wùhy
 && wùhy->
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
 &&

9188 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_WIPHY_SELF_MANAGED_REG
))

9189 
∆a_put_Áûuª
;

9191 
	`gílmsg_íd
(
msg
, 
hdr
);

9194 
∆a_put_Áûuª
:

9195 
	`gílmsg_ˇn˚l
(
msg
, 
hdr
);

9196  -
EMSGSIZE
;

9197 
	}
}

9199 
	$∆80211_gë_ªg_dump
(
sk_buff
 *
skb
,

9200 
√éök_ˇŒback
 *
cb
)

9202 c⁄° 
õì80211_ªgdomaö
 *
ªgdom
 = 
NULL
;

9203 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

9204 
îr
, 
ªg_idx
, 
°¨t
 = 
cb
->
¨gs
[2];

9206 
	`rcu_ªad_lock
();

9208 i‡(
cfg80211_ªgdomaö
 && 
°¨t
 == 0) {

9209 
îr
 = 
	`∆80211_£nd_ªgdom
(
skb
, 
cb
, cb->
∆h
->
∆msg_£q
,

9210 
NLM_F_MULTI
, 
NULL
,

9211 
	`rcu_dîe„ªn˚
(
cfg80211_ªgdomaö
));

9212 i‡(
îr
 < 0)

9213 
out_îr
;

9217 
ªg_idx
 = 1;

9218 
	`li°_f‹_óch_íåy_rcu
(
rdev
, &
cfg80211_rdev_li°
, 
li°
) {

9219 
ªgdom
 = 
	`gë_wùhy_ªgdom
(&
rdev
->
wùhy
);

9220 i‡(!
ªgdom
)

9223 i‡(++
ªg_idx
 <
°¨t
)

9226 
îr
 = 
	`∆80211_£nd_ªgdom
(
skb
, 
cb
, cb->
∆h
->
∆msg_£q
,

9227 
NLM_F_MULTI
, &
rdev
->
wùhy
, 
ªgdom
);

9228 i‡(
îr
 < 0) {

9229 
ªg_idx
--;

9234 
cb
->
¨gs
[2] = 
ªg_idx
;

9235 
îr
 = 
skb
->
Àn
;

9236 
out_îr
:

9237 
	`rcu_ªad_u∆ock
();

9238  
îr
;

9239 
	}
}

9241 #ifde‡
CONFIG_CFG80211_CRDA_SUPPORT


9242 c⁄° 
∆a_pﬁicy
 
	gªg_ruÀ_pﬁicy
[
NL80211_REG_RULE_ATTR_MAX
 + 1] = {

9243 [
NL80211_ATTR_REG_RULE_FLAGS
] = { .
ty≥
 = 
NLA_U32
 },

9244 [
NL80211_ATTR_FREQ_RANGE_START
] = { .
ty≥
 = 
NLA_U32
 },

9245 [
NL80211_ATTR_FREQ_RANGE_END
] = { .
ty≥
 = 
NLA_U32
 },

9246 [
NL80211_ATTR_FREQ_RANGE_MAX_BW
] = { .
ty≥
 = 
NLA_U32
 },

9247 [
NL80211_ATTR_POWER_RULE_MAX_ANT_GAIN
] = { .
ty≥
 = 
NLA_U32
 },

9248 [
NL80211_ATTR_POWER_RULE_MAX_EIRP
] = { .
ty≥
 = 
NLA_U32
 },

9249 [
NL80211_ATTR_DFS_CAC_TIME
] = { .
ty≥
 = 
NLA_U32
 },

9252 
	$∑r£_ªg_ruÀ
(
∆©å
 *
tb
[],

9253 
õì80211_ªg_ruÀ
 *
ªg_ruÀ
)

9255 
õì80211_‰eq_ønge
 *
‰eq_ønge
 = &
ªg_ruÀ
->freq_range;

9256 
õì80211_powî_ruÀ
 *
powî_ruÀ
 = &
ªg_ruÀ
->power_rule;

9258 i‡(!
tb
[
NL80211_ATTR_REG_RULE_FLAGS
])

9259  -
EINVAL
;

9260 i‡(!
tb
[
NL80211_ATTR_FREQ_RANGE_START
])

9261  -
EINVAL
;

9262 i‡(!
tb
[
NL80211_ATTR_FREQ_RANGE_END
])

9263  -
EINVAL
;

9264 i‡(!
tb
[
NL80211_ATTR_FREQ_RANGE_MAX_BW
])

9265  -
EINVAL
;

9266 i‡(!
tb
[
NL80211_ATTR_POWER_RULE_MAX_EIRP
])

9267  -
EINVAL
;

9269 
ªg_ruÀ
->
Êags
 = 
	`∆a_gë_u32
(
tb
[
NL80211_ATTR_REG_RULE_FLAGS
]);

9271 
‰eq_ønge
->
°¨t_‰eq_khz
 =

9272 
	`∆a_gë_u32
(
tb
[
NL80211_ATTR_FREQ_RANGE_START
]);

9273 
‰eq_ønge
->
íd_‰eq_khz
 =

9274 
	`∆a_gë_u32
(
tb
[
NL80211_ATTR_FREQ_RANGE_END
]);

9275 
‰eq_ønge
->
max_b™dwidth_khz
 =

9276 
	`∆a_gë_u32
(
tb
[
NL80211_ATTR_FREQ_RANGE_MAX_BW
]);

9278 
powî_ruÀ
->
max_eúp
 =

9279 
	`∆a_gë_u32
(
tb
[
NL80211_ATTR_POWER_RULE_MAX_EIRP
]);

9281 i‡(
tb
[
NL80211_ATTR_POWER_RULE_MAX_ANT_GAIN
])

9282 
powî_ruÀ
->
max_™ã¬a_gaö
 =

9283 
	`∆a_gë_u32
(
tb
[
NL80211_ATTR_POWER_RULE_MAX_ANT_GAIN
]);

9285 i‡(
tb
[
NL80211_ATTR_DFS_CAC_TIME
])

9286 
ªg_ruÀ
->
dfs_ˇc_ms
 =

9287 
	`∆a_gë_u32
(
tb
[
NL80211_ATTR_DFS_CAC_TIME
]);

9290 
	}
}

9292 
	$∆80211_£t_ªg
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

9294 
∆©å
 *
tb
[
NL80211_REG_RULE_ATTR_MAX
 + 1];

9295 
∆©å
 *
∆_ªg_ruÀ
;

9296 *
Æpha2
;

9297 
ªm_ªg_ruÀs
, 
r
;

9298 
u32
 
num_ruÀs
 = 0, 
ruÀ_idx
 = 0;

9299 
∆80211_dfs_ªgi⁄s
 
dfs_ªgi⁄
 = 
NL80211_DFS_UNSET
;

9300 
õì80211_ªgdomaö
 *
rd
;

9302 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

9304 i‡(!
öfo
->
©ås
[
NL80211_ATTR_REG_ALPHA2
]) {

9305 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9306  -
EINVAL
;

9309 i‡(!
öfo
->
©ås
[
NL80211_ATTR_REG_RULES
]) {

9310 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9311  -
EINVAL
;

9314 
Æpha2
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_REG_ALPHA2
]);

9316 i‡(
öfo
->
©ås
[
NL80211_ATTR_DFS_REGION
])

9317 
dfs_ªgi⁄
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_DFS_REGION
]);

9319 
	`∆a_f‹_óch_√°ed
(
∆_ªg_ruÀ
, 
öfo
->
©ås
[
NL80211_ATTR_REG_RULES
],

9320 
ªm_ªg_ruÀs
) {

9321 
num_ruÀs
++;

9322 i‡(
num_ruÀs
 > 
NL80211_MAX_SUPP_REG_RULES
) {

9323 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9324  -
EINVAL
;

9328 
	`π∆_lock
();

9329 i‡(!
	`ªg_is_vÆid_ªque°
(
Æpha2
)) {

9330 
r
 = -
EINVAL
;

9331 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9332 
out
;

9335 
rd
 = 
	`kzÆloc
(
	`°ru˘_size
‘d, 
ªg_ruÀs
, 
num_ruÀs
), 
GFP_KERNEL
);

9336 i‡(!
rd
) {

9337 
r
 = -
ENOMEM
;

9338 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9339 
out
;

9342 
rd
->
n_ªg_ruÀs
 = 
num_ruÀs
;

9343 
rd
->
Æpha2
[0] =álpha2[0];

9344 
rd
->
Æpha2
[1] =álpha2[1];

9350 i‡(
	`ªg_suµ‹ãd_dfs_ªgi⁄
(
dfs_ªgi⁄
))

9351 
rd
->
dfs_ªgi⁄
 = dfs_region;

9353 
	`∆a_f‹_óch_√°ed
(
∆_ªg_ruÀ
, 
öfo
->
©ås
[
NL80211_ATTR_REG_RULES
],

9354 
ªm_ªg_ruÀs
) {

9355 
r
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
NL80211_REG_RULE_ATTR_MAX
,

9356 
∆_ªg_ruÀ
, 
ªg_ruÀ_pﬁicy
,

9357 
öfo
->
exèck
);

9358 i‡(
r
) {

9359 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9360 
bad_ªg
;

9362 
r
 = 
	`∑r£_ªg_ruÀ
(
tb
, &
rd
->
ªg_ruÀs
[
ruÀ_idx
]);

9363 i‡(
r
) {

9364 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9365 
bad_ªg
;

9368 
ruÀ_idx
++;

9370 i‡(
ruÀ_idx
 > 
NL80211_MAX_SUPP_REG_RULES
) {

9371 
r
 = -
EINVAL
;

9372 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9373 
bad_ªg
;

9377 
r
 = 
	`£t_ªgdom
(
rd
, 
REGD_SOURCE_CRDA
);

9379 
rd
 = 
NULL
;

9380 
bad_ªg
:

9381 
	`k‰ì
(
rd
);

9382 
out
:

9383 
	`π∆_u∆ock
();

9384 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9385  
r
;

9386 
	}
}

9389 
	$vÆid©e_sˇn_‰eqs
(
∆©å
 *
‰eqs
)

9391 
∆©å
 *
©å1
, *
©å2
;

9392 
n_ch™√ls
 = 0, 
tmp1
, 
tmp2
;

9394 
	`∆a_f‹_óch_√°ed
(
©å1
, 
‰eqs
, 
tmp1
)

9395 i‡(
	`∆a_Àn
(
©å1
Ë!(
u32
))

9398 
	`∆a_f‹_óch_√°ed
(
©å1
, 
‰eqs
, 
tmp1
) {

9399 
n_ch™√ls
++;

9409 
	`∆a_f‹_óch_√°ed
(
©å2
, 
‰eqs
, 
tmp2
)

9410 i‡(
©å1
 !
©å2
 &&

9411 
	`∆a_gë_u32
(
©å1
Ë=∆a_gë_u32(
©å2
))

9415  
n_ch™√ls
;

9416 
	}
}

9418 
boﬁ
 
	$is_b™d_vÆid
(
wùhy
 *wùhy, 
∆80211_b™d
 
b
)

9420  
b
 < 
NUM_NL80211_BANDS
 && 
wùhy
->
b™ds
[b];

9421 
	}
}

9423 
	$∑r£_bss_£À˘
(
∆©å
 *
∆a
, 
wùhy
 *wiphy,

9424 
cfg80211_bss_£À˘i⁄
 *
bss_£À˘
)

9426 
∆©å
 *
©å
[
NL80211_BSS_SELECT_ATTR_MAX
 + 1];

9427 
∆©å
 *
√°
;

9428 
îr
;

9429 
boﬁ
 
found
 = 
Ál£
;

9430 
i
;

9433 
√°
 = 
	`∆a_d©a
(
∆a
);

9434 i‡(!
	`∆a_ok
(
√°
, 
	`∆a_Àn
(nest)))

9435  -
EINVAL
;

9437 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
©å
, 
NL80211_BSS_SELECT_ATTR_MAX
,

9438 
√°
, 
∆80211_bss_£À˘_pﬁicy
,

9439 
NULL
);

9440 i‡(
îr
)

9441  
îr
;

9444 
i
 = 0; i <
NL80211_BSS_SELECT_ATTR_MAX
; i++) {

9445 i‡(
©å
[
i
]) {

9446 i‡(
found
)

9447  -
EINVAL
;

9448 
found
 = 
åue
;

9452 
bss_£À˘
->
behaviour
 = 
__NL80211_BSS_SELECT_ATTR_INVALID
;

9454 i‡(
©å
[
NL80211_BSS_SELECT_ATTR_RSSI
])

9455 
bss_£À˘
->
behaviour
 = 
NL80211_BSS_SELECT_ATTR_RSSI
;

9457 i‡(
©å
[
NL80211_BSS_SELECT_ATTR_BAND_PREF
]) {

9458 
bss_£À˘
->
behaviour
 = 
NL80211_BSS_SELECT_ATTR_BAND_PREF
;

9459 
bss_£À˘
->
∑øm
.
b™d_¥ef
 =

9460 
	`∆a_gë_u32
(
©å
[
NL80211_BSS_SELECT_ATTR_BAND_PREF
]);

9461 i‡(!
	`is_b™d_vÆid
(
wùhy
, 
bss_£À˘
->
∑øm
.
b™d_¥ef
))

9462  -
EINVAL
;

9465 i‡(
©å
[
NL80211_BSS_SELECT_ATTR_RSSI_ADJUST
]) {

9466 
∆80211_bss_£À˘_rssi_adju°
 *
adj_∑øm
;

9468 
adj_∑øm
 = 
	`∆a_d©a
(
©å
[
NL80211_BSS_SELECT_ATTR_RSSI_ADJUST
]);

9469 
bss_£À˘
->
behaviour
 = 
NL80211_BSS_SELECT_ATTR_RSSI_ADJUST
;

9470 
bss_£À˘
->
∑øm
.
adju°
.
b™d
 = 
adj_∑øm
->band;

9471 
bss_£À˘
->
∑øm
.
adju°
.
dñè
 = 
adj_∑øm
->delta;

9472 i‡(!
	`is_b™d_vÆid
(
wùhy
, 
bss_£À˘
->
∑øm
.
adju°
.
b™d
))

9473  -
EINVAL
;

9477 i‡(
bss_£À˘
->
behaviour
 =
__NL80211_BSS_SELECT_ATTR_INVALID
)

9478  -
EINVAL
;

9480 i‡(!(
wùhy
->
bss_£À˘_suµ‹t
 & 
	`BIT
(
bss_£À˘
->
behaviour
)))

9481  -
EINVAL
;

9484 
	}
}

9486 
	$∆80211_∑r£_øndom_mac
(
∆©å
 **
©ås
,

9487 
u8
 *
mac_addr
, u8 *
mac_addr_mask
)

9489 
i
;

9491 i‡(!
©ås
[
NL80211_ATTR_MAC
] && !©ås[
NL80211_ATTR_MAC_MASK
]) {

9492 
	`ëh_zîo_addr
(
mac_addr
);

9493 
	`ëh_zîo_addr
(
mac_addr_mask
);

9494 
mac_addr
[0] = 0x2;

9495 
mac_addr_mask
[0] = 0x3;

9501 i‡(!
©ås
[
NL80211_ATTR_MAC
] || !©ås[
NL80211_ATTR_MAC_MASK
])

9502  -
EINVAL
;

9504 
	`mem˝y
(
mac_addr
, 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_MAC
]), 
ETH_ALEN
);

9505 
	`mem˝y
(
mac_addr_mask
, 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_MAC_MASK
]), 
ETH_ALEN
);

9508 i‡(!
	`is_mu…iˇ°_ëhî_addr
(
mac_addr_mask
) ||

9509 
	`is_mu…iˇ°_ëhî_addr
(
mac_addr
))

9510  -
EINVAL
;

9517 
i
 = 0; i < 
ETH_ALEN
; i++)

9518 
mac_addr
[
i
] &
mac_addr_mask
[i];

9521 
	}
}

9523 
boﬁ
 
	$cfg80211_off_ch™√l_›î_Ælowed
(
wúñess_dev
 *
wdev
,

9524 
õì80211_ch™√l
 *
ch™
)

9526 
lök_id
;

9527 
boﬁ
 
Æl_ok
 = 
åue
;

9529 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

9531 i‡(!
	`cfg80211_bóc⁄ög_iÁ˚_a˘ive
(
wdev
))

9532  
åue
;

9542 
	`f‹_óch_vÆid_lök
(
wdev
, 
lök_id
) {

9543 
cfg80211_ch™_def
 *
ch™def
;

9545 
ch™def
 = 
	`wdev_ch™def
(
wdev
, 
lök_id
);

9546 i‡(!
ch™def
 || !ch™def->
ch™
)

9556 i‡(
ch™def
->
ch™
->
Êags
 & 
IEEE80211_CHAN_RADAR
)

9557 
Æl_ok
 = 
Ál£
;

9560 i‡(
Æl_ok
)

9561  
åue
;

9563  
	`ªguœt‹y_¥e_ˇc_Ælowed
(
wdev
->
wùhy
);

9564 
	}
}

9566 
boﬁ
 
	$∆80211_check_sˇn_„©
(
wùhy
 *wùhy, 
u32
 
Êags
, u32 
Êag
,

9567 
∆80211_ext_„©uª_ödex
 
„©
)

9569 i‡(!(
Êags
 & 
Êag
))

9570  
åue
;

9571 i‡(
	`wùhy_ext_„©uª_is£t
(
wùhy
, 
„©
))

9572  
åue
;

9573  
Ál£
;

9574 
	}
}

9577 
	$∆80211_check_sˇn_Êags
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

9578 *
ªque°
, 
∆©å
 **
©ås
,

9579 
boﬁ
 
is_sched_sˇn
)

9581 
u8
 *
mac_addr
, *
mac_addr_mask
;

9582 
u32
 *
Êags
;

9583 
∆80211_„©uª_Êags
 
øndom√ss_Êag
;

9585 i‡(!
©ås
[
NL80211_ATTR_SCAN_FLAGS
])

9588 i‡(
is_sched_sˇn
) {

9589 
cfg80211_sched_sˇn_ªque°
 *
ªq
 = 
ªque°
;

9591 
øndom√ss_Êag
 = 
wdev
 ?

9592 
NL80211_FEATURE_SCHED_SCAN_RANDOM_MAC_ADDR
 :

9593 
NL80211_FEATURE_ND_RANDOM_MAC_ADDR
;

9594 
Êags
 = &
ªq
->flags;

9595 
mac_addr
 = 
ªq
->mac_addr;

9596 
mac_addr_mask
 = 
ªq
->mac_addr_mask;

9598 
cfg80211_sˇn_ªque°
 *
ªq
 = 
ªque°
;

9600 
øndom√ss_Êag
 = 
NL80211_FEATURE_SCAN_RANDOM_MAC_ADDR
;

9601 
Êags
 = &
ªq
->flags;

9602 
mac_addr
 = 
ªq
->mac_addr;

9603 
mac_addr_mask
 = 
ªq
->mac_addr_mask;

9606 *
Êags
 = 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_SCAN_FLAGS
]);

9608 i‡(((*
Êags
 & 
NL80211_SCAN_FLAG_LOW_PRIORITY
) &&

9609 !(
wùhy
->
„©uªs
 & 
NL80211_FEATURE_LOW_PRIORITY_SCAN
)) ||

9610 !
	`∆80211_check_sˇn_„©
(
wùhy
, *
Êags
,

9611 
NL80211_SCAN_FLAG_LOW_SPAN
,

9612 
NL80211_EXT_FEATURE_LOW_SPAN_SCAN
) ||

9613 !
	`∆80211_check_sˇn_„©
(
wùhy
, *
Êags
,

9614 
NL80211_SCAN_FLAG_LOW_POWER
,

9615 
NL80211_EXT_FEATURE_LOW_POWER_SCAN
) ||

9616 !
	`∆80211_check_sˇn_„©
(
wùhy
, *
Êags
,

9617 
NL80211_SCAN_FLAG_HIGH_ACCURACY
,

9618 
NL80211_EXT_FEATURE_HIGH_ACCURACY_SCAN
) ||

9619 !
	`∆80211_check_sˇn_„©
(
wùhy
, *
Êags
,

9620 
NL80211_SCAN_FLAG_FILS_MAX_CHANNEL_TIME
,

9621 
NL80211_EXT_FEATURE_FILS_MAX_CHANNEL_TIME
) ||

9622 !
	`∆80211_check_sˇn_„©
(
wùhy
, *
Êags
,

9623 
NL80211_SCAN_FLAG_ACCEPT_BCAST_PROBE_RESP
,

9624 
NL80211_EXT_FEATURE_ACCEPT_BCAST_PROBE_RESP
) ||

9625 !
	`∆80211_check_sˇn_„©
(
wùhy
, *
Êags
,

9626 
NL80211_SCAN_FLAG_OCE_PROBE_REQ_DEFERRAL_SUPPRESSION
,

9627 
NL80211_EXT_FEATURE_OCE_PROBE_REQ_DEFERRAL_SUPPRESSION
) ||

9628 !
	`∆80211_check_sˇn_„©
(
wùhy
, *
Êags
,

9629 
NL80211_SCAN_FLAG_OCE_PROBE_REQ_HIGH_TX_RATE
,

9630 
NL80211_EXT_FEATURE_OCE_PROBE_REQ_HIGH_TX_RATE
) ||

9631 !
	`∆80211_check_sˇn_„©
(
wùhy
, *
Êags
,

9632 
NL80211_SCAN_FLAG_RANDOM_SN
,

9633 
NL80211_EXT_FEATURE_SCAN_RANDOM_SN
) ||

9634 !
	`∆80211_check_sˇn_„©
(
wùhy
, *
Êags
,

9635 
NL80211_SCAN_FLAG_MIN_PREQ_CONTENT
,

9636 
NL80211_EXT_FEATURE_SCAN_MIN_PREQ_CONTENT
))

9637  -
EOPNOTSUPP
;

9639 i‡(*
Êags
 & 
NL80211_SCAN_FLAG_RANDOM_ADDR
) {

9640 
îr
;

9642 i‡(!(
wùhy
->
„©uªs
 & 
øndom√ss_Êag
) ||

9643 (
wdev
 && wdev->
c⁄√˘ed
))

9644  -
EOPNOTSUPP
;

9646 
îr
 = 
	`∆80211_∑r£_øndom_mac
(
©ås
, 
mac_addr
, 
mac_addr_mask
);

9647 i‡(
îr
)

9648  
îr
;

9652 
	}
}

9654 
	$∆80211_åiggî_sˇn
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

9656 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

9657 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

9658 
cfg80211_sˇn_ªque°
 *
ªque°
;

9659 
∆©å
 *
sˇn_‰eqs
 = 
NULL
;

9660 
boﬁ
 
sˇn_‰eqs_khz
 = 
Ál£
;

9661 
∆©å
 *
©å
;

9662 
wùhy
 *wiphy;

9663 
îr
, 
tmp
, 
n_ssids
 = 0, 
n_ch™√ls
, 
i
;

9664 
size_t
 
õ_Àn
, 
size
;

9666 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_TRIGGER_SCAN] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9668 
wùhy
 = &
rdev
->wiphy;

9670 i‡(
wdev
->
i·y≥
 =
NL80211_IFTYPE_NAN
) {

9671 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9672  -
EOPNOTSUPP
;

9675 i‡(!
rdev
->
›s
->
sˇn
) {

9676 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9677  -
EOPNOTSUPP
;

9680 i‡(
rdev
->
sˇn_ªq
 ||Ñdev->
sˇn_msg
) {

9681 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9682  -
EBUSY
;

9685 i‡(
öfo
->
©ås
[
NL80211_ATTR_SCAN_FREQ_KHZ
]) {

9686 i‡(!
	`wùhy_ext_„©uª_is£t
(
wùhy
,

9687 
NL80211_EXT_FEATURE_SCAN_FREQ_KHZ
)) {

9688 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9689  -
EOPNOTSUPP
;

9691 
sˇn_‰eqs
 = 
öfo
->
©ås
[
NL80211_ATTR_SCAN_FREQ_KHZ
];

9692 
sˇn_‰eqs_khz
 = 
åue
;

9693 } i‡(
öfo
->
©ås
[
NL80211_ATTR_SCAN_FREQUENCIES
])

9694 
sˇn_‰eqs
 = 
öfo
->
©ås
[
NL80211_ATTR_SCAN_FREQUENCIES
];

9696 i‡(
sˇn_‰eqs
) {

9697 
n_ch™√ls
 = 
	`vÆid©e_sˇn_‰eqs
(
sˇn_‰eqs
);

9698 i‡(!
n_ch™√ls
) {

9699 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9700  -
EINVAL
;

9703 
n_ch™√ls
 = 
	`õì80211_gë_num_suµ‹ãd_ch™√ls
(
wùhy
);

9706 i‡(
öfo
->
©ås
[
NL80211_ATTR_SCAN_SSIDS
])

9707 
	`∆a_f‹_óch_√°ed
(
©å
, 
öfo
->
©ås
[
NL80211_ATTR_SCAN_SSIDS
], 
tmp
)

9708 
n_ssids
++;

9710 i‡(
n_ssids
 > 
wùhy
->
max_sˇn_ssids
) {

9711 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9712  -
EINVAL
;

9715 i‡(
öfo
->
©ås
[
NL80211_ATTR_IE
])

9716 
õ_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

9718 
õ_Àn
 = 0;

9720 i‡(
õ_Àn
 > 
wùhy
->
max_sˇn_õ_Àn
) {

9721 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9722  -
EINVAL
;

9725 
size
 = 
	`°ru˘_size
(
ªque°
, 
ch™√ls
, 
n_ch™√ls
);

9726 
size
 = 
	`size_add
(size, 
	`¨øy_size
((*
ªque°
->
ssids
), 
n_ssids
));

9727 
size
 = 
	`size_add
(size, 
õ_Àn
);

9728 
ªque°
 = 
	`kzÆloc
(
size
, 
GFP_KERNEL
);

9729 i‡(!
ªque°
) {

9730 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9731  -
ENOMEM
;

9734 i‡(
n_ssids
)

9735 
ªque°
->
ssids
 = (*)&ªque°->
ch™√ls
[
n_ch™√ls
];

9736 
ªque°
->
n_ssids
 =Ç_ssids;

9737 i‡(
õ_Àn
) {

9738 i‡(
n_ssids
)

9739 
ªque°
->
õ
 = (*)‘eque°->
ssids
 + 
n_ssids
);

9741 
ªque°
->
õ
 = (*)‘eque°->
ch™√ls
 + 
n_ch™√ls
);

9744 
i
 = 0;

9745 i‡(
sˇn_‰eqs
) {

9747 
	`∆a_f‹_óch_√°ed
(
©å
, 
sˇn_‰eqs
, 
tmp
) {

9748 
õì80211_ch™√l
 *
ch™
;

9749 
‰eq
 = 
	`∆a_gë_u32
(
©å
);

9751 i‡(!
sˇn_‰eqs_khz
)

9752 
‰eq
 = 
	`MHZ_TO_KHZ
(freq);

9754 
ch™
 = 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
‰eq
);

9755 i‡(!
ch™
) {

9756 
îr
 = -
EINVAL
;

9757 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9758 
out_‰ì
;

9762 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

9765 
ªque°
->
ch™√ls
[
i
] = 
ch™
;

9766 
i
++;

9769 
∆80211_b™d
 
b™d
;

9772 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

9773 
j
;

9775 i‡(!
wùhy
->
b™ds
[
b™d
])

9777 
j
 = 0; j < 
wùhy
->
b™ds
[
b™d
]->
n_ch™√ls
; j++) {

9778 
õì80211_ch™√l
 *
ch™
;

9780 
ch™
 = &
wùhy
->
b™ds
[
b™d
]->
ch™√ls
[
j
];

9782 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

9785 
ªque°
->
ch™√ls
[
i
] = 
ch™
;

9786 
i
++;

9791 i‡(!
i
) {

9792 
îr
 = -
EINVAL
;

9793 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9794 
out_‰ì
;

9797 
ªque°
->
n_ch™√ls
 = 
i
;

9799 
i
 = 0; i < 
ªque°
->
n_ch™√ls
; i++) {

9800 
õì80211_ch™√l
 *
ch™
 = 
ªque°
->
ch™√ls
[
i
];

9803 i‡(
	`cfg80211_off_ch™√l_›î_Ælowed
(
wdev
, 
ch™
))

9806 i‡(!
	`cfg80211_wdev_⁄_sub_ch™
(
wdev
, 
ch™
, 
åue
)) {

9807 
îr
 = -
EBUSY
;

9808 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9809 
out_‰ì
;

9813 
i
 = 0;

9814 i‡(
n_ssids
) {

9815 
	`∆a_f‹_óch_√°ed
(
©å
, 
öfo
->
©ås
[
NL80211_ATTR_SCAN_SSIDS
], 
tmp
) {

9816 i‡(
	`∆a_Àn
(
©å
Ë> 
IEEE80211_MAX_SSID_LEN
) {

9817 
îr
 = -
EINVAL
;

9818 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9819 
out_‰ì
;

9821 
ªque°
->
ssids
[
i
].
ssid_Àn
 = 
	`∆a_Àn
(
©å
);

9822 
	`mem˝y
(
ªque°
->
ssids
[
i
].
ssid
, 
	`∆a_d©a
(
©å
), 
	`∆a_Àn
(attr));

9823 
i
++;

9827 i‡(
öfo
->
©ås
[
NL80211_ATTR_IE
]) {

9828 
ªque°
->
õ_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

9829 
	`mem˝y
((*)
ªque°
->
õ
,

9830 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IE
]),

9831 
ªque°
->
õ_Àn
);

9834 
i
 = 0; i < 
NUM_NL80211_BANDS
; i++)

9835 i‡(
wùhy
->
b™ds
[
i
])

9836 
ªque°
->
øãs
[
i
] =

9837 (1 << 
wùhy
->
b™ds
[
i
]->
n_bôøãs
) - 1;

9839 i‡(
öfo
->
©ås
[
NL80211_ATTR_SCAN_SUPP_RATES
]) {

9840 
	`∆a_f‹_óch_√°ed
(
©å
,

9841 
öfo
->
©ås
[
NL80211_ATTR_SCAN_SUPP_RATES
],

9842 
tmp
) {

9843 
∆80211_b™d
 
b™d
 = 
	`∆a_ty≥
(
©å
);

9845 i‡(
b™d
 < 0 || b™d >
NUM_NL80211_BANDS
) {

9846 
îr
 = -
EINVAL
;

9847 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9848 
out_‰ì
;

9851 i‡(!
wùhy
->
b™ds
[
b™d
])

9854 
îr
 = 
	`õì80211_gë_øãmask
(
wùhy
->
b™ds
[
b™d
],

9855 
	`∆a_d©a
(
©å
),

9856 
	`∆a_Àn
(
©å
),

9857 &
ªque°
->
øãs
[
b™d
]);

9858 i‡(
îr
) {

9859 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9860 
out_‰ì
;

9865 i‡(
öfo
->
©ås
[
NL80211_ATTR_MEASUREMENT_DURATION
]) {

9866 
ªque°
->
duøti⁄
 =

9867 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_MEASUREMENT_DURATION
]);

9868 
ªque°
->
duøti⁄_m™d©‹y
 =

9869 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_MEASUREMENT_DURATION_MANDATORY
]);

9872 
îr
 = 
	`∆80211_check_sˇn_Êags
(
wùhy
, 
wdev
, 
ªque°
, 
öfo
->
©ås
,

9873 
Ál£
);

9874 i‡(
îr
) {

9875 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9876 
out_‰ì
;

9879 
ªque°
->
no_cck
 =

9880 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_TX_NO_CCK_RATE
]);

9891 i‡(
öfo
->
©ås
[
NL80211_ATTR_BSSID
])

9892 
	`mem˝y
(
ªque°
->
bssid
,

9893 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_BSSID
]), 
ETH_ALEN
);

9894 i‡(!(
ªque°
->
Êags
 & 
NL80211_SCAN_FLAG_RANDOM_ADDR
) &&

9895 
öfo
->
©ås
[
NL80211_ATTR_MAC
])

9896 
	`mem˝y
(
ªque°
->
bssid
, 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]),

9897 
ETH_ALEN
);

9899 
	`ëh_brﬂdˇ°_addr
(
ªque°
->
bssid
);

9901 
ªque°
->
tsf_ªp‹t_lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

9902 
ªque°
->
wdev
 = wdev;

9903 
ªque°
->
wùhy
 = &
rdev
->wiphy;

9904 
ªque°
->
sˇn_°¨t
 = 
jiffõs
;

9906 
rdev
->
sˇn_ªq
 = 
ªque°
;

9907 
îr
 = 
	`cfg80211_sˇn
(
rdev
);

9909 i‡(
îr
) {

9910 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9911 
out_‰ì
;

9914 
	`∆80211_£nd_sˇn_°¨t
(
rdev
, 
wdev
);

9915 
	`dev_hﬁd
(
wdev
->
√tdev
);

9917 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_TRIGGER_SCAN] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

9920 
out_‰ì
:

9921 
rdev
->
sˇn_ªq
 = 
NULL
;

9922 
	`k‰ì
(
ªque°
);

9924 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9925  
îr
;

9926 
	}
}

9928 
	$∆80211_ab‹t_sˇn
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

9930 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

9931 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

9933 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

9935 i‡(!
rdev
->
›s
->
ab‹t_sˇn
) {

9936 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9937  -
EOPNOTSUPP
;

9940 i‡(
rdev
->
sˇn_msg
) {

9941 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9945 i‡(!
rdev
->
sˇn_ªq
) {

9946 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9947  -
ENOENT
;

9950 
	`rdev_ab‹t_sˇn
(
rdev
, 
wdev
);

9951 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

9953 
	}
}

9956 
	$∆80211_∑r£_sched_sˇn_∂™s
(
wùhy
 *wùhy, 
n_∂™s
,

9957 
cfg80211_sched_sˇn_ªque°
 *
ªque°
,

9958 
∆©å
 **
©ås
)

9960 
tmp
, 
îr
, 
i
 = 0;

9961 
∆©å
 *
©å
;

9963 i‡(!
©ås
[
NL80211_ATTR_SCHED_SCAN_PLANS
]) {

9964 
u32
 
öãrvÆ
;

9972 
öãrvÆ
 = 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_SCHED_SCAN_INTERVAL
]);

9973 i‡(!
öãrvÆ
)

9974  -
EINVAL
;

9976 
ªque°
->
sˇn_∂™s
[0].
öãrvÆ
 =

9977 
	`DIV_ROUND_UP
(
öãrvÆ
, 
MSEC_PER_SEC
);

9978 i‡(!
ªque°
->
sˇn_∂™s
[0].
öãrvÆ
)

9979  -
EINVAL
;

9981 i‡(
ªque°
->
sˇn_∂™s
[0].
öãrvÆ
 >

9982 
wùhy
->
max_sched_sˇn_∂™_öãrvÆ
)

9983 
ªque°
->
sˇn_∂™s
[0].
öãrvÆ
 =

9984 
wùhy
->
max_sched_sˇn_∂™_öãrvÆ
;

9989 
	`∆a_f‹_óch_√°ed
(
©å
, 
©ås
[
NL80211_ATTR_SCHED_SCAN_PLANS
], 
tmp
) {

9990 
∆©å
 *
∂™
[
NL80211_SCHED_SCAN_PLAN_MAX
 + 1];

9992 i‡(
	`WARN_ON
(
i
 >
n_∂™s
))

9993  -
EINVAL
;

9995 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
∂™
,

9996 
NL80211_SCHED_SCAN_PLAN_MAX
,

9997 
©å
, 
∆80211_∂™_pﬁicy
,

9998 
NULL
);

9999 i‡(
îr
)

10000  
îr
;

10002 i‡(!
∂™
[
NL80211_SCHED_SCAN_PLAN_INTERVAL
])

10003  -
EINVAL
;

10005 
ªque°
->
sˇn_∂™s
[
i
].
öãrvÆ
 =

10006 
	`∆a_gë_u32
(
∂™
[
NL80211_SCHED_SCAN_PLAN_INTERVAL
]);

10007 i‡(!
ªque°
->
sˇn_∂™s
[
i
].
öãrvÆ
 ||

10008 
ªque°
->
sˇn_∂™s
[
i
].
öãrvÆ
 >

10009 
wùhy
->
max_sched_sˇn_∂™_öãrvÆ
)

10010  -
EINVAL
;

10012 i‡(
∂™
[
NL80211_SCHED_SCAN_PLAN_ITERATIONS
]) {

10013 
ªque°
->
sˇn_∂™s
[
i
].
ôî©i⁄s
 =

10014 
	`∆a_gë_u32
(
∂™
[
NL80211_SCHED_SCAN_PLAN_ITERATIONS
]);

10015 i‡(!
ªque°
->
sˇn_∂™s
[
i
].
ôî©i⁄s
 ||

10016 (
ªque°
->
sˇn_∂™s
[
i
].
ôî©i⁄s
 >

10017 
wùhy
->
max_sched_sˇn_∂™_ôî©i⁄s
))

10018  -
EINVAL
;

10019 } i‡(
i
 < 
n_∂™s
 - 1) {

10024  -
EINVAL
;

10027 
i
++;

10034 i‡(
ªque°
->
sˇn_∂™s
[
n_∂™s
 - 1].
ôî©i⁄s
)

10035  -
EINVAL
;

10038 
	}
}

10040 
cfg80211_sched_sˇn_ªque°
 *

10041 
	$∆80211_∑r£_sched_sˇn
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

10042 
∆©å
 **
©ås
, 
max_m©ch_£ts
)

10044 
cfg80211_sched_sˇn_ªque°
 *
ªque°
;

10045 
∆©å
 *
©å
;

10046 
îr
, 
tmp
, 
n_ssids
 = 0, 
n_m©ch_£ts
 = 0, 
n_ch™√ls
, 
i
, 
n_∂™s
 = 0;

10047 
∆80211_b™d
 
b™d
;

10048 
size_t
 
õ_Àn
, 
size
;

10049 
∆©å
 *
tb
[
NL80211_SCHED_SCAN_MATCH_ATTR_MAX
 + 1];

10050 
s32
 
deÁu…_m©ch_rssi
 = 
NL80211_SCAN_RSSI_THOLD_OFF
;

10052 i‡(
©ås
[
NL80211_ATTR_SCAN_FREQUENCIES
]) {

10053 
n_ch™√ls
 = 
	`vÆid©e_sˇn_‰eqs
(

10054 
©ås
[
NL80211_ATTR_SCAN_FREQUENCIES
]);

10055 i‡(!
n_ch™√ls
)

10056  
	`ERR_PTR
(-
EINVAL
);

10058 
n_ch™√ls
 = 
	`õì80211_gë_num_suµ‹ãd_ch™√ls
(
wùhy
);

10061 i‡(
©ås
[
NL80211_ATTR_SCAN_SSIDS
])

10062 
	`∆a_f‹_óch_√°ed
(
©å
, 
©ås
[
NL80211_ATTR_SCAN_SSIDS
],

10063 
tmp
)

10064 
n_ssids
++;

10066 i‡(
n_ssids
 > 
wùhy
->
max_sched_sˇn_ssids
)

10067  
	`ERR_PTR
(-
EINVAL
);

10078 i‡(
©ås
[
NL80211_ATTR_SCHED_SCAN_MATCH
]) {

10079 
	`∆a_f‹_óch_√°ed
(
©å
,

10080 
©ås
[
NL80211_ATTR_SCHED_SCAN_MATCH
],

10081 
tmp
) {

10082 
∆©å
 *
rssi
;

10084 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
,

10085 
NL80211_SCHED_SCAN_MATCH_ATTR_MAX
,

10086 
©å
,

10087 
∆80211_m©ch_pﬁicy
,

10088 
NULL
);

10089 i‡(
îr
)

10090  
	`ERR_PTR
(
îr
);

10093 i‡(
tb
[
NL80211_SCHED_SCAN_MATCH_ATTR_SSID
] &&

10094 
tb
[
NL80211_SCHED_SCAN_MATCH_ATTR_BSSID
])

10095  
	`ERR_PTR
(-
EINVAL
);

10098 i‡(
tb
[
NL80211_SCHED_SCAN_MATCH_ATTR_SSID
] ||

10099 
tb
[
NL80211_SCHED_SCAN_MATCH_ATTR_BSSID
]) {

10100 
n_m©ch_£ts
++;

10103 
rssi
 = 
tb
[
NL80211_SCHED_SCAN_MATCH_ATTR_RSSI
];

10104 i‡(
rssi
)

10105 
deÁu…_m©ch_rssi
 = 
	`∆a_gë_s32
(
rssi
);

10110 i‡(!
n_m©ch_£ts
 && 
deÁu…_m©ch_rssi
 !
NL80211_SCAN_RSSI_THOLD_OFF
)

10111 
n_m©ch_£ts
 = 1;

10113 i‡(
n_m©ch_£ts
 > 
max_m©ch_£ts
)

10114  
	`ERR_PTR
(-
EINVAL
);

10116 i‡(
©ås
[
NL80211_ATTR_IE
])

10117 
õ_Àn
 = 
	`∆a_Àn
(
©ås
[
NL80211_ATTR_IE
]);

10119 
õ_Àn
 = 0;

10121 i‡(
õ_Àn
 > 
wùhy
->
max_sched_sˇn_õ_Àn
)

10122  
	`ERR_PTR
(-
EINVAL
);

10124 i‡(
©ås
[
NL80211_ATTR_SCHED_SCAN_PLANS
]) {

10129 i‡(
©ås
[
NL80211_ATTR_SCHED_SCAN_INTERVAL
])

10130  
	`ERR_PTR
(-
EINVAL
);

10132 
	`∆a_f‹_óch_√°ed
(
©å
,

10133 
©ås
[
NL80211_ATTR_SCHED_SCAN_PLANS
], 
tmp
)

10134 
n_∂™s
++;

10142 i‡(!
©ås
[
NL80211_ATTR_SCHED_SCAN_INTERVAL
])

10143  
	`ERR_PTR
(-
EINVAL
);

10145 
n_∂™s
 = 1;

10148 i‡(!
n_∂™s
 ||Ç_∂™†> 
wùhy
->
max_sched_sˇn_∂™s
)

10149  
	`ERR_PTR
(-
EINVAL
);

10151 i‡(!
	`wùhy_ext_„©uª_is£t
(

10152 
wùhy
, 
NL80211_EXT_FEATURE_SCHED_SCAN_RELATIVE_RSSI
) &&

10153 (
©ås
[
NL80211_ATTR_SCHED_SCAN_RELATIVE_RSSI
] ||

10154 
©ås
[
NL80211_ATTR_SCHED_SCAN_RSSI_ADJUST
]))

10155  
	`ERR_PTR
(-
EINVAL
);

10157 
size
 = 
	`°ru˘_size
(
ªque°
, 
ch™√ls
, 
n_ch™√ls
);

10158 
size
 = 
	`size_add
(size, 
	`¨øy_size
((*
ªque°
->
ssids
), 
n_ssids
));

10159 
size
 = 
	`size_add
(size, 
	`¨øy_size
((*
ªque°
->
m©ch_£ts
),

10160 
n_m©ch_£ts
));

10161 
size
 = 
	`size_add
(size, 
	`¨øy_size
((*
ªque°
->
sˇn_∂™s
),

10162 
n_∂™s
));

10163 
size
 = 
	`size_add
(size, 
õ_Àn
);

10164 
ªque°
 = 
	`kzÆloc
(
size
, 
GFP_KERNEL
);

10165 i‡(!
ªque°
)

10166  
	`ERR_PTR
(-
ENOMEM
);

10168 i‡(
n_ssids
)

10169 
ªque°
->
ssids
 = (*)&ªque°->
ch™√ls
[
n_ch™√ls
];

10170 
ªque°
->
n_ssids
 =Ç_ssids;

10171 i‡(
õ_Àn
) {

10172 i‡(
n_ssids
)

10173 
ªque°
->
õ
 = (*)‘eque°->
ssids
 + 
n_ssids
);

10175 
ªque°
->
õ
 = (*)‘eque°->
ch™√ls
 + 
n_ch™√ls
);

10178 i‡(
n_m©ch_£ts
) {

10179 i‡(
ªque°
->
õ
)

10180 
ªque°
->
m©ch_£ts
 = (*)‘eque°->
õ
 + 
õ_Àn
);

10181 i‡(
n_ssids
)

10182 
ªque°
->
m©ch_£ts
 =

10183 (*)(
ªque°
->
ssids
 + 
n_ssids
);

10185 
ªque°
->
m©ch_£ts
 =

10186 (*)(
ªque°
->
ch™√ls
 + 
n_ch™√ls
);

10188 
ªque°
->
n_m©ch_£ts
 =Ç_match_sets;

10190 i‡(
n_m©ch_£ts
)

10191 
ªque°
->
sˇn_∂™s
 = (*)‘eque°->
m©ch_£ts
 +

10192 
n_m©ch_£ts
);

10193 i‡(
ªque°
->
õ
)

10194 
ªque°
->
sˇn_∂™s
 = (*)‘eque°->
õ
 + 
õ_Àn
);

10195 i‡(
n_ssids
)

10196 
ªque°
->
sˇn_∂™s
 = (*)‘eque°->
ssids
 + 
n_ssids
);

10198 
ªque°
->
sˇn_∂™s
 = (*)‘eque°->
ch™√ls
 + 
n_ch™√ls
);

10200 
ªque°
->
n_sˇn_∂™s
 = 
n_∂™s
;

10202 
i
 = 0;

10203 i‡(
©ås
[
NL80211_ATTR_SCAN_FREQUENCIES
]) {

10205 
	`∆a_f‹_óch_√°ed
(
©å
,

10206 
©ås
[
NL80211_ATTR_SCAN_FREQUENCIES
],

10207 
tmp
) {

10208 
õì80211_ch™√l
 *
ch™
;

10210 
ch™
 = 
	`õì80211_gë_ch™√l
(
wùhy
, 
	`∆a_gë_u32
(
©å
));

10212 i‡(!
ch™
) {

10213 
îr
 = -
EINVAL
;

10214 
out_‰ì
;

10218 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

10221 
ªque°
->
ch™√ls
[
i
] = 
ch™
;

10222 
i
++;

10226 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

10227 
j
;

10229 i‡(!
wùhy
->
b™ds
[
b™d
])

10231 
j
 = 0; j < 
wùhy
->
b™ds
[
b™d
]->
n_ch™√ls
; j++) {

10232 
õì80211_ch™√l
 *
ch™
;

10234 
ch™
 = &
wùhy
->
b™ds
[
b™d
]->
ch™√ls
[
j
];

10236 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

10239 
ªque°
->
ch™√ls
[
i
] = 
ch™
;

10240 
i
++;

10245 i‡(!
i
) {

10246 
îr
 = -
EINVAL
;

10247 
out_‰ì
;

10250 
ªque°
->
n_ch™√ls
 = 
i
;

10252 
i
 = 0;

10253 i‡(
n_ssids
) {

10254 
	`∆a_f‹_óch_√°ed
(
©å
, 
©ås
[
NL80211_ATTR_SCAN_SSIDS
],

10255 
tmp
) {

10256 i‡(
	`∆a_Àn
(
©å
Ë> 
IEEE80211_MAX_SSID_LEN
) {

10257 
îr
 = -
EINVAL
;

10258 
out_‰ì
;

10260 
ªque°
->
ssids
[
i
].
ssid_Àn
 = 
	`∆a_Àn
(
©å
);

10261 
	`mem˝y
(
ªque°
->
ssids
[
i
].
ssid
, 
	`∆a_d©a
(
©å
),

10262 
	`∆a_Àn
(
©å
));

10263 
i
++;

10267 
i
 = 0;

10268 i‡(
©ås
[
NL80211_ATTR_SCHED_SCAN_MATCH
]) {

10269 
	`∆a_f‹_óch_√°ed
(
©å
,

10270 
©ås
[
NL80211_ATTR_SCHED_SCAN_MATCH
],

10271 
tmp
) {

10272 
∆©å
 *
ssid
, *
bssid
, *
rssi
;

10274 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
,

10275 
NL80211_SCHED_SCAN_MATCH_ATTR_MAX
,

10276 
©å
,

10277 
∆80211_m©ch_pﬁicy
,

10278 
NULL
);

10279 i‡(
îr
)

10280 
out_‰ì
;

10281 
ssid
 = 
tb
[
NL80211_SCHED_SCAN_MATCH_ATTR_SSID
];

10282 
bssid
 = 
tb
[
NL80211_SCHED_SCAN_MATCH_ATTR_BSSID
];

10284 i‡(!
ssid
 && !
bssid
) {

10285 
i
++;

10289 i‡(
	`WARN_ON
(
i
 >
n_m©ch_£ts
)) {

10294 
îr
 = -
EINVAL
;

10295 
out_‰ì
;

10298 i‡(
ssid
) {

10299 
	`mem˝y
(
ªque°
->
m©ch_£ts
[
i
].
ssid
.ssid,

10300 
	`∆a_d©a
(
ssid
), 
	`∆a_Àn
(ssid));

10301 
ªque°
->
m©ch_£ts
[
i
].
ssid
.
ssid_Àn
 =

10302 
	`∆a_Àn
(
ssid
);

10304 i‡(
bssid
)

10305 
	`mem˝y
(
ªque°
->
m©ch_£ts
[
i
].
bssid
,

10306 
	`∆a_d©a
(
bssid
), 
ETH_ALEN
);

10309 
ªque°
->
m©ch_£ts
[
i
].
rssi_thﬁd
 = 
deÁu…_m©ch_rssi
;

10310 
rssi
 = 
tb
[
NL80211_SCHED_SCAN_MATCH_ATTR_RSSI
];

10311 i‡(
rssi
)

10312 
ªque°
->
m©ch_£ts
[
i
].
rssi_thﬁd
 =

10313 
	`∆a_gë_s32
(
rssi
);

10314 
i
++;

10318 i‡(
i
 =0 && 
n_m©ch_£ts
)

10319 
ªque°
->
m©ch_£ts
[0].
rssi_thﬁd
 = 
deÁu…_m©ch_rssi
;

10321 
ªque°
->
mö_rssi_thﬁd
 = 
INT_MAX
;

10322 
i
 = 0; i < 
n_m©ch_£ts
; i++)

10323 
ªque°
->
mö_rssi_thﬁd
 =

10324 
	`mö
(
ªque°
->
m©ch_£ts
[
i
].
rssi_thﬁd
,

10325 
ªque°
->
mö_rssi_thﬁd
);

10327 
ªque°
->
mö_rssi_thﬁd
 = 
NL80211_SCAN_RSSI_THOLD_OFF
;

10330 i‡(
õ_Àn
) {

10331 
ªque°
->
õ_Àn
 = ie_len;

10332 
	`mem˝y
((*)
ªque°
->
õ
,

10333 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_IE
]),

10334 
ªque°
->
õ_Àn
);

10337 
îr
 = 
	`∆80211_check_sˇn_Êags
(
wùhy
, 
wdev
, 
ªque°
, 
©ås
, 
åue
);

10338 i‡(
îr
)

10339 
out_‰ì
;

10341 i‡(
©ås
[
NL80211_ATTR_SCHED_SCAN_DELAY
])

10342 
ªque°
->
dñay
 =

10343 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_SCHED_SCAN_DELAY
]);

10345 i‡(
©ås
[
NL80211_ATTR_SCHED_SCAN_RELATIVE_RSSI
]) {

10346 
ªque°
->
ªœtive_rssi
 = 
	`∆a_gë_s8
(

10347 
©ås
[
NL80211_ATTR_SCHED_SCAN_RELATIVE_RSSI
]);

10348 
ªque°
->
ªœtive_rssi_£t
 = 
åue
;

10351 i‡(
ªque°
->
ªœtive_rssi_£t
 &&

10352 
©ås
[
NL80211_ATTR_SCHED_SCAN_RSSI_ADJUST
]) {

10353 
∆80211_bss_£À˘_rssi_adju°
 *
rssi_adju°
;

10355 
rssi_adju°
 = 
	`∆a_d©a
(

10356 
©ås
[
NL80211_ATTR_SCHED_SCAN_RSSI_ADJUST
]);

10357 
ªque°
->
rssi_adju°
.
b™d
 =Ñssi_adjust->band;

10358 
ªque°
->
rssi_adju°
.
dñè
 =Ñssi_adjust->delta;

10359 i‡(!
	`is_b™d_vÆid
(
wùhy
, 
ªque°
->
rssi_adju°
.
b™d
)) {

10360 
îr
 = -
EINVAL
;

10361 
out_‰ì
;

10365 
îr
 = 
	`∆80211_∑r£_sched_sˇn_∂™s
(
wùhy
, 
n_∂™s
, 
ªque°
, 
©ås
);

10366 i‡(
îr
)

10367 
out_‰ì
;

10369 
ªque°
->
sˇn_°¨t
 = 
jiffõs
;

10371  
ªque°
;

10373 
out_‰ì
:

10374 
	`k‰ì
(
ªque°
);

10375  
	`ERR_PTR
(
îr
);

10376 
	}
}

10378 
	$∆80211_°¨t_sched_sˇn
(
sk_buff
 *
skb
,

10379 
gíl_öfo
 *
öfo
)

10381 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

10382 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

10383 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

10384 
cfg80211_sched_sˇn_ªque°
 *
sched_sˇn_ªq
;

10385 
boﬁ
 
w™t_mu…i
;

10386 
îr
;

10388 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

10390 i‡(!
rdev
->
wùhy
.
max_sched_sˇn_ªqs
 || !rdev->
›s
->
sched_sˇn_°¨t
) {

10391 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10392  -
EOPNOTSUPP
;

10395 
w™t_mu…i
 = 
öfo
->
©ås
[
NL80211_ATTR_SCHED_SCAN_MULTI
];

10396 
îr
 = 
	`cfg80211_sched_sˇn_ªq_possibÀ
(
rdev
, 
w™t_mu…i
);

10397 i‡(
îr
) {

10398 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10399  
îr
;

10402 
sched_sˇn_ªq
 = 
	`∆80211_∑r£_sched_sˇn
(&
rdev
->
wùhy
, 
wdev
,

10403 
öfo
->
©ås
,

10404 
rdev
->
wùhy
.
max_m©ch_£ts
);

10406 
îr
 = 
	`PTR_ERR_OR_ZERO
(
sched_sˇn_ªq
);

10407 i‡(
îr
) {

10408 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10409 
out_îr
;

10415 i‡(
w™t_mu…i
 && 
rdev
->
wùhy
.
max_sched_sˇn_ªqs
 > 1)

10416 
sched_sˇn_ªq
->
ªqid
 = 
	`cfg80211_assign_cookõ
(
rdev
);

10418 
îr
 = 
	`rdev_sched_sˇn_°¨t
(
rdev
, 
dev
, 
sched_sˇn_ªq
);

10419 i‡(
îr
) {

10420 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10421 
out_‰ì
;

10424 
sched_sˇn_ªq
->
dev
 = dev;

10425 
sched_sˇn_ªq
->
wùhy
 = &
rdev
->wiphy;

10427 i‡(
öfo
->
©ås
[
NL80211_ATTR_SOCKET_OWNER
])

10428 
sched_sˇn_ªq
->
ow√r_∆p‹tid
 = 
öfo
->
¢d_p‹tid
;

10430 
	`cfg80211_add_sched_sˇn_ªq
(
rdev
, 
sched_sˇn_ªq
);

10432 
	`∆80211_£nd_sched_sˇn
(
sched_sˇn_ªq
, 
NL80211_CMD_START_SCHED_SCAN
);

10433 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10436 
out_‰ì
:

10437 
	`k‰ì
(
sched_sˇn_ªq
);

10438 
out_îr
:

10439 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10440  
îr
;

10441 
	}
}

10443 
	$∆80211_°›_sched_sˇn
(
sk_buff
 *
skb
,

10444 
gíl_öfo
 *
öfo
)

10446 
cfg80211_sched_sˇn_ªque°
 *
ªq
;

10447 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

10448 
u64
 
cookõ
;

10450 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

10452 i‡(!
rdev
->
wùhy
.
max_sched_sˇn_ªqs
 || !rdev->
›s
->
sched_sˇn_°›
) {

10453 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10454  -
EOPNOTSUPP
;

10457 i‡(
öfo
->
©ås
[
NL80211_ATTR_COOKIE
]) {

10458 
cookõ
 = 
	`∆a_gë_u64
(
öfo
->
©ås
[
NL80211_ATTR_COOKIE
]);

10459 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10460  
	`__cfg80211_°›_sched_sˇn
(
rdev
, 
cookõ
, 
Ál£
);

10463 
ªq
 = 
	`li°_fú°_‹_nuŒ_rcu
(&
rdev
->
sched_sˇn_ªq_li°
,

10464 
cfg80211_sched_sˇn_ªque°
,

10465 
li°
);

10466 i‡(!
ªq
 ||Ñeq->
ªqid
 ||

10467 (
ªq
->
ow√r_∆p‹tid
 &&

10468 
ªq
->
ow√r_∆p‹tid
 !
öfo
->
¢d_p‹tid
)) {

10469 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10470  -
ENOENT
;

10473 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10474  
	`cfg80211_°›_sched_sˇn_ªq
(
rdev
, 
ªq
, 
Ál£
);

10475 
	}
}

10477 
	$∆80211_°¨t_ød¨_dëe˘i⁄
(
sk_buff
 *
skb
,

10478 
gíl_öfo
 *
öfo
)

10480 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

10481 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

10482 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

10483 
wùhy
 *wùhy = 
wdev
->wiphy;

10484 
cfg80211_ch™_def
 
ch™def
;

10485 
∆80211_dfs_ªgi⁄s
 
dfs_ªgi⁄
;

10486 
ˇc_time_ms
;

10487 
îr
 = -
EINVAL
;

10489 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

10491 
	`Êush_dñayed_w‹k
(&
rdev
->
dfs_upd©e_ch™√ls_wk
);

10493 
	`wùhy_lock
(
wùhy
);

10495 
dfs_ªgi⁄
 = 
	`ªg_gë_dfs_ªgi⁄
(
wùhy
);

10496 i‡(
dfs_ªgi⁄
 =
NL80211_DFS_UNSET
) {

10497 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10498 
u∆ock
;

10501 
îr
 = 
	`∆80211_∑r£_ch™def
(
rdev
, 
öfo
, &
ch™def
);

10502 i‡(
îr
) {

10503 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10504 
u∆ock
;

10507 
îr
 = 
	`cfg80211_ch™def_dfs_ªquúed
(
wùhy
, &
ch™def
, 
wdev
->
i·y≥
);

10508 i‡(
îr
 < 0) {

10509 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10510 
u∆ock
;

10513 i‡(
îr
 == 0) {

10514 
îr
 = -
EINVAL
;

10515 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10516 
u∆ock
;

10519 i‡(!
	`cfg80211_ch™def_dfs_ußbÀ
(
wùhy
, &
ch™def
)) {

10520 
îr
 = -
EINVAL
;

10521 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10522 
u∆ock
;

10525 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_RADAR_BACKGROUND
])) {

10526 
îr
 = 
	`cfg80211_°¨t_background_ød¨_dëe˘i⁄
(
rdev
, 
wdev
,

10527 &
ch™def
);

10528 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10529 
u∆ock
;

10532 i‡(
	`√tif_ˇºõr_ok
(
dev
)) {

10533 
îr
 = -
EBUSY
;

10534 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10535 
u∆ock
;

10538 i‡(
wdev
->
ˇc_°¨ãd
) {

10539 
îr
 = -
EBUSY
;

10540 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10541 
u∆ock
;

10545 i‡(
	`wùhy_ext_„©uª_is£t
(
wùhy
, 
NL80211_EXT_FEATURE_DFS_OFFLOAD
)) {

10546 
îr
 = -
EOPNOTSUPP
;

10547 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10548 
u∆ock
;

10551 i‡(!
rdev
->
›s
->
°¨t_ød¨_dëe˘i⁄
) {

10552 
îr
 = -
EOPNOTSUPP
;

10553 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10554 
u∆ock
;

10557 
ˇc_time_ms
 = 
	`cfg80211_ch™def_dfs_ˇc_time
(&
rdev
->
wùhy
, &
ch™def
);

10558 i‡(
	`WARN_ON
(!
ˇc_time_ms
))

10559 
ˇc_time_ms
 = 
IEEE80211_DFS_MIN_CAC_TIME_MS
;

10561 
îr
 = 
	`rdev_°¨t_ød¨_dëe˘i⁄
(
rdev
, 
dev
, &
ch™def
, 
ˇc_time_ms
);

10562 i‡(!
îr
) {

10563 
wdev
->
löks
[0].
≠
.
ch™def
 = chandef;

10564 
wdev
->
ˇc_°¨ãd
 = 
åue
;

10565 
wdev
->
ˇc_°¨t_time
 = 
jiffõs
;

10566 
wdev
->
ˇc_time_ms
 = cac_time_ms;

10568 
u∆ock
:

10569 
	`wùhy_u∆ock
(
wùhy
);

10571 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10572  
îr
;

10573 
	}
}

10575 
	$∆80211_nŸify_ød¨_dëe˘i⁄
(
sk_buff
 *
skb
,

10576 
gíl_öfo
 *
öfo
)

10578 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

10579 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

10580 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

10581 
wùhy
 *wùhy = 
wdev
->wiphy;

10582 
cfg80211_ch™_def
 
ch™def
;

10583 
∆80211_dfs_ªgi⁄s
 
dfs_ªgi⁄
;

10584 
îr
;

10586 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

10588 
dfs_ªgi⁄
 = 
	`ªg_gë_dfs_ªgi⁄
(
wùhy
);

10589 i‡(
dfs_ªgi⁄
 =
NL80211_DFS_UNSET
) {

10590 
	`GENL_SET_ERR_MSG
(
öfo
,

10592 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10593  -
EINVAL
;

10596 
îr
 = 
	`∆80211_∑r£_ch™def
(
rdev
, 
öfo
, &
ch™def
);

10597 i‡(
îr
) {

10598 
	`GENL_SET_ERR_MSG
(
öfo
, "UnableÅoÉxtract chandef info");

10599 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10600  
îr
;

10603 
îr
 = 
	`cfg80211_ch™def_dfs_ªquúed
(
wùhy
, &
ch™def
, 
wdev
->
i·y≥
);

10604 i‡(
îr
 < 0) {

10605 
	`GENL_SET_ERR_MSG
(
öfo
, "chandef is invalid");

10606 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10607  
îr
;

10610 i‡(
îr
 == 0) {

10611 
	`GENL_SET_ERR_MSG
(
öfo
,

10613 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10614  -
EINVAL
;

10620 i‡(
ch™def
.
ch™
->
dfs_°©e
 =
NL80211_DFS_UNAVAILABLE
) {

10621 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10625 
	`cfg80211_£t_dfs_°©e
(
wùhy
, &
ch™def
, 
NL80211_DFS_UNAVAILABLE
);

10627 
	`cfg80211_sched_dfs_ch™_upd©e
(
rdev
);

10629 
rdev
->
ød¨_ch™def
 = 
ch™def
;

10632 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
¥›ag©e_ød¨_dëe˘_wk
);

10634 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10636 
	}
}

10638 
	$∆80211_∑r£_cou¡î_off£ts
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

10639 c⁄° 
u8
 *
d©a
, 
size_t
 
d©Æí
,

10640 
fú°_cou¡
, 
∆©å
 *
©å
,

10641 c⁄° 
u16
 **
off£ts
, *
n_off£ts
)

10643 
i
;

10645 *
n_off£ts
 = 0;

10647 i‡(!
©å
)

10650 i‡(!
	`∆a_Àn
(
©å
Ë|| (∆a_Àn◊ârË% (
u16
)))

10651  -
EINVAL
;

10653 *
n_off£ts
 = 
	`∆a_Àn
(
©å
Ë/ (
u16
);

10654 i‡(
rdev
->
wùhy
.
max_num_cß_cou¡îs
 &&

10655 (*
n_off£ts
 > 
rdev
->
wùhy
.
max_num_cß_cou¡îs
))

10656  -
EINVAL
;

10658 *
off£ts
 = 
	`∆a_d©a
(
©å
);

10661 
i
 = 0; i < *
n_off£ts
; i++) {

10662 
u16
 
off£t
 = (*
off£ts
)[
i
];

10664 i‡(
off£t
 >
d©Æí
)

10665  -
EINVAL
;

10667 i‡(
fú°_cou¡
 !-1 && 
d©a
[
off£t
] != first_count)

10668  -
EINVAL
;

10672 
	}
}

10674 
	$∆80211_ch™√l_swôch
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

10676 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

10677 
lök_id
 = 
	`∆80211_lök_id
(
öfo
->
©ås
);

10678 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

10679 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

10680 
cfg80211_cß_£âögs
 
∑øms
;

10681 
∆©å
 **
cß_©ås
 = 
NULL
;

10682 
îr
;

10683 
boﬁ
 
√ed_√w_bóc⁄
 = 
Ál£
;

10684 
boﬁ
 
√ed_h™dÀ_dfs_Êag
 = 
åue
;

10685 
u32
 
cs_cou¡
;

10687 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

10689 i‡(!
rdev
->
›s
->
ch™√l_swôch
 ||

10690 !(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_HAS_CHANNEL_SWITCH
)) {

10691 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10692  -
EOPNOTSUPP
;

10695 
dev
->
õì80211_±r
->
i·y≥
) {

10696 
NL80211_IFTYPE_AP
:

10697 
NL80211_IFTYPE_P2P_GO
:

10698 
√ed_√w_bóc⁄
 = 
åue
;

10704 
√ed_h™dÀ_dfs_Êag
 = 
Ál£
;

10707 i‡(!
wdev
->
löks
[
lök_id
].
≠
.
bóc⁄_öãrvÆ
) {

10708 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10709  -
ENOTCONN
;

10711 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10713 
NL80211_IFTYPE_ADHOC
:

10714 i‡(!
wdev
->
u
.
ibss
.
ssid_Àn
) {

10715 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10716  -
ENOTCONN
;

10718 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10720 
NL80211_IFTYPE_MESH_POINT
:

10721 i‡(!
wdev
->
u
.
mesh
.
id_Àn
) {

10722 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10723  -
ENOTCONN
;

10725 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10728 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10729  -
EOPNOTSUPP
;

10732 
	`mem£t
(&
∑øms
, 0, (params));

10733 
∑øms
.
bóc⁄_cß
.
·m_ª•⁄dî
 = -1;

10735 i‡(!
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
] ||

10736 !
öfo
->
©ås
[
NL80211_ATTR_CH_SWITCH_COUNT
]) {

10737 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10738  -
EINVAL
;

10742 i‡(
√ed_√w_bóc⁄
 && !
öfo
->
©ås
[
NL80211_ATTR_CSA_IES
]) {

10743 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10744  -
EINVAL
;

10750 
cs_cou¡
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_CH_SWITCH_COUNT
]);

10751 i‡(
cs_cou¡
 > 255) {

10752 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10753  -
EINVAL
;

10756 
∑øms
.
cou¡
 = 
cs_cou¡
;

10758 i‡(!
√ed_√w_bóc⁄
) {

10759 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10760 
skù_bóc⁄s
;

10763 
îr
 = 
	`∆80211_∑r£_bóc⁄
(
rdev
, 
öfo
->
©ås
, &
∑øms
.
bóc⁄_a·î
,

10764 
öfo
->
exèck
);

10765 i‡(
îr
) {

10766 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10767 
‰ì
;

10770 
cß_©ås
 = 
	`kˇŒoc
(
NL80211_ATTR_MAX
 + 1, (*csa_attrs),

10771 
GFP_KERNEL
);

10772 i‡(!
cß_©ås
) {

10773 
îr
 = -
ENOMEM
;

10774 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10775 
‰ì
;

10778 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
cß_©ås
, 
NL80211_ATTR_MAX
,

10779 
öfo
->
©ås
[
NL80211_ATTR_CSA_IES
],

10780 
∆80211_pﬁicy
, 
öfo
->
exèck
);

10781 i‡(
îr
) {

10782 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10783 
‰ì
;

10786 
îr
 = 
	`∆80211_∑r£_bóc⁄
(
rdev
, 
cß_©ås
, &
∑øms
.
bóc⁄_cß
,

10787 
öfo
->
exèck
);

10788 i‡(
îr
) {

10789 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10790 
‰ì
;

10793 i‡(!
cß_©ås
[
NL80211_ATTR_CNTDWN_OFFS_BEACON
]) {

10794 
îr
 = -
EINVAL
;

10795 
‰ì
;

10798 
îr
 = 
	`∆80211_∑r£_cou¡î_off£ts
(
rdev
, 
∑øms
.
bóc⁄_cß
.
èû
,

10799 
∑øms
.
bóc⁄_cß
.
èû_Àn
,

10800 
∑øms
.
cou¡
,

10801 
cß_©ås
[
NL80211_ATTR_CNTDWN_OFFS_BEACON
],

10802 &
∑øms
.
cou¡î_off£ts_bóc⁄
,

10803 &
∑øms
.
n_cou¡î_off£ts_bóc⁄
);

10804 i‡(
îr
) {

10805 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10806 
‰ì
;

10809 
îr
 = 
	`∆80211_∑r£_cou¡î_off£ts
(
rdev
, 
∑øms
.
bóc⁄_cß
.
¥obe_ª•
,

10810 
∑øms
.
bóc⁄_cß
.
¥obe_ª•_Àn
,

10811 
∑øms
.
cou¡
,

10812 
cß_©ås
[
NL80211_ATTR_CNTDWN_OFFS_PRESP
],

10813 &
∑øms
.
cou¡î_off£ts_¥e•
,

10814 &
∑øms
.
n_cou¡î_off£ts_¥e•
);

10815 i‡(
îr
) {

10816 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10817 
‰ì
;

10820 
skù_bóc⁄s
:

10821 
îr
 = 
	`∆80211_∑r£_ch™def
(
rdev
, 
öfo
, &
∑øms
.
ch™def
);

10822 i‡(
îr
) {

10823 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10824 
‰ì
;

10827 i‡(!
	`cfg80211_ªg_ˇn_bóc⁄_ªœx
(&
rdev
->
wùhy
, &
∑øms
.
ch™def
,

10828 
wdev
->
i·y≥
)) {

10829 
îr
 = -
EINVAL
;

10830 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10831 
‰ì
;

10834 
îr
 = 
	`cfg80211_ch™def_dfs_ªquúed
(
wdev
->
wùhy
,

10835 &
∑øms
.
ch™def
,

10836 
wdev
->
i·y≥
);

10837 i‡(
îr
 < 0) {

10838 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10839 
‰ì
;

10842 i‡(
îr
 > 0) {

10843 
∑øms
.
ød¨_ªquúed
 = 
åue
;

10844 i‡(
√ed_h™dÀ_dfs_Êag
 &&

10845 !
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_HANDLE_DFS
])) {

10846 
îr
 = -
EINVAL
;

10847 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10848 
‰ì
;

10852 i‡(
öfo
->
©ås
[
NL80211_ATTR_CH_SWITCH_BLOCK_TX
])

10853 
∑øms
.
block_tx
 = 
åue
;

10855 
∑øms
.
lök_id
 =Üink_id;

10856 
îr
 = 
	`rdev_ch™√l_swôch
(
rdev
, 
dev
, &
∑øms
);

10858 
‰ì
:

10859 
	`k‰ì
(
∑øms
.
bóc⁄_a·î
.
mbssid_õs
);

10860 
	`k‰ì
(
∑øms
.
bóc⁄_cß
.
mbssid_õs
);

10861 
	`k‰ì
(
∑øms
.
bóc⁄_a·î
.
∫r_õs
);

10862 
	`k‰ì
(
∑øms
.
bóc⁄_cß
.
∫r_õs
);

10863 
	`k‰ì
(
cß_©ås
);

10864 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

10865  
îr
;

10866 
	}
}

10868 
	$∆80211_£nd_bss
(
sk_buff
 *
msg
, 
√éök_ˇŒback
 *
cb
,

10869 
u32
 
£q
, 
Êags
,

10870 
cfg80211_ªgi°îed_devi˚
 *
rdev
,

10871 
wúñess_dev
 *
wdev
,

10872 
cfg80211_öã∫Æ_bss
 *
ötbss
)

10874 
cfg80211_bss
 *
ªs
 = &
ötbss
->
pub
;

10875 c⁄° 
cfg80211_bss_õs
 *
õs
;

10876 
lök_id
;

10877 *
hdr
;

10878 
∆©å
 *
bss
;

10880 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

10882 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
	`NETLINK_CB
(
cb
->
skb
).
p‹tid
, 
£q
, 
Êags
,

10883 
NL80211_CMD_NEW_SCAN_RESULTS
);

10884 i‡(!
hdr
)

10887 
	`gíl_dump_check_c⁄si°ít
(
cb
, 
hdr
);

10889 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_GENERATION
, 
rdev
->
bss_gíî©i⁄
))

10890 
∆a_put_Áûuª
;

10891 i‡(
wdev
->
√tdev
 &&

10892 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
wdev
->
√tdev
->
ifödex
))

10893 
∆a_put_Áûuª
;

10894 i‡(
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

10895 
NL80211_ATTR_PAD
))

10896 
∆a_put_Áûuª
;

10898 
bss
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_BSS
);

10899 i‡(!
bss
)

10900 
∆a_put_Áûuª
;

10901 i‡((!
	`is_zîo_ëhî_addr
(
ªs
->
bssid
) &&

10902 
	`∆a_put
(
msg
, 
NL80211_BSS_BSSID
, 
ETH_ALEN
, 
ªs
->
bssid
)))

10903 
∆a_put_Áûuª
;

10905 
	`rcu_ªad_lock
();

10907 i‡(
	`rcu_ac˚ss_poöãr
(
ªs
->
¥obîe•_õs
) &&

10908 
	`∆a_put_Êag
(
msg
, 
NL80211_BSS_PRESP_DATA
))

10909 
Áû_u∆ock_rcu
;

10914 
õs
 = 
	`rcu_dîe„ªn˚
(
ªs
->ies);

10915 i‡(
õs
) {

10916 i‡(
	`∆a_put_u64_64bô
(
msg
, 
NL80211_BSS_TSF
, 
õs
->
tsf
,

10917 
NL80211_BSS_PAD
))

10918 
Áû_u∆ock_rcu
;

10919 i‡(
õs
->
Àn
 && 
	`∆a_put
(
msg
, 
NL80211_BSS_INFORMATION_ELEMENTS
,

10920 
õs
->
Àn
, ies->
d©a
))

10921 
Áû_u∆ock_rcu
;

10925 
õs
 = 
	`rcu_dîe„ªn˚
(
ªs
->
bóc⁄_õs
);

10926 i‡(
õs
 && ies->
‰om_bóc⁄
) {

10927 i‡(
	`∆a_put_u64_64bô
(
msg
, 
NL80211_BSS_BEACON_TSF
, 
õs
->
tsf
,

10928 
NL80211_BSS_PAD
))

10929 
Áû_u∆ock_rcu
;

10930 i‡(
õs
->
Àn
 && 
	`∆a_put
(
msg
, 
NL80211_BSS_BEACON_IES
,

10931 
õs
->
Àn
, ies->
d©a
))

10932 
Áû_u∆ock_rcu
;

10934 
	`rcu_ªad_u∆ock
();

10936 i‡(
ªs
->
bóc⁄_öãrvÆ
 &&

10937 
	`∆a_put_u16
(
msg
, 
NL80211_BSS_BEACON_INTERVAL
, 
ªs
->
bóc⁄_öãrvÆ
))

10938 
∆a_put_Áûuª
;

10939 i‡(
	`∆a_put_u16
(
msg
, 
NL80211_BSS_CAPABILITY
, 
ªs
->
ˇ∑bûôy
) ||

10940 
	`∆a_put_u32
(
msg
, 
NL80211_BSS_FREQUENCY
, 
ªs
->
ch™√l
->
˚¡î_‰eq
) ||

10941 
	`∆a_put_u32
(
msg
, 
NL80211_BSS_FREQUENCY_OFFSET
,

10942 
ªs
->
ch™√l
->
‰eq_off£t
) ||

10943 
	`∆a_put_u32
(
msg
, 
NL80211_BSS_SEEN_MS_AGO
,

10944 
	`jiffõs_to_m£cs
(
jiffõs
 - 
ötbss
->
ts
)))

10945 
∆a_put_Áûuª
;

10947 i‡(
ötbss
->
∑ª¡_tsf
 &&

10948 (
	`∆a_put_u64_64bô
(
msg
, 
NL80211_BSS_PARENT_TSF
,

10949 
ötbss
->
∑ª¡_tsf
, 
NL80211_BSS_PAD
) ||

10950 
	`∆a_put
(
msg
, 
NL80211_BSS_PARENT_BSSID
, 
ETH_ALEN
,

10951 
ötbss
->
∑ª¡_bssid
)))

10952 
∆a_put_Áûuª
;

10954 i‡(
ötbss
->
ts_boŸtime
 &&

10955 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_BSS_LAST_SEEN_BOOTTIME
,

10956 
ötbss
->
ts_boŸtime
, 
NL80211_BSS_PAD
))

10957 
∆a_put_Áûuª
;

10959 i‡(!
	`∆80211_put_sig«l
(
msg
, 
ötbss
->
pub
.
chaös
,

10960 
ötbss
->
pub
.
chaö_sig«l
,

10961 
NL80211_BSS_CHAIN_SIGNAL
))

10962 
∆a_put_Áûuª
;

10964 
rdev
->
wùhy
.
sig«l_ty≥
) {

10965 
CFG80211_SIGNAL_TYPE_MBM
:

10966 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_BSS_SIGNAL_MBM
, 
ªs
->
sig«l
))

10967 
∆a_put_Áûuª
;

10969 
CFG80211_SIGNAL_TYPE_UNSPEC
:

10970 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_BSS_SIGNAL_UNSPEC
, 
ªs
->
sig«l
))

10971 
∆a_put_Áûuª
;

10977 
wdev
->
i·y≥
) {

10978 
NL80211_IFTYPE_P2P_CLIENT
:

10979 
NL80211_IFTYPE_STATION
:

10980 
	`f‹_óch_vÆid_lök
(
wdev
, 
lök_id
) {

10981 i‡(
ötbss
 =
wdev
->
löks
[
lök_id
].
˛õ¡
.
cuºít_bss
 &&

10982 (
	`∆a_put_u32
(
msg
, 
NL80211_BSS_STATUS
,

10983 
NL80211_BSS_STATUS_ASSOCIATED
) ||

10984 (
wdev
->
vÆid_löks
 &&

10985 (
	`∆a_put_u8
(
msg
, 
NL80211_BSS_MLO_LINK_ID
,

10986 
lök_id
) ||

10987 
	`∆a_put
(
msg
, 
NL80211_BSS_MLD_ADDR
, 
ETH_ALEN
,

10988 
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
)))))

10989 
∆a_put_Áûuª
;

10992 
NL80211_IFTYPE_ADHOC
:

10993 i‡(
ötbss
 =
wdev
->
u
.
ibss
.
cuºít_bss
 &&

10994 
	`∆a_put_u32
(
msg
, 
NL80211_BSS_STATUS
,

10995 
NL80211_BSS_STATUS_IBSS_JOINED
))

10996 
∆a_put_Áûuª
;

11002 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_BSS_USE_FOR
, 
ªs
->
u£_f‹
))

11003 
∆a_put_Áûuª
;

11005 i‡(
ªs
->
ˇ¬Ÿ_u£_ªas⁄s
 &&

11006 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_BSS_CANNOT_USE_REASONS
,

11007 
ªs
->
ˇ¬Ÿ_u£_ªas⁄s
,

11008 
NL80211_BSS_PAD
))

11009 
∆a_put_Áûuª
;

11011 
	`∆a_√°_íd
(
msg
, 
bss
);

11013 
	`gílmsg_íd
(
msg
, 
hdr
);

11016 
Áû_u∆ock_rcu
:

11017 
	`rcu_ªad_u∆ock
();

11018 
∆a_put_Áûuª
:

11019 
	`gílmsg_ˇn˚l
(
msg
, 
hdr
);

11020  -
EMSGSIZE
;

11021 
	}
}

11023 
	$∆80211_dump_sˇn
(
sk_buff
 *
skb
, 
√éök_ˇŒback
 *
cb
)

11025 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

11026 
cfg80211_öã∫Æ_bss
 *
sˇn
;

11027 
wúñess_dev
 *
wdev
;

11028 
∆©å
 **
©åbuf
;

11029 
°¨t
 = 
cb
->
¨gs
[2], 
idx
 = 0;

11030 
boﬁ
 
dump_ö˛ude_u£_d©a
;

11031 
îr
;

11033 
©åbuf
 = 
	`kˇŒoc
(
NUM_NL80211_ATTR
, (*©åbuf), 
GFP_KERNEL
);

11034 i‡(!
©åbuf
)

11035  -
ENOMEM
;

11037 
îr
 = 
	`∆80211_¥ï¨e_wdev_dump
(
cb
, &
rdev
, &
wdev
, 
©åbuf
);

11038 i‡(
îr
) {

11039 
	`k‰ì
(
©åbuf
);

11040  
îr
;

11043 
	`__acquúe
(&
rdev
->
wùhy
.
mtx
);

11045 
dump_ö˛ude_u£_d©a
 =

11046 
©åbuf
[
NL80211_ATTR_BSS_DUMP_INCLUDE_USE_DATA
];

11047 
	`k‰ì
(
©åbuf
);

11049 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

11057 i‡(
°¨t
 == 0)

11058 
	`cfg80211_bss_expúe
(
rdev
);

11060 
cb
->
£q
 = 
rdev
->
bss_gíî©i⁄
;

11062 
	`li°_f‹_óch_íåy
(
sˇn
, &
rdev
->
bss_li°
, 
li°
) {

11063 i‡(++
idx
 <
°¨t
)

11065 i‡(!
dump_ö˛ude_u£_d©a
 &&

11066 !(
sˇn
->
pub
.
u£_f‹
 & 
NL80211_BSS_USE_FOR_NORMAL
))

11068 i‡(
	`∆80211_£nd_bss
(
skb
, 
cb
,

11069 
cb
->
∆h
->
∆msg_£q
, 
NLM_F_MULTI
,

11070 
rdev
, 
wdev
, 
sˇn
) < 0) {

11071 
idx
--;

11076 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

11078 
cb
->
¨gs
[2] = 
idx
;

11079 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

11081  
skb
->
Àn
;

11082 
	}
}

11084 
	$∆80211_£nd_survey
(
sk_buff
 *
msg
, 
u32
 
p‹tid
, u32 
£q
,

11085 
Êags
, 
√t_devi˚
 *
dev
,

11086 
boﬁ
 
Ælow_ødio_°©s
,

11087 
survey_öfo
 *
survey
)

11089 *
hdr
;

11090 
∆©å
 *
öfﬂâr
;

11093 i‡(!
survey
->
ch™√l
 && !
Ælow_ødio_°©s
)

11096 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
p‹tid
, 
£q
, 
Êags
,

11097 
NL80211_CMD_NEW_SURVEY_RESULTS
);

11098 i‡(!
hdr
)

11099  -
ENOMEM
;

11101 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
))

11102 
∆a_put_Áûuª
;

11104 
öfﬂâr
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_SURVEY_INFO
);

11105 i‡(!
öfﬂâr
)

11106 
∆a_put_Áûuª
;

11108 i‡(
survey
->
ch™√l
 &&

11109 
	`∆a_put_u32
(
msg
, 
NL80211_SURVEY_INFO_FREQUENCY
,

11110 
survey
->
ch™√l
->
˚¡î_‰eq
))

11111 
∆a_put_Áûuª
;

11113 i‡(
survey
->
ch™√l
 && survey->ch™√l->
‰eq_off£t
 &&

11114 
	`∆a_put_u32
(
msg
, 
NL80211_SURVEY_INFO_FREQUENCY_OFFSET
,

11115 
survey
->
ch™√l
->
‰eq_off£t
))

11116 
∆a_put_Áûuª
;

11118 i‡((
survey
->
fûÀd
 & 
SURVEY_INFO_NOISE_DBM
) &&

11119 
	`∆a_put_u8
(
msg
, 
NL80211_SURVEY_INFO_NOISE
, 
survey
->
noi£
))

11120 
∆a_put_Áûuª
;

11121 i‡((
survey
->
fûÀd
 & 
SURVEY_INFO_IN_USE
) &&

11122 
	`∆a_put_Êag
(
msg
, 
NL80211_SURVEY_INFO_IN_USE
))

11123 
∆a_put_Áûuª
;

11124 i‡((
survey
->
fûÀd
 & 
SURVEY_INFO_TIME
) &&

11125 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_SURVEY_INFO_TIME
,

11126 
survey
->
time
, 
NL80211_SURVEY_INFO_PAD
))

11127 
∆a_put_Áûuª
;

11128 i‡((
survey
->
fûÀd
 & 
SURVEY_INFO_TIME_BUSY
) &&

11129 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_SURVEY_INFO_TIME_BUSY
,

11130 
survey
->
time_busy
, 
NL80211_SURVEY_INFO_PAD
))

11131 
∆a_put_Áûuª
;

11132 i‡((
survey
->
fûÀd
 & 
SURVEY_INFO_TIME_EXT_BUSY
) &&

11133 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_SURVEY_INFO_TIME_EXT_BUSY
,

11134 
survey
->
time_ext_busy
, 
NL80211_SURVEY_INFO_PAD
))

11135 
∆a_put_Áûuª
;

11136 i‡((
survey
->
fûÀd
 & 
SURVEY_INFO_TIME_RX
) &&

11137 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_SURVEY_INFO_TIME_RX
,

11138 
survey
->
time_rx
, 
NL80211_SURVEY_INFO_PAD
))

11139 
∆a_put_Áûuª
;

11140 i‡((
survey
->
fûÀd
 & 
SURVEY_INFO_TIME_TX
) &&

11141 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_SURVEY_INFO_TIME_TX
,

11142 
survey
->
time_tx
, 
NL80211_SURVEY_INFO_PAD
))

11143 
∆a_put_Áûuª
;

11144 i‡((
survey
->
fûÀd
 & 
SURVEY_INFO_TIME_SCAN
) &&

11145 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_SURVEY_INFO_TIME_SCAN
,

11146 
survey
->
time_sˇn
, 
NL80211_SURVEY_INFO_PAD
))

11147 
∆a_put_Áûuª
;

11148 i‡((
survey
->
fûÀd
 & 
SURVEY_INFO_TIME_BSS_RX
) &&

11149 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_SURVEY_INFO_TIME_BSS_RX
,

11150 
survey
->
time_bss_rx
, 
NL80211_SURVEY_INFO_PAD
))

11151 
∆a_put_Áûuª
;

11153 
	`∆a_√°_íd
(
msg
, 
öfﬂâr
);

11155 
	`gílmsg_íd
(
msg
, 
hdr
);

11158 
∆a_put_Áûuª
:

11159 
	`gílmsg_ˇn˚l
(
msg
, 
hdr
);

11160  -
EMSGSIZE
;

11161 
	}
}

11163 
	$∆80211_dump_survey
(
sk_buff
 *
skb
, 
√éök_ˇŒback
 *
cb
)

11165 
∆©å
 **
©åbuf
;

11166 
survey_öfo
 
survey
;

11167 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

11168 
wúñess_dev
 *
wdev
;

11169 
survey_idx
 = 
cb
->
¨gs
[2];

11170 
ªs
;

11171 
boﬁ
 
ødio_°©s
;

11173 
©åbuf
 = 
	`kˇŒoc
(
NUM_NL80211_ATTR
, (*©åbuf), 
GFP_KERNEL
);

11174 i‡(!
©åbuf
)

11175  -
ENOMEM
;

11177 
ªs
 = 
	`∆80211_¥ï¨e_wdev_dump
(
cb
, &
rdev
, &
wdev
, 
©åbuf
);

11178 i‡(
ªs
) {

11179 
	`k‰ì
(
©åbuf
);

11180  
ªs
;

11183 
	`__acquúe
(&
rdev
->
wùhy
.
mtx
);

11186 
ødio_°©s
 = 
©åbuf
[
NL80211_ATTR_SURVEY_RADIO_STATS
];

11188 i‡(!
wdev
->
√tdev
) {

11189 
ªs
 = -
EINVAL
;

11190 
out_îr
;

11193 i‡(!
rdev
->
›s
->
dump_survey
) {

11194 
ªs
 = -
EOPNOTSUPP
;

11195 
out_îr
;

11199 
ªs
 = 
	`rdev_dump_survey
(
rdev
, 
wdev
->
√tdev
, 
survey_idx
, &
survey
);

11200 i‡(
ªs
 =-
ENOENT
)

11202 i‡(
ªs
)

11203 
out_îr
;

11206 i‡(
survey
.
ch™√l
 &&

11207 
survey
.
ch™√l
->
Êags
 & 
IEEE80211_CHAN_DISABLED
) {

11208 
survey_idx
++;

11212 i‡(
	`∆80211_£nd_survey
(
skb
,

11213 
	`NETLINK_CB
(
cb
->
skb
).
p‹tid
,

11214 
cb
->
∆h
->
∆msg_£q
, 
NLM_F_MULTI
,

11215 
wdev
->
√tdev
, 
ødio_°©s
, &
survey
) < 0)

11216 
out
;

11217 
survey_idx
++;

11220 
out
:

11221 
cb
->
¨gs
[2] = 
survey_idx
;

11222 
ªs
 = 
skb
->
Àn
;

11223 
out_îr
:

11224 
	`k‰ì
(
©åbuf
);

11225 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

11226  
ªs
;

11227 
	}
}

11229 
	$∆80211_authítiˇã
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

11231 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

11232 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

11233 
õì80211_ch™√l
 *
ch™
;

11234 c⁄° 
u8
 *
bssid
, *
ssid
;

11235 
îr
, 
ssid_Àn
;

11236 
∆80211_auth_ty≥
 
auth_ty≥
;

11237 
key_∑r£
 
key
;

11238 
boﬁ
 
loˇl_°©e_ch™ge
;

11239 
cfg80211_auth_ªque°
 
ªq
 = {};

11240 
u32
 
‰eq
;

11242 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_AUTHENTICATE] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

11244 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

11245 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11246  -
EINVAL
;

11249 i‡(!
öfo
->
©ås
[
NL80211_ATTR_AUTH_TYPE
]) {

11250 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11251  -
EINVAL
;

11254 i‡(!
öfo
->
©ås
[
NL80211_ATTR_SSID
]) {

11255 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11256  -
EINVAL
;

11259 i‡(!
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
]) {

11260 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11261  -
EINVAL
;

11264 
îr
 = 
	`∆80211_∑r£_key
(
öfo
, &
key
);

11265 i‡(
îr
) {

11266 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11267  
îr
;

11270 i‡(
key
.
idx
 >= 0) {

11271 i‡(
key
.
ty≥
 !-1 && key.ty≥ !
NL80211_KEYTYPE_GROUP
) {

11272 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11273  -
EINVAL
;

11275 i‡(!
key
.
p
.key || !key.p.
key_Àn
) {

11276 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11277  -
EINVAL
;

11279 i‡((
key
.
p
.
cùhî
 !
WLAN_CIPHER_SUITE_WEP40
 ||

11280 
key
.
p
.
key_Àn
 !
WLAN_KEY_LEN_WEP40
) &&

11281 (
key
.
p
.
cùhî
 !
WLAN_CIPHER_SUITE_WEP104
 ||

11282 
key
.
p
.
key_Àn
 !
WLAN_KEY_LEN_WEP104
)) {

11283 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11284  -
EINVAL
;

11286 i‡(
key
.
idx
 > 3) {

11287 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11288  -
EINVAL
;

11291 
key
.
p
.
key_Àn
 = 0;

11292 
key
.
p
.key = 
NULL
;

11295 i‡(
key
.
idx
 >= 0) {

11296 
i
;

11297 
boﬁ
 
ok
 = 
Ál£
;

11299 
i
 = 0; i < 
rdev
->
wùhy
.
n_cùhî_suôes
; i++) {

11300 i‡(
key
.
p
.
cùhî
 =
rdev
->
wùhy
.
cùhî_suôes
[
i
]) {

11301 
ok
 = 
åue
;

11302 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11306 i‡(!
ok
) {

11307 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11308  -
EINVAL
;

11312 i‡(!
rdev
->
›s
->
auth
) {

11313 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11314  -
EOPNOTSUPP
;

11317 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

11318 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
) {

11319 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11320  -
EOPNOTSUPP
;

11323 
bssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

11324 
‰eq
 = 
	`MHZ_TO_KHZ
(
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
]));

11325 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ_OFFSET
])

11326 
‰eq
 +=

11327 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ_OFFSET
]);

11329 
ch™
 = 
	`∆80211_gë_vÆid_ch™
(&
rdev
->
wùhy
, 
‰eq
);

11330 i‡(!
ch™
) {

11331 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11332  -
EINVAL
;

11335 
ssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

11336 
ssid_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

11338 i‡(
öfo
->
©ås
[
NL80211_ATTR_IE
]) {

11339 
ªq
.
õ
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

11340 
ªq
.
õ_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

11343 
auth_ty≥
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_AUTH_TYPE
]);

11344 i‡(!
	`∆80211_vÆid_auth_ty≥
(
rdev
, 
auth_ty≥
, 
NL80211_CMD_AUTHENTICATE
)) {

11345 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11346  -
EINVAL
;

11349 i‡((
auth_ty≥
 =
NL80211_AUTHTYPE_SAE
 ||

11350 
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_SK
 ||

11351 
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_SK_PFS
 ||

11352 
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_PK
) &&

11353 !
öfo
->
©ås
[
NL80211_ATTR_AUTH_DATA
]) {

11354 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11355  -
EINVAL
;

11358 i‡(
öfo
->
©ås
[
NL80211_ATTR_AUTH_DATA
]) {

11359 i‡(
auth_ty≥
 !
NL80211_AUTHTYPE_SAE
 &&

11360 
auth_ty≥
 !
NL80211_AUTHTYPE_FILS_SK
 &&

11361 
auth_ty≥
 !
NL80211_AUTHTYPE_FILS_SK_PFS
 &&

11362 
auth_ty≥
 !
NL80211_AUTHTYPE_FILS_PK
) {

11363 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11364  -
EINVAL
;

11366 
ªq
.
auth_d©a
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_AUTH_DATA
]);

11367 
ªq
.
auth_d©a_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_AUTH_DATA
]);

11370 
loˇl_°©e_ch™ge
 = !!
öfo
->
©ås
[
NL80211_ATTR_LOCAL_STATE_CHANGE
];

11376 i‡(
loˇl_°©e_ch™ge
) {

11377 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11381 
ªq
.
auth_ty≥
 =áuth_type;

11382 
ªq
.
key
 = key.
p
.key;

11383 
ªq
.
key_Àn
 = 
key
.
p
.key_len;

11384 
ªq
.
key_idx
 = 
key
.
idx
;

11385 
ªq
.
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

11386 i‡(
ªq
.
lök_id
 >= 0) {

11387 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_MLO
)) {

11388 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11389  -
EINVAL
;

11391 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
]) {

11392 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11393  -
EINVAL
;

11395 
ªq
.
≠_mld_addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
]);

11396 i‡(!
	`is_vÆid_ëhî_addr
(
ªq
.
≠_mld_addr
)) {

11397 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11398  -
EINVAL
;

11402 
ªq
.
bss
 = 
	`cfg80211_gë_bss
(&
rdev
->
wùhy
, 
ch™
, 
bssid
, 
ssid
, 
ssid_Àn
,

11403 
IEEE80211_BSS_TYPE_ESS
,

11404 
IEEE80211_PRIVACY_ANY
);

11405 i‡(!
ªq
.
bss
) {

11406 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11407  -
ENOENT
;

11410 
îr
 = 
	`cfg80211_mlme_auth
(
rdev
, 
dev
, &
ªq
);

11412 
	`cfg80211_put_bss
(&
rdev
->
wùhy
, 
ªq
.
bss
);

11414 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_AUTHENTICATE] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

11415  
îr
;

11416 
	}
}

11418 
	$vÆid©e_∑e_ovî_∆80211
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

11419 
gíl_öfo
 *
öfo
)

11421 i‡(!
öfo
->
©ås
[
NL80211_ATTR_SOCKET_OWNER
]) {

11422 
	`GENL_SET_ERR_MSG
(
öfo
, "SOCKET_OWNERÇot set");

11423  -
EINVAL
;

11426 i‡(!
rdev
->
›s
->
tx_c⁄åﬁ_p‹t
 ||

11427 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

11428 
NL80211_EXT_FEATURE_CONTROL_PORT_OVER_NL80211
))

11429  -
EOPNOTSUPP
;

11432 
	}
}

11434 
	$∆80211_¸y±o_£âögs
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

11435 
gíl_öfo
 *
öfo
,

11436 
cfg80211_¸y±o_£âögs
 *
£âögs
,

11437 
cùhî_limô
)

11439 
	`mem£t
(
£âögs
, 0, (*settings));

11441 
£âögs
->
c⁄åﬁ_p‹t
 = 
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT
];

11443 i‡(
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT_ETHERTYPE
]) {

11444 
u16
 
¥Ÿo
;

11446 
¥Ÿo
 = 
	`∆a_gë_u16
(

11447 
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT_ETHERTYPE
]);

11448 
£âögs
->
c⁄åﬁ_p‹t_ëhîty≥
 = 
	`˝u_to_be16
(
¥Ÿo
);

11449 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_CONTROL_PORT_PROTOCOL
) &&

11450 
¥Ÿo
 !
ETH_P_PAE
)

11451  -
EINVAL
;

11452 i‡(
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT_NO_ENCRYPT
])

11453 
£âögs
->
c⁄åﬁ_p‹t_no_í¸y±
 = 
åue
;

11455 
£âögs
->
c⁄åﬁ_p‹t_ëhîty≥
 = 
	`˝u_to_be16
(
ETH_P_PAE
);

11457 i‡(
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT_OVER_NL80211
]) {

11458 
r
 = 
	`vÆid©e_∑e_ovî_∆80211
(
rdev
, 
öfo
);

11460 i‡(
r
 < 0)

11461  
r
;

11463 
£âögs
->
c⁄åﬁ_p‹t_ovî_∆80211
 = 
åue
;

11465 i‡(
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT_NO_PREAUTH
])

11466 
£âögs
->
c⁄åﬁ_p‹t_no_¥óuth
 = 
åue
;

11469 i‡(
öfo
->
©ås
[
NL80211_ATTR_CIPHER_SUITES_PAIRWISE
]) {

11470 *
d©a
;

11471 
Àn
, 
i
;

11473 
d©a
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_CIPHER_SUITES_PAIRWISE
]);

11474 
Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_CIPHER_SUITES_PAIRWISE
]);

11475 
£âögs
->
n_cùhîs_∑úwi£
 = 
Àn
 / (
u32
);

11477 i‡(
Àn
 % (
u32
))

11478  -
EINVAL
;

11480 i‡(
£âögs
->
n_cùhîs_∑úwi£
 > 
cùhî_limô
)

11481  -
EINVAL
;

11483 
	`mem˝y
(
£âögs
->
cùhîs_∑úwi£
, 
d©a
, 
Àn
);

11485 
i
 = 0; i < 
£âögs
->
n_cùhîs_∑úwi£
; i++)

11486 i‡(!
	`cfg80211_suµ‹ãd_cùhî_suôe
(

11487 &
rdev
->
wùhy
,

11488 
£âögs
->
cùhîs_∑úwi£
[
i
]))

11489  -
EINVAL
;

11492 i‡(
öfo
->
©ås
[
NL80211_ATTR_CIPHER_SUITE_GROUP
]) {

11493 
£âögs
->
cùhî_group
 =

11494 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_CIPHER_SUITE_GROUP
]);

11495 i‡(!
	`cfg80211_suµ‹ãd_cùhî_suôe
(&
rdev
->
wùhy
,

11496 
£âögs
->
cùhî_group
))

11497  -
EINVAL
;

11500 i‡(
öfo
->
©ås
[
NL80211_ATTR_WPA_VERSIONS
])

11501 
£âögs
->
w∑_vîsi⁄s
 =

11502 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_WPA_VERSIONS
]);

11504 i‡(
öfo
->
©ås
[
NL80211_ATTR_AKM_SUITES
]) {

11505 *
d©a
;

11506 
Àn
;

11508 
d©a
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_AKM_SUITES
]);

11509 
Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_AKM_SUITES
]);

11510 
£âögs
->
n_akm_suôes
 = 
Àn
 / (
u32
);

11512 i‡(
Àn
 % (
u32
))

11513  -
EINVAL
;

11515 i‡(
£âögs
->
n_akm_suôes
 > 
rdev
->
wùhy
.
max_num_akm_suôes
)

11516  -
EINVAL
;

11518 
	`mem˝y
(
£âögs
->
akm_suôes
, 
d©a
, 
Àn
);

11521 i‡(
öfo
->
©ås
[
NL80211_ATTR_PMK
]) {

11522 i‡(
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_PMK
]Ë!
WLAN_PMK_LEN
)

11523  -
EINVAL
;

11524 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

11525 
NL80211_EXT_FEATURE_4WAY_HANDSHAKE_STA_PSK
) &&

11526 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

11527 
NL80211_EXT_FEATURE_4WAY_HANDSHAKE_AP_PSK
))

11528  -
EINVAL
;

11529 
£âögs
->
psk
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_PMK
]);

11532 i‡(
öfo
->
©ås
[
NL80211_ATTR_SAE_PASSWORD
]) {

11533 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

11534 
NL80211_EXT_FEATURE_SAE_OFFLOAD
) &&

11535 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

11536 
NL80211_EXT_FEATURE_SAE_OFFLOAD_AP
))

11537  -
EINVAL
;

11538 
£âögs
->
ße_pwd
 =

11539 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_SAE_PASSWORD
]);

11540 
£âögs
->
ße_pwd_Àn
 =

11541 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_SAE_PASSWORD
]);

11544 i‡(
öfo
->
©ås
[
NL80211_ATTR_SAE_PWE
])

11545 
£âögs
->
ße_pwe
 =

11546 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_SAE_PWE
]);

11548 
£âögs
->
ße_pwe
 = 
NL80211_SAE_PWE_UNSPECIFIED
;

11551 
	}
}

11553 
cfg80211_bss
 *
	$∆80211_assoc_bss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

11554 c⁄° 
u8
 *
ssid
, 
ssid_Àn
,

11555 
∆©å
 **
©ås
,

11556 
assoc_lök_id
, 
lök_id
)

11558 
õì80211_ch™√l
 *
ch™
;

11559 
cfg80211_bss
 *
bss
;

11560 c⁄° 
u8
 *
bssid
;

11561 
u32
 
‰eq
, 
u£_f‹
 = 0;

11563 i‡(!
©ås
[
NL80211_ATTR_MAC
] || !©ås[
NL80211_ATTR_WIPHY_FREQ
])

11564  
	`ERR_PTR
(-
EINVAL
);

11566 
bssid
 = 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_MAC
]);

11568 
‰eq
 = 
	`MHZ_TO_KHZ
(
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_WIPHY_FREQ
]));

11569 i‡(
©ås
[
NL80211_ATTR_WIPHY_FREQ_OFFSET
])

11570 
‰eq
 +
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_WIPHY_FREQ_OFFSET
]);

11572 
ch™
 = 
	`∆80211_gë_vÆid_ch™
(&
rdev
->
wùhy
, 
‰eq
);

11573 i‡(!
ch™
)

11574  
	`ERR_PTR
(-
EINVAL
);

11576 i‡(
assoc_lök_id
 >= 0)

11577 
u£_f‹
 = 
NL80211_BSS_USE_FOR_MLD_LINK
;

11578 i‡(
assoc_lök_id
 =
lök_id
)

11579 
u£_f‹
 |
NL80211_BSS_USE_FOR_NORMAL
;

11581 
bss
 = 
	`__cfg80211_gë_bss
(&
rdev
->
wùhy
, 
ch™
, 
bssid
,

11582 
ssid
, 
ssid_Àn
,

11583 
IEEE80211_BSS_TYPE_ESS
,

11584 
IEEE80211_PRIVACY_ANY
,

11585 
u£_f‹
);

11586 i‡(!
bss
)

11587  
	`ERR_PTR
(-
ENOENT
);

11589  
bss
;

11590 
	}
}

11592 
	$∆80211_assocüã
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

11594 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

11595 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

11596 
cfg80211_assoc_ªque°
 
ªq
 = {};

11597 
∆©å
 **
©ås
 = 
NULL
;

11598 c⁄° 
u8
 *
≠_addr
, *
ssid
;

11599 
lök_id
;

11600 
îr
, 
ssid_Àn
;

11602 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_ASSOCIATE] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

11604 i‡(
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 &&

11605 
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 !
öfo
->
¢d_p‹tid
) {

11606 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11607  -
EPERM
;

11610 i‡(!
öfo
->
©ås
[
NL80211_ATTR_SSID
]) {

11611 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11612  -
EINVAL
;

11615 i‡(!
rdev
->
›s
->
assoc
) {

11616 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11617  -
EOPNOTSUPP
;

11620 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

11621 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
) {

11622 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11623  -
EOPNOTSUPP
;

11626 
ssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

11627 
ssid_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

11629 i‡(
öfo
->
©ås
[
NL80211_ATTR_IE
]) {

11630 
ªq
.
õ
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

11631 
ªq
.
õ_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

11633 i‡(
	`cfg80211_föd_ext_ñem
(
WLAN_EID_EXT_NON_INHERITANCE
,

11634 
ªq
.
õ
,Ñeq.
õ_Àn
)) {

11635 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

11636 
öfo
->
©ås
[
NL80211_ATTR_IE
],

11638 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11639  -
EINVAL
;

11643 i‡(
öfo
->
©ås
[
NL80211_ATTR_USE_MFP
]) {

11644 
∆80211_mÂ
 
mÂ
 =

11645 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_USE_MFP
]);

11646 i‡(
mÂ
 =
NL80211_MFP_REQUIRED
)

11647 
ªq
.
u£_mÂ
 = 
åue
;

11648 i‡(
mÂ
 !
NL80211_MFP_NO
) {

11649 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11650  -
EINVAL
;

11654 i‡(
öfo
->
©ås
[
NL80211_ATTR_PREV_BSSID
])

11655 
ªq
.
¥ev_bssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_PREV_BSSID
]);

11657 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_DISABLE_HT
]))

11658 
ªq
.
Êags
 |
ASSOC_REQ_DISABLE_HT
;

11660 i‡(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY_MASK
])

11661 
	`mem˝y
(&
ªq
.
ht_ˇ∑_mask
,

11662 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY_MASK
]),

11663 (
ªq
.
ht_ˇ∑_mask
));

11665 i‡(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
]) {

11666 i‡(!
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY_MASK
]) {

11667 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11668  -
EINVAL
;

11670 
	`mem˝y
(&
ªq
.
ht_ˇ∑
,

11671 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
]),

11672 (
ªq
.
ht_ˇ∑
));

11675 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_DISABLE_VHT
]))

11676 
ªq
.
Êags
 |
ASSOC_REQ_DISABLE_VHT
;

11678 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_DISABLE_HE
]))

11679 
ªq
.
Êags
 |
ASSOC_REQ_DISABLE_HE
;

11681 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_DISABLE_EHT
]))

11682 
ªq
.
Êags
 |
ASSOC_REQ_DISABLE_EHT
;

11684 i‡(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY_MASK
])

11685 
	`mem˝y
(&
ªq
.
vht_ˇ∑_mask
,

11686 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY_MASK
]),

11687 (
ªq
.
vht_ˇ∑_mask
));

11689 i‡(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY
]) {

11690 i‡(!
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY_MASK
]) {

11691 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11692  -
EINVAL
;

11694 
	`mem˝y
(&
ªq
.
vht_ˇ∑
,

11695 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY
]),

11696 (
ªq
.
vht_ˇ∑
));

11699 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_USE_RRM
])) {

11700 i‡(!((
rdev
->
wùhy
.
„©uªs
 &

11701 
NL80211_FEATURE_DS_PARAM_SET_IE_IN_PROBES
) &&

11702 (
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_QUIET
)) &&

11703 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

11704 
NL80211_EXT_FEATURE_RRM
)) {

11705 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11706  -
EINVAL
;

11708 
ªq
.
Êags
 |
ASSOC_REQ_USE_RRM
;

11711 i‡(
öfo
->
©ås
[
NL80211_ATTR_FILS_KEK
]) {

11712 
ªq
.
fûs_kek
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_KEK
]);

11713 
ªq
.
fûs_kek_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FILS_KEK
]);

11714 i‡(!
öfo
->
©ås
[
NL80211_ATTR_FILS_NONCES
]) {

11715 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11716  -
EINVAL
;

11718 
ªq
.
fûs_n⁄˚s
 =

11719 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_NONCES
]);

11722 i‡(
öfo
->
©ås
[
NL80211_ATTR_S1G_CAPABILITY_MASK
]) {

11723 i‡(!
öfo
->
©ås
[
NL80211_ATTR_S1G_CAPABILITY
]) {

11724 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11725  -
EINVAL
;

11727 
	`mem˝y
(&
ªq
.
s1g_ˇ∑_mask
,

11728 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_S1G_CAPABILITY_MASK
]),

11729 (
ªq
.
s1g_ˇ∑_mask
));

11732 i‡(
öfo
->
©ås
[
NL80211_ATTR_S1G_CAPABILITY
]) {

11733 i‡(!
öfo
->
©ås
[
NL80211_ATTR_S1G_CAPABILITY_MASK
]) {

11734 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11735  -
EINVAL
;

11737 
	`mem˝y
(&
ªq
.
s1g_ˇ∑
,

11738 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_S1G_CAPABILITY
]),

11739 (
ªq
.
s1g_ˇ∑
));

11742 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_ASSOC_SPP_AMSDU
])) {

11743 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

11744 
NL80211_EXT_FEATURE_SPP_AMSDU_SUPPORT
)) {

11745 
	`GENL_SET_ERR_MSG
(
öfo
, "SPP A-MSDUsÇot supported");

11746 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11747  -
EINVAL
;

11749 
ªq
.
Êags
 |
ASSOC_REQ_SPP_AMSDU
;

11752 
ªq
.
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

11754 i‡(
öfo
->
©ås
[
NL80211_ATTR_MLO_LINKS
]) {

11755 
©åsize
 = 
NUM_NL80211_ATTR
 * (*
©ås
);

11756 
∆©å
 *
lök
;

11757 
ªm
 = 0;

11759 i‡(
ªq
.
lök_id
 < 0) {

11760 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11761  -
EINVAL
;

11764 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_MLO
)) {

11765 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11766  -
EINVAL
;

11769 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
] ||

11770 
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
] ||

11771 !
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
]) {

11772 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11773  -
EINVAL
;

11776 
ªq
.
≠_mld_addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
]);

11777 
≠_addr
 = 
ªq
.
≠_mld_addr
;

11779 
©ås
 = 
	`kzÆloc
(
©åsize
, 
GFP_KERNEL
);

11780 i‡(!
©ås
) {

11781 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11782  -
ENOMEM
;

11785 
	`∆a_f‹_óch_√°ed
(
lök
,

11786 
öfo
->
©ås
[
NL80211_ATTR_MLO_LINKS
],

11787 
ªm
) {

11788 
	`mem£t
(
©ås
, 0, 
©åsize
);

11790 
	`∆a_∑r£_√°ed
(
©ås
, 
NL80211_ATTR_MAX
,

11791 
lök
, 
NULL
, NULL);

11793 i‡(!
©ås
[
NL80211_ATTR_MLO_LINK_ID
]) {

11794 
îr
 = -
EINVAL
;

11795 
	`NL_SET_BAD_ATTR
(
öfo
->
exèck
, 
lök
);

11796 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11797 
‰ì
;

11800 
lök_id
 = 
	`∆a_gë_u8
(
©ås
[
NL80211_ATTR_MLO_LINK_ID
]);

11802 i‡(
ªq
.
löks
[
lök_id
].
bss
) {

11803 
îr
 = -
EINVAL
;

11804 
	`NL_SET_BAD_ATTR
(
öfo
->
exèck
, 
lök
);

11805 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11806 
‰ì
;

11808 
ªq
.
löks
[
lök_id
].
bss
 =

11809 
	`∆80211_assoc_bss
(
rdev
, 
ssid
, 
ssid_Àn
, 
©ås
,

11810 
ªq
.
lök_id
,Üink_id);

11811 i‡(
	`IS_ERR
(
ªq
.
löks
[
lök_id
].
bss
)) {

11812 
îr
 = 
	`PTR_ERR
(
ªq
.
löks
[
lök_id
].
bss
);

11813 
ªq
.
löks
[
lök_id
].
bss
 = 
NULL
;

11814 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

11815 
lök
, "Error fetching BSS forÜink");

11816 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11817 
‰ì
;

11820 i‡(
©ås
[
NL80211_ATTR_IE
]) {

11821 
ªq
.
löks
[
lök_id
].
ñems
 =

11822 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_IE
]);

11823 
ªq
.
löks
[
lök_id
].
ñems_Àn
 =

11824 
	`∆a_Àn
(
©ås
[
NL80211_ATTR_IE
]);

11826 i‡(
	`cfg80211_föd_ñem
(
WLAN_EID_FRAGMENT
,

11827 
ªq
.
löks
[
lök_id
].
ñems
,

11828 
ªq
.
löks
[
lök_id
].
ñems_Àn
)) {

11829 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

11830 
©ås
[
NL80211_ATTR_IE
],

11832 
îr
 = -
EINVAL
;

11833 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11834 
‰ì
;

11837 i‡(
	`cfg80211_föd_ext_ñem
(
WLAN_EID_EXT_NON_INHERITANCE
,

11838 
ªq
.
löks
[
lök_id
].
ñems
,

11839 
ªq
.
löks
[
lök_id
].
ñems_Àn
)) {

11840 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

11841 
©ås
[
NL80211_ATTR_IE
],

11843 
îr
 = -
EINVAL
;

11844 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11845 
‰ì
;

11849 
ªq
.
löks
[
lök_id
].
dißbÀd
 =

11850 
	`∆a_gë_Êag
(
©ås
[
NL80211_ATTR_MLO_LINK_DISABLED
]);

11853 i‡(!
ªq
.
löks
[ªq.
lök_id
].
bss
) {

11854 
îr
 = -
EINVAL
;

11855 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11856 
‰ì
;

11859 i‡(
ªq
.
löks
[ªq.
lök_id
].
ñems_Àn
) {

11860 
	`GENL_SET_ERR_MSG
(
öfo
,

11862 
îr
 = -
EINVAL
;

11863 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11864 
‰ì
;

11867 i‡(
ªq
.
löks
[ªq.
lök_id
].
dißbÀd
) {

11868 
	`GENL_SET_ERR_MSG
(
öfo
,

11870 
îr
 = -
EINVAL
;

11871 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11872 
‰ì
;

11875 
	`k‰ì
(
©ås
);

11876 
©ås
 = 
NULL
;

11878 i‡(
ªq
.
lök_id
 >= 0) {

11879 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11880  -
EINVAL
;

11883 
ªq
.
bss
 = 
	`∆80211_assoc_bss
(
rdev
, 
ssid
, 
ssid_Àn
, 
öfo
->
©ås
,

11885 i‡(
	`IS_ERR
(
ªq
.
bss
)) {

11886 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11887  
	`PTR_ERR
(
ªq
.
bss
);

11889 
≠_addr
 = 
ªq
.
bss
->
bssid
;

11892 
îr
 = 
	`∆80211_¸y±o_£âögs
(
rdev
, 
öfo
, &
ªq
.
¸y±o
, 1);

11893 i‡(!
îr
) {

11894 
∆©å
 *
lök
;

11895 
ªm
 = 0;

11897 
îr
 = 
	`cfg80211_mlme_assoc
(
rdev
, 
dev
, &
ªq
,

11898 
öfo
->
exèck
);

11900 i‡(!
îr
 && 
öfo
->
©ås
[
NL80211_ATTR_SOCKET_OWNER
]) {

11901 
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 =

11902 
öfo
->
¢d_p‹tid
;

11903 
	`mem˝y
(
dev
->
õì80211_±r
->
disc⁄√˘_bssid
,

11904 
≠_addr
, 
ETH_ALEN
);

11908 i‡(
öfo
->
©ås
[
NL80211_ATTR_MLO_LINKS
]) {

11909 
	`∆a_f‹_óch_√°ed
(
lök
,

11910 
öfo
->
©ås
[
NL80211_ATTR_MLO_LINKS
],

11911 
ªm
) {

11912 
∆©å
 *
lök_id_©å
 =

11913 
	`∆a_föd_√°ed
(
lök
, 
NL80211_ATTR_MLO_LINK_ID
);

11915 i‡(!
lök_id_©å
)

11918 
lök_id
 = 
	`∆a_gë_u8
(
lök_id_©å
);

11920 i‡(
lök_id
 =
ªq
.link_id)

11923 i‡(!
ªq
.
löks
[
lök_id
].
îr‹
 ||

11924 
	`WARN_ON
(
ªq
.
löks
[
lök_id
].
îr‹
 > 0))

11927 
	`WARN_ON
(
îr
 >= 0);

11929 
	`NL_SET_BAD_ATTR
(
öfo
->
exèck
, 
lök
);

11930 
îr
 = 
ªq
.
löks
[
lök_id
].
îr‹
;

11931 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11937 
‰ì
:

11938 
lök_id
 = 0;Üök_id < 
	`ARRAY_SIZE
(
ªq
.
löks
);Üink_id++)

11939 
	`cfg80211_put_bss
(&
rdev
->
wùhy
, 
ªq
.
löks
[
lök_id
].
bss
);

11940 
	`cfg80211_put_bss
(&
rdev
->
wùhy
, 
ªq
.
bss
);

11941 
	`k‰ì
(
©ås
);

11943 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_ASSOCIATE] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

11944  
îr
;

11945 
	}
}

11947 
	$∆80211_dóuthítiˇã
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

11949 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

11950 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

11951 c⁄° 
u8
 *
õ
 = 
NULL
, *
bssid
;

11952 
õ_Àn
 = 0;

11953 
u16
 
ªas⁄_code
;

11954 
boﬁ
 
loˇl_°©e_ch™ge
;

11956 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

11958 i‡(
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 &&

11959 
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 !
öfo
->
¢d_p‹tid
) {

11960 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11961  -
EPERM
;

11964 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

11965 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11966  -
EINVAL
;

11969 i‡(!
öfo
->
©ås
[
NL80211_ATTR_REASON_CODE
]) {

11970 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11971  -
EINVAL
;

11974 i‡(!
rdev
->
›s
->
dóuth
) {

11975 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11976  -
EOPNOTSUPP
;

11979 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

11980 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
) {

11981 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11982  -
EOPNOTSUPP
;

11985 
bssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

11987 
ªas⁄_code
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_REASON_CODE
]);

11988 i‡(
ªas⁄_code
 == 0) {

11990 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

11991  -
EINVAL
;

11994 i‡(
öfo
->
©ås
[
NL80211_ATTR_IE
]) {

11995 
õ
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

11996 
õ_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

11999 
loˇl_°©e_ch™ge
 = !!
öfo
->
©ås
[
NL80211_ATTR_LOCAL_STATE_CHANGE
];

12001 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12002  
	`cfg80211_mlme_dóuth
(
rdev
, 
dev
, 
bssid
, 
õ
, 
õ_Àn
, 
ªas⁄_code
,

12003 
loˇl_°©e_ch™ge
);

12004 
	}
}

12006 
	$∆80211_dißssocüã
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

12008 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

12009 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

12010 c⁄° 
u8
 *
õ
 = 
NULL
, *
bssid
;

12011 
õ_Àn
 = 0;

12012 
u16
 
ªas⁄_code
;

12013 
boﬁ
 
loˇl_°©e_ch™ge
;

12015 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

12017 i‡(
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 &&

12018 
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 !
öfo
->
¢d_p‹tid
) {

12019 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12020  -
EPERM
;

12023 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

12024 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12025  -
EINVAL
;

12028 i‡(!
öfo
->
©ås
[
NL80211_ATTR_REASON_CODE
]) {

12029 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12030  -
EINVAL
;

12033 i‡(!
rdev
->
›s
->
dißssoc
) {

12034 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12035  -
EOPNOTSUPP
;

12038 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

12039 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
) {

12040 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12041  -
EOPNOTSUPP
;

12044 
bssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

12046 
ªas⁄_code
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_REASON_CODE
]);

12047 i‡(
ªas⁄_code
 == 0) {

12049 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12050  -
EINVAL
;

12053 i‡(
öfo
->
©ås
[
NL80211_ATTR_IE
]) {

12054 
õ
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

12055 
õ_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

12058 
loˇl_°©e_ch™ge
 = !!
öfo
->
©ås
[
NL80211_ATTR_LOCAL_STATE_CHANGE
];

12060 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12061  
	`cfg80211_mlme_dißssoc
(
rdev
, 
dev
, 
bssid
, 
õ
, 
õ_Àn
, 
ªas⁄_code
,

12062 
loˇl_°©e_ch™ge
);

12063 
	}
}

12065 
boﬁ


12066 
	$∆80211_∑r£_mˇ°_øã
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

12067 
mˇ°_øã
[
NUM_NL80211_BANDS
],

12068 
øãvÆ
)

12070 
wùhy
 *wùhy = &
rdev
->wiphy;

12071 
boﬁ
 
found
 = 
Ál£
;

12072 
b™d
, 
i
;

12074 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

12075 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

12077 
sb™d
 = 
wùhy
->
b™ds
[
b™d
];

12078 i‡(!
sb™d
)

12081 
i
 = 0; i < 
sb™d
->
n_bôøãs
; i++) {

12082 i‡(
sb™d
->
bôøãs
[
i
].
bôøã
 =
øãvÆ
) {

12083 
mˇ°_øã
[
b™d
] = 
i
 + 1;

12084 
found
 = 
åue
;

12090  
found
;

12091 
	}
}

12093 
	$∆80211_joö_ibss
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

12095 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

12096 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

12097 
cfg80211_ibss_∑øms
 
ibss
;

12098 
wùhy
 *wiphy;

12099 
cfg80211_ˇched_keys
 *
c⁄nkeys
 = 
NULL
;

12100 
îr
;

12102 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

12104 
	`mem£t
(&
ibss
, 0, (ibss));

12106 i‡(!
öfo
->
©ås
[
NL80211_ATTR_SSID
] ||

12107 !
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_SSID
])) {

12108 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12109  -
EINVAL
;

12112 
ibss
.
bóc⁄_öãrvÆ
 = 100;

12114 i‡(
öfo
->
©ås
[
NL80211_ATTR_BEACON_INTERVAL
])

12115 
ibss
.
bóc⁄_öãrvÆ
 =

12116 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_BEACON_INTERVAL
]);

12118 
îr
 = 
	`cfg80211_vÆid©e_bóc⁄_öt
(
rdev
, 
NL80211_IFTYPE_ADHOC
,

12119 
ibss
.
bóc⁄_öãrvÆ
);

12120 i‡(
îr
) {

12121 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12122  
îr
;

12125 i‡(!
rdev
->
›s
->
joö_ibss
) {

12126 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12127  -
EOPNOTSUPP
;

12130 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
) {

12131 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12132  -
EOPNOTSUPP
;

12135 
wùhy
 = &
rdev
->wiphy;

12137 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

12138 
ibss
.
bssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

12140 i‡(!
	`is_vÆid_ëhî_addr
(
ibss
.
bssid
)) {

12141 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12142  -
EINVAL
;

12145 
ibss
.
ssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

12146 
ibss
.
ssid_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

12148 i‡(
öfo
->
©ås
[
NL80211_ATTR_IE
]) {

12149 
ibss
.
õ
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

12150 
ibss
.
õ_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

12153 
îr
 = 
	`∆80211_∑r£_ch™def
(
rdev
, 
öfo
, &
ibss
.
ch™def
);

12154 i‡(
îr
) {

12155 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12156  
îr
;

12159 i‡(!
	`cfg80211_ªg_ˇn_bóc⁄
(&
rdev
->
wùhy
, &
ibss
.
ch™def
,

12160 
NL80211_IFTYPE_ADHOC
)) {

12161 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12162  -
EINVAL
;

12165 
ibss
.
ch™def
.
width
) {

12166 
NL80211_CHAN_WIDTH_5
:

12167 
NL80211_CHAN_WIDTH_10
:

12168 
NL80211_CHAN_WIDTH_20_NOHT
:

12169 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12171 
NL80211_CHAN_WIDTH_20
:

12172 
NL80211_CHAN_WIDTH_40
:

12173 i‡(!(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_HT_IBSS
)) {

12174 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12175  -
EINVAL
;

12177 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12179 
NL80211_CHAN_WIDTH_80
:

12180 
NL80211_CHAN_WIDTH_80P80
:

12181 
NL80211_CHAN_WIDTH_160
:

12182 i‡(!(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_HT_IBSS
)) {

12183 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12184  -
EINVAL
;

12186 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

12187 
NL80211_EXT_FEATURE_VHT_IBSS
)) {

12188 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12189  -
EINVAL
;

12191 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12193 
NL80211_CHAN_WIDTH_320
:

12194 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12195  -
EINVAL
;

12197 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12198  -
EINVAL
;

12201 
ibss
.
ch™√l_fixed
 = !!
öfo
->
©ås
[
NL80211_ATTR_FREQ_FIXED
];

12202 
ibss
.
¥ivacy
 = !!
öfo
->
©ås
[
NL80211_ATTR_PRIVACY
];

12204 i‡(
öfo
->
©ås
[
NL80211_ATTR_BSS_BASIC_RATES
]) {

12205 
u8
 *
øãs
 =

12206 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_BSS_BASIC_RATES
]);

12207 
n_øãs
 =

12208 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_BSS_BASIC_RATES
]);

12209 
õì80211_suµ‹ãd_b™d
 *
sb™d
 =

12210 
wùhy
->
b™ds
[
ibss
.
ch™def
.
ch™
->
b™d
];

12212 
îr
 = 
	`õì80211_gë_øãmask
(
sb™d
, 
øãs
, 
n_øãs
,

12213 &
ibss
.
basic_øãs
);

12214 i‡(
îr
) {

12215 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12216  
îr
;

12220 i‡(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY_MASK
])

12221 
	`mem˝y
(&
ibss
.
ht_ˇ∑_mask
,

12222 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY_MASK
]),

12223 (
ibss
.
ht_ˇ∑_mask
));

12225 i‡(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
]) {

12226 i‡(!
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY_MASK
])

12227  -
EINVAL
;

12228 
	`mem˝y
(&
ibss
.
ht_ˇ∑
,

12229 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
]),

12230 (
ibss
.
ht_ˇ∑
));

12233 i‡(
öfo
->
©ås
[
NL80211_ATTR_MCAST_RATE
] &&

12234 !
	`∆80211_∑r£_mˇ°_øã
(
rdev
, 
ibss
.
mˇ°_øã
,

12235 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_MCAST_RATE
]))) {

12236 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12237  -
EINVAL
;

12240 i‡(
ibss
.
¥ivacy
 && 
öfo
->
©ås
[
NL80211_ATTR_KEYS
]) {

12241 
boﬁ
 
no_ht
 = 
Ál£
;

12243 
c⁄nkeys
 = 
	`∆80211_∑r£_c⁄nkeys
(
rdev
, 
öfo
, &
no_ht
);

12244 i‡(
	`IS_ERR
(
c⁄nkeys
)) {

12245 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12246  
	`PTR_ERR
(
c⁄nkeys
);

12249 i‡((
ibss
.
ch™def
.
width
 !
NL80211_CHAN_WIDTH_20_NOHT
) &&

12250 
no_ht
) {

12251 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12252 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12253  -
EINVAL
;

12257 
ibss
.
c⁄åﬁ_p‹t
 =

12258 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT
]);

12260 i‡(
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT_OVER_NL80211
]) {

12261 
r
 = 
	`vÆid©e_∑e_ovî_∆80211
(
rdev
, 
öfo
);

12263 i‡(
r
 < 0) {

12264 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12265 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12266  
r
;

12269 
ibss
.
c⁄åﬁ_p‹t_ovî_∆80211
 = 
åue
;

12272 
ibss
.
u£r•a˚_h™dÀs_dfs
 =

12273 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_HANDLE_DFS
]);

12275 
îr
 = 
	`__cfg80211_joö_ibss
(
rdev
, 
dev
, &
ibss
, 
c⁄nkeys
);

12276 i‡(
îr
)

12277 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12278 i‡(
öfo
->
©ås
[
NL80211_ATTR_SOCKET_OWNER
])

12279 
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 = 
öfo
->
¢d_p‹tid
;

12281 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12282  
îr
;

12283 
	}
}

12285 
	$∆80211_Àave_ibss
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

12287 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

12288 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

12290 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

12292 i‡(!
rdev
->
›s
->
Àave_ibss
) {

12293 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12294  -
EOPNOTSUPP
;

12297 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
) {

12298 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12299  -
EOPNOTSUPP
;

12302 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12303  
	`cfg80211_Àave_ibss
(
rdev
, 
dev
, 
Ál£
);

12304 
	}
}

12306 
	$∆80211_£t_mˇ°_øã
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

12308 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

12309 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

12310 
mˇ°_øã
[
NUM_NL80211_BANDS
];

12311 
u32
 
∆a_øã
;

12313 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

12315 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
 &&

12316 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
 &&

12317 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_OCB
) {

12318 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12319  -
EOPNOTSUPP
;

12322 i‡(!
rdev
->
›s
->
£t_mˇ°_øã
) {

12323 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12324  -
EOPNOTSUPP
;

12327 
	`mem£t
(
mˇ°_øã
, 0, (mcast_rate));

12329 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MCAST_RATE
]) {

12330 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12331  -
EINVAL
;

12334 
∆a_øã
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_MCAST_RATE
]);

12335 i‡(!
	`∆80211_∑r£_mˇ°_øã
(
rdev
, 
mˇ°_øã
, 
∆a_øã
)) {

12336 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12337  -
EINVAL
;

12340 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12341  
	`rdev_£t_mˇ°_øã
(
rdev
, 
dev
, 
mˇ°_øã
);

12342 
	}
}

12344 
sk_buff
 *

12345 
	$__cfg80211_Æloc_víd‹_skb
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

12346 
wúñess_dev
 *
wdev
, 
≠¥oxÀn
,

12347 
u32
 
p‹tid
, u32 
£q
, 
∆80211_comm™ds
 
cmd
,

12348 
∆80211_©ås
 
©å
,

12349 c⁄° 
∆80211_víd‹_cmd_öfo
 *
öfo
,

12350 
gÂ_t
 
gÂ
)

12352 
sk_buff
 *
skb
;

12353 *
hdr
;

12354 
∆©å
 *
d©a
;

12356 
skb
 = 
	`∆msg_√w
(
≠¥oxÀn
 + 100, 
gÂ
);

12357 i‡(!
skb
)

12358  
NULL
;

12360 
hdr
 = 
	`∆80211hdr_put
(
skb
, 
p‹tid
, 
£q
, 0, 
cmd
);

12361 i‡(!
hdr
) {

12362 
	`k‰ì_skb
(
skb
);

12363  
NULL
;

12366 i‡(
	`∆a_put_u32
(
skb
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
))

12367 
∆a_put_Áûuª
;

12369 i‡(
öfo
) {

12370 i‡(
	`∆a_put_u32
(
skb
, 
NL80211_ATTR_VENDOR_ID
,

12371 
öfo
->
víd‹_id
))

12372 
∆a_put_Áûuª
;

12373 i‡(
	`∆a_put_u32
(
skb
, 
NL80211_ATTR_VENDOR_SUBCMD
,

12374 
öfo
->
subcmd
))

12375 
∆a_put_Áûuª
;

12378 i‡(
wdev
) {

12379 i‡(
	`∆a_put_u64_64bô
(
skb
, 
NL80211_ATTR_WDEV
,

12380 
	`wdev_id
(
wdev
), 
NL80211_ATTR_PAD
))

12381 
∆a_put_Áûuª
;

12382 i‡(
wdev
->
√tdev
 &&

12383 
	`∆a_put_u32
(
skb
, 
NL80211_ATTR_IFINDEX
,

12384 
wdev
->
√tdev
->
ifödex
))

12385 
∆a_put_Áûuª
;

12388 
d©a
 = 
	`∆a_√°_°¨t_noÊag
(
skb
, 
©å
);

12389 i‡(!
d©a
)

12390 
∆a_put_Áûuª
;

12392 ((**)
skb
->
cb
)[0] = 
rdev
;

12393 ((**)
skb
->
cb
)[1] = 
hdr
;

12394 ((**)
skb
->
cb
)[2] = 
d©a
;

12396  
skb
;

12398 
∆a_put_Áûuª
:

12399 
	`k‰ì_skb
(
skb
);

12400  
NULL
;

12401 
	}
}

12403 
sk_buff
 *
	$__cfg80211_Æloc_evít_skb
(
wùhy
 *wiphy,

12404 
wúñess_dev
 *
wdev
,

12405 
∆80211_comm™ds
 
cmd
,

12406 
∆80211_©ås
 
©å
,

12407 
p‹tid
,

12408 
víd‹_evít_idx
,

12409 
≠¥oxÀn
, 
gÂ_t
 
gÂ
)

12411 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

12412 c⁄° 
∆80211_víd‹_cmd_öfo
 *
öfo
;

12414 
cmd
) {

12415 
NL80211_CMD_TESTMODE
:

12416 i‡(
	`WARN_ON
(
víd‹_evít_idx
 != -1))

12417  
NULL
;

12418 
öfo
 = 
NULL
;

12420 
NL80211_CMD_VENDOR
:

12421 i‡(
	`WARN_ON
(
víd‹_evít_idx
 < 0 ||

12422 
víd‹_evít_idx
 >
wùhy
->
n_víd‹_evíts
))

12423  
NULL
;

12424 
öfo
 = &
wùhy
->
víd‹_evíts
[
víd‹_evít_idx
];

12427 
	`WARN_ON
(1);

12428  
NULL
;

12431  
	`__cfg80211_Æloc_víd‹_skb
(
rdev
, 
wdev
, 
≠¥oxÀn
, 
p‹tid
, 0,

12432 
cmd
, 
©å
, 
öfo
, 
gÂ
);

12433 
	}
}

12434 
EXPORT_SYMBOL
(
__cfg80211_Æloc_evít_skb
);

12436 
	$__cfg80211_£nd_evít_skb
(
sk_buff
 *
skb
, 
gÂ_t
 
gÂ
)

12438 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = ((**)
skb
->
cb
)[0];

12439 *
hdr
 = ((**)
skb
->
cb
)[1];

12440 
∆msghdr
 *
∆hdr
 = 
	`∆msg_hdr
(
skb
);

12441 
∆©å
 *
d©a
 = ((**)
skb
->
cb
)[2];

12442 
∆80211_mu…iˇ°_groups
 
mcgΩ
 = 
NL80211_MCGRP_TESTMODE
;

12445 
	`mem£t
(
skb
->
cb
, 0, (skb->cb));

12447 
	`∆a_√°_íd
(
skb
, 
d©a
);

12448 
	`gílmsg_íd
(
skb
, 
hdr
);

12450 i‡(
∆hdr
->
∆msg_pid
) {

12451 
	`gílmsg_uniˇ°
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
skb
,

12452 
∆hdr
->
∆msg_pid
);

12454 i‡(
d©a
->
∆a_ty≥
 =
NL80211_ATTR_VENDOR_DATA
)

12455 
mcgΩ
 = 
NL80211_MCGRP_VENDOR
;

12457 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
),

12458 
skb
, 0, 
mcgΩ
, 
gÂ
);

12460 
	}
}

12461 
EXPORT_SYMBOL
(
__cfg80211_£nd_evít_skb
);

12463 #ifde‡
CONFIG_NL80211_TESTMODE


12464 
	$∆80211_ã°mode_do
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

12466 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

12467 
wúñess_dev
 *
wdev
;

12468 
îr
;

12470 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

12472 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

12474 
wdev
 = 
	`__cfg80211_wdev_‰om_©ås
(
rdev
, 
	`gíl_öfo_√t
(
öfo
),

12475 
öfo
->
©ås
);

12477 i‡(!
rdev
->
›s
->
ã°mode_cmd
) {

12478 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12479  -
EOPNOTSUPP
;

12482 i‡(
	`IS_ERR
(
wdev
)) {

12483 
îr
 = 
	`PTR_ERR
(
wdev
);

12484 i‡(
îr
 !-
EINVAL
) {

12485 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12486  
îr
;

12488 
wdev
 = 
NULL
;

12489 } i‡(
wdev
->
wùhy
 !&
rdev
->wiphy) {

12490 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12491  -
EINVAL
;

12494 i‡(!
öfo
->
©ås
[
NL80211_ATTR_TESTDATA
]) {

12495 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12496  -
EINVAL
;

12499 
rdev
->
cur_cmd_öfo
 = 
öfo
;

12500 
îr
 = 
	`rdev_ã°mode_cmd
(
rdev
, 
wdev
,

12501 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_TESTDATA
]),

12502 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_TESTDATA
]));

12503 
rdev
->
cur_cmd_öfo
 = 
NULL
;

12505 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12506  
îr
;

12507 
	}
}

12509 
	$∆80211_ã°mode_dump
(
sk_buff
 *
skb
,

12510 
√éök_ˇŒback
 *
cb
)

12512 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

12513 
∆©å
 **
©åbuf
 = 
NULL
;

12514 
îr
;

12515 
phy_idx
;

12516 *
d©a
 = 
NULL
;

12517 
d©a_Àn
 = 0;

12519 
	`π∆_lock
();

12521 i‡(
cb
->
¨gs
[0]) {

12526 
phy_idx
 = 
cb
->
¨gs
[0] - 1;

12528 
rdev
 = 
	`cfg80211_rdev_by_wùhy_idx
(
phy_idx
);

12529 i‡(!
rdev
) {

12530 
îr
 = -
ENOENT
;

12531 
out_îr
;

12534 
©åbuf
 = 
	`kˇŒoc
(
NUM_NL80211_ATTR
, (*attrbuf),

12535 
GFP_KERNEL
);

12536 i‡(!
©åbuf
) {

12537 
îr
 = -
ENOMEM
;

12538 
out_îr
;

12541 
îr
 = 
	`∆msg_∑r£_dïªˇãd
(
cb
->
∆h
,

12542 
GENL_HDRLEN
 + 
∆80211_Ám
.
hdrsize
,

12543 
©åbuf
, 
∆80211_Ám
.
max©å
,

12544 
∆80211_pﬁicy
, 
NULL
);

12545 i‡(
îr
)

12546 
out_îr
;

12548 
rdev
 = 
	`__cfg80211_rdev_‰om_©ås
(
	`sock_√t
(
skb
->
sk
), 
©åbuf
);

12549 i‡(
	`IS_ERR
(
rdev
)) {

12550 
îr
 = 
	`PTR_ERR
(
rdev
);

12551 
out_îr
;

12553 
phy_idx
 = 
rdev
->
wùhy_idx
;

12555 i‡(
©åbuf
[
NL80211_ATTR_TESTDATA
])

12556 
cb
->
¨gs
[1] = ()
©åbuf
[
NL80211_ATTR_TESTDATA
];

12559 i‡(
cb
->
¨gs
[1]) {

12560 
d©a
 = 
	`∆a_d©a
((*)
cb
->
¨gs
[1]);

12561 
d©a_Àn
 = 
	`∆a_Àn
((*)
cb
->
¨gs
[1]);

12564 i‡(!
rdev
->
›s
->
ã°mode_dump
) {

12565 
îr
 = -
EOPNOTSUPP
;

12566 
out_îr
;

12570 *
hdr
 = 
	`∆80211hdr_put
(
skb
, 
	`NETLINK_CB
(
cb
->skb).
p‹tid
,

12571 
cb
->
∆h
->
∆msg_£q
, 
NLM_F_MULTI
,

12572 
NL80211_CMD_TESTMODE
);

12573 
∆©å
 *
tmd©a
;

12575 i‡(!
hdr
)

12578 i‡(
	`∆a_put_u32
(
skb
, 
NL80211_ATTR_WIPHY
, 
phy_idx
)) {

12579 
	`gílmsg_ˇn˚l
(
skb
, 
hdr
);

12583 
tmd©a
 = 
	`∆a_√°_°¨t_noÊag
(
skb
, 
NL80211_ATTR_TESTDATA
);

12584 i‡(!
tmd©a
) {

12585 
	`gílmsg_ˇn˚l
(
skb
, 
hdr
);

12588 
îr
 = 
	`rdev_ã°mode_dump
(
rdev
, 
skb
, 
cb
, 
d©a
, 
d©a_Àn
);

12589 
	`∆a_√°_íd
(
skb
, 
tmd©a
);

12591 i‡(
îr
 =-
ENOBUFS
 ||Éº =-
ENOENT
) {

12592 
	`gílmsg_ˇn˚l
(
skb
, 
hdr
);

12594 } i‡(
îr
) {

12595 
	`gílmsg_ˇn˚l
(
skb
, 
hdr
);

12596 
out_îr
;

12599 
	`gílmsg_íd
(
skb
, 
hdr
);

12602 
îr
 = 
skb
->
Àn
;

12604 
cb
->
¨gs
[0] = 
phy_idx
 + 1;

12605 
out_îr
:

12606 
	`k‰ì
(
©åbuf
);

12607 
	`π∆_u∆ock
();

12608  
îr
;

12609 
	}
}

12612 
	$∆80211_c⁄√˘
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

12614 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

12615 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

12616 
cfg80211_c⁄√˘_∑øms
 
c⁄√˘
;

12617 
wùhy
 *wiphy;

12618 
cfg80211_ˇched_keys
 *
c⁄nkeys
 = 
NULL
;

12619 
u32
 
‰eq
 = 0;

12620 
îr
;

12622 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

12623 
	`mem£t
(&
c⁄√˘
, 0, (connect));

12625 i‡(!
öfo
->
©ås
[
NL80211_ATTR_SSID
] ||

12626 !
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_SSID
])) {

12627 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12628  -
EINVAL
;

12631 i‡(
öfo
->
©ås
[
NL80211_ATTR_AUTH_TYPE
]) {

12632 
c⁄√˘
.
auth_ty≥
 =

12633 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_AUTH_TYPE
]);

12634 i‡(!
	`∆80211_vÆid_auth_ty≥
(
rdev
, 
c⁄√˘
.
auth_ty≥
,

12635 
NL80211_CMD_CONNECT
)) {

12636 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12637  -
EINVAL
;

12640 
c⁄√˘
.
auth_ty≥
 = 
NL80211_AUTHTYPE_AUTOMATIC
;

12642 
c⁄√˘
.
¥ivacy
 = 
öfo
->
©ås
[
NL80211_ATTR_PRIVACY
];

12644 i‡(
öfo
->
©ås
[
NL80211_ATTR_WANT_1X_4WAY_HS
] &&

12645 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

12646 
NL80211_EXT_FEATURE_4WAY_HANDSHAKE_STA_1X
)) {

12647 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12648  -
EINVAL
;

12650 
c⁄√˘
.
w™t_1x
 = 
öfo
->
©ås
[
NL80211_ATTR_WANT_1X_4WAY_HS
];

12652 
îr
 = 
	`∆80211_¸y±o_£âögs
(
rdev
, 
öfo
, &
c⁄√˘
.
¸y±o
,

12653 
NL80211_MAX_NR_CIPHER_SUITES
);

12654 i‡(
îr
) {

12655 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12656  
îr
;

12659 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

12660 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
) {

12661 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12662  -
EOPNOTSUPP
;

12665 
wùhy
 = &
rdev
->wiphy;

12667 
c⁄√˘
.
bg_sˇn_≥riod
 = -1;

12668 i‡(
öfo
->
©ås
[
NL80211_ATTR_BG_SCAN_PERIOD
] &&

12669 (
wùhy
->
Êags
 & 
WIPHY_FLAG_SUPPORTS_FW_ROAM
)) {

12670 
c⁄√˘
.
bg_sˇn_≥riod
 =

12671 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_BG_SCAN_PERIOD
]);

12674 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
])

12675 
c⁄√˘
.
bssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

12676 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC_HINT
])

12677 
c⁄√˘
.
bssid_höt
 =

12678 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC_HINT
]);

12679 
c⁄√˘
.
ssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

12680 
c⁄√˘
.
ssid_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

12682 i‡(
öfo
->
©ås
[
NL80211_ATTR_IE
]) {

12683 
c⁄√˘
.
õ
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

12684 
c⁄√˘
.
õ_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

12687 i‡(
öfo
->
©ås
[
NL80211_ATTR_USE_MFP
]) {

12688 
c⁄√˘
.
mÂ
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_USE_MFP
]);

12689 i‡(
c⁄√˘
.
mÂ
 =
NL80211_MFP_OPTIONAL
 &&

12690 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

12691 
NL80211_EXT_FEATURE_MFP_OPTIONAL
)) {

12692 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12693  -
EOPNOTSUPP
;

12696 
c⁄√˘
.
mÂ
 = 
NL80211_MFP_NO
;

12699 i‡(
öfo
->
©ås
[
NL80211_ATTR_PREV_BSSID
])

12700 
c⁄√˘
.
¥ev_bssid
 =

12701 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_PREV_BSSID
]);

12703 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
])

12704 
‰eq
 = 
	`MHZ_TO_KHZ
(
	`∆a_gë_u32
(

12705 
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
]));

12706 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ_OFFSET
])

12707 
‰eq
 +=

12708 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ_OFFSET
]);

12710 i‡(
‰eq
) {

12711 
c⁄√˘
.
ch™√l
 = 
	`∆80211_gë_vÆid_ch™
(
wùhy
, 
‰eq
);

12712 i‡(!
c⁄√˘
.
ch™√l
) {

12713 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12714  -
EINVAL
;

12716 } i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ_HINT
]) {

12717 
‰eq
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ_HINT
]);

12718 
‰eq
 = 
	`MHZ_TO_KHZ
(freq);

12719 
c⁄√˘
.
ch™√l_höt
 = 
	`∆80211_gë_vÆid_ch™
(
wùhy
, 
‰eq
);

12720 i‡(!
c⁄√˘
.
ch™√l_höt
) {

12721 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12722  -
EINVAL
;

12726 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_EDMG_CHANNELS
]) {

12727 
c⁄√˘
.
edmg
.
ch™√ls
 =

12728 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_EDMG_CHANNELS
]);

12730 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_EDMG_BW_CONFIG
])

12731 
c⁄√˘
.
edmg
.
bw_c⁄fig
 =

12732 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_EDMG_BW_CONFIG
]);

12735 i‡(
c⁄√˘
.
¥ivacy
 && 
öfo
->
©ås
[
NL80211_ATTR_KEYS
]) {

12736 
c⁄nkeys
 = 
	`∆80211_∑r£_c⁄nkeys
(
rdev
, 
öfo
, 
NULL
);

12737 i‡(
	`IS_ERR
(
c⁄nkeys
)) {

12738 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12739  
	`PTR_ERR
(
c⁄nkeys
);

12743 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_DISABLE_HT
]))

12744 
c⁄√˘
.
Êags
 |
ASSOC_REQ_DISABLE_HT
;

12746 i‡(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY_MASK
])

12747 
	`mem˝y
(&
c⁄√˘
.
ht_ˇ∑_mask
,

12748 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY_MASK
]),

12749 (
c⁄√˘
.
ht_ˇ∑_mask
));

12751 i‡(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
]) {

12752 i‡(!
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY_MASK
]) {

12753 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12754 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12755  -
EINVAL
;

12757 
	`mem˝y
(&
c⁄√˘
.
ht_ˇ∑
,

12758 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
]),

12759 (
c⁄√˘
.
ht_ˇ∑
));

12762 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_DISABLE_VHT
]))

12763 
c⁄√˘
.
Êags
 |
ASSOC_REQ_DISABLE_VHT
;

12765 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_DISABLE_HE
]))

12766 
c⁄√˘
.
Êags
 |
ASSOC_REQ_DISABLE_HE
;

12768 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_DISABLE_EHT
]))

12769 
c⁄√˘
.
Êags
 |
ASSOC_REQ_DISABLE_EHT
;

12771 i‡(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY_MASK
])

12772 
	`mem˝y
(&
c⁄√˘
.
vht_ˇ∑_mask
,

12773 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY_MASK
]),

12774 (
c⁄√˘
.
vht_ˇ∑_mask
));

12776 i‡(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY
]) {

12777 i‡(!
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY_MASK
]) {

12778 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12779 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12780  -
EINVAL
;

12782 
	`mem˝y
(&
c⁄√˘
.
vht_ˇ∑
,

12783 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY
]),

12784 (
c⁄√˘
.
vht_ˇ∑
));

12787 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_USE_RRM
])) {

12788 i‡(!((
rdev
->
wùhy
.
„©uªs
 &

12789 
NL80211_FEATURE_DS_PARAM_SET_IE_IN_PROBES
) &&

12790 (
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_QUIET
)) &&

12791 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

12792 
NL80211_EXT_FEATURE_RRM
)) {

12793 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12794 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12795  -
EINVAL
;

12797 
c⁄√˘
.
Êags
 |
ASSOC_REQ_USE_RRM
;

12800 
c⁄√˘
.
pbss
 = 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_PBSS
]);

12801 i‡(
c⁄√˘
.
pbss
 && !
rdev
->
wùhy
.
b™ds
[
NL80211_BAND_60GHZ
]) {

12802 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12803 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12804  -
EOPNOTSUPP
;

12807 i‡(
öfo
->
©ås
[
NL80211_ATTR_BSS_SELECT
]) {

12809 i‡(
c⁄√˘
.
bssid
) {

12810 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12811 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12812  -
EINVAL
;

12815 
îr
 = 
	`∑r£_bss_£À˘
(
öfo
->
©ås
[
NL80211_ATTR_BSS_SELECT
],

12816 
wùhy
, &
c⁄√˘
.
bss_£À˘
);

12817 i‡(
îr
) {

12818 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12819 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12820  
îr
;

12824 i‡(
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

12825 
NL80211_EXT_FEATURE_FILS_SK_OFFLOAD
) &&

12826 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_USERNAME
] &&

12827 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_REALM
] &&

12828 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
] &&

12829 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_RRK
]) {

12830 
c⁄√˘
.
fûs_îp_u£∫ame
 =

12831 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_USERNAME
]);

12832 
c⁄√˘
.
fûs_îp_u£∫ame_Àn
 =

12833 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_USERNAME
]);

12834 
c⁄√˘
.
fûs_îp_ªÆm
 =

12835 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_REALM
]);

12836 
c⁄√˘
.
fûs_îp_ªÆm_Àn
 =

12837 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_REALM
]);

12838 
c⁄√˘
.
fûs_îp_√xt_£q_num
 =

12839 
	`∆a_gë_u16
(

12840 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
]);

12841 
c⁄√˘
.
fûs_îp_ºk
 =

12842 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_RRK
]);

12843 
c⁄√˘
.
fûs_îp_ºk_Àn
 =

12844 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_RRK
]);

12845 } i‡(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_USERNAME
] ||

12846 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_REALM
] ||

12847 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
] ||

12848 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_RRK
]) {

12849 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12850 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12851  -
EINVAL
;

12854 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_EXTERNAL_AUTH_SUPPORT
])) {

12855 i‡(!
öfo
->
©ås
[
NL80211_ATTR_SOCKET_OWNER
]) {

12856 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12857 
	`GENL_SET_ERR_MSG
(
öfo
,

12859 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12860  -
EINVAL
;

12862 
c⁄√˘
.
Êags
 |
CONNECT_REQ_EXTERNAL_AUTH_SUPPORT
;

12865 i‡(
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_MLO_SUPPORT
]))

12866 
c⁄√˘
.
Êags
 |
CONNECT_REQ_MLO_SUPPORT
;

12868 
îr
 = 
	`cfg80211_c⁄√˘
(
rdev
, 
dev
, &
c⁄√˘
, 
c⁄nkeys
,

12869 
c⁄√˘
.
¥ev_bssid
);

12870 i‡(
îr
)

12871 
	`k‰ì_£nsôive
(
c⁄nkeys
);

12873 i‡(!
îr
 && 
öfo
->
©ås
[
NL80211_ATTR_SOCKET_OWNER
]) {

12874 
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 = 
öfo
->
¢d_p‹tid
;

12875 i‡(
c⁄√˘
.
bssid
)

12876 
	`mem˝y
(
dev
->
õì80211_±r
->
disc⁄√˘_bssid
,

12877 
c⁄√˘
.
bssid
, 
ETH_ALEN
);

12879 
	`ëh_zîo_addr
(
dev
->
õì80211_±r
->
disc⁄√˘_bssid
);

12882 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12883  
îr
;

12884 
	}
}

12886 
	$∆80211_upd©e_c⁄√˘_∑øms
(
sk_buff
 *
skb
,

12887 
gíl_öfo
 *
öfo
)

12889 
cfg80211_c⁄√˘_∑øms
 
c⁄√˘
 = {};

12890 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

12891 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

12892 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

12893 
boﬁ
 
fûs_sk_ofÊﬂd
;

12894 
u32
 
auth_ty≥
;

12895 
u32
 
ch™ged
 = 0;

12897 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

12899 i‡(!
rdev
->
›s
->
upd©e_c⁄√˘_∑øms
) {

12900 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12901  -
EOPNOTSUPP
;

12904 i‡(
öfo
->
©ås
[
NL80211_ATTR_IE
]) {

12905 
c⁄√˘
.
õ
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

12906 
c⁄√˘
.
õ_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

12907 
ch™ged
 |
UPDATE_ASSOC_IES
;

12910 
fûs_sk_ofÊﬂd
 = 
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

12911 
NL80211_EXT_FEATURE_FILS_SK_OFFLOAD
);

12918 i‡(
fûs_sk_ofÊﬂd
 &&

12919 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_USERNAME
] &&

12920 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_REALM
] &&

12921 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
] &&

12922 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_RRK
]) {

12923 
c⁄√˘
.
fûs_îp_u£∫ame
 =

12924 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_USERNAME
]);

12925 
c⁄√˘
.
fûs_îp_u£∫ame_Àn
 =

12926 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_USERNAME
]);

12927 
c⁄√˘
.
fûs_îp_ªÆm
 =

12928 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_REALM
]);

12929 
c⁄√˘
.
fûs_îp_ªÆm_Àn
 =

12930 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_REALM
]);

12931 
c⁄√˘
.
fûs_îp_√xt_£q_num
 =

12932 
	`∆a_gë_u16
(

12933 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
]);

12934 
c⁄√˘
.
fûs_îp_ºk
 =

12935 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_RRK
]);

12936 
c⁄√˘
.
fûs_îp_ºk_Àn
 =

12937 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_RRK
]);

12938 
ch™ged
 |
UPDATE_FILS_ERP_INFO
;

12939 } i‡(
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_USERNAME
] ||

12940 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_REALM
] ||

12941 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
] ||

12942 
öfo
->
©ås
[
NL80211_ATTR_FILS_ERP_RRK
]) {

12943 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12944  -
EINVAL
;

12947 i‡(
öfo
->
©ås
[
NL80211_ATTR_AUTH_TYPE
]) {

12948 
auth_ty≥
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_AUTH_TYPE
]);

12949 i‡(!
	`∆80211_vÆid_auth_ty≥
(
rdev
, 
auth_ty≥
,

12950 
NL80211_CMD_CONNECT
)) {

12951 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12952  -
EINVAL
;

12955 i‡(
auth_ty≥
 =
NL80211_AUTHTYPE_FILS_SK
 &&

12956 
fûs_sk_ofÊﬂd
 && !(
ch™ged
 & 
UPDATE_FILS_ERP_INFO
)) {

12957  -
EINVAL
;

12960 
c⁄√˘
.
auth_ty≥
 =áuth_type;

12961 
ch™ged
 |
UPDATE_AUTH_TYPE
;

12964 i‡(!
wdev
->
c⁄√˘ed
) {

12965 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12966  -
ENOLINK
;

12969 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12970  
	`rdev_upd©e_c⁄√˘_∑øms
(
rdev
, 
dev
, &
c⁄√˘
, 
ch™ged
);

12971 
	}
}

12973 
	$∆80211_disc⁄√˘
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

12975 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

12976 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

12977 
u16
 
ªas⁄
;

12979 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

12981 i‡(
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 &&

12982 
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 !
öfo
->
¢d_p‹tid
) {

12983 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12984  -
EPERM
;

12987 i‡(!
öfo
->
©ås
[
NL80211_ATTR_REASON_CODE
])

12988 
ªas⁄
 = 
WLAN_REASON_DEAUTH_LEAVING
;

12990 
ªas⁄
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_REASON_CODE
]);

12992 i‡(
ªas⁄
 == 0) {

12993 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

12994  -
EINVAL
;

12997 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

12998 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
) {

12999 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13000  -
EOPNOTSUPP
;

13003 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13004  
	`cfg80211_disc⁄√˘
(
rdev
, 
dev
, 
ªas⁄
, 
åue
);

13005 
	}
}

13007 
	$∆80211_wùhy_√äs
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13009 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13010 
√t
 *net;

13011 
îr
;

13013 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13015 i‡(
öfo
->
©ås
[
NL80211_ATTR_PID
]) {

13016 
u32
 
pid
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_PID
]);

13018 
√t
 = 
	`gë_√t_ns_by_pid
(
pid
);

13019 } i‡(
öfo
->
©ås
[
NL80211_ATTR_NETNS_FD
]) {

13020 
u32
 
fd
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_NETNS_FD
]);

13022 
√t
 = 
	`gë_√t_ns_by_fd
(
fd
);

13024 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13025  -
EINVAL
;

13028 i‡(
	`IS_ERR
(
√t
)) {

13029 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13030  
	`PTR_ERR
(
√t
);

13033 
îr
 = 0;

13036 i‡(!
	`√t_eq
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
√t
))

13037 
îr
 = 
	`cfg80211_swôch_√äs
(
rdev
, 
√t
);

13039 
	`put_√t
(
√t
);

13040 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13041  
îr
;

13042 
	}
}

13044 
	$∆80211_£t_pmkß
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13046 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13047 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

13048 
cfg80211_pmkß
 
pmkß
;

13049 
boﬁ
 
≠_pmkß_ˇchög_suµ‹t
 = 
Ál£
;

13051 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13053 
	`mem£t
(&
pmkß
, 0, (
cfg80211_pmkß
));

13055 
≠_pmkß_ˇchög_suµ‹t
 = 
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

13056 
NL80211_EXT_FEATURE_AP_PMKSA_CACHING
);

13058 i‡(!
öfo
->
©ås
[
NL80211_ATTR_PMKID
]) {

13059 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13060  -
EINVAL
;

13063 
pmkß
.
pmkid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_PMKID
]);

13065 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

13066 
pmkß
.
bssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

13067 } i‡(
öfo
->
©ås
[
NL80211_ATTR_SSID
] &&

13068 
öfo
->
©ås
[
NL80211_ATTR_FILS_CACHE_ID
] &&

13069 
öfo
->
©ås
[
NL80211_ATTR_PMK
]) {

13070 
pmkß
.
ssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

13071 
pmkß
.
ssid_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

13072 
pmkß
.
ˇche_id
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_CACHE_ID
]);

13074 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13075  -
EINVAL
;

13078 i‡(
öfo
->
©ås
[
NL80211_ATTR_PMK
]) {

13079 
pmkß
.
pmk
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_PMK
]);

13080 
pmkß
.
pmk_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_PMK
]);

13083 i‡(
öfo
->
©ås
[
NL80211_ATTR_PMK_LIFETIME
])

13084 
pmkß
.
pmk_li„time
 =

13085 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_PMK_LIFETIME
]);

13087 i‡(
öfo
->
©ås
[
NL80211_ATTR_PMK_REAUTH_THRESHOLD
])

13088 
pmkß
.
pmk_ªauth_thªshﬁd
 =

13089 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_PMK_REAUTH_THRESHOLD
]);

13091 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

13092 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
 &&

13093 !((
dev
->
õì80211_±r
->
i·y≥
 =
NL80211_IFTYPE_AP
 ||

13094 
dev
->
õì80211_±r
->
i·y≥
 =
NL80211_IFTYPE_P2P_GO
) &&

13095 
≠_pmkß_ˇchög_suµ‹t
)) {

13096 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13097  -
EOPNOTSUPP
;

13100 i‡(!
rdev
->
›s
->
£t_pmkß
) {

13101 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13102  -
EOPNOTSUPP
;

13105 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13106  
	`rdev_£t_pmkß
(
rdev
, 
dev
, &
pmkß
);

13107 
	}
}

13109 
	$∆80211_dñ_pmkß
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13111 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13112 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

13113 
cfg80211_pmkß
 
pmkß
;

13114 
boﬁ
 
ße_ofÊﬂd_suµ‹t
 = 
Ál£
;

13115 
boﬁ
 
owe_ofÊﬂd_suµ‹t
 = 
Ál£
;

13116 
boﬁ
 
≠_pmkß_ˇchög_suµ‹t
 = 
Ál£
;

13118 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13120 
	`mem£t
(&
pmkß
, 0, (
cfg80211_pmkß
));

13122 
ße_ofÊﬂd_suµ‹t
 = 
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

13123 
NL80211_EXT_FEATURE_SAE_OFFLOAD
);

13124 
owe_ofÊﬂd_suµ‹t
 = 
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

13125 
NL80211_EXT_FEATURE_OWE_OFFLOAD
);

13126 
≠_pmkß_ˇchög_suµ‹t
 = 
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

13127 
NL80211_EXT_FEATURE_AP_PMKSA_CACHING
);

13129 i‡(
öfo
->
©ås
[
NL80211_ATTR_PMKID
])

13130 
pmkß
.
pmkid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_PMKID
]);

13132 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

13133 
pmkß
.
bssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

13134 } i‡(
öfo
->
©ås
[
NL80211_ATTR_SSID
]) {

13138 i‡(
öfo
->
©ås
[
NL80211_ATTR_FILS_CACHE_ID
] &&

13139 
öfo
->
©ås
[
NL80211_ATTR_PMK
]) {

13140 
pmkß
.
ˇche_id
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_CACHE_ID
]);

13141 } i‡(!
ße_ofÊﬂd_suµ‹t
 && !
owe_ofÊﬂd_suµ‹t
) {

13142 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13143  -
EINVAL
;

13145 
pmkß
.
ssid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

13146 
pmkß
.
ssid_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

13148 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13149  -
EINVAL
;

13152 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

13153 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
 &&

13154 !((
dev
->
õì80211_±r
->
i·y≥
 =
NL80211_IFTYPE_AP
 ||

13155 
dev
->
õì80211_±r
->
i·y≥
 =
NL80211_IFTYPE_P2P_GO
) &&

13156 
≠_pmkß_ˇchög_suµ‹t
)) {

13157 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13158  -
EOPNOTSUPP
;

13161 i‡(!
rdev
->
›s
->
dñ_pmkß
) {

13162 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13163  -
EOPNOTSUPP
;

13166 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13167  
	`rdev_dñ_pmkß
(
rdev
, 
dev
, &
pmkß
);

13168 
	}
}

13170 
	$∆80211_Êush_pmkß
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13172 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13173 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

13175 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

13177 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

13178 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
) {

13179 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13180  -
EOPNOTSUPP
;

13183 i‡(!
rdev
->
›s
->
Êush_pmkß
) {

13184 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

13185  -
EOPNOTSUPP
;

13188 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13189  
	`rdev_Êush_pmkß
(
rdev
, 
dev
);

13190 
	}
}

13192 
	$∆80211_tdls_mgmt
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13194 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13195 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

13196 
u8
 
a˘i⁄_code
, 
dülog_tokí
;

13197 
u32
 
≥î_ˇ∑bûôy
 = 0;

13198 
u16
 
°©us_code
;

13199 
u8
 *
≥î
;

13200 
lök_id
;

13201 
boﬁ
 
öôüt‹
;

13203 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13205 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_TDLS
) ||

13206 !
rdev
->
›s
->
tdls_mgmt
) {

13207 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13208  -
EOPNOTSUPP
;

13211 i‡(!
öfo
->
©ås
[
NL80211_ATTR_TDLS_ACTION
] ||

13212 !
öfo
->
©ås
[
NL80211_ATTR_STATUS_CODE
] ||

13213 !
öfo
->
©ås
[
NL80211_ATTR_TDLS_DIALOG_TOKEN
] ||

13214 !
öfo
->
©ås
[
NL80211_ATTR_IE
] ||

13215 !
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

13216 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13217  -
EINVAL
;

13220 
≥î
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

13221 
a˘i⁄_code
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_TDLS_ACTION
]);

13222 
°©us_code
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_STATUS_CODE
]);

13223 
dülog_tokí
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_TDLS_DIALOG_TOKEN
]);

13224 
öôüt‹
 = 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_TDLS_INITIATOR
]);

13225 i‡(
öfo
->
©ås
[
NL80211_ATTR_TDLS_PEER_CAPABILITY
])

13226 
≥î_ˇ∑bûôy
 =

13227 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_TDLS_PEER_CAPABILITY
]);

13228 
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

13230 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13231  
	`rdev_tdls_mgmt
(
rdev
, 
dev
, 
≥î
, 
lök_id
, 
a˘i⁄_code
,

13232 
dülog_tokí
, 
°©us_code
, 
≥î_ˇ∑bûôy
,

13233 
öôüt‹
,

13234 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IE
]),

13235 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]));

13236 
	}
}

13238 
	$∆80211_tdls_›î
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13240 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13241 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

13242 
∆80211_tdls_›î©i⁄
 
›î©i⁄
;

13243 
u8
 *
≥î
;

13245 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13247 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_TDLS
) ||

13248 !
rdev
->
›s
->
tdls_›î
) {

13249 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13250  -
EOPNOTSUPP
;

13253 i‡(!
öfo
->
©ås
[
NL80211_ATTR_TDLS_OPERATION
] ||

13254 !
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

13255 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13256  -
EINVAL
;

13259 
›î©i⁄
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_TDLS_OPERATION
]);

13260 
≥î
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

13262 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13263  
	`rdev_tdls_›î
(
rdev
, 
dev
, 
≥î
, 
›î©i⁄
);

13264 
	}
}

13266 
	$∆80211_ªmaö_⁄_ch™√l
(
sk_buff
 *
skb
,

13267 
gíl_öfo
 *
öfo
)

13269 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13270 
lök_id
 = 
	`∆80211_lök_id
(
öfo
->
©ås
);

13271 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

13272 
cfg80211_ch™_def
 
ch™def
;

13273 
sk_buff
 *
msg
;

13274 *
hdr
;

13275 
u64
 
cookõ
;

13276 
u32
 
duøti⁄
;

13277 
îr
;

13279 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13281 i‡(!
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
] ||

13282 !
öfo
->
©ås
[
NL80211_ATTR_DURATION
]) {

13283 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13284  -
EINVAL
;

13287 
duøti⁄
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_DURATION
]);

13289 i‡(!
rdev
->
›s
->
ªmaö_⁄_ch™√l
 ||

13290 !(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_HAS_REMAIN_ON_CHANNEL
)) {

13291 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13292  -
EOPNOTSUPP
;

13299 i‡(
duøti⁄
 < 
NL80211_MIN_REMAIN_ON_CHANNEL_TIME
 ||

13300 
duøti⁄
 > 
rdev
->
wùhy
.
max_ªmaö_⁄_ch™√l_duøti⁄
) {

13301 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13302  -
EINVAL
;

13305 
îr
 = 
	`∆80211_∑r£_ch™def
(
rdev
, 
öfo
, &
ch™def
);

13306 i‡(
îr
) {

13307 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13308  
îr
;

13311 i‡(!
	`cfg80211_off_ch™√l_›î_Ælowed
(
wdev
, 
ch™def
.
ch™
)) {

13312 c⁄° 
cfg80211_ch™_def
 *
›î_ch™def
, *
com∑t_ch™def
;

13314 
›î_ch™def
 = 
	`wdev_ch™def
(
wdev
, 
lök_id
);

13316 i‡(
	`WARN_ON
(!
›î_ch™def
)) {

13318 
	`WARN_ON
(1);

13319 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13320  -
EBUSY
;

13324 
com∑t_ch™def
 = 
	`cfg80211_ch™def_com∑tibÀ
(&
ch™def
,

13325 
›î_ch™def
);

13327 i‡(
com∑t_ch™def
 !&
ch™def
) {

13328 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13329  -
EBUSY
;

13333 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

13334 i‡(!
msg
) {

13335 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13336  -
ENOMEM
;

13339 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

13340 
NL80211_CMD_REMAIN_ON_CHANNEL
);

13341 i‡(!
hdr
) {

13342 
îr
 = -
ENOBUFS
;

13343 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13344 
‰ì_msg
;

13347 
îr
 = 
	`rdev_ªmaö_⁄_ch™√l
(
rdev
, 
wdev
, 
ch™def
.
ch™
,

13348 
duøti⁄
, &
cookõ
);

13350 i‡(
îr
) {

13351 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13352 
‰ì_msg
;

13355 i‡(
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
cookõ
,

13356 
NL80211_ATTR_PAD
)) {

13357 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13358 
∆a_put_Áûuª
;

13361 
	`gílmsg_íd
(
msg
, 
hdr
);

13363 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13364  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

13366 
∆a_put_Áûuª
:

13367 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13368 
îr
 = -
ENOBUFS
;

13369 
‰ì_msg
:

13370 
	`∆msg_‰ì
(
msg
);

13371 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13372  
îr
;

13373 
	}
}

13375 
	$∆80211_ˇn˚l_ªmaö_⁄_ch™√l
(
sk_buff
 *
skb
,

13376 
gíl_öfo
 *
öfo
)

13378 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13379 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

13380 
u64
 
cookõ
;

13382 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13384 i‡(!
öfo
->
©ås
[
NL80211_ATTR_COOKIE
]) {

13385 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13386  -
EINVAL
;

13389 i‡(!
rdev
->
›s
->
ˇn˚l_ªmaö_⁄_ch™√l
) {

13390 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13391  -
EOPNOTSUPP
;

13394 
cookõ
 = 
	`∆a_gë_u64
(
öfo
->
©ås
[
NL80211_ATTR_COOKIE
]);

13396 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13397  
	`rdev_ˇn˚l_ªmaö_⁄_ch™√l
(
rdev
, 
wdev
, 
cookõ
);

13398 
	}
}

13400 
	$∆80211_£t_tx_bôøã_mask
(
sk_buff
 *
skb
,

13401 
gíl_öfo
 *
öfo
)

13403 
cfg80211_bôøã_mask
 
mask
;

13404 
lök_id
 = 
	`∆80211_lök_id
(
öfo
->
©ås
);

13405 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13406 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

13407 
îr
;

13409 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13411 i‡(!
rdev
->
›s
->
£t_bôøã_mask
) {

13412 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13413  -
EOPNOTSUPP
;

13416 
îr
 = 
	`∆80211_∑r£_tx_bôøã_mask
(
öfo
, info->
©ås
,

13417 
NL80211_ATTR_TX_RATES
, &
mask
,

13418 
dev
, 
åue
, 
lök_id
);

13419 i‡(
îr
) {

13420 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13421  
îr
;

13424 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13425  
	`rdev_£t_bôøã_mask
(
rdev
, 
dev
, 
lök_id
, 
NULL
, &
mask
);

13426 
	}
}

13428 
	$∆80211_ªgi°î_mgmt
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13430 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13431 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

13432 
u16
 
‰ame_ty≥
 = 
IEEE80211_FTYPE_MGMT
 | 
IEEE80211_STYPE_ACTION
;

13434 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

13436 i‡(!
öfo
->
©ås
[
NL80211_ATTR_FRAME_MATCH
]) {

13437 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

13438  -
EINVAL
;

13441 i‡(
öfo
->
©ås
[
NL80211_ATTR_FRAME_TYPE
])

13442 
‰ame_ty≥
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_FRAME_TYPE
]);

13444 
wdev
->
i·y≥
) {

13445 
NL80211_IFTYPE_STATION
:

13446 
NL80211_IFTYPE_ADHOC
:

13447 
NL80211_IFTYPE_P2P_CLIENT
:

13448 
NL80211_IFTYPE_AP
:

13449 
NL80211_IFTYPE_AP_VLAN
:

13450 
NL80211_IFTYPE_MESH_POINT
:

13451 
NL80211_IFTYPE_P2P_GO
:

13452 
NL80211_IFTYPE_P2P_DEVICE
:

13453 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

13455 
NL80211_IFTYPE_NAN
:

13456 i‡(!
	`wùhy_ext_„©uª_is£t
(
wdev
->
wùhy
,

13457 
NL80211_EXT_FEATURE_SECURE_NAN
)) {

13458 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

13459  -
EOPNOTSUPP
;

13461 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

13464 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

13465  -
EOPNOTSUPP
;

13469 i‡(!
rdev
->
›s
->
mgmt_tx
) {

13470 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

13471  -
EOPNOTSUPP
;

13474 i‡(
öfo
->
©ås
[
NL80211_ATTR_RECEIVE_MULTICAST
] &&

13475 !
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

13476 
NL80211_EXT_FEATURE_MULTICAST_REGISTRATIONS
)) {

13477 
	`GENL_SET_ERR_MSG
(
öfo
,

13479 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

13480  -
EOPNOTSUPP
;

13483 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

13484  
	`cfg80211_mlme_ªgi°î_mgmt
(
wdev
, 
öfo
->
¢d_p‹tid
, 
‰ame_ty≥
,

13485 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FRAME_MATCH
]),

13486 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FRAME_MATCH
]),

13487 
öfo
->
©ås
[
NL80211_ATTR_RECEIVE_MULTICAST
],

13488 
öfo
->
exèck
);

13489 
	}
}

13491 
	$∆80211_tx_mgmt
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13493 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13494 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

13495 
cfg80211_ch™_def
 
ch™def
;

13496 
îr
;

13497 *
hdr
 = 
NULL
;

13498 
u64
 
cookõ
;

13499 
sk_buff
 *
msg
 = 
NULL
;

13500 
cfg80211_mgmt_tx_∑øms
 
∑øms
 = {

13501 .
d⁄t_waô_f‹_ack
 =

13502 
öfo
->
©ås
[
NL80211_ATTR_DONT_WAIT_FOR_ACK
],

13505 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13507 i‡(!
öfo
->
©ås
[
NL80211_ATTR_FRAME
]) {

13508 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13509  -
EINVAL
;

13512 i‡(!
rdev
->
›s
->
mgmt_tx
) {

13513 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13514  -
EOPNOTSUPP
;

13517 
wdev
->
i·y≥
) {

13518 
NL80211_IFTYPE_P2P_DEVICE
:

13519 i‡(!
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
]) {

13520 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13521  -
EINVAL
;

13523 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13525 
NL80211_IFTYPE_STATION
:

13526 
NL80211_IFTYPE_ADHOC
:

13527 
NL80211_IFTYPE_P2P_CLIENT
:

13528 
NL80211_IFTYPE_AP
:

13529 
NL80211_IFTYPE_AP_VLAN
:

13530 
NL80211_IFTYPE_MESH_POINT
:

13531 
NL80211_IFTYPE_P2P_GO
:

13532 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13534 
NL80211_IFTYPE_NAN
:

13535 i‡(!
	`wùhy_ext_„©uª_is£t
(
wdev
->
wùhy
,

13536 
NL80211_EXT_FEATURE_SECURE_NAN
)) {

13537 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13538  -
EOPNOTSUPP
;

13540 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13543 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13544  -
EOPNOTSUPP
;

13547 i‡(
öfo
->
©ås
[
NL80211_ATTR_DURATION
]) {

13548 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_OFFCHAN_TX
)) {

13549 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13550  -
EINVAL
;

13552 
∑øms
.
waô
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_DURATION
]);

13558 i‡(
∑øms
.
waô
 < 
NL80211_MIN_REMAIN_ON_CHANNEL_TIME
 ||

13559 
∑øms
.
waô
 > 
rdev
->
wùhy
.
max_ªmaö_⁄_ch™√l_duøti⁄
) {

13560 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13561  -
EINVAL
;

13565 
∑øms
.
offch™
 = 
öfo
->
©ås
[
NL80211_ATTR_OFFCHANNEL_TX_OK
];

13567 i‡(
∑øms
.
offch™
 && !(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_OFFCHAN_TX
)) {

13568 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13569  -
EINVAL
;

13572 
∑øms
.
no_cck
 = 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_TX_NO_CCK_RATE
]);

13577 
ch™def
.
ch™
 = 
NULL
;

13578 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
]) {

13579 
îr
 = 
	`∆80211_∑r£_ch™def
(
rdev
, 
öfo
, &
ch™def
);

13580 i‡(
îr
) {

13581 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13582  
îr
;

13586 i‡(!
ch™def
.
ch™
 && 
∑øms
.
offch™
) {

13587 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13588  -
EINVAL
;

13591 i‡(
∑øms
.
offch™
 &&

13592 !
	`cfg80211_off_ch™√l_›î_Ælowed
(
wdev
, 
ch™def
.
ch™
)) {

13593 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13594  -
EBUSY
;

13597 
∑øms
.
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

13603 i‡(
∑øms
.
lök_id
 >= 0 &&

13604 !(
wdev
->
vÆid_löks
 & 
	`BIT
(
∑øms
.
lök_id
))) {

13605 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13606  -
EINVAL
;

13609 
∑øms
.
buf
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FRAME
]);

13610 
∑øms
.
Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FRAME
]);

13612 
îr
 = 
	`∆80211_∑r£_cou¡î_off£ts
(
rdev
, 
NULL
, 
∑øms
.
Àn
, -1,

13613 
öfo
->
©ås
[
NL80211_ATTR_CSA_C_OFFSETS_TX
],

13614 &
∑øms
.
cß_off£ts
,

13615 &
∑øms
.
n_cß_off£ts
);

13616 i‡(
îr
) {

13617 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13618  
îr
;

13621 i‡(!
∑øms
.
d⁄t_waô_f‹_ack
) {

13622 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

13623 i‡(!
msg
) {

13624 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13625  -
ENOMEM
;

13628 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

13629 
NL80211_CMD_FRAME
);

13630 i‡(!
hdr
) {

13631 
îr
 = -
ENOBUFS
;

13632 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13633 
‰ì_msg
;

13637 
∑øms
.
ch™
 = 
ch™def
.chan;

13638 
îr
 = 
	`cfg80211_mlme_mgmt_tx
(
rdev
, 
wdev
, &
∑øms
, &
cookõ
);

13639 i‡(
îr
) {

13640 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13641 
‰ì_msg
;

13644 i‡(
msg
) {

13645 i‡(
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
cookõ
,

13646 
NL80211_ATTR_PAD
)) {

13647 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13648 
∆a_put_Áûuª
;

13651 
	`gílmsg_íd
(
msg
, 
hdr
);

13652 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13653  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

13656 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13659 
∆a_put_Áûuª
:

13660 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13661 
îr
 = -
ENOBUFS
;

13662 
‰ì_msg
:

13663 
	`∆msg_‰ì
(
msg
);

13664 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13665  
îr
;

13666 
	}
}

13668 
	$∆80211_tx_mgmt_ˇn˚l_waô
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13670 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13671 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

13672 
u64
 
cookõ
;

13674 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13676 i‡(!
öfo
->
©ås
[
NL80211_ATTR_COOKIE
]) {

13677 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13678  -
EINVAL
;

13681 i‡(!
rdev
->
›s
->
mgmt_tx_ˇn˚l_waô
) {

13682 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13683  -
EOPNOTSUPP
;

13686 
wdev
->
i·y≥
) {

13687 
NL80211_IFTYPE_STATION
:

13688 
NL80211_IFTYPE_ADHOC
:

13689 
NL80211_IFTYPE_P2P_CLIENT
:

13690 
NL80211_IFTYPE_AP
:

13691 
NL80211_IFTYPE_AP_VLAN
:

13692 
NL80211_IFTYPE_P2P_GO
:

13693 
NL80211_IFTYPE_P2P_DEVICE
:

13694 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13696 
NL80211_IFTYPE_NAN
:

13697 i‡(!
	`wùhy_ext_„©uª_is£t
(
wdev
->
wùhy
,

13698 
NL80211_EXT_FEATURE_SECURE_NAN
)) {

13699 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13700  -
EOPNOTSUPP
;

13702 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13705 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13706  -
EOPNOTSUPP
;

13709 
cookõ
 = 
	`∆a_gë_u64
(
öfo
->
©ås
[
NL80211_ATTR_COOKIE
]);

13711 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13712  
	`rdev_mgmt_tx_ˇn˚l_waô
(
rdev
, 
wdev
, 
cookõ
);

13713 
	}
}

13715 
	$∆80211_£t_powî_ßve
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13717 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13718 
wúñess_dev
 *
wdev
;

13719 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

13720 
u8
 
ps_°©e
;

13721 
boﬁ
 
°©e
;

13722 
îr
;

13724 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13726 i‡(!
öfo
->
©ås
[
NL80211_ATTR_PS_STATE
]) {

13727 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13728  -
EINVAL
;

13731 
ps_°©e
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_PS_STATE
]);

13733 
wdev
 = 
dev
->
õì80211_±r
;

13735 i‡(!
rdev
->
›s
->
£t_powî_mgmt
) {

13736 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13737  -
EOPNOTSUPP
;

13740 
°©e
 = (
ps_°©e
 =
NL80211_PS_ENABLED
Ë? 
åue
 : 
Ál£
;

13742 i‡(
°©e
 =
wdev
->
ps
) {

13743 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13747 
îr
 = 
	`rdev_£t_powî_mgmt
(
rdev
, 
dev
, 
°©e
, 
wdev
->
ps_timeout
);

13748 i‡(!
îr
)

13749 
wdev
->
ps
 = 
°©e
;

13751 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13752  
îr
;

13753 
	}
}

13755 
	$∆80211_gë_powî_ßve
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13757 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13758 
∆80211_ps_°©e
 
ps_°©e
;

13759 
wúñess_dev
 *
wdev
;

13760 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

13761 
sk_buff
 *
msg
;

13762 *
hdr
;

13763 
îr
;

13765 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13767 
wdev
 = 
dev
->
õì80211_±r
;

13769 i‡(!
rdev
->
›s
->
£t_powî_mgmt
) {

13770 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13771  -
EOPNOTSUPP
;

13774 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

13775 i‡(!
msg
) {

13776 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13777  -
ENOMEM
;

13780 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

13781 
NL80211_CMD_GET_POWER_SAVE
);

13782 i‡(!
hdr
) {

13783 
îr
 = -
ENOBUFS
;

13784 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13785 
‰ì_msg
;

13788 i‡(
wdev
->
ps
)

13789 
ps_°©e
 = 
NL80211_PS_ENABLED
;

13791 
ps_°©e
 = 
NL80211_PS_DISABLED
;

13793 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_PS_STATE
, 
ps_°©e
)) {

13794 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13795 
∆a_put_Áûuª
;

13798 
	`gílmsg_íd
(
msg
, 
hdr
);

13799 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13800  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

13802 
∆a_put_Áûuª
:

13803 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13804 
îr
 = -
ENOBUFS
;

13805 
‰ì_msg
:

13806 
	`∆msg_‰ì
(
msg
);

13807 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13808  
îr
;

13809 
	}
}

13811 c⁄° 
∆a_pﬁicy


13812 
	g∆80211_©å_cqm_pﬁicy
[
NL80211_ATTR_CQM_MAX
 + 1] = {

13813 [
NL80211_ATTR_CQM_RSSI_THOLD
] = { .
ty≥
 = 
NLA_BINARY
 },

13814 [
NL80211_ATTR_CQM_RSSI_HYST
] = { .
ty≥
 = 
NLA_U32
 },

13815 [
NL80211_ATTR_CQM_RSSI_THRESHOLD_EVENT
] = { .
ty≥
 = 
NLA_U32
 },

13816 [
NL80211_ATTR_CQM_TXE_RATE
] = { .
ty≥
 = 
NLA_U32
 },

13817 [
NL80211_ATTR_CQM_TXE_PKTS
] = { .
ty≥
 = 
NLA_U32
 },

13818 [
NL80211_ATTR_CQM_TXE_INTVL
] = { .
ty≥
 = 
NLA_U32
 },

13819 [
NL80211_ATTR_CQM_RSSI_LEVEL
] = { .
ty≥
 = 
NLA_S32
 },

13822 
	$∆80211_£t_cqm_txe
(
gíl_öfo
 *
öfo
,

13823 
u32
 
øã
, u32 
pkts
, u32 
ötvl
)

13825 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13826 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

13827 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

13829 i‡(
øã
 > 100 || 
ötvl
 > 
NL80211_CQM_TXE_MAX_INTVL
)

13830  -
EINVAL
;

13832 i‡(!
rdev
->
›s
->
£t_cqm_txe_c⁄fig
)

13833  -
EOPNOTSUPP
;

13835 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

13836 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
)

13837  -
EOPNOTSUPP
;

13839  
	`rdev_£t_cqm_txe_c⁄fig
(
rdev
, 
dev
, 
øã
, 
pkts
, 
ötvl
);

13840 
	}
}

13842 
	$cfg80211_cqm_rssi_upd©e
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

13843 
√t_devi˚
 *
dev
,

13844 
cfg80211_cqm_c⁄fig
 *
cqm_c⁄fig
)

13846 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

13847 
s32
 
œ°
, 
low
, 
high
;

13848 
u32
 
hy°
;

13849 
i
, 
n
, 
low_ödex
;

13850 
îr
;

13858 i‡(!
cqm_c⁄fig
->
œ°_rssi_evít_vÆue
 &&

13859 
wdev
->
löks
[0].
˛õ¡
.
cuºít_bss
 &&

13860 
rdev
->
›s
->
gë_°©i⁄
) {

13861 
°©i⁄_öfo
 
söfo
 = {};

13862 
u8
 *
mac_addr
;

13864 
mac_addr
 = 
wdev
->
löks
[0].
˛õ¡
.
cuºít_bss
->
pub
.
bssid
;

13866 
îr
 = 
	`rdev_gë_°©i⁄
(
rdev
, 
dev
, 
mac_addr
, &
söfo
);

13867 i‡(
îr
)

13868  
îr
;

13870 
	`cfg80211_söfo_ªÀa£_c⁄ã¡
(&
söfo
);

13871 i‡(
söfo
.
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_BEACON_SIGNAL_AVG
))

13872 
cqm_c⁄fig
->
œ°_rssi_evít_vÆue
 =

13873 (
s8
Ë
söfo
.
rx_bóc⁄_sig«l_avg
;

13876 
œ°
 = 
cqm_c⁄fig
->
œ°_rssi_evít_vÆue
;

13877 
hy°
 = 
cqm_c⁄fig
->
rssi_hy°
;

13878 
n
 = 
cqm_c⁄fig
->
n_rssi_thªshﬁds
;

13880 
i
 = 0; i < 
n
; i++) {

13881 
i
 = 
	`¨øy_ödex_no•ec
(i, 
n
);

13882 i‡(
œ°
 < 
cqm_c⁄fig
->
rssi_thªshﬁds
[
i
])

13886 
low_ödex
 = 
i
 - 1;

13887 i‡(
low_ödex
 >= 0) {

13888 
low_ödex
 = 
	`¨øy_ödex_no•ec
÷ow_ödex, 
n
);

13889 
low
 = 
cqm_c⁄fig
->
rssi_thªshﬁds
[
low_ödex
] - 
hy°
;

13891 
low
 = 
S32_MIN
;

13893 i‡(
i
 < 
n
) {

13894 
i
 = 
	`¨øy_ödex_no•ec
(i, 
n
);

13895 
high
 = 
cqm_c⁄fig
->
rssi_thªshﬁds
[
i
] + 
hy°
 - 1;

13897 
high
 = 
S32_MAX
;

13900  
	`rdev_£t_cqm_rssi_ønge_c⁄fig
(
rdev
, 
dev
, 
low
, 
high
);

13901 
	}
}

13903 
	$∆80211_£t_cqm_rssi
(
gíl_öfo
 *
öfo
,

13904 c⁄° 
s32
 *
thªshﬁds
, 
n_thªshﬁds
,

13905 
u32
 
hy°îesis
)

13907 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

13908 
cfg80211_cqm_c⁄fig
 *
cqm_c⁄fig
 = 
NULL
, *
ﬁd
;

13909 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

13910 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

13911 
s32
 
¥ev
 = 
S32_MIN
;

13912 
i
, 
îr
;

13915 
i
 = 0; i < 
n_thªshﬁds
; i++) {

13916 i‡(
thªshﬁds
[
i
] > 0 ||Åhªshﬁds[i] <
¥ev
)

13917  -
EINVAL
;

13919 
¥ev
 = 
thªshﬁds
[
i
];

13922 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

13923 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
)

13924  -
EOPNOTSUPP
;

13926 i‡(
n_thªshﬁds
 =1 && 
thªshﬁds
[0] == 0)

13927 
n_thªshﬁds
 = 0;

13929 
ﬁd
 = 
	`wùhy_dîe„ªn˚
(
wdev
->
wùhy
, wdev->
cqm_c⁄fig
);

13932 i‡(!
n_thªshﬁds
 && !
ﬁd
)

13935 i‡(
n_thªshﬁds
 > 1) {

13936 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

13937 
NL80211_EXT_FEATURE_CQM_RSSI_LIST
) ||

13938 !
rdev
->
›s
->
£t_cqm_rssi_ønge_c⁄fig
)

13939  -
EOPNOTSUPP
;

13941 i‡(!
rdev
->
›s
->
£t_cqm_rssi_c⁄fig
)

13942  -
EOPNOTSUPP
;

13945 i‡(
n_thªshﬁds
) {

13946 
cqm_c⁄fig
 = 
	`kzÆloc
(
	`°ru˘_size
(cqm_c⁄fig, 
rssi_thªshﬁds
,

13947 
n_thªshﬁds
),

13948 
GFP_KERNEL
);

13949 i‡(!
cqm_c⁄fig
)

13950  -
ENOMEM
;

13952 
cqm_c⁄fig
->
rssi_hy°
 = 
hy°îesis
;

13953 
cqm_c⁄fig
->
n_rssi_thªshﬁds
 = 
n_thªshﬁds
;

13954 
	`mem˝y
(
cqm_c⁄fig
->
rssi_thªshﬁds
, 
thªshﬁds
,

13955 
	`Êex_¨øy_size
(
cqm_c⁄fig
, 
rssi_thªshﬁds
,

13956 
n_thªshﬁds
));

13957 
cqm_c⁄fig
->
u£_ønge_≠i
 = 
n_thªshﬁds
 > 1 ||

13958 !
rdev
->
›s
->
£t_cqm_rssi_c⁄fig
;

13960 
	`rcu_assign_poöãr
(
wdev
->
cqm_c⁄fig
, cqm_config);

13962 i‡(
cqm_c⁄fig
->
u£_ønge_≠i
)

13963 
îr
 = 
	`cfg80211_cqm_rssi_upd©e
(
rdev
, 
dev
, 
cqm_c⁄fig
);

13965 
îr
 = 
	`rdev_£t_cqm_rssi_c⁄fig
(
rdev
, 
dev
,

13966 
thªshﬁds
[0],

13967 
hy°îesis
);

13969 
	`RCU_INIT_POINTER
(
wdev
->
cqm_c⁄fig
, 
NULL
);

13971 i‡(
ﬁd
->
u£_ønge_≠i
)

13972 
îr
 = 
	`rdev_£t_cqm_rssi_ønge_c⁄fig
(
rdev
, 
dev
, 0, 0);

13974 
îr
 = 
	`rdev_£t_cqm_rssi_c⁄fig
(
rdev
, 
dev
, 0, 0);

13977 i‡(
îr
) {

13978 
	`rcu_assign_poöãr
(
wdev
->
cqm_c⁄fig
, 
ﬁd
);

13979 
	`k‰ì_rcu
(
cqm_c⁄fig
, 
rcu_hód
);

13981 
	`k‰ì_rcu
(
ﬁd
, 
rcu_hód
);

13984  
îr
;

13985 
	}
}

13987 
	$∆80211_£t_cqm
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

13989 
∆©å
 *
©ås
[
NL80211_ATTR_CQM_MAX
 + 1];

13990 
∆©å
 *
cqm
;

13991 
îr
;

13993 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

13995 
cqm
 = 
öfo
->
©ås
[
NL80211_ATTR_CQM
];

13996 i‡(!
cqm
) {

13997 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

13998  -
EINVAL
;

14001 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
©ås
, 
NL80211_ATTR_CQM_MAX
, 
cqm
,

14002 
∆80211_©å_cqm_pﬁicy
,

14003 
öfo
->
exèck
);

14004 i‡(
îr
) {

14005 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14006  
îr
;

14009 i‡(
©ås
[
NL80211_ATTR_CQM_RSSI_THOLD
] &&

14010 
©ås
[
NL80211_ATTR_CQM_RSSI_HYST
]) {

14011 c⁄° 
s32
 *
thªshﬁds
 =

14012 
	`∆a_d©a
(
©ås
[
NL80211_ATTR_CQM_RSSI_THOLD
]);

14013 
Àn
 = 
	`∆a_Àn
(
©ås
[
NL80211_ATTR_CQM_RSSI_THOLD
]);

14014 
u32
 
hy°îesis
 = 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_CQM_RSSI_HYST
]);

14016 i‡(
Àn
 % 4) {

14017 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14018  -
EINVAL
;

14021 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14022  
	`∆80211_£t_cqm_rssi
(
öfo
, 
thªshﬁds
, 
Àn
 / 4,

14023 
hy°îesis
);

14026 i‡(
©ås
[
NL80211_ATTR_CQM_TXE_RATE
] &&

14027 
©ås
[
NL80211_ATTR_CQM_TXE_PKTS
] &&

14028 
©ås
[
NL80211_ATTR_CQM_TXE_INTVL
]) {

14029 
u32
 
øã
 = 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_CQM_TXE_RATE
]);

14030 
u32
 
pkts
 = 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_CQM_TXE_PKTS
]);

14031 
u32
 
ötvl
 = 
	`∆a_gë_u32
(
©ås
[
NL80211_ATTR_CQM_TXE_INTVL
]);

14033 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14034  
	`∆80211_£t_cqm_txe
(
öfo
, 
øã
, 
pkts
, 
ötvl
);

14037 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14038  -
EINVAL
;

14039 
	}
}

14041 
	$∆80211_joö_ocb
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

14043 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

14044 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

14045 
ocb_£tup
 
£tup
 = {};

14046 
îr
;

14048 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

14050 
îr
 = 
	`∆80211_∑r£_ch™def
(
rdev
, 
öfo
, &
£tup
.
ch™def
);

14051 i‡(
îr
) {

14052 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14053  
îr
;

14056 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14057  
	`cfg80211_joö_ocb
(
rdev
, 
dev
, &
£tup
);

14058 
	}
}

14060 
	$∆80211_Àave_ocb
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

14062 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

14063 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

14064 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

14065 
	`¥_öfo
("\n\n");

14066 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14067  
	`cfg80211_Àave_ocb
(
rdev
, 
dev
);

14068 
	}
}

14070 
	$∆80211_joö_mesh
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

14072 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

14073 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

14074 
mesh_c⁄fig
 
cfg
;

14075 
mesh_£tup
 
£tup
;

14076 
îr
;

14078 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

14081 
	`mem˝y
(&
cfg
, &
deÁu…_mesh_c⁄fig
, (cfg));

14082 
	`mem˝y
(&
£tup
, &
deÁu…_mesh_£tup
, (setup));

14084 i‡(
öfo
->
©ås
[
NL80211_ATTR_MESH_CONFIG
]) {

14086 
îr
 = 
	`∆80211_∑r£_mesh_c⁄fig
(
öfo
, &
cfg
, 
NULL
);

14087 i‡(
îr
) {

14088 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14089  
îr
;

14093 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MESH_ID
] ||

14094 !
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_MESH_ID
])) {

14095 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14096  -
EINVAL
;

14099 
£tup
.
mesh_id
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MESH_ID
]);

14100 
£tup
.
mesh_id_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_MESH_ID
]);

14102 i‡(
öfo
->
©ås
[
NL80211_ATTR_MCAST_RATE
] &&

14103 !
	`∆80211_∑r£_mˇ°_øã
(
rdev
, 
£tup
.
mˇ°_øã
,

14104 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_MCAST_RATE
]))) {

14105 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14106  -
EINVAL
;

14109 i‡(
öfo
->
©ås
[
NL80211_ATTR_BEACON_INTERVAL
]) {

14110 
£tup
.
bóc⁄_öãrvÆ
 =

14111 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_BEACON_INTERVAL
]);

14113 
îr
 = 
	`cfg80211_vÆid©e_bóc⁄_öt
(
rdev
,

14114 
NL80211_IFTYPE_MESH_POINT
,

14115 
£tup
.
bóc⁄_öãrvÆ
);

14116 i‡(
îr
) {

14117 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14118  
îr
;

14122 i‡(
öfo
->
©ås
[
NL80211_ATTR_DTIM_PERIOD
]) {

14123 
£tup
.
dtim_≥riod
 =

14124 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_DTIM_PERIOD
]);

14125 i‡(
£tup
.
dtim_≥riod
 < 1 || setup.dtim_period > 100) {

14126 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14127  -
EINVAL
;

14131 i‡(
öfo
->
©ås
[
NL80211_ATTR_MESH_SETUP
]) {

14133 
îr
 = 
	`∆80211_∑r£_mesh_£tup
(
öfo
, &
£tup
);

14134 i‡(
îr
) {

14135 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14136  
îr
;

14140 i‡(
£tup
.
u£r_mpm
)

14141 
cfg
.
auto_›í_∂öks
 = 
Ál£
;

14143 i‡(
öfo
->
©ås
[
NL80211_ATTR_WIPHY_FREQ
]) {

14144 
îr
 = 
	`∆80211_∑r£_ch™def
(
rdev
, 
öfo
, &
£tup
.
ch™def
);

14145 i‡(
îr
) {

14146 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14147  
îr
;

14151 
£tup
.
ch™def
.
ch™
 = 
NULL
;

14154 i‡(
öfo
->
©ås
[
NL80211_ATTR_BSS_BASIC_RATES
]) {

14155 
u8
 *
øãs
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_BSS_BASIC_RATES
]);

14156 
n_øãs
 =

14157 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_BSS_BASIC_RATES
]);

14158 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

14160 i‡(!
£tup
.
ch™def
.
ch™
) {

14161 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14162  -
EINVAL
;

14165 
sb™d
 = 
rdev
->
wùhy
.
b™ds
[
£tup
.
ch™def
.
ch™
->
b™d
];

14167 
îr
 = 
	`õì80211_gë_øãmask
(
sb™d
, 
øãs
, 
n_øãs
,

14168 &
£tup
.
basic_øãs
);

14169 i‡(
îr
) {

14170 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14171  
îr
;

14175 i‡(
öfo
->
©ås
[
NL80211_ATTR_TX_RATES
]) {

14176 
îr
 = 
	`∆80211_∑r£_tx_bôøã_mask
(
öfo
, info->
©ås
,

14177 
NL80211_ATTR_TX_RATES
,

14178 &
£tup
.
bóc⁄_øã
,

14179 
dev
, 
Ál£
, 0);

14180 i‡(
îr
) {

14181 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14182  
îr
;

14185 i‡(!
£tup
.
ch™def
.
ch™
) {

14186 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14187  -
EINVAL
;

14190 
îr
 = 
	`vÆid©e_bóc⁄_tx_øã
(
rdev
, 
£tup
.
ch™def
.
ch™
->
b™d
,

14191 &
£tup
.
bóc⁄_øã
);

14192 i‡(
îr
) {

14193 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14194  
îr
;

14198 
£tup
.
u£r•a˚_h™dÀs_dfs
 =

14199 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_HANDLE_DFS
]);

14201 i‡(
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT_OVER_NL80211
]) {

14202 
r
 = 
	`vÆid©e_∑e_ovî_∆80211
(
rdev
, 
öfo
);

14204 i‡(
r
 < 0) {

14205 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14206  
r
;

14209 
£tup
.
c⁄åﬁ_p‹t_ovî_∆80211
 = 
åue
;

14212 
îr
 = 
	`__cfg80211_joö_mesh
(
rdev
, 
dev
, &
£tup
, &
cfg
);

14213 i‡(!
îr
 && 
öfo
->
©ås
[
NL80211_ATTR_SOCKET_OWNER
])

14214 
dev
->
õì80211_±r
->
c⁄n_ow√r_∆p‹tid
 = 
öfo
->
¢d_p‹tid
;

14216 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14217  
îr
;

14218 
	}
}

14220 
	$∆80211_Àave_mesh
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

14222 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

14223 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

14224 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

14225 
	`¥_öfo
("\n\n");

14226 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14227  
	`cfg80211_Àave_mesh
(
rdev
, 
dev
);

14228 
	}
}

14230 #ifde‡
CONFIG_PM


14231 
	$∆80211_£nd_wowœn_∑âîns
(
sk_buff
 *
msg
,

14232 
cfg80211_ªgi°îed_devi˚
 *
rdev
)

14234 
cfg80211_wowœn
 *
wowœn
 = 
rdev
->
wùhy
.
wowœn_c⁄fig
;

14235 
∆©å
 *
∆_∑ts
, *
∆_∑t
;

14236 
i
, 
∑t_Àn
;

14238 i‡(!
wowœn
->
n_∑âîns
)

14241 
∆_∑ts
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_WOWLAN_TRIG_PKT_PATTERN
);

14242 i‡(!
∆_∑ts
)

14243  -
ENOBUFS
;

14245 
i
 = 0; i < 
wowœn
->
n_∑âîns
; i++) {

14246 
∆_∑t
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
i
 + 1);

14247 i‡(!
∆_∑t
)

14248  -
ENOBUFS
;

14249 
∑t_Àn
 = 
wowœn
->
∑âîns
[
i
].
∑âîn_Àn
;

14250 i‡(
	`∆a_put
(
msg
, 
NL80211_PKTPAT_MASK
, 
	`DIV_ROUND_UP
(
∑t_Àn
, 8),

14251 
wowœn
->
∑âîns
[
i
].
mask
) ||

14252 
	`∆a_put
(
msg
, 
NL80211_PKTPAT_PATTERN
, 
∑t_Àn
,

14253 
wowœn
->
∑âîns
[
i
].
∑âîn
) ||

14254 
	`∆a_put_u32
(
msg
, 
NL80211_PKTPAT_OFFSET
,

14255 
wowœn
->
∑âîns
[
i
].
pkt_off£t
))

14256  -
ENOBUFS
;

14257 
	`∆a_√°_íd
(
msg
, 
∆_∑t
);

14259 
	`∆a_√°_íd
(
msg
, 
∆_∑ts
);

14262 
	}
}

14264 
	$∆80211_£nd_wowœn_t˝
(
sk_buff
 *
msg
,

14265 
cfg80211_wowœn_t˝
 *
t˝
)

14267 
∆©å
 *
∆_t˝
;

14269 i‡(!
t˝
)

14272 
∆_t˝
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

14273 
NL80211_WOWLAN_TRIG_TCP_CONNECTION
);

14274 i‡(!
∆_t˝
)

14275  -
ENOBUFS
;

14277 i‡(
	`∆a_put_ö_addr
(
msg
, 
NL80211_WOWLAN_TCP_SRC_IPV4
, 
t˝
->
§c
) ||

14278 
	`∆a_put_ö_addr
(
msg
, 
NL80211_WOWLAN_TCP_DST_IPV4
, 
t˝
->
d°
) ||

14279 
	`∆a_put
(
msg
, 
NL80211_WOWLAN_TCP_DST_MAC
, 
ETH_ALEN
, 
t˝
->
d°_mac
) ||

14280 
	`∆a_put_u16
(
msg
, 
NL80211_WOWLAN_TCP_SRC_PORT
, 
t˝
->
§c_p‹t
) ||

14281 
	`∆a_put_u16
(
msg
, 
NL80211_WOWLAN_TCP_DST_PORT
, 
t˝
->
d°_p‹t
) ||

14282 
	`∆a_put
(
msg
, 
NL80211_WOWLAN_TCP_DATA_PAYLOAD
,

14283 
t˝
->
∑ylﬂd_Àn
,Å˝->
∑ylﬂd
) ||

14284 
	`∆a_put_u32
(
msg
, 
NL80211_WOWLAN_TCP_DATA_INTERVAL
,

14285 
t˝
->
d©a_öãrvÆ
) ||

14286 
	`∆a_put
(
msg
, 
NL80211_WOWLAN_TCP_WAKE_PAYLOAD
,

14287 
t˝
->
wake_Àn
,Å˝->
wake_d©a
) ||

14288 
	`∆a_put
(
msg
, 
NL80211_WOWLAN_TCP_WAKE_MASK
,

14289 
	`DIV_ROUND_UP
(
t˝
->
wake_Àn
, 8),Å˝->
wake_mask
))

14290  -
ENOBUFS
;

14292 i‡(
t˝
->
∑ylﬂd_£q
.
Àn
 &&

14293 
	`∆a_put
(
msg
, 
NL80211_WOWLAN_TCP_DATA_PAYLOAD_SEQ
,

14294 (
t˝
->
∑ylﬂd_£q
), &tcp->payload_seq))

14295  -
ENOBUFS
;

14297 i‡(
t˝
->
∑ylﬂd_tok
.
Àn
 &&

14298 
	`∆a_put
(
msg
, 
NL80211_WOWLAN_TCP_DATA_PAYLOAD_TOKEN
,

14299 (
t˝
->
∑ylﬂd_tok
Ë+Å˝->
tokís_size
,

14300 &
t˝
->
∑ylﬂd_tok
))

14301  -
ENOBUFS
;

14303 
	`∆a_√°_íd
(
msg
, 
∆_t˝
);

14306 
	}
}

14308 
	$∆80211_£nd_wowœn_nd
(
sk_buff
 *
msg
,

14309 
cfg80211_sched_sˇn_ªque°
 *
ªq
)

14311 
∆©å
 *
nd
, *
‰eqs
, *
m©ches
, *
m©ch
, *
sˇn_∂™s
, *
sˇn_∂™
;

14312 
i
;

14314 i‡(!
ªq
)

14317 
nd
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_WOWLAN_TRIG_NET_DETECT
);

14318 i‡(!
nd
)

14319  -
ENOBUFS
;

14321 i‡(
ªq
->
n_sˇn_∂™s
 == 1 &&

14322 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_SCHED_SCAN_INTERVAL
,

14323 
ªq
->
sˇn_∂™s
[0].
öãrvÆ
 * 1000))

14324  -
ENOBUFS
;

14326 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_SCHED_SCAN_DELAY
, 
ªq
->
dñay
))

14327  -
ENOBUFS
;

14329 i‡(
ªq
->
ªœtive_rssi_£t
) {

14330 
∆80211_bss_£À˘_rssi_adju°
 
rssi_adju°
;

14332 i‡(
	`∆a_put_s8
(
msg
, 
NL80211_ATTR_SCHED_SCAN_RELATIVE_RSSI
,

14333 
ªq
->
ªœtive_rssi
))

14334  -
ENOBUFS
;

14336 
rssi_adju°
.
b™d
 = 
ªq
->rssi_adjust.band;

14337 
rssi_adju°
.
dñè
 = 
ªq
->rssi_adjust.delta;

14338 i‡(
	`∆a_put
(
msg
, 
NL80211_ATTR_SCHED_SCAN_RSSI_ADJUST
,

14339 (
rssi_adju°
), &rssi_adjust))

14340  -
ENOBUFS
;

14343 
‰eqs
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_SCAN_FREQUENCIES
);

14344 i‡(!
‰eqs
)

14345  -
ENOBUFS
;

14347 
i
 = 0; i < 
ªq
->
n_ch™√ls
; i++) {

14348 i‡(
	`∆a_put_u32
(
msg
, 
i
, 
ªq
->
ch™√ls
[i]->
˚¡î_‰eq
))

14349  -
ENOBUFS
;

14352 
	`∆a_√°_íd
(
msg
, 
‰eqs
);

14354 i‡(
ªq
->
n_m©ch_£ts
) {

14355 
m©ches
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

14356 
NL80211_ATTR_SCHED_SCAN_MATCH
);

14357 i‡(!
m©ches
)

14358  -
ENOBUFS
;

14360 
i
 = 0; i < 
ªq
->
n_m©ch_£ts
; i++) {

14361 
m©ch
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
i
);

14362 i‡(!
m©ch
)

14363  -
ENOBUFS
;

14365 i‡(
	`∆a_put
(
msg
, 
NL80211_SCHED_SCAN_MATCH_ATTR_SSID
,

14366 
ªq
->
m©ch_£ts
[
i
].
ssid
.
ssid_Àn
,

14367 
ªq
->
m©ch_£ts
[
i
].
ssid
.ssid))

14368  -
ENOBUFS
;

14369 
	`∆a_√°_íd
(
msg
, 
m©ch
);

14371 
	`∆a_√°_íd
(
msg
, 
m©ches
);

14374 
sˇn_∂™s
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_SCHED_SCAN_PLANS
);

14375 i‡(!
sˇn_∂™s
)

14376  -
ENOBUFS
;

14378 
i
 = 0; i < 
ªq
->
n_sˇn_∂™s
; i++) {

14379 
sˇn_∂™
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
i
 + 1);

14380 i‡(!
sˇn_∂™
)

14381  -
ENOBUFS
;

14383 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_SCHED_SCAN_PLAN_INTERVAL
,

14384 
ªq
->
sˇn_∂™s
[
i
].
öãrvÆ
) ||

14385 (
ªq
->
sˇn_∂™s
[
i
].
ôî©i⁄s
 &&

14386 
	`∆a_put_u32
(
msg
, 
NL80211_SCHED_SCAN_PLAN_ITERATIONS
,

14387 
ªq
->
sˇn_∂™s
[
i
].
ôî©i⁄s
)))

14388  -
ENOBUFS
;

14389 
	`∆a_√°_íd
(
msg
, 
sˇn_∂™
);

14391 
	`∆a_√°_íd
(
msg
, 
sˇn_∂™s
);

14393 
	`∆a_√°_íd
(
msg
, 
nd
);

14396 
	}
}

14398 
	$∆80211_gë_wowœn
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

14400 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

14401 
sk_buff
 *
msg
;

14402 *
hdr
;

14403 
u32
 
size
 = 
NLMSG_DEFAULT_SIZE
;

14405 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

14407 i‡(!
rdev
->
wùhy
.
wowœn
) {

14408 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14409  -
EOPNOTSUPP
;

14412 i‡(
rdev
->
wùhy
.
wowœn_c⁄fig
 &&Ñdev->wùhy.wowœn_c⁄fig->
t˝
) {

14414 
size
 +
rdev
->
wùhy
.
wowœn_c⁄fig
->
t˝
->
tokís_size
 +

14415 
rdev
->
wùhy
.
wowœn_c⁄fig
->
t˝
->
∑ylﬂd_Àn
 +

14416 
rdev
->
wùhy
.
wowœn_c⁄fig
->
t˝
->
wake_Àn
 +

14417 
rdev
->
wùhy
.
wowœn_c⁄fig
->
t˝
->
wake_Àn
 / 8;

14420 
msg
 = 
	`∆msg_√w
(
size
, 
GFP_KERNEL
);

14421 i‡(!
msg
) {

14422 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14423  -
ENOMEM
;

14426 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

14427 
NL80211_CMD_GET_WOWLAN
);

14428 i‡(!
hdr
) {

14429 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14430 
∆a_put_Áûuª
;

14433 i‡(
rdev
->
wùhy
.
wowœn_c⁄fig
) {

14434 
∆©å
 *
∆_wowœn
;

14436 
∆_wowœn
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

14437 
NL80211_ATTR_WOWLAN_TRIGGERS
);

14438 i‡(!
∆_wowœn
) {

14439 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14440 
∆a_put_Áûuª
;

14443 i‡((
rdev
->
wùhy
.
wowœn_c⁄fig
->
™y
 &&

14444 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_ANY
)) ||

14445 (
rdev
->
wùhy
.
wowœn_c⁄fig
->
disc⁄√˘
 &&

14446 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_DISCONNECT
)) ||

14447 (
rdev
->
wùhy
.
wowœn_c⁄fig
->
magic_pkt
 &&

14448 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_MAGIC_PKT
)) ||

14449 (
rdev
->
wùhy
.
wowœn_c⁄fig
->
gtk_ªkey_Áûuª
 &&

14450 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_GTK_REKEY_FAILURE
)) ||

14451 (
rdev
->
wùhy
.
wowœn_c⁄fig
->
óp_idítôy_ªq
 &&

14452 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_EAP_IDENT_REQUEST
)) ||

14453 (
rdev
->
wùhy
.
wowœn_c⁄fig
->
four_way_h™dshake
 &&

14454 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_4WAY_HANDSHAKE
)) ||

14455 (
rdev
->
wùhy
.
wowœn_c⁄fig
->
rfkûl_ªÀa£
 &&

14456 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_RFKILL_RELEASE
))) {

14457 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14458 
∆a_put_Áûuª
;

14461 i‡(
	`∆80211_£nd_wowœn_∑âîns
(
msg
, 
rdev
)) {

14462 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14463 
∆a_put_Áûuª
;

14466 i‡(
	`∆80211_£nd_wowœn_t˝
(
msg
,

14467 
rdev
->
wùhy
.
wowœn_c⁄fig
->
t˝
)) {

14468 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14469 
∆a_put_Áûuª
;

14472 i‡(
	`∆80211_£nd_wowœn_nd
(

14473 
msg
,

14474 
rdev
->
wùhy
.
wowœn_c⁄fig
->
nd_c⁄fig
)) {

14475 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14476 
∆a_put_Áûuª
;

14479 
	`∆a_√°_íd
(
msg
, 
∆_wowœn
);

14482 
	`gílmsg_íd
(
msg
, 
hdr
);

14483 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14484  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

14486 
∆a_put_Áûuª
:

14487 
	`∆msg_‰ì
(
msg
);

14488 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14489  -
ENOBUFS
;

14490 
	}
}

14492 
	$∆80211_∑r£_wowœn_t˝
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

14493 
∆©å
 *
©å
,

14494 
cfg80211_wowœn
 *
åig
)

14496 
∆©å
 *
tb
[
NUM_NL80211_WOWLAN_TCP
];

14497 
cfg80211_wowœn_t˝
 *
cfg
;

14498 
∆80211_wowœn_t˝_d©a_tokí
 *
tok
 = 
NULL
;

14499 
∆80211_wowœn_t˝_d©a_£q
 *
£q
 = 
NULL
;

14500 
u32
 
size
;

14501 
u32
 
d©a_size
, 
wake_size
, 
tokís_size
 = 0, 
wake_mask_size
;

14502 
îr
, 
p‹t
;

14504 i‡(!
rdev
->
wùhy
.
wowœn
->
t˝
)

14505  -
EINVAL
;

14507 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
MAX_NL80211_WOWLAN_TCP
, 
©å
,

14508 
∆80211_wowœn_t˝_pﬁicy
, 
NULL
);

14509 i‡(
îr
)

14510  
îr
;

14512 i‡(!
tb
[
NL80211_WOWLAN_TCP_SRC_IPV4
] ||

14513 !
tb
[
NL80211_WOWLAN_TCP_DST_IPV4
] ||

14514 !
tb
[
NL80211_WOWLAN_TCP_DST_MAC
] ||

14515 !
tb
[
NL80211_WOWLAN_TCP_DST_PORT
] ||

14516 !
tb
[
NL80211_WOWLAN_TCP_DATA_PAYLOAD
] ||

14517 !
tb
[
NL80211_WOWLAN_TCP_DATA_INTERVAL
] ||

14518 !
tb
[
NL80211_WOWLAN_TCP_WAKE_PAYLOAD
] ||

14519 !
tb
[
NL80211_WOWLAN_TCP_WAKE_MASK
])

14520  -
EINVAL
;

14522 
d©a_size
 = 
	`∆a_Àn
(
tb
[
NL80211_WOWLAN_TCP_DATA_PAYLOAD
]);

14523 i‡(
d©a_size
 > 
rdev
->
wùhy
.
wowœn
->
t˝
->
d©a_∑ylﬂd_max
)

14524  -
EINVAL
;

14526 i‡(
	`∆a_gë_u32
(
tb
[
NL80211_WOWLAN_TCP_DATA_INTERVAL
]) >

14527 
rdev
->
wùhy
.
wowœn
->
t˝
->
d©a_öãrvÆ_max
 ||

14528 
	`∆a_gë_u32
(
tb
[
NL80211_WOWLAN_TCP_DATA_INTERVAL
]) == 0)

14529  -
EINVAL
;

14531 
wake_size
 = 
	`∆a_Àn
(
tb
[
NL80211_WOWLAN_TCP_WAKE_PAYLOAD
]);

14532 i‡(
wake_size
 > 
rdev
->
wùhy
.
wowœn
->
t˝
->
wake_∑ylﬂd_max
)

14533  -
EINVAL
;

14535 
wake_mask_size
 = 
	`∆a_Àn
(
tb
[
NL80211_WOWLAN_TCP_WAKE_MASK
]);

14536 i‡(
wake_mask_size
 !
	`DIV_ROUND_UP
(
wake_size
, 8))

14537  -
EINVAL
;

14539 i‡(
tb
[
NL80211_WOWLAN_TCP_DATA_PAYLOAD_TOKEN
]) {

14540 
u32
 
tok 
 = 
	`∆a_Àn
(
tb
[
NL80211_WOWLAN_TCP_DATA_PAYLOAD_TOKEN
]);

14542 
tok
 = 
	`∆a_d©a
(
tb
[
NL80211_WOWLAN_TCP_DATA_PAYLOAD_TOKEN
]);

14543 
tokís_size
 = 
tok 
 - (*
tok
);

14545 i‡(!
tok
->
Àn
 || 
tokís_size
 %Åok->len)

14546  -
EINVAL
;

14547 i‡(!
rdev
->
wùhy
.
wowœn
->
t˝
->
tok
)

14548  -
EINVAL
;

14549 i‡(
tok
->
Àn
 > 
rdev
->
wùhy
.
wowœn
->
t˝
->tok->
max_Àn
)

14550  -
EINVAL
;

14551 i‡(
tok
->
Àn
 < 
rdev
->
wùhy
.
wowœn
->
t˝
->tok->
mö_Àn
)

14552  -
EINVAL
;

14553 i‡(
tokís_size
 > 
rdev
->
wùhy
.
wowœn
->
t˝
->
tok
->
bufsize
)

14554  -
EINVAL
;

14555 i‡(
tok
->
off£t
 +Åok->
Àn
 > 
d©a_size
)

14556  -
EINVAL
;

14559 i‡(
tb
[
NL80211_WOWLAN_TCP_DATA_PAYLOAD_SEQ
]) {

14560 
£q
 = 
	`∆a_d©a
(
tb
[
NL80211_WOWLAN_TCP_DATA_PAYLOAD_SEQ
]);

14561 i‡(!
rdev
->
wùhy
.
wowœn
->
t˝
->
£q
)

14562  -
EINVAL
;

14563 i‡(
£q
->
Àn
 == 0 || seq->len > 4)

14564  -
EINVAL
;

14565 i‡(
£q
->
Àn
 + seq->
off£t
 > 
d©a_size
)

14566  -
EINVAL
;

14569 
size
 = (*
cfg
);

14570 
size
 +
d©a_size
;

14571 
size
 +
wake_size
 + 
wake_mask_size
;

14572 
size
 +
tokís_size
;

14574 
cfg
 = 
	`kzÆloc
(
size
, 
GFP_KERNEL
);

14575 i‡(!
cfg
)

14576  -
ENOMEM
;

14577 
cfg
->
§c
 = 
	`∆a_gë_ö_addr
(
tb
[
NL80211_WOWLAN_TCP_SRC_IPV4
]);

14578 
cfg
->
d°
 = 
	`∆a_gë_ö_addr
(
tb
[
NL80211_WOWLAN_TCP_DST_IPV4
]);

14579 
	`mem˝y
(
cfg
->
d°_mac
, 
	`∆a_d©a
(
tb
[
NL80211_WOWLAN_TCP_DST_MAC
]),

14580 
ETH_ALEN
);

14581 i‡(
tb
[
NL80211_WOWLAN_TCP_SRC_PORT
])

14582 
p‹t
 = 
	`∆a_gë_u16
(
tb
[
NL80211_WOWLAN_TCP_SRC_PORT
]);

14584 
p‹t
 = 0;

14585 #ifde‡
CONFIG_INET


14587 
îr
 = 
	`__sock_¸óã
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
PF_INET
, 
SOCK_STREAM
,

14588 
IPPROTO_TCP
, &
cfg
->
sock
, 1);

14589 i‡(
îr
) {

14590 
	`k‰ì
(
cfg
);

14591  
îr
;

14593 i‡(
	`öë_csk_gë_p‹t
(
cfg
->
sock
->
sk
, 
p‹t
)) {

14594 
	`sock_ªÀa£
(
cfg
->
sock
);

14595 
	`k‰ì
(
cfg
);

14596  -
EADDRINUSE
;

14598 
cfg
->
§c_p‹t
 = 
	`öë_sk
(cfg->
sock
->
sk
)->
öë_num
;

14600 i‡(!
p‹t
) {

14601 
	`k‰ì
(
cfg
);

14602  -
EINVAL
;

14604 
cfg
->
§c_p‹t
 = 
p‹t
;

14607 
cfg
->
d°_p‹t
 = 
	`∆a_gë_u16
(
tb
[
NL80211_WOWLAN_TCP_DST_PORT
]);

14608 
cfg
->
∑ylﬂd_Àn
 = 
d©a_size
;

14609 
cfg
->
∑ylﬂd
 = (
u8
 *)cfg + (*cfgË+ 
tokís_size
;

14610 
	`mem˝y
((*)
cfg
->
∑ylﬂd
,

14611 
	`∆a_d©a
(
tb
[
NL80211_WOWLAN_TCP_DATA_PAYLOAD
]),

14612 
d©a_size
);

14613 i‡(
£q
)

14614 
cfg
->
∑ylﬂd_£q
 = *
£q
;

14615 
cfg
->
d©a_öãrvÆ
 = 
	`∆a_gë_u32
(
tb
[
NL80211_WOWLAN_TCP_DATA_INTERVAL
]);

14616 
cfg
->
wake_Àn
 = 
wake_size
;

14617 
cfg
->
wake_d©a
 = (
u8
 *)cfg + (*cfgË+ 
tokís_size
 + 
d©a_size
;

14618 
	`mem˝y
((*)
cfg
->
wake_d©a
,

14619 
	`∆a_d©a
(
tb
[
NL80211_WOWLAN_TCP_WAKE_PAYLOAD
]),

14620 
wake_size
);

14621 
cfg
->
wake_mask
 = (
u8
 *)cfg + (*cfgË+ 
tokís_size
 +

14622 
d©a_size
 + 
wake_size
;

14623 
	`mem˝y
((*)
cfg
->
wake_mask
,

14624 
	`∆a_d©a
(
tb
[
NL80211_WOWLAN_TCP_WAKE_MASK
]),

14625 
wake_mask_size
);

14626 i‡(
tok
) {

14627 
cfg
->
tokís_size
 =Åokens_size;

14628 
cfg
->
∑ylﬂd_tok
 = *
tok
;

14629 
	`mem˝y
(
cfg
->
∑ylﬂd_tok
.
tokí_°ªam
, 
tok
->token_stream,

14630 
tokís_size
);

14633 
åig
->
t˝
 = 
cfg
;

14636 
	}
}

14638 
	$∆80211_∑r£_wowœn_nd
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

14639 c⁄° 
wùhy_wowœn_suµ‹t
 *
wowœn
,

14640 
∆©å
 *
©å
,

14641 
cfg80211_wowœn
 *
åig
)

14643 
∆©å
 **
tb
;

14644 
îr
;

14646 
tb
 = 
	`kˇŒoc
(
NUM_NL80211_ATTR
, (*tb), 
GFP_KERNEL
);

14647 i‡(!
tb
)

14648  -
ENOMEM
;

14650 i‡(!(
wowœn
->
Êags
 & 
WIPHY_WOWLAN_NET_DETECT
)) {

14651 
îr
 = -
EOPNOTSUPP
;

14652 
out
;

14655 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
NL80211_ATTR_MAX
, 
©å
,

14656 
∆80211_pﬁicy
, 
NULL
);

14657 i‡(
îr
)

14658 
out
;

14660 
åig
->
nd_c⁄fig
 = 
	`∆80211_∑r£_sched_sˇn
(&
rdev
->
wùhy
, 
NULL
, 
tb
,

14661 
wowœn
->
max_nd_m©ch_£ts
);

14662 
îr
 = 
	`PTR_ERR_OR_ZERO
(
åig
->
nd_c⁄fig
);

14663 i‡(
îr
)

14664 
åig
->
nd_c⁄fig
 = 
NULL
;

14666 
out
:

14667 
	`k‰ì
(
tb
);

14668  
îr
;

14669 
	}
}

14671 
	$∆80211_£t_wowœn
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

14673 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

14674 
∆©å
 *
tb
[
NUM_NL80211_WOWLAN_TRIG
];

14675 
cfg80211_wowœn
 
√w_åiggîs
 = {};

14676 
cfg80211_wowœn
 *
¡rig
;

14677 c⁄° 
wùhy_wowœn_suµ‹t
 *
wowœn
 = 
rdev
->
wùhy
.wowlan;

14678 
îr
, 
i
;

14679 
boﬁ
 
¥ev_íabÀd
 = 
rdev
->
wùhy
.
wowœn_c⁄fig
;

14680 
boﬁ
 
ªguœr
 = 
Ál£
;

14682 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

14684 i‡(!
wowœn
) {

14685 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14686  -
EOPNOTSUPP
;

14689 i‡(!
öfo
->
©ås
[
NL80211_ATTR_WOWLAN_TRIGGERS
]) {

14690 
	`cfg80211_rdev_‰ì_wowœn
(
rdev
);

14691 
rdev
->
wùhy
.
wowœn_c⁄fig
 = 
NULL
;

14692 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14693 
£t_wakeup
;

14696 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
MAX_NL80211_WOWLAN_TRIG
,

14697 
öfo
->
©ås
[
NL80211_ATTR_WOWLAN_TRIGGERS
],

14698 
∆80211_wowœn_pﬁicy
, 
öfo
->
exèck
);

14699 i‡(
îr
) {

14700 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14701  
îr
;

14704 i‡(
tb
[
NL80211_WOWLAN_TRIG_ANY
]) {

14705 i‡(!(
wowœn
->
Êags
 & 
WIPHY_WOWLAN_ANY
)) {

14706 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14707  -
EINVAL
;

14709 
√w_åiggîs
.
™y
 = 
åue
;

14712 i‡(
tb
[
NL80211_WOWLAN_TRIG_DISCONNECT
]) {

14713 i‡(!(
wowœn
->
Êags
 & 
WIPHY_WOWLAN_DISCONNECT
)) {

14714 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14715  -
EINVAL
;

14717 
√w_åiggîs
.
disc⁄√˘
 = 
åue
;

14718 
ªguœr
 = 
åue
;

14721 i‡(
tb
[
NL80211_WOWLAN_TRIG_MAGIC_PKT
]) {

14722 i‡(!(
wowœn
->
Êags
 & 
WIPHY_WOWLAN_MAGIC_PKT
)) {

14723 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14724  -
EINVAL
;

14726 
√w_åiggîs
.
magic_pkt
 = 
åue
;

14727 
ªguœr
 = 
åue
;

14730 i‡(
tb
[
NL80211_WOWLAN_TRIG_GTK_REKEY_SUPPORTED
]) {

14731 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14732  -
EINVAL
;

14735 i‡(
tb
[
NL80211_WOWLAN_TRIG_GTK_REKEY_FAILURE
]) {

14736 i‡(!(
wowœn
->
Êags
 & 
WIPHY_WOWLAN_GTK_REKEY_FAILURE
)) {

14737 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14738  -
EINVAL
;

14740 
√w_åiggîs
.
gtk_ªkey_Áûuª
 = 
åue
;

14741 
ªguœr
 = 
åue
;

14744 i‡(
tb
[
NL80211_WOWLAN_TRIG_EAP_IDENT_REQUEST
]) {

14745 i‡(!(
wowœn
->
Êags
 & 
WIPHY_WOWLAN_EAP_IDENTITY_REQ
)) {

14746 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14747  -
EINVAL
;

14749 
√w_åiggîs
.
óp_idítôy_ªq
 = 
åue
;

14750 
ªguœr
 = 
åue
;

14753 i‡(
tb
[
NL80211_WOWLAN_TRIG_4WAY_HANDSHAKE
]) {

14754 i‡(!(
wowœn
->
Êags
 & 
WIPHY_WOWLAN_4WAY_HANDSHAKE
)) {

14755 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14756  -
EINVAL
;

14758 
√w_åiggîs
.
four_way_h™dshake
 = 
åue
;

14759 
ªguœr
 = 
åue
;

14762 i‡(
tb
[
NL80211_WOWLAN_TRIG_RFKILL_RELEASE
]) {

14763 i‡(!(
wowœn
->
Êags
 & 
WIPHY_WOWLAN_RFKILL_RELEASE
)) {

14764 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14765  -
EINVAL
;

14767 
√w_åiggîs
.
rfkûl_ªÀa£
 = 
åue
;

14768 
ªguœr
 = 
åue
;

14771 i‡(
tb
[
NL80211_WOWLAN_TRIG_PKT_PATTERN
]) {

14772 
∆©å
 *
∑t
;

14773 
n_∑âîns
 = 0;

14774 
ªm
, 
∑t_Àn
, 
mask_Àn
, 
pkt_off£t
;

14775 
∆©å
 *
∑t_tb
[
NUM_NL80211_PKTPAT
];

14777 
ªguœr
 = 
åue
;

14779 
	`∆a_f‹_óch_√°ed
(
∑t
, 
tb
[
NL80211_WOWLAN_TRIG_PKT_PATTERN
],

14780 
ªm
)

14781 
n_∑âîns
++;

14782 i‡(
n_∑âîns
 > 
wowœn
->n_patterns) {

14783 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14784  -
EINVAL
;

14787 
√w_åiggîs
.
∑âîns
 = 
	`kˇŒoc
(
n_∑âîns
,

14788 (
√w_åiggîs
.
∑âîns
[0]),

14789 
GFP_KERNEL
);

14790 i‡(!
√w_åiggîs
.
∑âîns
) {

14791 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14792  -
ENOMEM
;

14795 
√w_åiggîs
.
n_∑âîns
 =Ç_patterns;

14796 
i
 = 0;

14798 
	`∆a_f‹_óch_√°ed
(
∑t
, 
tb
[
NL80211_WOWLAN_TRIG_PKT_PATTERN
],

14799 
ªm
) {

14800 
u8
 *
mask_∑t
;

14802 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
∑t_tb
,

14803 
MAX_NL80211_PKTPAT
,

14804 
∑t
,

14805 
∆80211_∑ckë_∑âîn_pﬁicy
,

14806 
öfo
->
exèck
);

14807 i‡(
îr
) {

14808 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14809 
îr‹
;

14812 
îr
 = -
EINVAL
;

14813 i‡(!
∑t_tb
[
NL80211_PKTPAT_MASK
] ||

14814 !
∑t_tb
[
NL80211_PKTPAT_PATTERN
]) {

14815 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14816 
îr‹
;

14818 
∑t_Àn
 = 
	`∆a_Àn
(
∑t_tb
[
NL80211_PKTPAT_PATTERN
]);

14819 
mask_Àn
 = 
	`DIV_ROUND_UP
(
∑t_Àn
, 8);

14820 i‡(
	`∆a_Àn
(
∑t_tb
[
NL80211_PKTPAT_MASK
]Ë!
mask_Àn
) {

14821 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14822 
îr‹
;

14824 i‡(
∑t_Àn
 > 
wowœn
->
∑âîn_max_Àn
 ||

14825 
∑t_Àn
 < 
wowœn
->
∑âîn_mö_Àn
) {

14826 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14827 
îr‹
;

14830 i‡(!
∑t_tb
[
NL80211_PKTPAT_OFFSET
])

14831 
pkt_off£t
 = 0;

14833 
pkt_off£t
 = 
	`∆a_gë_u32
(

14834 
∑t_tb
[
NL80211_PKTPAT_OFFSET
]);

14835 i‡(
pkt_off£t
 > 
wowœn
->
max_pkt_off£t
) {

14836 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14837 
îr‹
;

14839 
√w_åiggîs
.
∑âîns
[
i
].
pkt_off£t
 =Ökt_offset;

14841 
mask_∑t
 = 
	`kmÆloc
(
mask_Àn
 + 
∑t_Àn
, 
GFP_KERNEL
);

14842 i‡(!
mask_∑t
) {

14843 
îr
 = -
ENOMEM
;

14844 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14845 
îr‹
;

14847 
√w_åiggîs
.
∑âîns
[
i
].
mask
 = 
mask_∑t
;

14848 
	`mem˝y
(
mask_∑t
, 
	`∆a_d©a
(
∑t_tb
[
NL80211_PKTPAT_MASK
]),

14849 
mask_Àn
);

14850 
mask_∑t
 +
mask_Àn
;

14851 
√w_åiggîs
.
∑âîns
[
i
].
∑âîn
 = 
mask_∑t
;

14852 
√w_åiggîs
.
∑âîns
[
i
].
∑âîn_Àn
 = 
∑t_Àn
;

14853 
	`mem˝y
(
mask_∑t
,

14854 
	`∆a_d©a
(
∑t_tb
[
NL80211_PKTPAT_PATTERN
]),

14855 
∑t_Àn
);

14856 
i
++;

14860 i‡(
tb
[
NL80211_WOWLAN_TRIG_TCP_CONNECTION
]) {

14861 
ªguœr
 = 
åue
;

14862 
îr
 = 
	`∆80211_∑r£_wowœn_t˝
(

14863 
rdev
, 
tb
[
NL80211_WOWLAN_TRIG_TCP_CONNECTION
],

14864 &
√w_åiggîs
);

14865 i‡(
îr
) {

14866 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14867 
îr‹
;

14871 i‡(
tb
[
NL80211_WOWLAN_TRIG_NET_DETECT
]) {

14872 
ªguœr
 = 
åue
;

14873 
îr
 = 
	`∆80211_∑r£_wowœn_nd
(

14874 
rdev
, 
wowœn
, 
tb
[
NL80211_WOWLAN_TRIG_NET_DETECT
],

14875 &
√w_åiggîs
);

14876 i‡(
îr
) {

14877 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14878 
îr‹
;

14888 i‡(
√w_åiggîs
.
™y
 && 
ªguœr
) {

14889 
îr
 = -
EINVAL
;

14890 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14891 
îr‹
;

14894 
¡rig
 = 
	`kmemdup
(&
√w_åiggîs
, “ew_åiggîs), 
GFP_KERNEL
);

14895 i‡(!
¡rig
) {

14896 
îr
 = -
ENOMEM
;

14897 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14898 
îr‹
;

14900 
	`cfg80211_rdev_‰ì_wowœn
(
rdev
);

14901 
rdev
->
wùhy
.
wowœn_c⁄fig
 = 
¡rig
;

14903 
£t_wakeup
:

14904 i‡(
rdev
->
›s
->
£t_wakeup
 &&

14905 
¥ev_íabÀd
 !!!
rdev
->
wùhy
.
wowœn_c⁄fig
)

14906 
	`rdev_£t_wakeup
(
rdev
,Ñdev->
wùhy
.
wowœn_c⁄fig
);

14908 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14910 
îr‹
:

14911 
i
 = 0; i < 
√w_åiggîs
.
n_∑âîns
; i++)

14912 
	`k‰ì
(
√w_åiggîs
.
∑âîns
[
i
].
mask
);

14913 
	`k‰ì
(
√w_åiggîs
.
∑âîns
);

14914 i‡(
√w_åiggîs
.
t˝
 &&Çew_åiggîs.t˝->
sock
)

14915 
	`sock_ªÀa£
(
√w_åiggîs
.
t˝
->
sock
);

14916 
	`k‰ì
(
√w_åiggîs
.
t˝
);

14917 
	`k‰ì
(
√w_åiggîs
.
nd_c⁄fig
);

14918 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14919  
îr
;

14920 
	}
}

14923 
	$∆80211_£nd_cﬂÀs˚_ruÀs
(
sk_buff
 *
msg
,

14924 
cfg80211_ªgi°îed_devi˚
 *
rdev
)

14926 
∆©å
 *
∆_∑ts
, *
∆_∑t
, *
∆_ruÀ
, *
∆_ruÀs
;

14927 
i
, 
j
, 
∑t_Àn
;

14928 
cfg80211_cﬂÀs˚_ruÀs
 *
ruÀ
;

14930 i‡(!
rdev
->
cﬂÀs˚
->
n_ruÀs
)

14933 
∆_ruÀs
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_COALESCE_RULE
);

14934 i‡(!
∆_ruÀs
)

14935  -
ENOBUFS
;

14937 
i
 = 0; i < 
rdev
->
cﬂÀs˚
->
n_ruÀs
; i++) {

14938 
∆_ruÀ
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
i
 + 1);

14939 i‡(!
∆_ruÀ
)

14940  -
ENOBUFS
;

14942 
ruÀ
 = &
rdev
->
cﬂÀs˚
->
ruÀs
[
i
];

14943 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_COALESCE_RULE_DELAY
,

14944 
ruÀ
->
dñay
))

14945  -
ENOBUFS
;

14947 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_COALESCE_RULE_CONDITION
,

14948 
ruÀ
->
c⁄dôi⁄
))

14949  -
ENOBUFS
;

14951 
∆_∑ts
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

14952 
NL80211_ATTR_COALESCE_RULE_PKT_PATTERN
);

14953 i‡(!
∆_∑ts
)

14954  -
ENOBUFS
;

14956 
j
 = 0; j < 
ruÀ
->
n_∑âîns
; j++) {

14957 
∆_∑t
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
j
 + 1);

14958 i‡(!
∆_∑t
)

14959  -
ENOBUFS
;

14960 
∑t_Àn
 = 
ruÀ
->
∑âîns
[
j
].
∑âîn_Àn
;

14961 i‡(
	`∆a_put
(
msg
, 
NL80211_PKTPAT_MASK
,

14962 
	`DIV_ROUND_UP
(
∑t_Àn
, 8),

14963 
ruÀ
->
∑âîns
[
j
].
mask
) ||

14964 
	`∆a_put
(
msg
, 
NL80211_PKTPAT_PATTERN
, 
∑t_Àn
,

14965 
ruÀ
->
∑âîns
[
j
].
∑âîn
) ||

14966 
	`∆a_put_u32
(
msg
, 
NL80211_PKTPAT_OFFSET
,

14967 
ruÀ
->
∑âîns
[
j
].
pkt_off£t
))

14968  -
ENOBUFS
;

14969 
	`∆a_√°_íd
(
msg
, 
∆_∑t
);

14971 
	`∆a_√°_íd
(
msg
, 
∆_∑ts
);

14972 
	`∆a_√°_íd
(
msg
, 
∆_ruÀ
);

14974 
	`∆a_√°_íd
(
msg
, 
∆_ruÀs
);

14977 
	}
}

14979 
	$∆80211_gë_cﬂÀs˚
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

14981 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

14982 
sk_buff
 *
msg
;

14983 *
hdr
;

14985 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

14987 i‡(!
rdev
->
wùhy
.
cﬂÀs˚
) {

14988 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14989  -
EOPNOTSUPP
;

14992 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

14993 i‡(!
msg
) {

14994 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

14995  -
ENOMEM
;

14998 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

14999 
NL80211_CMD_GET_COALESCE
);

15000 i‡(!
hdr
) {

15001 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15002 
∆a_put_Áûuª
;

15005 i‡(
rdev
->
cﬂÀs˚
 && 
	`∆80211_£nd_cﬂÀs˚_ruÀs
(
msg
,Ñdev)) {

15006 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15007 
∆a_put_Áûuª
;

15010 
	`gílmsg_íd
(
msg
, 
hdr
);

15011 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15012  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

15014 
∆a_put_Áûuª
:

15015 
	`∆msg_‰ì
(
msg
);

15016 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15017  -
ENOBUFS
;

15018 
	}
}

15020 
	$cfg80211_rdev_‰ì_cﬂÀs˚
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

15022 
cfg80211_cﬂÀs˚
 *
cﬂÀs˚
 = 
rdev
->coalesce;

15023 
i
, 
j
;

15024 
cfg80211_cﬂÀs˚_ruÀs
 *
ruÀ
;

15026 i‡(!
cﬂÀs˚
)

15029 
i
 = 0; i < 
cﬂÀs˚
->
n_ruÀs
; i++) {

15030 
ruÀ
 = &
cﬂÀs˚
->
ruÀs
[
i
];

15031 
j
 = 0; j < 
ruÀ
->
n_∑âîns
; j++)

15032 
	`k‰ì
(
ruÀ
->
∑âîns
[
j
].
mask
);

15033 
	`k‰ì
(
ruÀ
->
∑âîns
);

15035 
	`k‰ì
(
cﬂÀs˚
->
ruÀs
);

15036 
	`k‰ì
(
cﬂÀs˚
);

15037 
rdev
->
cﬂÀs˚
 = 
NULL
;

15038 
	}
}

15040 
	$∆80211_∑r£_cﬂÀs˚_ruÀ
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

15041 
∆©å
 *
ruÀ
,

15042 
cfg80211_cﬂÀs˚_ruÀs
 *
√w_ruÀ
)

15044 
îr
, 
i
;

15045 c⁄° 
wùhy_cﬂÀs˚_suµ‹t
 *
cﬂÀs˚
 = 
rdev
->
wùhy
.coalesce;

15046 
∆©å
 *
tb
[
NUM_NL80211_ATTR_COALESCE_RULE
], *
∑t
;

15047 
ªm
, 
∑t_Àn
, 
mask_Àn
, 
pkt_off£t
, 
n_∑âîns
 = 0;

15048 
∆©å
 *
∑t_tb
[
NUM_NL80211_PKTPAT
];

15050 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
NL80211_ATTR_COALESCE_RULE_MAX
,

15051 
ruÀ
, 
∆80211_cﬂÀs˚_pﬁicy
, 
NULL
);

15052 i‡(
îr
)

15053  
îr
;

15055 i‡(
tb
[
NL80211_ATTR_COALESCE_RULE_DELAY
])

15056 
√w_ruÀ
->
dñay
 =

15057 
	`∆a_gë_u32
(
tb
[
NL80211_ATTR_COALESCE_RULE_DELAY
]);

15058 i‡(
√w_ruÀ
->
dñay
 > 
cﬂÀs˚
->
max_dñay
)

15059  -
EINVAL
;

15061 i‡(
tb
[
NL80211_ATTR_COALESCE_RULE_CONDITION
])

15062 
√w_ruÀ
->
c⁄dôi⁄
 =

15063 
	`∆a_gë_u32
(
tb
[
NL80211_ATTR_COALESCE_RULE_CONDITION
]);

15065 i‡(!
tb
[
NL80211_ATTR_COALESCE_RULE_PKT_PATTERN
])

15066  -
EINVAL
;

15068 
	`∆a_f‹_óch_√°ed
(
∑t
, 
tb
[
NL80211_ATTR_COALESCE_RULE_PKT_PATTERN
],

15069 
ªm
)

15070 
n_∑âîns
++;

15071 i‡(
n_∑âîns
 > 
cﬂÀs˚
->n_patterns)

15072  -
EINVAL
;

15074 
√w_ruÀ
->
∑âîns
 = 
	`kˇŒoc
(
n_∑âîns
, (new_rule->patterns[0]),

15075 
GFP_KERNEL
);

15076 i‡(!
√w_ruÀ
->
∑âîns
)

15077  -
ENOMEM
;

15079 
√w_ruÀ
->
n_∑âîns
 =Ç_patterns;

15080 
i
 = 0;

15082 
	`∆a_f‹_óch_√°ed
(
∑t
, 
tb
[
NL80211_ATTR_COALESCE_RULE_PKT_PATTERN
],

15083 
ªm
) {

15084 
u8
 *
mask_∑t
;

15086 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
∑t_tb
, 
MAX_NL80211_PKTPAT
,

15087 
∑t
,

15088 
∆80211_∑ckë_∑âîn_pﬁicy
,

15089 
NULL
);

15090 i‡(
îr
)

15091  
îr
;

15093 i‡(!
∑t_tb
[
NL80211_PKTPAT_MASK
] ||

15094 !
∑t_tb
[
NL80211_PKTPAT_PATTERN
])

15095  -
EINVAL
;

15096 
∑t_Àn
 = 
	`∆a_Àn
(
∑t_tb
[
NL80211_PKTPAT_PATTERN
]);

15097 
mask_Àn
 = 
	`DIV_ROUND_UP
(
∑t_Àn
, 8);

15098 i‡(
	`∆a_Àn
(
∑t_tb
[
NL80211_PKTPAT_MASK
]Ë!
mask_Àn
)

15099  -
EINVAL
;

15100 i‡(
∑t_Àn
 > 
cﬂÀs˚
->
∑âîn_max_Àn
 ||

15101 
∑t_Àn
 < 
cﬂÀs˚
->
∑âîn_mö_Àn
)

15102  -
EINVAL
;

15104 i‡(!
∑t_tb
[
NL80211_PKTPAT_OFFSET
])

15105 
pkt_off£t
 = 0;

15107 
pkt_off£t
 = 
	`∆a_gë_u32
(
∑t_tb
[
NL80211_PKTPAT_OFFSET
]);

15108 i‡(
pkt_off£t
 > 
cﬂÀs˚
->
max_pkt_off£t
)

15109  -
EINVAL
;

15110 
√w_ruÀ
->
∑âîns
[
i
].
pkt_off£t
 =Ökt_offset;

15112 
mask_∑t
 = 
	`kmÆloc
(
mask_Àn
 + 
∑t_Àn
, 
GFP_KERNEL
);

15113 i‡(!
mask_∑t
)

15114  -
ENOMEM
;

15116 
√w_ruÀ
->
∑âîns
[
i
].
mask
 = 
mask_∑t
;

15117 
	`mem˝y
(
mask_∑t
, 
	`∆a_d©a
(
∑t_tb
[
NL80211_PKTPAT_MASK
]),

15118 
mask_Àn
);

15120 
mask_∑t
 +
mask_Àn
;

15121 
√w_ruÀ
->
∑âîns
[
i
].
∑âîn
 = 
mask_∑t
;

15122 
√w_ruÀ
->
∑âîns
[
i
].
∑âîn_Àn
 = 
∑t_Àn
;

15123 
	`mem˝y
(
mask_∑t
, 
	`∆a_d©a
(
∑t_tb
[
NL80211_PKTPAT_PATTERN
]),

15124 
∑t_Àn
);

15125 
i
++;

15129 
	}
}

15131 
	$∆80211_£t_cﬂÀs˚
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

15133 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

15134 c⁄° 
wùhy_cﬂÀs˚_suµ‹t
 *
cﬂÀs˚
 = 
rdev
->
wùhy
.coalesce;

15135 
cfg80211_cﬂÀs˚
 
√w_cﬂÀs˚
 = {};

15136 
cfg80211_cﬂÀs˚
 *
n_cﬂÀs˚
;

15137 
îr
, 
ªm_ruÀ
, 
n_ruÀs
 = 0, 
i
, 
j
;

15138 
∆©å
 *
ruÀ
;

15139 
cfg80211_cﬂÀs˚_ruÀs
 *
tmp_ruÀ
;

15141 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

15143 i‡(!
rdev
->
wùhy
.
cﬂÀs˚
 || !rdev->
›s
->
£t_cﬂÀs˚
) {

15144 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15145  -
EOPNOTSUPP
;

15148 i‡(!
öfo
->
©ås
[
NL80211_ATTR_COALESCE_RULE
]) {

15149 
	`cfg80211_rdev_‰ì_cﬂÀs˚
(
rdev
);

15150 
	`rdev_£t_cﬂÀs˚
(
rdev
, 
NULL
);

15151 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15155 
	`∆a_f‹_óch_√°ed
(
ruÀ
, 
öfo
->
©ås
[
NL80211_ATTR_COALESCE_RULE
],

15156 
ªm_ruÀ
)

15157 
n_ruÀs
++;

15158 i‡(
n_ruÀs
 > 
cﬂÀs˚
->n_rules) {

15159 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15160  -
EINVAL
;

15163 
√w_cﬂÀs˚
.
ruÀs
 = 
	`kˇŒoc
(
n_ruÀs
, (new_coalesce.rules[0]),

15164 
GFP_KERNEL
);

15165 i‡(!
√w_cﬂÀs˚
.
ruÀs
) {

15166 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15167  -
ENOMEM
;

15170 
√w_cﬂÀs˚
.
n_ruÀs
 =Ç_rules;

15171 
i
 = 0;

15173 
	`∆a_f‹_óch_√°ed
(
ruÀ
, 
öfo
->
©ås
[
NL80211_ATTR_COALESCE_RULE
],

15174 
ªm_ruÀ
) {

15175 
îr
 = 
	`∆80211_∑r£_cﬂÀs˚_ruÀ
(
rdev
, 
ruÀ
,

15176 &
√w_cﬂÀs˚
.
ruÀs
[
i
]);

15177 i‡(
îr
) {

15178 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15179 
îr‹
;

15182 
i
++;

15185 
îr
 = 
	`rdev_£t_cﬂÀs˚
(
rdev
, &
√w_cﬂÀs˚
);

15186 i‡(
îr
) {

15187 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15188 
îr‹
;

15191 
n_cﬂÀs˚
 = 
	`kmemdup
(&
√w_cﬂÀs˚
, “ew_cﬂÀs˚), 
GFP_KERNEL
);

15192 i‡(!
n_cﬂÀs˚
) {

15193 
îr
 = -
ENOMEM
;

15194 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15195 
îr‹
;

15197 
	`cfg80211_rdev_‰ì_cﬂÀs˚
(
rdev
);

15198 
rdev
->
cﬂÀs˚
 = 
n_cﬂÀs˚
;

15200 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15202 
îr‹
:

15203 
i
 = 0; i < 
√w_cﬂÀs˚
.
n_ruÀs
; i++) {

15204 
tmp_ruÀ
 = &
√w_cﬂÀs˚
.
ruÀs
[
i
];

15205 i‡(!
tmp_ruÀ
)

15207 
j
 = 0; j < 
tmp_ruÀ
->
n_∑âîns
; j++)

15208 
	`k‰ì
(
tmp_ruÀ
->
∑âîns
[
j
].
mask
);

15209 
	`k‰ì
(
tmp_ruÀ
->
∑âîns
);

15211 
	`k‰ì
(
√w_cﬂÀs˚
.
ruÀs
);

15213 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15214  
îr
;

15215 
	}
}

15217 
	$∆80211_£t_ªkey_d©a
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

15219 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

15220 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

15221 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

15222 
∆©å
 *
tb
[
NUM_NL80211_REKEY_DATA
];

15223 
cfg80211_gtk_ªkey_d©a
 
ªkey_d©a
 = {};

15224 
îr
;

15226 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

15228 i‡(!
öfo
->
©ås
[
NL80211_ATTR_REKEY_DATA
]) {

15229 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15230  -
EINVAL
;

15233 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
MAX_NL80211_REKEY_DATA
,

15234 
öfo
->
©ås
[
NL80211_ATTR_REKEY_DATA
],

15235 
∆80211_ªkey_pﬁicy
, 
öfo
->
exèck
);

15236 i‡(
îr
) {

15237 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15238  
îr
;

15241 i‡(!
tb
[
NL80211_REKEY_DATA_REPLAY_CTR
] || !tb[
NL80211_REKEY_DATA_KEK
] ||

15242 !
tb
[
NL80211_REKEY_DATA_KCK
]) {

15243 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15244  -
EINVAL
;

15246 i‡(
	`∆a_Àn
(
tb
[
NL80211_REKEY_DATA_KEK
]Ë!
NL80211_KEK_LEN
 &&

15247 !(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_EXT_KEK_KCK
 &&

15248 
	`∆a_Àn
(
tb
[
NL80211_REKEY_DATA_KEK
]Ë=
NL80211_KEK_EXT_LEN
)) {

15249 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15250  -
ERANGE
;

15252 i‡(
	`∆a_Àn
(
tb
[
NL80211_REKEY_DATA_KCK
]Ë!
NL80211_KCK_LEN
 &&

15253 !(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_EXT_KEK_KCK
 &&

15254 
	`∆a_Àn
(
tb
[
NL80211_REKEY_DATA_KCK
]Ë=
NL80211_KCK_EXT_LEN
) &&

15255 !(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SUPPORTS_EXT_KCK_32
 &&

15256 
	`∆a_Àn
(
tb
[
NL80211_REKEY_DATA_KCK
]Ë=
NL80211_KCK_EXT_LEN_32
)) {

15257 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15258  -
ERANGE
;

15261 
ªkey_d©a
.
kek
 = 
	`∆a_d©a
(
tb
[
NL80211_REKEY_DATA_KEK
]);

15262 
ªkey_d©a
.
kck
 = 
	`∆a_d©a
(
tb
[
NL80211_REKEY_DATA_KCK
]);

15263 
ªkey_d©a
.
ª∂ay_˘r
 = 
	`∆a_d©a
(
tb
[
NL80211_REKEY_DATA_REPLAY_CTR
]);

15264 
ªkey_d©a
.
kek_Àn
 = 
	`∆a_Àn
(
tb
[
NL80211_REKEY_DATA_KEK
]);

15265 
ªkey_d©a
.
kck_Àn
 = 
	`∆a_Àn
(
tb
[
NL80211_REKEY_DATA_KCK
]);

15266 i‡(
tb
[
NL80211_REKEY_DATA_AKM
])

15267 
ªkey_d©a
.
akm
 = 
	`∆a_gë_u32
(
tb
[
NL80211_REKEY_DATA_AKM
]);

15269 i‡(!
wdev
->
c⁄√˘ed
) {

15270 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15271  -
ENOTCONN
;

15274 i‡(!
rdev
->
›s
->
£t_ªkey_d©a
) {

15275 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15276  -
EOPNOTSUPP
;

15279 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

15280  
	`rdev_£t_ªkey_d©a
(
rdev
, 
dev
, &
ªkey_d©a
);

15281 
	}
}

15283 
	$∆80211_ªgi°î_u√x≥˘ed_‰ame
(
sk_buff
 *
skb
,

15284 
gíl_öfo
 *
öfo
)

15286 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

15287 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

15289 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

15291 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

15292 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

15293 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15294  -
EINVAL
;

15297 i‡(
wdev
->
≠_u√x≥˘ed_∆p‹tid
) {

15298 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15299  -
EBUSY
;

15302 
wdev
->
≠_u√x≥˘ed_∆p‹tid
 = 
öfo
->
¢d_p‹tid
;

15303 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15305 
	}
}

15307 
	$∆80211_¥obe_˛õ¡
(
sk_buff
 *
skb
,

15308 
gíl_öfo
 *
öfo
)

15310 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

15311 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

15312 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

15313 
sk_buff
 *
msg
;

15314 *
hdr
;

15315 c⁄° 
u8
 *
addr
;

15316 
u64
 
cookõ
;

15317 
îr
;

15319 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

15321 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

15322 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

15323 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15324  -
EOPNOTSUPP
;

15327 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

15328 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15329  -
EINVAL
;

15332 i‡(!
rdev
->
›s
->
¥obe_˛õ¡
) {

15333 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15334  -
EOPNOTSUPP
;

15337 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

15338 i‡(!
msg
) {

15339 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15340  -
ENOMEM
;

15343 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

15344 
NL80211_CMD_PROBE_CLIENT
);

15345 i‡(!
hdr
) {

15346 
îr
 = -
ENOBUFS
;

15347 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15348 
‰ì_msg
;

15351 
addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

15353 
îr
 = 
	`rdev_¥obe_˛õ¡
(
rdev
, 
dev
, 
addr
, &
cookõ
);

15354 i‡(
îr
) {

15355 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15356 
‰ì_msg
;

15359 i‡(
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
cookõ
,

15360 
NL80211_ATTR_PAD
)) {

15361 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15362 
∆a_put_Áûuª
;

15365 
	`gílmsg_íd
(
msg
, 
hdr
);

15367 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15368  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

15370 
∆a_put_Áûuª
:

15371 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15372 
îr
 = -
ENOBUFS
;

15373 
‰ì_msg
:

15374 
	`∆msg_‰ì
(
msg
);

15375 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15376  
îr
;

15377 
	}
}

15379 
	$∆80211_ªgi°î_bóc⁄s
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

15381 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

15382 
cfg80211_bóc⁄_ªgi°øti⁄
 *
ªg
, *
ƒeg
;

15383 
rv
;

15385 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

15387 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_REPORTS_OBSS
)) {

15388 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15389  -
EOPNOTSUPP
;

15392 
ƒeg
 = 
	`kzÆloc
((*ƒeg), 
GFP_KERNEL
);

15393 i‡(!
ƒeg
) {

15394 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15395  -
ENOMEM
;

15399 
	`•ö_lock_bh
(&
rdev
->
bóc⁄_ªgi°øti⁄s_lock
);

15400 
	`li°_f‹_óch_íåy
(
ªg
, &
rdev
->
bóc⁄_ªgi°øti⁄s
, 
li°
) {

15401 i‡(
ªg
->
∆p‹tid
 =
öfo
->
¢d_p‹tid
) {

15402 
rv
 = -
EALREADY
;

15403 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15404 
out_îr
;

15408 
ƒeg
->
∆p‹tid
 = 
öfo
->
¢d_p‹tid
;

15409 
	`li°_add
(&
ƒeg
->
li°
, &
rdev
->
bóc⁄_ªgi°øti⁄s
);

15411 
	`•ö_u∆ock_bh
(&
rdev
->
bóc⁄_ªgi°øti⁄s_lock
);

15413 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15415 
out_îr
:

15416 
	`•ö_u∆ock_bh
(&
rdev
->
bóc⁄_ªgi°øti⁄s_lock
);

15417 
	`k‰ì
(
ƒeg
);

15418 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15419  
rv
;

15420 
	}
}

15422 
	$∆80211_°¨t_p2p_devi˚
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

15424 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

15425 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

15426 
îr
;

15428 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

15430 i‡(!
rdev
->
›s
->
°¨t_p2p_devi˚
) {

15431 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15432  -
EOPNOTSUPP
;

15435 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_DEVICE
) {

15436 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15437  -
EOPNOTSUPP
;

15440 i‡(
	`wdev_ru¬ög
(
wdev
)) {

15441 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15445 i‡(
	`rfkûl_blocked
(
rdev
->
wùhy
.
rfkûl
)) {

15446 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15447  -
ERFKILL
;

15450 
îr
 = 
	`rdev_°¨t_p2p_devi˚
(
rdev
, 
wdev
);

15451 i‡(
îr
) {

15452 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15453  
îr
;

15456 
wdev
->
is_ru¬ög
 = 
åue
;

15457 
rdev
->
›ícou¡
++;

15459 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

15461 
	}
}

15463 
	$∆80211_°›_p2p_devi˚
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

15465 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

15466 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

15468 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

15470 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_DEVICE
) {

15471 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15472  -
EOPNOTSUPP
;

15475 i‡(!
rdev
->
›s
->
°›_p2p_devi˚
) {

15476 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15477  -
EOPNOTSUPP
;

15480 
	`cfg80211_°›_p2p_devi˚
(
rdev
, 
wdev
);

15482 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15484 
	}
}

15486 
	$∆80211_°¨t_«n
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

15488 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

15489 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

15490 
cfg80211_«n_c⁄f
 
c⁄f
 = {};

15491 
îr
;

15493 
	`¥_öfo
("[%s] [%d] : ENRY\n", 
__func__
, 
__LINE__
);

15495 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_NAN
) {

15496 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15497  -
EOPNOTSUPP
;

15500 i‡(
	`wdev_ru¬ög
(
wdev
)) {

15501 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15502  -
EEXIST
;

15505 i‡(
	`rfkûl_blocked
(
rdev
->
wùhy
.
rfkûl
)) {

15506 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15507  -
ERFKILL
;

15511 i‡(!
öfo
->
©ås
[
NL80211_ATTR_NAN_MASTER_PREF
]) {

15512 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15513  -
EINVAL
;

15516 
c⁄f
.
ma°î_¥ef
 =

15517 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_NAN_MASTER_PREF
]);

15519 i‡(
öfo
->
©ås
[
NL80211_ATTR_BANDS
]) {

15520 
u32
 
b™ds
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_BANDS
]);

15522 i‡(
b™ds
 & ~(
u32
)
wdev
->
wùhy
->
«n_suµ‹ãd_b™ds
) {

15523 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15524  -
EOPNOTSUPP
;

15527 i‡(
b™ds
 && !(b™d†& 
	`BIT
(
NL80211_BAND_2GHZ
))) {

15528 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15529  -
EINVAL
;

15532 
c⁄f
.
b™ds
 = bands;

15535 
îr
 = 
	`rdev_°¨t_«n
(
rdev
, 
wdev
, &
c⁄f
);

15536 i‡(
îr
) {

15537 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15538  
îr
;

15541 
wdev
->
is_ru¬ög
 = 
åue
;

15542 
rdev
->
›ícou¡
++;

15544 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15546 
	}
}

15548 
	$∆80211_°›_«n
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

15550 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

15551 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

15553 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

15555 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_NAN
) {

15556 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15557  -
EOPNOTSUPP
;

15560 
	`cfg80211_°›_«n
(
rdev
, 
wdev
);

15562 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15564 
	}
}

15566 
	$vÆid©e_«n_fûãr
(
∆©å
 *
fûãr_©å
)

15568 
∆©å
 *
©å
;

15569 
Àn
 = 0, 
n_íåõs
 = 0, 
ªm
;

15571 
	`∆a_f‹_óch_√°ed
(
©å
, 
fûãr_©å
, 
ªm
) {

15572 
Àn
 +
	`∆a_Àn
(
©å
);

15573 
n_íåõs
++;

15576 i‡(
Àn
 >
U8_MAX
)

15577  -
EINVAL
;

15579  
n_íåõs
;

15580 
	}
}

15582 
	$h™dÀ_«n_fûãr
(
∆©å
 *
©å_fûãr
,

15583 
cfg80211_«n_func
 *
func
,

15584 
boﬁ
 
tx
)

15586 
∆©å
 *
©å
;

15587 
n_íåõs
, 
ªm
, 
i
;

15588 
cfg80211_«n_func_fûãr
 *
fûãr
;

15590 
n_íåõs
 = 
	`vÆid©e_«n_fûãr
(
©å_fûãr
);

15591 i‡(
n_íåõs
 < 0)

15592  
n_íåõs
;

15594 
	`BUILD_BUG_ON
((*
func
->
rx_fûãrs
Ë!(*func->
tx_fûãrs
));

15596 
fûãr
 = 
	`kˇŒoc
(
n_íåõs
, (*
func
->
rx_fûãrs
), 
GFP_KERNEL
);

15597 i‡(!
fûãr
)

15598  -
ENOMEM
;

15600 
i
 = 0;

15601 
	`∆a_f‹_óch_√°ed
(
©å
, 
©å_fûãr
, 
ªm
) {

15602 
fûãr
[
i
].fûã∏
	`∆a_memdup
(
©å
, 
GFP_KERNEL
);

15603 i‡(!
fûãr
[
i
].filter)

15604 
îr
;

15606 
fûãr
[
i
].
Àn
 = 
	`∆a_Àn
(
©å
);

15607 
i
++;

15609 i‡(
tx
) {

15610 
func
->
num_tx_fûãrs
 = 
n_íåõs
;

15611 
func
->
tx_fûãrs
 = 
fûãr
;

15613 
func
->
num_rx_fûãrs
 = 
n_íåõs
;

15614 
func
->
rx_fûãrs
 = 
fûãr
;

15619 
îr
:

15620 
i
 = 0;

15621 
	`∆a_f‹_óch_√°ed
(
©å
, 
©å_fûãr
, 
ªm
) {

15622 
	`k‰ì
(
fûãr
[
i
].filter);

15623 
i
++;

15625 
	`k‰ì
(
fûãr
);

15626  -
ENOMEM
;

15627 
	}
}

15629 
	$∆80211_«n_add_func
(
sk_buff
 *
skb
,

15630 
gíl_öfo
 *
öfo
)

15632 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

15633 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

15634 
∆©å
 *
tb
[
NUM_NL80211_NAN_FUNC_ATTR
], *
func_©å
;

15635 
cfg80211_«n_func
 *
func
;

15636 
sk_buff
 *
msg
 = 
NULL
;

15637 *
hdr
 = 
NULL
;

15638 
îr
 = 0;

15640 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

15642 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_NAN
) {

15643 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15644  -
EOPNOTSUPP
;

15647 i‡(!
	`wdev_ru¬ög
(
wdev
)) {

15648 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15649  -
ENOTCONN
;

15652 i‡(!
öfo
->
©ås
[
NL80211_ATTR_NAN_FUNC
]) {

15653 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15654  -
EINVAL
;

15657 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
NL80211_NAN_FUNC_ATTR_MAX
,

15658 
öfo
->
©ås
[
NL80211_ATTR_NAN_FUNC
],

15659 
∆80211_«n_func_pﬁicy
,

15660 
öfo
->
exèck
);

15661 i‡(
îr
) {

15662 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15663  
îr
;

15666 
func
 = 
	`kzÆloc
((*func), 
GFP_KERNEL
);

15667 i‡(!
func
) {

15668 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15669  -
ENOMEM
;

15672 
func
->
cookõ
 = 
	`cfg80211_assign_cookõ
(
rdev
);

15674 i‡(!
tb
[
NL80211_NAN_FUNC_TYPE
]) {

15675 
îr
 = -
EINVAL
;

15676 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15677 
out
;

15681 
func
->
ty≥
 = 
	`∆a_gë_u8
(
tb
[
NL80211_NAN_FUNC_TYPE
]);

15683 i‡(!
tb
[
NL80211_NAN_FUNC_SERVICE_ID
]) {

15684 
îr
 = -
EINVAL
;

15685 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15686 
out
;

15689 
	`mem˝y
(
func
->
£rvi˚_id
, 
	`∆a_d©a
(
tb
[
NL80211_NAN_FUNC_SERVICE_ID
]),

15690 (
func
->
£rvi˚_id
));

15692 
func
->
˛o£_ønge
 =

15693 
	`∆a_gë_Êag
(
tb
[
NL80211_NAN_FUNC_CLOSE_RANGE
]);

15695 i‡(
tb
[
NL80211_NAN_FUNC_SERVICE_INFO
]) {

15696 
func
->
£rv_•ec_öfo_Àn
 =

15697 
	`∆a_Àn
(
tb
[
NL80211_NAN_FUNC_SERVICE_INFO
]);

15698 
func
->
£rv_•ec_öfo
 =

15699 
	`kmemdup
(
	`∆a_d©a
(
tb
[
NL80211_NAN_FUNC_SERVICE_INFO
]),

15700 
func
->
£rv_•ec_öfo_Àn
,

15701 
GFP_KERNEL
);

15702 i‡(!
func
->
£rv_•ec_öfo
) {

15703 
îr
 = -
ENOMEM
;

15704 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15705 
out
;

15709 i‡(
tb
[
NL80211_NAN_FUNC_TTL
])

15710 
func
->
âl
 = 
	`∆a_gë_u32
(
tb
[
NL80211_NAN_FUNC_TTL
]);

15712 
func
->
ty≥
) {

15713 
NL80211_NAN_FUNC_PUBLISH
:

15714 i‡(!
tb
[
NL80211_NAN_FUNC_PUBLISH_TYPE
]) {

15715 
îr
 = -
EINVAL
;

15716 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15717 
out
;

15720 
func
->
publish_ty≥
 =

15721 
	`∆a_gë_u8
(
tb
[
NL80211_NAN_FUNC_PUBLISH_TYPE
]);

15722 
func
->
publish_bˇ°
 =

15723 
	`∆a_gë_Êag
(
tb
[
NL80211_NAN_FUNC_PUBLISH_BCAST
]);

15725 i‡((!(
func
->
publish_ty≥
 & 
NL80211_NAN_SOLICITED_PUBLISH
)) &&

15726 
func
->
publish_bˇ°
) {

15727 
îr
 = -
EINVAL
;

15728 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15729 
out
;

15731 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15733 
NL80211_NAN_FUNC_SUBSCRIBE
:

15734 
func
->
subs¸ibe_a˘ive
 =

15735 
	`∆a_gë_Êag
(
tb
[
NL80211_NAN_FUNC_SUBSCRIBE_ACTIVE
]);

15736 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15738 
NL80211_NAN_FUNC_FOLLOW_UP
:

15739 i‡(!
tb
[
NL80211_NAN_FUNC_FOLLOW_UP_ID
] ||

15740 !
tb
[
NL80211_NAN_FUNC_FOLLOW_UP_REQ_ID
] ||

15741 !
tb
[
NL80211_NAN_FUNC_FOLLOW_UP_DEST
]) {

15742 
îr
 = -
EINVAL
;

15743 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15744 
out
;

15747 
func
->
fﬁlowup_id
 =

15748 
	`∆a_gë_u8
(
tb
[
NL80211_NAN_FUNC_FOLLOW_UP_ID
]);

15749 
func
->
fﬁlowup_ªqid
 =

15750 
	`∆a_gë_u8
(
tb
[
NL80211_NAN_FUNC_FOLLOW_UP_REQ_ID
]);

15751 
	`mem˝y
(
func
->
fﬁlowup_de°
.
addr
,

15752 
	`∆a_d©a
(
tb
[
NL80211_NAN_FUNC_FOLLOW_UP_DEST
]),

15753 (
func
->
fﬁlowup_de°
.
addr
));

15754 i‡(
func
->
âl
) {

15755 
îr
 = -
EINVAL
;

15756 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15757 
out
;

15759 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15762 
îr
 = -
EINVAL
;

15763 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15764 
out
;

15767 i‡(
tb
[
NL80211_NAN_FUNC_SRF
]) {

15768 
∆©å
 *
§f_tb
[
NUM_NL80211_NAN_SRF_ATTR
];

15770 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
§f_tb
,

15771 
NL80211_NAN_SRF_ATTR_MAX
,

15772 
tb
[
NL80211_NAN_FUNC_SRF
],

15773 
∆80211_«n_§f_pﬁicy
,

15774 
öfo
->
exèck
);

15775 i‡(
îr
) {

15776 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15777 
out
;

15780 
func
->
§f_ö˛ude
 =

15781 
	`∆a_gë_Êag
(
§f_tb
[
NL80211_NAN_SRF_INCLUDE
]);

15783 i‡(
§f_tb
[
NL80211_NAN_SRF_BF
]) {

15784 i‡(
§f_tb
[
NL80211_NAN_SRF_MAC_ADDRS
] ||

15785 !
§f_tb
[
NL80211_NAN_SRF_BF_IDX
]) {

15786 
îr
 = -
EINVAL
;

15787 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15788 
out
;

15791 
func
->
§f_bf_Àn
 =

15792 
	`∆a_Àn
(
§f_tb
[
NL80211_NAN_SRF_BF
]);

15793 
func
->
§f_bf
 =

15794 
	`kmemdup
(
	`∆a_d©a
(
§f_tb
[
NL80211_NAN_SRF_BF
]),

15795 
func
->
§f_bf_Àn
, 
GFP_KERNEL
);

15796 i‡(!
func
->
§f_bf
) {

15797 
îr
 = -
ENOMEM
;

15798 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15799 
out
;

15802 
func
->
§f_bf_idx
 =

15803 
	`∆a_gë_u8
(
§f_tb
[
NL80211_NAN_SRF_BF_IDX
]);

15805 
∆©å
 *
©å
, *
mac_©å
 =

15806 
§f_tb
[
NL80211_NAN_SRF_MAC_ADDRS
];

15807 
n_íåõs
, 
ªm
, 
i
 = 0;

15809 i‡(!
mac_©å
) {

15810 
îr
 = -
EINVAL
;

15811 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15812 
out
;

15815 
n_íåõs
 = 
	`vÆid©e_a˛_mac_addrs
(
mac_©å
);

15816 i‡(
n_íåõs
 <= 0) {

15817 
îr
 = -
EINVAL
;

15818 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15819 
out
;

15822 
func
->
§f_num_macs
 = 
n_íåõs
;

15823 
func
->
§f_macs
 =

15824 
	`kˇŒoc
(
n_íåõs
, (*
func
->
§f_macs
),

15825 
GFP_KERNEL
);

15826 i‡(!
func
->
§f_macs
) {

15827 
îr
 = -
ENOMEM
;

15828 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15829 
out
;

15832 
	`∆a_f‹_óch_√°ed
(
©å
, 
mac_©å
, 
ªm
)

15833 
	`mem˝y
(
func
->
§f_macs
[
i
++].
addr
, 
	`∆a_d©a
(
©å
),

15834 (*
func
->
§f_macs
));

15838 i‡(
tb
[
NL80211_NAN_FUNC_TX_MATCH_FILTER
]) {

15839 
îr
 = 
	`h™dÀ_«n_fûãr
(
tb
[
NL80211_NAN_FUNC_TX_MATCH_FILTER
],

15840 
func
, 
åue
);

15841 i‡(
îr
) {

15842 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15843 
out
;

15847 i‡(
tb
[
NL80211_NAN_FUNC_RX_MATCH_FILTER
]) {

15848 
îr
 = 
	`h™dÀ_«n_fûãr
(
tb
[
NL80211_NAN_FUNC_RX_MATCH_FILTER
],

15849 
func
, 
Ál£
);

15850 i‡(
îr
) {

15851 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15852 
out
;

15856 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

15857 i‡(!
msg
) {

15858 
îr
 = -
ENOMEM
;

15859 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15860 
out
;

15863 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

15864 
NL80211_CMD_ADD_NAN_FUNCTION
);

15866 i‡(
	`WARN_ON
(!
hdr
)) {

15867 
îr
 = -
ENOMEM
;

15868 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15869 
out
;

15872 
îr
 = 
	`rdev_add_«n_func
(
rdev
, 
wdev
, 
func
);

15873 
out
:

15874 i‡(
îr
 < 0) {

15875 
	`cfg80211_‰ì_«n_func
(
func
);

15876 
	`∆msg_‰ì
(
msg
);

15877 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15878  
îr
;

15882 i‡(
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
func
->
cookõ
,

15883 
NL80211_ATTR_PAD
)) {

15884 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15885 
∆a_put_Áûuª
;

15888 
func_©å
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_NAN_FUNC
);

15889 i‡(!
func_©å
) {

15890 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15891 
∆a_put_Áûuª
;

15894 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_NAN_FUNC_INSTANCE_ID
,

15895 
func
->
ö°™˚_id
)) {

15896 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15897 
∆a_put_Áûuª
;

15900 
	`∆a_√°_íd
(
msg
, 
func_©å
);

15902 
	`gílmsg_íd
(
msg
, 
hdr
);

15903 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15904  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

15906 
∆a_put_Áûuª
:

15907 
	`∆msg_‰ì
(
msg
);

15908 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15909  -
ENOBUFS
;

15910 
	}
}

15912 
	$∆80211_«n_dñ_func
(
sk_buff
 *
skb
,

15913 
gíl_öfo
 *
öfo
)

15915 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

15916 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

15917 
u64
 
cookõ
;

15919 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

15921 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_NAN
) {

15922 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15923  -
EOPNOTSUPP
;

15926 i‡(!
	`wdev_ru¬ög
(
wdev
)) {

15927 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15928  -
ENOTCONN
;

15931 i‡(!
öfo
->
©ås
[
NL80211_ATTR_COOKIE
]) {

15932 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15933  -
EINVAL
;

15936 
cookõ
 = 
	`∆a_gë_u64
(
öfo
->
©ås
[
NL80211_ATTR_COOKIE
]);

15938 
	`rdev_dñ_«n_func
(
rdev
, 
wdev
, 
cookõ
);

15940 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15942 
	}
}

15944 
	$∆80211_«n_ch™ge_c⁄fig
(
sk_buff
 *
skb
,

15945 
gíl_öfo
 *
öfo
)

15947 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

15948 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

15949 
cfg80211_«n_c⁄f
 
c⁄f
 = {};

15950 
u32
 
ch™ged
 = 0;

15952 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

15954 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_NAN
) {

15955 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15956  -
EOPNOTSUPP
;

15959 i‡(!
	`wdev_ru¬ög
(
wdev
)) {

15960 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15961  -
ENOTCONN
;

15964 i‡(
öfo
->
©ås
[
NL80211_ATTR_NAN_MASTER_PREF
]) {

15965 
c⁄f
.
ma°î_¥ef
 =

15966 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_NAN_MASTER_PREF
]);

15967 i‡(
c⁄f
.
ma°î_¥ef
 <= 1 || conf.master_pref == 255) {

15968 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15969  -
EINVAL
;

15972 
ch™ged
 |
CFG80211_NAN_CONF_CHANGED_PREF
;

15975 i‡(
öfo
->
©ås
[
NL80211_ATTR_BANDS
]) {

15976 
u32
 
b™ds
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_BANDS
]);

15978 i‡(
b™ds
 & ~(
u32
)
wdev
->
wùhy
->
«n_suµ‹ãd_b™ds
) {

15979 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15980  -
EOPNOTSUPP
;

15983 i‡(
b™ds
 && !(b™d†& 
	`BIT
(
NL80211_BAND_2GHZ
))) {

15984 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15985  -
EINVAL
;

15988 
c⁄f
.
b™ds
 = bands;

15989 
ch™ged
 |
CFG80211_NAN_CONF_CHANGED_BANDS
;

15992 i‡(!
ch™ged
) {

15993 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15994  -
EINVAL
;

15997 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

15998  
	`rdev_«n_ch™ge_c⁄f
(
rdev
, 
wdev
, &
c⁄f
, 
ch™ged
);

15999 
	}
}

16001 
	$cfg80211_«n_m©ch
(
wúñess_dev
 *
wdev
,

16002 
cfg80211_«n_m©ch_∑øms
 *
m©ch
, 
gÂ_t
 
gÂ
)

16004 
wùhy
 *wùhy = 
wdev
->wiphy;

16005 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

16006 
∆©å
 *
m©ch_©å
, *
loˇl_func_©å
, *
≥î_func_©å
;

16007 
sk_buff
 *
msg
;

16008 *
hdr
;

16010 i‡(
	`WARN_ON
(!
m©ch
->
ö°_id
 || !m©ch->
≥î_ö°_id
 || !m©ch->
addr
))

16013 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

16014 i‡(!
msg
)

16017 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_NAN_MATCH
);

16018 i‡(!
hdr
) {

16019 
	`∆msg_‰ì
(
msg
);

16023 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

16024 (
wdev
->
√tdev
 && 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
,

16025 
wdev
->
√tdev
->
ifödex
)) ||

16026 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

16027 
NL80211_ATTR_PAD
))

16028 
∆a_put_Áûuª
;

16030 i‡(
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
m©ch
->
cookõ
,

16031 
NL80211_ATTR_PAD
) ||

16032 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
m©ch
->
addr
))

16033 
∆a_put_Áûuª
;

16035 
m©ch_©å
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_NAN_MATCH
);

16036 i‡(!
m©ch_©å
)

16037 
∆a_put_Áûuª
;

16039 
loˇl_func_©å
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

16040 
NL80211_NAN_MATCH_FUNC_LOCAL
);

16041 i‡(!
loˇl_func_©å
)

16042 
∆a_put_Áûuª
;

16044 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_NAN_FUNC_INSTANCE_ID
, 
m©ch
->
ö°_id
))

16045 
∆a_put_Áûuª
;

16047 
	`∆a_√°_íd
(
msg
, 
loˇl_func_©å
);

16049 
≥î_func_©å
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

16050 
NL80211_NAN_MATCH_FUNC_PEER
);

16051 i‡(!
≥î_func_©å
)

16052 
∆a_put_Áûuª
;

16054 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_NAN_FUNC_TYPE
, 
m©ch
->
ty≥
) ||

16055 
	`∆a_put_u8
(
msg
, 
NL80211_NAN_FUNC_INSTANCE_ID
, 
m©ch
->
≥î_ö°_id
))

16056 
∆a_put_Áûuª
;

16058 i‡(
m©ch
->
öfo
 && m©ch->
öfo_Àn
 &&

16059 
	`∆a_put
(
msg
, 
NL80211_NAN_FUNC_SERVICE_INFO
, 
m©ch
->
öfo_Àn
,

16060 
m©ch
->
öfo
))

16061 
∆a_put_Áûuª
;

16063 
	`∆a_√°_íd
(
msg
, 
≥î_func_©å
);

16064 
	`∆a_√°_íd
(
msg
, 
m©ch_©å
);

16065 
	`gílmsg_íd
(
msg
, 
hdr
);

16067 i‡(!
wdev
->
ow√r_∆p‹tid
)

16068 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
),

16069 
msg
, 0, 
NL80211_MCGRP_NAN
, 
gÂ
);

16071 
	`gílmsg_uniˇ°
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
,

16072 
wdev
->
ow√r_∆p‹tid
);

16076 
∆a_put_Áûuª
:

16077 
	`∆msg_‰ì
(
msg
);

16078 
	}
}

16079 
EXPORT_SYMBOL
(
cfg80211_«n_m©ch
);

16081 
	$cfg80211_«n_func_ãrmö©ed
(
wúñess_dev
 *
wdev
,

16082 
u8
 
ö°_id
,

16083 
∆80211_«n_func_ãrm_ªas⁄
 
ªas⁄
,

16084 
u64
 
cookõ
, 
gÂ_t
 
gÂ
)

16086 
wùhy
 *wùhy = 
wdev
->wiphy;

16087 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

16088 
sk_buff
 *
msg
;

16089 
∆©å
 *
func_©å
;

16090 *
hdr
;

16092 i‡(
	`WARN_ON
(!
ö°_id
))

16095 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

16096 i‡(!
msg
)

16099 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_DEL_NAN_FUNCTION
);

16100 i‡(!
hdr
) {

16101 
	`∆msg_‰ì
(
msg
);

16105 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

16106 (
wdev
->
√tdev
 && 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
,

16107 
wdev
->
√tdev
->
ifödex
)) ||

16108 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

16109 
NL80211_ATTR_PAD
))

16110 
∆a_put_Áûuª
;

16112 i‡(
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
cookõ
,

16113 
NL80211_ATTR_PAD
))

16114 
∆a_put_Áûuª
;

16116 
func_©å
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_NAN_FUNC
);

16117 i‡(!
func_©å
)

16118 
∆a_put_Áûuª
;

16120 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_NAN_FUNC_INSTANCE_ID
, 
ö°_id
) ||

16121 
	`∆a_put_u8
(
msg
, 
NL80211_NAN_FUNC_TERM_REASON
, 
ªas⁄
))

16122 
∆a_put_Áûuª
;

16124 
	`∆a_√°_íd
(
msg
, 
func_©å
);

16125 
	`gílmsg_íd
(
msg
, 
hdr
);

16127 i‡(!
wdev
->
ow√r_∆p‹tid
)

16128 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
),

16129 
msg
, 0, 
NL80211_MCGRP_NAN
, 
gÂ
);

16131 
	`gílmsg_uniˇ°
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
,

16132 
wdev
->
ow√r_∆p‹tid
);

16136 
∆a_put_Áûuª
:

16137 
	`∆msg_‰ì
(
msg
);

16138 
	}
}

16139 
EXPORT_SYMBOL
(
cfg80211_«n_func_ãrmö©ed
);

16141 
	$∆80211_gë_¥Ÿocﬁ_„©uªs
(
sk_buff
 *
skb
,

16142 
gíl_öfo
 *
öfo
)

16144 *
hdr
;

16145 
sk_buff
 *
msg
;

16147 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

16149 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

16150 i‡(!
msg
) {

16151 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16152  -
ENOMEM
;

16155 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

16156 
NL80211_CMD_GET_PROTOCOL_FEATURES
);

16157 i‡(!
hdr
) {

16158 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16159 
∆a_put_Áûuª
;

16162 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_PROTOCOL_FEATURES
,

16163 
NL80211_PROTOCOL_FEATURE_SPLIT_WIPHY_DUMP
)) {

16164 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16165 
∆a_put_Áûuª
;

16168 
	`gílmsg_íd
(
msg
, 
hdr
);

16169 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

16170  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

16172 
∆a_put_Áûuª
:

16173 
	`k‰ì_skb
(
msg
);

16174 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16175  -
ENOBUFS
;

16176 
	}
}

16178 
	$∆80211_upd©e_·_õs
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

16180 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16181 
cfg80211_upd©e_·_õs_∑øms
 
·_∑øms
;

16182 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

16184 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16186 i‡(!
rdev
->
›s
->
upd©e_·_õs
) {

16187 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16188  -
EOPNOTSUPP
;

16191 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MDID
] ||

16192 !
öfo
->
©ås
[
NL80211_ATTR_IE
]) {

16193 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16194  -
EINVAL
;

16197 
	`mem£t
(&
·_∑øms
, 0, (ft_params));

16198 
·_∑øms
.
md
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_MDID
]);

16199 
·_∑øms
.
õ
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

16200 
·_∑øms
.
õ_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

16202 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16203  
	`rdev_upd©e_·_õs
(
rdev
, 
dev
, &
·_∑øms
);

16204 
	}
}

16206 
	$∆80211_¸ô_¥Ÿocﬁ_°¨t
(
sk_buff
 *
skb
,

16207 
gíl_öfo
 *
öfo
)

16209 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16210 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

16211 
∆80211_¸ô_¥Ÿo_id
 
¥Ÿo
 = 
NL80211_CRIT_PROTO_UNSPEC
;

16212 
u16
 
duøti⁄
;

16213 
ªt
;

16215 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16217 i‡(!
rdev
->
›s
->
¸ô_¥Ÿo_°¨t
) {

16218 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16219  -
EOPNOTSUPP
;

16222 i‡(
	`WARN_ON
(!
rdev
->
›s
->
¸ô_¥Ÿo_°›
)) {

16223 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16224  -
EINVAL
;

16227 i‡(
rdev
->
¸ô_¥Ÿo_∆p‹tid
) {

16228 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16229  -
EBUSY
;

16233 i‡(
öfo
->
©ås
[
NL80211_ATTR_CRIT_PROT_ID
])

16234 
¥Ÿo
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_CRIT_PROT_ID
]);

16236 i‡(
¥Ÿo
 >
NUM_NL80211_CRIT_PROTO
) {

16237 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16238  -
EINVAL
;

16242 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAX_CRIT_PROT_DURATION
]) {

16243 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16244  -
EINVAL
;

16247 
duøti⁄
 =

16248 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_MAX_CRIT_PROT_DURATION
]);

16250 
ªt
 = 
	`rdev_¸ô_¥Ÿo_°¨t
(
rdev
, 
wdev
, 
¥Ÿo
, 
duøti⁄
);

16251 i‡(!
ªt
)

16252 
rdev
->
¸ô_¥Ÿo_∆p‹tid
 = 
öfo
->
¢d_p‹tid
;

16254 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16255  
ªt
;

16256 
	}
}

16258 
	$∆80211_¸ô_¥Ÿocﬁ_°›
(
sk_buff
 *
skb
,

16259 
gíl_öfo
 *
öfo
)

16261 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16262 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

16264 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16266 i‡(!
rdev
->
›s
->
¸ô_¥Ÿo_°›
) {

16267 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16268  -
EOPNOTSUPP
;

16271 i‡(
rdev
->
¸ô_¥Ÿo_∆p‹tid
) {

16272 
rdev
->
¸ô_¥Ÿo_∆p‹tid
 = 0;

16273 
	`rdev_¸ô_¥Ÿo_°›
(
rdev
, 
wdev
);

16275 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16277 
	}
}

16279 
	$∆80211_víd‹_check_pﬁicy
(c⁄° 
wùhy_víd‹_comm™d
 *
vcmd
,

16280 
∆©å
 *
©å
,

16281 
√éök_ext_ack
 *
exèck
)

16283 i‡(
vcmd
->
pﬁicy
 =
VENDOR_CMD_RAW_DATA
) {

16284 i‡(
©å
->
∆a_ty≥
 & 
NLA_F_NESTED
) {

16285 
	`NL_SET_ERR_MSG_ATTR
(
exèck
, 
©å
,

16287  -
EINVAL
;

16293 i‡(!(
©å
->
∆a_ty≥
 & 
NLA_F_NESTED
)) {

16294 
	`NL_SET_ERR_MSG_ATTR
(
exèck
, 
©å
, "expectedÇested data");

16295  -
EINVAL
;

16298  
	`∆a_vÆid©e_√°ed
(
©å
, 
vcmd
->
max©å
, vcmd->
pﬁicy
, 
exèck
);

16299 
	}
}

16301 
	$∆80211_víd‹_cmd
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

16303 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16304 
wúñess_dev
 *
wdev
 =

16305 
	`__cfg80211_wdev_‰om_©ås
(
rdev
, 
	`gíl_öfo_√t
(
öfo
),

16306 
öfo
->
©ås
);

16307 
i
, 
îr
;

16308 
u32
 
vid
, 
subcmd
;

16310 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16312 i‡(!
rdev
->
wùhy
.
víd‹_comm™ds
) {

16313 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16314  -
EOPNOTSUPP
;

16317 i‡(
	`IS_ERR
(
wdev
)) {

16318 
îr
 = 
	`PTR_ERR
(
wdev
);

16319 i‡(
îr
 !-
EINVAL
) {

16320 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16321  
îr
;

16323 
wdev
 = 
NULL
;

16324 } i‡(
wdev
->
wùhy
 !&
rdev
->wiphy) {

16325 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16326  -
EINVAL
;

16329 i‡(!
öfo
->
©ås
[
NL80211_ATTR_VENDOR_ID
] ||

16330 !
öfo
->
©ås
[
NL80211_ATTR_VENDOR_SUBCMD
]) {

16331 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16332  -
EINVAL
;

16335 
vid
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_VENDOR_ID
]);

16336 
subcmd
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_VENDOR_SUBCMD
]);

16337 
i
 = 0; i < 
rdev
->
wùhy
.
n_víd‹_comm™ds
; i++) {

16338 c⁄° 
wùhy_víd‹_comm™d
 *
vcmd
;

16339 *
d©a
 = 
NULL
;

16340 
Àn
 = 0;

16342 
vcmd
 = &
rdev
->
wùhy
.
víd‹_comm™ds
[
i
];

16344 i‡(
vcmd
->
öfo
.
víd‹_id
 !
vid
 || vcmd->öfo.
subcmd
 != subcmd)

16347 i‡(
vcmd
->
Êags
 & (
WIPHY_VENDOR_CMD_NEED_WDEV
 |

16348 
WIPHY_VENDOR_CMD_NEED_NETDEV
)) {

16349 i‡(!
wdev
) {

16350 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16351  -
EINVAL
;

16353 i‡(
vcmd
->
Êags
 & 
WIPHY_VENDOR_CMD_NEED_NETDEV
 &&

16354 !
wdev
->
√tdev
) {

16355 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16356  -
EINVAL
;

16359 i‡(
vcmd
->
Êags
 & 
WIPHY_VENDOR_CMD_NEED_RUNNING
) {

16360 i‡(!
	`wdev_ru¬ög
(
wdev
)) {

16361 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16362  -
ENETDOWN
;

16366 
wdev
 = 
NULL
;

16369 i‡(!
vcmd
->
doô
) {

16370 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16371  -
EOPNOTSUPP
;

16374 i‡(
öfo
->
©ås
[
NL80211_ATTR_VENDOR_DATA
]) {

16375 
d©a
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_VENDOR_DATA
]);

16376 
Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_VENDOR_DATA
]);

16378 
îr
 = 
	`∆80211_víd‹_check_pﬁicy
(
vcmd
,

16379 
öfo
->
©ås
[
NL80211_ATTR_VENDOR_DATA
],

16380 
öfo
->
exèck
);

16381 i‡(
îr
) {

16382 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16383  
îr
;

16387 
rdev
->
cur_cmd_öfo
 = 
öfo
;

16388 
îr
 = 
vcmd
->
	`doô
(&
rdev
->
wùhy
, 
wdev
, 
d©a
, 
Àn
);

16389 
rdev
->
cur_cmd_öfo
 = 
NULL
;

16390 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16391  
îr
;

16394 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16395  -
EOPNOTSUPP
;

16396 
	}
}

16398 
	$∆80211_¥ï¨e_víd‹_dump
(
sk_buff
 *
skb
,

16399 
√éök_ˇŒback
 *
cb
,

16400 
cfg80211_ªgi°îed_devi˚
 **
rdev
,

16401 
wúñess_dev
 **
wdev
)

16403 
∆©å
 **
©åbuf
;

16404 
u32
 
vid
, 
subcmd
;

16405 
i
;

16406 
vcmd_idx
 = -1;

16407 
îr
;

16408 *
d©a
 = 
NULL
;

16409 
d©a_Àn
 = 0;

16411 i‡(
cb
->
¨gs
[0]) {

16413 
wùhy
 *wùhy = 
	`wùhy_idx_to_wùhy
(
cb
->
¨gs
[0] - 1);

16414 
wúñess_dev
 *
tmp
;

16416 i‡(!
wùhy
)

16417  -
ENODEV
;

16418 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

16419 *
wdev
 = 
NULL
;

16421 i‡(
cb
->
¨gs
[1]) {

16422 
	`li°_f‹_óch_íåy
(
tmp
, &
wùhy
->
wdev_li°
, 
li°
) {

16423 i‡(
tmp
->
idítifõr
 =
cb
->
¨gs
[1] - 1) {

16424 *
wdev
 = 
tmp
;

16434 
©åbuf
 = 
	`kˇŒoc
(
NUM_NL80211_ATTR
, (*©åbuf), 
GFP_KERNEL
);

16435 i‡(!
©åbuf
)

16436  -
ENOMEM
;

16438 
îr
 = 
	`∆msg_∑r£_dïªˇãd
(
cb
->
∆h
,

16439 
GENL_HDRLEN
 + 
∆80211_Ám
.
hdrsize
,

16440 
©åbuf
, 
∆80211_Ám
.
max©å
,

16441 
∆80211_pﬁicy
, 
NULL
);

16442 i‡(
îr
)

16443 
out
;

16445 i‡(!
©åbuf
[
NL80211_ATTR_VENDOR_ID
] ||

16446 !
©åbuf
[
NL80211_ATTR_VENDOR_SUBCMD
]) {

16447 
îr
 = -
EINVAL
;

16448 
out
;

16451 *
wdev
 = 
	`__cfg80211_wdev_‰om_©ås
(
NULL
, 
	`sock_√t
(
skb
->
sk
), 
©åbuf
);

16452 i‡(
	`IS_ERR
(*
wdev
))

16453 *
wdev
 = 
NULL
;

16455 *
rdev
 = 
	`__cfg80211_rdev_‰om_©ås
(
	`sock_√t
(
skb
->
sk
), 
©åbuf
);

16456 i‡(
	`IS_ERR
(*
rdev
)) {

16457 
îr
 = 
	`PTR_ERR
(*
rdev
);

16458 
out
;

16461 
vid
 = 
	`∆a_gë_u32
(
©åbuf
[
NL80211_ATTR_VENDOR_ID
]);

16462 
subcmd
 = 
	`∆a_gë_u32
(
©åbuf
[
NL80211_ATTR_VENDOR_SUBCMD
]);

16464 
i
 = 0; i < (*
rdev
)->
wùhy
.
n_víd‹_comm™ds
; i++) {

16465 c⁄° 
wùhy_víd‹_comm™d
 *
vcmd
;

16467 
vcmd
 = &(*
rdev
)->
wùhy
.
víd‹_comm™ds
[
i
];

16469 i‡(
vcmd
->
öfo
.
víd‹_id
 !
vid
 || vcmd->öfo.
subcmd
 != subcmd)

16472 i‡(!
vcmd
->
dumpô
) {

16473 
îr
 = -
EOPNOTSUPP
;

16474 
out
;

16477 
vcmd_idx
 = 
i
;

16481 i‡(
vcmd_idx
 < 0) {

16482 
îr
 = -
EOPNOTSUPP
;

16483 
out
;

16486 i‡(
©åbuf
[
NL80211_ATTR_VENDOR_DATA
]) {

16487 
d©a
 = 
	`∆a_d©a
(
©åbuf
[
NL80211_ATTR_VENDOR_DATA
]);

16488 
d©a_Àn
 = 
	`∆a_Àn
(
©åbuf
[
NL80211_ATTR_VENDOR_DATA
]);

16490 
îr
 = 
	`∆80211_víd‹_check_pﬁicy
(

16491 &(*
rdev
)->
wùhy
.
víd‹_comm™ds
[
vcmd_idx
],

16492 
©åbuf
[
NL80211_ATTR_VENDOR_DATA
],

16493 
cb
->
exèck
);

16494 i‡(
îr
)

16495 
out
;

16499 
cb
->
¨gs
[0] = (*
rdev
)->
wùhy_idx
 + 1;

16501 
cb
->
¨gs
[1] = *
wdev
 ? (*wdev)->
idítifõr
 + 1 : 0;

16502 
cb
->
¨gs
[2] = 
vcmd_idx
;

16503 
cb
->
¨gs
[3] = ()
d©a
;

16504 
cb
->
¨gs
[4] = 
d©a_Àn
;

16507 
îr
 = 0;

16508 
out
:

16509 
	`k‰ì
(
©åbuf
);

16510  
îr
;

16511 
	}
}

16513 
	$∆80211_víd‹_cmd_dump
(
sk_buff
 *
skb
,

16514 
√éök_ˇŒback
 *
cb
)

16516 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

16517 
wúñess_dev
 *
wdev
;

16518 
vcmd_idx
;

16519 c⁄° 
wùhy_víd‹_comm™d
 *
vcmd
;

16520 *
d©a
;

16521 
d©a_Àn
;

16522 
îr
;

16523 
∆©å
 *
víd‹_d©a
;

16525 
	`π∆_lock
();

16526 
îr
 = 
	`∆80211_¥ï¨e_víd‹_dump
(
skb
, 
cb
, &
rdev
, &
wdev
);

16527 i‡(
îr
)

16528 
out
;

16530 
vcmd_idx
 = 
cb
->
¨gs
[2];

16531 
d©a
 = (*)
cb
->
¨gs
[3];

16532 
d©a_Àn
 = 
cb
->
¨gs
[4];

16533 
vcmd
 = &
rdev
->
wùhy
.
víd‹_comm™ds
[
vcmd_idx
];

16535 i‡(
vcmd
->
Êags
 & (
WIPHY_VENDOR_CMD_NEED_WDEV
 |

16536 
WIPHY_VENDOR_CMD_NEED_NETDEV
)) {

16537 i‡(!
wdev
) {

16538 
îr
 = -
EINVAL
;

16539 
out
;

16541 i‡(
vcmd
->
Êags
 & 
WIPHY_VENDOR_CMD_NEED_NETDEV
 &&

16542 !
wdev
->
√tdev
) {

16543 
îr
 = -
EINVAL
;

16544 
out
;

16547 i‡(
vcmd
->
Êags
 & 
WIPHY_VENDOR_CMD_NEED_RUNNING
) {

16548 i‡(!
	`wdev_ru¬ög
(
wdev
)) {

16549 
îr
 = -
ENETDOWN
;

16550 
out
;

16556 *
hdr
 = 
	`∆80211hdr_put
(
skb
, 
	`NETLINK_CB
(
cb
->skb).
p‹tid
,

16557 
cb
->
∆h
->
∆msg_£q
, 
NLM_F_MULTI
,

16558 
NL80211_CMD_VENDOR
);

16559 i‡(!
hdr
)

16562 i‡(
	`∆a_put_u32
(
skb
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

16563 (
wdev
 && 
	`∆a_put_u64_64bô
(
skb
, 
NL80211_ATTR_WDEV
,

16564 
	`wdev_id
(
wdev
),

16565 
NL80211_ATTR_PAD
))) {

16566 
	`gílmsg_ˇn˚l
(
skb
, 
hdr
);

16570 
víd‹_d©a
 = 
	`∆a_√°_°¨t_noÊag
(
skb
,

16571 
NL80211_ATTR_VENDOR_DATA
);

16572 i‡(!
víd‹_d©a
) {

16573 
	`gílmsg_ˇn˚l
(
skb
, 
hdr
);

16577 
îr
 = 
vcmd
->
	`dumpô
(&
rdev
->
wùhy
, 
wdev
, 
skb
, 
d©a
, 
d©a_Àn
,

16578 (*)&
cb
->
¨gs
[5]);

16579 
	`∆a_√°_íd
(
skb
, 
víd‹_d©a
);

16581 i‡(
îr
 =-
ENOBUFS
 ||Éº =-
ENOENT
) {

16582 
	`gílmsg_ˇn˚l
(
skb
, 
hdr
);

16584 } i‡(
îr
 <= 0) {

16585 
	`gílmsg_ˇn˚l
(
skb
, 
hdr
);

16586 
out
;

16589 
	`gílmsg_íd
(
skb
, 
hdr
);

16592 
îr
 = 
skb
->
Àn
;

16593 
out
:

16594 
	`π∆_u∆ock
();

16595  
îr
;

16596 
	}
}

16598 
sk_buff
 *
	$__cfg80211_Æloc_ª∂y_skb
(
wùhy
 *wiphy,

16599 
∆80211_comm™ds
 
cmd
,

16600 
∆80211_©ås
 
©å
,

16601 
≠¥oxÀn
)

16603 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

16605 i‡(
	`WARN_ON
(!
rdev
->
cur_cmd_öfo
))

16606  
NULL
;

16608  
	`__cfg80211_Æloc_víd‹_skb
(
rdev
, 
NULL
, 
≠¥oxÀn
,

16609 
rdev
->
cur_cmd_öfo
->
¢d_p‹tid
,

16610 
rdev
->
cur_cmd_öfo
->
¢d_£q
,

16611 
cmd
, 
©å
, 
NULL
, 
GFP_KERNEL
);

16612 
	}
}

16613 
EXPORT_SYMBOL
(
__cfg80211_Æloc_ª∂y_skb
);

16615 
	$cfg80211_víd‹_cmd_ª∂y
(
sk_buff
 *
skb
)

16617 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = ((**)
skb
->
cb
)[0];

16618 *
hdr
 = ((**)
skb
->
cb
)[1];

16619 
∆©å
 *
d©a
 = ((**)
skb
->
cb
)[2];

16622 
	`mem£t
(
skb
->
cb
, 0, (skb->cb));

16624 i‡(
	`WARN_ON
(!
rdev
->
cur_cmd_öfo
)) {

16625 
	`k‰ì_skb
(
skb
);

16626  -
EINVAL
;

16629 
	`∆a_√°_íd
(
skb
, 
d©a
);

16630 
	`gílmsg_íd
(
skb
, 
hdr
);

16631  
	`gílmsg_ª∂y
(
skb
, 
rdev
->
cur_cmd_öfo
);

16632 
	}
}

16633 
EXPORT_SYMBOL_GPL
(
cfg80211_víd‹_cmd_ª∂y
);

16635 
	$cfg80211_víd‹_cmd_gë_£ndî
(
wùhy
 *wiphy)

16637 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

16639 i‡(
	`WARN_ON
(!
rdev
->
cur_cmd_öfo
))

16642  
rdev
->
cur_cmd_öfo
->
¢d_p‹tid
;

16643 
	}
}

16644 
EXPORT_SYMBOL_GPL
(
cfg80211_víd‹_cmd_gë_£ndî
);

16646 
	$∆80211_£t_qos_m≠
(
sk_buff
 *
skb
,

16647 
gíl_öfo
 *
öfo
)

16649 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16650 
cfg80211_qos_m≠
 *
qos_m≠
 = 
NULL
;

16651 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

16652 
u8
 *
pos
, 
Àn
, 
num_des
, 
des_Àn
, 
des
;

16653 
ªt
;

16655 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16657 i‡(!
rdev
->
›s
->
£t_qos_m≠
) {

16658 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16659  -
EOPNOTSUPP
;

16662 i‡(
öfo
->
©ås
[
NL80211_ATTR_QOS_MAP
]) {

16663 
pos
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_QOS_MAP
]);

16664 
Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_QOS_MAP
]);

16666 i‡(
Àn
 % 2) {

16667 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16668  -
EINVAL
;

16671 
qos_m≠
 = 
	`kzÆloc
((
cfg80211_qos_m≠
), 
GFP_KERNEL
);

16672 i‡(!
qos_m≠
) {

16673 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16674  -
ENOMEM
;

16677 
num_des
 = (
Àn
 - 
IEEE80211_QOS_MAP_LEN_MIN
) >> 1;

16678 i‡(
num_des
) {

16679 
des_Àn
 = 
num_des
 *

16680 (
cfg80211_ds˝_ex˚±i⁄
);

16681 
	`mem˝y
(
qos_m≠
->
ds˝_ex˚±i⁄
, 
pos
, 
des_Àn
);

16682 
qos_m≠
->
num_des
 =Çum_des;

16683 
des
 = 0; de†< 
num_des
; des++) {

16684 i‡(
qos_m≠
->
ds˝_ex˚±i⁄
[
des
].
up
 > 7) {

16685 
	`k‰ì
(
qos_m≠
);

16686 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16687  -
EINVAL
;

16690 
pos
 +
des_Àn
;

16692 
	`mem˝y
(
qos_m≠
->
up
, 
pos
, 
IEEE80211_QOS_MAP_LEN_MIN
);

16695 
ªt
 = 
	`∆80211_key_Ælowed
(
dev
->
õì80211_±r
);

16696 i‡(!
ªt
)

16697 
ªt
 = 
	`rdev_£t_qos_m≠
(
rdev
, 
dev
, 
qos_m≠
);

16699 
	`k‰ì
(
qos_m≠
);

16700 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16701  
ªt
;

16702 
	}
}

16704 
	$∆80211_add_tx_ts
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

16706 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16707 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

16708 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

16709 c⁄° 
u8
 *
≥î
;

16710 
u8
 
tsid
, 
up
;

16711 
u16
 
admôãd_time
 = 0;

16713 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16715 i‡(!(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_SUPPORTS_WMM_ADMISSION
)) {

16716 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16717  -
EOPNOTSUPP
;

16720 i‡(!
öfo
->
©ås
[
NL80211_ATTR_TSID
] || !öfo->©ås[
NL80211_ATTR_MAC
] ||

16721 !
öfo
->
©ås
[
NL80211_ATTR_USER_PRIO
]) {

16722 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16723  -
EINVAL
;

16726 
tsid
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_TSID
]);

16727 
up
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_USER_PRIO
]);

16730 i‡(
tsid
 >
IEEE80211_FIRST_TSPEC_TSID
) {

16735 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16736  -
EINVAL
;

16739 
≥î
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

16741 i‡(
öfo
->
©ås
[
NL80211_ATTR_ADMITTED_TIME
]) {

16742 
admôãd_time
 =

16743 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_ADMITTED_TIME
]);

16744 i‡(!
admôãd_time
) {

16745 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16746  -
EINVAL
;

16750 
wdev
->
i·y≥
) {

16751 
NL80211_IFTYPE_STATION
:

16752 
NL80211_IFTYPE_P2P_CLIENT
:

16753 i‡(
wdev
->
c⁄√˘ed
) {

16754 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16757 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16758  -
ENOTCONN
;

16760 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16761  -
EOPNOTSUPP
;

16764 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16765  
	`rdev_add_tx_ts
(
rdev
, 
dev
, 
tsid
, 
≥î
, 
up
, 
admôãd_time
);

16766 
	}
}

16768 
	$∆80211_dñ_tx_ts
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

16770 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16771 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

16772 c⁄° 
u8
 *
≥î
;

16773 
u8
 
tsid
;

16775 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16777 i‡(!
öfo
->
©ås
[
NL80211_ATTR_TSID
] || !öfo->©ås[
NL80211_ATTR_MAC
]) {

16778 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16779  -
EINVAL
;

16782 
tsid
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_TSID
]);

16783 
≥î
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

16785 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16786  
	`rdev_dñ_tx_ts
(
rdev
, 
dev
, 
tsid
, 
≥î
);

16787 
	}
}

16789 
	$∆80211_tdls_ch™√l_swôch
(
sk_buff
 *
skb
,

16790 
gíl_öfo
 *
öfo
)

16792 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16793 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

16794 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

16795 
cfg80211_ch™_def
 
ch™def
 = {};

16796 c⁄° 
u8
 *
addr
;

16797 
u8
 
›î_˛ass
;

16798 
îr
;

16800 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16802 i‡(!
rdev
->
›s
->
tdls_ch™√l_swôch
 ||

16803 !(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_TDLS_CHANNEL_SWITCH
)) {

16804 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16805  -
EOPNOTSUPP
;

16808 
dev
->
õì80211_±r
->
i·y≥
) {

16809 
NL80211_IFTYPE_STATION
:

16810 
NL80211_IFTYPE_P2P_CLIENT
:

16811 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16814 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16815  -
EOPNOTSUPP
;

16818 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
] ||

16819 !
öfo
->
©ås
[
NL80211_ATTR_OPER_CLASS
]) {

16820 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16821  -
EINVAL
;

16824 
îr
 = 
	`∆80211_∑r£_ch™def
(
rdev
, 
öfo
, &
ch™def
);

16825 i‡(
îr
) {

16826 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16827  
îr
;

16835 i‡(
ch™def
.
ch™
->
b™d
 =
NL80211_BAND_2GHZ
 &&

16836 
ch™def
.
width
 !
NL80211_CHAN_WIDTH_20_NOHT
 &&

16837 
ch™def
.
width
 !
NL80211_CHAN_WIDTH_20
) {

16838 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16839  -
EINVAL
;

16843 i‡(!
	`cfg80211_ªg_ˇn_bóc⁄_ªœx
(&
rdev
->
wùhy
, &
ch™def
,

16844 
wdev
->
i·y≥
)) {

16845 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16846  -
EINVAL
;

16850 i‡(
	`cfg80211_ch™def_dfs_ªquúed
(
wdev
->
wùhy
, &
ch™def
, wdev->
i·y≥
)) {

16851 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16852  -
EINVAL
;

16855 
addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

16856 
›î_˛ass
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_OPER_CLASS
]);

16858 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16859  
	`rdev_tdls_ch™√l_swôch
(
rdev
, 
dev
, 
addr
, 
›î_˛ass
, &
ch™def
);

16860 
	}
}

16862 
	$∆80211_tdls_ˇn˚l_ch™√l_swôch
(
sk_buff
 *
skb
,

16863 
gíl_öfo
 *
öfo
)

16865 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16866 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

16867 c⁄° 
u8
 *
addr
;

16869 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16871 i‡(!
rdev
->
›s
->
tdls_ch™√l_swôch
 ||

16872 !
rdev
->
›s
->
tdls_ˇn˚l_ch™√l_swôch
 ||

16873 !(
rdev
->
wùhy
.
„©uªs
 & 
NL80211_FEATURE_TDLS_CHANNEL_SWITCH
)) {

16874 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16875  -
EOPNOTSUPP
;

16878 
dev
->
õì80211_±r
->
i·y≥
) {

16879 
NL80211_IFTYPE_STATION
:

16880 
NL80211_IFTYPE_P2P_CLIENT
:

16881 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16884 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16885  -
EOPNOTSUPP
;

16888 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

16889 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16890  -
EINVAL
;

16893 
addr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

16895 
	`rdev_tdls_ˇn˚l_ch™√l_swôch
(
rdev
, 
dev
, 
addr
);

16897 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16899 
	}
}

16901 
	$∆80211_£t_mu…iˇ°_to_uniˇ°
(
sk_buff
 *
skb
,

16902 
gíl_öfo
 *
öfo
)

16904 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16905 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

16906 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

16907 c⁄° 
∆©å
 *
∆a
;

16908 
boﬁ
 
íabÀd
;

16910 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16912 i‡(!
rdev
->
›s
->
£t_mu…iˇ°_to_uniˇ°
) {

16913 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16914  -
EOPNOTSUPP
;

16917 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

16918 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

16919 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16920  -
EOPNOTSUPP
;

16923 
∆a
 = 
öfo
->
©ås
[
NL80211_ATTR_MULTICAST_TO_UNICAST_ENABLED
];

16924 
íabÀd
 = 
	`∆a_gë_Êag
(
∆a
);

16926 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16927  
	`rdev_£t_mu…iˇ°_to_uniˇ°
(
rdev
, 
dev
, 
íabÀd
);

16928 
	}
}

16930 
	$∆80211_£t_pmk
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

16932 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16933 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

16934 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

16935 
cfg80211_pmk_c⁄f
 
pmk_c⁄f
 = {};

16937 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16939 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

16940 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
) {

16941 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16942  -
EOPNOTSUPP
;

16945 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

16946 
NL80211_EXT_FEATURE_4WAY_HANDSHAKE_STA_1X
)) {

16947 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16948  -
EOPNOTSUPP
;

16951 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
] || !öfo->©ås[
NL80211_ATTR_PMK
]) {

16952 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16953  -
EINVAL
;

16956 i‡(!
wdev
->
c⁄√˘ed
) {

16957 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16958  -
ENOTCONN
;

16961 
pmk_c⁄f
.
Ø
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

16962 i‡(
	`memcmp
(
pmk_c⁄f
.
Ø
, 
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
, 
ETH_ALEN
)) {

16963 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16964  -
EINVAL
;

16967 
pmk_c⁄f
.
pmk
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_PMK
]);

16968 
pmk_c⁄f
.
pmk_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_PMK
]);

16969 i‡(
pmk_c⁄f
.
pmk_Àn
 !
WLAN_PMK_LEN
 &&

16970 
pmk_c⁄f
.
pmk_Àn
 !
WLAN_PMK_LEN_SUITE_B_192
) {

16971 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16972  -
EINVAL
;

16975 i‡(
öfo
->
©ås
[
NL80211_ATTR_PMKR0_NAME
])

16976 
pmk_c⁄f
.
pmk_r0_«me
 =

16977 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_PMKR0_NAME
]);

16979 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16980  
	`rdev_£t_pmk
(
rdev
, 
dev
, &
pmk_c⁄f
);

16981 
	}
}

16983 
	$∆80211_dñ_pmk
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

16985 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

16986 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

16987 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

16988 c⁄° 
u8
 *
Ø
;

16990 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

16992 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

16993 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
) {

16994 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

16995  -
EOPNOTSUPP
;

16998 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

16999 
NL80211_EXT_FEATURE_4WAY_HANDSHAKE_STA_1X
)) {

17000 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17001  -
EOPNOTSUPP
;

17004 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

17005 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17006  -
EINVAL
;

17009 
Ø
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

17010 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17011  
	`rdev_dñ_pmk
(
rdev
, 
dev
, 
Ø
);

17012 
	}
}

17014 
	$∆80211_exã∫Æ_auth
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

17016 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17017 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17018 
cfg80211_exã∫Æ_auth_∑øms
 
∑øms
;

17020 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17022 i‡(!
rdev
->
›s
->
exã∫Æ_auth
) {

17023 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17024  -
EOPNOTSUPP
;

17027 i‡(!
öfo
->
©ås
[
NL80211_ATTR_SSID
] &&

17028 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

17029 
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
) {

17030 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17031  -
EINVAL
;

17034 i‡(!
öfo
->
©ås
[
NL80211_ATTR_BSSID
]) {

17035 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17036  -
EINVAL
;

17039 i‡(!
öfo
->
©ås
[
NL80211_ATTR_STATUS_CODE
]) {

17040 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17041  -
EINVAL
;

17044 
	`mem£t
(&
∑øms
, 0, (params));

17046 i‡(
öfo
->
©ås
[
NL80211_ATTR_SSID
]) {

17047 
∑øms
.
ssid
.
ssid_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]);

17048 i‡(
∑øms
.
ssid
.
ssid_Àn
 == 0) {

17049 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17050  -
EINVAL
;

17052 
	`mem˝y
(
∑øms
.
ssid
.ssid,

17053 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_SSID
]),

17054 
∑øms
.
ssid
.
ssid_Àn
);

17057 
	`mem˝y
(
∑øms
.
bssid
, 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_BSSID
]),

17058 
ETH_ALEN
);

17060 
∑øms
.
°©us
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_STATUS_CODE
]);

17062 i‡(
öfo
->
©ås
[
NL80211_ATTR_PMKID
])

17063 
∑øms
.
pmkid
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_PMKID
]);

17065 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17066  
	`rdev_exã∫Æ_auth
(
rdev
, 
dev
, &
∑øms
);

17067 
	}
}

17069 
	$∆80211_tx_c⁄åﬁ_p‹t
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

17071 
boﬁ
 
d⁄t_waô_f‹_ack
 = 
öfo
->
©ås
[
NL80211_ATTR_DONT_WAIT_FOR_ACK
];

17072 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17073 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17074 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

17075 c⁄° 
u8
 *
buf
;

17076 
size_t
 
Àn
;

17077 
u8
 *
de°
;

17078 
u16
 
¥Ÿo
;

17079 
boﬁ
 
n€n¸y±
;

17080 
u64
 
cookõ
 = 0;

17081 
lök_id
;

17082 
îr
;

17084 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_CONTROL_PORT_FRAME] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

17086 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

17087 
NL80211_EXT_FEATURE_CONTROL_PORT_OVER_NL80211
)) {

17088 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_CONTROL_PORT_FRAME] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

17089  -
EOPNOTSUPP
;

17092 i‡(!
rdev
->
›s
->
tx_c⁄åﬁ_p‹t
) {

17093 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_CONTROL_PORT_FRAME] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

17094  -
EOPNOTSUPP
;

17097 i‡(!
öfo
->
©ås
[
NL80211_ATTR_FRAME
] ||

17098 !
öfo
->
©ås
[
NL80211_ATTR_MAC
] ||

17099 !
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT_ETHERTYPE
]) {

17100 
	`GENL_SET_ERR_MSG
(
öfo
, "Frame, MAC orÉthertype missing");

17101 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_CONTROL_PORT_FRAME] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

17102  -
EINVAL
;

17105 
wdev
->
i·y≥
) {

17106 
NL80211_IFTYPE_AP
:

17107 
NL80211_IFTYPE_P2P_GO
:

17108 
NL80211_IFTYPE_MESH_POINT
:

17109 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_CONTROL_PORT_FRAME] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

17111 
NL80211_IFTYPE_ADHOC
:

17112 i‡(
wdev
->
u
.
ibss
.
cuºít_bss
) {

17113 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_CONTROL_PORT_FRAME] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

17116  -
ENOTCONN
;

17117 
NL80211_IFTYPE_STATION
:

17118 
NL80211_IFTYPE_P2P_CLIENT
:

17119 i‡(
wdev
->
c⁄√˘ed
) {

17120 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_CONTROL_PORT_FRAME] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

17123 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_CONTROL_PORT_FRAME] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

17124  -
ENOTCONN
;

17126 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_CONTROL_PORT_FRAME] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

17127  -
EOPNOTSUPP
;

17130 
buf
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FRAME
]);

17131 
Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FRAME
]);

17132 
de°
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

17133 
¥Ÿo
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT_ETHERTYPE
]);

17134 
n€n¸y±
 =

17135 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_CONTROL_PORT_NO_ENCRYPT
]);

17137 
lök_id
 = 
	`∆80211_lök_id_‹_övÆid
(
öfo
->
©ås
);

17139 
îr
 = 
	`rdev_tx_c⁄åﬁ_p‹t
(
rdev
, 
dev
, 
buf
, 
Àn
,

17140 
de°
, 
	`˝u_to_be16
(
¥Ÿo
), 
n€n¸y±
, 
lök_id
,

17141 
d⁄t_waô_f‹_ack
 ? 
NULL
 : &
cookõ
);

17142 i‡(!
îr
 && !
d⁄t_waô_f‹_ack
)

17143 
	`∆_£t_exèck_cookõ_u64
(
öfo
->
exèck
, 
cookõ
);

17144 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_CONTROL_PORT_FRAME] [%s] [%d] [EXIT]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

17145  
îr
;

17146 
	}
}

17148 
	$∆80211_gë_·m_ª•⁄dî_°©s
(
sk_buff
 *
skb
,

17149 
gíl_öfo
 *
öfo
)

17151 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17152 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17153 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

17154 
cfg80211_·m_ª•⁄dî_°©s
 
·m_°©s
 = {};

17155 
lök_id
 = 
	`∆80211_lök_id
(
öfo
->
©ås
);

17156 
sk_buff
 *
msg
;

17157 *
hdr
;

17158 
∆©å
 *
·m_°©s_©å
;

17159 
îr
;

17161 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17163 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_AP
 ||

17164 !
wdev
->
löks
[
lök_id
].
≠
.
bóc⁄_öãrvÆ
) {

17165 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17166  -
EOPNOTSUPP
;

17169 
îr
 = 
	`rdev_gë_·m_ª•⁄dî_°©s
(
rdev
, 
dev
, &
·m_°©s
);

17170 i‡(
îr
) {

17171 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17172  
îr
;

17175 i‡(!
·m_°©s
.
fûÀd
) {

17176 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17177  -
ENODATA
;

17180 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

17181 i‡(!
msg
) {

17182 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17183  -
ENOMEM
;

17186 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
öfo
->
¢d_p‹tid
, info->
¢d_£q
, 0,

17187 
NL80211_CMD_GET_FTM_RESPONDER_STATS
);

17188 i‡(!
hdr
) {

17189 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17190 
∆a_put_Áûuª
;

17193 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
)) {

17194 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17195 
∆a_put_Áûuª
;

17198 
·m_°©s_©å
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

17199 
NL80211_ATTR_FTM_RESPONDER_STATS
);

17200 i‡(!
·m_°©s_©å
) {

17201 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17202 
∆a_put_Áûuª
;

17205 
	#SET_FTM
(
fõld
, 
«me
, 
ty≥
) \

17206 dÿ{ i‡((
·m_°©s
.
fûÀd
 & 
	`BIT
(
NL80211_FTM_STATS_
 ## 
«me
)) && \

17207 
∆a_put_
 ## 
	`ty≥
(
msg
, 
NL80211_FTM_STATS_
 ## 
«me
, \

17208 
·m_°©s
.
fõld
)) \

17209 
∆a_put_Áûuª
; } 0)

	)

17210 
	#SET_FTM_U64
(
fõld
, 
«me
) \

17211 dÿ{ i‡((
·m_°©s
.
fûÀd
 & 
	`BIT
(
NL80211_FTM_STATS_
 ## 
«me
)) && \

17212 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_FTM_STATS_
 ## 
«me
, \

17213 
·m_°©s
.
fõld
, 
NL80211_FTM_STATS_PAD
)) \

17214 
∆a_put_Áûuª
; } 0)

	)

17216 
	`SET_FTM
(
suc˚ss_num
, 
SUCCESS_NUM
, 
u32
);

17217 
	`SET_FTM
(
∑πül_num
, 
PARTIAL_NUM
, 
u32
);

17218 
	`SET_FTM
(
Áûed_num
, 
FAILED_NUM
, 
u32
);

17219 
	`SET_FTM
(
aßp_num
, 
ASAP_NUM
, 
u32
);

17220 
	`SET_FTM
(
n⁄_aßp_num
, 
NON_ASAP_NUM
, 
u32
);

17221 
	`SET_FTM_U64
(
tŸÆ_duøti⁄_ms
, 
TOTAL_DURATION_MSEC
);

17222 
	`SET_FTM
(
unknown_åiggîs_num
, 
UNKNOWN_TRIGGERS_NUM
, 
u32
);

17223 
	`SET_FTM
(
ªscheduÀ_ªque°s_num
, 
RESCHEDULE_REQUESTS_NUM
, 
u32
);

17224 
	`SET_FTM
(
out_of_wödow_åiggîs_num
, 
OUT_OF_WINDOW_TRIGGERS_NUM
, 
u32
);

17225 #unde‡
SET_FTM


17227 
	`∆a_√°_íd
(
msg
, 
·m_°©s_©å
);

17229 
	`gílmsg_íd
(
msg
, 
hdr
);

17230 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17231  
	`gílmsg_ª∂y
(
msg
, 
öfo
);

17233 
∆a_put_Áûuª
:

17234 
	`∆msg_‰ì
(
msg
);

17235 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17236  -
ENOBUFS
;

17237 
	}
}

17239 
	$∆80211_upd©e_owe_öfo
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

17241 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17242 
cfg80211_upd©e_owe_öfo
 
owe_öfo
;

17243 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17245 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17247 i‡(!
rdev
->
›s
->
upd©e_owe_öfo
) {

17248 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17249  -
EOPNOTSUPP
;

17252 i‡(!
öfo
->
©ås
[
NL80211_ATTR_STATUS_CODE
] ||

17253 !
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

17254 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17255  -
EINVAL
;

17258 
	`mem£t
(&
owe_öfo
, 0, (owe_info));

17259 
owe_öfo
.
°©us
 = 
	`∆a_gë_u16
(
öfo
->
©ås
[
NL80211_ATTR_STATUS_CODE
]);

17260 
	`∆a_mem˝y
(
owe_öfo
.
≥î
, 
öfo
->
©ås
[
NL80211_ATTR_MAC
], 
ETH_ALEN
);

17262 i‡(
öfo
->
©ås
[
NL80211_ATTR_IE
]) {

17263 
owe_öfo
.
õ
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

17264 
owe_öfo
.
õ_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_IE
]);

17267 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17268  
	`rdev_upd©e_owe_öfo
(
rdev
, 
dev
, &
owe_öfo
);

17269 
	}
}

17271 
	$∆80211_¥obe_mesh_lök
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

17273 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17274 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17275 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

17276 
°©i⁄_öfo
 
söfo
 = {};

17277 c⁄° 
u8
 *
buf
;

17278 
size_t
 
Àn
;

17279 
u8
 *
de°
;

17280 
îr
;

17282 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17284 i‡(!
rdev
->
›s
->
¥obe_mesh_lök
 || !rdev->›s->
gë_°©i⁄
) {

17285 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17286  -
EOPNOTSUPP
;

17289 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
] ||

17290 !
öfo
->
©ås
[
NL80211_ATTR_FRAME
]) {

17291 
	`GENL_SET_ERR_MSG
(
öfo
, "Frame or MAC missing");

17292 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17293  -
EINVAL
;

17296 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
) {

17297 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17298  -
EOPNOTSUPP
;

17301 
de°
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

17302 
buf
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FRAME
]);

17303 
Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FRAME
]);

17305 i‡(
Àn
 < (
ëhhdr
)) {

17306 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17307  -
EINVAL
;

17310 i‡(!
	`ëhî_addr_equÆ
(
buf
, 
de°
Ë|| 
	`is_mu…iˇ°_ëhî_addr
(buf) ||

17311 !
	`ëhî_addr_equÆ
(
buf
 + 
ETH_ALEN
, 
dev
->
dev_addr
)) {

17312 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17313  -
EINVAL
;

17316 
îr
 = 
	`rdev_gë_°©i⁄
(
rdev
, 
dev
, 
de°
, &
söfo
);

17317 i‡(
îr
) {

17318 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17319  
îr
;

17322 
	`cfg80211_söfo_ªÀa£_c⁄ã¡
(&
söfo
);

17324 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17325  
	`rdev_¥obe_mesh_lök
(
rdev
, 
dev
, 
de°
, 
buf
, 
Àn
);

17326 
	}
}

17328 
	$∑r£_tid_c⁄f
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

17329 
∆©å
 *
©ås
[], 
√t_devi˚
 *
dev
,

17330 
cfg80211_tid_cfg
 *
tid_c⁄f
,

17331 
gíl_öfo
 *
öfo
, c⁄° 
u8
 *
≥î
,

17332 
lök_id
)

17334 
√éök_ext_ack
 *
exèck
 = 
öfo
->extack;

17335 
u64
 
mask
;

17336 
îr
;

17338 i‡(!
©ås
[
NL80211_TID_CONFIG_ATTR_TIDS
])

17339  -
EINVAL
;

17341 
tid_c⁄f
->
c⁄fig_ovîride
 =

17342 
	`∆a_gë_Êag
(
©ås
[
NL80211_TID_CONFIG_ATTR_OVERRIDE
]);

17343 
tid_c⁄f
->
tids
 = 
	`∆a_gë_u16
(
©ås
[
NL80211_TID_CONFIG_ATTR_TIDS
]);

17345 i‡(
tid_c⁄f
->
c⁄fig_ovîride
) {

17346 i‡(
rdev
->
›s
->
ª£t_tid_c⁄fig
) {

17347 
îr
 = 
	`rdev_ª£t_tid_c⁄fig
(
rdev
, 
dev
, 
≥î
,

17348 
tid_c⁄f
->
tids
);

17349 i‡(
îr
)

17350  
îr
;

17352  -
EINVAL
;

17356 i‡(
©ås
[
NL80211_TID_CONFIG_ATTR_NOACK
]) {

17357 
tid_c⁄f
->
mask
 |
	`BIT
(
NL80211_TID_CONFIG_ATTR_NOACK
);

17358 
tid_c⁄f
->
nﬂck
 =

17359 
	`∆a_gë_u8
(
©ås
[
NL80211_TID_CONFIG_ATTR_NOACK
]);

17362 i‡(
©ås
[
NL80211_TID_CONFIG_ATTR_RETRY_SHORT
]) {

17363 
tid_c⁄f
->
mask
 |
	`BIT
(
NL80211_TID_CONFIG_ATTR_RETRY_SHORT
);

17364 
tid_c⁄f
->
ªåy_sh‹t
 =

17365 
	`∆a_gë_u8
(
©ås
[
NL80211_TID_CONFIG_ATTR_RETRY_SHORT
]);

17367 i‡(
tid_c⁄f
->
ªåy_sh‹t
 > 
rdev
->
wùhy
.
max_d©a_ªåy_cou¡
)

17368  -
EINVAL
;

17371 i‡(
©ås
[
NL80211_TID_CONFIG_ATTR_RETRY_LONG
]) {

17372 
tid_c⁄f
->
mask
 |
	`BIT
(
NL80211_TID_CONFIG_ATTR_RETRY_LONG
);

17373 
tid_c⁄f
->
ªåy_l⁄g
 =

17374 
	`∆a_gë_u8
(
©ås
[
NL80211_TID_CONFIG_ATTR_RETRY_LONG
]);

17376 i‡(
tid_c⁄f
->
ªåy_l⁄g
 > 
rdev
->
wùhy
.
max_d©a_ªåy_cou¡
)

17377  -
EINVAL
;

17380 i‡(
©ås
[
NL80211_TID_CONFIG_ATTR_AMPDU_CTRL
]) {

17381 
tid_c⁄f
->
mask
 |
	`BIT
(
NL80211_TID_CONFIG_ATTR_AMPDU_CTRL
);

17382 
tid_c⁄f
->
ampdu
 =

17383 
	`∆a_gë_u8
(
©ås
[
NL80211_TID_CONFIG_ATTR_AMPDU_CTRL
]);

17386 i‡(
©ås
[
NL80211_TID_CONFIG_ATTR_RTSCTS_CTRL
]) {

17387 
tid_c⁄f
->
mask
 |
	`BIT
(
NL80211_TID_CONFIG_ATTR_RTSCTS_CTRL
);

17388 
tid_c⁄f
->
πs˘s
 =

17389 
	`∆a_gë_u8
(
©ås
[
NL80211_TID_CONFIG_ATTR_RTSCTS_CTRL
]);

17392 i‡(
©ås
[
NL80211_TID_CONFIG_ATTR_AMSDU_CTRL
]) {

17393 
tid_c⁄f
->
mask
 |
	`BIT
(
NL80211_TID_CONFIG_ATTR_AMSDU_CTRL
);

17394 
tid_c⁄f
->
amsdu
 =

17395 
	`∆a_gë_u8
(
©ås
[
NL80211_TID_CONFIG_ATTR_AMSDU_CTRL
]);

17398 i‡(
©ås
[
NL80211_TID_CONFIG_ATTR_TX_RATE_TYPE
]) {

17399 
u32
 
idx
 = 
NL80211_TID_CONFIG_ATTR_TX_RATE_TYPE
, 
©å
;

17401 
tid_c⁄f
->
txøã_ty≥
 = 
	`∆a_gë_u8
(
©ås
[
idx
]);

17403 i‡(
tid_c⁄f
->
txøã_ty≥
 !
NL80211_TX_RATE_AUTOMATIC
) {

17404 
©å
 = 
NL80211_TID_CONFIG_ATTR_TX_RATE
;

17405 
îr
 = 
	`∆80211_∑r£_tx_bôøã_mask
(
öfo
, 
©ås
, 
©å
,

17406 &
tid_c⁄f
->
txøã_mask
, 
dev
,

17407 
åue
, 
lök_id
);

17408 i‡(
îr
)

17409  
îr
;

17411 
tid_c⁄f
->
mask
 |
	`BIT
(
NL80211_TID_CONFIG_ATTR_TX_RATE
);

17413 
tid_c⁄f
->
mask
 |
	`BIT
(
NL80211_TID_CONFIG_ATTR_TX_RATE_TYPE
);

17416 i‡(
≥î
)

17417 
mask
 = 
rdev
->
wùhy
.
tid_c⁄fig_suµ‹t
.
≥î
;

17419 
mask
 = 
rdev
->
wùhy
.
tid_c⁄fig_suµ‹t
.
vif
;

17421 i‡(
tid_c⁄f
->
mask
 & ~mask) {

17422 
	`NL_SET_ERR_MSG
(
exèck
, "unsupported TID configuration");

17423  -
EOPNOTSUPP
;

17427 
	}
}

17429 
	$∆80211_£t_tid_c⁄fig
(
sk_buff
 *
skb
,

17430 
gíl_öfo
 *
öfo
)

17432 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17433 
∆©å
 *
©ås
[
NL80211_TID_CONFIG_ATTR_MAX
 + 1];

17434 
lök_id
 = 
	`∆80211_lök_id
(
öfo
->
©ås
);

17435 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17436 
cfg80211_tid_c⁄fig
 *
tid_c⁄fig
;

17437 
∆©å
 *
tid
;

17438 
c⁄f_idx
 = 0, 
ªm_c⁄f
;

17439 
ªt
 = -
EINVAL
;

17440 
u32
 
num_c⁄f
 = 0;

17442 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17444 i‡(!
öfo
->
©ås
[
NL80211_ATTR_TID_CONFIG
]) {

17445 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17446  -
EINVAL
;

17449 i‡(!
rdev
->
›s
->
£t_tid_c⁄fig
) {

17450 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17451  -
EOPNOTSUPP
;

17454 
	`∆a_f‹_óch_√°ed
(
tid
, 
öfo
->
©ås
[
NL80211_ATTR_TID_CONFIG
],

17455 
ªm_c⁄f
)

17456 
num_c⁄f
++;

17458 
tid_c⁄fig
 = 
	`kzÆloc
(
	`°ru˘_size
—id_c⁄fig, 
tid_c⁄f
, 
num_c⁄f
),

17459 
GFP_KERNEL
);

17460 i‡(!
tid_c⁄fig
) {

17461 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17462  -
ENOMEM
;

17465 
tid_c⁄fig
->
n_tid_c⁄f
 = 
num_c⁄f
;

17467 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
])

17468 
tid_c⁄fig
->
≥î
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

17470 
	`∆a_f‹_óch_√°ed
(
tid
, 
öfo
->
©ås
[
NL80211_ATTR_TID_CONFIG
],

17471 
ªm_c⁄f
) {

17472 
ªt
 = 
	`∆a_∑r£_√°ed
(
©ås
, 
NL80211_TID_CONFIG_ATTR_MAX
,

17473 
tid
, 
NULL
, NULL);

17475 i‡(
ªt
) {

17476 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17477 
bad_tid_c⁄f
;

17480 
ªt
 = 
	`∑r£_tid_c⁄f
(
rdev
, 
©ås
, 
dev
,

17481 &
tid_c⁄fig
->
tid_c⁄f
[
c⁄f_idx
],

17482 
öfo
, 
tid_c⁄fig
->
≥î
, 
lök_id
);

17483 i‡(
ªt
) {

17484 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17485 
bad_tid_c⁄f
;

17488 
c⁄f_idx
++;

17491 
ªt
 = 
	`rdev_£t_tid_c⁄fig
(
rdev
, 
dev
, 
tid_c⁄fig
);

17493 
bad_tid_c⁄f
:

17494 
	`k‰ì
(
tid_c⁄fig
);

17495 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17496  
ªt
;

17497 
	}
}

17499 
	$∆80211_cﬁ‹_ch™ge
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

17501 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17502 
cfg80211_cﬁ‹_ch™ge_£âögs
 
∑øms
 = {};

17503 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17504 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

17505 
∆©å
 **
tb
;

17506 
u16
 
off£t
;

17507 
îr
;

17509 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17511 i‡(!
rdev
->
›s
->
cﬁ‹_ch™ge
) {

17512 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17513  -
EOPNOTSUPP
;

17516 i‡(!
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

17517 
NL80211_EXT_FEATURE_BSS_COLOR
)) {

17518 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17519  -
EOPNOTSUPP
;

17522 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_AP
) {

17523 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17524  -
EOPNOTSUPP
;

17527 i‡(!
öfo
->
©ås
[
NL80211_ATTR_COLOR_CHANGE_COUNT
] ||

17528 !
öfo
->
©ås
[
NL80211_ATTR_COLOR_CHANGE_COLOR
] ||

17529 !
öfo
->
©ås
[
NL80211_ATTR_COLOR_CHANGE_ELEMS
]) {

17530 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17531  -
EINVAL
;

17534 
∑øms
.
cou¡
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_COLOR_CHANGE_COUNT
]);

17535 
∑øms
.
cﬁ‹
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_COLOR_CHANGE_COLOR
]);

17537 
îr
 = 
	`∆80211_∑r£_bóc⁄
(
rdev
, 
öfo
->
©ås
, &
∑øms
.
bóc⁄_√xt
,

17538 
öfo
->
exèck
);

17539 i‡(
îr
) {

17540 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17541  
îr
;

17544 
tb
 = 
	`kˇŒoc
(
NL80211_ATTR_MAX
 + 1, (*tb), 
GFP_KERNEL
);

17545 i‡(!
tb
) {

17546 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17547  -
ENOMEM
;

17550 
îr
 = 
	`∆a_∑r£_√°ed
(
tb
, 
NL80211_ATTR_MAX
,

17551 
öfo
->
©ås
[
NL80211_ATTR_COLOR_CHANGE_ELEMS
],

17552 
∆80211_pﬁicy
, 
öfo
->
exèck
);

17553 i‡(
îr
) {

17554 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17555 
out
;

17558 
îr
 = 
	`∆80211_∑r£_bóc⁄
(
rdev
, 
tb
, &
∑øms
.
bóc⁄_cﬁ‹_ch™ge
,

17559 
öfo
->
exèck
);

17560 i‡(
îr
) {

17561 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17562 
out
;

17565 i‡(!
tb
[
NL80211_ATTR_CNTDWN_OFFS_BEACON
]) {

17566 
îr
 = -
EINVAL
;

17567 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17568 
out
;

17571 i‡(
	`∆a_Àn
(
tb
[
NL80211_ATTR_CNTDWN_OFFS_BEACON
]Ë!(
u16
)) {

17572 
îr
 = -
EINVAL
;

17573 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17574 
out
;

17577 
off£t
 = 
	`∆a_gë_u16
(
tb
[
NL80211_ATTR_CNTDWN_OFFS_BEACON
]);

17578 i‡(
off£t
 >
∑øms
.
bóc⁄_cﬁ‹_ch™ge
.
èû_Àn
) {

17579 
îr
 = -
EINVAL
;

17580 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17581 
out
;

17584 i‡(
∑øms
.
bóc⁄_cﬁ‹_ch™ge
.
èû
[
off£t
] !∑øms.
cou¡
) {

17585 
îr
 = -
EINVAL
;

17586 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17587 
out
;

17590 
∑øms
.
cou¡î_off£t_bóc⁄
 = 
off£t
;

17592 i‡(
tb
[
NL80211_ATTR_CNTDWN_OFFS_PRESP
]) {

17593 i‡(
	`∆a_Àn
(
tb
[
NL80211_ATTR_CNTDWN_OFFS_PRESP
]) !=

17594 (
u16
)) {

17595 
îr
 = -
EINVAL
;

17596 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17597 
out
;

17600 
off£t
 = 
	`∆a_gë_u16
(
tb
[
NL80211_ATTR_CNTDWN_OFFS_PRESP
]);

17601 i‡(
off£t
 >
∑øms
.
bóc⁄_cﬁ‹_ch™ge
.
¥obe_ª•_Àn
) {

17602 
îr
 = -
EINVAL
;

17603 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17604 
out
;

17607 i‡(
∑øms
.
bóc⁄_cﬁ‹_ch™ge
.
¥obe_ª•
[
off£t
] !=

17608 
∑øms
.
cou¡
) {

17609 
îr
 = -
EINVAL
;

17610 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17611 
out
;

17614 
∑øms
.
cou¡î_off£t_¥e•
 = 
off£t
;

17617 
îr
 = 
	`rdev_cﬁ‹_ch™ge
(
rdev
, 
dev
, &
∑øms
);

17619 
out
:

17620 
	`k‰ì
(
∑øms
.
bóc⁄_√xt
.
mbssid_õs
);

17621 
	`k‰ì
(
∑øms
.
bóc⁄_cﬁ‹_ch™ge
.
mbssid_õs
);

17622 
	`k‰ì
(
∑øms
.
bóc⁄_√xt
.
∫r_õs
);

17623 
	`k‰ì
(
∑øms
.
bóc⁄_cﬁ‹_ch™ge
.
∫r_õs
);

17624 
	`k‰ì
(
tb
);

17625 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17626  
îr
;

17627 
	}
}

17629 
	$∆80211_£t_fûs_Ød
(
sk_buff
 *
skb
,

17630 
gíl_öfo
 *
öfo
)

17632 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17633 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17634 
cfg80211_fûs_Ød
 
fûs_Ød
 = {};

17635 
u8
 *
n⁄˚s
;

17637 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17639 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
] ||

17640 !
öfo
->
©ås
[
NL80211_ATTR_FILS_KEK
] ||

17641 !
öfo
->
©ås
[
NL80211_ATTR_FILS_NONCES
]) {

17642 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17643  -
EINVAL
;

17646 
fûs_Ød
.
maˇddr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

17647 
fûs_Ød
.
kek_Àn
 = 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_FILS_KEK
]);

17648 
fûs_Ød
.
kek
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_KEK
]);

17649 
n⁄˚s
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_FILS_NONCES
]);

17650 
fûs_Ød
.
¢⁄˚
 = 
n⁄˚s
;

17651 
fûs_Ød
.
™⁄˚
 = 
n⁄˚s
 + 
FILS_NONCE_LEN
;

17653 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17654  
	`rdev_£t_fûs_Ød
(
rdev
, 
dev
, &
fûs_Ød
);

17655 
	}
}

17657 
	$∆80211_add_lök
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

17659 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17660 
lök_id
 = 
	`∆80211_lök_id
(
öfo
->
©ås
);

17661 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17662 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

17663 
ªt
;

17665 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17667 i‡(!(
wdev
->
wùhy
->
Êags
 & 
WIPHY_FLAG_SUPPORTS_MLO
)) {

17668 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17669  -
EINVAL
;

17672 
wdev
->
i·y≥
) {

17673 
NL80211_IFTYPE_AP
:

17674 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17677 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17678  -
EINVAL
;

17681 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
] ||

17682 !
	`is_vÆid_ëhî_addr
(
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]))) {

17683 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17684  -
EINVAL
;

17687 
wdev
->
vÆid_löks
 |
	`BIT
(
lök_id
);

17688 
	`ëhî_addr_c›y
(
wdev
->
löks
[
lök_id
].
addr
,

17689 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]));

17691 
ªt
 = 
	`rdev_add_ötf_lök
(
rdev
, 
wdev
, 
lök_id
);

17692 i‡(
ªt
) {

17693 
wdev
->
vÆid_löks
 &~
	`BIT
(
lök_id
);

17694 
	`ëh_zîo_addr
(
wdev
->
löks
[
lök_id
].
addr
);

17697 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17698  
ªt
;

17699 
	}
}

17701 
	$∆80211_ªmove_lök
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

17703 
lök_id
 = 
	`∆80211_lök_id
(
öfo
->
©ås
);

17704 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17705 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

17707 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17710 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MLO_LINK_ID
]) {

17711 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17712  -
EINVAL
;

17715 
wdev
->
i·y≥
) {

17716 
NL80211_IFTYPE_AP
:

17717 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17720 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17721  -
EINVAL
;

17724 
	`cfg80211_ªmove_lök
(
wdev
, 
lök_id
);

17726 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17728 
	}
}

17731 
	$∆80211_add_mod_lök_°©i⁄
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
,

17732 
boﬁ
 
add
)

17734 
lök_°©i⁄_∑ømëîs
 
∑øms
 = {};

17735 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17736 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17737 
îr
;

17739 i‡((
add
 && !
rdev
->
›s
->
add_lök_°©i⁄
) ||

17740 (!
add
 && !
rdev
->
›s
->
mod_lök_°©i⁄
))

17741  -
EOPNOTSUPP
;

17743 i‡(
add
 && !
öfo
->
©ås
[
NL80211_ATTR_MAC
])

17744  -
EINVAL
;

17746 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
])

17747  -
EINVAL
;

17749 i‡(
add
 && !
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_RATES
])

17750  -
EINVAL
;

17752 
∑øms
.
mld_mac
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
]);

17754 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

17755 
∑øms
.
lök_mac
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

17756 i‡(!
	`is_vÆid_ëhî_addr
(
∑øms
.
lök_mac
))

17757  -
EINVAL
;

17760 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MLO_LINK_ID
])

17761  -
EINVAL
;

17763 
∑øms
.
lök_id
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_MLO_LINK_ID
]);

17765 i‡(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_RATES
]) {

17766 
∑øms
.
suµ‹ãd_øãs
 =

17767 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_RATES
]);

17768 
∑øms
.
suµ‹ãd_øãs_Àn
 =

17769 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_STA_SUPPORTED_RATES
]);

17772 i‡(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
])

17773 
∑øms
.
ht_ˇ∑
 =

17774 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HT_CAPABILITY
]);

17776 i‡(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY
])

17777 
∑øms
.
vht_ˇ∑
 =

17778 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_VHT_CAPABILITY
]);

17780 i‡(
öfo
->
©ås
[
NL80211_ATTR_HE_CAPABILITY
]) {

17781 
∑øms
.
he_ˇ∑
 =

17782 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HE_CAPABILITY
]);

17783 
∑øms
.
he_ˇ∑_Àn
 =

17784 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_HE_CAPABILITY
]);

17786 i‡(
öfo
->
©ås
[
NL80211_ATTR_EHT_CAPABILITY
]) {

17787 
∑øms
.
eht_ˇ∑
 =

17788 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_EHT_CAPABILITY
]);

17789 
∑øms
.
eht_ˇ∑_Àn
 =

17790 
	`∆a_Àn
(
öfo
->
©ås
[
NL80211_ATTR_EHT_CAPABILITY
]);

17792 i‡(!
	`õì80211_eht_ˇ∑_size_ok
((c⁄° 
u8
 *)
∑øms
.
he_ˇ∑
,

17793 (c⁄° 
u8
 *)
∑øms
.
eht_ˇ∑
,

17794 
∑øms
.
eht_ˇ∑_Àn
,

17795 
Ál£
))

17796  -
EINVAL
;

17800 i‡(
öfo
->
©ås
[
NL80211_ATTR_HE_6GHZ_CAPABILITY
])

17801 
∑øms
.
he_6ghz_ˇ∑
 =

17802 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_HE_6GHZ_CAPABILITY
]);

17804 i‡(
öfo
->
©ås
[
NL80211_ATTR_OPMODE_NOTIF
]) {

17805 
∑øms
.
›mode_nŸif_u£d
 = 
åue
;

17806 
∑øms
.
›mode_nŸif
 =

17807 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_OPMODE_NOTIF
]);

17810 
îr
 = 
	`∆80211_∑r£_°a_txpowî_£âög
(
öfo
, &
∑øms
.
txpwr
,

17811 &
∑øms
.
txpwr_£t
);

17812 i‡(
îr
)

17813  
îr
;

17815 i‡(
add
)

17816  
	`rdev_add_lök_°©i⁄
(
rdev
, 
dev
, &
∑øms
);

17818  
	`rdev_mod_lök_°©i⁄
(
rdev
, 
dev
, &
∑øms
);

17819 
	}
}

17822 
	$∆80211_add_lök_°©i⁄
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

17824 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17825 
	`¥_öfo
("\n\n");

17826 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17827  
	`∆80211_add_mod_lök_°©i⁄
(
skb
, 
öfo
, 
åue
);

17828 
	}
}

17831 
	$∆80211_modify_lök_°©i⁄
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

17833 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17834 
	`¥_öfo
("\n\n");

17835 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17836  
	`∆80211_add_mod_lök_°©i⁄
(
skb
, 
öfo
, 
Ál£
);

17837 
	}
}

17840 
	$∆80211_ªmove_lök_°©i⁄
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

17842 
lök_°©i⁄_dñ_∑ømëîs
 
∑øms
 = {};

17843 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17844 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17846 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17848 i‡(!
rdev
->
›s
->
dñ_lök_°©i⁄
) {

17849 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17850  -
EOPNOTSUPP
;

17853 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
] ||

17854 !
öfo
->
©ås
[
NL80211_ATTR_MLO_LINK_ID
]) {

17855 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17856  -
EINVAL
;

17859 
∑øms
.
mld_mac
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MLD_ADDR
]);

17860 
∑øms
.
lök_id
 = 
	`∆a_gë_u8
(
öfo
->
©ås
[
NL80211_ATTR_MLO_LINK_ID
]);

17862 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17863  
	`rdev_dñ_lök_°©i⁄
(
rdev
, 
dev
, &
∑øms
);

17864 
	}
}

17866 
	$∆80211_£t_hw_time°amp
(
sk_buff
 *
skb
,

17867 
gíl_öfo
 *
öfo
)

17869 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17870 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17871 
cfg80211_£t_hw_time°amp
 
hwts
 = {};

17873 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17875 i‡(!
rdev
->
wùhy
.
hw_time°amp_max_≥îs
) {

17876  -
EOPNOTSUPP
;

17879 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MAC
] &&

17880 
rdev
->
wùhy
.
hw_time°amp_max_≥îs
 !
CFG80211_HW_TIMESTAMP_ALL_PEERS
) {

17881 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17882  -
EOPNOTSUPP
;

17885 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
])

17886 
hwts
.
maˇddr
 = 
	`∆a_d©a
(
öfo
->
©ås
[
NL80211_ATTR_MAC
]);

17888 
hwts
.
íabÀ
 =

17889 
	`∆a_gë_Êag
(
öfo
->
©ås
[
NL80211_ATTR_HW_TIMESTAMP_ENABLED
]);

17891 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17892  
	`rdev_£t_hw_time°amp
(
rdev
, 
dev
, &
hwts
);

17893 
	}
}

17896 
	$∆80211_£t_âlm
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

17898 
cfg80211_âlm_∑øms
 
∑øms
 = {};

17899 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

17900 
√t_devi˚
 *
dev
 = 
öfo
->
u£r_±r
[1];

17901 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

17903 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

17905 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

17906 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
) {

17907 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17908  -
EOPNOTSUPP
;

17911 i‡(!
wdev
->
c⁄√˘ed
) {

17912 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17913  -
ENOLINK
;

17916 i‡(!
öfo
->
©ås
[
NL80211_ATTR_MLO_TTLM_DLINK
] ||

17917 !
öfo
->
©ås
[
NL80211_ATTR_MLO_TTLM_ULINK
]) {

17918 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17919  -
EINVAL
;

17922 
	`∆a_mem˝y
(
∑øms
.
dlök
,

17923 
öfo
->
©ås
[
NL80211_ATTR_MLO_TTLM_DLINK
],

17924 (
∑øms
.
dlök
));

17925 
	`∆a_mem˝y
(
∑øms
.
ulök
,

17926 
öfo
->
©ås
[
NL80211_ATTR_MLO_TTLM_ULINK
],

17927 (
∑øms
.
ulök
));

17929 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

17930  
	`rdev_£t_âlm
(
rdev
, 
dev
, &
∑øms
);

17931 
	}
}

17933 
	#NL80211_FLAG_NEED_WIPHY
 0x01

	)

17934 
	#NL80211_FLAG_NEED_NETDEV
 0x02

	)

17935 
	#NL80211_FLAG_NEED_RTNL
 0x04

	)

17936 
	#NL80211_FLAG_CHECK_NETDEV_UP
 0x08

	)

17937 
	#NL80211_FLAG_NEED_NETDEV_UP
 (
NL80211_FLAG_NEED_NETDEV
 |\

17938 
NL80211_FLAG_CHECK_NETDEV_UP
)

	)

17939 
	#NL80211_FLAG_NEED_WDEV
 0x10

	)

17941 
	#NL80211_FLAG_NEED_WDEV_UP
 (
NL80211_FLAG_NEED_WDEV
 |\

17942 
NL80211_FLAG_CHECK_NETDEV_UP
)

	)

17943 
	#NL80211_FLAG_CLEAR_SKB
 0x20

	)

17944 
	#NL80211_FLAG_NO_WIPHY_MTX
 0x40

	)

17945 
	#NL80211_FLAG_MLO_VALID_LINK_ID
 0x80

	)

17946 
	#NL80211_FLAG_MLO_UNSUPPORTED
 0x100

	)

17948 
	#INTERNAL_FLAG_SELECTORS
(
__£l
) \

17949 
	`SELECTOR
(
__£l
, 
NONE
, 0) \

17950 
	`SELECTOR
(
__£l
, 
WIPHY
, \

17951 
NL80211_FLAG_NEED_WIPHY
) \

17952 
	`SELECTOR
(
__£l
, 
WDEV
, \

17953 
NL80211_FLAG_NEED_WDEV
) \

17954 
	`SELECTOR
(
__£l
, 
NETDEV
, \

17955 
NL80211_FLAG_NEED_NETDEV
) \

17956 
	`SELECTOR
(
__£l
, 
NETDEV_LINK
, \

17957 
NL80211_FLAG_NEED_NETDEV
 | \

17958 
NL80211_FLAG_MLO_VALID_LINK_ID
) \

17959 
	`SELECTOR
(
__£l
, 
NETDEV_NO_MLO
, \

17960 
NL80211_FLAG_NEED_NETDEV
 | \

17961 
NL80211_FLAG_MLO_UNSUPPORTED
) \

17962 
	`SELECTOR
(
__£l
, 
WIPHY_RTNL
, \

17963 
NL80211_FLAG_NEED_WIPHY
 | \

17964 
NL80211_FLAG_NEED_RTNL
) \

17965 
	`SELECTOR
(
__£l
, 
WIPHY_RTNL_NOMTX
, \

17966 
NL80211_FLAG_NEED_WIPHY
 | \

17967 
NL80211_FLAG_NEED_RTNL
 | \

17968 
NL80211_FLAG_NO_WIPHY_MTX
) \

17969 
	`SELECTOR
(
__£l
, 
WDEV_RTNL
, \

17970 
NL80211_FLAG_NEED_WDEV
 | \

17971 
NL80211_FLAG_NEED_RTNL
) \

17972 
	`SELECTOR
(
__£l
, 
NETDEV_RTNL
, \

17973 
NL80211_FLAG_NEED_NETDEV
 | \

17974 
NL80211_FLAG_NEED_RTNL
) \

17975 
	`SELECTOR
(
__£l
, 
NETDEV_UP
, \

17976 
NL80211_FLAG_NEED_NETDEV_UP
) \

17977 
	`SELECTOR
(
__£l
, 
NETDEV_UP_LINK
, \

17978 
NL80211_FLAG_NEED_NETDEV_UP
 | \

17979 
NL80211_FLAG_MLO_VALID_LINK_ID
) \

17980 
	`SELECTOR
(
__£l
, 
NETDEV_UP_NO_MLO
, \

17981 
NL80211_FLAG_NEED_NETDEV_UP
 | \

17982 
NL80211_FLAG_MLO_UNSUPPORTED
) \

17983 
	`SELECTOR
(
__£l
, 
NETDEV_UP_NO_MLO_CLEAR
, \

17984 
NL80211_FLAG_NEED_NETDEV_UP
 | \

17985 
NL80211_FLAG_CLEAR_SKB
 | \

17986 
NL80211_FLAG_MLO_UNSUPPORTED
) \

17987 
	`SELECTOR
(
__£l
, 
NETDEV_UP_NOTMX
, \

17988 
NL80211_FLAG_NEED_NETDEV_UP
 | \

17989 
NL80211_FLAG_NO_WIPHY_MTX
) \

17990 
	`SELECTOR
(
__£l
, 
NETDEV_UP_NOTMX_NOMLO
, \

17991 
NL80211_FLAG_NEED_NETDEV_UP
 | \

17992 
NL80211_FLAG_NO_WIPHY_MTX
 | \

17993 
NL80211_FLAG_MLO_UNSUPPORTED
) \

17994 
	`SELECTOR
(
__£l
, 
NETDEV_UP_CLEAR
, \

17995 
NL80211_FLAG_NEED_NETDEV_UP
 | \

17996 
NL80211_FLAG_CLEAR_SKB
) \

17997 
	`SELECTOR
(
__£l
, 
WDEV_UP
, \

17998 
NL80211_FLAG_NEED_WDEV_UP
) \

17999 
	`SELECTOR
(
__£l
, 
WDEV_UP_LINK
, \

18000 
NL80211_FLAG_NEED_WDEV_UP
 | \

18001 
NL80211_FLAG_MLO_VALID_LINK_ID
) \

18002 
	`SELECTOR
(
__£l
, 
WDEV_UP_RTNL
, \

18003 
NL80211_FLAG_NEED_WDEV_UP
 | \

18004 
NL80211_FLAG_NEED_RTNL
) \

18005 
	`SELECTOR
(
__£l
, 
WIPHY_CLEAR
, \

18006 
NL80211_FLAG_NEED_WIPHY
 | \

18007 
NL80211_FLAG_CLEAR_SKB
)

	)

18009 
	e∆80211_öã∫Æ_Êags_£À˘‹
 {

18010 
	#SELECTOR
(
_
, 
«me
, 
vÆue
Ë
NL80211_IFL_SEL_
##«me,

	)

18011 
INTERNAL_FLAG_SELECTORS
(
_
)

18012 #unde‡
SELECTOR


18015 
u32
 
	g∆80211_öã∫Æ_Êags
[] = {

18016 
	#SELECTOR
(
_
, 
«me
, 
vÆue
Ë[
NL80211_IFL_SEL_
##«me] = vÆue,

	)

18017 
INTERNAL_FLAG_SELECTORS
(
_
)

18018 #unde‡
SELECTOR


18021 
	$∆80211_¥e_doô
(c⁄° 
gíl_•lô_›s
 *
›s
,

18022 
sk_buff
 *
skb
,

18023 
gíl_öfo
 *
öfo
)

18025 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
NULL
;

18026 
wúñess_dev
 *
wdev
 = 
NULL
;

18027 
√t_devi˚
 *
dev
 = 
NULL
;

18028 
u32
 
öã∫Æ_Êags
;

18029 
îr
;

18031 i‡(
	`WARN_ON
(
›s
->
öã∫Æ_Êags
 >
	`ARRAY_SIZE
(
∆80211_öã∫Æ_Êags
)))

18032  -
EINVAL
;

18034 
öã∫Æ_Êags
 = 
∆80211_öã∫Æ_Êags
[
›s
->internal_flags];

18036 
	`π∆_lock
();

18037 i‡(
öã∫Æ_Êags
 & 
NL80211_FLAG_NEED_WIPHY
) {

18038 
rdev
 = 
	`cfg80211_gë_dev_‰om_öfo
(
	`gíl_öfo_√t
(
öfo
), info);

18039 i‡(
	`IS_ERR
(
rdev
)) {

18040 
îr
 = 
	`PTR_ERR
(
rdev
);

18041 
out_u∆ock
;

18043 
öfo
->
u£r_±r
[0] = 
rdev
;

18044 } i‡(
öã∫Æ_Êags
 & 
NL80211_FLAG_NEED_NETDEV
 ||

18045 
öã∫Æ_Êags
 & 
NL80211_FLAG_NEED_WDEV
) {

18046 
wdev
 = 
	`__cfg80211_wdev_‰om_©ås
(
NULL
, 
	`gíl_öfo_√t
(
öfo
),

18047 
öfo
->
©ås
);

18048 i‡(
	`IS_ERR
(
wdev
)) {

18049 
îr
 = 
	`PTR_ERR
(
wdev
);

18050 
out_u∆ock
;

18053 
dev
 = 
wdev
->
√tdev
;

18054 
	`dev_hﬁd
(
dev
);

18055 
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

18057 i‡(
öã∫Æ_Êags
 & 
NL80211_FLAG_NEED_NETDEV
) {

18058 i‡(!
dev
) {

18059 
îr
 = -
EINVAL
;

18060 
out_u∆ock
;

18063 
öfo
->
u£r_±r
[1] = 
dev
;

18065 
öfo
->
u£r_±r
[1] = 
wdev
;

18068 i‡(
öã∫Æ_Êags
 & 
NL80211_FLAG_CHECK_NETDEV_UP
 &&

18069 !
	`wdev_ru¬ög
(
wdev
)) {

18070 
îr
 = -
ENETDOWN
;

18071 
out_u∆ock
;

18074 
öfo
->
u£r_±r
[0] = 
rdev
;

18077 i‡(
öã∫Æ_Êags
 & 
NL80211_FLAG_MLO_VALID_LINK_ID
) {

18078 
∆©å
 *
lök_id
 = 
öfo
->
©ås
[
NL80211_ATTR_MLO_LINK_ID
];

18080 i‡(!
wdev
) {

18081 
îr
 = -
EINVAL
;

18082 
out_u∆ock
;

18086 i‡(
wdev
->
vÆid_löks
 &&

18087 (!
lök_id
 ||

18088 !(
wdev
->
vÆid_löks
 & 
	`BIT
(
	`∆a_gë_u8
(
lök_id
))))) {

18089 
îr
 = -
EINVAL
;

18090 
out_u∆ock
;

18094 i‡(!
wdev
->
vÆid_löks
 && 
lök_id
) {

18095 
îr
 = -
EINVAL
;

18096 
out_u∆ock
;

18100 i‡(
öã∫Æ_Êags
 & 
NL80211_FLAG_MLO_UNSUPPORTED
) {

18101 i‡(
öfo
->
©ås
[
NL80211_ATTR_MLO_LINK_ID
] ||

18102 (
wdev
 && wdev->
vÆid_löks
)) {

18103 
îr
 = -
EINVAL
;

18104 
out_u∆ock
;

18108 i‡(
rdev
 && !(
öã∫Æ_Êags
 & 
NL80211_FLAG_NO_WIPHY_MTX
)) {

18109 
	`wùhy_lock
(&
rdev
->
wùhy
);

18111 
	`__ªÀa£
(&
rdev
->
wùhy
.
mtx
);

18113 i‡(!(
öã∫Æ_Êags
 & 
NL80211_FLAG_NEED_RTNL
))

18114 
	`π∆_u∆ock
();

18117 
out_u∆ock
:

18118 
	`π∆_u∆ock
();

18119 
	`dev_put
(
dev
);

18120  
îr
;

18121 
	}
}

18123 
	$∆80211_po°_doô
(c⁄° 
gíl_•lô_›s
 *
›s
,

18124 
sk_buff
 *
skb
,

18125 
gíl_öfo
 *
öfo
)

18127 
u32
 
öã∫Æ_Êags
 = 
∆80211_öã∫Æ_Êags
[
›s
->internal_flags];

18129 i‡(
öfo
->
u£r_±r
[1]) {

18130 i‡(
öã∫Æ_Êags
 & 
NL80211_FLAG_NEED_WDEV
) {

18131 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

18133 
	`dev_put
(
wdev
->
√tdev
);

18135 
	`dev_put
(
öfo
->
u£r_±r
[1]);

18139 i‡(
öfo
->
u£r_±r
[0] &&

18140 !(
öã∫Æ_Êags
 & 
NL80211_FLAG_NO_WIPHY_MTX
)) {

18141 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

18144 
	`__acquúe
(&
rdev
->
wùhy
.
mtx
);

18145 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

18148 i‡(
öã∫Æ_Êags
 & 
NL80211_FLAG_NEED_RTNL
)

18149 
	`π∆_u∆ock
();

18156 i‡(
öã∫Æ_Êags
 & 
NL80211_FLAG_CLEAR_SKB
) {

18157 
∆msghdr
 *
∆h
 = 
	`∆msg_hdr
(
skb
);

18159 
	`mem£t
(
	`∆msg_d©a
(
∆h
), 0, 
	`∆msg_Àn
(nlh));

18161 
	}
}

18163 
	$∆80211_£t_ßr_sub_•ecs
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

18164 
cfg80211_ßr_•ecs
 *
ßr_•ecs
,

18165 
∆©å
 *
•ec
[], 
ödex
)

18167 
u32
 
ønge_ödex
, 
i
;

18169 i‡(!
ßr_•ecs
 || !
•ec
)

18170  -
EINVAL
;

18172 i‡(!
•ec
[
NL80211_SAR_ATTR_SPECS_POWER
] ||

18173 !
•ec
[
NL80211_SAR_ATTR_SPECS_RANGE_INDEX
])

18174  -
EINVAL
;

18176 
ønge_ödex
 = 
	`∆a_gë_u32
(
•ec
[
NL80211_SAR_ATTR_SPECS_RANGE_INDEX
]);

18179 i‡(
ønge_ödex
 >
rdev
->
wùhy
.
ßr_ˇ∑
->
num_‰eq_ønges
)

18180  -
EINVAL
;

18183 
i
 = 0; i < 
ödex
; i++) {

18184 i‡(
ßr_•ecs
->
sub_•ecs
[
i
].
‰eq_ønge_ödex
 =
ønge_ödex
)

18185  -
EINVAL
;

18188 
ßr_•ecs
->
sub_•ecs
[
ödex
].
powî
 =

18189 
	`∆a_gë_s32
(
•ec
[
NL80211_SAR_ATTR_SPECS_POWER
]);

18191 
ßr_•ecs
->
sub_•ecs
[
ödex
].
‰eq_ønge_ödex
 = 
ønge_ödex
;

18194 
	}
}

18196 
	$∆80211_£t_ßr_•ecs
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

18198 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

18199 
∆©å
 *
•ec
[
NL80211_SAR_ATTR_SPECS_MAX
 + 1];

18200 
∆©å
 *
tb
[
NL80211_SAR_ATTR_MAX
 + 1];

18201 
cfg80211_ßr_•ecs
 *
ßr_•ec
;

18202 
∆80211_ßr_ty≥
 
ty≥
;

18203 
∆©å
 *
•ec_li°
;

18204 
u32
 
•ecs
;

18205 
ªm
, 
îr
;

18207 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

18209 i‡(!
rdev
->
wùhy
.
ßr_ˇ∑
 || !rdev->
›s
->
£t_ßr_•ecs
) {

18210 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

18211  -
EOPNOTSUPP
;

18214 i‡(!
öfo
->
©ås
[
NL80211_ATTR_SAR_SPEC
]) {

18215 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

18216  -
EINVAL
;

18219 
	`∆a_∑r£_√°ed
(
tb
, 
NL80211_SAR_ATTR_MAX
,

18220 
öfo
->
©ås
[
NL80211_ATTR_SAR_SPEC
],

18221 
NULL
, NULL);

18223 i‡(!
tb
[
NL80211_SAR_ATTR_TYPE
] || !tb[
NL80211_SAR_ATTR_SPECS
]) {

18224 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

18225  -
EINVAL
;

18228 
ty≥
 = 
	`∆a_gë_u32
(
tb
[
NL80211_SAR_ATTR_TYPE
]);

18229 i‡(
ty≥
 !
rdev
->
wùhy
.
ßr_ˇ∑
->type) {

18230 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

18231  -
EINVAL
;

18234 
•ecs
 = 0;

18235 
	`∆a_f‹_óch_√°ed
(
•ec_li°
, 
tb
[
NL80211_SAR_ATTR_SPECS
], 
ªm
)

18236 
•ecs
++;

18238 i‡(
•ecs
 > 
rdev
->
wùhy
.
ßr_ˇ∑
->
num_‰eq_ønges
) {

18239 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

18240  -
EINVAL
;

18243 
ßr_•ec
 = 
	`kzÆloc
(
	`°ru˘_size
(ßr_•ec, 
sub_•ecs
, 
•ecs
), 
GFP_KERNEL
);

18244 i‡(!
ßr_•ec
) {

18245 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

18246  -
ENOMEM
;

18249 
ßr_•ec
->
ty≥
 =Åype;

18250 
•ecs
 = 0;

18251 
	`∆a_f‹_óch_√°ed
(
•ec_li°
, 
tb
[
NL80211_SAR_ATTR_SPECS
], 
ªm
) {

18252 
	`∆a_∑r£_√°ed
(
•ec
, 
NL80211_SAR_ATTR_SPECS_MAX
,

18253 
•ec_li°
, 
NULL
, NULL);

18255 
ty≥
) {

18256 
NL80211_SAR_TYPE_POWER
:

18257 i‡(
	`∆80211_£t_ßr_sub_•ecs
(
rdev
, 
ßr_•ec
,

18258 
•ec
, 
•ecs
)) {

18259 
îr
 = -
EINVAL
;

18260 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

18261 
îr‹
;

18263 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

18266 
îr
 = -
EINVAL
;

18267 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

18268 
îr‹
;

18270 
•ecs
++;

18273 
ßr_•ec
->
num_sub_•ecs
 = 
•ecs
;

18275 
rdev
->
cur_cmd_öfo
 = 
öfo
;

18276 
îr
 = 
	`rdev_£t_ßr_•ecs
(
rdev
, 
ßr_•ec
);

18277 
rdev
->
cur_cmd_öfo
 = 
NULL
;

18278 
îr‹
:

18279 
	`k‰ì
(
ßr_•ec
);

18280 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

18281  
îr
;

18282 
	}
}

18284 
	#SELECTOR
(
__£l
, 
«me
, 
vÆue
) \

18285 ((
__£l
Ë=(
vÆue
)Ë? 
NL80211_IFL_SEL_
##
«me
 :

	)

18286 
__missög_£À˘‹
();

18287 
	#IFLAGS
(
__vÆ
Ë
	`INTERNAL_FLAG_SELECTORS
(__vÆË
	`__missög_£À˘‹
()

	)

18289 c⁄° 
gíl_›s
 
	g∆80211_›s
[] = {

18291 .
cmd
 = 
NL80211_CMD_GET_WIPHY
,

18292 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18293 .
	gdoô
 = 
∆80211_gë_wùhy
,

18294 .
	gdumpô
 = 
∆80211_dump_wùhy
,

18295 .
	gd⁄e
 = 
∆80211_dump_wùhy_d⁄e
,

18297 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WIPHY
),

18301 c⁄° 
gíl_smÆl_›s
 
	g∆80211_smÆl_›s
[] = {

18303 .
cmd
 = 
NL80211_CMD_SET_WIPHY
,

18304 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18305 .
	gdoô
 = 
∆80211_£t_wùhy
,

18306 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18309 .
	gcmd
 = 
NL80211_CMD_GET_INTERFACE
,

18310 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18311 .
	gdoô
 = 
∆80211_gë_öãrÁ˚
,

18312 .
	gdumpô
 = 
∆80211_dump_öãrÁ˚
,

18314 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV
),

18317 .
	gcmd
 = 
NL80211_CMD_SET_INTERFACE
,

18318 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18319 .
	gdoô
 = 
∆80211_£t_öãrÁ˚
,

18320 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18321 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
 |

18322 
NL80211_FLAG_NEED_RTNL
),

18325 .
	gcmd
 = 
NL80211_CMD_NEW_INTERFACE
,

18326 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18327 .
	gdoô
 = 
∆80211_√w_öãrÁ˚
,

18328 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18329 .
	göã∫Æ_Êags
 =

18330 
IFLAGS
(
NL80211_FLAG_NEED_WIPHY
 |

18331 
NL80211_FLAG_NEED_RTNL
 |

18333 
NL80211_FLAG_NO_WIPHY_MTX
),

18336 .
	gcmd
 = 
NL80211_CMD_DEL_INTERFACE
,

18337 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18338 .
	gdoô
 = 
∆80211_dñ_öãrÁ˚
,

18339 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18340 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV
 |

18341 
NL80211_FLAG_NEED_RTNL
),

18344 .
	gcmd
 = 
NL80211_CMD_GET_KEY
,

18345 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18346 .
	gdoô
 = 
∆80211_gë_key
,

18347 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18348 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18351 .
	gcmd
 = 
NL80211_CMD_SET_KEY
,

18352 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18353 .
	gdoô
 = 
∆80211_£t_key
,

18354 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18356 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18357 
NL80211_FLAG_CLEAR_SKB
),

18360 .
	gcmd
 = 
NL80211_CMD_NEW_KEY
,

18361 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18362 .
	gdoô
 = 
∆80211_√w_key
,

18363 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18364 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18365 
NL80211_FLAG_CLEAR_SKB
),

18368 .
	gcmd
 = 
NL80211_CMD_DEL_KEY
,

18369 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18370 .
	gdoô
 = 
∆80211_dñ_key
,

18371 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18372 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18375 .
	gcmd
 = 
NL80211_CMD_SET_BEACON
,

18376 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18377 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18378 .
	gdoô
 = 
∆80211_£t_bóc⁄
,

18379 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18380 
NL80211_FLAG_MLO_VALID_LINK_ID
),

18383 .
	gcmd
 = 
NL80211_CMD_START_AP
,

18384 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18385 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18386 .
	gdoô
 = 
∆80211_°¨t_≠
,

18387 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18388 
NL80211_FLAG_MLO_VALID_LINK_ID
),

18391 .
	gcmd
 = 
NL80211_CMD_STOP_AP
,

18392 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18393 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18394 .
	gdoô
 = 
∆80211_°›_≠
,

18395 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18396 
NL80211_FLAG_MLO_VALID_LINK_ID
),

18399 .
	gcmd
 = 
NL80211_CMD_GET_STATION
,

18400 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18401 .
	gdoô
 = 
∆80211_gë_°©i⁄
,

18402 .
	gdumpô
 = 
∆80211_dump_°©i⁄
,

18403 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
),

18406 .
	gcmd
 = 
NL80211_CMD_SET_STATION
,

18407 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18408 .
	gdoô
 = 
∆80211_£t_°©i⁄
,

18409 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18410 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18413 .
	gcmd
 = 
NL80211_CMD_NEW_STATION
,

18414 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18415 .
	gdoô
 = 
∆80211_√w_°©i⁄
,

18416 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18417 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18420 .
	gcmd
 = 
NL80211_CMD_DEL_STATION
,

18421 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18422 .
	gdoô
 = 
∆80211_dñ_°©i⁄
,

18423 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18428 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18431 .
	gcmd
 = 
NL80211_CMD_GET_MPATH
,

18432 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18433 .
	gdoô
 = 
∆80211_gë_m∑th
,

18434 .
	gdumpô
 = 
∆80211_dump_m∑th
,

18435 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18436 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18439 .
	gcmd
 = 
NL80211_CMD_GET_MPP
,

18440 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18441 .
	gdoô
 = 
∆80211_gë_mµ
,

18442 .
	gdumpô
 = 
∆80211_dump_mµ
,

18443 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18444 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18447 .
	gcmd
 = 
NL80211_CMD_SET_MPATH
,

18448 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18449 .
	gdoô
 = 
∆80211_£t_m∑th
,

18450 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18451 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18454 .
	gcmd
 = 
NL80211_CMD_NEW_MPATH
,

18455 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18456 .
	gdoô
 = 
∆80211_√w_m∑th
,

18457 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18458 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18461 .
	gcmd
 = 
NL80211_CMD_DEL_MPATH
,

18462 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18463 .
	gdoô
 = 
∆80211_dñ_m∑th
,

18464 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18465 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18468 .
	gcmd
 = 
NL80211_CMD_SET_BSS
,

18469 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18470 .
	gdoô
 = 
∆80211_£t_bss
,

18471 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18472 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18473 
NL80211_FLAG_MLO_VALID_LINK_ID
),

18476 .
	gcmd
 = 
NL80211_CMD_GET_REG
,

18477 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18478 .
	gdoô
 = 
∆80211_gë_ªg_do
,

18479 .
	gdumpô
 = 
∆80211_gë_ªg_dump
,

18482 #ifde‡
CONFIG_CFG80211_CRDA_SUPPORT


18484 .
	gcmd
 = 
NL80211_CMD_SET_REG
,

18485 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18486 .
	gdoô
 = 
∆80211_£t_ªg
,

18487 .
	gÊags
 = 
GENL_ADMIN_PERM
,

18491 .
	gcmd
 = 
NL80211_CMD_REQ_SET_REG
,

18492 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18493 .
	gdoô
 = 
∆80211_ªq_£t_ªg
,

18494 .
	gÊags
 = 
GENL_ADMIN_PERM
,

18497 .
	gcmd
 = 
NL80211_CMD_RELOAD_REGDB
,

18498 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18499 .
	gdoô
 = 
∆80211_ªlﬂd_ªgdb
,

18500 .
	gÊags
 = 
GENL_ADMIN_PERM
,

18503 .
	gcmd
 = 
NL80211_CMD_GET_MESH_CONFIG
,

18504 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18505 .
	gdoô
 = 
∆80211_gë_mesh_c⁄fig
,

18507 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18510 .
	gcmd
 = 
NL80211_CMD_SET_MESH_CONFIG
,

18511 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18512 .
	gdoô
 = 
∆80211_upd©e_mesh_c⁄fig
,

18513 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18514 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18517 .
	gcmd
 = 
NL80211_CMD_TRIGGER_SCAN
,

18518 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18519 .
	gdoô
 = 
∆80211_åiggî_sˇn
,

18520 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18521 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
),

18524 .
	gcmd
 = 
NL80211_CMD_ABORT_SCAN
,

18525 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18526 .
	gdoô
 = 
∆80211_ab‹t_sˇn
,

18527 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18528 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
),

18531 .
	gcmd
 = 
NL80211_CMD_GET_SCAN
,

18532 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18533 .
	gdumpô
 = 
∆80211_dump_sˇn
,

18536 .
	gcmd
 = 
NL80211_CMD_START_SCHED_SCAN
,

18537 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18538 .
	gdoô
 = 
∆80211_°¨t_sched_sˇn
,

18539 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18540 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18543 .
	gcmd
 = 
NL80211_CMD_STOP_SCHED_SCAN
,

18544 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18545 .
	gdoô
 = 
∆80211_°›_sched_sˇn
,

18546 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18547 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18550 .
	gcmd
 = 
NL80211_CMD_AUTHENTICATE
,

18551 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18552 .
	gdoô
 = 
∆80211_authítiˇã
,

18553 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18554 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18555 
NL80211_FLAG_CLEAR_SKB
),

18558 .
	gcmd
 = 
NL80211_CMD_ASSOCIATE
,

18559 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18560 .
	gdoô
 = 
∆80211_assocüã
,

18561 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18562 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18563 
NL80211_FLAG_CLEAR_SKB
),

18566 .
	gcmd
 = 
NL80211_CMD_DEAUTHENTICATE
,

18567 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18568 .
	gdoô
 = 
∆80211_dóuthítiˇã
,

18569 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18570 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18573 .
	gcmd
 = 
NL80211_CMD_DISASSOCIATE
,

18574 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18575 .
	gdoô
 = 
∆80211_dißssocüã
,

18576 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18577 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18580 .
	gcmd
 = 
NL80211_CMD_JOIN_IBSS
,

18581 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18582 .
	gdoô
 = 
∆80211_joö_ibss
,

18583 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18584 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18587 .
	gcmd
 = 
NL80211_CMD_LEAVE_IBSS
,

18588 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18589 .
	gdoô
 = 
∆80211_Àave_ibss
,

18590 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18591 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18593 #ifde‡
CONFIG_NL80211_TESTMODE


18595 .
	gcmd
 = 
NL80211_CMD_TESTMODE
,

18596 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18597 .
	gdoô
 = 
∆80211_ã°mode_do
,

18598 .
	gdumpô
 = 
∆80211_ã°mode_dump
,

18599 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18600 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WIPHY
),

18604 .
	gcmd
 = 
NL80211_CMD_CONNECT
,

18605 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18606 .
	gdoô
 = 
∆80211_c⁄√˘
,

18607 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18608 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18609 
NL80211_FLAG_CLEAR_SKB
),

18612 .
	gcmd
 = 
NL80211_CMD_UPDATE_CONNECT_PARAMS
,

18613 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18614 .
	gdoô
 = 
∆80211_upd©e_c⁄√˘_∑øms
,

18615 .
	gÊags
 = 
GENL_ADMIN_PERM
,

18616 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18617 
NL80211_FLAG_CLEAR_SKB
),

18620 .
	gcmd
 = 
NL80211_CMD_DISCONNECT
,

18621 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18622 .
	gdoô
 = 
∆80211_disc⁄√˘
,

18623 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18624 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18627 .
	gcmd
 = 
NL80211_CMD_SET_WIPHY_NETNS
,

18628 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18629 .
	gdoô
 = 
∆80211_wùhy_√äs
,

18630 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18631 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WIPHY
 |

18632 
NL80211_FLAG_NEED_RTNL
 |

18633 
NL80211_FLAG_NO_WIPHY_MTX
),

18636 .
	gcmd
 = 
NL80211_CMD_GET_SURVEY
,

18637 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18638 .
	gdumpô
 = 
∆80211_dump_survey
,

18641 .
	gcmd
 = 
NL80211_CMD_SET_PMKSA
,

18642 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18643 .
	gdoô
 = 
∆80211_£t_pmkß
,

18644 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18645 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18646 
NL80211_FLAG_CLEAR_SKB
),

18649 .
	gcmd
 = 
NL80211_CMD_DEL_PMKSA
,

18650 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18651 .
	gdoô
 = 
∆80211_dñ_pmkß
,

18652 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18653 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18656 .
	gcmd
 = 
NL80211_CMD_FLUSH_PMKSA
,

18657 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18658 .
	gdoô
 = 
∆80211_Êush_pmkß
,

18659 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18660 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18663 .
	gcmd
 = 
NL80211_CMD_REMAIN_ON_CHANNEL
,

18664 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18665 .
	gdoô
 = 
∆80211_ªmaö_⁄_ch™√l
,

18666 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18668 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
 |

18669 
NL80211_FLAG_MLO_VALID_LINK_ID
),

18672 .
	gcmd
 = 
NL80211_CMD_CANCEL_REMAIN_ON_CHANNEL
,

18673 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18674 .
	gdoô
 = 
∆80211_ˇn˚l_ªmaö_⁄_ch™√l
,

18675 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18676 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
),

18679 .
	gcmd
 = 
NL80211_CMD_SET_TX_BITRATE_MASK
,

18680 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18681 .
	gdoô
 = 
∆80211_£t_tx_bôøã_mask
,

18682 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18683 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
 |

18684 
NL80211_FLAG_MLO_VALID_LINK_ID
),

18687 .
	gcmd
 = 
NL80211_CMD_REGISTER_FRAME
,

18688 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18689 .
	gdoô
 = 
∆80211_ªgi°î_mgmt
,

18690 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18691 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV
),

18694 .
	gcmd
 = 
NL80211_CMD_FRAME
,

18695 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18696 .
	gdoô
 = 
∆80211_tx_mgmt
,

18697 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18698 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
),

18701 .
	gcmd
 = 
NL80211_CMD_FRAME_WAIT_CANCEL
,

18702 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18703 .
	gdoô
 = 
∆80211_tx_mgmt_ˇn˚l_waô
,

18704 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18705 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
),

18708 .
	gcmd
 = 
NL80211_CMD_SET_POWER_SAVE
,

18709 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18710 .
	gdoô
 = 
∆80211_£t_powî_ßve
,

18711 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18712 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
),

18715 .
	gcmd
 = 
NL80211_CMD_GET_POWER_SAVE
,

18716 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18717 .
	gdoô
 = 
∆80211_gë_powî_ßve
,

18719 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
),

18722 .
	gcmd
 = 
NL80211_CMD_SET_CQM
,

18723 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18724 .
	gdoô
 = 
∆80211_£t_cqm
,

18725 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18726 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
),

18729 .
	gcmd
 = 
NL80211_CMD_SET_CHANNEL
,

18730 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18731 .
	gdoô
 = 
∆80211_£t_ch™√l
,

18732 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18733 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
 |

18734 
NL80211_FLAG_MLO_VALID_LINK_ID
),

18737 .
	gcmd
 = 
NL80211_CMD_JOIN_MESH
,

18738 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18739 .
	gdoô
 = 
∆80211_joö_mesh
,

18740 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18741 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18744 .
	gcmd
 = 
NL80211_CMD_LEAVE_MESH
,

18745 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18746 .
	gdoô
 = 
∆80211_Àave_mesh
,

18747 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18748 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18751 .
	gcmd
 = 
NL80211_CMD_JOIN_OCB
,

18752 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18753 .
	gdoô
 = 
∆80211_joö_ocb
,

18754 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18755 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18758 .
	gcmd
 = 
NL80211_CMD_LEAVE_OCB
,

18759 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18760 .
	gdoô
 = 
∆80211_Àave_ocb
,

18761 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18762 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18764 #ifde‡
CONFIG_PM


18766 .
	gcmd
 = 
NL80211_CMD_GET_WOWLAN
,

18767 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18768 .
	gdoô
 = 
∆80211_gë_wowœn
,

18770 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WIPHY
),

18773 .
	gcmd
 = 
NL80211_CMD_SET_WOWLAN
,

18774 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18775 .
	gdoô
 = 
∆80211_£t_wowœn
,

18776 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18777 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WIPHY
),

18781 .
	gcmd
 = 
NL80211_CMD_SET_REKEY_OFFLOAD
,

18782 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18783 .
	gdoô
 = 
∆80211_£t_ªkey_d©a
,

18784 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18785 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18786 
NL80211_FLAG_CLEAR_SKB
),

18789 .
	gcmd
 = 
NL80211_CMD_TDLS_MGMT
,

18790 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18791 .
	gdoô
 = 
∆80211_tdls_mgmt
,

18792 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18793 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18794 
NL80211_FLAG_MLO_VALID_LINK_ID
),

18797 .
	gcmd
 = 
NL80211_CMD_TDLS_OPER
,

18798 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18799 .
	gdoô
 = 
∆80211_tdls_›î
,

18800 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18801 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18804 .
	gcmd
 = 
NL80211_CMD_UNEXPECTED_FRAME
,

18805 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18806 .
	gdoô
 = 
∆80211_ªgi°î_u√x≥˘ed_‰ame
,

18807 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18808 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
),

18811 .
	gcmd
 = 
NL80211_CMD_PROBE_CLIENT
,

18812 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18813 .
	gdoô
 = 
∆80211_¥obe_˛õ¡
,

18814 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18815 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18818 .
	gcmd
 = 
NL80211_CMD_REGISTER_BEACONS
,

18819 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18820 .
	gdoô
 = 
∆80211_ªgi°î_bóc⁄s
,

18821 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18822 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WIPHY
),

18825 .
	gcmd
 = 
NL80211_CMD_SET_NOACK_MAP
,

18826 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18827 .
	gdoô
 = 
∆80211_£t_nﬂck_m≠
,

18828 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18829 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
),

18832 .
	gcmd
 = 
NL80211_CMD_START_P2P_DEVICE
,

18833 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18834 .
	gdoô
 = 
∆80211_°¨t_p2p_devi˚
,

18835 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18836 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV
 |

18837 
NL80211_FLAG_NEED_RTNL
),

18840 .
	gcmd
 = 
NL80211_CMD_STOP_P2P_DEVICE
,

18841 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18842 .
	gdoô
 = 
∆80211_°›_p2p_devi˚
,

18843 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18844 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
 |

18845 
NL80211_FLAG_NEED_RTNL
),

18848 .
	gcmd
 = 
NL80211_CMD_START_NAN
,

18849 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18850 .
	gdoô
 = 
∆80211_°¨t_«n
,

18851 .
	gÊags
 = 
GENL_ADMIN_PERM
,

18852 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV
 |

18853 
NL80211_FLAG_NEED_RTNL
),

18856 .
	gcmd
 = 
NL80211_CMD_STOP_NAN
,

18857 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18858 .
	gdoô
 = 
∆80211_°›_«n
,

18859 .
	gÊags
 = 
GENL_ADMIN_PERM
,

18860 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
 |

18861 
NL80211_FLAG_NEED_RTNL
),

18864 .
	gcmd
 = 
NL80211_CMD_ADD_NAN_FUNCTION
,

18865 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18866 .
	gdoô
 = 
∆80211_«n_add_func
,

18867 .
	gÊags
 = 
GENL_ADMIN_PERM
,

18868 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
),

18871 .
	gcmd
 = 
NL80211_CMD_DEL_NAN_FUNCTION
,

18872 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18873 .
	gdoô
 = 
∆80211_«n_dñ_func
,

18874 .
	gÊags
 = 
GENL_ADMIN_PERM
,

18875 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
),

18878 .
	gcmd
 = 
NL80211_CMD_CHANGE_NAN_CONFIG
,

18879 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18880 .
	gdoô
 = 
∆80211_«n_ch™ge_c⁄fig
,

18881 .
	gÊags
 = 
GENL_ADMIN_PERM
,

18882 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
),

18885 .
	gcmd
 = 
NL80211_CMD_SET_MCAST_RATE
,

18886 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18887 .
	gdoô
 = 
∆80211_£t_mˇ°_øã
,

18888 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18889 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
),

18892 .
	gcmd
 = 
NL80211_CMD_SET_MAC_ACL
,

18893 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18894 .
	gdoô
 = 
∆80211_£t_mac_a˛
,

18895 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18896 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
 |

18897 
NL80211_FLAG_MLO_UNSUPPORTED
),

18900 .
	gcmd
 = 
NL80211_CMD_RADAR_DETECT
,

18901 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18902 .
	gdoô
 = 
∆80211_°¨t_ød¨_dëe˘i⁄
,

18903 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18904 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18905 
NL80211_FLAG_NO_WIPHY_MTX
 |

18906 
NL80211_FLAG_MLO_UNSUPPORTED
),

18909 .
	gcmd
 = 
NL80211_CMD_GET_PROTOCOL_FEATURES
,

18910 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18911 .
	gdoô
 = 
∆80211_gë_¥Ÿocﬁ_„©uªs
,

18914 .
	gcmd
 = 
NL80211_CMD_UPDATE_FT_IES
,

18915 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18916 .
	gdoô
 = 
∆80211_upd©e_·_õs
,

18917 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18918 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18921 .
	gcmd
 = 
NL80211_CMD_CRIT_PROTOCOL_START
,

18922 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18923 .
	gdoô
 = 
∆80211_¸ô_¥Ÿocﬁ_°¨t
,

18924 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18925 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
),

18928 .
	gcmd
 = 
NL80211_CMD_CRIT_PROTOCOL_STOP
,

18929 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18930 .
	gdoô
 = 
∆80211_¸ô_¥Ÿocﬁ_°›
,

18931 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18932 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
),

18935 .
	gcmd
 = 
NL80211_CMD_GET_COALESCE
,

18936 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18937 .
	gdoô
 = 
∆80211_gë_cﬂÀs˚
,

18938 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WIPHY
),

18941 .
	gcmd
 = 
NL80211_CMD_SET_COALESCE
,

18942 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18943 .
	gdoô
 = 
∆80211_£t_cﬂÀs˚
,

18944 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18945 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WIPHY
),

18948 .
	gcmd
 = 
NL80211_CMD_CHANNEL_SWITCH
,

18949 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18950 .
	gdoô
 = 
∆80211_ch™√l_swôch
,

18951 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18952 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18953 
NL80211_FLAG_MLO_VALID_LINK_ID
),

18956 .
	gcmd
 = 
NL80211_CMD_VENDOR
,

18957 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18958 .
	gdoô
 = 
∆80211_víd‹_cmd
,

18959 .
	gdumpô
 = 
∆80211_víd‹_cmd_dump
,

18960 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18961 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WIPHY
 |

18962 
NL80211_FLAG_CLEAR_SKB
),

18965 .
	gcmd
 = 
NL80211_CMD_SET_QOS_MAP
,

18966 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18967 .
	gdoô
 = 
∆80211_£t_qos_m≠
,

18968 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18969 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18972 .
	gcmd
 = 
NL80211_CMD_ADD_TX_TS
,

18973 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18974 .
	gdoô
 = 
∆80211_add_tx_ts
,

18975 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18976 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

18977 
NL80211_FLAG_MLO_UNSUPPORTED
),

18980 .
	gcmd
 = 
NL80211_CMD_DEL_TX_TS
,

18981 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18982 .
	gdoô
 = 
∆80211_dñ_tx_ts
,

18983 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18984 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18987 .
	gcmd
 = 
NL80211_CMD_TDLS_CHANNEL_SWITCH
,

18988 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18989 .
	gdoô
 = 
∆80211_tdls_ch™√l_swôch
,

18990 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18991 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

18994 .
	gcmd
 = 
NL80211_CMD_TDLS_CANCEL_CHANNEL_SWITCH
,

18995 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

18996 .
	gdoô
 = 
∆80211_tdls_ˇn˚l_ch™√l_swôch
,

18997 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

18998 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19001 .
	gcmd
 = 
NL80211_CMD_SET_MULTICAST_TO_UNICAST
,

19002 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

19003 .
	gdoô
 = 
∆80211_£t_mu…iˇ°_to_uniˇ°
,

19004 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19005 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
),

19008 .
	gcmd
 = 
NL80211_CMD_SET_PMK
,

19009 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

19010 .
	gdoô
 = 
∆80211_£t_pmk
,

19011 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

19012 
NL80211_FLAG_CLEAR_SKB
),

19015 .
	gcmd
 = 
NL80211_CMD_DEL_PMK
,

19016 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

19017 .
	gdoô
 = 
∆80211_dñ_pmk
,

19018 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19021 .
	gcmd
 = 
NL80211_CMD_EXTERNAL_AUTH
,

19022 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

19023 .
	gdoô
 = 
∆80211_exã∫Æ_auth
,

19024 .
	gÊags
 = 
GENL_ADMIN_PERM
,

19025 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19028 .
	gcmd
 = 
NL80211_CMD_CONTROL_PORT_FRAME
,

19029 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

19030 .
	gdoô
 = 
∆80211_tx_c⁄åﬁ_p‹t
,

19031 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19032 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19035 .
	gcmd
 = 
NL80211_CMD_GET_FTM_RESPONDER_STATS
,

19036 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

19037 .
	gdoô
 = 
∆80211_gë_·m_ª•⁄dî_°©s
,

19038 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
 |

19039 
NL80211_FLAG_MLO_VALID_LINK_ID
),

19042 .
	gcmd
 = 
NL80211_CMD_PEER_MEASUREMENT_START
,

19043 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

19044 .
	gdoô
 = 
∆80211_pm§_°¨t
,

19045 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19046 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WDEV_UP
),

19049 .
	gcmd
 = 
NL80211_CMD_NOTIFY_RADAR
,

19050 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

19051 .
	gdoô
 = 
∆80211_nŸify_ød¨_dëe˘i⁄
,

19052 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19053 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19056 .
	gcmd
 = 
NL80211_CMD_UPDATE_OWE_INFO
,

19057 .
	gdoô
 = 
∆80211_upd©e_owe_öfo
,

19058 .
	gÊags
 = 
GENL_ADMIN_PERM
,

19059 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19062 .
	gcmd
 = 
NL80211_CMD_PROBE_MESH_LINK
,

19063 .
	gdoô
 = 
∆80211_¥obe_mesh_lök
,

19064 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19065 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19068 .
	gcmd
 = 
NL80211_CMD_SET_TID_CONFIG
,

19069 .
	gdoô
 = 
∆80211_£t_tid_c⁄fig
,

19070 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19071 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV
 |

19072 
NL80211_FLAG_MLO_VALID_LINK_ID
),

19075 .
	gcmd
 = 
NL80211_CMD_SET_SAR_SPECS
,

19076 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

19077 .
	gdoô
 = 
∆80211_£t_ßr_•ecs
,

19078 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19079 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_WIPHY
 |

19080 
NL80211_FLAG_NEED_RTNL
),

19083 .
	gcmd
 = 
NL80211_CMD_COLOR_CHANGE_REQUEST
,

19084 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

19085 .
	gdoô
 = 
∆80211_cﬁ‹_ch™ge
,

19086 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19087 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19090 .
	gcmd
 = 
NL80211_CMD_SET_FILS_AAD
,

19091 .
	gvÆid©e
 = 
GENL_DONT_VALIDATE_STRICT
 | 
GENL_DONT_VALIDATE_DUMP
,

19092 .
	gdoô
 = 
∆80211_£t_fûs_Ød
,

19093 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19094 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19097 .
	gcmd
 = 
NL80211_CMD_ADD_LINK
,

19098 .
	gdoô
 = 
∆80211_add_lök
,

19099 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19100 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19103 .
	gcmd
 = 
NL80211_CMD_REMOVE_LINK
,

19104 .
	gdoô
 = 
∆80211_ªmove_lök
,

19105 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19106 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

19107 
NL80211_FLAG_MLO_VALID_LINK_ID
),

19110 .
	gcmd
 = 
NL80211_CMD_ADD_LINK_STA
,

19111 .
	gdoô
 = 
∆80211_add_lök_°©i⁄
,

19112 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19113 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

19114 
NL80211_FLAG_MLO_VALID_LINK_ID
),

19117 .
	gcmd
 = 
NL80211_CMD_MODIFY_LINK_STA
,

19118 .
	gdoô
 = 
∆80211_modify_lök_°©i⁄
,

19119 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19120 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

19121 
NL80211_FLAG_MLO_VALID_LINK_ID
),

19124 .
	gcmd
 = 
NL80211_CMD_REMOVE_LINK_STA
,

19125 .
	gdoô
 = 
∆80211_ªmove_lök_°©i⁄
,

19126 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19127 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
 |

19128 
NL80211_FLAG_MLO_VALID_LINK_ID
),

19131 .
	gcmd
 = 
NL80211_CMD_SET_HW_TIMESTAMP
,

19132 .
	gdoô
 = 
∆80211_£t_hw_time°amp
,

19133 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19134 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19137 .
	gcmd
 = 
NL80211_CMD_SET_TID_TO_LINK_MAPPING
,

19138 .
	gdoô
 = 
∆80211_£t_âlm
,

19139 .
	gÊags
 = 
GENL_UNS_ADMIN_PERM
,

19140 .
	göã∫Æ_Êags
 = 
IFLAGS
(
NL80211_FLAG_NEED_NETDEV_UP
),

19144 
gíl_Ámûy
 
∆80211_Ám
 
	g__ro_a·î_öô
 = {

19145 .
«me
 = 
NL80211_GENL_NAME
,

19146 .
	ghdrsize
 = 0,

19147 .
	gvîsi⁄
 = 1,

19148 .
	gmax©å
 = 
NL80211_ATTR_MAX
,

19149 .
	gpﬁicy
 = 
∆80211_pﬁicy
,

19150 .
	g√äsok
 = 
åue
,

19151 .
	g¥e_doô
 = 
∆80211_¥e_doô
,

19152 .
	gpo°_doô
 = 
∆80211_po°_doô
,

19153 .
	gmoduÀ
 = 
THIS_MODULE
,

19154 .
	g›s
 = 
∆80211_›s
,

19155 .
	gn_›s
 = 
ARRAY_SIZE
(
∆80211_›s
),

19156 .
	gsmÆl_›s
 = 
∆80211_smÆl_›s
,

19157 .
	gn_smÆl_›s
 = 
ARRAY_SIZE
(
∆80211_smÆl_›s
),

19158 .
	gªsv_°¨t_›
 = 
NL80211_CMD_REMOVE_LINK_STA
 + 1,

19159 .
	gmcgΩs
 = 
∆80211_mcgΩs
,

19160 .
	gn_mcgΩs
 = 
ARRAY_SIZE
(
∆80211_mcgΩs
),

19161 .
	g∑øŒñ_›s
 = 
åue
,

19166 
	$∆80211_nŸify_wùhy
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19167 
∆80211_comm™ds
 
cmd
)

19169 
sk_buff
 *
msg
;

19170 
∆80211_dump_wùhy_°©e
 
°©e
 = {};

19172 
	`WARN_ON
(
cmd
 !
NL80211_CMD_NEW_WIPHY
 &&

19173 
cmd
 !
NL80211_CMD_DEL_WIPHY
);

19175 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

19176 i‡(!
msg
)

19179 i‡(
	`∆80211_£nd_wùhy
(
rdev
, 
cmd
, 
msg
, 0, 0, 0, &
°©e
) < 0) {

19180 
	`∆msg_‰ì
(
msg
);

19184 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

19185 
NL80211_MCGRP_CONFIG
, 
GFP_KERNEL
);

19186 
	}
}

19188 
	$∆80211_nŸify_iÁ˚
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19189 
wúñess_dev
 *
wdev
,

19190 
∆80211_comm™ds
 
cmd
)

19192 
sk_buff
 *
msg
;

19194 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

19195 i‡(!
msg
)

19198 i‡(
	`∆80211_£nd_iÁ˚
(
msg
, 0, 0, 0, 
rdev
, 
wdev
, 
cmd
) < 0) {

19199 
	`∆msg_‰ì
(
msg
);

19203 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

19204 
NL80211_MCGRP_CONFIG
, 
GFP_KERNEL
);

19205 
	}
}

19207 
	$∆80211_add_sˇn_ªq
(
sk_buff
 *
msg
,

19208 
cfg80211_ªgi°îed_devi˚
 *
rdev
)

19210 
cfg80211_sˇn_ªque°
 *
ªq
 = 
rdev
->
sˇn_ªq
;

19211 
∆©å
 *
√°
;

19212 
i
;

19213 
cfg80211_sˇn_öfo
 *
öfo
;

19215 i‡(
	`WARN_ON
(!
ªq
))

19218 
√°
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_SCAN_SSIDS
);

19219 i‡(!
√°
)

19220 
∆a_put_Áûuª
;

19221 
i
 = 0; i < 
ªq
->
n_ssids
; i++) {

19222 i‡(
	`∆a_put
(
msg
, 
i
, 
ªq
->
ssids
[i].
ssid_Àn
,Ñeq->ssids[i].
ssid
))

19223 
∆a_put_Áûuª
;

19225 
	`∆a_√°_íd
(
msg
, 
√°
);

19227 i‡(
ªq
->
Êags
 & 
NL80211_SCAN_FLAG_FREQ_KHZ
) {

19228 
√°
 = 
	`∆a_√°_°¨t
(
msg
, 
NL80211_ATTR_SCAN_FREQ_KHZ
);

19229 i‡(!
√°
)

19230 
∆a_put_Áûuª
;

19231 
i
 = 0; i < 
ªq
->
n_ch™√ls
; i++) {

19232 i‡(
	`∆a_put_u32
(
msg
, 
i
,

19233 
	`õì80211_ch™√l_to_khz
(
ªq
->
ch™√ls
[
i
])))

19234 
∆a_put_Áûuª
;

19236 
	`∆a_√°_íd
(
msg
, 
√°
);

19238 
√°
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

19239 
NL80211_ATTR_SCAN_FREQUENCIES
);

19240 i‡(!
√°
)

19241 
∆a_put_Áûuª
;

19242 
i
 = 0; i < 
ªq
->
n_ch™√ls
; i++) {

19243 i‡(
	`∆a_put_u32
(
msg
, 
i
, 
ªq
->
ch™√ls
[i]->
˚¡î_‰eq
))

19244 
∆a_put_Áûuª
;

19246 
	`∆a_√°_íd
(
msg
, 
√°
);

19249 i‡(
ªq
->
õ
 &&

19250 
	`∆a_put
(
msg
, 
NL80211_ATTR_IE
, 
ªq
->
õ_Àn
,Ñeq->
õ
))

19251 
∆a_put_Áûuª
;

19253 i‡(
ªq
->
Êags
 &&

19254 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_SCAN_FLAGS
, 
ªq
->
Êags
))

19255 
∆a_put_Áûuª
;

19257 
öfo
 = 
rdev
->
öt_sˇn_ªq
 ? &rdev->int_scan_req->info :

19258 &
rdev
->
sˇn_ªq
->
öfo
;

19259 i‡(
öfo
->
sˇn_°¨t_tsf
 &&

19260 (
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_SCAN_START_TIME_TSF
,

19261 
öfo
->
sˇn_°¨t_tsf
, 
NL80211_BSS_PAD
) ||

19262 
	`∆a_put
(
msg
, 
NL80211_ATTR_SCAN_START_TIME_TSF_BSSID
, 
ETH_ALEN
,

19263 
öfo
->
tsf_bssid
)))

19264 
∆a_put_Áûuª
;

19267 
∆a_put_Áûuª
:

19268  -
ENOBUFS
;

19269 
	}
}

19271 
	$∆80211_¥ï_sˇn_msg
(
sk_buff
 *
msg
,

19272 
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19273 
wúñess_dev
 *
wdev
,

19274 
u32
 
p‹tid
, u32 
£q
, 
Êags
,

19275 
u32
 
cmd
)

19277 *
hdr
;

19279 
hdr
 = 
	`∆80211hdr_put
(
msg
, 
p‹tid
, 
£q
, 
Êags
, 
cmd
);

19280 i‡(!
hdr
)

19283 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

19284 (
wdev
->
√tdev
 && 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
,

19285 
wdev
->
√tdev
->
ifödex
)) ||

19286 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

19287 
NL80211_ATTR_PAD
))

19288 
∆a_put_Áûuª
;

19291 
	`∆80211_add_sˇn_ªq
(
msg
, 
rdev
);

19293 
	`gílmsg_íd
(
msg
, 
hdr
);

19296 
∆a_put_Áûuª
:

19297 
	`gílmsg_ˇn˚l
(
msg
, 
hdr
);

19298  -
EMSGSIZE
;

19299 
	}
}

19302 
	$∆80211_¥ï_sched_sˇn_msg
(
sk_buff
 *
msg
,

19303 
cfg80211_sched_sˇn_ªque°
 *
ªq
, 
u32
 
cmd
)

19305 *
hdr
;

19307 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
cmd
);

19308 i‡(!
hdr
)

19311 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
,

19312 
	`wùhy_to_rdev
(
ªq
->
wùhy
)->
wùhy_idx
) ||

19313 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
ªq
->
dev
->
ifödex
) ||

19314 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
ªq
->
ªqid
,

19315 
NL80211_ATTR_PAD
))

19316 
∆a_put_Áûuª
;

19318 
	`gílmsg_íd
(
msg
, 
hdr
);

19321 
∆a_put_Áûuª
:

19322 
	`gílmsg_ˇn˚l
(
msg
, 
hdr
);

19323  -
EMSGSIZE
;

19324 
	}
}

19326 
	$∆80211_£nd_sˇn_°¨t
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19327 
wúñess_dev
 *
wdev
)

19329 
sk_buff
 *
msg
;

19331 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

19332 i‡(!
msg
)

19335 i‡(
	`∆80211_¥ï_sˇn_msg
(
msg
, 
rdev
, 
wdev
, 0, 0, 0,

19336 
NL80211_CMD_TRIGGER_SCAN
) < 0) {

19337 
	`∆msg_‰ì
(
msg
);

19341 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

19342 
NL80211_MCGRP_SCAN
, 
GFP_KERNEL
);

19343 
	}
}

19345 
sk_buff
 *
	$∆80211_buûd_sˇn_msg
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19346 
wúñess_dev
 *
wdev
, 
boﬁ
 
ab‹ãd
)

19348 
sk_buff
 *
msg
;

19350 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

19351 i‡(!
msg
)

19352  
NULL
;

19354 i‡(
	`∆80211_¥ï_sˇn_msg
(
msg
, 
rdev
, 
wdev
, 0, 0, 0,

19355 
ab‹ãd
 ? 
NL80211_CMD_SCAN_ABORTED
 :

19356 
NL80211_CMD_NEW_SCAN_RESULTS
) < 0) {

19357 
	`∆msg_‰ì
(
msg
);

19358  
NULL
;

19361  
msg
;

19362 
	}
}

19365 
	$∆80211_£nd_sˇn_msg
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19366 
sk_buff
 *
msg
)

19368 i‡(!
msg
)

19371 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

19372 
NL80211_MCGRP_SCAN
, 
GFP_KERNEL
);

19373 
	}
}

19375 
	$∆80211_£nd_sched_sˇn
(
cfg80211_sched_sˇn_ªque°
 *
ªq
, 
u32
 
cmd
)

19377 
sk_buff
 *
msg
;

19379 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

19380 i‡(!
msg
)

19383 i‡(
	`∆80211_¥ï_sched_sˇn_msg
(
msg
, 
ªq
, 
cmd
) < 0) {

19384 
	`∆msg_‰ì
(
msg
);

19388 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(
ªq
->
wùhy
), 
msg
, 0,

19389 
NL80211_MCGRP_SCAN
, 
GFP_KERNEL
);

19390 
	}
}

19392 
boﬁ
 
	$∆80211_ªg_ch™ge_evít_fûl
(
sk_buff
 *
msg
,

19393 
ªguœt‹y_ªque°
 *
ªque°
)

19396 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_REG_INITIATOR
, 
ªque°
->
öôüt‹
))

19397 
∆a_put_Áûuª
;

19399 i‡(
ªque°
->
Æpha2
[0] == '0' &&Ñequest->alpha2[1] == '0') {

19400 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_REG_TYPE
,

19401 
NL80211_REGDOM_TYPE_WORLD
))

19402 
∆a_put_Áûuª
;

19403 } i‡(
ªque°
->
Æpha2
[0] == '9' &&Ñequest->alpha2[1] == '9') {

19404 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_REG_TYPE
,

19405 
NL80211_REGDOM_TYPE_CUSTOM_WORLD
))

19406 
∆a_put_Áûuª
;

19407 } i‡((
ªque°
->
Æpha2
[0] == '9' &&Ñequest->alpha2[1] == '8') ||

19408 
ªque°
->
öãr£˘
) {

19409 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_REG_TYPE
,

19410 
NL80211_REGDOM_TYPE_INTERSECTION
))

19411 
∆a_put_Áûuª
;

19413 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_REG_TYPE
,

19414 
NL80211_REGDOM_TYPE_COUNTRY
) ||

19415 
	`∆a_put_°rög
(
msg
, 
NL80211_ATTR_REG_ALPHA2
,

19416 
ªque°
->
Æpha2
))

19417 
∆a_put_Áûuª
;

19420 i‡(
ªque°
->
wùhy_idx
 !
WIPHY_IDX_INVALID
) {

19421 
wùhy
 *wùhy = 
	`wùhy_idx_to_wùhy
(
ªque°
->
wùhy_idx
);

19423 i‡(
wùhy
 &&

19424 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
ªque°
->
wùhy_idx
))

19425 
∆a_put_Áûuª
;

19427 i‡(
wùhy
 &&

19428 
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
 &&

19429 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_WIPHY_SELF_MANAGED_REG
))

19430 
∆a_put_Áûuª
;

19433  
åue
;

19435 
∆a_put_Áûuª
:

19436  
Ál£
;

19437 
	}
}

19443 
	$∆80211_comm⁄_ªg_ch™ge_evít
(
∆80211_comm™ds
 
cmd_id
,

19444 
ªguœt‹y_ªque°
 *
ªque°
)

19446 
sk_buff
 *
msg
;

19447 *
hdr
;

19449 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

19450 i‡(!
msg
)

19453 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
cmd_id
);

19454 i‡(!
hdr
)

19455 
∆a_put_Áûuª
;

19457 i‡(!
	`∆80211_ªg_ch™ge_evít_fûl
(
msg
, 
ªque°
))

19458 
∆a_put_Áûuª
;

19460 
	`gílmsg_íd
(
msg
, 
hdr
);

19462 
	`rcu_ªad_lock
();

19463 
	`gílmsg_mu…iˇ°_Æ s
(&
∆80211_Ám
, 
msg
, 0,

19464 
NL80211_MCGRP_REGULATORY
, 
GFP_ATOMIC
);

19465 
	`rcu_ªad_u∆ock
();

19469 
∆a_put_Áûuª
:

19470 
	`∆msg_‰ì
(
msg
);

19471 
	}
}

19473 
	s∆80211_mlme_evít
 {

19474 
∆80211_comm™ds
 
	mcmd
;

19475 c⁄° 
u8
 *
	mbuf
;

19476 
size_t
 
	mbuf_Àn
;

19477 
	mu≠sd_queues
;

19478 c⁄° 
u8
 *
	mªq_õs
;

19479 
size_t
 
	mªq_õs_Àn
;

19480 
boﬁ
 
	mªc⁄√˘
;

19483 
	$∆80211_£nd_mlme_evít
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19484 
√t_devi˚
 *
√tdev
,

19485 c⁄° 
∆80211_mlme_evít
 *
evít
,

19486 
gÂ_t
 
gÂ
)

19488 
sk_buff
 *
msg
;

19489 *
hdr
;

19491 
msg
 = 
	`∆msg_√w
(100 + 
evít
->
buf_Àn
 +Évít->
ªq_õs_Àn
, 
gÂ
);

19492 i‡(!
msg
)

19495 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
evít
->
cmd
);

19496 i‡(!
hdr
) {

19497 
	`∆msg_‰ì
(
msg
);

19501 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

19502 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

19503 
	`∆a_put
(
msg
, 
NL80211_ATTR_FRAME
, 
evít
->
buf_Àn
,Évít->
buf
) ||

19504 (
evít
->
ªq_õs
 &&

19505 
	`∆a_put
(
msg
, 
NL80211_ATTR_REQ_IE
, 
evít
->
ªq_õs_Àn
,

19506 
evít
->
ªq_õs
)))

19507 
∆a_put_Áûuª
;

19509 i‡(
evít
->
ªc⁄√˘
 &&

19510 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_RECONNECT_REQUESTED
))

19511 
∆a_put_Áûuª
;

19513 i‡(
evít
->
u≠sd_queues
 >= 0) {

19514 
∆©å
 *
∆a_wmm
 =

19515 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_STA_WME
);

19516 i‡(!
∆a_wmm
)

19517 
∆a_put_Áûuª
;

19519 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_STA_WME_UAPSD_QUEUES
,

19520 
evít
->
u≠sd_queues
))

19521 
∆a_put_Áûuª
;

19523 
	`∆a_√°_íd
(
msg
, 
∆a_wmm
);

19526 
	`gílmsg_íd
(
msg
, 
hdr
);

19528 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

19529 
NL80211_MCGRP_MLME
, 
gÂ
);

19532 
∆a_put_Áûuª
:

19533 
	`∆msg_‰ì
(
msg
);

19534 
	}
}

19536 
	$∆80211_£nd_rx_auth
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19537 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
buf
,

19538 
size_t
 
Àn
, 
gÂ_t
 
gÂ
)

19540 
∆80211_mlme_evít
 
evít
 = {

19541 .
cmd
 = 
NL80211_CMD_AUTHENTICATE
,

19542 .
buf
 = buf,

19543 .
buf_Àn
 = 
Àn
,

19544 .
u≠sd_queues
 = -1,

19547 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_AUTHENTICATE] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

19549 
	`∆80211_£nd_mlme_evít
(
rdev
, 
√tdev
, &
evít
, 
gÂ
);

19550 
	}
}

19552 
	$∆80211_£nd_rx_assoc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19553 
√t_devi˚
 *
√tdev
,

19554 c⁄° 
cfg80211_rx_assoc_ª•_d©a
 *
d©a
)

19556 
∆80211_mlme_evít
 
evít
 = {

19557 .
cmd
 = 
NL80211_CMD_ASSOCIATE
,

19558 .
buf
 = 
d©a
->buf,

19559 .
buf_Àn
 = 
d©a
->
Àn
,

19560 .
u≠sd_queues
 = 
d©a
->uapsd_queues,

19561 .
ªq_õs
 = 
d©a
->req_ies,

19562 .
ªq_õs_Àn
 = 
d©a
->req_ies_len,

19565 
	`¥_öfo
("[MODULE -> %s], [THREAD -> %s] [NL80211_CMD_ASSOCIATE] [%s] [%d] [ENTRY]\n", 
THIS_MODULE
->
«me
, 
	`gë_thªad_«me
(), 
__func__
, 
__LINE__
);

19567 
	`∆80211_£nd_mlme_evít
(
rdev
, 
√tdev
, &
evít
, 
GFP_KERNEL
);

19568 
	}
}

19570 
	$∆80211_£nd_dóuth
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19571 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
buf
,

19572 
size_t
 
Àn
, 
boﬁ
 
ªc⁄√˘
, 
gÂ_t
 
gÂ
)

19574 
∆80211_mlme_evít
 
evít
 = {

19575 .
cmd
 = 
NL80211_CMD_DEAUTHENTICATE
,

19576 .
buf
 = buf,

19577 .
buf_Àn
 = 
Àn
,

19578 .
ªc⁄√˘
 =Ñeconnect,

19579 .
u≠sd_queues
 = -1,

19582 
	`∆80211_£nd_mlme_evít
(
rdev
, 
√tdev
, &
evít
, 
gÂ
);

19583 
	}
}

19585 
	$∆80211_£nd_dißssoc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19586 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
buf
,

19587 
size_t
 
Àn
, 
boﬁ
 
ªc⁄√˘
, 
gÂ_t
 
gÂ
)

19589 
∆80211_mlme_evít
 
evít
 = {

19590 .
cmd
 = 
NL80211_CMD_DISASSOCIATE
,

19591 .
buf
 = buf,

19592 .
buf_Àn
 = 
Àn
,

19593 .
ªc⁄√˘
 =Ñeconnect,

19594 .
u≠sd_queues
 = -1,

19597 
	`∆80211_£nd_mlme_evít
(
rdev
, 
√tdev
, &
evít
, 
gÂ
);

19598 
	}
}

19600 
	$cfg80211_rx_u≈rŸ_mlme_mgmt
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
buf
,

19601 
size_t
 
Àn
)

19603 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

19604 
wùhy
 *wùhy = 
wdev
->wiphy;

19605 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

19606 c⁄° 
õì80211_mgmt
 *
mgmt
 = (*)
buf
;

19607 
∆80211_mlme_evít
 
evít
 = {

19608 .
buf
 = buf,

19609 .
buf_Àn
 = 
Àn
,

19610 .
u≠sd_queues
 = -1,

19613 i‡(
	`WARN_ON
(
Àn
 < 2))

19616 i‡(
	`õì80211_is_dóuth
(
mgmt
->
‰ame_c⁄åﬁ
)) {

19617 
evít
.
cmd
 = 
NL80211_CMD_UNPROT_DEAUTHENTICATE
;

19618 } i‡(
	`õì80211_is_dißssoc
(
mgmt
->
‰ame_c⁄åﬁ
)) {

19619 
evít
.
cmd
 = 
NL80211_CMD_UNPROT_DISASSOCIATE
;

19620 } i‡(
	`õì80211_is_bóc⁄
(
mgmt
->
‰ame_c⁄åﬁ
)) {

19621 i‡(
wdev
->
u≈rŸ_bóc⁄_ªp‹ãd
 &&

19622 
	`ñ≠£d_jiffõs_m£cs
(
wdev
->
u≈rŸ_bóc⁄_ªp‹ãd
) < 10000)

19624 
evít
.
cmd
 = 
NL80211_CMD_UNPROT_BEACON
;

19625 
wdev
->
u≈rŸ_bóc⁄_ªp‹ãd
 = 
jiffõs
;

19630 
	`åa˚_cfg80211_rx_u≈rŸ_mlme_mgmt
(
dev
, 
buf
, 
Àn
);

19631 
	`∆80211_£nd_mlme_evít
(
rdev
, 
dev
, &
evít
, 
GFP_ATOMIC
);

19632 
	}
}

19633 
EXPORT_SYMBOL
(
cfg80211_rx_u≈rŸ_mlme_mgmt
);

19635 
	$∆80211_£nd_mlme_timeout
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19636 
√t_devi˚
 *
√tdev
, 
cmd
,

19637 c⁄° 
u8
 *
addr
, 
gÂ_t
 
gÂ
)

19639 
sk_buff
 *
msg
;

19640 *
hdr
;

19642 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

19643 i‡(!
msg
)

19646 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
cmd
);

19647 i‡(!
hdr
) {

19648 
	`∆msg_‰ì
(
msg
);

19652 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

19653 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

19654 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_TIMED_OUT
) ||

19655 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
addr
))

19656 
∆a_put_Áûuª
;

19658 
	`gílmsg_íd
(
msg
, 
hdr
);

19660 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

19661 
NL80211_MCGRP_MLME
, 
gÂ
);

19664 
∆a_put_Áûuª
:

19665 
	`∆msg_‰ì
(
msg
);

19666 
	}
}

19668 
	$∆80211_£nd_auth_timeout
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19669 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
addr
,

19670 
gÂ_t
 
gÂ
)

19672 
	`∆80211_£nd_mlme_timeout
(
rdev
, 
√tdev
, 
NL80211_CMD_AUTHENTICATE
,

19673 
addr
, 
gÂ
);

19674 
	}
}

19676 
	$∆80211_£nd_assoc_timeout
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19677 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
addr
,

19678 
gÂ_t
 
gÂ
)

19680 
	`∆80211_£nd_mlme_timeout
(
rdev
, 
√tdev
, 
NL80211_CMD_ASSOCIATE
,

19681 
addr
, 
gÂ
);

19682 
	}
}

19684 
	$∆80211_£nd_c⁄√˘_ªsu…
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19685 
√t_devi˚
 *
√tdev
,

19686 
cfg80211_c⁄√˘_ª•_∑øms
 *
¸
,

19687 
gÂ_t
 
gÂ
)

19689 
sk_buff
 *
msg
;

19690 *
hdr
;

19691 
lök
;

19692 
size_t
 
lök_öfo_size
 = 0;

19693 c⁄° 
u8
 *
c⁄√˘ed_addr
 = 
¸
->
vÆid_löks
 ?

19694 
¸
->
≠_mld_addr
 : cr->
löks
[0].
bssid
;

19696 i‡(
¸
->
vÆid_löks
) {

19697 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
) {

19699 
lök_öfo_size
 +
NLA_HDRLEN
;

19701 
lök_öfo_size
 +
	`∆a_tŸÆ_size
((
u8
));

19702 
lök_öfo_size
 +
¸
->
löks
[
lök
].
addr
 ?

19703 
	`∆a_tŸÆ_size
(
ETH_ALEN
) : 0;

19704 
lök_öfo_size
 +(
¸
->
löks
[
lök
].
bssid
 ||

19705 
¸
->
löks
[
lök
].
bss
) ?

19706 
	`∆a_tŸÆ_size
(
ETH_ALEN
) : 0;

19707 
lök_öfo_size
 +
	`∆a_tŸÆ_size
((
u16
));

19711 
msg
 = 
	`∆msg_√w
(100 + 
¸
->
ªq_õ_Àn
 + cr->
ª•_õ_Àn
 +

19712 
¸
->
fûs
.
kek_Àn
 + cr->fûs.
pmk_Àn
 +

19713 (
¸
->
fûs
.
pmkid
 ? 
WLAN_PMKID_LEN
 : 0Ë+ 
lök_öfo_size
,

19714 
gÂ
);

19715 i‡(!
msg
)

19718 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_CONNECT
);

19719 i‡(!
hdr
) {

19720 
	`∆msg_‰ì
(
msg
);

19724 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

19725 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

19726 (
c⁄√˘ed_addr
 &&

19727 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
c⁄√˘ed_addr
)) ||

19728 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_STATUS_CODE
,

19729 
¸
->
°©us
 < 0 ? 
WLAN_STATUS_UNSPECIFIED_FAILURE
 :

19730 
¸
->
°©us
) ||

19731 (
¸
->
°©us
 < 0 &&

19732 (
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_TIMED_OUT
) ||

19733 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_TIMEOUT_REASON
,

19734 
¸
->
timeout_ªas⁄
))) ||

19735 (
¸
->
ªq_õ
 &&

19736 
	`∆a_put
(
msg
, 
NL80211_ATTR_REQ_IE
, 
¸
->
ªq_õ_Àn
, cr->
ªq_õ
)) ||

19737 (
¸
->
ª•_õ
 &&

19738 
	`∆a_put
(
msg
, 
NL80211_ATTR_RESP_IE
, 
¸
->
ª•_õ_Àn
,

19739 
¸
->
ª•_õ
)) ||

19740 (
¸
->
fûs
.
upd©e_îp_√xt_£q_num
 &&

19741 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
,

19742 
¸
->
fûs
.
îp_√xt_£q_num
)) ||

19743 (
¸
->
°©us
 =
WLAN_STATUS_SUCCESS
 &&

19744 ((
¸
->
fûs
.
kek
 &&

19745 
	`∆a_put
(
msg
, 
NL80211_ATTR_FILS_KEK
, 
¸
->
fûs
.
kek_Àn
,

19746 
¸
->
fûs
.
kek
)) ||

19747 (
¸
->
fûs
.
pmk
 &&

19748 
	`∆a_put
(
msg
, 
NL80211_ATTR_PMK
, 
¸
->
fûs
.
pmk_Àn
, cr->fûs.
pmk
)) ||

19749 (
¸
->
fûs
.
pmkid
 &&

19750 
	`∆a_put
(
msg
, 
NL80211_ATTR_PMKID
, 
WLAN_PMKID_LEN
, 
¸
->
fûs
.
pmkid
)))))

19751 
∆a_put_Áûuª
;

19753 i‡(
¸
->
vÆid_löks
) {

19754 
i
 = 1;

19755 
∆©å
 *
√°ed
;

19757 
√°ed
 = 
	`∆a_√°_°¨t
(
msg
, 
NL80211_ATTR_MLO_LINKS
);

19758 i‡(!
√°ed
)

19759 
∆a_put_Áûuª
;

19761 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
) {

19762 
∆©å
 *
√°ed_mlo_löks
;

19763 c⁄° 
u8
 *
bssid
 = 
¸
->
löks
[
lök
].
bss
 ?

19764 
¸
->
löks
[
lök
].
bss
->
bssid
 :

19765 
¸
->
löks
[
lök
].
bssid
;

19767 
√°ed_mlo_löks
 = 
	`∆a_√°_°¨t
(
msg
, 
i
);

19768 i‡(!
√°ed_mlo_löks
)

19769 
∆a_put_Áûuª
;

19771 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MLO_LINK_ID
, 
lök
) ||

19772 (
bssid
 &&

19773 
	`∆a_put
(
msg
, 
NL80211_ATTR_BSSID
, 
ETH_ALEN
, 
bssid
)) ||

19774 (
¸
->
löks
[
lök
].
addr
 &&

19775 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
,

19776 
¸
->
löks
[
lök
].
addr
)) ||

19777 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_STATUS_CODE
,

19778 
¸
->
löks
[
lök
].
°©us
))

19779 
∆a_put_Áûuª
;

19781 
	`∆a_√°_íd
(
msg
, 
√°ed_mlo_löks
);

19782 
i
++;

19784 
	`∆a_√°_íd
(
msg
, 
√°ed
);

19787 
	`gílmsg_íd
(
msg
, 
hdr
);

19789 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

19790 
NL80211_MCGRP_MLME
, 
gÂ
);

19793 
∆a_put_Áûuª
:

19794 
	`∆msg_‰ì
(
msg
);

19795 
	}
}

19797 
	$∆80211_£nd_rﬂmed
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19798 
√t_devi˚
 *
√tdev
,

19799 
cfg80211_rﬂm_öfo
 *
öfo
, 
gÂ_t
 
gÂ
)

19801 
sk_buff
 *
msg
;

19802 *
hdr
;

19803 
size_t
 
lök_öfo_size
 = 0;

19804 
lök
;

19805 c⁄° 
u8
 *
c⁄√˘ed_addr
 = 
öfo
->
≠_mld_addr
 ?

19806 
öfo
->
≠_mld_addr
 :

19807 (
öfo
->
löks
[0].
bss
 ?

19808 
öfo
->
löks
[0].
bss
->
bssid
 :

19809 
öfo
->
löks
[0].
bssid
);

19811 i‡(
öfo
->
vÆid_löks
) {

19812 
	`f‹_óch_vÆid_lök
(
öfo
, 
lök
) {

19814 
lök_öfo_size
 +
NLA_HDRLEN
;

19816 
lök_öfo_size
 +
	`∆a_tŸÆ_size
((
u8
));

19817 
lök_öfo_size
 +
öfo
->
löks
[
lök
].
addr
 ?

19818 
	`∆a_tŸÆ_size
(
ETH_ALEN
) : 0;

19819 
lök_öfo_size
 +(
öfo
->
löks
[
lök
].
bssid
 ||

19820 
öfo
->
löks
[
lök
].
bss
) ?

19821 
	`∆a_tŸÆ_size
(
ETH_ALEN
) : 0;

19825 
msg
 = 
	`∆msg_√w
(100 + 
öfo
->
ªq_õ_Àn
 + info->
ª•_õ_Àn
 +

19826 
öfo
->
fûs
.
kek_Àn
 + info->fûs.
pmk_Àn
 +

19827 (
öfo
->
fûs
.
pmkid
 ? 
WLAN_PMKID_LEN
 : 0) +

19828 
lök_öfo_size
, 
gÂ
);

19829 i‡(!
msg
)

19832 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_ROAM
);

19833 i‡(!
hdr
) {

19834 
	`∆msg_‰ì
(
msg
);

19838 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

19839 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

19840 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
c⁄√˘ed_addr
) ||

19841 (
öfo
->
ªq_õ
 &&

19842 
	`∆a_put
(
msg
, 
NL80211_ATTR_REQ_IE
, 
öfo
->
ªq_õ_Àn
,

19843 
öfo
->
ªq_õ
)) ||

19844 (
öfo
->
ª•_õ
 &&

19845 
	`∆a_put
(
msg
, 
NL80211_ATTR_RESP_IE
, 
öfo
->
ª•_õ_Àn
,

19846 
öfo
->
ª•_õ
)) ||

19847 (
öfo
->
fûs
.
upd©e_îp_√xt_£q_num
 &&

19848 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
,

19849 
öfo
->
fûs
.
îp_√xt_£q_num
)) ||

19850 (
öfo
->
fûs
.
kek
 &&

19851 
	`∆a_put
(
msg
, 
NL80211_ATTR_FILS_KEK
, 
öfo
->
fûs
.
kek_Àn
,

19852 
öfo
->
fûs
.
kek
)) ||

19853 (
öfo
->
fûs
.
pmk
 &&

19854 
	`∆a_put
(
msg
, 
NL80211_ATTR_PMK
, 
öfo
->
fûs
.
pmk_Àn
, info->fûs.
pmk
)) ||

19855 (
öfo
->
fûs
.
pmkid
 &&

19856 
	`∆a_put
(
msg
, 
NL80211_ATTR_PMKID
, 
WLAN_PMKID_LEN
, 
öfo
->
fûs
.
pmkid
)))

19857 
∆a_put_Áûuª
;

19859 i‡(
öfo
->
vÆid_löks
) {

19860 
i
 = 1;

19861 
∆©å
 *
√°ed
;

19863 
√°ed
 = 
	`∆a_√°_°¨t
(
msg
, 
NL80211_ATTR_MLO_LINKS
);

19864 i‡(!
√°ed
)

19865 
∆a_put_Áûuª
;

19867 
	`f‹_óch_vÆid_lök
(
öfo
, 
lök
) {

19868 
∆©å
 *
√°ed_mlo_löks
;

19869 c⁄° 
u8
 *
bssid
 = 
öfo
->
löks
[
lök
].
bss
 ?

19870 
öfo
->
löks
[
lök
].
bss
->
bssid
 :

19871 
öfo
->
löks
[
lök
].
bssid
;

19873 
√°ed_mlo_löks
 = 
	`∆a_√°_°¨t
(
msg
, 
i
);

19874 i‡(!
√°ed_mlo_löks
)

19875 
∆a_put_Áûuª
;

19877 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MLO_LINK_ID
, 
lök
) ||

19878 (
bssid
 &&

19879 
	`∆a_put
(
msg
, 
NL80211_ATTR_BSSID
, 
ETH_ALEN
, 
bssid
)) ||

19880 (
öfo
->
löks
[
lök
].
addr
 &&

19881 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
,

19882 
öfo
->
löks
[
lök
].
addr
)))

19883 
∆a_put_Áûuª
;

19885 
	`∆a_√°_íd
(
msg
, 
√°ed_mlo_löks
);

19886 
i
++;

19888 
	`∆a_√°_íd
(
msg
, 
√°ed
);

19891 
	`gílmsg_íd
(
msg
, 
hdr
);

19893 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

19894 
NL80211_MCGRP_MLME
, 
gÂ
);

19897 
∆a_put_Áûuª
:

19898 
	`∆msg_‰ì
(
msg
);

19899 
	}
}

19901 
	$∆80211_£nd_p‹t_auth‹ized
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19902 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
≥î_addr
,

19903 c⁄° 
u8
 *
td_bôm≠
, u8 
td_bôm≠_Àn
)

19905 
sk_buff
 *
msg
;

19906 *
hdr
;

19908 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

19909 i‡(!
msg
)

19912 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_PORT_AUTHORIZED
);

19913 i‡(!
hdr
) {

19914 
	`∆msg_‰ì
(
msg
);

19918 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

19919 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

19920 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
≥î_addr
))

19921 
∆a_put_Áûuª
;

19923 i‡((
td_bôm≠_Àn
 > 0Ë&& 
td_bôm≠
)

19924 i‡(
	`∆a_put
(
msg
, 
NL80211_ATTR_TD_BITMAP
,

19925 
td_bôm≠_Àn
, 
td_bôm≠
))

19926 
∆a_put_Áûuª
;

19928 
	`gílmsg_íd
(
msg
, 
hdr
);

19930 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

19931 
NL80211_MCGRP_MLME
, 
GFP_KERNEL
);

19934 
∆a_put_Áûuª
:

19935 
	`∆msg_‰ì
(
msg
);

19936 
	}
}

19938 
	$∆80211_£nd_disc⁄√˘ed
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19939 
√t_devi˚
 *
√tdev
, 
u16
 
ªas⁄
,

19940 c⁄° 
u8
 *
õ
, 
size_t
 
õ_Àn
, 
boﬁ
 
‰om_≠
)

19942 
sk_buff
 *
msg
;

19943 *
hdr
;

19945 
msg
 = 
	`∆msg_√w
(100 + 
õ_Àn
, 
GFP_KERNEL
);

19946 i‡(!
msg
)

19949 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_DISCONNECT
);

19950 i‡(!
hdr
) {

19951 
	`∆msg_‰ì
(
msg
);

19955 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

19956 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

19957 (
ªas⁄
 &&

19958 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_REASON_CODE
, 
ªas⁄
)) ||

19959 (
‰om_≠
 &&

19960 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_DISCONNECTED_BY_AP
)) ||

19961 (
õ
 && 
	`∆a_put
(
msg
, 
NL80211_ATTR_IE
, 
õ_Àn
, ie)))

19962 
∆a_put_Áûuª
;

19964 
	`gílmsg_íd
(
msg
, 
hdr
);

19966 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

19967 
NL80211_MCGRP_MLME
, 
GFP_KERNEL
);

19970 
∆a_put_Áûuª
:

19971 
	`∆msg_‰ì
(
msg
);

19972 
	}
}

19974 
	$cfg80211_löks_ªmoved
(
√t_devi˚
 *
dev
, 
u16
 
lök_mask
)

19976 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

19977 
wùhy
 *wùhy = 
wdev
->wiphy;

19978 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

19979 
sk_buff
 *
msg
;

19980 
∆©å
 *
löks
;

19981 *
hdr
;

19983 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

19984 
	`åa˚_cfg80211_löks_ªmoved
(
dev
, 
lök_mask
);

19986 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

19987 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
))

19990 i‡(
	`WARN_ON
(!
wdev
->
vÆid_löks
 || !
lök_mask
 ||

19991 (
wdev
->
vÆid_löks
 & 
lök_mask
) !=Üink_mask ||

19992 
wdev
->
vÆid_löks
 =
lök_mask
))

19995 
	`cfg80211_wdev_ªÀa£_lök_bs£s
(
wdev
, 
lök_mask
);

19996 
wdev
->
vÆid_löks
 &~
lök_mask
;

19998 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

19999 i‡(!
msg
)

20002 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_LINKS_REMOVED
);

20003 i‡(!
hdr
) {

20004 
	`∆msg_‰ì
(
msg
);

20008 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20009 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
))

20010 
∆a_put_Áûuª
;

20012 
löks
 = 
	`∆a_√°_°¨t
(
msg
, 
NL80211_ATTR_MLO_LINKS
);

20013 i‡(!
löks
)

20014 
∆a_put_Áûuª
;

20016 
lök_mask
) {

20017 
∆©å
 *
lök
;

20018 
lök_id
 = 
	`__ffs
(
lök_mask
);

20020 
lök
 = 
	`∆a_√°_°¨t
(
msg
, 
lök_id
 + 1);

20021 i‡(!
lök
)

20022 
∆a_put_Áûuª
;

20024 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MLO_LINK_ID
, 
lök_id
))

20025 
∆a_put_Áûuª
;

20027 
	`∆a_√°_íd
(
msg
, 
lök
);

20028 
lök_mask
 &~(1 << 
lök_id
);

20031 
	`∆a_√°_íd
(
msg
, 
löks
);

20033 
	`gílmsg_íd
(
msg
, 
hdr
);

20035 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20036 
NL80211_MCGRP_MLME
, 
GFP_KERNEL
);

20039 
∆a_put_Áûuª
:

20040 
	`∆msg_‰ì
(
msg
);

20041 
	}
}

20042 
EXPORT_SYMBOL
(
cfg80211_löks_ªmoved
);

20044 
	$∆80211_£nd_ibss_bssid
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

20045 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
bssid
,

20046 
gÂ_t
 
gÂ
)

20048 
sk_buff
 *
msg
;

20049 *
hdr
;

20051 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

20052 i‡(!
msg
)

20055 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_JOIN_IBSS
);

20056 i‡(!
hdr
) {

20057 
	`∆msg_‰ì
(
msg
);

20061 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20062 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

20063 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
bssid
))

20064 
∆a_put_Áûuª
;

20066 
	`gílmsg_íd
(
msg
, 
hdr
);

20068 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20069 
NL80211_MCGRP_MLME
, 
gÂ
);

20072 
∆a_put_Áûuª
:

20073 
	`∆msg_‰ì
(
msg
);

20074 
	}
}

20076 
	$cfg80211_nŸify_√w_≥î_ˇndid©e
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
addr
,

20077 c⁄° 
u8
 *
õ
, u8 
õ_Àn
,

20078 
sig_dbm
, 
gÂ_t
 
gÂ
)

20080 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

20081 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

20082 
sk_buff
 *
msg
;

20083 *
hdr
;

20085 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
))

20088 
	`åa˚_cfg80211_nŸify_√w_≥î_ˇndid©e
(
dev
, 
addr
);

20090 
msg
 = 
	`∆msg_√w
(100 + 
õ_Àn
, 
gÂ
);

20091 i‡(!
msg
)

20094 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_NEW_PEER_CANDIDATE
);

20095 i‡(!
hdr
) {

20096 
	`∆msg_‰ì
(
msg
);

20100 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20101 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

20102 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
addr
) ||

20103 (
õ_Àn
 && 
õ
 &&

20104 
	`∆a_put
(
msg
, 
NL80211_ATTR_IE
, 
õ_Àn
, 
õ
)) ||

20105 (
sig_dbm
 &&

20106 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_RX_SIGNAL_DBM
, 
sig_dbm
)))

20107 
∆a_put_Áûuª
;

20109 
	`gílmsg_íd
(
msg
, 
hdr
);

20111 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20112 
NL80211_MCGRP_MLME
, 
gÂ
);

20115 
∆a_put_Áûuª
:

20116 
	`∆msg_‰ì
(
msg
);

20117 
	}
}

20118 
EXPORT_SYMBOL
(
cfg80211_nŸify_√w_≥î_ˇndid©e
);

20120 
	$∆80211_mich´l_mic_Áûuª
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

20121 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
addr
,

20122 
∆80211_key_ty≥
 
key_ty≥
, 
key_id
,

20123 c⁄° 
u8
 *
tsc
, 
gÂ_t
 
gÂ
)

20125 
sk_buff
 *
msg
;

20126 *
hdr
;

20128 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

20129 i‡(!
msg
)

20132 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_MICHAEL_MIC_FAILURE
);

20133 i‡(!
hdr
) {

20134 
	`∆msg_‰ì
(
msg
);

20138 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20139 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

20140 (
addr
 && 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
,áddr)) ||

20141 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_KEY_TYPE
, 
key_ty≥
) ||

20142 (
key_id
 != -1 &&

20143 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_KEY_IDX
, 
key_id
)) ||

20144 (
tsc
 && 
	`∆a_put
(
msg
, 
NL80211_ATTR_KEY_SEQ
, 6,Åsc)))

20145 
∆a_put_Áûuª
;

20147 
	`gílmsg_íd
(
msg
, 
hdr
);

20149 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20150 
NL80211_MCGRP_MLME
, 
gÂ
);

20153 
∆a_put_Áûuª
:

20154 
	`∆msg_‰ì
(
msg
);

20155 
	}
}

20157 
	$∆80211_£nd_bóc⁄_höt_evít
(
wùhy
 *wiphy,

20158 
õì80211_ch™√l
 *
ch™√l_bef‹e
,

20159 
õì80211_ch™√l
 *
ch™√l_a·î
)

20161 
sk_buff
 *
msg
;

20162 *
hdr
;

20163 
∆©å
 *
∆_‰eq
;

20165 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_ATOMIC
);

20166 i‡(!
msg
)

20169 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_REG_BEACON_HINT
);

20170 i‡(!
hdr
) {

20171 
	`∆msg_‰ì
(
msg
);

20179 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
	`gë_wùhy_idx
(
wùhy
)))

20180 
∆a_put_Áûuª
;

20183 
∆_‰eq
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_FREQ_BEFORE
);

20184 i‡(!
∆_‰eq
)

20185 
∆a_put_Áûuª
;

20187 i‡(
	`∆80211_msg_put_ch™√l
(
msg
, 
wùhy
, 
ch™√l_bef‹e
, 
Ál£
))

20188 
∆a_put_Áûuª
;

20189 
	`∆a_√°_íd
(
msg
, 
∆_‰eq
);

20192 
∆_‰eq
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_FREQ_AFTER
);

20193 i‡(!
∆_‰eq
)

20194 
∆a_put_Áûuª
;

20196 i‡(
	`∆80211_msg_put_ch™√l
(
msg
, 
wùhy
, 
ch™√l_a·î
, 
Ál£
))

20197 
∆a_put_Áûuª
;

20198 
	`∆a_√°_íd
(
msg
, 
∆_‰eq
);

20200 
	`gílmsg_íd
(
msg
, 
hdr
);

20202 
	`rcu_ªad_lock
();

20203 
	`gílmsg_mu…iˇ°_Æ s
(&
∆80211_Ám
, 
msg
, 0,

20204 
NL80211_MCGRP_REGULATORY
, 
GFP_ATOMIC
);

20205 
	`rcu_ªad_u∆ock
();

20209 
∆a_put_Áûuª
:

20210 
	`∆msg_‰ì
(
msg
);

20211 
	}
}

20213 
	$∆80211_£nd_ªmaö_⁄_ch™_evít
(

20214 
cmd
, 
cfg80211_ªgi°îed_devi˚
 *
rdev
,

20215 
wúñess_dev
 *
wdev
, 
u64
 
cookõ
,

20216 
õì80211_ch™√l
 *
ch™
,

20217 
duøti⁄
, 
gÂ_t
 
gÂ
)

20219 
sk_buff
 *
msg
;

20220 *
hdr
;

20222 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

20223 i‡(!
msg
)

20226 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
cmd
);

20227 i‡(!
hdr
) {

20228 
	`∆msg_‰ì
(
msg
);

20232 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20233 (
wdev
->
√tdev
 && 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
,

20234 
wdev
->
√tdev
->
ifödex
)) ||

20235 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

20236 
NL80211_ATTR_PAD
) ||

20237 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_FREQ
, 
ch™
->
˚¡î_‰eq
) ||

20238 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_CHANNEL_TYPE
,

20239 
NL80211_CHAN_NO_HT
) ||

20240 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
cookõ
,

20241 
NL80211_ATTR_PAD
))

20242 
∆a_put_Áûuª
;

20244 i‡(
cmd
 =
NL80211_CMD_REMAIN_ON_CHANNEL
 &&

20245 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_DURATION
, 
duøti⁄
))

20246 
∆a_put_Áûuª
;

20248 
	`gílmsg_íd
(
msg
, 
hdr
);

20250 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20251 
NL80211_MCGRP_MLME
, 
gÂ
);

20254 
∆a_put_Áûuª
:

20255 
	`∆msg_‰ì
(
msg
);

20256 
	}
}

20258 
	$cfg80211_assoc_comeback
(
√t_devi˚
 *
√tdev
,

20259 c⁄° 
u8
 *
≠_addr
, 
u32
 
timeout
)

20261 
wúñess_dev
 *
wdev
 = 
√tdev
->
õì80211_±r
;

20262 
wùhy
 *wùhy = 
wdev
->wiphy;

20263 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

20264 
sk_buff
 *
msg
;

20265 *
hdr
;

20267 
	`åa˚_cfg80211_assoc_comeback
(
wdev
, 
≠_addr
, 
timeout
);

20269 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

20270 i‡(!
msg
)

20273 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_ASSOC_COMEBACK
);

20274 i‡(!
hdr
) {

20275 
	`∆msg_‰ì
(
msg
);

20279 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20280 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

20281 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
≠_addr
) ||

20282 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_TIMEOUT
, 
timeout
))

20283 
∆a_put_Áûuª
;

20285 
	`gílmsg_íd
(
msg
, 
hdr
);

20287 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20288 
NL80211_MCGRP_MLME
, 
GFP_KERNEL
);

20291 
∆a_put_Áûuª
:

20292 
	`∆msg_‰ì
(
msg
);

20293 
	}
}

20294 
EXPORT_SYMBOL
(
cfg80211_assoc_comeback
);

20296 
	$cfg80211_ªady_⁄_ch™√l
(
wúñess_dev
 *
wdev
, 
u64
 
cookõ
,

20297 
õì80211_ch™√l
 *
ch™
,

20298 
duøti⁄
, 
gÂ_t
 
gÂ
)

20300 
wùhy
 *wùhy = 
wdev
->wiphy;

20301 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

20303 
	`åa˚_cfg80211_ªady_⁄_ch™√l
(
wdev
, 
cookõ
, 
ch™
, 
duøti⁄
);

20304 
	`∆80211_£nd_ªmaö_⁄_ch™_evít
(
NL80211_CMD_REMAIN_ON_CHANNEL
,

20305 
rdev
, 
wdev
, 
cookõ
, 
ch™
,

20306 
duøti⁄
, 
gÂ
);

20307 
	}
}

20308 
EXPORT_SYMBOL
(
cfg80211_ªady_⁄_ch™√l
);

20310 
	$cfg80211_ªmaö_⁄_ch™√l_expúed
(
wúñess_dev
 *
wdev
, 
u64
 
cookõ
,

20311 
õì80211_ch™√l
 *
ch™
,

20312 
gÂ_t
 
gÂ
)

20314 
wùhy
 *wùhy = 
wdev
->wiphy;

20315 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

20317 
	`åa˚_cfg80211_ªady_⁄_ch™√l_expúed
(
wdev
, 
cookõ
, 
ch™
);

20318 
	`∆80211_£nd_ªmaö_⁄_ch™_evít
(
NL80211_CMD_CANCEL_REMAIN_ON_CHANNEL
,

20319 
rdev
, 
wdev
, 
cookõ
, 
ch™
, 0, 
gÂ
);

20320 
	}
}

20321 
EXPORT_SYMBOL
(
cfg80211_ªmaö_⁄_ch™√l_expúed
);

20323 
	$cfg80211_tx_mgmt_expúed
(
wúñess_dev
 *
wdev
, 
u64
 
cookõ
,

20324 
õì80211_ch™√l
 *
ch™
,

20325 
gÂ_t
 
gÂ
)

20327 
wùhy
 *wùhy = 
wdev
->wiphy;

20328 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

20330 
	`åa˚_cfg80211_tx_mgmt_expúed
(
wdev
, 
cookõ
, 
ch™
);

20331 
	`∆80211_£nd_ªmaö_⁄_ch™_evít
(
NL80211_CMD_FRAME_WAIT_CANCEL
,

20332 
rdev
, 
wdev
, 
cookõ
, 
ch™
, 0, 
gÂ
);

20333 
	}
}

20334 
EXPORT_SYMBOL
(
cfg80211_tx_mgmt_expúed
);

20336 
	$cfg80211_√w_°a
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
mac_addr
,

20337 
°©i⁄_öfo
 *
söfo
, 
gÂ_t
 
gÂ
)

20339 
wùhy
 *wùhy = 
dev
->
õì80211_±r
->wiphy;

20340 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

20341 
sk_buff
 *
msg
;

20343 
	`åa˚_cfg80211_√w_°a
(
dev
, 
mac_addr
, 
söfo
);

20345 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

20346 i‡(!
msg
)

20349 i‡(
	`∆80211_£nd_°©i⁄
(
msg
, 
NL80211_CMD_NEW_STATION
, 0, 0, 0,

20350 
rdev
, 
dev
, 
mac_addr
, 
söfo
) < 0) {

20351 
	`∆msg_‰ì
(
msg
);

20355 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20356 
NL80211_MCGRP_MLME
, 
gÂ
);

20357 
	}
}

20358 
EXPORT_SYMBOL
(
cfg80211_√w_°a
);

20360 
	$cfg80211_dñ_°a_söfo
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
mac_addr
,

20361 
°©i⁄_öfo
 *
söfo
, 
gÂ_t
 
gÂ
)

20363 
wùhy
 *wùhy = 
dev
->
õì80211_±r
->wiphy;

20364 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

20365 
sk_buff
 *
msg
;

20366 
°©i⁄_öfo
 
em±y_söfo
 = {};

20368 i‡(!
söfo
)

20369 
söfo
 = &
em±y_söfo
;

20371 
	`åa˚_cfg80211_dñ_°a
(
dev
, 
mac_addr
);

20373 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

20374 i‡(!
msg
) {

20375 
	`cfg80211_söfo_ªÀa£_c⁄ã¡
(
söfo
);

20379 i‡(
	`∆80211_£nd_°©i⁄
(
msg
, 
NL80211_CMD_DEL_STATION
, 0, 0, 0,

20380 
rdev
, 
dev
, 
mac_addr
, 
söfo
) < 0) {

20381 
	`∆msg_‰ì
(
msg
);

20385 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20386 
NL80211_MCGRP_MLME
, 
gÂ
);

20387 
	}
}

20388 
EXPORT_SYMBOL
(
cfg80211_dñ_°a_söfo
);

20390 
	$cfg80211_c⁄n_Áûed
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
mac_addr
,

20391 
∆80211_c⁄√˘_Áûed_ªas⁄
 
ªas⁄
,

20392 
gÂ_t
 
gÂ
)

20394 
wùhy
 *wùhy = 
dev
->
õì80211_±r
->wiphy;

20395 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

20396 
sk_buff
 *
msg
;

20397 *
hdr
;

20399 
msg
 = 
	`∆msg_√w
(
NLMSG_GOODSIZE
, 
gÂ
);

20400 i‡(!
msg
)

20403 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_CONN_FAILED
);

20404 i‡(!
hdr
) {

20405 
	`∆msg_‰ì
(
msg
);

20409 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

20410 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
mac_addr
) ||

20411 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_CONN_FAILED_REASON
, 
ªas⁄
))

20412 
∆a_put_Áûuª
;

20414 
	`gílmsg_íd
(
msg
, 
hdr
);

20416 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20417 
NL80211_MCGRP_MLME
, 
gÂ
);

20420 
∆a_put_Áûuª
:

20421 
	`∆msg_‰ì
(
msg
);

20422 
	}
}

20423 
EXPORT_SYMBOL
(
cfg80211_c⁄n_Áûed
);

20425 
boﬁ
 
	$__∆80211_u√x≥˘ed_‰ame
(
√t_devi˚
 *
dev
, 
u8
 
cmd
,

20426 c⁄° 
u8
 *
addr
, 
gÂ_t
 
gÂ
)

20428 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

20429 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

20430 
sk_buff
 *
msg
;

20431 *
hdr
;

20432 
u32
 
∆p‹tid
 = 
	`READ_ONCE
(
wdev
->
≠_u√x≥˘ed_∆p‹tid
);

20434 i‡(!
∆p‹tid
)

20435  
Ál£
;

20437 
msg
 = 
	`∆msg_√w
(100, 
gÂ
);

20438 i‡(!
msg
)

20439  
åue
;

20441 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
cmd
);

20442 i‡(!
hdr
) {

20443 
	`∆msg_‰ì
(
msg
);

20444  
åue
;

20447 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20448 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

20449 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
addr
))

20450 
∆a_put_Áûuª
;

20452 
	`gílmsg_íd
(
msg
, 
hdr
);

20453 
	`gílmsg_uniˇ°
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 
∆p‹tid
);

20454  
åue
;

20456 
∆a_put_Áûuª
:

20457 
	`∆msg_‰ì
(
msg
);

20458  
åue
;

20459 
	}
}

20461 
boﬁ
 
	$cfg80211_rx_•urious_‰ame
(
√t_devi˚
 *
dev
,

20462 c⁄° 
u8
 *
addr
, 
gÂ_t
 
gÂ
)

20464 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

20465 
boﬁ
 
ªt
;

20467 
	`åa˚_cfg80211_rx_•urious_‰ame
(
dev
, 
addr
);

20469 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

20470 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
)) {

20471 
	`åa˚_cfg80211_ªtu∫_boﬁ
(
Ál£
);

20472  
Ál£
;

20474 
ªt
 = 
	`__∆80211_u√x≥˘ed_‰ame
(
dev
, 
NL80211_CMD_UNEXPECTED_FRAME
,

20475 
addr
, 
gÂ
);

20476 
	`åa˚_cfg80211_ªtu∫_boﬁ
(
ªt
);

20477  
ªt
;

20478 
	}
}

20479 
EXPORT_SYMBOL
(
cfg80211_rx_•urious_‰ame
);

20481 
boﬁ
 
	$cfg80211_rx_u√x≥˘ed_4addr_‰ame
(
√t_devi˚
 *
dev
,

20482 c⁄° 
u8
 *
addr
, 
gÂ_t
 
gÂ
)

20484 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

20485 
boﬁ
 
ªt
;

20487 
	`åa˚_cfg80211_rx_u√x≥˘ed_4addr_‰ame
(
dev
, 
addr
);

20489 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

20490 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
 &&

20491 
wdev
->
i·y≥
 !
NL80211_IFTYPE_AP_VLAN
)) {

20492 
	`åa˚_cfg80211_ªtu∫_boﬁ
(
Ál£
);

20493  
Ál£
;

20495 
ªt
 = 
	`__∆80211_u√x≥˘ed_‰ame
(
dev
,

20496 
NL80211_CMD_UNEXPECTED_4ADDR_FRAME
,

20497 
addr
, 
gÂ
);

20498 
	`åa˚_cfg80211_ªtu∫_boﬁ
(
ªt
);

20499  
ªt
;

20500 
	}
}

20501 
EXPORT_SYMBOL
(
cfg80211_rx_u√x≥˘ed_4addr_‰ame
);

20503 
	$∆80211_£nd_mgmt
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

20504 
wúñess_dev
 *
wdev
, 
u32
 
∆p‹tid
,

20505 
cfg80211_rx_öfo
 *
öfo
, 
gÂ_t
 
gÂ
)

20507 
√t_devi˚
 *
√tdev
 = 
wdev
->netdev;

20508 
sk_buff
 *
msg
;

20509 *
hdr
;

20511 
msg
 = 
	`∆msg_√w
(100 + 
öfo
->
Àn
, 
gÂ
);

20512 i‡(!
msg
)

20513  -
ENOMEM
;

20515 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_FRAME
);

20516 i‡(!
hdr
) {

20517 
	`∆msg_‰ì
(
msg
);

20518  -
ENOMEM
;

20521 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20522 (
√tdev
 && 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
,

20523 
√tdev
->
ifödex
)) ||

20524 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

20525 
NL80211_ATTR_PAD
) ||

20526 (
öfo
->
have_lök_id
 &&

20527 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MLO_LINK_ID
, 
öfo
->
lök_id
)) ||

20528 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_FREQ
, 
	`KHZ_TO_MHZ
(
öfo
->
‰eq
)) ||

20529 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_FREQ_OFFSET
, 
öfo
->
‰eq
 % 1000) ||

20530 (
öfo
->
sig_dbm
 &&

20531 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_RX_SIGNAL_DBM
, 
öfo
->
sig_dbm
)) ||

20532 
	`∆a_put
(
msg
, 
NL80211_ATTR_FRAME
, 
öfo
->
Àn
, info->
buf
) ||

20533 (
öfo
->
Êags
 &&

20534 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_RXMGMT_FLAGS
, 
öfo
->
Êags
)) ||

20535 (
öfo
->
rx_t°amp
 && 
	`∆a_put_u64_64bô
(
msg
,

20536 
NL80211_ATTR_RX_HW_TIMESTAMP
,

20537 
öfo
->
rx_t°amp
,

20538 
NL80211_ATTR_PAD
)) ||

20539 (
öfo
->
ack_t°amp
 && 
	`∆a_put_u64_64bô
(
msg
,

20540 
NL80211_ATTR_TX_HW_TIMESTAMP
,

20541 
öfo
->
ack_t°amp
,

20542 
NL80211_ATTR_PAD
)))

20543 
∆a_put_Áûuª
;

20545 
	`gílmsg_íd
(
msg
, 
hdr
);

20547  
	`gílmsg_uniˇ°
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 
∆p‹tid
);

20549 
∆a_put_Áûuª
:

20550 
	`∆msg_‰ì
(
msg
);

20551  -
ENOBUFS
;

20552 
	}
}

20554 
	$∆80211_‰ame_tx_°©us
(
wúñess_dev
 *
wdev
,

20555 
cfg80211_tx_°©us
 *
°©us
,

20556 
gÂ_t
 
gÂ
, 
∆80211_comm™ds
 
comm™d
)

20558 
wùhy
 *wùhy = 
wdev
->wiphy;

20559 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

20560 
√t_devi˚
 *
√tdev
 = 
wdev
->netdev;

20561 
sk_buff
 *
msg
;

20562 *
hdr
;

20564 i‡(
comm™d
 =
NL80211_CMD_FRAME_TX_STATUS
)

20565 
	`åa˚_cfg80211_mgmt_tx_°©us
(
wdev
, 
°©us
->
cookõ
,

20566 
°©us
->
ack
);

20568 
	`åa˚_cfg80211_c⁄åﬁ_p‹t_tx_°©us
(
wdev
, 
°©us
->
cookõ
,

20569 
°©us
->
ack
);

20571 
msg
 = 
	`∆msg_√w
(100 + 
°©us
->
Àn
, 
gÂ
);

20572 i‡(!
msg
)

20575 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
comm™d
);

20576 i‡(!
hdr
) {

20577 
	`∆msg_‰ì
(
msg
);

20581 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20582 (
√tdev
 && 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
,

20583 
√tdev
->
ifödex
)) ||

20584 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

20585 
NL80211_ATTR_PAD
) ||

20586 
	`∆a_put
(
msg
, 
NL80211_ATTR_FRAME
, 
°©us
->
Àn
, sètus->
buf
) ||

20587 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
°©us
->
cookõ
,

20588 
NL80211_ATTR_PAD
) ||

20589 (
°©us
->
ack
 && 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_ACK
)) ||

20590 (
°©us
->
tx_t°amp
 &&

20591 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_TX_HW_TIMESTAMP
,

20592 
°©us
->
tx_t°amp
, 
NL80211_ATTR_PAD
)) ||

20593 (
°©us
->
ack_t°amp
 &&

20594 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_RX_HW_TIMESTAMP
,

20595 
°©us
->
ack_t°amp
, 
NL80211_ATTR_PAD
)))

20596 
∆a_put_Áûuª
;

20598 
	`gílmsg_íd
(
msg
, 
hdr
);

20600 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20601 
NL80211_MCGRP_MLME
, 
gÂ
);

20604 
∆a_put_Áûuª
:

20605 
	`∆msg_‰ì
(
msg
);

20606 
	}
}

20608 
	$cfg80211_c⁄åﬁ_p‹t_tx_°©us
(
wúñess_dev
 *
wdev
, 
u64
 
cookõ
,

20609 c⁄° 
u8
 *
buf
, 
size_t
 
Àn
, 
boﬁ
 
ack
,

20610 
gÂ_t
 
gÂ
)

20612 
cfg80211_tx_°©us
 
°©us
 = {

20613 .
cookõ
 = cookie,

20614 .
buf
 = buf,

20615 .
Àn
 =Üen,

20616 .
ack
 =áck

20619 
	`∆80211_‰ame_tx_°©us
(
wdev
, &
°©us
, 
gÂ
,

20620 
NL80211_CMD_CONTROL_PORT_FRAME_TX_STATUS
);

20621 
	}
}

20622 
EXPORT_SYMBOL
(
cfg80211_c⁄åﬁ_p‹t_tx_°©us
);

20624 
	$cfg80211_mgmt_tx_°©us_ext
(
wúñess_dev
 *
wdev
,

20625 
cfg80211_tx_°©us
 *
°©us
, 
gÂ_t
 
gÂ
)

20627 
	`∆80211_‰ame_tx_°©us
(
wdev
, 
°©us
, 
gÂ
, 
NL80211_CMD_FRAME_TX_STATUS
);

20628 
	}
}

20629 
EXPORT_SYMBOL
(
cfg80211_mgmt_tx_°©us_ext
);

20631 
	$__∆80211_rx_c⁄åﬁ_p‹t
(
√t_devi˚
 *
dev
,

20632 
sk_buff
 *
skb
,

20633 
boﬁ
 
u√n¸y±ed
,

20634 
lök_id
,

20635 
gÂ_t
 
gÂ
)

20637 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

20638 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

20639 
ëhhdr
 *
ehdr
 = 
	`ëh_hdr
(
skb
);

20640 c⁄° 
u8
 *
addr
 = 
ehdr
->
h_sour˚
;

20641 
u16
 
¥Ÿo
 = 
	`be16_to_˝u
(
skb
->
¥Ÿocﬁ
);

20642 
sk_buff
 *
msg
;

20643 *
hdr
;

20644 
∆©å
 *
‰ame
;

20646 
u32
 
∆p‹tid
 = 
	`READ_ONCE
(
wdev
->
c⁄n_ow√r_∆p‹tid
);

20648 i‡(!
∆p‹tid
)

20649  -
ENOENT
;

20651 
msg
 = 
	`∆msg_√w
(100 + 
skb
->
Àn
, 
gÂ
);

20652 i‡(!
msg
)

20653  -
ENOMEM
;

20655 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_CONTROL_PORT_FRAME
);

20656 i‡(!
hdr
) {

20657 
	`∆msg_‰ì
(
msg
);

20658  -
ENOBUFS
;

20661 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20662 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

20663 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

20664 
NL80211_ATTR_PAD
) ||

20665 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
addr
) ||

20666 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_CONTROL_PORT_ETHERTYPE
, 
¥Ÿo
) ||

20667 (
lök_id
 >= 0 &&

20668 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MLO_LINK_ID
, 
lök_id
)) ||

20669 (
u√n¸y±ed
 && 
	`∆a_put_Êag
(
msg
,

20670 
NL80211_ATTR_CONTROL_PORT_NO_ENCRYPT
)))

20671 
∆a_put_Áûuª
;

20673 
‰ame
 = 
	`∆a_ª£rve
(
msg
, 
NL80211_ATTR_FRAME
, 
skb
->
Àn
);

20674 i‡(!
‰ame
)

20675 
∆a_put_Áûuª
;

20677 
	`skb_c›y_bôs
(
skb
, 0, 
	`∆a_d©a
(
‰ame
), skb->
Àn
);

20678 
	`gílmsg_íd
(
msg
, 
hdr
);

20680  
	`gílmsg_uniˇ°
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 
∆p‹tid
);

20682 
∆a_put_Áûuª
:

20683 
	`∆msg_‰ì
(
msg
);

20684  -
ENOBUFS
;

20685 
	}
}

20687 
boﬁ
 
	$cfg80211_rx_c⁄åﬁ_p‹t
(
√t_devi˚
 *
dev
, 
sk_buff
 *
skb
,

20688 
boﬁ
 
u√n¸y±ed
, 
lök_id
)

20690 
ªt
;

20692 
	`åa˚_cfg80211_rx_c⁄åﬁ_p‹t
(
dev
, 
skb
, 
u√n¸y±ed
, 
lök_id
);

20693 
ªt
 = 
	`__∆80211_rx_c⁄åﬁ_p‹t
(
dev
, 
skb
, 
u√n¸y±ed
, 
lök_id
,

20694 
GFP_ATOMIC
);

20695 
	`åa˚_cfg80211_ªtu∫_boﬁ
(
ªt
 == 0);

20696  
ªt
 == 0;

20697 
	}
}

20698 
EXPORT_SYMBOL
(
cfg80211_rx_c⁄åﬁ_p‹t
);

20700 
sk_buff
 *
	$cfg80211_¥ï¨e_cqm
(
√t_devi˚
 *
dev
,

20701 c⁄° *
mac
, 
gÂ_t
 
gÂ
)

20703 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

20704 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

20705 
sk_buff
 *
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

20706 **
cb
;

20708 i‡(!
msg
)

20709  
NULL
;

20711 
cb
 = (**)
msg
->cb;

20713 
cb
[0] = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_NOTIFY_CQM
);

20714 i‡(!
cb
[0]) {

20715 
	`∆msg_‰ì
(
msg
);

20716  
NULL
;

20719 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20720 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
))

20721 
∆a_put_Áûuª
;

20723 i‡(
mac
 && 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, mac))

20724 
∆a_put_Áûuª
;

20726 
cb
[1] = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_CQM
);

20727 i‡(!
cb
[1])

20728 
∆a_put_Áûuª
;

20730 
cb
[2] = 
rdev
;

20732  
msg
;

20733 
∆a_put_Áûuª
:

20734 
	`∆msg_‰ì
(
msg
);

20735  
NULL
;

20736 
	}
}

20738 
	$cfg80211_£nd_cqm
(
sk_buff
 *
msg
, 
gÂ_t
 
gÂ
)

20740 **
cb
 = (**)
msg
->cb;

20741 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
cb
[2];

20743 
	`∆a_√°_íd
(
msg
, 
cb
[1]);

20744 
	`gílmsg_íd
(
msg
, 
cb
[0]);

20746 
	`mem£t
(
msg
->
cb
, 0, (msg->cb));

20748 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20749 
NL80211_MCGRP_MLME
, 
gÂ
);

20750 
	}
}

20752 
	$cfg80211_cqm_rssi_nŸify
(
√t_devi˚
 *
dev
,

20753 
∆80211_cqm_rssi_thªshﬁd_evít
 
rssi_evít
,

20754 
s32
 
rssi_Àvñ
, 
gÂ_t
 
gÂ
)

20756 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

20757 
cfg80211_cqm_c⁄fig
 *
cqm_c⁄fig
;

20759 
	`åa˚_cfg80211_cqm_rssi_nŸify
(
dev
, 
rssi_evít
, 
rssi_Àvñ
);

20761 i‡(
	`WARN_ON
(
rssi_evít
 !
NL80211_CQM_RSSI_THRESHOLD_EVENT_LOW
 &&

20762 
rssi_evít
 !
NL80211_CQM_RSSI_THRESHOLD_EVENT_HIGH
))

20765 
	`rcu_ªad_lock
();

20766 
cqm_c⁄fig
 = 
	`rcu_dîe„ªn˚
(
wdev
->cqm_config);

20767 i‡(
cqm_c⁄fig
) {

20768 
cqm_c⁄fig
->
œ°_rssi_evít_vÆue
 = 
rssi_Àvñ
;

20769 
cqm_c⁄fig
->
œ°_rssi_evít_ty≥
 = 
rssi_evít
;

20770 
	`wùhy_w‹k_queue
(
wdev
->
wùhy
, &wdev->
cqm_rssi_w‹k
);

20772 
	`rcu_ªad_u∆ock
();

20773 
	}
}

20774 
EXPORT_SYMBOL
(
cfg80211_cqm_rssi_nŸify
);

20776 
	$cfg80211_cqm_rssi_nŸify_w‹k
(
wùhy
 *wùhy, 
wùhy_w‹k
 *
w‹k
)

20778 
wúñess_dev
 *
wdev
 = 
	`c⁄èöî_of
(
w‹k
, wireless_dev,

20779 
cqm_rssi_w‹k
);

20780 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

20781 
∆80211_cqm_rssi_thªshﬁd_evít
 
rssi_evít
;

20782 
cfg80211_cqm_c⁄fig
 *
cqm_c⁄fig
;

20783 
sk_buff
 *
msg
;

20784 
s32
 
rssi_Àvñ
;

20786 
cqm_c⁄fig
 = 
	`wùhy_dîe„ªn˚
(
wdev
->
wùhy
, wdev->cqm_config);

20787 i‡(!
cqm_c⁄fig
)

20790 i‡(
cqm_c⁄fig
->
u£_ønge_≠i
)

20791 
	`cfg80211_cqm_rssi_upd©e
(
rdev
, 
wdev
->
√tdev
, 
cqm_c⁄fig
);

20793 
rssi_Àvñ
 = 
cqm_c⁄fig
->
œ°_rssi_evít_vÆue
;

20794 
rssi_evít
 = 
cqm_c⁄fig
->
œ°_rssi_evít_ty≥
;

20796 
msg
 = 
	`cfg80211_¥ï¨e_cqm
(
wdev
->
√tdev
, 
NULL
, 
GFP_KERNEL
);

20797 i‡(!
msg
)

20800 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_CQM_RSSI_THRESHOLD_EVENT
,

20801 
rssi_evít
))

20802 
∆a_put_Áûuª
;

20804 i‡(
rssi_Àvñ
 && 
	`∆a_put_s32
(
msg
, 
NL80211_ATTR_CQM_RSSI_LEVEL
,

20805 
rssi_Àvñ
))

20806 
∆a_put_Áûuª
;

20808 
	`cfg80211_£nd_cqm
(
msg
, 
GFP_KERNEL
);

20812 
∆a_put_Áûuª
:

20813 
	`∆msg_‰ì
(
msg
);

20814 
	}
}

20816 
	$cfg80211_cqm_txe_nŸify
(
√t_devi˚
 *
dev
,

20817 c⁄° 
u8
 *
≥î
, 
u32
 
num_∑ckës
,

20818 
u32
 
øã
, u32 
ötvl
, 
gÂ_t
 
gÂ
)

20820 
sk_buff
 *
msg
;

20822 
msg
 = 
	`cfg80211_¥ï¨e_cqm
(
dev
, 
≥î
, 
gÂ
);

20823 i‡(!
msg
)

20826 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_CQM_TXE_PKTS
, 
num_∑ckës
))

20827 
∆a_put_Áûuª
;

20829 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_CQM_TXE_RATE
, 
øã
))

20830 
∆a_put_Áûuª
;

20832 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_CQM_TXE_INTVL
, 
ötvl
))

20833 
∆a_put_Áûuª
;

20835 
	`cfg80211_£nd_cqm
(
msg
, 
gÂ
);

20838 
∆a_put_Áûuª
:

20839 
	`∆msg_‰ì
(
msg
);

20840 
	}
}

20841 
EXPORT_SYMBOL
(
cfg80211_cqm_txe_nŸify
);

20843 
	$cfg80211_cqm_pkéoss_nŸify
(
√t_devi˚
 *
dev
,

20844 c⁄° 
u8
 *
≥î
, 
u32
 
num_∑ckës
, 
gÂ_t
 
gÂ
)

20846 
sk_buff
 *
msg
;

20848 
	`åa˚_cfg80211_cqm_pkéoss_nŸify
(
dev
, 
≥î
, 
num_∑ckës
);

20850 
msg
 = 
	`cfg80211_¥ï¨e_cqm
(
dev
, 
≥î
, 
gÂ
);

20851 i‡(!
msg
)

20854 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_CQM_PKT_LOSS_EVENT
, 
num_∑ckës
))

20855 
∆a_put_Áûuª
;

20857 
	`cfg80211_£nd_cqm
(
msg
, 
gÂ
);

20860 
∆a_put_Áûuª
:

20861 
	`∆msg_‰ì
(
msg
);

20862 
	}
}

20863 
EXPORT_SYMBOL
(
cfg80211_cqm_pkéoss_nŸify
);

20865 
	$cfg80211_cqm_bóc⁄_loss_nŸify
(
√t_devi˚
 *
dev
, 
gÂ_t
 
gÂ
)

20867 
sk_buff
 *
msg
;

20869 
msg
 = 
	`cfg80211_¥ï¨e_cqm
(
dev
, 
NULL
, 
gÂ
);

20870 i‡(!
msg
)

20873 i‡(
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_CQM_BEACON_LOSS_EVENT
))

20874 
∆a_put_Áûuª
;

20876 
	`cfg80211_£nd_cqm
(
msg
, 
gÂ
);

20879 
∆a_put_Áûuª
:

20880 
	`∆msg_‰ì
(
msg
);

20881 
	}
}

20882 
EXPORT_SYMBOL
(
cfg80211_cqm_bóc⁄_loss_nŸify
);

20884 
	$∆80211_gtk_ªkey_nŸify
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

20885 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
bssid
,

20886 c⁄° 
u8
 *
ª∂ay_˘r
, 
gÂ_t
 
gÂ
)

20888 
sk_buff
 *
msg
;

20889 
∆©å
 *
ªkey_©å
;

20890 *
hdr
;

20892 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

20893 i‡(!
msg
)

20896 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_SET_REKEY_OFFLOAD
);

20897 i‡(!
hdr
) {

20898 
	`∆msg_‰ì
(
msg
);

20902 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20903 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

20904 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
bssid
))

20905 
∆a_put_Áûuª
;

20907 
ªkey_©å
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_REKEY_DATA
);

20908 i‡(!
ªkey_©å
)

20909 
∆a_put_Áûuª
;

20911 i‡(
	`∆a_put
(
msg
, 
NL80211_REKEY_DATA_REPLAY_CTR
,

20912 
NL80211_REPLAY_CTR_LEN
, 
ª∂ay_˘r
))

20913 
∆a_put_Áûuª
;

20915 
	`∆a_√°_íd
(
msg
, 
ªkey_©å
);

20917 
	`gílmsg_íd
(
msg
, 
hdr
);

20919 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20920 
NL80211_MCGRP_MLME
, 
gÂ
);

20923 
∆a_put_Áûuª
:

20924 
	`∆msg_‰ì
(
msg
);

20925 
	}
}

20927 
	$cfg80211_gtk_ªkey_nŸify
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
bssid
,

20928 c⁄° 
u8
 *
ª∂ay_˘r
, 
gÂ_t
 
gÂ
)

20930 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

20931 
wùhy
 *wùhy = 
wdev
->wiphy;

20932 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

20934 
	`åa˚_cfg80211_gtk_ªkey_nŸify
(
dev
, 
bssid
);

20935 
	`∆80211_gtk_ªkey_nŸify
(
rdev
, 
dev
, 
bssid
, 
ª∂ay_˘r
, 
gÂ
);

20936 
	}
}

20937 
EXPORT_SYMBOL
(
cfg80211_gtk_ªkey_nŸify
);

20940 
	$∆80211_pmkß_ˇndid©e_nŸify
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

20941 
√t_devi˚
 *
√tdev
, 
ödex
,

20942 c⁄° 
u8
 *
bssid
, 
boﬁ
 
¥óuth
, 
gÂ_t
 
gÂ
)

20944 
sk_buff
 *
msg
;

20945 
∆©å
 *
©å
;

20946 *
hdr
;

20948 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

20949 i‡(!
msg
)

20952 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_PMKSA_CANDIDATE
);

20953 i‡(!
hdr
) {

20954 
	`∆msg_‰ì
(
msg
);

20958 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

20959 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
))

20960 
∆a_put_Áûuª
;

20962 
©å
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_PMKSA_CANDIDATE
);

20963 i‡(!
©å
)

20964 
∆a_put_Áûuª
;

20966 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_PMKSA_CANDIDATE_INDEX
, 
ödex
) ||

20967 
	`∆a_put
(
msg
, 
NL80211_PMKSA_CANDIDATE_BSSID
, 
ETH_ALEN
, 
bssid
) ||

20968 (
¥óuth
 &&

20969 
	`∆a_put_Êag
(
msg
, 
NL80211_PMKSA_CANDIDATE_PREAUTH
)))

20970 
∆a_put_Áûuª
;

20972 
	`∆a_√°_íd
(
msg
, 
©å
);

20974 
	`gílmsg_íd
(
msg
, 
hdr
);

20976 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

20977 
NL80211_MCGRP_MLME
, 
gÂ
);

20980 
∆a_put_Áûuª
:

20981 
	`∆msg_‰ì
(
msg
);

20982 
	}
}

20984 
	$cfg80211_pmkß_ˇndid©e_nŸify
(
√t_devi˚
 *
dev
, 
ödex
,

20985 c⁄° 
u8
 *
bssid
, 
boﬁ
 
¥óuth
, 
gÂ_t
 
gÂ
)

20987 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

20988 
wùhy
 *wùhy = 
wdev
->wiphy;

20989 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

20991 
	`åa˚_cfg80211_pmkß_ˇndid©e_nŸify
(
dev
, 
ödex
, 
bssid
, 
¥óuth
);

20992 
	`∆80211_pmkß_ˇndid©e_nŸify
(
rdev
, 
dev
, 
ödex
, 
bssid
, 
¥óuth
, 
gÂ
);

20993 
	}
}

20994 
EXPORT_SYMBOL
(
cfg80211_pmkß_ˇndid©e_nŸify
);

20996 
	$∆80211_ch_swôch_nŸify
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

20997 
√t_devi˚
 *
√tdev
,

20998 
lök_id
,

20999 
cfg80211_ch™_def
 *
ch™def
,

21000 
gÂ_t
 
gÂ
,

21001 
∆80211_comm™ds
 
nŸif
,

21002 
u8
 
cou¡
, 
boﬁ
 
quõt
)

21004 
wúñess_dev
 *
wdev
 = 
√tdev
->
õì80211_±r
;

21005 
sk_buff
 *
msg
;

21006 *
hdr
;

21008 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

21009 i‡(!
msg
)

21012 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
nŸif
);

21013 i‡(!
hdr
) {

21014 
	`∆msg_‰ì
(
msg
);

21018 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
))

21019 
∆a_put_Áûuª
;

21021 i‡(
wdev
->
vÆid_löks
 &&

21022 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MLO_LINK_ID
, 
lök_id
))

21023 
∆a_put_Áûuª
;

21025 i‡(
	`∆80211_£nd_ch™def
(
msg
, 
ch™def
))

21026 
∆a_put_Áûuª
;

21028 i‡(
nŸif
 =
NL80211_CMD_CH_SWITCH_STARTED_NOTIFY
) {

21029 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_CH_SWITCH_COUNT
, 
cou¡
))

21030 
∆a_put_Áûuª
;

21031 i‡(
quõt
 &&

21032 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_CH_SWITCH_BLOCK_TX
))

21033 
∆a_put_Áûuª
;

21036 
	`gílmsg_íd
(
msg
, 
hdr
);

21038 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

21039 
NL80211_MCGRP_MLME
, 
gÂ
);

21042 
∆a_put_Áûuª
:

21043 
	`∆msg_‰ì
(
msg
);

21044 
	}
}

21046 
	$cfg80211_ch_swôch_nŸify
(
√t_devi˚
 *
dev
,

21047 
cfg80211_ch™_def
 *
ch™def
,

21048 
lök_id
)

21050 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

21051 
wùhy
 *wùhy = 
wdev
->wiphy;

21052 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

21054 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

21055 
	`WARN_INVALID_LINK_ID
(
wdev
, 
lök_id
);

21057 
	`åa˚_cfg80211_ch_swôch_nŸify
(
dev
, 
ch™def
, 
lök_id
);

21059 
wdev
->
i·y≥
) {

21060 
NL80211_IFTYPE_STATION
:

21061 
NL80211_IFTYPE_P2P_CLIENT
:

21062 i‡(!
	`WARN_ON
(!
wdev
->
löks
[
lök_id
].
˛õ¡
.
cuºít_bss
))

21063 
	`cfg80211_upd©e_assoc_bss_íåy
(
wdev
, 
lök_id
,

21064 
ch™def
->
ch™
);

21066 
NL80211_IFTYPE_MESH_POINT
:

21067 
wdev
->
u
.
mesh
.
ch™def
 = *chandef;

21068 
wdev
->
u
.
mesh
.
¥e£t_ch™def
 = *
ch™def
;

21070 
NL80211_IFTYPE_AP
:

21071 
NL80211_IFTYPE_P2P_GO
:

21072 
wdev
->
löks
[
lök_id
].
≠
.
ch™def
 = *chandef;

21074 
NL80211_IFTYPE_ADHOC
:

21075 
wdev
->
u
.
ibss
.
ch™def
 = *chandef;

21078 
	`WARN_ON
(1);

21082 
	`cfg80211_scheduÀ_ch™√ls_check
(
wdev
);

21083 
	`cfg80211_sched_dfs_ch™_upd©e
(
rdev
);

21085 
	`∆80211_ch_swôch_nŸify
(
rdev
, 
dev
, 
lök_id
, 
ch™def
, 
GFP_KERNEL
,

21086 
NL80211_CMD_CH_SWITCH_NOTIFY
, 0, 
Ál£
);

21087 
	}
}

21088 
EXPORT_SYMBOL
(
cfg80211_ch_swôch_nŸify
);

21090 
	$cfg80211_ch_swôch_°¨ãd_nŸify
(
√t_devi˚
 *
dev
,

21091 
cfg80211_ch™_def
 *
ch™def
,

21092 
lök_id
, 
u8
 
cou¡
,

21093 
boﬁ
 
quõt
)

21095 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

21096 
wùhy
 *wùhy = 
wdev
->wiphy;

21097 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

21099 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

21100 
	`WARN_INVALID_LINK_ID
(
wdev
, 
lök_id
);

21102 
	`åa˚_cfg80211_ch_swôch_°¨ãd_nŸify
(
dev
, 
ch™def
, 
lök_id
);

21105 
	`∆80211_ch_swôch_nŸify
(
rdev
, 
dev
, 
lök_id
, 
ch™def
, 
GFP_KERNEL
,

21106 
NL80211_CMD_CH_SWITCH_STARTED_NOTIFY
,

21107 
cou¡
, 
quõt
);

21108 
	}
}

21109 
EXPORT_SYMBOL
(
cfg80211_ch_swôch_°¨ãd_nŸify
);

21111 
	$cfg80211_bss_cﬁ‹_nŸify
(
√t_devi˚
 *
dev
,

21112 
∆80211_comm™ds
 
cmd
, 
u8
 
cou¡
,

21113 
u64
 
cﬁ‹_bôm≠
)

21115 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

21116 
wùhy
 *wùhy = 
wdev
->wiphy;

21117 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

21118 
sk_buff
 *
msg
;

21119 *
hdr
;

21121 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

21123 
	`åa˚_cfg80211_bss_cﬁ‹_nŸify
(
dev
, 
cmd
, 
cou¡
, 
cﬁ‹_bôm≠
);

21125 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

21126 i‡(!
msg
)

21127  -
ENOMEM
;

21129 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
cmd
);

21130 i‡(!
hdr
)

21131 
∆a_put_Áûuª
;

21133 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
))

21134 
∆a_put_Áûuª
;

21136 i‡(
cmd
 =
NL80211_CMD_COLOR_CHANGE_STARTED
 &&

21137 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_COLOR_CHANGE_COUNT
, 
cou¡
))

21138 
∆a_put_Áûuª
;

21140 i‡(
cmd
 =
NL80211_CMD_OBSS_COLOR_COLLISION
 &&

21141 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_OBSS_COLOR_BITMAP
,

21142 
cﬁ‹_bôm≠
, 
NL80211_ATTR_PAD
))

21143 
∆a_put_Áûuª
;

21145 
	`gílmsg_íd
(
msg
, 
hdr
);

21147  
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
),

21148 
msg
, 0, 
NL80211_MCGRP_MLME
, 
GFP_KERNEL
);

21150 
∆a_put_Áûuª
:

21151 
	`∆msg_‰ì
(
msg
);

21152  -
EINVAL
;

21153 
	}
}

21154 
EXPORT_SYMBOL
(
cfg80211_bss_cﬁ‹_nŸify
);

21157 
	$∆80211_ød¨_nŸify
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

21158 c⁄° 
cfg80211_ch™_def
 *
ch™def
,

21159 
∆80211_ød¨_evít
 
evít
,

21160 
√t_devi˚
 *
√tdev
, 
gÂ_t
 
gÂ
)

21162 
sk_buff
 *
msg
;

21163 *
hdr
;

21165 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

21166 i‡(!
msg
)

21169 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_RADAR_DETECT
);

21170 i‡(!
hdr
) {

21171 
	`∆msg_‰ì
(
msg
);

21175 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
))

21176 
∆a_put_Áûuª
;

21179 i‡(
√tdev
) {

21180 
wúñess_dev
 *
wdev
 = 
√tdev
->
õì80211_±r
;

21182 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

21183 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

21184 
NL80211_ATTR_PAD
))

21185 
∆a_put_Áûuª
;

21188 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_RADAR_EVENT
, 
evít
))

21189 
∆a_put_Áûuª
;

21191 i‡(
	`∆80211_£nd_ch™def
(
msg
, 
ch™def
))

21192 
∆a_put_Áûuª
;

21194 
	`gílmsg_íd
(
msg
, 
hdr
);

21196 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

21197 
NL80211_MCGRP_MLME
, 
gÂ
);

21200 
∆a_put_Áûuª
:

21201 
	`∆msg_‰ì
(
msg
);

21202 
	}
}

21204 
	$cfg80211_°a_›mode_ch™ge_nŸify
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
mac
,

21205 
°a_›mode_öfo
 *
°a_›mode
,

21206 
gÂ_t
 
gÂ
)

21208 
sk_buff
 *
msg
;

21209 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

21210 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

21211 *
hdr
;

21213 i‡(
	`WARN_ON
(!
mac
))

21216 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

21217 i‡(!
msg
)

21220 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_STA_OPMODE_CHANGED
);

21221 i‡(!
hdr
) {

21222 
	`∆msg_‰ì
(
msg
);

21226 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
))

21227 
∆a_put_Áûuª
;

21229 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
))

21230 
∆a_put_Áûuª
;

21232 i‡(
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
mac
))

21233 
∆a_put_Áûuª
;

21235 i‡((
°a_›mode
->
ch™ged
 & 
STA_OPMODE_SMPS_MODE_CHANGED
) &&

21236 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_SMPS_MODE
, 
°a_›mode
->
smps_mode
))

21237 
∆a_put_Áûuª
;

21239 i‡((
°a_›mode
->
ch™ged
 & 
STA_OPMODE_MAX_BW_CHANGED
) &&

21240 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_CHANNEL_WIDTH
, 
°a_›mode
->
bw
))

21241 
∆a_put_Áûuª
;

21243 i‡((
°a_›mode
->
ch™ged
 & 
STA_OPMODE_N_SS_CHANGED
) &&

21244 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_NSS
, 
°a_›mode
->
rx_nss
))

21245 
∆a_put_Áûuª
;

21247 
	`gílmsg_íd
(
msg
, 
hdr
);

21249 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

21250 
NL80211_MCGRP_MLME
, 
gÂ
);

21254 
∆a_put_Áûuª
:

21255 
	`∆msg_‰ì
(
msg
);

21256 
	}
}

21257 
EXPORT_SYMBOL
(
cfg80211_°a_›mode_ch™ge_nŸify
);

21259 
	$cfg80211_¥obe_°©us
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
addr
,

21260 
u64
 
cookõ
, 
boﬁ
 
acked
, 
s32
 
ack_sig«l
,

21261 
boﬁ
 
is_vÆid_ack_sig«l
, 
gÂ_t
 
gÂ
)

21263 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

21264 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

21265 
sk_buff
 *
msg
;

21266 *
hdr
;

21268 
	`åa˚_cfg80211_¥obe_°©us
(
dev
, 
addr
, 
cookõ
, 
acked
);

21270 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

21272 i‡(!
msg
)

21275 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_PROBE_CLIENT
);

21276 i‡(!
hdr
) {

21277 
	`∆msg_‰ì
(
msg
);

21281 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

21282 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

21283 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
addr
) ||

21284 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
cookõ
,

21285 
NL80211_ATTR_PAD
) ||

21286 (
acked
 && 
	`∆a_put_Êag
(
msg
, 
NL80211_ATTR_ACK
)) ||

21287 (
is_vÆid_ack_sig«l
 && 
	`∆a_put_s32
(
msg
, 
NL80211_ATTR_ACK_SIGNAL
,

21288 
ack_sig«l
)))

21289 
∆a_put_Áûuª
;

21291 
	`gílmsg_íd
(
msg
, 
hdr
);

21293 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

21294 
NL80211_MCGRP_MLME
, 
gÂ
);

21297 
∆a_put_Áûuª
:

21298 
	`∆msg_‰ì
(
msg
);

21299 
	}
}

21300 
EXPORT_SYMBOL
(
cfg80211_¥obe_°©us
);

21302 
	$cfg80211_ªp‹t_obss_bóc⁄_khz
(
wùhy
 *wùhy, c⁄° 
u8
 *
‰ame
,

21303 
size_t
 
Àn
, 
‰eq
, 
sig_dbm
)

21305 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

21306 
sk_buff
 *
msg
;

21307 *
hdr
;

21308 
cfg80211_bóc⁄_ªgi°øti⁄
 *
ªg
;

21310 
	`åa˚_cfg80211_ªp‹t_obss_bóc⁄
(
wùhy
, 
‰ame
, 
Àn
, 
‰eq
, 
sig_dbm
);

21312 
	`•ö_lock_bh
(&
rdev
->
bóc⁄_ªgi°øti⁄s_lock
);

21313 
	`li°_f‹_óch_íåy
(
ªg
, &
rdev
->
bóc⁄_ªgi°øti⁄s
, 
li°
) {

21314 
msg
 = 
	`∆msg_√w
(
Àn
 + 100, 
GFP_ATOMIC
);

21315 i‡(!
msg
) {

21316 
	`•ö_u∆ock_bh
(&
rdev
->
bóc⁄_ªgi°øti⁄s_lock
);

21320 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_FRAME
);

21321 i‡(!
hdr
)

21322 
∆a_put_Áûuª
;

21324 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

21325 (
‰eq
 &&

21326 (
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_FREQ
,

21327 
	`KHZ_TO_MHZ
(
‰eq
)) ||

21328 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY_FREQ_OFFSET
,

21329 
‰eq
 % 1000))) ||

21330 (
sig_dbm
 &&

21331 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_RX_SIGNAL_DBM
, 
sig_dbm
)) ||

21332 
	`∆a_put
(
msg
, 
NL80211_ATTR_FRAME
, 
Àn
, 
‰ame
))

21333 
∆a_put_Áûuª
;

21335 
	`gílmsg_íd
(
msg
, 
hdr
);

21337 
	`gílmsg_uniˇ°
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 
ªg
->
∆p‹tid
);

21339 
	`•ö_u∆ock_bh
(&
rdev
->
bóc⁄_ªgi°øti⁄s_lock
);

21342 
∆a_put_Áûuª
:

21343 
	`•ö_u∆ock_bh
(&
rdev
->
bóc⁄_ªgi°øti⁄s_lock
);

21344 
	`∆msg_‰ì
(
msg
);

21345 
	}
}

21346 
EXPORT_SYMBOL
(
cfg80211_ªp‹t_obss_bóc⁄_khz
);

21348 #ifde‡
CONFIG_PM


21349 
	$cfg80211_√t_dëe˘_ªsu…s
(
sk_buff
 *
msg
,

21350 
cfg80211_wowœn_wakeup
 *
wakeup
)

21352 
cfg80211_wowœn_nd_öfo
 *
nd
 = 
wakeup
->
√t_dëe˘
;

21353 
∆©å
 *
∆_ªsu…s
, *
∆_m©ch
, *
∆_‰eqs
;

21354 
i
, 
j
;

21356 
∆_ªsu…s
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

21357 
NL80211_WOWLAN_TRIG_NET_DETECT_RESULTS
);

21358 i‡(!
∆_ªsu…s
)

21359  -
EMSGSIZE
;

21361 
i
 = 0; i < 
nd
->
n_m©ches
; i++) {

21362 
cfg80211_wowœn_nd_m©ch
 *
m©ch
 = 
nd
->
m©ches
[
i
];

21364 
∆_m©ch
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
i
);

21365 i‡(!
∆_m©ch
)

21375 i‡(
	`∆a_put
(
msg
, 
NL80211_ATTR_SSID
, 
m©ch
->
ssid
.
ssid_Àn
,

21376 
m©ch
->
ssid
.ssid)) {

21377 
	`∆a_√°_ˇn˚l
(
msg
, 
∆_m©ch
);

21378 
out
;

21381 i‡(
m©ch
->
n_ch™√ls
) {

21382 
∆_‰eqs
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

21383 
NL80211_ATTR_SCAN_FREQUENCIES
);

21384 i‡(!
∆_‰eqs
) {

21385 
	`∆a_√°_ˇn˚l
(
msg
, 
∆_m©ch
);

21386 
out
;

21389 
j
 = 0; j < 
m©ch
->
n_ch™√ls
; j++) {

21390 i‡(
	`∆a_put_u32
(
msg
, 
j
, 
m©ch
->
ch™√ls
[j])) {

21391 
	`∆a_√°_ˇn˚l
(
msg
, 
∆_‰eqs
);

21392 
	`∆a_√°_ˇn˚l
(
msg
, 
∆_m©ch
);

21393 
out
;

21397 
	`∆a_√°_íd
(
msg
, 
∆_‰eqs
);

21400 
	`∆a_√°_íd
(
msg
, 
∆_m©ch
);

21403 
out
:

21404 
	`∆a_√°_íd
(
msg
, 
∆_ªsu…s
);

21406 
	}
}

21408 
	$cfg80211_ªp‹t_wowœn_wakeup
(
wúñess_dev
 *
wdev
,

21409 
cfg80211_wowœn_wakeup
 *
wakeup
,

21410 
gÂ_t
 
gÂ
)

21412 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

21413 
sk_buff
 *
msg
;

21414 *
hdr
;

21415 
size
 = 200;

21417 
	`åa˚_cfg80211_ªp‹t_wowœn_wakeup
(
wdev
->
wùhy
, wdev, 
wakeup
);

21419 i‡(
wakeup
)

21420 
size
 +
wakeup
->
∑ckë_¥e£¡_Àn
;

21422 
msg
 = 
	`∆msg_√w
(
size
, 
gÂ
);

21423 i‡(!
msg
)

21426 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_SET_WOWLAN
);

21427 i‡(!
hdr
)

21428 
‰ì_msg
;

21430 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

21431 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

21432 
NL80211_ATTR_PAD
))

21433 
‰ì_msg
;

21435 i‡(
wdev
->
√tdev
 && 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
,

21436 
wdev
->
√tdev
->
ifödex
))

21437 
‰ì_msg
;

21439 i‡(
wakeup
) {

21440 
∆©å
 *
ªas⁄s
;

21442 
ªas⁄s
 = 
	`∆a_√°_°¨t_noÊag
(
msg
,

21443 
NL80211_ATTR_WOWLAN_TRIGGERS
);

21444 i‡(!
ªas⁄s
)

21445 
‰ì_msg
;

21447 i‡(
wakeup
->
disc⁄√˘
 &&

21448 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_DISCONNECT
))

21449 
‰ì_msg
;

21450 i‡(
wakeup
->
magic_pkt
 &&

21451 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_MAGIC_PKT
))

21452 
‰ì_msg
;

21453 i‡(
wakeup
->
gtk_ªkey_Áûuª
 &&

21454 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_GTK_REKEY_FAILURE
))

21455 
‰ì_msg
;

21456 i‡(
wakeup
->
óp_idítôy_ªq
 &&

21457 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_EAP_IDENT_REQUEST
))

21458 
‰ì_msg
;

21459 i‡(
wakeup
->
four_way_h™dshake
 &&

21460 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_4WAY_HANDSHAKE
))

21461 
‰ì_msg
;

21462 i‡(
wakeup
->
rfkûl_ªÀa£
 &&

21463 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_RFKILL_RELEASE
))

21464 
‰ì_msg
;

21466 i‡(
wakeup
->
∑âîn_idx
 >= 0 &&

21467 
	`∆a_put_u32
(
msg
, 
NL80211_WOWLAN_TRIG_PKT_PATTERN
,

21468 
wakeup
->
∑âîn_idx
))

21469 
‰ì_msg
;

21471 i‡(
wakeup
->
t˝_m©ch
 &&

21472 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_WAKEUP_TCP_MATCH
))

21473 
‰ì_msg
;

21475 i‡(
wakeup
->
t˝_c⁄∆o°
 &&

21476 
	`∆a_put_Êag
(
msg
, 
NL80211_WOWLAN_TRIG_WAKEUP_TCP_CONNLOST
))

21477 
‰ì_msg
;

21479 i‡(
wakeup
->
t˝_nom‹ëokís
 &&

21480 
	`∆a_put_Êag
(
msg
,

21481 
NL80211_WOWLAN_TRIG_WAKEUP_TCP_NOMORETOKENS
))

21482 
‰ì_msg
;

21484 i‡(
wakeup
->
u≈rŸ_dóuth_dißssoc
 &&

21485 
	`∆a_put_Êag
(
msg
,

21486 
NL80211_WOWLAN_TRIG_UNPROTECTED_DEAUTH_DISASSOC
))

21487 
‰ì_msg
;

21489 i‡(
wakeup
->
∑ckë
) {

21490 
u32
 
pkt_©å
 = 
NL80211_WOWLAN_TRIG_WAKEUP_PKT_80211
;

21491 
u32
 
Àn_©å
 = 
NL80211_WOWLAN_TRIG_WAKEUP_PKT_80211_LEN
;

21493 i‡(!
wakeup
->
∑ckë_80211
) {

21494 
pkt_©å
 =

21495 
NL80211_WOWLAN_TRIG_WAKEUP_PKT_8023
;

21496 
Àn_©å
 =

21497 
NL80211_WOWLAN_TRIG_WAKEUP_PKT_8023_LEN
;

21500 i‡(
wakeup
->
∑ckë_Àn
 &&

21501 
	`∆a_put_u32
(
msg
, 
Àn_©å
, 
wakeup
->
∑ckë_Àn
))

21502 
‰ì_msg
;

21504 i‡(
	`∆a_put
(
msg
, 
pkt_©å
, 
wakeup
->
∑ckë_¥e£¡_Àn
,

21505 
wakeup
->
∑ckë
))

21506 
‰ì_msg
;

21509 i‡(
wakeup
->
√t_dëe˘
 &&

21510 
	`cfg80211_√t_dëe˘_ªsu…s
(
msg
, 
wakeup
))

21511 
‰ì_msg
;

21513 
	`∆a_√°_íd
(
msg
, 
ªas⁄s
);

21516 
	`gílmsg_íd
(
msg
, 
hdr
);

21518 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

21519 
NL80211_MCGRP_MLME
, 
gÂ
);

21522 
‰ì_msg
:

21523 
	`∆msg_‰ì
(
msg
);

21524 
	}
}

21525 
EXPORT_SYMBOL
(
cfg80211_ªp‹t_wowœn_wakeup
);

21528 
	$cfg80211_tdls_›î_ªque°
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
≥î
,

21529 
∆80211_tdls_›î©i⁄
 
›î
,

21530 
u16
 
ªas⁄_code
, 
gÂ_t
 
gÂ
)

21532 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

21533 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

21534 
sk_buff
 *
msg
;

21535 *
hdr
;

21537 
	`åa˚_cfg80211_tdls_›î_ªque°
(
wdev
->
wùhy
, 
dev
, 
≥î
, 
›î
,

21538 
ªas⁄_code
);

21540 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

21541 i‡(!
msg
)

21544 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_TDLS_OPER
);

21545 i‡(!
hdr
) {

21546 
	`∆msg_‰ì
(
msg
);

21550 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

21551 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

21552 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_TDLS_OPERATION
, 
›î
) ||

21553 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
≥î
) ||

21554 (
ªas⁄_code
 > 0 &&

21555 
	`∆a_put_u16
(
msg
, 
NL80211_ATTR_REASON_CODE
, 
ªas⁄_code
)))

21556 
∆a_put_Áûuª
;

21558 
	`gílmsg_íd
(
msg
, 
hdr
);

21560 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

21561 
NL80211_MCGRP_MLME
, 
gÂ
);

21564 
∆a_put_Áûuª
:

21565 
	`∆msg_‰ì
(
msg
);

21566 
	}
}

21567 
EXPORT_SYMBOL
(
cfg80211_tdls_›î_ªque°
);

21569 
	$∆80211_√éök_nŸify
(
nŸifõr_block
 * 
nb
,

21570 
°©e
,

21571 *
_nŸify
)

21573 
√éök_nŸify
 *
nŸify
 = 
_nŸify
;

21574 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

21575 
wúñess_dev
 *
wdev
;

21576 
cfg80211_bóc⁄_ªgi°øti⁄
 *
ªg
, *
tmp
;

21578 i‡(
°©e
 !
NETLINK_URELEASE
 || 
nŸify
->
¥Ÿocﬁ
 !
NETLINK_GENERIC
)

21579  
NOTIFY_DONE
;

21581 
	`rcu_ªad_lock
();

21583 
	`li°_f‹_óch_íåy_rcu
(
rdev
, &
cfg80211_rdev_li°
, 
li°
) {

21584 
cfg80211_sched_sˇn_ªque°
 *
sched_sˇn_ªq
;

21586 
	`li°_f‹_óch_íåy_rcu
(
sched_sˇn_ªq
,

21587 &
rdev
->
sched_sˇn_ªq_li°
,

21588 
li°
) {

21589 i‡(
sched_sˇn_ªq
->
ow√r_∆p‹tid
 =
nŸify
->
p‹tid
) {

21590 
sched_sˇn_ªq
->
∆_ow√r_dód
 = 
åue
;

21591 
	`wùhy_w‹k_queue
(&
rdev
->
wùhy
,

21592 &
rdev
->
sched_sˇn_°›_wk
);

21596 
	`li°_f‹_óch_íåy_rcu
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

21597 
	`cfg80211_mlme_uƒegi°î_sockë
(
wdev
, 
nŸify
->
p‹tid
);

21599 i‡(
wdev
->
ow√r_∆p‹tid
 =
nŸify
->
p‹tid
) {

21600 
wdev
->
∆_ow√r_dód
 = 
åue
;

21601 
	`scheduÀ_w‹k
(&
rdev
->
de°roy_w‹k
);

21602 } i‡(
wdev
->
c⁄n_ow√r_∆p‹tid
 =
nŸify
->
p‹tid
) {

21603 
	`scheduÀ_w‹k
(&
wdev
->
disc⁄√˘_wk
);

21606 
	`cfg80211_ªÀa£_pm§
(
wdev
, 
nŸify
->
p‹tid
);

21609 
	`•ö_lock_bh
(&
rdev
->
bóc⁄_ªgi°øti⁄s_lock
);

21610 
	`li°_f‹_óch_íåy_ß„
(
ªg
, 
tmp
, &
rdev
->
bóc⁄_ªgi°øti⁄s
,

21611 
li°
) {

21612 i‡(
ªg
->
∆p‹tid
 =
nŸify
->
p‹tid
) {

21613 
	`li°_dñ
(&
ªg
->
li°
);

21614 
	`k‰ì
(
ªg
);

21618 
	`•ö_u∆ock_bh
(&
rdev
->
bóc⁄_ªgi°øti⁄s_lock
);

21621 
	`rcu_ªad_u∆ock
();

21627 
	`ªguœt‹y_√éök_nŸify
(
nŸify
->
p‹tid
);

21628  
NOTIFY_OK
;

21629 
	}
}

21631 
nŸifõr_block
 
	g∆80211_√éök_nŸifõr
 = {

21632 .
nŸifõr_ˇŒ
 = 
∆80211_√éök_nŸify
,

21635 
	$cfg80211_·_evít
(
√t_devi˚
 *
√tdev
,

21636 
cfg80211_·_evít_∑øms
 *
·_evít
)

21638 
wùhy
 *wùhy = 
√tdev
->
õì80211_±r
->wiphy;

21639 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

21640 
sk_buff
 *
msg
;

21641 *
hdr
;

21643 
	`åa˚_cfg80211_·_evít
(
wùhy
, 
√tdev
, 
·_evít
);

21645 i‡(!
·_evít
->
èrgë_≠
)

21648 
msg
 = 
	`∆msg_√w
(100 + 
·_evít
->
õs_Àn
 + ft_evít->
ric_õs_Àn
,

21649 
GFP_KERNEL
);

21650 i‡(!
msg
)

21653 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_FT_EVENT
);

21654 i‡(!
hdr
)

21655 
out
;

21657 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

21658 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

21659 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
·_evít
->
èrgë_≠
))

21660 
out
;

21662 i‡(
·_evít
->
õs
 &&

21663 
	`∆a_put
(
msg
, 
NL80211_ATTR_IE
, 
·_evít
->
õs_Àn
, ft_evít->
õs
))

21664 
out
;

21665 i‡(
·_evít
->
ric_õs
 &&

21666 
	`∆a_put
(
msg
, 
NL80211_ATTR_IE_RIC
, 
·_evít
->
ric_õs_Àn
,

21667 
·_evít
->
ric_õs
))

21668 
out
;

21670 
	`gílmsg_íd
(
msg
, 
hdr
);

21672 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

21673 
NL80211_MCGRP_MLME
, 
GFP_KERNEL
);

21675 
out
:

21676 
	`∆msg_‰ì
(
msg
);

21677 
	}
}

21678 
EXPORT_SYMBOL
(
cfg80211_·_evít
);

21680 
	$cfg80211_¸ô_¥Ÿo_°›≥d
(
wúñess_dev
 *
wdev
, 
gÂ_t
 
gÂ
)

21682 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

21683 
sk_buff
 *
msg
;

21684 *
hdr
;

21685 
u32
 
∆p‹tid
;

21687 
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

21688 i‡(!
rdev
->
¸ô_¥Ÿo_∆p‹tid
)

21691 
∆p‹tid
 = 
rdev
->
¸ô_¥Ÿo_∆p‹tid
;

21692 
rdev
->
¸ô_¥Ÿo_∆p‹tid
 = 0;

21694 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

21695 i‡(!
msg
)

21698 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_CRIT_PROTOCOL_STOP
);

21699 i‡(!
hdr
)

21700 
∆a_put_Áûuª
;

21702 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

21703 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

21704 
NL80211_ATTR_PAD
))

21705 
∆a_put_Áûuª
;

21707 
	`gílmsg_íd
(
msg
, 
hdr
);

21709 
	`gílmsg_uniˇ°
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 
∆p‹tid
);

21712 
∆a_put_Áûuª
:

21713 
	`∆msg_‰ì
(
msg
);

21714 
	}
}

21715 
EXPORT_SYMBOL
(
cfg80211_¸ô_¥Ÿo_°›≥d
);

21717 
	$∆80211_£nd_≠_°›≥d
(
wúñess_dev
 *
wdev
, 
lök_id
)

21719 
wùhy
 *wùhy = 
wdev
->wiphy;

21720 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

21721 
sk_buff
 *
msg
;

21722 *
hdr
;

21724 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_KERNEL
);

21725 i‡(!
msg
)

21728 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_STOP_AP
);

21729 i‡(!
hdr
)

21730 
out
;

21732 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

21733 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
wdev
->
√tdev
->
ifödex
) ||

21734 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

21735 
NL80211_ATTR_PAD
) ||

21736 (
wdev
->
vÆid_löks
 &&

21737 
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MLO_LINK_ID
, 
lök_id
)))

21738 
out
;

21740 
	`gílmsg_íd
(
msg
, 
hdr
);

21742 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(
wùhy
), 
msg
, 0,

21743 
NL80211_MCGRP_MLME
, 
GFP_KERNEL
);

21745 
out
:

21746 
	`∆msg_‰ì
(
msg
);

21747 
	}
}

21749 
	$cfg80211_exã∫Æ_auth_ªque°
(
√t_devi˚
 *
dev
,

21750 
cfg80211_exã∫Æ_auth_∑øms
 *
∑øms
,

21751 
gÂ_t
 
gÂ
)

21753 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

21754 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

21755 
sk_buff
 *
msg
;

21756 *
hdr
;

21758 i‡(!
wdev
->
c⁄n_ow√r_∆p‹tid
)

21759  -
EINVAL
;

21761 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

21762 i‡(!
msg
)

21763  -
ENOMEM
;

21765 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_EXTERNAL_AUTH
);

21766 i‡(!
hdr
)

21767 
∆a_put_Áûuª
;

21777 i‡(
∑øms
->
key_mgmt_suôe
 =
WLAN_AKM_SUITE_SAE
) {

21778 i‡(
	`∆a_put_be32
(
msg
, 
NL80211_ATTR_AKM_SUITES
,

21779 
	`˝u_to_be32
(
WLAN_AKM_SUITE_SAE
)))

21780 
∆a_put_Áûuª
;

21782 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_AKM_SUITES
,

21783 
∑øms
->
key_mgmt_suôe
))

21784 
∆a_put_Áûuª
;

21787 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

21788 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
dev
->
ifödex
) ||

21789 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_EXTERNAL_AUTH_ACTION
,

21790 
∑øms
->
a˘i⁄
) ||

21791 
	`∆a_put
(
msg
, 
NL80211_ATTR_BSSID
, 
ETH_ALEN
, 
∑øms
->
bssid
) ||

21792 
	`∆a_put
(
msg
, 
NL80211_ATTR_SSID
, 
∑øms
->
ssid
.
ssid_Àn
,

21793 
∑øms
->
ssid
.ssid) ||

21794 (!
	`is_zîo_ëhî_addr
(
∑øms
->
mld_addr
) &&

21795 
	`∆a_put
(
msg
, 
NL80211_ATTR_MLD_ADDR
, 
ETH_ALEN
, 
∑øms
->
mld_addr
)))

21796 
∆a_put_Áûuª
;

21798 
	`gílmsg_íd
(
msg
, 
hdr
);

21799 
	`gílmsg_uniˇ°
(
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
,

21800 
wdev
->
c⁄n_ow√r_∆p‹tid
);

21803 
∆a_put_Áûuª
:

21804 
	`∆msg_‰ì
(
msg
);

21805  -
ENOBUFS
;

21806 
	}
}

21807 
EXPORT_SYMBOL
(
cfg80211_exã∫Æ_auth_ªque°
);

21809 
	$cfg80211_upd©e_owe_öfo_evít
(
√t_devi˚
 *
√tdev
,

21810 
cfg80211_upd©e_owe_öfo
 *
owe_öfo
,

21811 
gÂ_t
 
gÂ
)

21813 
wùhy
 *wùhy = 
√tdev
->
õì80211_±r
->wiphy;

21814 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

21815 
sk_buff
 *
msg
;

21816 *
hdr
;

21818 
	`åa˚_cfg80211_upd©e_owe_öfo_evít
(
wùhy
, 
√tdev
, 
owe_öfo
);

21820 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

21821 i‡(!
msg
)

21824 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_UPDATE_OWE_INFO
);

21825 i‡(!
hdr
)

21826 
∆a_put_Áûuª
;

21828 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

21829 
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
√tdev
->
ifödex
) ||

21830 
	`∆a_put
(
msg
, 
NL80211_ATTR_MAC
, 
ETH_ALEN
, 
owe_öfo
->
≥î
))

21831 
∆a_put_Áûuª
;

21833 i‡(!
owe_öfo
->
õ_Àn
 ||

21834 
	`∆a_put
(
msg
, 
NL80211_ATTR_IE
, 
owe_öfo
->
õ_Àn
, owe_öfo->
õ
))

21835 
∆a_put_Áûuª
;

21837 i‡(
owe_öfo
->
assoc_lök_id
 != -1) {

21838 i‡(
	`∆a_put_u8
(
msg
, 
NL80211_ATTR_MLO_LINK_ID
,

21839 
owe_öfo
->
assoc_lök_id
))

21840 
∆a_put_Áûuª
;

21842 i‡(!
	`is_zîo_ëhî_addr
(
owe_öfo
->
≥î_mld_addr
) &&

21843 
	`∆a_put
(
msg
, 
NL80211_ATTR_MLD_ADDR
, 
ETH_ALEN
,

21844 
owe_öfo
->
≥î_mld_addr
))

21845 
∆a_put_Áûuª
;

21848 
	`gílmsg_íd
(
msg
, 
hdr
);

21850 
	`gílmsg_mu…iˇ°_√äs
(&
∆80211_Ám
, 
	`wùhy_√t
(&
rdev
->
wùhy
), 
msg
, 0,

21851 
NL80211_MCGRP_MLME
, 
gÂ
);

21854 
∆a_put_Áûuª
:

21855 
	`gílmsg_ˇn˚l
(
msg
, 
hdr
);

21856 
	`∆msg_‰ì
(
msg
);

21857 
	}
}

21858 
EXPORT_SYMBOL
(
cfg80211_upd©e_owe_öfo_evít
);

21860 
	$cfg80211_scheduÀ_ch™√ls_check
(
wúñess_dev
 *
wdev
)

21862 
wùhy
 *wùhy = 
wdev
->wiphy;

21865 i‡(
wdev
->
i·y≥
 =
NL80211_IFTYPE_STATION
 &&

21866 (
	`wùhy_ext_„©uª_is£t
(
wùhy
,

21867 
NL80211_EXT_FEATURE_DFS_CONCURRENT
) ||

21868 (
	`IS_ENABLED
(
CONFIG_CFG80211_REG_RELAX_NO_IR
) &&

21869 
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_ENABLE_RELAX_NO_IR
)))

21870 
	`ªg_check_ch™√ls
();

21871 
	}
}

21872 
EXPORT_SYMBOL
(
cfg80211_scheduÀ_ch™√ls_check
);

21876 
__öô
 
	$∆80211_öô
()

21878 
îr
;

21880 
îr
 = 
	`gíl_ªgi°î_Ámûy
(&
∆80211_Ám
);

21881 i‡(
îr
)

21882  
îr
;

21884 
îr
 = 
	`√éök_ªgi°î_nŸifõr
(&
∆80211_√éök_nŸifõr
);

21885 i‡(
îr
)

21886 
îr_out
;

21889 
îr_out
:

21890 
	`gíl_uƒegi°î_Ámûy
(&
∆80211_Ám
);

21891  
îr
;

21892 
	}
}

21894 
	$∆80211_exô
()

21896 
	`√éök_uƒegi°î_nŸifõr
(&
∆80211_√éök_nŸifõr
);

21897 
	`gíl_uƒegi°î_Ámûy
(&
∆80211_Ám
);

21898 
	}
}

	@nl80211.h

6 #i‚de‡
__NET_WIRELESS_NL80211_H


7 
	#__NET_WIRELESS_NL80211_H


	)

9 
	~"c‹e.h
"

11 
∆80211_öô
();

12 
∆80211_exô
();

14 *
∆80211hdr_put
(
sk_buff
 *
skb
, 
u32
 
p‹tid
, u32 
£q
,

15 
Êags
, 
u8
 
cmd
);

16 
boﬁ
 
∆80211_put_°a_øã
(
sk_buff
 *
msg
, 
øã_öfo
 *
öfo
,

17 
©å
);

19 
ölöe
 
u64
 
	$wdev_id
(
wúñess_dev
 *
wdev
)

21  (
u64
)
wdev
->
idítifõr
 |

22 ((
u64
)
	`wùhy_to_rdev
(
wdev
->
wùhy
)->
wùhy_idx
 << 32);

23 
	}
}

25 
∆80211_∑r£_ch™def
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

26 
gíl_öfo
 *
öfo
,

27 
cfg80211_ch™_def
 *
ch™def
);

28 
∆80211_∑r£_øndom_mac
(
∆©å
 **
©ås
,

29 
u8
 *
mac_addr
, u8 *
mac_addr_mask
);

31 
∆80211_nŸify_wùhy
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

32 
∆80211_comm™ds
 
cmd
);

33 
∆80211_nŸify_iÁ˚
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

34 
wúñess_dev
 *
wdev
,

35 
∆80211_comm™ds
 
cmd
);

36 
∆80211_£nd_sˇn_°¨t
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

37 
wúñess_dev
 *
wdev
);

38 
sk_buff
 *
∆80211_buûd_sˇn_msg
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

39 
wúñess_dev
 *
wdev
, 
boﬁ
 
ab‹ãd
);

40 
∆80211_£nd_sˇn_msg
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

41 
sk_buff
 *
msg
);

42 
∆80211_£nd_sched_sˇn
(
cfg80211_sched_sˇn_ªque°
 *
ªq
, 
u32
 
cmd
);

43 
∆80211_comm⁄_ªg_ch™ge_evít
(
∆80211_comm™ds
 
cmd_id
,

44 
ªguœt‹y_ªque°
 *
ªque°
);

46 
ölöe
 

47 
	$∆80211_£nd_ªg_ch™ge_evít
(
ªguœt‹y_ªque°
 *
ªque°
)

49 
	`∆80211_comm⁄_ªg_ch™ge_evít
(
NL80211_CMD_REG_CHANGE
, 
ªque°
);

50 
	}
}

52 
ölöe
 

53 
	$∆80211_£nd_wùhy_ªg_ch™ge_evít
(
ªguœt‹y_ªque°
 *
ªque°
)

55 
	`∆80211_comm⁄_ªg_ch™ge_evít
(
NL80211_CMD_WIPHY_REG_CHANGE
, 
ªque°
);

56 
	}
}

58 
∆80211_£nd_rx_auth
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

59 
√t_devi˚
 *
√tdev
,

60 c⁄° 
u8
 *
buf
, 
size_t
 
Àn
, 
gÂ_t
 
gÂ
);

61 
∆80211_£nd_rx_assoc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

62 
√t_devi˚
 *
√tdev
,

63 c⁄° 
cfg80211_rx_assoc_ª•_d©a
 *
d©a
);

64 
∆80211_£nd_dóuth
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

65 
√t_devi˚
 *
√tdev
,

66 c⁄° 
u8
 *
buf
, 
size_t
 
Àn
,

67 
boﬁ
 
ªc⁄√˘
, 
gÂ_t
 
gÂ
);

68 
∆80211_£nd_dißssoc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

69 
√t_devi˚
 *
√tdev
,

70 c⁄° 
u8
 *
buf
, 
size_t
 
Àn
,

71 
boﬁ
 
ªc⁄√˘
, 
gÂ_t
 
gÂ
);

72 
∆80211_£nd_auth_timeout
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

73 
√t_devi˚
 *
√tdev
,

74 c⁄° 
u8
 *
addr
, 
gÂ_t
 
gÂ
);

75 
∆80211_£nd_assoc_timeout
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

76 
√t_devi˚
 *
√tdev
,

77 c⁄° 
u8
 *
addr
, 
gÂ_t
 
gÂ
);

78 
∆80211_£nd_c⁄√˘_ªsu…
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

79 
√t_devi˚
 *
√tdev
,

80 
cfg80211_c⁄√˘_ª•_∑øms
 *
∑øms
,

81 
gÂ_t
 
gÂ
);

82 
∆80211_£nd_rﬂmed
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

83 
√t_devi˚
 *
√tdev
,

84 
cfg80211_rﬂm_öfo
 *
öfo
, 
gÂ_t
 
gÂ
);

88 
∆80211_£nd_p‹t_auth‹ized
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

89 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
≥î_addr
,

90 c⁄° 
u8
 *
td_bôm≠
, u8 
td_bôm≠_Àn
);

91 
∆80211_£nd_disc⁄√˘ed
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

92 
√t_devi˚
 *
√tdev
, 
u16
 
ªas⁄
,

93 c⁄° 
u8
 *
õ
, 
size_t
 
õ_Àn
, 
boﬁ
 
‰om_≠
);

96 
∆80211_mich´l_mic_Áûuª
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

97 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
addr
,

98 
∆80211_key_ty≥
 
key_ty≥
,

99 
key_id
, c⁄° 
u8
 *
tsc
, 
gÂ_t
 
gÂ
);

102 
∆80211_£nd_bóc⁄_höt_evít
(
wùhy
 *wiphy,

103 
õì80211_ch™√l
 *
ch™√l_bef‹e
,

104 
õì80211_ch™√l
 *
ch™√l_a·î
);

106 
∆80211_£nd_ibss_bssid
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

107 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
bssid
,

108 
gÂ_t
 
gÂ
);

110 
∆80211_£nd_mgmt
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

111 
wúñess_dev
 *
wdev
, 
u32
 
∆pid
,

112 
cfg80211_rx_öfo
 *
öfo
, 
gÂ_t
 
gÂ
);

115 
∆80211_ød¨_nŸify
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

116 c⁄° 
cfg80211_ch™_def
 *
ch™def
,

117 
∆80211_ød¨_evít
 
evít
,

118 
√t_devi˚
 *
√tdev
, 
gÂ_t
 
gÂ
);

120 
∆80211_£nd_≠_°›≥d
(
wúñess_dev
 *
wdev
, 
lök_id
);

122 
cfg80211_rdev_‰ì_cﬂÀs˚
(
cfg80211_ªgi°îed_devi˚
 *
rdev
);

125 
∆80211_pm§_°¨t
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
);

	@ocb.c

12 
	~<löux/õì80211.h
>

13 
	~<√t/cfg80211.h
>

14 
	~"∆80211.h
"

15 
	~"c‹e.h
"

16 
	~"rdev-›s.h
"

18 
	$cfg80211_joö_ocb
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19 
√t_devi˚
 *
dev
,

20 
ocb_£tup
 *
£tup
)

22 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

23 
îr
;

25 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

27 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_OCB
)

28  -
EOPNOTSUPP
;

30 i‡(!
rdev
->
›s
->
joö_ocb
)

31  -
EOPNOTSUPP
;

33 i‡(
	`WARN_ON
(!
£tup
->
ch™def
.
ch™
))

34  -
EINVAL
;

36 
îr
 = 
	`rdev_joö_ocb
(
rdev
, 
dev
, 
£tup
);

37 i‡(!
îr
)

38 
wdev
->
u
.
ocb
.
ch™def
 = 
£tup
->chandef;

40  
îr
;

41 
	}
}

43 
	$cfg80211_Àave_ocb
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

44 
√t_devi˚
 *
dev
)

46 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

47 
îr
;

49 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

51 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_OCB
)

52  -
EOPNOTSUPP
;

54 i‡(!
rdev
->
›s
->
Àave_ocb
)

55  -
EOPNOTSUPP
;

57 i‡(!
wdev
->
u
.
ocb
.
ch™def
.
ch™
)

58  -
ENOTCONN
;

60 
îr
 = 
	`rdev_Àave_ocb
(
rdev
, 
dev
);

61 i‡(!
îr
)

62 
	`mem£t
(&
wdev
->
u
.
ocb
.
ch™def
, 0, (wdev->u.ocb.chandef));

64  
îr
;

65 
	}
}

	@of.c

17 
	~<löux/of.h
>

18 
	~<√t/cfg80211.h
>

19 
	~"c‹e.h
"

21 
boﬁ
 
	$wùhy_‰eq_limôs_vÆid_ch™
(
wùhy
 *wiphy,

22 
õì80211_‰eq_ønge
 *
‰eq_limôs
,

23 
n_‰eq_limôs
,

24 
õì80211_ch™√l
 *
ch™
)

26 
u32
 
bw
 = 
	`MHZ_TO_KHZ
(20);

27 
i
;

29 
i
 = 0; i < 
n_‰eq_limôs
; i++) {

30 
õì80211_‰eq_ønge
 *
limô
 = &
‰eq_limôs
[
i
];

32 i‡(
	`cfg80211_d€s_bw_fô_ønge
(
limô
,

33 
	`MHZ_TO_KHZ
(
ch™
->
˚¡î_‰eq
),

34 
bw
))

35  
åue
;

38  
Ál£
;

39 
	}
}

41 
	$wùhy_‰eq_limôs_≠∂y
(
wùhy
 *wiphy,

42 
õì80211_‰eq_ønge
 *
‰eq_limôs
,

43 
n_‰eq_limôs
)

45 
∆80211_b™d
 
b™d
;

46 
i
;

48 i‡(
	`WARN_ON
(!
n_‰eq_limôs
))

51 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

52 
õì80211_suµ‹ãd_b™d
 *
sb™d
 = 
wùhy
->
b™ds
[
b™d
];

54 i‡(!
sb™d
)

57 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++) {

58 
õì80211_ch™√l
 *
ch™
 = &
sb™d
->
ch™√ls
[
i
];

60 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

63 i‡(!
	`wùhy_‰eq_limôs_vÆid_ch™
(
wùhy
, 
‰eq_limôs
,

64 
n_‰eq_limôs
,

65 
ch™
)) {

66 
	`¥_debug
("Disabling freq %d MHzás it's out of OFÜimits\n",

67 
ch™
->
˚¡î_‰eq
);

68 
ch™
->
Êags
 |
IEEE80211_CHAN_DISABLED
;

72 
	}
}

74 
	$wùhy_ªad_of_‰eq_limôs
(
wùhy
 *wiphy)

76 
devi˚
 *
dev
 = 
	`wùhy_dev
(
wùhy
);

77 
devi˚_node
 *
≈
;

78 
¥›îty
 *
¥›
;

79 
õì80211_‰eq_ønge
 *
‰eq_limôs
;

80 
n_‰eq_limôs
;

81 c⁄° 
__be32
 *
p
;

82 
Àn
, 
i
;

83 
îr
 = 0;

85 i‡(!
dev
)

87 
≈
 = 
	`dev_of_node
(
dev
);

88 i‡(!
≈
)

91 
¥›
 = 
	`of_föd_¥›îty
(
≈
, "õì80211-‰eq-limô", &
Àn
);

92 i‡(!
¥›
)

95 i‡(!
Àn
 ||Üí % (
u32
) ||Üen / (u32) % 2) {

96 
	`dev_îr
(
dev
, "ieee80211-freq-limit wrong format");

99 
n_‰eq_limôs
 = 
Àn
 / (
u32
) / 2;

101 
‰eq_limôs
 = 
	`kˇŒoc
(
n_‰eq_limôs
, (*‰eq_limôs), 
GFP_KERNEL
);

102 i‡(!
‰eq_limôs
) {

103 
îr
 = -
ENOMEM
;

104 
out_k‰ì
;

107 
p
 = 
NULL
;

108 
i
 = 0; i < 
n_‰eq_limôs
; i++) {

109 
õì80211_‰eq_ønge
 *
limô
 = &
‰eq_limôs
[
i
];

111 
p
 = 
	`of_¥›_√xt_u32
(
¥›
,Ö, &
limô
->
°¨t_‰eq_khz
);

112 i‡(!
p
) {

113 
îr
 = -
EINVAL
;

114 
out_k‰ì
;

117 
p
 = 
	`of_¥›_√xt_u32
(
¥›
,Ö, &
limô
->
íd_‰eq_khz
);

118 i‡(!
p
) {

119 
îr
 = -
EINVAL
;

120 
out_k‰ì
;

123 i‡(!
limô
->
°¨t_‰eq_khz
 ||

124 !
limô
->
íd_‰eq_khz
 ||

125 
limô
->
°¨t_‰eq_khz
 >limô->
íd_‰eq_khz
) {

126 
îr
 = -
EINVAL
;

127 
out_k‰ì
;

131 
	`wùhy_‰eq_limôs_≠∂y
(
wùhy
, 
‰eq_limôs
, 
n_‰eq_limôs
);

133 
out_k‰ì
:

134 
	`k‰ì
(
‰eq_limôs
);

135 i‡(
îr
)

136 
	`dev_îr
(
dev
, "FaûedÅÿgëÜimôs: %d\n", 
îr
);

137 
	}
}

138 
EXPORT_SYMBOL
(
wùhy_ªad_of_‰eq_limôs
);

	@pmsr.c

5 
	~<√t/cfg80211.h
>

6 
	~"c‹e.h
"

7 
	~"∆80211.h
"

8 
	~"rdev-›s.h
"

10 
	$pm§_∑r£_·m
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

11 
∆©å
 *
·mªq
,

12 
cfg80211_pm§_ªque°_≥î
 *
out
,

13 
gíl_öfo
 *
öfo
)

15 c⁄° 
cfg80211_pm§_ˇ∑bûôõs
 *
ˇ∑
 = 
rdev
->
wùhy
.
pm§_ˇ∑
;

16 
∆©å
 *
tb
[
NL80211_PMSR_FTM_REQ_ATTR_MAX
 + 1];

17 
u32
 
¥ómbÀ
 = 
NL80211_PREAMBLE_DMG
;

20 i‡(!(
rdev
->
wùhy
.
pm§_ˇ∑
->
·m
.
b™dwidths
 & 
	`BIT
(
out
->
ch™def
.
width
))) {

21 
	`NL_SET_ERR_MSG
(
öfo
->
exèck
, "FTM: unsupported bandwidth");

22  -
EINVAL
;

26 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
NL80211_PMSR_FTM_REQ_ATTR_MAX
, 
·mªq
,

27 
NULL
, NULL);

29 i‡(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_PREAMBLE
])

30 
¥ómbÀ
 = 
	`∆a_gë_u32
(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_PREAMBLE
]);

33 
out
->
·m
.
ªque°ed
 = 
åue
;

35 
out
->
ch™def
.
ch™
->
b™d
) {

36 
NL80211_BAND_60GHZ
:

40 i‡(!
tb
[
NL80211_PMSR_FTM_REQ_ATTR_PREAMBLE
]) {

41 
	`NL_SET_ERR_MSG
(
öfo
->
exèck
,

43  -
EINVAL
;

47 i‡(!(
ˇ∑
->
·m
.
¥ómbÀs
 & 
	`BIT
(
¥ómbÀ
))) {

48 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

49 
tb
[
NL80211_PMSR_FTM_REQ_ATTR_PREAMBLE
],

51  -
EINVAL
;

54 
out
->
·m
.
¥ómbÀ
 =Öreamble;

56 
out
->
·m
.
bur°_≥riod
 = 0;

57 i‡(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_BURST_PERIOD
])

58 
out
->
·m
.
bur°_≥riod
 =

59 
	`∆a_gë_u32
(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_BURST_PERIOD
]);

61 
out
->
·m
.
aßp
 = !!
tb
[
NL80211_PMSR_FTM_REQ_ATTR_ASAP
];

62 i‡(
out
->
·m
.
aßp
 && !
ˇ∑
->ftm.asap) {

63 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

64 
tb
[
NL80211_PMSR_FTM_REQ_ATTR_ASAP
],

66  -
EINVAL
;

69 i‡(!
out
->
·m
.
aßp
 && !
ˇ∑
->·m.
n⁄_aßp
) {

70 
	`NL_SET_ERR_MSG
(
öfo
->
exèck
,

72  -
EINVAL
;

75 
out
->
·m
.
num_bur°s_exp
 = 0;

76 i‡(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_NUM_BURSTS_EXP
])

77 
out
->
·m
.
num_bur°s_exp
 =

78 
	`∆a_gë_u32
(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_NUM_BURSTS_EXP
]);

80 i‡(
ˇ∑
->
·m
.
max_bur°s_exp⁄ít
 >= 0 &&

81 
out
->
·m
.
num_bur°s_exp
 > 
ˇ∑
->·m.
max_bur°s_exp⁄ít
) {

82 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

83 
tb
[
NL80211_PMSR_FTM_REQ_ATTR_NUM_BURSTS_EXP
],

85  -
EINVAL
;

88 
out
->
·m
.
bur°_duøti⁄
 = 15;

89 i‡(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_BURST_DURATION
])

90 
out
->
·m
.
bur°_duøti⁄
 =

91 
	`∆a_gë_u32
(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_BURST_DURATION
]);

93 
out
->
·m
.
·ms_≥r_bur°
 = 0;

94 i‡(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_FTMS_PER_BURST
])

95 
out
->
·m
.
·ms_≥r_bur°
 =

96 
	`∆a_gë_u32
(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_FTMS_PER_BURST
]);

98 i‡(
ˇ∑
->
·m
.
max_·ms_≥r_bur°
 &&

99 (
out
->
·m
.
·ms_≥r_bur°
 > 
ˇ∑
->·m.
max_·ms_≥r_bur°
 ||

100 
out
->
·m
.
·ms_≥r_bur°
 == 0)) {

101 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

102 
tb
[
NL80211_PMSR_FTM_REQ_ATTR_FTMS_PER_BURST
],

104  -
EINVAL
;

107 
out
->
·m
.
·mr_ªåõs
 = 3;

108 i‡(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_NUM_FTMR_RETRIES
])

109 
out
->
·m
.
·mr_ªåõs
 =

110 
	`∆a_gë_u32
(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_NUM_FTMR_RETRIES
]);

112 
out
->
·m
.
ªque°_lci
 = !!
tb
[
NL80211_PMSR_FTM_REQ_ATTR_REQUEST_LCI
];

113 i‡(
out
->
·m
.
ªque°_lci
 && !
ˇ∑
->ftm.request_lci) {

114 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

115 
tb
[
NL80211_PMSR_FTM_REQ_ATTR_REQUEST_LCI
],

119 
out
->
·m
.
ªque°_civi˛oc
 =

120 !!
tb
[
NL80211_PMSR_FTM_REQ_ATTR_REQUEST_CIVICLOC
];

121 i‡(
out
->
·m
.
ªque°_civi˛oc
 && !
ˇ∑
->ftm.request_civicloc) {

122 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

123 
tb
[
NL80211_PMSR_FTM_REQ_ATTR_REQUEST_CIVICLOC
],

127 
out
->
·m
.
åiggî_ba£d
 =

128 !!
tb
[
NL80211_PMSR_FTM_REQ_ATTR_TRIGGER_BASED
];

129 i‡(
out
->
·m
.
åiggî_ba£d
 && !
ˇ∑
->ftm.trigger_based) {

130 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

131 
tb
[
NL80211_PMSR_FTM_REQ_ATTR_TRIGGER_BASED
],

133  -
EINVAL
;

136 
out
->
·m
.
n⁄_åiggî_ba£d
 =

137 !!
tb
[
NL80211_PMSR_FTM_REQ_ATTR_NON_TRIGGER_BASED
];

138 i‡(
out
->
·m
.
n⁄_åiggî_ba£d
 && !
ˇ∑
->ftm.non_trigger_based) {

139 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

140 
tb
[
NL80211_PMSR_FTM_REQ_ATTR_NON_TRIGGER_BASED
],

142  -
EINVAL
;

145 i‡(
out
->
·m
.
åiggî_ba£d
 && out->·m.
n⁄_åiggî_ba£d
) {

146 
	`NL_SET_ERR_MSG
(
öfo
->
exèck
,

148  -
EINVAL
;

151 i‡((
out
->
·m
.
åiggî_ba£d
 || out->·m.
n⁄_åiggî_ba£d
) &&

152 
out
->
·m
.
¥ómbÀ
 !
NL80211_PREAMBLE_HE
) {

153 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

154 
tb
[
NL80211_PMSR_FTM_REQ_ATTR_PREAMBLE
],

156  -
EINVAL
;

159 
out
->
·m
.
lmr_„edback
 =

160 !!
tb
[
NL80211_PMSR_FTM_REQ_ATTR_LMR_FEEDBACK
];

161 i‡(!
out
->
·m
.
åiggî_ba£d
 && !out->·m.
n⁄_åiggî_ba£d
 &&

162 
out
->
·m
.
lmr_„edback
) {

163 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

164 
tb
[
NL80211_PMSR_FTM_REQ_ATTR_LMR_FEEDBACK
],

166  -
EINVAL
;

169 i‡(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_BSS_COLOR
]) {

170 i‡(!
out
->
·m
.
n⁄_åiggî_ba£d
 && !out->·m.
åiggî_ba£d
) {

171 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

172 
tb
[
NL80211_PMSR_FTM_REQ_ATTR_BSS_COLOR
],

174  -
EINVAL
;

177 
out
->
·m
.
bss_cﬁ‹
 =

178 
	`∆a_gë_u8
(
tb
[
NL80211_PMSR_FTM_REQ_ATTR_BSS_COLOR
]);

182 
	}
}

184 
	$pm§_∑r£_≥î
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

185 
∆©å
 *
≥î
,

186 
cfg80211_pm§_ªque°_≥î
 *
out
,

187 
gíl_öfo
 *
öfo
)

189 
∆©å
 *
tb
[
NL80211_PMSR_PEER_ATTR_MAX
 + 1];

190 
∆©å
 *
ªq
[
NL80211_PMSR_REQ_ATTR_MAX
 + 1];

191 
∆©å
 *
åeq
;

192 
îr
, 
ªm
;

195 
	`∆a_∑r£_√°ed_dïªˇãd
(
tb
, 
NL80211_PMSR_PEER_ATTR_MAX
, 
≥î
,

196 
NULL
, NULL);

198 i‡(!
tb
[
NL80211_PMSR_PEER_ATTR_ADDR
] ||

199 !
tb
[
NL80211_PMSR_PEER_ATTR_CHAN
] ||

200 !
tb
[
NL80211_PMSR_PEER_ATTR_REQ
]) {

201 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
, 
≥î
,

203  -
EINVAL
;

206 
	`mem˝y
(
out
->
addr
, 
	`∆a_d©a
(
tb
[
NL80211_PMSR_PEER_ATTR_ADDR
]), 
ETH_ALEN
);

209 
	`mem£t
(
öfo
->
©ås
, 0, (*öfo->©åsË* (
NL80211_ATTR_MAX
 + 1));

210 
îr
 = 
	`∆a_∑r£_√°ed_dïªˇãd
(
öfo
->
©ås
, 
NL80211_ATTR_MAX
,

211 
tb
[
NL80211_PMSR_PEER_ATTR_CHAN
],

212 
NULL
, 
öfo
->
exèck
);

213 i‡(
îr
)

214  
îr
;

216 
îr
 = 
	`∆80211_∑r£_ch™def
(
rdev
, 
öfo
, &
out
->
ch™def
);

217 i‡(
îr
)

218  
îr
;

221 
	`∆a_∑r£_√°ed_dïªˇãd
(
ªq
, 
NL80211_PMSR_REQ_ATTR_MAX
,

222 
tb
[
NL80211_PMSR_PEER_ATTR_REQ
], 
NULL
,

223 
NULL
);

225 i‡(!
ªq
[
NL80211_PMSR_REQ_ATTR_DATA
]) {

226 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

227 
tb
[
NL80211_PMSR_PEER_ATTR_REQ
],

229  -
EINVAL
;

232 i‡(
ªq
[
NL80211_PMSR_REQ_ATTR_GET_AP_TSF
])

233 
out
->
ªp‹t_≠_tsf
 = 
åue
;

235 i‡(
out
->
ªp‹t_≠_tsf
 && !
rdev
->
wùhy
.
pm§_ˇ∑
->report_ap_tsf) {

236 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

237 
ªq
[
NL80211_PMSR_REQ_ATTR_GET_AP_TSF
],

239  -
EINVAL
;

242 
	`∆a_f‹_óch_√°ed
(
åeq
, 
ªq
[
NL80211_PMSR_REQ_ATTR_DATA
], 
ªm
) {

243 
	`∆a_ty≥
(
åeq
)) {

244 
NL80211_PMSR_TYPE_FTM
:

245 
îr
 = 
	`pm§_∑r£_·m
(
rdev
, 
åeq
, 
out
, 
öfo
);

248 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
, 
åeq
,

250 
îr
 = -
EINVAL
;

254 i‡(
îr
)

255  
îr
;

258 
	}
}

260 
	$∆80211_pm§_°¨t
(
sk_buff
 *
skb
, 
gíl_öfo
 *
öfo
)

262 
∆©å
 *
ªq©å
 = 
öfo
->
©ås
[
NL80211_ATTR_PEER_MEASUREMENTS
];

263 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
öfo
->
u£r_±r
[0];

264 
wúñess_dev
 *
wdev
 = 
öfo
->
u£r_±r
[1];

265 
cfg80211_pm§_ªque°
 *
ªq
;

266 
∆©å
 *
≥îs
, *
≥î
;

267 
cou¡
, 
ªm
, 
îr
, 
idx
;

269 
	`¥_öfo
("[%s] [%d] : ENTRY\n", 
__func__
, 
__LINE__
);

271 i‡(!
rdev
->
wùhy
.
pm§_ˇ∑
) {

272 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

273  -
EOPNOTSUPP
;

276 i‡(!
ªq©å
) {

277 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

278  -
EINVAL
;

281 
≥îs
 = 
	`∆a_föd
(
	`∆a_d©a
(
ªq©å
), 
	`∆a_Àn
(reqattr),

282 
NL80211_PMSR_ATTR_PEERS
);

283 i‡(!
≥îs
) {

284 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

285  -
EINVAL
;

288 
cou¡
 = 0;

289 
	`∆a_f‹_óch_√°ed
(
≥î
, 
≥îs
, 
ªm
) {

290 
cou¡
++;

292 i‡(
cou¡
 > 
rdev
->
wùhy
.
pm§_ˇ∑
->
max_≥îs
) {

293 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
, 
≥î
,

295 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

296  -
EINVAL
;

300 
ªq
 = 
	`kzÆloc
(
	`°ru˘_size
‘eq, 
≥îs
, 
cou¡
), 
GFP_KERNEL
);

301 i‡(!
ªq
) {

302 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

303  -
ENOMEM
;

305 
ªq
->
n_≥îs
 = 
cou¡
;

307 i‡(
öfo
->
©ås
[
NL80211_ATTR_TIMEOUT
])

308 
ªq
->
timeout
 = 
	`∆a_gë_u32
(
öfo
->
©ås
[
NL80211_ATTR_TIMEOUT
]);

310 i‡(
öfo
->
©ås
[
NL80211_ATTR_MAC
]) {

311 i‡(!
rdev
->
wùhy
.
pm§_ˇ∑
->
øndomize_mac_addr
) {

312 
	`NL_SET_ERR_MSG_ATTR
(
öfo
->
exèck
,

313 
öfo
->
©ås
[
NL80211_ATTR_MAC
],

315 
îr
 = -
EINVAL
;

316 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

317 
out_îr
;

320 
îr
 = 
	`∆80211_∑r£_øndom_mac
(
öfo
->
©ås
, 
ªq
->
mac_addr
,

321 
ªq
->
mac_addr_mask
);

322 i‡(
îr
) {

323 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

324 
out_îr
;

327 
	`mem˝y
(
ªq
->
mac_addr
, 
	`wdev_addªss
(
wdev
), 
ETH_ALEN
);

328 
	`ëh_brﬂdˇ°_addr
(
ªq
->
mac_addr_mask
);

331 
idx
 = 0;

332 
	`∆a_f‹_óch_√°ed
(
≥î
, 
≥îs
, 
ªm
) {

334 
îr
 = 
	`pm§_∑r£_≥î
(
rdev
, 
≥î
, &
ªq
->
≥îs
[
idx
], 
öfo
);

335 i‡(
îr
) {

336 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

337 
out_îr
;

339 
idx
++;

341 
ªq
->
cookõ
 = 
	`cfg80211_assign_cookõ
(
rdev
);

342 
ªq
->
∆_p‹tid
 = 
öfo
->
¢d_p‹tid
;

344 
îr
 = 
	`rdev_°¨t_pm§
(
rdev
, 
wdev
, 
ªq
);

345 i‡(
îr
) {

346 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

347 
out_îr
;

350 
	`li°_add_èû
(&
ªq
->
li°
, &
wdev
->
pm§_li°
);

352 
	`∆_£t_exèck_cookõ_u64
(
öfo
->
exèck
, 
ªq
->
cookõ
);

353 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

355 
out_îr
:

356 
	`k‰ì
(
ªq
);

357 
	`¥_öfo
("[%s] [%d] : EXIT\n", 
__func__
, 
__LINE__
);

358  
îr
;

359 
	}
}

361 
	$cfg80211_pm§_com∂ëe
(
wúñess_dev
 *
wdev
,

362 
cfg80211_pm§_ªque°
 *
ªq
,

363 
gÂ_t
 
gÂ
)

365 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

366 
cfg80211_pm§_ªque°
 *
tmp
, *
¥ev
, *
to_‰ì
 = 
NULL
;

367 
sk_buff
 *
msg
;

368 *
hdr
;

370 
	`åa˚_cfg80211_pm§_com∂ëe
(
wdev
->
wùhy
, wdev, 
ªq
->
cookõ
);

372 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

373 i‡(!
msg
)

374 
‰ì_ªque°
;

376 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0,

377 
NL80211_CMD_PEER_MEASUREMENT_COMPLETE
);

378 i‡(!
hdr
)

379 
‰ì_msg
;

381 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

382 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

383 
NL80211_ATTR_PAD
))

384 
‰ì_msg
;

386 i‡(
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
ªq
->
cookõ
,

387 
NL80211_ATTR_PAD
))

388 
‰ì_msg
;

390 
	`gílmsg_íd
(
msg
, 
hdr
);

391 
	`gílmsg_uniˇ°
(
	`wùhy_√t
(
wdev
->
wùhy
), 
msg
, 
ªq
->
∆_p‹tid
);

392 
‰ì_ªque°
;

393 
‰ì_msg
:

394 
	`∆msg_‰ì
(
msg
);

395 
‰ì_ªque°
:

396 
	`•ö_lock_bh
(&
wdev
->
pm§_lock
);

402 
	`li°_f‹_óch_íåy_ß„
(
tmp
, 
¥ev
, &
wdev
->
pm§_li°
, 
li°
) {

403 i‡(
tmp
 =
ªq
) {

404 
	`li°_dñ
(&
ªq
->
li°
);

405 
to_‰ì
 = 
ªq
;

409 
	`•ö_u∆ock_bh
(&
wdev
->
pm§_lock
);

410 
	`k‰ì
(
to_‰ì
);

411 
	}
}

412 
EXPORT_SYMBOL_GPL
(
cfg80211_pm§_com∂ëe
);

414 
	$∆80211_pm§_£nd_·m_ªs
(
sk_buff
 *
msg
,

415 
cfg80211_pm§_ªsu…
 *
ªs
)

417 i‡(
ªs
->
°©us
 =
NL80211_PMSR_STATUS_FAILURE
) {

418 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_PMSR_FTM_RESP_ATTR_FAIL_REASON
,

419 
ªs
->
·m
.
Áûuª_ªas⁄
))

420 
îr‹
;

422 i‡(
ªs
->
·m
.
Áûuª_ªas⁄
 ==

423 
NL80211_PMSR_FTM_FAILURE_PEER_BUSY
 &&

424 
ªs
->
·m
.
busy_ªåy_time
 &&

425 
	`∆a_put_u32
(
msg
, 
NL80211_PMSR_FTM_RESP_ATTR_BUSY_RETRY_TIME
,

426 
ªs
->
·m
.
busy_ªåy_time
))

427 
îr‹
;

432 
	#PUT
(
ç
, 
©å
, 
vÆ
) \

434 i‡(
∆a_put_
##
	`ç
(
msg
, \

435 
NL80211_PMSR_FTM_RESP_ATTR_
##
©å
, \

436 
ªs
->
·m
.
vÆ
)) \

437 
îr‹
; \

438 } 0)

	)

440 
	#PUTOPT
(
ç
, 
©å
, 
vÆ
) \

442 i‡(
ªs
->
·m
.
vÆ
##
_vÆid
) \

443 
	`PUT
(
ç
, 
©å
, 
vÆ
); \

444 } 0)

	)

446 
	#PUT_U64
(
©å
, 
vÆ
) \

448 i‡(
	`∆a_put_u64_64bô
(
msg
, \

449 
NL80211_PMSR_FTM_RESP_ATTR_
##
©å
,\

450 
ªs
->
·m
.
vÆ
, \

451 
NL80211_PMSR_FTM_RESP_ATTR_PAD
)) \

452 
îr‹
; \

453 } 0)

	)

455 
	#PUTOPT_U64
(
©å
, 
vÆ
) \

457 i‡(
ªs
->
·m
.
vÆ
##
_vÆid
) \

458 
	`PUT_U64
(
©å
, 
vÆ
); \

459 } 0)

	)

461 i‡(
ªs
->
·m
.
bur°_ödex
 >= 0)

462 
	`PUT
(
u32
, 
BURST_INDEX
, 
bur°_ödex
);

463 
	`PUTOPT
(
u32
, 
NUM_FTMR_ATTEMPTS
, 
num_·mr_©ãm±s
);

464 
	`PUTOPT
(
u32
, 
NUM_FTMR_SUCCESSES
, 
num_·mr_suc˚s£s
);

465 
	`PUT
(
u8
, 
NUM_BURSTS_EXP
, 
num_bur°s_exp
);

466 
	`PUT
(
u8
, 
BURST_DURATION
, 
bur°_duøti⁄
);

467 
	`PUT
(
u8
, 
FTMS_PER_BURST
, 
·ms_≥r_bur°
);

468 
	`PUTOPT
(
s32
, 
RSSI_AVG
, 
rssi_avg
);

469 
	`PUTOPT
(
s32
, 
RSSI_SPREAD
, 
rssi_•ªad
);

470 i‡(
ªs
->
·m
.
tx_øã_vÆid
 &&

471 !
	`∆80211_put_°a_øã
(
msg
, &
ªs
->
·m
.
tx_øã
,

472 
NL80211_PMSR_FTM_RESP_ATTR_TX_RATE
))

473 
îr‹
;

474 i‡(
ªs
->
·m
.
rx_øã_vÆid
 &&

475 !
	`∆80211_put_°a_øã
(
msg
, &
ªs
->
·m
.
rx_øã
,

476 
NL80211_PMSR_FTM_RESP_ATTR_RX_RATE
))

477 
îr‹
;

478 
	`PUTOPT_U64
(
RTT_AVG
, 
πt_avg
);

479 
	`PUTOPT_U64
(
RTT_VARIANCE
, 
πt_v¨ün˚
);

480 
	`PUTOPT_U64
(
RTT_SPREAD
, 
πt_•ªad
);

481 
	`PUTOPT_U64
(
DIST_AVG
, 
di°_avg
);

482 
	`PUTOPT_U64
(
DIST_VARIANCE
, 
di°_v¨ün˚
);

483 
	`PUTOPT_U64
(
DIST_SPREAD
, 
di°_•ªad
);

484 i‡(
ªs
->
·m
.
lci
 &&Ñes->·m.
lci_Àn
 &&

485 
	`∆a_put
(
msg
, 
NL80211_PMSR_FTM_RESP_ATTR_LCI
,

486 
ªs
->
·m
.
lci_Àn
,Ñes->·m.
lci
))

487 
îr‹
;

488 i‡(
ªs
->
·m
.
civi˛oc
 &&Ñes->·m.
civi˛oc_Àn
 &&

489 
	`∆a_put
(
msg
, 
NL80211_PMSR_FTM_RESP_ATTR_CIVICLOC
,

490 
ªs
->
·m
.
civi˛oc_Àn
,Ñes->·m.
civi˛oc
))

491 
îr‹
;

492 #unde‡
PUT


493 #unde‡
PUTOPT


494 #unde‡
PUT_U64


495 #unde‡
PUTOPT_U64


498 
îr‹
:

499  -
ENOSPC
;

500 
	}
}

502 
	$∆80211_pm§_£nd_ªsu…
(
sk_buff
 *
msg
,

503 
cfg80211_pm§_ªsu…
 *
ªs
)

505 
∆©å
 *
pm§
, *
≥îs
, *
≥î
, *
ª•
, *
d©a
, *
ty≥d©a
;

507 
pm§
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_ATTR_PEER_MEASUREMENTS
);

508 i‡(!
pm§
)

509 
îr‹
;

511 
≥îs
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_PMSR_ATTR_PEERS
);

512 i‡(!
≥îs
)

513 
îr‹
;

515 
≥î
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 1);

516 i‡(!
≥î
)

517 
îr‹
;

519 i‡(
	`∆a_put
(
msg
, 
NL80211_PMSR_PEER_ATTR_ADDR
, 
ETH_ALEN
, 
ªs
->
addr
))

520 
îr‹
;

522 
ª•
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_PMSR_PEER_ATTR_RESP
);

523 i‡(!
ª•
)

524 
îr‹
;

526 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_PMSR_RESP_ATTR_STATUS
, 
ªs
->
°©us
) ||

527 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_PMSR_RESP_ATTR_HOST_TIME
,

528 
ªs
->
ho°_time
, 
NL80211_PMSR_RESP_ATTR_PAD
))

529 
îr‹
;

531 i‡(
ªs
->
≠_tsf_vÆid
 &&

532 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_PMSR_RESP_ATTR_AP_TSF
,

533 
ªs
->
≠_tsf
, 
NL80211_PMSR_RESP_ATTR_PAD
))

534 
îr‹
;

536 i‡(
ªs
->
föÆ
 && 
	`∆a_put_Êag
(
msg
, 
NL80211_PMSR_RESP_ATTR_FINAL
))

537 
îr‹
;

539 
d©a
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
NL80211_PMSR_RESP_ATTR_DATA
);

540 i‡(!
d©a
)

541 
îr‹
;

543 
ty≥d©a
 = 
	`∆a_√°_°¨t_noÊag
(
msg
, 
ªs
->
ty≥
);

544 i‡(!
ty≥d©a
)

545 
îr‹
;

547 
ªs
->
ty≥
) {

548 
NL80211_PMSR_TYPE_FTM
:

549 i‡(
	`∆80211_pm§_£nd_·m_ªs
(
msg
, 
ªs
))

550 
îr‹
;

553 
	`WARN_ON
(1);

556 
	`∆a_√°_íd
(
msg
, 
ty≥d©a
);

557 
	`∆a_√°_íd
(
msg
, 
d©a
);

558 
	`∆a_√°_íd
(
msg
, 
ª•
);

559 
	`∆a_√°_íd
(
msg
, 
≥î
);

560 
	`∆a_√°_íd
(
msg
, 
≥îs
);

561 
	`∆a_√°_íd
(
msg
, 
pm§
);

564 
îr‹
:

565  -
ENOSPC
;

566 
	}
}

568 
	$cfg80211_pm§_ªp‹t
(
wúñess_dev
 *
wdev
,

569 
cfg80211_pm§_ªque°
 *
ªq
,

570 
cfg80211_pm§_ªsu…
 *
ªsu…
,

571 
gÂ_t
 
gÂ
)

573 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

574 
sk_buff
 *
msg
;

575 *
hdr
;

576 
îr
;

578 
	`åa˚_cfg80211_pm§_ªp‹t
(
wdev
->
wùhy
, wdev, 
ªq
->
cookõ
,

579 
ªsu…
->
addr
);

586 
msg
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
gÂ
);

587 i‡(!
msg
)

590 
hdr
 = 
	`∆80211hdr_put
(
msg
, 0, 0, 0, 
NL80211_CMD_PEER_MEASUREMENT_RESULT
);

591 i‡(!
hdr
)

592 
‰ì
;

594 i‡(
	`∆a_put_u32
(
msg
, 
NL80211_ATTR_WIPHY
, 
rdev
->
wùhy_idx
) ||

595 
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_WDEV
, 
	`wdev_id
(
wdev
),

596 
NL80211_ATTR_PAD
))

597 
‰ì
;

599 i‡(
	`∆a_put_u64_64bô
(
msg
, 
NL80211_ATTR_COOKIE
, 
ªq
->
cookõ
,

600 
NL80211_ATTR_PAD
))

601 
‰ì
;

603 
îr
 = 
	`∆80211_pm§_£nd_ªsu…
(
msg
, 
ªsu…
);

604 i‡(
îr
) {

605 
	`¥_îr_øãlimôed
("peer measurementÑesult: message didn't fit!");

606 
‰ì
;

609 
	`gílmsg_íd
(
msg
, 
hdr
);

610 
	`gílmsg_uniˇ°
(
	`wùhy_√t
(
wdev
->
wùhy
), 
msg
, 
ªq
->
∆_p‹tid
);

612 
‰ì
:

613 
	`∆msg_‰ì
(
msg
);

614 
	}
}

615 
EXPORT_SYMBOL_GPL
(
cfg80211_pm§_ªp‹t
);

617 
	$cfg80211_pm§_¥o˚ss_ab‹t
(
wúñess_dev
 *
wdev
)

619 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

620 
cfg80211_pm§_ªque°
 *
ªq
, *
tmp
;

621 
	`LIST_HEAD
(
‰ì_li°
);

623 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

625 
	`•ö_lock_bh
(&
wdev
->
pm§_lock
);

626 
	`li°_f‹_óch_íåy_ß„
(
ªq
, 
tmp
, &
wdev
->
pm§_li°
, 
li°
) {

627 i‡(
ªq
->
∆_p‹tid
)

629 
	`li°_move_èû
(&
ªq
->
li°
, &
‰ì_li°
);

631 
	`•ö_u∆ock_bh
(&
wdev
->
pm§_lock
);

633 
	`li°_f‹_óch_íåy_ß„
(
ªq
, 
tmp
, &
‰ì_li°
, 
li°
) {

634 
	`rdev_ab‹t_pm§
(
rdev
, 
wdev
, 
ªq
);

636 
	`k‰ì
(
ªq
);

638 
	}
}

640 
	$cfg80211_pm§_‰ì_wk
(
w‹k_°ru˘
 *
w‹k
)

642 
wúñess_dev
 *
wdev
 = 
	`c⁄èöî_of
(
w‹k
, wireless_dev,

643 
pm§_‰ì_wk
);

645 
	`wùhy_lock
(
wdev
->
wùhy
);

646 
	`cfg80211_pm§_¥o˚ss_ab‹t
(
wdev
);

647 
	`wùhy_u∆ock
(
wdev
->
wùhy
);

648 
	}
}

650 
	$cfg80211_pm§_wdev_down
(
wúñess_dev
 *
wdev
)

652 
cfg80211_pm§_ªque°
 *
ªq
;

653 
boﬁ
 
found
 = 
Ál£
;

655 
	`•ö_lock_bh
(&
wdev
->
pm§_lock
);

656 
	`li°_f‹_óch_íåy
(
ªq
, &
wdev
->
pm§_li°
, 
li°
) {

657 
found
 = 
åue
;

658 
ªq
->
∆_p‹tid
 = 0;

660 
	`•ö_u∆ock_bh
(&
wdev
->
pm§_lock
);

662 i‡(
found
)

663 
	`cfg80211_pm§_¥o˚ss_ab‹t
(
wdev
);

665 
	`WARN_ON
(!
	`li°_em±y
(&
wdev
->
pm§_li°
));

666 
	}
}

668 
	$cfg80211_ªÀa£_pm§
(
wúñess_dev
 *
wdev
, 
u32
 
p‹tid
)

670 
cfg80211_pm§_ªque°
 *
ªq
;

672 
	`•ö_lock_bh
(&
wdev
->
pm§_lock
);

673 
	`li°_f‹_óch_íåy
(
ªq
, &
wdev
->
pm§_li°
, 
li°
) {

674 i‡(
ªq
->
∆_p‹tid
 =
p‹tid
) {

675 
ªq
->
∆_p‹tid
 = 0;

676 
	`scheduÀ_w‹k
(&
wdev
->
pm§_‰ì_wk
);

679 
	`•ö_u∆ock_bh
(&
wdev
->
pm§_lock
);

680 
	}
}

	@radiotap.c

17 
	~<löux/kî√l.h
>

18 
	~<löux/exp‹t.h
>

19 
	~<√t/cfg80211.h
>

20 
	~<√t/õì80211_ødiŸ≠.h
>

21 
	~<asm/u«lig√d.h
>

25 c⁄° 
ødiŸ≠_Æign_size
 
	gπ≠_«me•a˚_sizes
[] = {

26 [
IEEE80211_RADIOTAP_TSFT
] = { .
Æign
 = 8, .
	gsize
 = 8, },

27 [
IEEE80211_RADIOTAP_FLAGS
] = { .
Æign
 = 1, .
	gsize
 = 1, },

28 [
IEEE80211_RADIOTAP_RATE
] = { .
Æign
 = 1, .
	gsize
 = 1, },

29 [
IEEE80211_RADIOTAP_CHANNEL
] = { .
Æign
 = 2, .
	gsize
 = 4, },

30 [
IEEE80211_RADIOTAP_FHSS
] = { .
Æign
 = 2, .
	gsize
 = 2, },

31 [
IEEE80211_RADIOTAP_DBM_ANTSIGNAL
] = { .
Æign
 = 1, .
	gsize
 = 1, },

32 [
IEEE80211_RADIOTAP_DBM_ANTNOISE
] = { .
Æign
 = 1, .
	gsize
 = 1, },

33 [
IEEE80211_RADIOTAP_LOCK_QUALITY
] = { .
Æign
 = 2, .
	gsize
 = 2, },

34 [
IEEE80211_RADIOTAP_TX_ATTENUATION
] = { .
Æign
 = 2, .
	gsize
 = 2, },

35 [
IEEE80211_RADIOTAP_DB_TX_ATTENUATION
] = { .
Æign
 = 2, .
	gsize
 = 2, },

36 [
IEEE80211_RADIOTAP_DBM_TX_POWER
] = { .
Æign
 = 1, .
	gsize
 = 1, },

37 [
IEEE80211_RADIOTAP_ANTENNA
] = { .
Æign
 = 1, .
	gsize
 = 1, },

38 [
IEEE80211_RADIOTAP_DB_ANTSIGNAL
] = { .
Æign
 = 1, .
	gsize
 = 1, },

39 [
IEEE80211_RADIOTAP_DB_ANTNOISE
] = { .
Æign
 = 1, .
	gsize
 = 1, },

40 [
IEEE80211_RADIOTAP_RX_FLAGS
] = { .
Æign
 = 2, .
	gsize
 = 2, },

41 [
IEEE80211_RADIOTAP_TX_FLAGS
] = { .
Æign
 = 2, .
	gsize
 = 2, },

42 [
IEEE80211_RADIOTAP_RTS_RETRIES
] = { .
Æign
 = 1, .
	gsize
 = 1, },

43 [
IEEE80211_RADIOTAP_DATA_RETRIES
] = { .
Æign
 = 1, .
	gsize
 = 1, },

44 [
IEEE80211_RADIOTAP_MCS
] = { .
Æign
 = 1, .
	gsize
 = 3, },

45 [
IEEE80211_RADIOTAP_AMPDU_STATUS
] = { .
Æign
 = 4, .
	gsize
 = 8, },

46 [
IEEE80211_RADIOTAP_VHT
] = { .
Æign
 = 2, .
	gsize
 = 12, },

52 c⁄° 
õì80211_ødiŸ≠_«me•a˚
 
	gødiŸ≠_ns
 = {

53 .
n_bôs
 = 
ARRAY_SIZE
(
π≠_«me•a˚_sizes
),

54 .
	gÆign_size
 = 
π≠_«me•a˚_sizes
,

97 
	$õì80211_ødiŸ≠_ôî©‹_öô
(

98 
õì80211_ødiŸ≠_ôî©‹
 *
ôî©‹
,

99 
õì80211_ødiŸ≠_hódî
 *
ødiŸ≠_hódî
,

100 
max_Àngth
, c⁄° 
õì80211_ødiŸ≠_víd‹_«me•a˚s
 *
vns
)

103 i‡(
max_Àngth
 < (
õì80211_ødiŸ≠_hódî
))

104  -
EINVAL
;

107 i‡(
ødiŸ≠_hódî
->
ô_vîsi⁄
)

108  -
EINVAL
;

111 i‡(
max_Àngth
 < 
	`gë_u«lig√d_À16
(&
ødiŸ≠_hódî
->
ô_Àn
))

112  -
EINVAL
;

114 
ôî©‹
->
_πhódî
 = 
ødiŸ≠_hódî
;

115 
ôî©‹
->
_max_Àngth
 = 
	`gë_u«lig√d_À16
(&
ødiŸ≠_hódî
->
ô_Àn
);

116 
ôî©‹
->
_¨g_ödex
 = 0;

117 
ôî©‹
->
_bôm≠_shi·î
 = 
	`gë_u«lig√d_À32
(&
ødiŸ≠_hódî
->
ô_¥e£¡
);

118 
ôî©‹
->
_¨g
 = (
uöt8_t
 *)
ødiŸ≠_hódî
->
ô_›ti⁄Æ
;

119 
ôî©‹
->
_ª£t_⁄_ext
 = 0;

120 
ôî©‹
->
_√xt_bôm≠
 = 
ødiŸ≠_hódî
->
ô_›ti⁄Æ
;

121 
ôî©‹
->
_vns
 = 
vns
;

122 
ôî©‹
->
cuºít_«me•a˚
 = &
ødiŸ≠_ns
;

123 
ôî©‹
->
is_ødiŸ≠_ns
 = 1;

127 i‡(
ôî©‹
->
_bôm≠_shi·î
 & (
	`BIT
(
IEEE80211_RADIOTAP_EXT
))) {

128 i‡(()
ôî©‹
->
_¨g
 -

129 ()
ôî©‹
->
_πhódî
 + (
uöt32_t
) >

130 ()
ôî©‹
->
_max_Àngth
)

131  -
EINVAL
;

132 
	`gë_u«lig√d_À32
(
ôî©‹
->
_¨g
) &

133 (
	`BIT
(
IEEE80211_RADIOTAP_EXT
))) {

134 
ôî©‹
->
_¨g
 +(
uöt32_t
);

142 i‡(()
ôî©‹
->
_¨g
 -

143 ()
ôî©‹
->
_πhódî
 +

144 (
uöt32_t
) >

145 ()
ôî©‹
->
_max_Àngth
)

146  -
EINVAL
;

149 
ôî©‹
->
_¨g
 +(
uöt32_t
);

158 
ôî©‹
->
this_¨g
 = iãøt‹->
_¨g
;

163 
	}
}

164 
EXPORT_SYMBOL
(
õì80211_ødiŸ≠_ôî©‹_öô
);

166 
	$föd_ns
(
õì80211_ødiŸ≠_ôî©‹
 *
ôî©‹
,

167 
uöt32_t
 
oui
, 
uöt8_t
 
subns
)

169 
i
;

171 
ôî©‹
->
cuºít_«me•a˚
 = 
NULL
;

173 i‡(!
ôî©‹
->
_vns
)

176 
i
 = 0; i < 
ôî©‹
->
_vns
->
n_ns
; i++) {

177 i‡(
ôî©‹
->
_vns
->
ns
[
i
].
oui
 != oui)

179 i‡(
ôî©‹
->
_vns
->
ns
[
i
].
subns
 != subns)

182 
ôî©‹
->
cuºít_«me•a˚
 = &ôî©‹->
_vns
->
ns
[
i
];

185 
	}
}

212 
	$õì80211_ødiŸ≠_ôî©‹_√xt
(

213 
õì80211_ødiŸ≠_ôî©‹
 *
ôî©‹
)

216 
hô
 = 0;

217 
∑d
, 
Æign
, 
size
, 
subns
;

218 
uöt32_t
 
oui
;

221 i‡((
ôî©‹
->
_¨g_ödex
 % 32Ë=
IEEE80211_RADIOTAP_EXT
 &&

222 !(
ôî©‹
->
_bôm≠_shi·î
 & 1))

223  -
ENOENT
;

225 i‡(!(
ôî©‹
->
_bôm≠_shi·î
 & 1))

226 
√xt_íåy
;

229 
ôî©‹
->
_¨g_ödex
 % 32) {

230 
IEEE80211_RADIOTAP_RADIOTAP_NAMESPACE
:

231 
IEEE80211_RADIOTAP_EXT
:

232 
Æign
 = 1;

233 
size
 = 0;

235 
IEEE80211_RADIOTAP_VENDOR_NAMESPACE
:

236 
Æign
 = 2;

237 
size
 = 6;

240 i‡(!
ôî©‹
->
cuºít_«me•a˚
 ||

241 
ôî©‹
->
_¨g_ödex
 >ôî©‹->
cuºít_«me•a˚
->
n_bôs
) {

242 i‡(
ôî©‹
->
cuºít_«me•a˚
 =&
ødiŸ≠_ns
)

243  -
ENOENT
;

244 
Æign
 = 0;

246 
Æign
 = 
ôî©‹
->
cuºít_«me•a˚
->
Æign_size
[ôî©‹->
_¨g_ödex
].align;

247 
size
 = 
ôî©‹
->
cuºít_«me•a˚
->
Æign_size
[ôî©‹->
_¨g_ödex
].size;

249 i‡(!
Æign
) {

251 
ôî©‹
->
_¨g
 = iãøt‹->
_√xt_ns_d©a
;

253 
ôî©‹
->
cuºít_«me•a˚
 = 
NULL
;

254 
√xt_íåy
;

271 
∑d
 = (()
ôî©‹
->
_¨g
 -

272 ()
ôî©‹
->
_πhódî
Ë& (
Æign
 - 1);

274 i‡(
∑d
)

275 
ôî©‹
->
_¨g
 +
Æign
 - 
∑d
;

277 i‡(
ôî©‹
->
_¨g_ödex
 % 32 =
IEEE80211_RADIOTAP_VENDOR_NAMESPACE
) {

278 
vn¶í
;

280 i‡(()
ôî©‹
->
_¨g
 + 
size
 -

281 ()
ôî©‹
->
_πhódî
 >

282 ()
ôî©‹
->
_max_Àngth
)

283  -
EINVAL
;

285 
oui
 = (*
ôî©‹
->
_¨g
 << 16) |

286 (*(
ôî©‹
->
_¨g
 + 1) << 8) |

287 *(
ôî©‹
->
_¨g
 + 2);

288 
subns
 = *(
ôî©‹
->
_¨g
 + 3);

290 
	`föd_ns
(
ôî©‹
, 
oui
, 
subns
);

292 
vn¶í
 = 
	`gë_u«lig√d_À16
(
ôî©‹
->
_¨g
 + 4);

293 
ôî©‹
->
_√xt_ns_d©a
 = iãøt‹->
_¨g
 + 
size
 + 
vn¶í
;

294 i‡(!
ôî©‹
->
cuºít_«me•a˚
)

295 
size
 +
vn¶í
;

302 
ôî©‹
->
this_¨g_ödex
 = iãøt‹->
_¨g_ödex
;

303 
ôî©‹
->
this_¨g
 = iãøt‹->
_¨g
;

304 
ôî©‹
->
this_¨g_size
 = 
size
;

307 
ôî©‹
->
_¨g
 +
size
;

316 i‡(()
ôî©‹
->
_¨g
 -

317 ()
ôî©‹
->
_πhódî
 >

318 ()
ôî©‹
->
_max_Àngth
)

319  -
EINVAL
;

322 
ôî©‹
->
_¨g_ödex
 % 32) {

323 
IEEE80211_RADIOTAP_VENDOR_NAMESPACE
:

324 
ôî©‹
->
_ª£t_⁄_ext
 = 1;

326 
ôî©‹
->
is_ødiŸ≠_ns
 = 0;

333 
ôî©‹
->
this_¨g_ödex
 =

334 
IEEE80211_RADIOTAP_VENDOR_NAMESPACE
;

335 i‡(!
ôî©‹
->
cuºít_«me•a˚
)

336 
hô
 = 1;

337 
√xt_íåy
;

338 
IEEE80211_RADIOTAP_RADIOTAP_NAMESPACE
:

339 
ôî©‹
->
_ª£t_⁄_ext
 = 1;

340 
ôî©‹
->
cuºít_«me•a˚
 = &
ødiŸ≠_ns
;

341 
ôî©‹
->
is_ødiŸ≠_ns
 = 1;

342 
√xt_íåy
;

343 
IEEE80211_RADIOTAP_EXT
:

348 
ôî©‹
->
_bôm≠_shi·î
 =

349 
	`gë_u«lig√d_À32
(
ôî©‹
->
_√xt_bôm≠
);

350 
ôî©‹
->
_√xt_bôm≠
++;

351 i‡(
ôî©‹
->
_ª£t_⁄_ext
)

352 
ôî©‹
->
_¨g_ödex
 = 0;

354 
ôî©‹
->
_¨g_ödex
++;

355 
ôî©‹
->
_ª£t_⁄_ext
 = 0;

359 
hô
 = 1;

360 
√xt_íåy
:

361 
ôî©‹
->
_bôm≠_shi·î
 >>= 1;

362 
ôî©‹
->
_¨g_ödex
++;

366 i‡(
hô
)

369 
	}
}

370 
EXPORT_SYMBOL
(
õì80211_ødiŸ≠_ôî©‹_√xt
);

	@rdev-ops.h

7 #i‚de‡
__CFG80211_RDEV_OPS


8 
	#__CFG80211_RDEV_OPS


	)

10 
	~<löux/π√éök.h
>

11 
	~<√t/cfg80211.h
>

12 
	~"c‹e.h
"

13 
	~"åa˚.h
"

15 
ölöe
 
	$rdev_su•íd
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

16 
cfg80211_wowœn
 *
wowœn
)

18 
ªt
;

19 
	`åa˚_rdev_su•íd
(&
rdev
->
wùhy
, 
wowœn
);

20 
ªt
 = 
rdev
->
›s
->
	`su•íd
(&rdev->
wùhy
, 
wowœn
);

21 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

22  
ªt
;

23 
	}
}

25 
ölöe
 
	$rdev_ªsume
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

27 
ªt
;

28 
	`åa˚_rdev_ªsume
(&
rdev
->
wùhy
);

29 
ªt
 = 
rdev
->
›s
->
	`ªsume
(&rdev->
wùhy
);

30 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

31  
ªt
;

32 
	}
}

34 
ölöe
 
	$rdev_£t_wakeup
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

35 
boﬁ
 
íabÀd
)

37 
	`åa˚_rdev_£t_wakeup
(&
rdev
->
wùhy
, 
íabÀd
);

38 
rdev
->
›s
->
	`£t_wakeup
(&rdev->
wùhy
, 
íabÀd
);

39 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

40 
	}
}

42 
ölöe
 
wúñess_dev


43 *
	$rdev_add_vútuÆ_ötf
(
cfg80211_ªgi°îed_devi˚
 *
rdev
, *
«me
,

44 
«me_assign_ty≥
,

45 
∆80211_i·y≥
 
ty≥
,

46 
vif_∑øms
 *
∑øms
)

48 
wúñess_dev
 *
ªt
;

49 
	`åa˚_rdev_add_vútuÆ_ötf
(&
rdev
->
wùhy
, 
«me
, 
ty≥
);

50 
ªt
 = 
rdev
->
›s
->
	`add_vútuÆ_ötf
(&rdev->
wùhy
, 
«me
, 
«me_assign_ty≥
,

51 
ty≥
, 
∑øms
);

52 
	`åa˚_rdev_ªtu∫_wdev
(&
rdev
->
wùhy
, 
ªt
);

53  
ªt
;

54 
	}
}

56 
ölöe
 

57 
	$rdev_dñ_vútuÆ_ötf
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

58 
wúñess_dev
 *
wdev
)

60 
ªt
;

61 
	`åa˚_rdev_dñ_vútuÆ_ötf
(&
rdev
->
wùhy
, 
wdev
);

62 
ªt
 = 
rdev
->
›s
->
	`dñ_vútuÆ_ötf
(&rdev->
wùhy
, 
wdev
);

63 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

64  
ªt
;

65 
	}
}

67 
ölöe
 

68 
	$rdev_ch™ge_vútuÆ_ötf
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

69 
√t_devi˚
 *
dev
, 
∆80211_i·y≥
 
ty≥
,

70 
vif_∑øms
 *
∑øms
)

72 
ªt
;

73 
	`åa˚_rdev_ch™ge_vútuÆ_ötf
(&
rdev
->
wùhy
, 
dev
, 
ty≥
);

74 
ªt
 = 
rdev
->
›s
->
	`ch™ge_vútuÆ_ötf
(&rdev->
wùhy
, 
dev
, 
ty≥
, 
∑øms
);

75 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

76  
ªt
;

77 
	}
}

79 
ölöe
 
	$rdev_add_key
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

80 
√t_devi˚
 *
√tdev
, 
lök_id
,

81 
u8
 
key_ödex
, 
boﬁ
 
∑úwi£
, c⁄° u8 *
mac_addr
,

82 
key_∑øms
 *
∑øms
)

84 
ªt
;

85 
	`åa˚_rdev_add_key
(&
rdev
->
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
, 
∑úwi£
,

86 
mac_addr
, 
∑øms
->
mode
);

87 
ªt
 = 
rdev
->
›s
->
	`add_key
(&rdev->
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
,

88 
∑úwi£
, 
mac_addr
, 
∑øms
);

89 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

90  
ªt
;

91 
	}
}

93 
ölöe
 

94 
	$rdev_gë_key
(
cfg80211_ªgi°îed_devi˚
 *
rdev
, 
√t_devi˚
 *
√tdev
,

95 
lök_id
, 
u8
 
key_ödex
, 
boﬁ
 
∑úwi£
, c⁄° u8 *
mac_addr
,

96 *
cookõ
,

97 (*
ˇŒback
)(*
cookõ
, 
key_∑øms
*))

99 
ªt
;

100 
	`åa˚_rdev_gë_key
(&
rdev
->
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
, 
∑úwi£
,

101 
mac_addr
);

102 
ªt
 = 
rdev
->
›s
->
	`gë_key
(&rdev->
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
,

103 
∑úwi£
, 
mac_addr
, 
cookõ
, 
ˇŒback
);

104 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

105  
ªt
;

106 
	}
}

108 
ölöe
 
	$rdev_dñ_key
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

109 
√t_devi˚
 *
√tdev
, 
lök_id
,

110 
u8
 
key_ödex
, 
boﬁ
 
∑úwi£
, c⁄° u8 *
mac_addr
)

112 
ªt
;

113 
	`åa˚_rdev_dñ_key
(&
rdev
->
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
, 
∑úwi£
,

114 
mac_addr
);

115 
ªt
 = 
rdev
->
›s
->
	`dñ_key
(&rdev->
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
,

116 
∑úwi£
, 
mac_addr
);

117 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

118  
ªt
;

119 
	}
}

121 
ölöe
 

122 
	$rdev_£t_deÁu…_key
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

123 
√t_devi˚
 *
√tdev
, 
lök_id
, 
u8
 
key_ödex
,

124 
boﬁ
 
uniˇ°
, boﬁ 
mu…iˇ°
)

126 
ªt
;

127 
	`åa˚_rdev_£t_deÁu…_key
(&
rdev
->
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
,

128 
uniˇ°
, 
mu…iˇ°
);

129 
ªt
 = 
rdev
->
›s
->
	`£t_deÁu…_key
(&rdev->
wùhy
, 
√tdev
, 
lök_id
,

130 
key_ödex
, 
uniˇ°
, 
mu…iˇ°
);

131 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

132  
ªt
;

133 
	}
}

135 
ölöe
 

136 
	$rdev_£t_deÁu…_mgmt_key
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

137 
√t_devi˚
 *
√tdev
, 
lök_id
, 
u8
 
key_ödex
)

139 
ªt
;

140 
	`åa˚_rdev_£t_deÁu…_mgmt_key
(&
rdev
->
wùhy
, 
√tdev
, 
lök_id
,

141 
key_ödex
);

142 
ªt
 = 
rdev
->
›s
->
	`£t_deÁu…_mgmt_key
(&rdev->
wùhy
, 
√tdev
, 
lök_id
,

143 
key_ödex
);

144 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

145  
ªt
;

146 
	}
}

148 
ölöe
 

149 
	$rdev_£t_deÁu…_bóc⁄_key
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

150 
√t_devi˚
 *
√tdev
, 
lök_id
,

151 
u8
 
key_ödex
)

153 
ªt
;

155 
	`åa˚_rdev_£t_deÁu…_bóc⁄_key
(&
rdev
->
wùhy
, 
√tdev
, 
lök_id
,

156 
key_ödex
);

157 
ªt
 = 
rdev
->
›s
->
	`£t_deÁu…_bóc⁄_key
(&rdev->
wùhy
, 
√tdev
, 
lök_id
,

158 
key_ödex
);

159 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

160  
ªt
;

161 
	}
}

163 
ölöe
 
	$rdev_°¨t_≠
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

164 
√t_devi˚
 *
dev
,

165 
cfg80211_≠_£âögs
 *
£âögs
)

167 
ªt
;

168 
	`åa˚_rdev_°¨t_≠
(&
rdev
->
wùhy
, 
dev
, 
£âögs
);

169 
ªt
 = 
rdev
->
›s
->
	`°¨t_≠
(&rdev->
wùhy
, 
dev
, 
£âögs
);

170 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

171  
ªt
;

172 
	}
}

174 
ölöe
 
	$rdev_ch™ge_bóc⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

175 
√t_devi˚
 *
dev
,

176 
cfg80211_≠_upd©e
 *
öfo
)

178 
ªt
;

179 
	`åa˚_rdev_ch™ge_bóc⁄
(&
rdev
->
wùhy
, 
dev
, 
öfo
);

180 
ªt
 = 
rdev
->
›s
->
	`ch™ge_bóc⁄
(&rdev->
wùhy
, 
dev
, 
öfo
);

181 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

182  
ªt
;

183 
	}
}

185 
ölöe
 
	$rdev_°›_≠
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

186 
√t_devi˚
 *
dev
, 
lök_id
)

188 
ªt
;

189 
	`åa˚_rdev_°›_≠
(&
rdev
->
wùhy
, 
dev
, 
lök_id
);

190 
ªt
 = 
rdev
->
›s
->
	`°›_≠
(&rdev->
wùhy
, 
dev
, 
lök_id
);

191 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

192  
ªt
;

193 
	}
}

195 
ölöe
 
	$rdev_add_°©i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

196 
√t_devi˚
 *
dev
, 
u8
 *
mac
,

197 
°©i⁄_∑ømëîs
 *
∑øms
)

199 
ªt
;

200 
	`åa˚_rdev_add_°©i⁄
(&
rdev
->
wùhy
, 
dev
, 
mac
, 
∑øms
);

201 
ªt
 = 
rdev
->
›s
->
	`add_°©i⁄
(&rdev->
wùhy
, 
dev
, 
mac
, 
∑øms
);

202 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

203  
ªt
;

204 
	}
}

206 
ölöe
 
	$rdev_dñ_°©i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

207 
√t_devi˚
 *
dev
,

208 
°©i⁄_dñ_∑ømëîs
 *
∑øms
)

210 
ªt
;

211 
	`åa˚_rdev_dñ_°©i⁄
(&
rdev
->
wùhy
, 
dev
, 
∑øms
);

212 
ªt
 = 
rdev
->
›s
->
	`dñ_°©i⁄
(&rdev->
wùhy
, 
dev
, 
∑øms
);

213 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

214  
ªt
;

215 
	}
}

217 
ölöe
 
	$rdev_ch™ge_°©i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

218 
√t_devi˚
 *
dev
, 
u8
 *
mac
,

219 
°©i⁄_∑ømëîs
 *
∑øms
)

221 
ªt
;

222 
	`åa˚_rdev_ch™ge_°©i⁄
(&
rdev
->
wùhy
, 
dev
, 
mac
, 
∑øms
);

223 
ªt
 = 
rdev
->
›s
->
	`ch™ge_°©i⁄
(&rdev->
wùhy
, 
dev
, 
mac
, 
∑øms
);

224 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

225  
ªt
;

226 
	}
}

228 
ölöe
 
	$rdev_gë_°©i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

229 
√t_devi˚
 *
dev
, c⁄° 
u8
 *
mac
,

230 
°©i⁄_öfo
 *
söfo
)

232 
ªt
;

233 
	`åa˚_rdev_gë_°©i⁄
(&
rdev
->
wùhy
, 
dev
, 
mac
);

234 
ªt
 = 
rdev
->
›s
->
	`gë_°©i⁄
(&rdev->
wùhy
, 
dev
, 
mac
, 
söfo
);

235 
	`åa˚_rdev_ªtu∫_öt_°©i⁄_öfo
(&
rdev
->
wùhy
, 
ªt
, 
söfo
);

236  
ªt
;

237 
	}
}

239 
ölöe
 
	$rdev_dump_°©i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

240 
√t_devi˚
 *
dev
, 
idx
, 
u8
 *
mac
,

241 
°©i⁄_öfo
 *
söfo
)

243 
ªt
;

244 
	`åa˚_rdev_dump_°©i⁄
(&
rdev
->
wùhy
, 
dev
, 
idx
, 
mac
);

245 
ªt
 = 
rdev
->
›s
->
	`dump_°©i⁄
(&rdev->
wùhy
, 
dev
, 
idx
, 
mac
, 
söfo
);

246 
	`åa˚_rdev_ªtu∫_öt_°©i⁄_öfo
(&
rdev
->
wùhy
, 
ªt
, 
söfo
);

247  
ªt
;

248 
	}
}

250 
ölöe
 
	$rdev_add_m∑th
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

251 
√t_devi˚
 *
dev
, 
u8
 *
d°
, u8 *
√xt_h›
)

253 
ªt
;

254 
	`åa˚_rdev_add_m∑th
(&
rdev
->
wùhy
, 
dev
, 
d°
, 
√xt_h›
);

255 
ªt
 = 
rdev
->
›s
->
	`add_m∑th
(&rdev->
wùhy
, 
dev
, 
d°
, 
√xt_h›
);

256 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

257  
ªt
;

258 
	}
}

260 
ölöe
 
	$rdev_dñ_m∑th
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

261 
√t_devi˚
 *
dev
, 
u8
 *
d°
)

263 
ªt
;

264 
	`åa˚_rdev_dñ_m∑th
(&
rdev
->
wùhy
, 
dev
, 
d°
);

265 
ªt
 = 
rdev
->
›s
->
	`dñ_m∑th
(&rdev->
wùhy
, 
dev
, 
d°
);

266 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

267  
ªt
;

268 
	}
}

270 
ölöe
 
	$rdev_ch™ge_m∑th
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

271 
√t_devi˚
 *
dev
, 
u8
 *
d°
,

272 
u8
 *
√xt_h›
)

274 
ªt
;

275 
	`åa˚_rdev_ch™ge_m∑th
(&
rdev
->
wùhy
, 
dev
, 
d°
, 
√xt_h›
);

276 
ªt
 = 
rdev
->
›s
->
	`ch™ge_m∑th
(&rdev->
wùhy
, 
dev
, 
d°
, 
√xt_h›
);

277 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

278  
ªt
;

279 
	}
}

281 
ölöe
 
	$rdev_gë_m∑th
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

282 
√t_devi˚
 *
dev
, 
u8
 *
d°
, u8 *
√xt_h›
,

283 
m∑th_öfo
 *
pöfo
)

285 
ªt
;

286 
	`åa˚_rdev_gë_m∑th
(&
rdev
->
wùhy
, 
dev
, 
d°
, 
√xt_h›
);

287 
ªt
 = 
rdev
->
›s
->
	`gë_m∑th
(&rdev->
wùhy
, 
dev
, 
d°
, 
√xt_h›
, 
pöfo
);

288 
	`åa˚_rdev_ªtu∫_öt_m∑th_öfo
(&
rdev
->
wùhy
, 
ªt
, 
pöfo
);

289  
ªt
;

291 
	}
}

293 
ölöe
 
	$rdev_gë_mµ
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

294 
√t_devi˚
 *
dev
, 
u8
 *
d°
, u8 *
mµ
,

295 
m∑th_öfo
 *
pöfo
)

297 
ªt
;

299 
	`åa˚_rdev_gë_mµ
(&
rdev
->
wùhy
, 
dev
, 
d°
, 
mµ
);

300 
ªt
 = 
rdev
->
›s
->
	`gë_mµ
(&rdev->
wùhy
, 
dev
, 
d°
, 
mµ
, 
pöfo
);

301 
	`åa˚_rdev_ªtu∫_öt_m∑th_öfo
(&
rdev
->
wùhy
, 
ªt
, 
pöfo
);

302  
ªt
;

303 
	}
}

305 
ölöe
 
	$rdev_dump_m∑th
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

306 
√t_devi˚
 *
dev
, 
idx
, 
u8
 *
d°
,

307 
u8
 *
√xt_h›
, 
m∑th_öfo
 *
pöfo
)

310 
ªt
;

311 
	`åa˚_rdev_dump_m∑th
(&
rdev
->
wùhy
, 
dev
, 
idx
, 
d°
, 
√xt_h›
);

312 
ªt
 = 
rdev
->
›s
->
	`dump_m∑th
(&rdev->
wùhy
, 
dev
, 
idx
, 
d°
, 
√xt_h›
,

313 
pöfo
);

314 
	`åa˚_rdev_ªtu∫_öt_m∑th_öfo
(&
rdev
->
wùhy
, 
ªt
, 
pöfo
);

315  
ªt
;

316 
	}
}

318 
ölöe
 
	$rdev_dump_mµ
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

319 
√t_devi˚
 *
dev
, 
idx
, 
u8
 *
d°
,

320 
u8
 *
mµ
, 
m∑th_öfo
 *
pöfo
)

323 
ªt
;

325 
	`åa˚_rdev_dump_mµ
(&
rdev
->
wùhy
, 
dev
, 
idx
, 
d°
, 
mµ
);

326 
ªt
 = 
rdev
->
›s
->
	`dump_mµ
(&rdev->
wùhy
, 
dev
, 
idx
, 
d°
, 
mµ
, 
pöfo
);

327 
	`åa˚_rdev_ªtu∫_öt_m∑th_öfo
(&
rdev
->
wùhy
, 
ªt
, 
pöfo
);

328  
ªt
;

329 
	}
}

331 
ölöe
 

332 
	$rdev_gë_mesh_c⁄fig
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

333 
√t_devi˚
 *
dev
, 
mesh_c⁄fig
 *
c⁄f
)

335 
ªt
;

336 
	`åa˚_rdev_gë_mesh_c⁄fig
(&
rdev
->
wùhy
, 
dev
);

337 
ªt
 = 
rdev
->
›s
->
	`gë_mesh_c⁄fig
(&rdev->
wùhy
, 
dev
, 
c⁄f
);

338 
	`åa˚_rdev_ªtu∫_öt_mesh_c⁄fig
(&
rdev
->
wùhy
, 
ªt
, 
c⁄f
);

339  
ªt
;

340 
	}
}

342 
ölöe
 

343 
	$rdev_upd©e_mesh_c⁄fig
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

344 
√t_devi˚
 *
dev
, 
u32
 
mask
,

345 c⁄° 
mesh_c⁄fig
 *
nc⁄f
)

347 
ªt
;

348 
	`åa˚_rdev_upd©e_mesh_c⁄fig
(&
rdev
->
wùhy
, 
dev
, 
mask
, 
nc⁄f
);

349 
ªt
 = 
rdev
->
›s
->
	`upd©e_mesh_c⁄fig
(&rdev->
wùhy
, 
dev
, 
mask
, 
nc⁄f
);

350 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

351  
ªt
;

352 
	}
}

354 
ölöe
 
	$rdev_joö_mesh
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

355 
√t_devi˚
 *
dev
,

356 c⁄° 
mesh_c⁄fig
 *
c⁄f
,

357 c⁄° 
mesh_£tup
 *
£tup
)

359 
ªt
;

360 
	`åa˚_rdev_joö_mesh
(&
rdev
->
wùhy
, 
dev
, 
c⁄f
, 
£tup
);

361 
ªt
 = 
rdev
->
›s
->
	`joö_mesh
(&rdev->
wùhy
, 
dev
, 
c⁄f
, 
£tup
);

362 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

363  
ªt
;

364 
	}
}

367 
ölöe
 
	$rdev_Àave_mesh
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

368 
√t_devi˚
 *
dev
)

370 
ªt
;

371 
	`åa˚_rdev_Àave_mesh
(&
rdev
->
wùhy
, 
dev
);

372 
ªt
 = 
rdev
->
›s
->
	`Àave_mesh
(&rdev->
wùhy
, 
dev
);

373 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

374  
ªt
;

375 
	}
}

377 
ölöe
 
	$rdev_joö_ocb
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

378 
√t_devi˚
 *
dev
,

379 
ocb_£tup
 *
£tup
)

381 
ªt
;

382 
	`åa˚_rdev_joö_ocb
(&
rdev
->
wùhy
, 
dev
, 
£tup
);

383 
ªt
 = 
rdev
->
›s
->
	`joö_ocb
(&rdev->
wùhy
, 
dev
, 
£tup
);

384 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

385  
ªt
;

386 
	}
}

388 
ölöe
 
	$rdev_Àave_ocb
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

389 
√t_devi˚
 *
dev
)

391 
ªt
;

392 
	`åa˚_rdev_Àave_ocb
(&
rdev
->
wùhy
, 
dev
);

393 
ªt
 = 
rdev
->
›s
->
	`Àave_ocb
(&rdev->
wùhy
, 
dev
);

394 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

395  
ªt
;

396 
	}
}

398 
ölöe
 
	$rdev_ch™ge_bss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

399 
√t_devi˚
 *
dev
,

400 
bss_∑ømëîs
 *
∑øms
)

403 
ªt
;

404 
	`åa˚_rdev_ch™ge_bss
(&
rdev
->
wùhy
, 
dev
, 
∑øms
);

405 
ªt
 = 
rdev
->
›s
->
	`ch™ge_bss
(&rdev->
wùhy
, 
dev
, 
∑øms
);

406 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

407  
ªt
;

408 
	}
}

410 
ölöe
 
	$rdev_öf‹m_bss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

411 
cfg80211_bss
 *
bss
,

412 c⁄° 
cfg80211_bss_õs
 *
õs
,

413 *
drv_d©a
)

416 
	`åa˚_rdev_öf‹m_bss
(&
rdev
->
wùhy
, 
bss
);

417 i‡(
rdev
->
›s
->
öf‹m_bss
)

418 
rdev
->
›s
->
	`öf‹m_bss
(&rdev->
wùhy
, 
bss
, 
õs
, 
drv_d©a
);

419 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

420 
	}
}

422 
ölöe
 
	$rdev_£t_txq_∑øms
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

423 
√t_devi˚
 *
dev
,

424 
õì80211_txq_∑øms
 *
∑øms
)

427 
ªt
;

428 
	`åa˚_rdev_£t_txq_∑øms
(&
rdev
->
wùhy
, 
dev
, 
∑øms
);

429 
ªt
 = 
rdev
->
›s
->
	`£t_txq_∑øms
(&rdev->
wùhy
, 
dev
, 
∑øms
);

430 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

431  
ªt
;

432 
	}
}

434 
ölöe
 

435 
	$rdev_libîès_£t_mesh_ch™√l
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

436 
√t_devi˚
 *
dev
,

437 
õì80211_ch™√l
 *
ch™
)

439 
ªt
;

440 
	`åa˚_rdev_libîès_£t_mesh_ch™√l
(&
rdev
->
wùhy
, 
dev
, 
ch™
);

441 
ªt
 = 
rdev
->
›s
->
	`libîès_£t_mesh_ch™√l
(&rdev->
wùhy
, 
dev
, 
ch™
);

442 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

443  
ªt
;

444 
	}
}

446 
ölöe
 

447 
	$rdev_£t_m⁄ô‹_ch™√l
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

448 
cfg80211_ch™_def
 *
ch™def
)

450 
ªt
;

451 
	`åa˚_rdev_£t_m⁄ô‹_ch™√l
(&
rdev
->
wùhy
, 
ch™def
);

452 
ªt
 = 
rdev
->
›s
->
	`£t_m⁄ô‹_ch™√l
(&rdev->
wùhy
, 
ch™def
);

453 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

454  
ªt
;

455 
	}
}

457 
ölöe
 
	$rdev_sˇn
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

458 
cfg80211_sˇn_ªque°
 *
ªque°
)

460 
ªt
;

461 
	`åa˚_rdev_sˇn
(&
rdev
->
wùhy
, 
ªque°
);

462 
ªt
 = 
rdev
->
›s
->
	`sˇn
(&rdev->
wùhy
, 
ªque°
);

463 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

464  
ªt
;

465 
	}
}

467 
ölöe
 
	$rdev_ab‹t_sˇn
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

468 
wúñess_dev
 *
wdev
)

470 
	`åa˚_rdev_ab‹t_sˇn
(&
rdev
->
wùhy
, 
wdev
);

471 
rdev
->
›s
->
	`ab‹t_sˇn
(&rdev->
wùhy
, 
wdev
);

472 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

473 
	}
}

475 
ölöe
 
	$rdev_auth
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

476 
√t_devi˚
 *
dev
,

477 
cfg80211_auth_ªque°
 *
ªq
)

479 
ªt
;

480 
	`åa˚_rdev_auth
(&
rdev
->
wùhy
, 
dev
, 
ªq
);

481 
ªt
 = 
rdev
->
›s
->
	`auth
(&rdev->
wùhy
, 
dev
, 
ªq
);

482 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

483  
ªt
;

484 
	}
}

486 
ölöe
 
	$rdev_assoc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

487 
√t_devi˚
 *
dev
,

488 
cfg80211_assoc_ªque°
 *
ªq
)

490 
ªt
;

492 
	`åa˚_rdev_assoc
(&
rdev
->
wùhy
, 
dev
, 
ªq
);

493 
ªt
 = 
rdev
->
›s
->
	`assoc
(&rdev->
wùhy
, 
dev
, 
ªq
);

494 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

495  
ªt
;

496 
	}
}

498 
ölöe
 
	$rdev_dóuth
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

499 
√t_devi˚
 *
dev
,

500 
cfg80211_dóuth_ªque°
 *
ªq
)

502 
ªt
;

503 
	`åa˚_rdev_dóuth
(&
rdev
->
wùhy
, 
dev
, 
ªq
);

504 
ªt
 = 
rdev
->
›s
->
	`dóuth
(&rdev->
wùhy
, 
dev
, 
ªq
);

505 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

506  
ªt
;

507 
	}
}

509 
ölöe
 
	$rdev_dißssoc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

510 
√t_devi˚
 *
dev
,

511 
cfg80211_dißssoc_ªque°
 *
ªq
)

513 
ªt
;

514 
	`åa˚_rdev_dißssoc
(&
rdev
->
wùhy
, 
dev
, 
ªq
);

515 
ªt
 = 
rdev
->
›s
->
	`dißssoc
(&rdev->
wùhy
, 
dev
, 
ªq
);

516 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

517  
ªt
;

518 
	}
}

520 
ölöe
 
	$rdev_c⁄√˘
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

521 
√t_devi˚
 *
dev
,

522 
cfg80211_c⁄√˘_∑øms
 *
sme
)

524 
ªt
;

525 
	`åa˚_rdev_c⁄√˘
(&
rdev
->
wùhy
, 
dev
, 
sme
);

526 
ªt
 = 
rdev
->
›s
->
	`c⁄√˘
(&rdev->
wùhy
, 
dev
, 
sme
);

527 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

528  
ªt
;

529 
	}
}

531 
ölöe
 

532 
	$rdev_upd©e_c⁄√˘_∑øms
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

533 
√t_devi˚
 *
dev
,

534 
cfg80211_c⁄√˘_∑øms
 *
sme
, 
u32
 
ch™ged
)

536 
ªt
;

537 
	`åa˚_rdev_upd©e_c⁄√˘_∑øms
(&
rdev
->
wùhy
, 
dev
, 
sme
, 
ch™ged
);

538 
ªt
 = 
rdev
->
›s
->
	`upd©e_c⁄√˘_∑øms
(&rdev->
wùhy
, 
dev
, 
sme
, 
ch™ged
);

539 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

540  
ªt
;

541 
	}
}

543 
ölöe
 
	$rdev_disc⁄√˘
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

544 
√t_devi˚
 *
dev
, 
u16
 
ªas⁄_code
)

546 
ªt
;

547 
	`åa˚_rdev_disc⁄√˘
(&
rdev
->
wùhy
, 
dev
, 
ªas⁄_code
);

548 
ªt
 = 
rdev
->
›s
->
	`disc⁄√˘
(&rdev->
wùhy
, 
dev
, 
ªas⁄_code
);

549 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

550  
ªt
;

551 
	}
}

553 
ölöe
 
	$rdev_joö_ibss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

554 
√t_devi˚
 *
dev
,

555 
cfg80211_ibss_∑øms
 *
∑øms
)

557 
ªt
;

558 
	`åa˚_rdev_joö_ibss
(&
rdev
->
wùhy
, 
dev
, 
∑øms
);

559 
ªt
 = 
rdev
->
›s
->
	`joö_ibss
(&rdev->
wùhy
, 
dev
, 
∑øms
);

560 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

561  
ªt
;

562 
	}
}

564 
ölöe
 
	$rdev_Àave_ibss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

565 
√t_devi˚
 *
dev
)

567 
ªt
;

568 
	`åa˚_rdev_Àave_ibss
(&
rdev
->
wùhy
, 
dev
);

569 
ªt
 = 
rdev
->
›s
->
	`Àave_ibss
(&rdev->
wùhy
, 
dev
);

570 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

571  
ªt
;

572 
	}
}

574 
ölöe
 

575 
	$rdev_£t_wùhy_∑øms
(
cfg80211_ªgi°îed_devi˚
 *
rdev
, 
u32
 
ch™ged
)

577 
ªt
;

579 i‡(!
rdev
->
›s
->
£t_wùhy_∑øms
)

580  -
EOPNOTSUPP
;

582 
	`åa˚_rdev_£t_wùhy_∑øms
(&
rdev
->
wùhy
, 
ch™ged
);

583 
ªt
 = 
rdev
->
›s
->
	`£t_wùhy_∑øms
(&rdev->
wùhy
, 
ch™ged
);

584 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

585  
ªt
;

586 
	}
}

588 
ölöe
 
	$rdev_£t_tx_powî
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

589 
wúñess_dev
 *
wdev
,

590 
∆80211_tx_powî_£âög
 
ty≥
, 
mbm
)

592 
ªt
;

593 
	`åa˚_rdev_£t_tx_powî
(&
rdev
->
wùhy
, 
wdev
, 
ty≥
, 
mbm
);

594 
ªt
 = 
rdev
->
›s
->
	`£t_tx_powî
(&rdev->
wùhy
, 
wdev
, 
ty≥
, 
mbm
);

595 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

596  
ªt
;

597 
	}
}

599 
ölöe
 
	$rdev_gë_tx_powî
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

600 
wúñess_dev
 *
wdev
, *
dbm
)

602 
ªt
;

603 
	`åa˚_rdev_gë_tx_powî
(&
rdev
->
wùhy
, 
wdev
);

604 
ªt
 = 
rdev
->
›s
->
	`gë_tx_powî
(&rdev->
wùhy
, 
wdev
, 
dbm
);

605 
	`åa˚_rdev_ªtu∫_öt_öt
(&
rdev
->
wùhy
, 
ªt
, *
dbm
);

606  
ªt
;

607 
	}
}

609 
ölöe
 

610 
	$rdev_£t_mu…iˇ°_to_uniˇ°
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

611 
√t_devi˚
 *
dev
,

612 c⁄° 
boﬁ
 
íabÀd
)

614 
ªt
;

615 
	`åa˚_rdev_£t_mu…iˇ°_to_uniˇ°
(&
rdev
->
wùhy
, 
dev
, 
íabÀd
);

616 
ªt
 = 
rdev
->
›s
->
	`£t_mu…iˇ°_to_uniˇ°
(&rdev->
wùhy
, 
dev
, 
íabÀd
);

617 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

618  
ªt
;

619 
	}
}

621 
ölöe
 

622 
	$rdev_gë_txq_°©s
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

623 
wúñess_dev
 *
wdev
,

624 
cfg80211_txq_°©s
 *
txq°©s
)

626 
ªt
;

627 
	`åa˚_rdev_gë_txq_°©s
(&
rdev
->
wùhy
, 
wdev
);

628 
ªt
 = 
rdev
->
›s
->
	`gë_txq_°©s
(&rdev->
wùhy
, 
wdev
, 
txq°©s
);

629 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

630  
ªt
;

631 
	}
}

633 
ölöe
 
	$rdev_rfkûl_pﬁl
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

635 
	`åa˚_rdev_rfkûl_pﬁl
(&
rdev
->
wùhy
);

636 
rdev
->
›s
->
	`rfkûl_pﬁl
(&rdev->
wùhy
);

637 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

638 
	}
}

641 #ifde‡
CONFIG_NL80211_TESTMODE


642 
ölöe
 
	$rdev_ã°mode_cmd
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

643 
wúñess_dev
 *
wdev
,

644 *
d©a
, 
Àn
)

646 
ªt
;

647 
	`åa˚_rdev_ã°mode_cmd
(&
rdev
->
wùhy
, 
wdev
);

648 
ªt
 = 
rdev
->
›s
->
	`ã°mode_cmd
(&rdev->
wùhy
, 
wdev
, 
d©a
, 
Àn
);

649 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

650  
ªt
;

651 
	}
}

653 
ölöe
 
	$rdev_ã°mode_dump
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

654 
sk_buff
 *
skb
,

655 
√éök_ˇŒback
 *
cb
, *
d©a
,

656 
Àn
)

658 
ªt
;

659 
	`åa˚_rdev_ã°mode_dump
(&
rdev
->
wùhy
);

660 
ªt
 = 
rdev
->
›s
->
	`ã°mode_dump
(&rdev->
wùhy
, 
skb
, 
cb
, 
d©a
, 
Àn
);

661 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

662  
ªt
;

663 
	}
}

666 
ölöe
 

667 
	$rdev_£t_bôøã_mask
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

668 
√t_devi˚
 *
dev
, 
lök_id
,

669 c⁄° 
u8
 *
≥î
,

670 c⁄° 
cfg80211_bôøã_mask
 *
mask
)

672 
ªt
;

673 
	`åa˚_rdev_£t_bôøã_mask
(&
rdev
->
wùhy
, 
dev
, 
lök_id
, 
≥î
, 
mask
);

674 
ªt
 = 
rdev
->
›s
->
	`£t_bôøã_mask
(&rdev->
wùhy
, 
dev
, 
lök_id
,

675 
≥î
, 
mask
);

676 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

677  
ªt
;

678 
	}
}

680 
ölöe
 
	$rdev_dump_survey
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

681 
√t_devi˚
 *
√tdev
, 
idx
,

682 
survey_öfo
 *
öfo
)

684 
ªt
;

685 
	`åa˚_rdev_dump_survey
(&
rdev
->
wùhy
, 
√tdev
, 
idx
);

686 
ªt
 = 
rdev
->
›s
->
	`dump_survey
(&rdev->
wùhy
, 
√tdev
, 
idx
, 
öfo
);

687 i‡(
ªt
 < 0)

688 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

690 
	`åa˚_rdev_ªtu∫_öt_survey_öfo
(&
rdev
->
wùhy
, 
ªt
, 
öfo
);

691  
ªt
;

692 
	}
}

694 
ölöe
 
	$rdev_£t_pmkß
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

695 
√t_devi˚
 *
√tdev
,

696 
cfg80211_pmkß
 *
pmkß
)

698 
ªt
;

699 
	`åa˚_rdev_£t_pmkß
(&
rdev
->
wùhy
, 
√tdev
, 
pmkß
);

700 
ªt
 = 
rdev
->
›s
->
	`£t_pmkß
(&rdev->
wùhy
, 
√tdev
, 
pmkß
);

701 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

702  
ªt
;

703 
	}
}

705 
ölöe
 
	$rdev_dñ_pmkß
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

706 
√t_devi˚
 *
√tdev
,

707 
cfg80211_pmkß
 *
pmkß
)

709 
ªt
;

710 
	`åa˚_rdev_dñ_pmkß
(&
rdev
->
wùhy
, 
√tdev
, 
pmkß
);

711 
ªt
 = 
rdev
->
›s
->
	`dñ_pmkß
(&rdev->
wùhy
, 
√tdev
, 
pmkß
);

712 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

713  
ªt
;

714 
	}
}

716 
ölöe
 
	$rdev_Êush_pmkß
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

717 
√t_devi˚
 *
√tdev
)

719 
ªt
;

720 
	`åa˚_rdev_Êush_pmkß
(&
rdev
->
wùhy
, 
√tdev
);

721 
ªt
 = 
rdev
->
›s
->
	`Êush_pmkß
(&rdev->
wùhy
, 
√tdev
);

722 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

723  
ªt
;

724 
	}
}

726 
ölöe
 

727 
	$rdev_ªmaö_⁄_ch™√l
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

728 
wúñess_dev
 *
wdev
,

729 
õì80211_ch™√l
 *
ch™
,

730 
duøti⁄
, 
u64
 *
cookõ
)

732 
ªt
;

733 
	`åa˚_rdev_ªmaö_⁄_ch™√l
(&
rdev
->
wùhy
, 
wdev
, 
ch™
, 
duøti⁄
);

734 
ªt
 = 
rdev
->
›s
->
	`ªmaö_⁄_ch™√l
(&rdev->
wùhy
, 
wdev
, 
ch™
,

735 
duøti⁄
, 
cookõ
);

736 
	`åa˚_rdev_ªtu∫_öt_cookõ
(&
rdev
->
wùhy
, 
ªt
, *
cookõ
);

737  
ªt
;

738 
	}
}

740 
ölöe
 

741 
	$rdev_ˇn˚l_ªmaö_⁄_ch™√l
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

742 
wúñess_dev
 *
wdev
, 
u64
 
cookõ
)

744 
ªt
;

745 
	`åa˚_rdev_ˇn˚l_ªmaö_⁄_ch™√l
(&
rdev
->
wùhy
, 
wdev
, 
cookõ
);

746 
ªt
 = 
rdev
->
›s
->
	`ˇn˚l_ªmaö_⁄_ch™√l
(&rdev->
wùhy
, 
wdev
, 
cookõ
);

747 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

748  
ªt
;

749 
	}
}

751 
ölöe
 
	$rdev_mgmt_tx
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

752 
wúñess_dev
 *
wdev
,

753 
cfg80211_mgmt_tx_∑øms
 *
∑øms
,

754 
u64
 *
cookõ
)

756 
ªt
;

757 
	`åa˚_rdev_mgmt_tx
(&
rdev
->
wùhy
, 
wdev
, 
∑øms
);

758 
ªt
 = 
rdev
->
›s
->
	`mgmt_tx
(&rdev->
wùhy
, 
wdev
, 
∑øms
, 
cookõ
);

759 
	`åa˚_rdev_ªtu∫_öt_cookõ
(&
rdev
->
wùhy
, 
ªt
, *
cookõ
);

760  
ªt
;

761 
	}
}

763 
ölöe
 
	$rdev_tx_c⁄åﬁ_p‹t
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

764 
√t_devi˚
 *
dev
,

765 c⁄° *
buf
, 
size_t
 
Àn
,

766 c⁄° 
u8
 *
de°
, 
__be16
 
¥Ÿo
,

767 c⁄° 
boﬁ
 
n€n¸y±
, 
lök
,

768 
u64
 *
cookõ
)

770 
ªt
;

771 
	`åa˚_rdev_tx_c⁄åﬁ_p‹t
(&
rdev
->
wùhy
, 
dev
, 
buf
, 
Àn
,

772 
de°
, 
¥Ÿo
, 
n€n¸y±
, 
lök
);

773 
ªt
 = 
rdev
->
›s
->
	`tx_c⁄åﬁ_p‹t
(&rdev->
wùhy
, 
dev
, 
buf
, 
Àn
,

774 
de°
, 
¥Ÿo
, 
n€n¸y±
, 
lök
, 
cookõ
);

775 i‡(
cookõ
)

776 
	`åa˚_rdev_ªtu∫_öt_cookõ
(&
rdev
->
wùhy
, 
ªt
, *
cookõ
);

778 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

779  
ªt
;

780 
	}
}

782 
ölöe
 

783 
	$rdev_mgmt_tx_ˇn˚l_waô
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

784 
wúñess_dev
 *
wdev
, 
u64
 
cookõ
)

786 
ªt
;

787 
	`åa˚_rdev_mgmt_tx_ˇn˚l_waô
(&
rdev
->
wùhy
, 
wdev
, 
cookõ
);

788 
ªt
 = 
rdev
->
›s
->
	`mgmt_tx_ˇn˚l_waô
(&rdev->
wùhy
, 
wdev
, 
cookõ
);

789 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

790  
ªt
;

791 
	}
}

793 
ölöe
 
	$rdev_£t_powî_mgmt
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

794 
√t_devi˚
 *
dev
, 
boﬁ
 
íabÀd
,

795 
timeout
)

797 
ªt
;

798 
	`åa˚_rdev_£t_powî_mgmt
(&
rdev
->
wùhy
, 
dev
, 
íabÀd
, 
timeout
);

799 
ªt
 = 
rdev
->
›s
->
	`£t_powî_mgmt
(&rdev->
wùhy
, 
dev
, 
íabÀd
, 
timeout
);

800 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

801  
ªt
;

802 
	}
}

804 
ölöe
 

805 
	$rdev_£t_cqm_rssi_c⁄fig
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

806 
√t_devi˚
 *
dev
, 
s32
 
rssi_thﬁd
, 
u32
 
rssi_hy°
)

808 
ªt
;

809 
	`åa˚_rdev_£t_cqm_rssi_c⁄fig
(&
rdev
->
wùhy
, 
dev
, 
rssi_thﬁd
,

810 
rssi_hy°
);

811 
ªt
 = 
rdev
->
›s
->
	`£t_cqm_rssi_c⁄fig
(&rdev->
wùhy
, 
dev
, 
rssi_thﬁd
,

812 
rssi_hy°
);

813 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

814  
ªt
;

815 
	}
}

817 
ölöe
 

818 
	$rdev_£t_cqm_rssi_ønge_c⁄fig
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

819 
√t_devi˚
 *
dev
, 
s32
 
low
, s32 
high
)

821 
ªt
;

822 
	`åa˚_rdev_£t_cqm_rssi_ønge_c⁄fig
(&
rdev
->
wùhy
, 
dev
, 
low
, 
high
);

823 
ªt
 = 
rdev
->
›s
->
	`£t_cqm_rssi_ønge_c⁄fig
(&rdev->
wùhy
, 
dev
,

824 
low
, 
high
);

825 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

826  
ªt
;

827 
	}
}

829 
ölöe
 

830 
	$rdev_£t_cqm_txe_c⁄fig
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

831 
√t_devi˚
 *
dev
, 
u32
 
øã
, u32 
pkts
, u32 
ötvl
)

833 
ªt
;

834 
	`åa˚_rdev_£t_cqm_txe_c⁄fig
(&
rdev
->
wùhy
, 
dev
, 
øã
, 
pkts
, 
ötvl
);

835 
ªt
 = 
rdev
->
›s
->
	`£t_cqm_txe_c⁄fig
(&rdev->
wùhy
, 
dev
, 
øã
, 
pkts
,

836 
ötvl
);

837 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

838  
ªt
;

839 
	}
}

841 
ölöe
 

842 
	$rdev_upd©e_mgmt_‰ame_ªgi°øti⁄s
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

843 
wúñess_dev
 *
wdev
,

844 
mgmt_‰ame_ªgs
 *
upd
)

846 
	`might_¶ìp
();

848 
	`åa˚_rdev_upd©e_mgmt_‰ame_ªgi°øti⁄s
(&
rdev
->
wùhy
, 
wdev
, 
upd
);

849 i‡(
rdev
->
›s
->
upd©e_mgmt_‰ame_ªgi°øti⁄s
)

850 
rdev
->
›s
->
	`upd©e_mgmt_‰ame_ªgi°øti⁄s
(&rdev->
wùhy
, 
wdev
,

851 
upd
);

852 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

853 
	}
}

855 
ölöe
 
	$rdev_£t_™ã¬a
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

856 
u32
 
tx_™t
, u32 
rx_™t
)

858 
ªt
;

859 
	`åa˚_rdev_£t_™ã¬a
(&
rdev
->
wùhy
, 
tx_™t
, 
rx_™t
);

860 
ªt
 = 
rdev
->
›s
->
	`£t_™ã¬a
(&rdev->
wùhy
, 
tx_™t
, 
rx_™t
);

861 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

862  
ªt
;

863 
	}
}

865 
ölöe
 
	$rdev_gë_™ã¬a
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

866 
u32
 *
tx_™t
, u32 *
rx_™t
)

868 
ªt
;

869 
	`åa˚_rdev_gë_™ã¬a
(&
rdev
->
wùhy
);

870 
ªt
 = 
rdev
->
›s
->
	`gë_™ã¬a
(&rdev->
wùhy
, 
tx_™t
, 
rx_™t
);

871 i‡(
ªt
)

872 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

874 
	`åa˚_rdev_ªtu∫_öt_tx_rx
(&
rdev
->
wùhy
, 
ªt
, *
tx_™t
,

875 *
rx_™t
);

876  
ªt
;

877 
	}
}

879 
ölöe
 

880 
	$rdev_sched_sˇn_°¨t
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

881 
√t_devi˚
 *
dev
,

882 
cfg80211_sched_sˇn_ªque°
 *
ªque°
)

884 
ªt
;

885 
	`åa˚_rdev_sched_sˇn_°¨t
(&
rdev
->
wùhy
, 
dev
, 
ªque°
->
ªqid
);

886 
ªt
 = 
rdev
->
›s
->
	`sched_sˇn_°¨t
(&rdev->
wùhy
, 
dev
, 
ªque°
);

887 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

888  
ªt
;

889 
	}
}

891 
ölöe
 
	$rdev_sched_sˇn_°›
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

892 
√t_devi˚
 *
dev
, 
u64
 
ªqid
)

894 
ªt
;

895 
	`åa˚_rdev_sched_sˇn_°›
(&
rdev
->
wùhy
, 
dev
, 
ªqid
);

896 
ªt
 = 
rdev
->
›s
->
	`sched_sˇn_°›
(&rdev->
wùhy
, 
dev
, 
ªqid
);

897 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

898  
ªt
;

899 
	}
}

901 
ölöe
 
	$rdev_£t_ªkey_d©a
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

902 
√t_devi˚
 *
dev
,

903 
cfg80211_gtk_ªkey_d©a
 *
d©a
)

905 
ªt
;

906 
	`åa˚_rdev_£t_ªkey_d©a
(&
rdev
->
wùhy
, 
dev
);

907 
ªt
 = 
rdev
->
›s
->
	`£t_ªkey_d©a
(&rdev->
wùhy
, 
dev
, 
d©a
);

908 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

909  
ªt
;

910 
	}
}

912 
ölöe
 
	$rdev_tdls_mgmt
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

913 
√t_devi˚
 *
dev
, 
u8
 *
≥î
,

914 
lök_id
, 
u8
 
a˘i⁄_code
,

915 
u8
 
dülog_tokí
, 
u16
 
°©us_code
,

916 
u32
 
≥î_ˇ∑bûôy
, 
boﬁ
 
öôüt‹
,

917 c⁄° 
u8
 *
buf
, 
size_t
 
Àn
)

919 
ªt
;

920 
	`åa˚_rdev_tdls_mgmt
(&
rdev
->
wùhy
, 
dev
, 
≥î
, 
lök_id
, 
a˘i⁄_code
,

921 
dülog_tokí
, 
°©us_code
, 
≥î_ˇ∑bûôy
,

922 
öôüt‹
, 
buf
, 
Àn
);

923 
ªt
 = 
rdev
->
›s
->
	`tdls_mgmt
(&rdev->
wùhy
, 
dev
, 
≥î
, 
lök_id
,

924 
a˘i⁄_code
, 
dülog_tokí
, 
°©us_code
,

925 
≥î_ˇ∑bûôy
, 
öôüt‹
, 
buf
, 
Àn
);

926 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

927  
ªt
;

928 
	}
}

930 
ölöe
 
	$rdev_tdls_›î
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

931 
√t_devi˚
 *
dev
, 
u8
 *
≥î
,

932 
∆80211_tdls_›î©i⁄
 
›î
)

934 
ªt
;

935 
	`åa˚_rdev_tdls_›î
(&
rdev
->
wùhy
, 
dev
, 
≥î
, 
›î
);

936 
ªt
 = 
rdev
->
›s
->
	`tdls_›î
(&rdev->
wùhy
, 
dev
, 
≥î
, 
›î
);

937 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

938  
ªt
;

939 
	}
}

941 
ölöe
 
	$rdev_¥obe_˛õ¡
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

942 
√t_devi˚
 *
dev
, c⁄° 
u8
 *
≥î
,

943 
u64
 *
cookõ
)

945 
ªt
;

946 
	`åa˚_rdev_¥obe_˛õ¡
(&
rdev
->
wùhy
, 
dev
, 
≥î
);

947 
ªt
 = 
rdev
->
›s
->
	`¥obe_˛õ¡
(&rdev->
wùhy
, 
dev
, 
≥î
, 
cookõ
);

948 
	`åa˚_rdev_ªtu∫_öt_cookõ
(&
rdev
->
wùhy
, 
ªt
, *
cookõ
);

949  
ªt
;

950 
	}
}

952 
ölöe
 
	$rdev_£t_nﬂck_m≠
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

953 
√t_devi˚
 *
dev
, 
u16
 
nﬂck_m≠
)

955 
ªt
;

956 
	`åa˚_rdev_£t_nﬂck_m≠
(&
rdev
->
wùhy
, 
dev
, 
nﬂck_m≠
);

957 
ªt
 = 
rdev
->
›s
->
	`£t_nﬂck_m≠
(&rdev->
wùhy
, 
dev
, 
nﬂck_m≠
);

958 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

959  
ªt
;

960 
	}
}

962 
ölöe
 

963 
	$rdev_gë_ch™√l
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

964 
wúñess_dev
 *
wdev
,

965 
lök_id
,

966 
cfg80211_ch™_def
 *
ch™def
)

968 
ªt
;

970 
	`åa˚_rdev_gë_ch™√l
(&
rdev
->
wùhy
, 
wdev
, 
lök_id
);

971 
ªt
 = 
rdev
->
›s
->
	`gë_ch™√l
(&rdev->
wùhy
, 
wdev
, 
lök_id
, 
ch™def
);

972 
	`åa˚_rdev_ªtu∫_ch™def
(&
rdev
->
wùhy
, 
ªt
, 
ch™def
);

974  
ªt
;

975 
	}
}

977 
ölöe
 
	$rdev_°¨t_p2p_devi˚
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

978 
wúñess_dev
 *
wdev
)

980 
ªt
;

982 
	`åa˚_rdev_°¨t_p2p_devi˚
(&
rdev
->
wùhy
, 
wdev
);

983 
ªt
 = 
rdev
->
›s
->
	`°¨t_p2p_devi˚
(&rdev->
wùhy
, 
wdev
);

984 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

985  
ªt
;

986 
	}
}

988 
ölöe
 
	$rdev_°›_p2p_devi˚
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

989 
wúñess_dev
 *
wdev
)

991 
	`åa˚_rdev_°›_p2p_devi˚
(&
rdev
->
wùhy
, 
wdev
);

992 
rdev
->
›s
->
	`°›_p2p_devi˚
(&rdev->
wùhy
, 
wdev
);

993 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

994 
	}
}

996 
ölöe
 
	$rdev_°¨t_«n
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

997 
wúñess_dev
 *
wdev
,

998 
cfg80211_«n_c⁄f
 *
c⁄f
)

1000 
ªt
;

1002 
	`åa˚_rdev_°¨t_«n
(&
rdev
->
wùhy
, 
wdev
, 
c⁄f
);

1003 
ªt
 = 
rdev
->
›s
->
	`°¨t_«n
(&rdev->
wùhy
, 
wdev
, 
c⁄f
);

1004 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1005  
ªt
;

1006 
	}
}

1008 
ölöe
 
	$rdev_°›_«n
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1009 
wúñess_dev
 *
wdev
)

1011 
	`åa˚_rdev_°›_«n
(&
rdev
->
wùhy
, 
wdev
);

1012 
rdev
->
›s
->
	`°›_«n
(&rdev->
wùhy
, 
wdev
);

1013 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

1014 
	}
}

1016 
ölöe
 

1017 
	$rdev_add_«n_func
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1018 
wúñess_dev
 *
wdev
,

1019 
cfg80211_«n_func
 *
«n_func
)

1021 
ªt
;

1023 
	`åa˚_rdev_add_«n_func
(&
rdev
->
wùhy
, 
wdev
, 
«n_func
);

1024 
ªt
 = 
rdev
->
›s
->
	`add_«n_func
(&rdev->
wùhy
, 
wdev
, 
«n_func
);

1025 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1026  
ªt
;

1027 
	}
}

1029 
ölöe
 
	$rdev_dñ_«n_func
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1030 
wúñess_dev
 *
wdev
, 
u64
 
cookõ
)

1032 
	`åa˚_rdev_dñ_«n_func
(&
rdev
->
wùhy
, 
wdev
, 
cookõ
);

1033 
rdev
->
›s
->
	`dñ_«n_func
(&rdev->
wùhy
, 
wdev
, 
cookõ
);

1034 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

1035 
	}
}

1037 
ölöe
 

1038 
	$rdev_«n_ch™ge_c⁄f
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1039 
wúñess_dev
 *
wdev
,

1040 
cfg80211_«n_c⁄f
 *
c⁄f
, 
u32
 
ch™ges
)

1042 
ªt
;

1044 
	`åa˚_rdev_«n_ch™ge_c⁄f
(&
rdev
->
wùhy
, 
wdev
, 
c⁄f
, 
ch™ges
);

1045 i‡(
rdev
->
›s
->
«n_ch™ge_c⁄f
)

1046 
ªt
 = 
rdev
->
›s
->
	`«n_ch™ge_c⁄f
(&rdev->
wùhy
, 
wdev
, 
c⁄f
,

1047 
ch™ges
);

1049 
ªt
 = -
EOPNOTSUPP
;

1050 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1051  
ªt
;

1052 
	}
}

1054 
ölöe
 
	$rdev_£t_mac_a˛
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1055 
√t_devi˚
 *
dev
,

1056 
cfg80211_a˛_d©a
 *
∑øms
)

1058 
ªt
;

1060 
	`åa˚_rdev_£t_mac_a˛
(&
rdev
->
wùhy
, 
dev
, 
∑øms
);

1061 
ªt
 = 
rdev
->
›s
->
	`£t_mac_a˛
(&rdev->
wùhy
, 
dev
, 
∑øms
);

1062 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1063  
ªt
;

1064 
	}
}

1066 
ölöe
 
	$rdev_upd©e_·_õs
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1067 
√t_devi˚
 *
dev
,

1068 
cfg80211_upd©e_·_õs_∑øms
 *
·õ
)

1070 
ªt
;

1072 
	`åa˚_rdev_upd©e_·_õs
(&
rdev
->
wùhy
, 
dev
, 
·õ
);

1073 
ªt
 = 
rdev
->
›s
->
	`upd©e_·_õs
(&rdev->
wùhy
, 
dev
, 
·õ
);

1074 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1075  
ªt
;

1076 
	}
}

1078 
ölöe
 
	$rdev_¸ô_¥Ÿo_°¨t
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1079 
wúñess_dev
 *
wdev
,

1080 
∆80211_¸ô_¥Ÿo_id
 
¥Ÿocﬁ
,

1081 
u16
 
duøti⁄
)

1083 
ªt
;

1085 
	`åa˚_rdev_¸ô_¥Ÿo_°¨t
(&
rdev
->
wùhy
, 
wdev
, 
¥Ÿocﬁ
, 
duøti⁄
);

1086 
ªt
 = 
rdev
->
›s
->
	`¸ô_¥Ÿo_°¨t
(&rdev->
wùhy
, 
wdev
,

1087 
¥Ÿocﬁ
, 
duøti⁄
);

1088 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1089  
ªt
;

1090 
	}
}

1092 
ölöe
 
	$rdev_¸ô_¥Ÿo_°›
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1093 
wúñess_dev
 *
wdev
)

1095 
	`åa˚_rdev_¸ô_¥Ÿo_°›
(&
rdev
->
wùhy
, 
wdev
);

1096 
rdev
->
›s
->
	`¸ô_¥Ÿo_°›
(&rdev->
wùhy
, 
wdev
);

1097 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

1098 
	}
}

1100 
ölöe
 
	$rdev_ch™√l_swôch
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1101 
√t_devi˚
 *
dev
,

1102 
cfg80211_cß_£âögs
 *
∑øms
)

1104 
ªt
;

1106 
	`åa˚_rdev_ch™√l_swôch
(&
rdev
->
wùhy
, 
dev
, 
∑øms
);

1107 
ªt
 = 
rdev
->
›s
->
	`ch™√l_swôch
(&rdev->
wùhy
, 
dev
, 
∑øms
);

1108 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1109  
ªt
;

1110 
	}
}

1112 
ölöe
 
	$rdev_£t_qos_m≠
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1113 
√t_devi˚
 *
dev
,

1114 
cfg80211_qos_m≠
 *
qos_m≠
)

1116 
ªt
 = -
EOPNOTSUPP
;

1118 i‡(
rdev
->
›s
->
£t_qos_m≠
) {

1119 
	`åa˚_rdev_£t_qos_m≠
(&
rdev
->
wùhy
, 
dev
, 
qos_m≠
);

1120 
ªt
 = 
rdev
->
›s
->
	`£t_qos_m≠
(&rdev->
wùhy
, 
dev
, 
qos_m≠
);

1121 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1124  
ªt
;

1125 
	}
}

1127 
ölöe
 

1128 
	$rdev_£t_≠_ch™width
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1129 
√t_devi˚
 *
dev
,

1130 
lök_id
,

1131 
cfg80211_ch™_def
 *
ch™def
)

1133 
ªt
;

1135 
	`åa˚_rdev_£t_≠_ch™width
(&
rdev
->
wùhy
, 
dev
, 
lök_id
, 
ch™def
);

1136 
ªt
 = 
rdev
->
›s
->
	`£t_≠_ch™width
(&rdev->
wùhy
, 
dev
, 
lök_id
, 
ch™def
);

1137 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1139  
ªt
;

1140 
	}
}

1142 
ölöe
 

1143 
	$rdev_add_tx_ts
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1144 
√t_devi˚
 *
dev
, 
u8
 
tsid
, c⁄° u8 *
≥î
,

1145 
u8
 
u£r_¥io
, 
u16
 
admôãd_time
)

1147 
ªt
 = -
EOPNOTSUPP
;

1149 
	`åa˚_rdev_add_tx_ts
(&
rdev
->
wùhy
, 
dev
, 
tsid
, 
≥î
,

1150 
u£r_¥io
, 
admôãd_time
);

1151 i‡(
rdev
->
›s
->
add_tx_ts
)

1152 
ªt
 = 
rdev
->
›s
->
	`add_tx_ts
(&rdev->
wùhy
, 
dev
, 
tsid
, 
≥î
,

1153 
u£r_¥io
, 
admôãd_time
);

1154 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1156  
ªt
;

1157 
	}
}

1159 
ölöe
 

1160 
	$rdev_dñ_tx_ts
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1161 
√t_devi˚
 *
dev
, 
u8
 
tsid
, c⁄° u8 *
≥î
)

1163 
ªt
 = -
EOPNOTSUPP
;

1165 
	`åa˚_rdev_dñ_tx_ts
(&
rdev
->
wùhy
, 
dev
, 
tsid
, 
≥î
);

1166 i‡(
rdev
->
›s
->
dñ_tx_ts
)

1167 
ªt
 = 
rdev
->
›s
->
	`dñ_tx_ts
(&rdev->
wùhy
, 
dev
, 
tsid
, 
≥î
);

1168 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1170  
ªt
;

1171 
	}
}

1173 
ölöe
 

1174 
	$rdev_tdls_ch™√l_swôch
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1175 
√t_devi˚
 *
dev
, c⁄° 
u8
 *
addr
,

1176 
u8
 
›î_˛ass
, 
cfg80211_ch™_def
 *
ch™def
)

1178 
ªt
;

1180 
	`åa˚_rdev_tdls_ch™√l_swôch
(&
rdev
->
wùhy
, 
dev
, 
addr
, 
›î_˛ass
,

1181 
ch™def
);

1182 
ªt
 = 
rdev
->
›s
->
	`tdls_ch™√l_swôch
(&rdev->
wùhy
, 
dev
, 
addr
,

1183 
›î_˛ass
, 
ch™def
);

1184 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1185  
ªt
;

1186 
	}
}

1188 
ölöe
 

1189 
	$rdev_tdls_ˇn˚l_ch™√l_swôch
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1190 
√t_devi˚
 *
dev
, c⁄° 
u8
 *
addr
)

1192 
	`åa˚_rdev_tdls_ˇn˚l_ch™√l_swôch
(&
rdev
->
wùhy
, 
dev
, 
addr
);

1193 
rdev
->
›s
->
	`tdls_ˇn˚l_ch™√l_swôch
(&rdev->
wùhy
, 
dev
, 
addr
);

1194 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

1195 
	}
}

1197 
ölöe
 

1198 
	$rdev_°¨t_ød¨_dëe˘i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1199 
√t_devi˚
 *
dev
,

1200 
cfg80211_ch™_def
 *
ch™def
,

1201 
u32
 
ˇc_time_ms
)

1203 
ªt
 = -
EOPNOTSUPP
;

1205 
	`åa˚_rdev_°¨t_ød¨_dëe˘i⁄
(&
rdev
->
wùhy
, 
dev
, 
ch™def
,

1206 
ˇc_time_ms
);

1207 i‡(
rdev
->
›s
->
°¨t_ød¨_dëe˘i⁄
)

1208 
ªt
 = 
rdev
->
›s
->
	`°¨t_ød¨_dëe˘i⁄
(&rdev->
wùhy
, 
dev
,

1209 
ch™def
, 
ˇc_time_ms
);

1210 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1211  
ªt
;

1212 
	}
}

1214 
ölöe
 

1215 
	$rdev_íd_ˇc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1216 
√t_devi˚
 *
dev
)

1218 
	`åa˚_rdev_íd_ˇc
(&
rdev
->
wùhy
, 
dev
);

1219 i‡(
rdev
->
›s
->
íd_ˇc
)

1220 
rdev
->
›s
->
	`íd_ˇc
(&rdev->
wùhy
, 
dev
);

1221 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

1222 
	}
}

1224 
ölöe
 

1225 
	$rdev_£t_mˇ°_øã
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1226 
√t_devi˚
 *
dev
,

1227 
mˇ°_øã
[
NUM_NL80211_BANDS
])

1229 
ªt
 = -
EOPNOTSUPP
;

1231 
	`åa˚_rdev_£t_mˇ°_øã
(&
rdev
->
wùhy
, 
dev
, 
mˇ°_øã
);

1232 i‡(
rdev
->
›s
->
£t_mˇ°_øã
)

1233 
ªt
 = 
rdev
->
›s
->
	`£t_mˇ°_øã
(&rdev->
wùhy
, 
dev
, 
mˇ°_øã
);

1234 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1235  
ªt
;

1236 
	}
}

1238 
ölöe
 

1239 
	$rdev_£t_cﬂÀs˚
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1240 
cfg80211_cﬂÀs˚
 *
cﬂÀs˚
)

1242 
ªt
 = -
EOPNOTSUPP
;

1244 
	`åa˚_rdev_£t_cﬂÀs˚
(&
rdev
->
wùhy
, 
cﬂÀs˚
);

1245 i‡(
rdev
->
›s
->
£t_cﬂÀs˚
)

1246 
ªt
 = 
rdev
->
›s
->
	`£t_cﬂÀs˚
(&rdev->
wùhy
, 
cﬂÀs˚
);

1247 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1248  
ªt
;

1249 
	}
}

1251 
ölöe
 
	$rdev_£t_pmk
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1252 
√t_devi˚
 *
dev
,

1253 
cfg80211_pmk_c⁄f
 *
pmk_c⁄f
)

1255 
ªt
 = -
EOPNOTSUPP
;

1257 
	`åa˚_rdev_£t_pmk
(&
rdev
->
wùhy
, 
dev
, 
pmk_c⁄f
);

1258 i‡(
rdev
->
›s
->
£t_pmk
)

1259 
ªt
 = 
rdev
->
›s
->
	`£t_pmk
(&rdev->
wùhy
, 
dev
, 
pmk_c⁄f
);

1260 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1261  
ªt
;

1262 
	}
}

1264 
ölöe
 
	$rdev_dñ_pmk
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1265 
√t_devi˚
 *
dev
, c⁄° 
u8
 *
Ø
)

1267 
ªt
 = -
EOPNOTSUPP
;

1269 
	`åa˚_rdev_dñ_pmk
(&
rdev
->
wùhy
, 
dev
, 
Ø
);

1270 i‡(
rdev
->
›s
->
dñ_pmk
)

1271 
ªt
 = 
rdev
->
›s
->
	`dñ_pmk
(&rdev->
wùhy
, 
dev
, 
Ø
);

1272 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1273  
ªt
;

1274 
	}
}

1276 
ölöe
 

1277 
	$rdev_exã∫Æ_auth
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1278 
√t_devi˚
 *
dev
,

1279 
cfg80211_exã∫Æ_auth_∑øms
 *
∑øms
)

1281 
ªt
 = -
EOPNOTSUPP
;

1283 
	`åa˚_rdev_exã∫Æ_auth
(&
rdev
->
wùhy
, 
dev
, 
∑øms
);

1284 i‡(
rdev
->
›s
->
exã∫Æ_auth
)

1285 
ªt
 = 
rdev
->
›s
->
	`exã∫Æ_auth
(&rdev->
wùhy
, 
dev
, 
∑øms
);

1286 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1287  
ªt
;

1288 
	}
}

1290 
ölöe
 

1291 
	$rdev_gë_·m_ª•⁄dî_°©s
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1292 
√t_devi˚
 *
dev
,

1293 
cfg80211_·m_ª•⁄dî_°©s
 *
·m_°©s
)

1295 
ªt
 = -
EOPNOTSUPP
;

1297 
	`åa˚_rdev_gë_·m_ª•⁄dî_°©s
(&
rdev
->
wùhy
, 
dev
, 
·m_°©s
);

1298 i‡(
rdev
->
›s
->
gë_·m_ª•⁄dî_°©s
)

1299 
ªt
 = 
rdev
->
›s
->
	`gë_·m_ª•⁄dî_°©s
(&rdev->
wùhy
, 
dev
,

1300 
·m_°©s
);

1301 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1302  
ªt
;

1303 
	}
}

1305 
ölöe
 

1306 
	$rdev_°¨t_pm§
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1307 
wúñess_dev
 *
wdev
,

1308 
cfg80211_pm§_ªque°
 *
ªque°
)

1310 
ªt
 = -
EOPNOTSUPP
;

1312 
	`åa˚_rdev_°¨t_pm§
(&
rdev
->
wùhy
, 
wdev
, 
ªque°
->
cookõ
);

1313 i‡(
rdev
->
›s
->
°¨t_pm§
)

1314 
ªt
 = 
rdev
->
›s
->
	`°¨t_pm§
(&rdev->
wùhy
, 
wdev
, 
ªque°
);

1315 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1316  
ªt
;

1317 
	}
}

1319 
ölöe
 

1320 
	$rdev_ab‹t_pm§
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1321 
wúñess_dev
 *
wdev
,

1322 
cfg80211_pm§_ªque°
 *
ªque°
)

1324 
	`åa˚_rdev_ab‹t_pm§
(&
rdev
->
wùhy
, 
wdev
, 
ªque°
->
cookõ
);

1325 i‡(
rdev
->
›s
->
ab‹t_pm§
)

1326 
rdev
->
›s
->
	`ab‹t_pm§
(&rdev->
wùhy
, 
wdev
, 
ªque°
);

1327 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

1328 
	}
}

1330 
ölöe
 
	$rdev_upd©e_owe_öfo
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1331 
√t_devi˚
 *
dev
,

1332 
cfg80211_upd©e_owe_öfo
 *
oweöfo
)

1334 
ªt
 = -
EOPNOTSUPP
;

1336 
	`åa˚_rdev_upd©e_owe_öfo
(&
rdev
->
wùhy
, 
dev
, 
oweöfo
);

1337 i‡(
rdev
->
›s
->
upd©e_owe_öfo
)

1338 
ªt
 = 
rdev
->
›s
->
	`upd©e_owe_öfo
(&rdev->
wùhy
, 
dev
, 
oweöfo
);

1339 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1340  
ªt
;

1341 
	}
}

1343 
ölöe
 

1344 
	$rdev_¥obe_mesh_lök
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1345 
√t_devi˚
 *
dev
, c⁄° 
u8
 *
de°
,

1346 c⁄° *
buf
, 
size_t
 
Àn
)

1348 
ªt
;

1350 
	`åa˚_rdev_¥obe_mesh_lök
(&
rdev
->
wùhy
, 
dev
, 
de°
, 
buf
, 
Àn
);

1351 
ªt
 = 
rdev
->
›s
->
	`¥obe_mesh_lök
(&rdev->
wùhy
, 
dev
, 
buf
, 
Àn
);

1352 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1353  
ªt
;

1354 
	}
}

1356 
ölöe
 
	$rdev_£t_tid_c⁄fig
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1357 
√t_devi˚
 *
dev
,

1358 
cfg80211_tid_c⁄fig
 *
tid_c⁄f
)

1360 
ªt
;

1362 
	`åa˚_rdev_£t_tid_c⁄fig
(&
rdev
->
wùhy
, 
dev
, 
tid_c⁄f
);

1363 
ªt
 = 
rdev
->
›s
->
	`£t_tid_c⁄fig
(&rdev->
wùhy
, 
dev
, 
tid_c⁄f
);

1364 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1365  
ªt
;

1366 
	}
}

1368 
ölöe
 
	$rdev_ª£t_tid_c⁄fig
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1369 
√t_devi˚
 *
dev
, c⁄° 
u8
 *
≥î
,

1370 
u8
 
tids
)

1372 
ªt
;

1374 
	`åa˚_rdev_ª£t_tid_c⁄fig
(&
rdev
->
wùhy
, 
dev
, 
≥î
, 
tids
);

1375 
ªt
 = 
rdev
->
›s
->
	`ª£t_tid_c⁄fig
(&rdev->
wùhy
, 
dev
, 
≥î
, 
tids
);

1376 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1377  
ªt
;

1378 
	}
}

1380 
ölöe
 
	$rdev_£t_ßr_•ecs
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1381 
cfg80211_ßr_•ecs
 *
ßr
)

1383 
ªt
;

1385 
	`åa˚_rdev_£t_ßr_•ecs
(&
rdev
->
wùhy
, 
ßr
);

1386 
ªt
 = 
rdev
->
›s
->
	`£t_ßr_•ecs
(&rdev->
wùhy
, 
ßr
);

1387 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1389  
ªt
;

1390 
	}
}

1392 
ölöe
 
	$rdev_cﬁ‹_ch™ge
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1393 
√t_devi˚
 *
dev
,

1394 
cfg80211_cﬁ‹_ch™ge_£âögs
 *
∑øms
)

1396 
ªt
;

1398 
	`åa˚_rdev_cﬁ‹_ch™ge
(&
rdev
->
wùhy
, 
dev
, 
∑øms
);

1399 
ªt
 = 
rdev
->
›s
->
	`cﬁ‹_ch™ge
(&rdev->
wùhy
, 
dev
, 
∑øms
);

1400 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1402  
ªt
;

1403 
	}
}

1405 
ölöe
 

1406 
	$rdev_£t_fûs_Ød
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1407 
√t_devi˚
 *
dev
, 
cfg80211_fûs_Ød
 *
fûs_Ød
)

1409 
ªt
 = -
EOPNOTSUPP
;

1411 
	`åa˚_rdev_£t_fûs_Ød
(&
rdev
->
wùhy
, 
dev
, 
fûs_Ød
);

1412 i‡(
rdev
->
›s
->
£t_fûs_Ød
)

1413 
ªt
 = 
rdev
->
›s
->
	`£t_fûs_Ød
(&rdev->
wùhy
, 
dev
, 
fûs_Ød
);

1414 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1416  
ªt
;

1417 
	}
}

1419 
ölöe
 

1420 
	$rdev_£t_ød¨_background
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1421 
cfg80211_ch™_def
 *
ch™def
)

1423 
wùhy
 *wùhy = &
rdev
->wiphy;

1424 
ªt
;

1426 i‡(!
rdev
->
›s
->
£t_ød¨_background
)

1427  -
EOPNOTSUPP
;

1429 
	`åa˚_rdev_£t_ød¨_background
(
wùhy
, 
ch™def
);

1430 
ªt
 = 
rdev
->
›s
->
	`£t_ød¨_background
(
wùhy
, 
ch™def
);

1431 
	`åa˚_rdev_ªtu∫_öt
(
wùhy
, 
ªt
);

1433  
ªt
;

1434 
	}
}

1436 
ölöe
 

1437 
	$rdev_add_ötf_lök
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1438 
wúñess_dev
 *
wdev
,

1439 
lök_id
)

1441 
ªt
 = 0;

1443 
	`åa˚_rdev_add_ötf_lök
(&
rdev
->
wùhy
, 
wdev
, 
lök_id
);

1444 i‡(
rdev
->
›s
->
add_ötf_lök
)

1445 
ªt
 = 
rdev
->
›s
->
	`add_ötf_lök
(&rdev->
wùhy
, 
wdev
, 
lök_id
);

1446 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1448  
ªt
;

1449 
	}
}

1451 
ölöe
 

1452 
	$rdev_dñ_ötf_lök
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1453 
wúñess_dev
 *
wdev
,

1454 
lök_id
)

1456 
	`åa˚_rdev_dñ_ötf_lök
(&
rdev
->
wùhy
, 
wdev
, 
lök_id
);

1457 i‡(
rdev
->
›s
->
dñ_ötf_lök
)

1458 
rdev
->
›s
->
	`dñ_ötf_lök
(&rdev->
wùhy
, 
wdev
, 
lök_id
);

1459 
	`åa˚_rdev_ªtu∫_void
(&
rdev
->
wùhy
);

1460 
	}
}

1462 
ölöe
 

1463 
	$rdev_add_lök_°©i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1464 
√t_devi˚
 *
dev
,

1465 
lök_°©i⁄_∑ømëîs
 *
∑øms
)

1467 
ªt
;

1469 i‡(!
rdev
->
›s
->
add_lök_°©i⁄
)

1470  -
EOPNOTSUPP
;

1472 
	`åa˚_rdev_add_lök_°©i⁄
(&
rdev
->
wùhy
, 
dev
, 
∑øms
);

1473 
ªt
 = 
rdev
->
›s
->
	`add_lök_°©i⁄
(&rdev->
wùhy
, 
dev
, 
∑øms
);

1474 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1475  
ªt
;

1476 
	}
}

1478 
ölöe
 

1479 
	$rdev_mod_lök_°©i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1480 
√t_devi˚
 *
dev
,

1481 
lök_°©i⁄_∑ømëîs
 *
∑øms
)

1483 
ªt
;

1485 i‡(!
rdev
->
›s
->
mod_lök_°©i⁄
)

1486  -
EOPNOTSUPP
;

1488 
	`åa˚_rdev_mod_lök_°©i⁄
(&
rdev
->
wùhy
, 
dev
, 
∑øms
);

1489 
ªt
 = 
rdev
->
›s
->
	`mod_lök_°©i⁄
(&rdev->
wùhy
, 
dev
, 
∑øms
);

1490 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1491  
ªt
;

1492 
	}
}

1494 
ölöe
 

1495 
	$rdev_dñ_lök_°©i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1496 
√t_devi˚
 *
dev
,

1497 
lök_°©i⁄_dñ_∑ømëîs
 *
∑øms
)

1499 
ªt
;

1501 i‡(!
rdev
->
›s
->
dñ_lök_°©i⁄
)

1502  -
EOPNOTSUPP
;

1504 
	`åa˚_rdev_dñ_lök_°©i⁄
(&
rdev
->
wùhy
, 
dev
, 
∑øms
);

1505 
ªt
 = 
rdev
->
›s
->
	`dñ_lök_°©i⁄
(&rdev->
wùhy
, 
dev
, 
∑øms
);

1506 
	`åa˚_rdev_ªtu∫_öt
(&
rdev
->
wùhy
, 
ªt
);

1507  
ªt
;

1508 
	}
}

1510 
ölöe
 

1511 
	$rdev_£t_hw_time°amp
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1512 
√t_devi˚
 *
dev
,

1513 
cfg80211_£t_hw_time°amp
 *
hwts
)

1515 
wùhy
 *wùhy = &
rdev
->wiphy;

1516 
ªt
;

1518 i‡(!
rdev
->
›s
->
£t_hw_time°amp
)

1519  -
EOPNOTSUPP
;

1521 
	`åa˚_rdev_£t_hw_time°amp
(
wùhy
, 
dev
, 
hwts
);

1522 
ªt
 = 
rdev
->
›s
->
	`£t_hw_time°amp
(
wùhy
, 
dev
, 
hwts
);

1523 
	`åa˚_rdev_ªtu∫_öt
(
wùhy
, 
ªt
);

1525  
ªt
;

1526 
	}
}

1528 
ölöe
 

1529 
	$rdev_£t_âlm
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1530 
√t_devi˚
 *
dev
,

1531 
cfg80211_âlm_∑øms
 *
∑øms
)

1533 
wùhy
 *wùhy = &
rdev
->wiphy;

1534 
ªt
;

1536 i‡(!
rdev
->
›s
->
£t_âlm
)

1537  -
EOPNOTSUPP
;

1539 
	`åa˚_rdev_£t_âlm
(
wùhy
, 
dev
, 
∑øms
);

1540 
ªt
 = 
rdev
->
›s
->
	`£t_âlm
(
wùhy
, 
dev
, 
∑øms
);

1541 
	`åa˚_rdev_ªtu∫_öt
(
wùhy
, 
ªt
);

1543  
ªt
;

1544 
	}
}

	@reg.c

48 
	#¥_fmt
(
fmt
Ë
KBUILD_MODNAME
 ": " 
	)
fmt

50 
	~<löux/kî√l.h
>

51 
	~<löux/exp‹t.h
>

52 
	~<löux/¶ab.h
>

53 
	~<löux/li°.h
>

54 
	~<löux/˘y≥.h
>

55 
	~<löux/∆80211.h
>

56 
	~<löux/∂©f‹m_devi˚.h
>

57 
	~<löux/vîifiˇti⁄.h
>

58 
	~<löux/moduÀ∑øm.h
>

59 
	~<löux/fúmw¨e.h
>

60 
	~<löux/unôs.h
>

62 
	~<√t/cfg80211.h
>

63 
	~"c‹e.h
"

64 
	~"ªg.h
"

65 
	~"rdev-›s.h
"

66 
	~"∆80211.h
"

72 
	#REG_ENFORCE_GRACE_MS
 60000

	)

84 
	eªg_ªque°_åótmít
 {

85 
	mREG_REQ_OK
,

86 
	mREG_REQ_IGNORE
,

87 
	mREG_REQ_INTERSECT
,

88 
	mREG_REQ_ALREADY_SET
,

91 
ªguœt‹y_ªque°
 
	gc‹e_ªque°_w‹ld
 = {

92 .
öôüt‹
 = 
NL80211_REGDOM_SET_BY_CORE
,

93 .
	gÆpha2
[0] = '0',

94 .
	gÆpha2
[1] = '0',

95 .
	göãr£˘
 = 
Ál£
,

96 .
	g¥o˚s£d
 = 
åue
,

97 .
	gcou¡ry_õ_ív
 = 
ENVIRON_ANY
,

104 
ªguœt‹y_ªque°
 
__rcu
 *
	gœ°_ªque°
 =

105 (
__f‹˚
 
__rcu
 *)&
c‹e_ªque°_w‹ld
;

108 
∂©f‹m_devi˚
 *
	gªg_pdev
;

116 c⁄° 
õì80211_ªgdomaö
 
__rcu
 *
	gcfg80211_ªgdomaö
;

123 
	gªg_num_devs_suµ‹t_ba£höt
;

130 
boﬁ
 
	gªg_is_ödo‹
;

131 
DEFINE_SPINLOCK
(
ªg_ödo‹_lock
);

134 
u32
 
	gªg_is_ödo‹_p‹tid
;

136 
ª°‹e_ªguœt‹y_£âögs
(
boﬁ
 
ª£t_u£r
, boﬁ 
ˇched
);

137 
¥öt_ªgdomaö
(c⁄° 
õì80211_ªgdomaö
 *
rd
);

138 
ªg_¥o˚ss_höt
(
ªguœt‹y_ªque°
 *
ªg_ªque°
);

140 c⁄° 
õì80211_ªgdomaö
 *
	$gë_cfg80211_ªgdom
()

142  
	`rcu_dîe„ªn˚_π∆
(
cfg80211_ªgdomaö
);

143 
	}
}

150 c⁄° 
õì80211_ªgdomaö
 *
	$gë_wùhy_ªgdom
(
wùhy
 *wiphy)

152  
	`rcu_dîe„ªn˚_check
(
wùhy
->
ªgd
,

153 
	`lockdï_is_hñd
(&
wùhy
->
mtx
) ||

154 
	`lockdï_π∆_is_hñd
());

155 
	}
}

156 
EXPORT_SYMBOL
(
gë_wùhy_ªgdom
);

158 c⁄° *
	$ªg_dfs_ªgi⁄_°r
(
∆80211_dfs_ªgi⁄s
 
dfs_ªgi⁄
)

160 
dfs_ªgi⁄
) {

161 
NL80211_DFS_UNSET
:

163 
NL80211_DFS_FCC
:

165 
NL80211_DFS_ETSI
:

167 
NL80211_DFS_JP
:

171 
	}
}

173 
∆80211_dfs_ªgi⁄s
 
	$ªg_gë_dfs_ªgi⁄
(
wùhy
 *wiphy)

175 c⁄° 
õì80211_ªgdomaö
 *
ªgd
 = 
NULL
;

176 c⁄° 
õì80211_ªgdomaö
 *
wùhy_ªgd
 = 
NULL
;

177 
∆80211_dfs_ªgi⁄s
 
dfs_ªgi⁄
;

179 
	`rcu_ªad_lock
();

180 
ªgd
 = 
	`gë_cfg80211_ªgdom
();

181 
dfs_ªgi⁄
 = 
ªgd
->dfs_region;

183 i‡(!
wùhy
)

184 
out
;

186 
wùhy_ªgd
 = 
	`gë_wùhy_ªgdom
(
wùhy
);

187 i‡(!
wùhy_ªgd
)

188 
out
;

190 i‡(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
) {

191 
dfs_ªgi⁄
 = 
wùhy_ªgd
->dfs_region;

192 
out
;

195 i‡(
wùhy_ªgd
->
dfs_ªgi⁄
 =
ªgd
->dfs_region)

196 
out
;

198 
	`¥_debug
("%s: device specific dfs_region (%s) disagrees with cfg80211's central dfs_region (%s)\n",

199 
	`dev_«me
(&
wùhy
->
dev
),

200 
	`ªg_dfs_ªgi⁄_°r
(
wùhy_ªgd
->
dfs_ªgi⁄
),

201 
	`ªg_dfs_ªgi⁄_°r
(
ªgd
->
dfs_ªgi⁄
));

203 
out
:

204 
	`rcu_ªad_u∆ock
();

206  
dfs_ªgi⁄
;

207 
	}
}

209 
	$rcu_‰ì_ªgdom
(c⁄° 
õì80211_ªgdomaö
 *
r
)

211 i‡(!
r
)

213 
	`k‰ì_rcu
((
õì80211_ªgdomaö
 *)
r
, 
rcu_hód
);

214 
	}
}

216 
ªguœt‹y_ªque°
 *
	$gë_œ°_ªque°
()

218  
	`rcu_dîe„ªn˚_π∆
(
œ°_ªque°
);

219 
	}
}

222 
LIST_HEAD
(
ªg_ªque°s_li°
);

223 
DEFINE_SPINLOCK
(
ªg_ªque°s_lock
);

226 
LIST_HEAD
(
ªg_≥ndög_bóc⁄s
);

227 
DEFINE_SPINLOCK
(
ªg_≥ndög_bóc⁄s_lock
);

230 
LIST_HEAD
(
ªg_bóc⁄_li°
);

232 
	sªg_bóc⁄
 {

233 
li°_hód
 
	mli°
;

234 
õì80211_ch™√l
 
	mch™
;

237 
ªg_check_ch™s_w‹k
(
w‹k_°ru˘
 *
w‹k
);

238 
DECLARE_DELAYED_WORK
(
ªg_check_ch™s
, 
ªg_check_ch™s_w‹k
);

240 
ªg_todo
(
w‹k_°ru˘
 *
w‹k
);

241 
DECLARE_WORK
(
ªg_w‹k
, 
ªg_todo
);

244 c⁄° 
õì80211_ªgdomaö
 
	gw‹ld_ªgdom
 = {

245 .
n_ªg_ruÀs
 = 8,

246 .
	gÆpha2
 = "00",

247 .
	gªg_ruÀs
 = {

249 
REG_RULE
(2412-10, 2462+10, 40, 6, 20, 0),

251 
REG_RULE
(2467-10, 2472+10, 20, 6, 20,

252 
NL80211_RRF_NO_IR
 | 
NL80211_RRF_AUTO_BW
),

255 
REG_RULE
(2484-10, 2484+10, 20, 6, 20,

256 
NL80211_RRF_NO_IR
 |

257 
NL80211_RRF_NO_OFDM
),

259 
REG_RULE
(5180-10, 5240+10, 80, 6, 20,

260 
NL80211_RRF_NO_IR
 |

261 
NL80211_RRF_AUTO_BW
),

264 
REG_RULE
(5260-10, 5320+10, 80, 6, 20,

265 
NL80211_RRF_NO_IR
 |

266 
NL80211_RRF_AUTO_BW
 |

267 
NL80211_RRF_DFS
),

270 
REG_RULE
(5500-10, 5720+10, 160, 6, 20,

271 
NL80211_RRF_NO_IR
 |

272 
NL80211_RRF_DFS
),

275 
REG_RULE
(5745-10, 5825+10, 80, 6, 20,

276 
NL80211_RRF_NO_IR
),

279 
REG_RULE
(56160+2160*1-1080, 56160+2160*3+1080, 2160, 0, 0, 0),

284 c⁄° 
õì80211_ªgdomaö
 *
	gcfg80211_w‹ld_ªgdom
 =

285 &
w‹ld_ªgdom
;

287 *
	gõì80211_ªgdom
 = "00";

288 
	gu£r_Æpha2
[2];

289 c⁄° 
õì80211_ªgdomaö
 *
	gcfg80211_u£r_ªgdom
;

291 
moduÀ_∑øm
(
õì80211_ªgdom
, 
ch¨p
, 0444);

292 
MODULE_PARM_DESC
(
õì80211_ªgdom
, "IEEE 802.11Ñegulatory domain code");

294 
	$ªg_‰ì_ªque°
(
ªguœt‹y_ªque°
 *
ªque°
)

296 i‡(
ªque°
 =&
c‹e_ªque°_w‹ld
)

299 i‡(
ªque°
 !
	`gë_œ°_ªque°
())

300 
	`k‰ì
(
ªque°
);

301 
	}
}

303 
	$ªg_‰ì_œ°_ªque°
()

305 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

307 i‡(
Ã
 !&
c‹e_ªque°_w‹ld
 &&Ür)

308 
	`k‰ì_rcu
(
Ã
, 
rcu_hód
);

309 
	}
}

311 
	$ªg_upd©e_œ°_ªque°
(
ªguœt‹y_ªque°
 *
ªque°
)

313 
ªguœt‹y_ªque°
 *
Ã
;

315 
Ã
 = 
	`gë_œ°_ªque°
();

316 i‡(
Ã
 =
ªque°
)

319 
	`ªg_‰ì_œ°_ªque°
();

320 
	`rcu_assign_poöãr
(
œ°_ªque°
, 
ªque°
);

321 
	}
}

323 
	$ª£t_ªgdomaös
(
boﬁ
 
fuŒ_ª£t
,

324 c⁄° 
õì80211_ªgdomaö
 *
√w_ªgdom
)

326 c⁄° 
õì80211_ªgdomaö
 *
r
;

328 
	`ASSERT_RTNL
();

330 
r
 = 
	`gë_cfg80211_ªgdom
();

333 i‡(
r
 =
cfg80211_w‹ld_ªgdom
)

334 
r
 = 
NULL
;

335 i‡(
cfg80211_w‹ld_ªgdom
 =&
w‹ld_ªgdom
)

336 
cfg80211_w‹ld_ªgdom
 = 
NULL
;

337 i‡(
r
 =&
w‹ld_ªgdom
)

338 
r
 = 
NULL
;

340 
	`rcu_‰ì_ªgdom
(
r
);

341 
	`rcu_‰ì_ªgdom
(
cfg80211_w‹ld_ªgdom
);

343 
cfg80211_w‹ld_ªgdom
 = &
w‹ld_ªgdom
;

344 
	`rcu_assign_poöãr
(
cfg80211_ªgdomaö
, 
√w_ªgdom
);

346 i‡(!
fuŒ_ª£t
)

349 
	`ªg_upd©e_œ°_ªque°
(&
c‹e_ªque°_w‹ld
);

350 
	}
}

356 
	$upd©e_w‹ld_ªgdomaö
(c⁄° 
õì80211_ªgdomaö
 *
rd
)

358 
ªguœt‹y_ªque°
 *
Ã
;

360 
Ã
 = 
	`gë_œ°_ªque°
();

362 
	`WARN_ON
(!
Ã
);

364 
	`ª£t_ªgdomaös
(
Ál£
, 
rd
);

366 
cfg80211_w‹ld_ªgdom
 = 
rd
;

367 
	}
}

369 
boﬁ
 
	$is_w‹ld_ªgdom
(c⁄° *
Æpha2
)

371 i‡(!
Æpha2
)

372  
Ál£
;

373  
Æpha2
[0] == '0' &&álpha2[1] == '0';

374 
	}
}

376 
boﬁ
 
	$is_Æpha2_£t
(c⁄° *
Æpha2
)

378 i‡(!
Æpha2
)

379  
Ál£
;

380  
Æpha2
[0] &&álpha2[1];

381 
	}
}

383 
boﬁ
 
	$is_unknown_Æpha2
(c⁄° *
Æpha2
)

385 i‡(!
Æpha2
)

386  
Ál£
;

391  
Æpha2
[0] == '9' &&álpha2[1] == '9';

392 
	}
}

394 
boﬁ
 
	$is_öãr£˘ed_Æpha2
(c⁄° *
Æpha2
)

396 i‡(!
Æpha2
)

397  
Ál£
;

403  
Æpha2
[0] == '9' &&álpha2[1] == '8';

404 
	}
}

406 
boﬁ
 
	$is_™_Æpha2
(c⁄° *
Æpha2
)

408 i‡(!
Æpha2
)

409  
Ál£
;

410  
	`ißÕha
(
Æpha2
[0]) && isalpha(alpha2[1]);

411 
	}
}

413 
boﬁ
 
	$Æpha2_equÆ
(c⁄° *
Æpha2_x
, c⁄° *
Æpha2_y
)

415 i‡(!
Æpha2_x
 || !
Æpha2_y
)

416  
Ál£
;

417  
Æpha2_x
[0] =
Æpha2_y
[0] &&álpha2_x[1] ==álpha2_y[1];

418 
	}
}

420 
boﬁ
 
	$ªgdom_ch™ges
(c⁄° *
Æpha2
)

422 c⁄° 
õì80211_ªgdomaö
 *
r
 = 
	`gë_cfg80211_ªgdom
();

424 i‡(!
r
)

425  
åue
;

426  !
	`Æpha2_equÆ
(
r
->
Æpha2
,álpha2);

427 
	}
}

434 
boﬁ
 
	$is_u£r_ªgdom_ßved
()

436 i‡(
u£r_Æpha2
[0] == '9' && user_alpha2[1] == '7')

437  
Ál£
;

440 i‡(
	`WARN
(!
	`is_w‹ld_ªgdom
(
u£r_Æpha2
Ë&& !
	`is_™_Æpha2
(user_alpha2),

442 
u£r_Æpha2
[0], user_alpha2[1]))

443  
Ál£
;

445  
åue
;

446 
	}
}

448 c⁄° 
õì80211_ªgdomaö
 *

449 
	$ªg_c›y_ªgd
(c⁄° 
õì80211_ªgdomaö
 *
§c_ªgd
)

451 
õì80211_ªgdomaö
 *
ªgd
;

452 
i
;

454 
ªgd
 = 
	`kzÆloc
(
	`°ru˘_size
‘egd, 
ªg_ruÀs
, 
§c_ªgd
->
n_ªg_ruÀs
),

455 
GFP_KERNEL
);

456 i‡(!
ªgd
)

457  
	`ERR_PTR
(-
ENOMEM
);

459 
	`mem˝y
(
ªgd
, 
§c_ªgd
, (
õì80211_ªgdomaö
));

461 
i
 = 0; i < 
§c_ªgd
->
n_ªg_ruÀs
; i++)

462 
	`mem˝y
(&
ªgd
->
ªg_ruÀs
[
i
], &
§c_ªgd
->reg_rules[i],

463 (
õì80211_ªg_ruÀ
));

465  
ªgd
;

466 
	}
}

468 
	$cfg80211_ßve_u£r_ªgdom
(c⁄° 
õì80211_ªgdomaö
 *
rd
)

470 
	`ASSERT_RTNL
();

472 i‡(!
	`IS_ERR
(
cfg80211_u£r_ªgdom
))

473 
	`k‰ì
(
cfg80211_u£r_ªgdom
);

474 
cfg80211_u£r_ªgdom
 = 
	`ªg_c›y_ªgd
(
rd
);

475 
	}
}

477 
	sªg_ªgdb_≠∂y_ªque°
 {

478 
li°_hód
 
	mli°
;

479 c⁄° 
õì80211_ªgdomaö
 *
	mªgdom
;

482 
LIST_HEAD
(
ªg_ªgdb_≠∂y_li°
);

483 
DEFINE_MUTEX
(
ªg_ªgdb_≠∂y_muãx
);

485 
	$ªg_ªgdb_≠∂y
(
w‹k_°ru˘
 *
w‹k
)

487 
ªg_ªgdb_≠∂y_ªque°
 *
ªque°
;

489 
	`π∆_lock
();

491 
	`muãx_lock
(&
ªg_ªgdb_≠∂y_muãx
);

492 !
	`li°_em±y
(&
ªg_ªgdb_≠∂y_li°
)) {

493 
ªque°
 = 
	`li°_fú°_íåy
(&
ªg_ªgdb_≠∂y_li°
,

494 
ªg_ªgdb_≠∂y_ªque°
,

495 
li°
);

496 
	`li°_dñ
(&
ªque°
->
li°
);

498 
	`£t_ªgdom
(
ªque°
->
ªgdom
, 
REGD_SOURCE_INTERNAL_DB
);

499 
	`k‰ì
(
ªque°
);

501 
	`muãx_u∆ock
(&
ªg_ªgdb_≠∂y_muãx
);

503 
	`π∆_u∆ock
();

504 
	}
}

506 
DECLARE_WORK
(
ªg_ªgdb_w‹k
, 
ªg_ªgdb_≠∂y
);

508 
	$ªg_scheduÀ_≠∂y
(c⁄° 
õì80211_ªgdomaö
 *
ªgdom
)

510 
ªg_ªgdb_≠∂y_ªque°
 *
ªque°
;

512 
ªque°
 = 
	`kzÆloc
((
ªg_ªgdb_≠∂y_ªque°
), 
GFP_KERNEL
);

513 i‡(!
ªque°
) {

514 
	`k‰ì
(
ªgdom
);

515  -
ENOMEM
;

518 
ªque°
->
ªgdom
 =Ñegdom;

520 
	`muãx_lock
(&
ªg_ªgdb_≠∂y_muãx
);

521 
	`li°_add_èû
(&
ªque°
->
li°
, &
ªg_ªgdb_≠∂y_li°
);

522 
	`muãx_u∆ock
(&
ªg_ªgdb_≠∂y_muãx
);

524 
	`scheduÀ_w‹k
(&
ªg_ªgdb_w‹k
);

526 
	}
}

528 #ifde‡
CONFIG_CFG80211_CRDA_SUPPORT


530 
	#REG_MAX_CRDA_TIMEOUTS
 10

	)

532 
u32
 
	gªg_¸da_timeouts
;

534 
¸da_timeout_w‹k
(
w‹k_°ru˘
 *
w‹k
);

535 
DECLARE_DELAYED_WORK
(
¸da_timeout
, 
¸da_timeout_w‹k
);

537 
	$¸da_timeout_w‹k
(
w‹k_°ru˘
 *
w‹k
)

539 
	`¥_debug
("Timeout while waiting for CRDAÅoÑeply,ÑestoringÑegulatory settings\n");

540 
	`π∆_lock
();

541 
ªg_¸da_timeouts
++;

542 
	`ª°‹e_ªguœt‹y_£âögs
(
åue
, 
Ál£
);

543 
	`π∆_u∆ock
();

544 
	}
}

546 
	$ˇn˚l_¸da_timeout
()

548 
	`ˇn˚l_dñayed_w‹k
(&
¸da_timeout
);

549 
	}
}

551 
	$ˇn˚l_¸da_timeout_sync
()

553 
	`ˇn˚l_dñayed_w‹k_sync
(&
¸da_timeout
);

554 
	}
}

556 
	$ª£t_¸da_timeouts
()

558 
ªg_¸da_timeouts
 = 0;

559 
	}
}

565 
	$ˇŒ_¸da
(c⁄° *
Æpha2
)

567 
cou¡ry
[12];

568 *
ív
[] = { 
cou¡ry
, 
NULL
 };

569 
ªt
;

571 
	`¢¥ötf
(
cou¡ry
, (country), "COUNTRY=%c%c",

572 
Æpha2
[0],álpha2[1]);

574 i‡(
ªg_¸da_timeouts
 > 
REG_MAX_CRDA_TIMEOUTS
) {

575 
	`¥_debug
("Exceeded CRDA call maxáttempts. Not calling CRDA\n");

576  -
EINVAL
;

579 i‡(!
	`is_w‹ld_ªgdom
((*Ë
Æpha2
))

580 
	`¥_debug
("Calling CRDA for country: %c%c\n",

581 
Æpha2
[0],álpha2[1]);

583 
	`¥_debug
("Calling CRDAÅo update worldÑegulatory domain\n");

585 
ªt
 = 
	`kobje˘_uevít_ív
(&
ªg_pdev
->
dev
.
kobj
, 
KOBJ_CHANGE
, 
ív
);

586 i‡(
ªt
)

587  
ªt
;

589 
	`queue_dñayed_w‹k
(
sy°em_powî_efficõ¡_wq
,

590 &
¸da_timeout
, 
	`m£cs_to_jiffõs
(3142));

592 
	}
}

594 
ölöe
 
	$ˇn˚l_¸da_timeout
(Ë{
	}
}

595 
ölöe
 
	$ˇn˚l_¸da_timeout_sync
(Ë{
	}
}

596 
ölöe
 
	$ª£t_¸da_timeouts
(Ë{
	}
}

597 
ölöe
 
	$ˇŒ_¸da
(c⁄° *
Æpha2
)

599  -
ENODATA
;

600 
	}
}

604 c⁄° 
fwdb_hódî
 *
	gªgdb
;

606 
	sfwdb_cou¡ry
 {

607 
u8
 
	mÆpha2
[2];

608 
__be16
 
	mcﬁl_±r
;

610 } 
__∑cked
 
__Æig√d
(4);

612 
	sfwdb_cﬁÀ˘i⁄
 {

613 
u8
 
	mÀn
;

614 
u8
 
	mn_ruÀs
;

615 
u8
 
	mdfs_ªgi⁄
;

618 } 
__∑cked
 
__Æig√d
(4);

620 
	efwdb_Êags
 {

621 
	mFWDB_FLAG_NO_OFDM
 = 
BIT
(0),

622 
	mFWDB_FLAG_NO_OUTDOOR
 = 
BIT
(1),

623 
	mFWDB_FLAG_DFS
 = 
BIT
(2),

624 
	mFWDB_FLAG_NO_IR
 = 
BIT
(3),

625 
	mFWDB_FLAG_AUTO_BW
 = 
BIT
(4),

628 
	sfwdb_wmm_ac
 {

629 
u8
 
	mecw
;

630 
u8
 
	maif¢
;

631 
__be16
 
	mcŸ
;

632 } 
	g__∑cked
;

634 
	sfwdb_wmm_ruÀ
 {

635 
fwdb_wmm_ac
 
	m˛õ¡
[
IEEE80211_NUM_ACS
];

636 
fwdb_wmm_ac
 
	m≠
[
IEEE80211_NUM_ACS
];

637 } 
	g__∑cked
;

639 
	sfwdb_ruÀ
 {

640 
u8
 
	mÀn
;

641 
u8
 
	mÊags
;

642 
__be16
 
	mmax_eúp
;

643 
__be32
 
	m°¨t
, 
	míd
, 
	mmax_bw
;

645 
__be16
 
	mˇc_timeout
;

646 
__be16
 
	mwmm_±r
;

647 } 
__∑cked
 
__Æig√d
(4);

649 
	#FWDB_MAGIC
 0x52474442

	)

650 
	#FWDB_VERSION
 20

	)

652 
	sfwdb_hódî
 {

653 
__be32
 
	mmagic
;

654 
__be32
 
	mvîsi⁄
;

655 
fwdb_cou¡ry
 
	mcou¡ry
[];

656 } 
__∑cked
 
__Æig√d
(4);

658 
	$ecw2cw
(
ecw
)

660  (1 << 
ecw
) - 1;

661 
	}
}

663 
boﬁ
 
	$vÆid_wmm
(
fwdb_wmm_ruÀ
 *
ruÀ
)

665 
fwdb_wmm_ac
 *
ac
 = (fwdb_wmm_a¯*)
ruÀ
;

666 
i
;

668 
i
 = 0; i < 
IEEE80211_NUM_ACS
 * 2; i++) {

669 
u16
 
cw_mö
 = 
	`ecw2cw
((
ac
[
i
].
ecw
 & 0xf0) >> 4);

670 
u16
 
cw_max
 = 
	`ecw2cw
(
ac
[
i
].
ecw
 & 0x0f);

671 
u8
 
aif¢
 = 
ac
[
i
].aifsn;

673 i‡(
cw_mö
 >
cw_max
)

674  
Ál£
;

676 i‡(
aif¢
 < 1)

677  
Ál£
;

680  
åue
;

681 
	}
}

683 
boﬁ
 
	$vÆid_ruÀ
(c⁄° 
u8
 *
d©a
, 
size
, 
u16
 
ruÀ_±r
)

685 
fwdb_ruÀ
 *
ruÀ
 = (*)(
d©a
 + (
ruÀ_±r
 << 2));

687 i‡((
u8
 *)
ruÀ
 + ‘uÀ->
Àn
Ë> 
d©a
 + 
size
)

688  
Ál£
;

691 i‡(
ruÀ
->
Àn
 < 
	`off£to„nd
(
fwdb_ruÀ
, 
max_bw
))

692  
Ál£
;

693 i‡(
ruÀ
->
Àn
 >
	`off£to„nd
(
fwdb_ruÀ
, 
wmm_±r
)) {

694 
u32
 
wmm_±r
 = 
	`be16_to_˝u
(
ruÀ
->wmm_ptr) << 2;

695 
fwdb_wmm_ruÀ
 *
wmm
;

697 i‡(
wmm_±r
 + (
fwdb_wmm_ruÀ
Ë> 
size
)

698  
Ál£
;

700 
wmm
 = (*)(
d©a
 + 
wmm_±r
);

702 i‡(!
	`vÆid_wmm
(
wmm
))

703  
Ál£
;

705  
åue
;

706 
	}
}

708 
boﬁ
 
	$vÆid_cou¡ry
(c⁄° 
u8
 *
d©a
, 
size
,

709 c⁄° 
fwdb_cou¡ry
 *
cou¡ry
)

711 
±r
 = 
	`be16_to_˝u
(
cou¡ry
->
cﬁl_±r
) << 2;

712 
fwdb_cﬁÀ˘i⁄
 *
cﬁl
 = (*)(
d©a
 + 
±r
);

713 
__be16
 *
ruÀs_±r
;

714 
i
;

717 i‡((
u8
 *)
cﬁl
 + 
	`off£to„nd
(
	`ty≥of
(*cﬁl), 
n_ruÀs
Ë> 
d©a
 + 
size
)

718  
Ál£
;

721 i‡((
u8
 *)
cﬁl
 + 
	`ALIGN
(cﬁl->
Àn
, 2) +

722 (
cﬁl
->
n_ruÀs
 * 2Ë> 
d©a
 + 
size
)

723  
Ál£
;

726 i‡(
cﬁl
->
Àn
 < 
	`off£to„nd
(
fwdb_cﬁÀ˘i⁄
, 
dfs_ªgi⁄
))

727  
Ál£
;

729 
ruÀs_±r
 = (*)((
u8
 *)
cﬁl
 + 
	`ALIGN
(cﬁl->
Àn
, 2));

731 
i
 = 0; i < 
cﬁl
->
n_ruÀs
; i++) {

732 
u16
 
ruÀ_±r
 = 
	`be16_to_˝u
(
ruÀs_±r
[
i
]);

734 i‡(!
	`vÆid_ruÀ
(
d©a
, 
size
, 
ruÀ_±r
))

735  
Ál£
;

738  
åue
;

739 
	}
}

741 #ifde‡
CONFIG_CFG80211_REQUIRE_SIGNED_REGDB


742 
	~<keys/asymmëric-ty≥.h
>

744 
key
 *
	gbuûtö_ªgdb_keys
;

746 
__öô
 
	$lﬂd_buûtö_ªgdb_keys
()

748 
buûtö_ªgdb_keys
 =

749 
	`keyrög_Æloc
(".builtin_regdb_keys",

750 
	`KUIDT_INIT
(0), 
	`KGIDT_INIT
(0), 
	`cuºít_¸ed
(),

751 ((
KEY_POS_ALL
 & ~
KEY_POS_SETATTR
) |

752 
KEY_USR_VIEW
 | 
KEY_USR_READ
 | 
KEY_USR_SEARCH
),

753 
KEY_ALLOC_NOT_IN_QUOTA
, 
NULL
, NULL);

754 i‡(
	`IS_ERR
(
buûtö_ªgdb_keys
))

755  
	`PTR_ERR
(
buûtö_ªgdb_keys
);

757 
	`¥_nŸi˚
("Loading compiled-in X.509 certificates forÑegulatory database\n");

759 #ifde‡
CONFIG_CFG80211_USE_KERNEL_REGDB_KEYS


760 
	`x509_lﬂd_˚πifiˇã_li°
(
shù≥d_ªgdb_˚πs
,

761 
shù≥d_ªgdb_˚πs_Àn
,

762 
buûtö_ªgdb_keys
);

764 #ifde‡
CONFIG_CFG80211_EXTRA_REGDB_KEYDIR


765 i‡(
CONFIG_CFG80211_EXTRA_REGDB_KEYDIR
[0] != '\0')

766 
	`x509_lﬂd_˚πifiˇã_li°
(
exåa_ªgdb_˚πs
,

767 
exåa_ªgdb_˚πs_Àn
,

768 
buûtö_ªgdb_keys
);

772 
	}
}

774 
MODULE_FIRMWARE
("regulatory.db.p7s");

776 
boﬁ
 
	$ªgdb_has_vÆid_sig«tuª
(c⁄° 
u8
 *
d©a
, 
size
)

778 c⁄° 
fúmw¨e
 *
sig
;

779 
boﬁ
 
ªsu…
;

781 i‡(
	`ªque°_fúmw¨e
(&
sig
, "ªguœt‹y.db.p7s", &
ªg_pdev
->
dev
))

782  
Ál£
;

784 
ªsu…
 = 
	`vîify_pkcs7_sig«tuª
(
d©a
, 
size
, 
sig
->data, sig->size,

785 
buûtö_ªgdb_keys
,

786 
VERIFYING_UNSPECIFIED_SIGNATURE
,

787 
NULL
, NULL) == 0;

789 
	`ªÀa£_fúmw¨e
(
sig
);

791  
ªsu…
;

792 
	}
}

794 
	$‰ì_ªgdb_keyrög
()

796 
	`key_put
(
buûtö_ªgdb_keys
);

797 
	}
}

799 
	$lﬂd_buûtö_ªgdb_keys
()

802 
	}
}

804 
boﬁ
 
	$ªgdb_has_vÆid_sig«tuª
(c⁄° 
u8
 *
d©a
, 
size
)

806  
åue
;

807 
	}
}

809 
	$‰ì_ªgdb_keyrög
()

811 
	}
}

814 
boﬁ
 
	$vÆid_ªgdb
(c⁄° 
u8
 *
d©a
, 
size
)

816 c⁄° 
fwdb_hódî
 *
hdr
 = (*)
d©a
;

817 c⁄° 
fwdb_cou¡ry
 *
cou¡ry
;

819 i‡(
size
 < (*
hdr
))

820  
Ál£
;

822 i‡(
hdr
->
magic
 !
	`˝u_to_be32
(
FWDB_MAGIC
))

823  
Ál£
;

825 i‡(
hdr
->
vîsi⁄
 !
	`˝u_to_be32
(
FWDB_VERSION
))

826  
Ál£
;

828 i‡(!
	`ªgdb_has_vÆid_sig«tuª
(
d©a
, 
size
))

829  
Ál£
;

831 
cou¡ry
 = &
hdr
->country[0];

832 (
u8
 *)(
cou¡ry
 + 1Ë<
d©a
 + 
size
) {

833 i‡(!
cou¡ry
->
cﬁl_±r
)

835 i‡(!
	`vÆid_cou¡ry
(
d©a
, 
size
, 
cou¡ry
))

836  
Ál£
;

837 
cou¡ry
++;

840  
åue
;

841 
	}
}

843 
	$£t_wmm_ruÀ
(c⁄° 
fwdb_hódî
 *
db
,

844 c⁄° 
fwdb_cou¡ry
 *
cou¡ry
,

845 c⁄° 
fwdb_ruÀ
 *
ruÀ
,

846 
õì80211_ªg_ruÀ
 *
ºuÀ
)

848 
õì80211_wmm_ruÀ
 *
wmm_ruÀ
 = &
ºuÀ
->wmm_rule;

849 
fwdb_wmm_ruÀ
 *
wmm
;

850 
i
, 
wmm_±r
;

852 
wmm_±r
 = 
	`be16_to_˝u
(
ruÀ
->wmm_ptr) << 2;

853 
wmm
 = (*)((
u8
 *)
db
 + 
wmm_±r
);

855 i‡(!
	`vÆid_wmm
(
wmm
)) {

856 
	`¥_îr
("InvalidÑegulatory WMMÑule %u-%u in domain %c%c\n",

857 
	`be32_to_˝u
(
ruÀ
->
°¨t
), be32_to_˝u‘uÀ->
íd
),

858 
cou¡ry
->
Æpha2
[0], country->alpha2[1]);

862 
i
 = 0; i < 
IEEE80211_NUM_ACS
; i++) {

863 
wmm_ruÀ
->
˛õ¡
[
i
].
cw_mö
 =

864 
	`ecw2cw
((
wmm
->
˛õ¡
[
i
].
ecw
 & 0xf0) >> 4);

865 
wmm_ruÀ
->
˛õ¡
[
i
].
cw_max
 = 
	`ecw2cw
(
wmm
->˛õ¡[i].
ecw
 & 0x0f);

866 
wmm_ruÀ
->
˛õ¡
[
i
].
aif¢
 = 
wmm
->client[i].aifsn;

867 
wmm_ruÀ
->
˛õ¡
[
i
].
cŸ
 =

868 1000 * 
	`be16_to_˝u
(
wmm
->
˛õ¡
[
i
].
cŸ
);

869 
wmm_ruÀ
->
≠
[
i
].
cw_mö
 = 
	`ecw2cw
((
wmm
->≠[i].
ecw
 & 0xf0) >> 4);

870 
wmm_ruÀ
->
≠
[
i
].
cw_max
 = 
	`ecw2cw
(
wmm
->≠[i].
ecw
 & 0x0f);

871 
wmm_ruÀ
->
≠
[
i
].
aif¢
 = 
wmm
->ap[i].aifsn;

872 
wmm_ruÀ
->
≠
[
i
].
cŸ
 = 1000 * 
	`be16_to_˝u
(
wmm
->ap[i].cot);

875 
ºuÀ
->
has_wmm
 = 
åue
;

876 
	}
}

878 
	$__ªgdb_quîy_wmm
(c⁄° 
fwdb_hódî
 *
db
,

879 c⁄° 
fwdb_cou¡ry
 *
cou¡ry
, 
‰eq
,

880 
õì80211_ªg_ruÀ
 *
ºuÀ
)

882 
±r
 = 
	`be16_to_˝u
(
cou¡ry
->
cﬁl_±r
) << 2;

883 
fwdb_cﬁÀ˘i⁄
 *
cﬁl
 = (*)((
u8
 *)
db
 + 
±r
);

884 
i
;

886 
i
 = 0; i < 
cﬁl
->
n_ruÀs
; i++) {

887 
__be16
 *
ruÀs_±r
 = (*)((
u8
 *)
cﬁl
 + 
	`ALIGN
(cﬁl->
Àn
, 2));

888 
ruÀ_±r
 = 
	`be16_to_˝u
(
ruÀs_±r
[
i
]) << 2;

889 
fwdb_ruÀ
 *
ruÀ
 = (*)((
u8
 *)
db
 + 
ruÀ_±r
);

891 i‡(
ruÀ
->
Àn
 < 
	`off£to„nd
(
fwdb_ruÀ
, 
wmm_±r
))

894 i‡(
‰eq
 >
	`KHZ_TO_MHZ
(
	`be32_to_˝u
(
ruÀ
->
°¨t
)) &&

895 
‰eq
 <
	`KHZ_TO_MHZ
(
	`be32_to_˝u
(
ruÀ
->
íd
))) {

896 
	`£t_wmm_ruÀ
(
db
, 
cou¡ry
, 
ruÀ
, 
ºuÀ
);

901  -
ENODATA
;

902 
	}
}

904 
	$ªg_quîy_ªgdb_wmm
(*
Æpha2
, 
‰eq
, 
õì80211_ªg_ruÀ
 *
ruÀ
)

906 c⁄° 
fwdb_hódî
 *
hdr
 = 
ªgdb
;

907 c⁄° 
fwdb_cou¡ry
 *
cou¡ry
;

909 i‡(!
ªgdb
)

910  -
ENODATA
;

912 i‡(
	`IS_ERR
(
ªgdb
))

913  
	`PTR_ERR
(
ªgdb
);

915 
cou¡ry
 = &
hdr
->country[0];

916 
cou¡ry
->
cﬁl_±r
) {

917 i‡(
	`Æpha2_equÆ
(
Æpha2
, 
cou¡ry
->alpha2))

918  
	`__ªgdb_quîy_wmm
(
ªgdb
, 
cou¡ry
, 
‰eq
, 
ruÀ
);

920 
cou¡ry
++;

923  -
ENODATA
;

924 
	}
}

925 
EXPORT_SYMBOL
(
ªg_quîy_ªgdb_wmm
);

927 
	$ªgdb_quîy_cou¡ry
(c⁄° 
fwdb_hódî
 *
db
,

928 c⁄° 
fwdb_cou¡ry
 *
cou¡ry
)

930 
±r
 = 
	`be16_to_˝u
(
cou¡ry
->
cﬁl_±r
) << 2;

931 
fwdb_cﬁÀ˘i⁄
 *
cﬁl
 = (*)((
u8
 *)
db
 + 
±r
);

932 
õì80211_ªgdomaö
 *
ªgdom
;

933 
i
;

935 
ªgdom
 = 
	`kzÆloc
(
	`°ru˘_size
‘egdom, 
ªg_ruÀs
, 
cﬁl
->
n_ruÀs
),

936 
GFP_KERNEL
);

937 i‡(!
ªgdom
)

938  -
ENOMEM
;

940 
ªgdom
->
n_ªg_ruÀs
 = 
cﬁl
->
n_ruÀs
;

941 
ªgdom
->
Æpha2
[0] = 
cou¡ry
->alpha2[0];

942 
ªgdom
->
Æpha2
[1] = 
cou¡ry
->alpha2[1];

943 
ªgdom
->
dfs_ªgi⁄
 = 
cﬁl
->dfs_region;

945 
i
 = 0; i < 
ªgdom
->
n_ªg_ruÀs
; i++) {

946 
__be16
 *
ruÀs_±r
 = (*)((
u8
 *)
cﬁl
 + 
	`ALIGN
(cﬁl->
Àn
, 2));

947 
ruÀ_±r
 = 
	`be16_to_˝u
(
ruÀs_±r
[
i
]) << 2;

948 
fwdb_ruÀ
 *
ruÀ
 = (*)((
u8
 *)
db
 + 
ruÀ_±r
);

949 
õì80211_ªg_ruÀ
 *
ºuÀ
 = &
ªgdom
->
ªg_ruÀs
[
i
];

951 
ºuÀ
->
‰eq_ønge
.
°¨t_‰eq_khz
 = 
	`be32_to_˝u
(
ruÀ
->
°¨t
);

952 
ºuÀ
->
‰eq_ønge
.
íd_‰eq_khz
 = 
	`be32_to_˝u
(
ruÀ
->
íd
);

953 
ºuÀ
->
‰eq_ønge
.
max_b™dwidth_khz
 = 
	`be32_to_˝u
(
ruÀ
->
max_bw
);

955 
ºuÀ
->
powî_ruÀ
.
max_™ã¬a_gaö
 = 0;

956 
ºuÀ
->
powî_ruÀ
.
max_eúp
 = 
	`be16_to_˝u
(
ruÀ
->max_eirp);

958 
ºuÀ
->
Êags
 = 0;

959 i‡(
ruÀ
->
Êags
 & 
FWDB_FLAG_NO_OFDM
)

960 
ºuÀ
->
Êags
 |
NL80211_RRF_NO_OFDM
;

961 i‡(
ruÀ
->
Êags
 & 
FWDB_FLAG_NO_OUTDOOR
)

962 
ºuÀ
->
Êags
 |
NL80211_RRF_NO_OUTDOOR
;

963 i‡(
ruÀ
->
Êags
 & 
FWDB_FLAG_DFS
)

964 
ºuÀ
->
Êags
 |
NL80211_RRF_DFS
;

965 i‡(
ruÀ
->
Êags
 & 
FWDB_FLAG_NO_IR
)

966 
ºuÀ
->
Êags
 |
NL80211_RRF_NO_IR
;

967 i‡(
ruÀ
->
Êags
 & 
FWDB_FLAG_AUTO_BW
)

968 
ºuÀ
->
Êags
 |
NL80211_RRF_AUTO_BW
;

970 
ºuÀ
->
dfs_ˇc_ms
 = 0;

973 i‡(
ruÀ
->
Àn
 >
	`off£to„nd
(
fwdb_ruÀ
, 
ˇc_timeout
))

974 
ºuÀ
->
dfs_ˇc_ms
 =

975 1000 * 
	`be16_to_˝u
(
ruÀ
->
ˇc_timeout
);

976 i‡(
ruÀ
->
Àn
 >
	`off£to„nd
(
fwdb_ruÀ
, 
wmm_±r
))

977 
	`£t_wmm_ruÀ
(
db
, 
cou¡ry
, 
ruÀ
, 
ºuÀ
);

980  
	`ªg_scheduÀ_≠∂y
(
ªgdom
);

981 
	}
}

983 
	$quîy_ªgdb
(c⁄° *
Æpha2
)

985 c⁄° 
fwdb_hódî
 *
hdr
 = 
ªgdb
;

986 c⁄° 
fwdb_cou¡ry
 *
cou¡ry
;

988 
	`ASSERT_RTNL
();

990 i‡(
	`IS_ERR
(
ªgdb
))

991  
	`PTR_ERR
(
ªgdb
);

993 
cou¡ry
 = &
hdr
->country[0];

994 
cou¡ry
->
cﬁl_±r
) {

995 i‡(
	`Æpha2_equÆ
(
Æpha2
, 
cou¡ry
->alpha2))

996  
	`ªgdb_quîy_cou¡ry
(
ªgdb
, 
cou¡ry
);

997 
cou¡ry
++;

1000  -
ENODATA
;

1001 
	}
}

1003 
	$ªgdb_fw_cb
(c⁄° 
fúmw¨e
 *
fw
, *
c⁄ãxt
)

1005 
£t_îr‹
 = 0;

1006 
boﬁ
 
ª°‹e
 = 
åue
;

1007 *
db
;

1009 i‡(!
fw
) {

1010 
	`¥_öfo
("failedÅoÜoadÑegulatory.db\n");

1011 
£t_îr‹
 = -
ENODATA
;

1012 } i‡(!
	`vÆid_ªgdb
(
fw
->
d©a
, fw->
size
)) {

1013 
	`¥_öfo
("loadedÑegulatory.db is malformed or signature is missing/invalid\n");

1014 
£t_îr‹
 = -
EINVAL
;

1017 
	`π∆_lock
();

1018 i‡(
ªgdb
 && !
	`IS_ERR
(regdb)) {

1025 } i‡(
£t_îr‹
) {

1026 
ªgdb
 = 
	`ERR_PTR
(
£t_îr‹
);

1027 } i‡(
fw
) {

1028 
db
 = 
	`kmemdup
(
fw
->
d©a
, fw->
size
, 
GFP_KERNEL
);

1029 i‡(
db
) {

1030 
ªgdb
 = 
db
;

1031 
ª°‹e
 = 
c⁄ãxt
 && 
	`quîy_ªgdb
(context);

1033 
ª°‹e
 = 
åue
;

1037 i‡(
ª°‹e
)

1038 
	`ª°‹e_ªguœt‹y_£âögs
(
åue
, 
Ál£
);

1040 
	`π∆_u∆ock
();

1042 
	`k‰ì
(
c⁄ãxt
);

1044 
	`ªÀa£_fúmw¨e
(
fw
);

1045 
	}
}

1047 
MODULE_FIRMWARE
("regulatory.db");

1049 
	$quîy_ªgdb_fûe
(c⁄° *
Æpha2
)

1051 
îr
;

1053 
	`ASSERT_RTNL
();

1055 i‡(
ªgdb
)

1056  
	`quîy_ªgdb
(
Æpha2
);

1058 
Æpha2
 = 
	`kmemdup
◊Õha2, 2, 
GFP_KERNEL
);

1059 i‡(!
Æpha2
)

1060  -
ENOMEM
;

1062 
îr
 = 
	`ªque°_fúmw¨e_nowaô
(
THIS_MODULE
, 
åue
, "regulatory.db",

1063 &
ªg_pdev
->
dev
, 
GFP_KERNEL
,

1064 (*)
Æpha2
, 
ªgdb_fw_cb
);

1065 i‡(
îr
)

1066 
	`k‰ì
(
Æpha2
);

1068  
îr
;

1069 
	}
}

1071 
	$ªg_ªlﬂd_ªgdb
()

1073 c⁄° 
fúmw¨e
 *
fw
;

1074 *
db
;

1075 
îr
;

1076 c⁄° 
õì80211_ªgdomaö
 *
cuºít_ªgdomaö
;

1077 
ªguœt‹y_ªque°
 *
ªque°
;

1079 
îr
 = 
	`ªque°_fúmw¨e
(&
fw
, "ªguœt‹y.db", &
ªg_pdev
->
dev
);

1080 i‡(
îr
)

1081  
îr
;

1083 i‡(!
	`vÆid_ªgdb
(
fw
->
d©a
, fw->
size
)) {

1084 
îr
 = -
ENODATA
;

1085 
out
;

1088 
db
 = 
	`kmemdup
(
fw
->
d©a
, fw->
size
, 
GFP_KERNEL
);

1089 i‡(!
db
) {

1090 
îr
 = -
ENOMEM
;

1091 
out
;

1094 
	`π∆_lock
();

1095 i‡(!
	`IS_ERR_OR_NULL
(
ªgdb
))

1096 
	`k‰ì
(
ªgdb
);

1097 
ªgdb
 = 
db
;

1100 
cuºít_ªgdomaö
 = 
	`gë_cfg80211_ªgdom
();

1102 
ªque°
 = 
	`kzÆloc
((*ªque°), 
GFP_KERNEL
);

1103 i‡(!
ªque°
) {

1104 
îr
 = -
ENOMEM
;

1105 
out_u∆ock
;

1108 
ªque°
->
wùhy_idx
 = 
WIPHY_IDX_INVALID
;

1109 
ªque°
->
Æpha2
[0] = 
cuºít_ªgdomaö
->alpha2[0];

1110 
ªque°
->
Æpha2
[1] = 
cuºít_ªgdomaö
->alpha2[1];

1111 
ªque°
->
öôüt‹
 = 
NL80211_REGDOM_SET_BY_CORE
;

1112 
ªque°
->
u£r_ªg_höt_ty≥
 = 
NL80211_USER_REG_HINT_USER
;

1114 
	`ªg_¥o˚ss_höt
(
ªque°
);

1116 
out_u∆ock
:

1117 
	`π∆_u∆ock
();

1118 
out
:

1119 
	`ªÀa£_fúmw¨e
(
fw
);

1120  
îr
;

1121 
	}
}

1123 
boﬁ
 
	$ªg_quîy_d©aba£
(
ªguœt‹y_ªque°
 *
ªque°
)

1125 i‡(
	`quîy_ªgdb_fûe
(
ªque°
->
Æpha2
) == 0)

1126  
åue
;

1128 i‡(
	`ˇŒ_¸da
(
ªque°
->
Æpha2
) == 0)

1129  
åue
;

1131  
Ál£
;

1132 
	}
}

1134 
boﬁ
 
	$ªg_is_vÆid_ªque°
(c⁄° *
Æpha2
)

1136 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

1138 i‡(!
Ã
 ||Ür->
¥o˚s£d
)

1139  
Ál£
;

1141  
	`Æpha2_equÆ
(
Ã
->
Æpha2
,álpha2);

1142 
	}
}

1144 c⁄° 
õì80211_ªgdomaö
 *
	$ªg_gë_ªgdomaö
(
wùhy
 *wiphy)

1146 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

1152 i‡(
Ã
->
öôüt‹
 !
NL80211_REGDOM_SET_BY_COUNTRY_IE
 &&

1153 
Ã
->
öôüt‹
 !
NL80211_REGDOM_SET_BY_USER
 &&

1154 
wùhy
->
ªgd
)

1155  
	`gë_wùhy_ªgdom
(
wùhy
);

1157  
	`gë_cfg80211_ªgdom
();

1158 
	}
}

1161 
	$ªg_gë_max_b™dwidth_‰om_ønge
(c⁄° 
õì80211_ªgdomaö
 *
rd
,

1162 c⁄° 
õì80211_ªg_ruÀ
 *
ruÀ
)

1164 c⁄° 
õì80211_‰eq_ønge
 *
‰eq_ønge
 = &
ruÀ
->freq_range;

1165 c⁄° 
õì80211_‰eq_ønge
 *
‰eq_ønge_tmp
;

1166 c⁄° 
õì80211_ªg_ruÀ
 *
tmp
;

1167 
u32
 
°¨t_‰eq
, 
íd_‰eq
, 
idx
, 
no
;

1169 
idx
 = 0; idx < 
rd
->
n_ªg_ruÀs
; idx++)

1170 i‡(
ruÀ
 =&
rd
->
ªg_ruÀs
[
idx
])

1173 i‡(
idx
 =
rd
->
n_ªg_ruÀs
)

1177 
no
 = 
idx
;

1179 
no
) {

1180 
tmp
 = &
rd
->
ªg_ruÀs
[--
no
];

1181 
‰eq_ønge_tmp
 = &
tmp
->
‰eq_ønge
;

1183 i‡(
‰eq_ønge_tmp
->
íd_‰eq_khz
 < 
‰eq_ønge
->
°¨t_‰eq_khz
)

1186 
‰eq_ønge
 = 
‰eq_ønge_tmp
;

1189 
°¨t_‰eq
 = 
‰eq_ønge
->
°¨t_‰eq_khz
;

1192 
‰eq_ønge
 = &
ruÀ
->freq_range;

1193 
no
 = 
idx
;

1195 
no
 < 
rd
->
n_ªg_ruÀs
 - 1) {

1196 
tmp
 = &
rd
->
ªg_ruÀs
[++
no
];

1197 
‰eq_ønge_tmp
 = &
tmp
->
‰eq_ønge
;

1199 i‡(
‰eq_ønge_tmp
->
°¨t_‰eq_khz
 > 
‰eq_ønge
->
íd_‰eq_khz
)

1202 
‰eq_ønge
 = 
‰eq_ønge_tmp
;

1205 
íd_‰eq
 = 
‰eq_ønge
->
íd_‰eq_khz
;

1207  
íd_‰eq
 - 
°¨t_‰eq
;

1208 
	}
}

1210 
	$ªg_gë_max_b™dwidth
(c⁄° 
õì80211_ªgdomaö
 *
rd
,

1211 c⁄° 
õì80211_ªg_ruÀ
 *
ruÀ
)

1213 
bw
 = 
	`ªg_gë_max_b™dwidth_‰om_ønge
(
rd
, 
ruÀ
);

1215 i‡(
ruÀ
->
Êags
 & 
NL80211_RRF_NO_320MHZ
)

1216 
bw
 = 
	`mö_t
(, bw, 
	`MHZ_TO_KHZ
(160));

1217 i‡(
ruÀ
->
Êags
 & 
NL80211_RRF_NO_160MHZ
)

1218 
bw
 = 
	`mö_t
(, bw, 
	`MHZ_TO_KHZ
(80));

1219 i‡(
ruÀ
->
Êags
 & 
NL80211_RRF_NO_80MHZ
)

1220 
bw
 = 
	`mö_t
(, bw, 
	`MHZ_TO_KHZ
(40));

1226 i‡(
ruÀ
->
Êags
 & 
NL80211_RRF_NO_HT40MINUS
 &&

1227 
ruÀ
->
Êags
 & 
NL80211_RRF_NO_HT40PLUS
)

1228 
bw
 = 
	`mö_t
(, bw, 
	`MHZ_TO_KHZ
(20));

1230  
bw
;

1231 
	}
}

1234 
boﬁ
 
	$is_vÆid_ªg_ruÀ
(c⁄° 
õì80211_ªg_ruÀ
 *
ruÀ
)

1236 c⁄° 
õì80211_‰eq_ønge
 *
‰eq_ønge
 = &
ruÀ
->freq_range;

1237 
u32
 
‰eq_diff
;

1239 i‡(
‰eq_ønge
->
°¨t_‰eq_khz
 <0 || fªq_ønge->
íd_‰eq_khz
 <= 0)

1240  
Ál£
;

1242 i‡(
‰eq_ønge
->
°¨t_‰eq_khz
 > fªq_ønge->
íd_‰eq_khz
)

1243  
Ál£
;

1245 
‰eq_diff
 = 
‰eq_ønge
->
íd_‰eq_khz
 - fªq_ønge->
°¨t_‰eq_khz
;

1247 i‡(
‰eq_ønge
->
íd_‰eq_khz
 <‰eq_ønge->
°¨t_‰eq_khz
 ||

1248 
‰eq_ønge
->
max_b™dwidth_khz
 > 
‰eq_diff
)

1249  
Ál£
;

1251  
åue
;

1252 
	}
}

1254 
boﬁ
 
	$is_vÆid_rd
(c⁄° 
õì80211_ªgdomaö
 *
rd
)

1256 c⁄° 
õì80211_ªg_ruÀ
 *
ªg_ruÀ
 = 
NULL
;

1257 
i
;

1259 i‡(!
rd
->
n_ªg_ruÀs
)

1260  
Ál£
;

1262 i‡(
	`WARN_ON
(
rd
->
n_ªg_ruÀs
 > 
NL80211_MAX_SUPP_REG_RULES
))

1263  
Ál£
;

1265 
i
 = 0; i < 
rd
->
n_ªg_ruÀs
; i++) {

1266 
ªg_ruÀ
 = &
rd
->
ªg_ruÀs
[
i
];

1267 i‡(!
	`is_vÆid_ªg_ruÀ
(
ªg_ruÀ
))

1268  
Ál£
;

1271  
åue
;

1272 
	}
}

1291 
boﬁ
 
	$‰eq_ö_ruÀ_b™d
(c⁄° 
õì80211_‰eq_ønge
 *
‰eq_ønge
,

1292 
u32
 
‰eq_khz
)

1299 
u32
 
limô
 = 
‰eq_khz
 > 45 * 
KHZ_PER_GHZ
 ? 20 * KHZ_PER_GHZ : 2 * KHZ_PER_GHZ;

1300 i‡(
	`abs
(
‰eq_khz
 - 
‰eq_ønge
->
°¨t_‰eq_khz
Ë<
limô
)

1301  
åue
;

1302 i‡(
	`abs
(
‰eq_khz
 - 
‰eq_ønge
->
íd_‰eq_khz
Ë<
limô
)

1303  
åue
;

1304  
Ál£
;

1305 
	}
}

1312 
∆80211_dfs_ªgi⁄s


1313 
	$ªg_öãr£˘_dfs_ªgi⁄
(c⁄° 
∆80211_dfs_ªgi⁄s
 
dfs_ªgi⁄1
,

1314 c⁄° 
∆80211_dfs_ªgi⁄s
 
dfs_ªgi⁄2
)

1316 i‡(
dfs_ªgi⁄1
 !
dfs_ªgi⁄2
)

1317  
NL80211_DFS_UNSET
;

1318  
dfs_ªgi⁄1
;

1319 
	}
}

1321 
	$ªg_wmm_ruÀs_öãr£˘
(c⁄° 
õì80211_wmm_ac
 *
wmm_ac1
,

1322 c⁄° 
õì80211_wmm_ac
 *
wmm_ac2
,

1323 
õì80211_wmm_ac
 *
öãr£˘
)

1325 
öãr£˘
->
cw_mö
 = 
	`max_t
(
u16
, 
wmm_ac1
->cw_mö, 
wmm_ac2
->cw_min);

1326 
öãr£˘
->
cw_max
 = 
	`max_t
(
u16
, 
wmm_ac1
->cw_max, 
wmm_ac2
->cw_max);

1327 
öãr£˘
->
cŸ
 = 
	`mö_t
(
u16
, 
wmm_ac1
->cŸ, 
wmm_ac2
->cot);

1328 
öãr£˘
->
aif¢
 = 
	`max_t
(
u8
, 
wmm_ac1
->aif¢, 
wmm_ac2
->aifsn);

1329 
	}
}

1335 
	$ªg_ruÀs_öãr£˘
(c⁄° 
õì80211_ªgdomaö
 *
rd1
,

1336 c⁄° 
õì80211_ªgdomaö
 *
rd2
,

1337 c⁄° 
õì80211_ªg_ruÀ
 *
ruÀ1
,

1338 c⁄° 
õì80211_ªg_ruÀ
 *
ruÀ2
,

1339 
õì80211_ªg_ruÀ
 *
öãr£˘ed_ruÀ
)

1341 c⁄° 
õì80211_‰eq_ønge
 *
‰eq_ønge1
, *
‰eq_ønge2
;

1342 
õì80211_‰eq_ønge
 *
‰eq_ønge
;

1343 c⁄° 
õì80211_powî_ruÀ
 *
powî_ruÀ1
, *
powî_ruÀ2
;

1344 
õì80211_powî_ruÀ
 *
powî_ruÀ
;

1345 c⁄° 
õì80211_wmm_ruÀ
 *
wmm_ruÀ1
, *
wmm_ruÀ2
;

1346 
õì80211_wmm_ruÀ
 *
wmm_ruÀ
;

1347 
u32
 
‰eq_diff
, 
max_b™dwidth1
, 
max_b™dwidth2
;

1349 
‰eq_ønge1
 = &
ruÀ1
->
‰eq_ønge
;

1350 
‰eq_ønge2
 = &
ruÀ2
->
‰eq_ønge
;

1351 
‰eq_ønge
 = &
öãr£˘ed_ruÀ
->freq_range;

1353 
powî_ruÀ1
 = &
ruÀ1
->
powî_ruÀ
;

1354 
powî_ruÀ2
 = &
ruÀ2
->
powî_ruÀ
;

1355 
powî_ruÀ
 = &
öãr£˘ed_ruÀ
->power_rule;

1357 
wmm_ruÀ1
 = &
ruÀ1
->
wmm_ruÀ
;

1358 
wmm_ruÀ2
 = &
ruÀ2
->
wmm_ruÀ
;

1359 
wmm_ruÀ
 = &
öãr£˘ed_ruÀ
->wmm_rule;

1361 
‰eq_ønge
->
°¨t_‰eq_khz
 = 
	`max
(
‰eq_ønge1
->start_freq_khz,

1362 
‰eq_ønge2
->
°¨t_‰eq_khz
);

1363 
‰eq_ønge
->
íd_‰eq_khz
 = 
	`mö
(
‰eq_ønge1
->end_freq_khz,

1364 
‰eq_ønge2
->
íd_‰eq_khz
);

1366 
max_b™dwidth1
 = 
‰eq_ønge1
->
max_b™dwidth_khz
;

1367 
max_b™dwidth2
 = 
‰eq_ønge2
->
max_b™dwidth_khz
;

1369 i‡(
ruÀ1
->
Êags
 & 
NL80211_RRF_AUTO_BW
)

1370 
max_b™dwidth1
 = 
	`ªg_gë_max_b™dwidth
(
rd1
, 
ruÀ1
);

1371 i‡(
ruÀ2
->
Êags
 & 
NL80211_RRF_AUTO_BW
)

1372 
max_b™dwidth2
 = 
	`ªg_gë_max_b™dwidth
(
rd2
, 
ruÀ2
);

1374 
‰eq_ønge
->
max_b™dwidth_khz
 = 
	`mö
(
max_b™dwidth1
, 
max_b™dwidth2
);

1376 
öãr£˘ed_ruÀ
->
Êags
 = 
ruÀ1
->Êag†| 
ruÀ2
->flags;

1386 i‡((
ruÀ1
->
Êags
 & 
NL80211_RRF_AUTO_BW
) &&

1387 (
ruÀ2
->
Êags
 & 
NL80211_RRF_AUTO_BW
))

1388 
öãr£˘ed_ruÀ
->
Êags
 |
NL80211_RRF_AUTO_BW
;

1390 
öãr£˘ed_ruÀ
->
Êags
 &~
NL80211_RRF_AUTO_BW
;

1392 
‰eq_diff
 = 
‰eq_ønge
->
íd_‰eq_khz
 - fªq_ønge->
°¨t_‰eq_khz
;

1393 i‡(
‰eq_ønge
->
max_b™dwidth_khz
 > 
‰eq_diff
)

1394 
‰eq_ønge
->
max_b™dwidth_khz
 = 
‰eq_diff
;

1396 
powî_ruÀ
->
max_eúp
 = 
	`mö
(
powî_ruÀ1
->max_eirp,

1397 
powî_ruÀ2
->
max_eúp
);

1398 
powî_ruÀ
->
max_™ã¬a_gaö
 = 
	`mö
(
powî_ruÀ1
->max_antenna_gain,

1399 
powî_ruÀ2
->
max_™ã¬a_gaö
);

1401 
öãr£˘ed_ruÀ
->
dfs_ˇc_ms
 = 
	`max
(
ruÀ1
->dfs_cac_ms,

1402 
ruÀ2
->
dfs_ˇc_ms
);

1404 i‡(
ruÀ1
->
has_wmm
 && 
ruÀ2
->has_wmm) {

1405 
u8
 
ac
;

1407 
ac
 = 0;á¯< 
IEEE80211_NUM_ACS
;ác++) {

1408 
	`ªg_wmm_ruÀs_öãr£˘
(&
wmm_ruÀ1
->
˛õ¡
[
ac
],

1409 &
wmm_ruÀ2
->
˛õ¡
[
ac
],

1410 &
wmm_ruÀ
->
˛õ¡
[
ac
]);

1411 
	`ªg_wmm_ruÀs_öãr£˘
(&
wmm_ruÀ1
->
≠
[
ac
],

1412 &
wmm_ruÀ2
->
≠
[
ac
],

1413 &
wmm_ruÀ
->
≠
[
ac
]);

1416 
öãr£˘ed_ruÀ
->
has_wmm
 = 
åue
;

1417 } i‡(
ruÀ1
->
has_wmm
) {

1418 *
wmm_ruÀ
 = *
wmm_ruÀ1
;

1419 
öãr£˘ed_ruÀ
->
has_wmm
 = 
åue
;

1420 } i‡(
ruÀ2
->
has_wmm
) {

1421 *
wmm_ruÀ
 = *
wmm_ruÀ2
;

1422 
öãr£˘ed_ruÀ
->
has_wmm
 = 
åue
;

1424 
öãr£˘ed_ruÀ
->
has_wmm
 = 
Ál£
;

1427 i‡(!
	`is_vÆid_ªg_ruÀ
(
öãr£˘ed_ruÀ
))

1428  -
EINVAL
;

1431 
	}
}

1434 
boﬁ
 
	$ruÀ_c⁄èös
(
õì80211_ªg_ruÀ
 *
r1
,

1435 
õì80211_ªg_ruÀ
 *
r2
)

1438 i‡(
r1
->
Êags
 !
r2
->flags)

1439  
Ál£
;

1442 i‡((
r1
->
powî_ruÀ
.
max_™ã¬a_gaö
 >

1443 
r2
->
powî_ruÀ
.
max_™ã¬a_gaö
) ||

1444 
r1
->
powî_ruÀ
.
max_eúp
 > 
r2
->power_rule.max_eirp)

1445  
Ál£
;

1448 i‡(
r1
->
‰eq_ønge
.
°¨t_‰eq_khz
 > 
r2
->freq_range.start_freq_khz ||

1449 
r1
->
‰eq_ønge
.
íd_‰eq_khz
 < 
r2
->freq_range.end_freq_khz)

1450  
Ál£
;

1453 i‡(
r1
->
‰eq_ønge
.
max_b™dwidth_khz
 <

1454 
r2
->
‰eq_ønge
.
max_b™dwidth_khz
)

1455  
Ál£
;

1457  
åue
;

1458 
	}
}

1461 
	$add_ruÀ
(
õì80211_ªg_ruÀ
 *
ruÀ
,

1462 
õì80211_ªg_ruÀ
 *
ªg_ruÀs
, 
u32
 *
n_ruÀs
)

1464 
õì80211_ªg_ruÀ
 *
tmp_ruÀ
;

1465 
i
;

1467 
i
 = 0; i < *
n_ruÀs
; i++) {

1468 
tmp_ruÀ
 = &
ªg_ruÀs
[
i
];

1470 i‡(
	`ruÀ_c⁄èös
(
tmp_ruÀ
, 
ruÀ
))

1474 i‡(
	`ruÀ_c⁄èös
(
ruÀ
, 
tmp_ruÀ
)) {

1475 
	`mem˝y
(
tmp_ruÀ
, 
ruÀ
, (*rule));

1480 
	`mem˝y
(&
ªg_ruÀs
[*
n_ruÀs
], 
ruÀ
, (*rule));

1481 (*
n_ruÀs
)++;

1482 
	}
}

1499 
õì80211_ªgdomaö
 *

1500 
	$ªgdom_öãr£˘
(c⁄° 
õì80211_ªgdomaö
 *
rd1
,

1501 c⁄° 
õì80211_ªgdomaö
 *
rd2
)

1503 
r
;

1504 
x
, 
y
;

1505 
num_ruÀs
 = 0;

1506 c⁄° 
õì80211_ªg_ruÀ
 *
ruÀ1
, *
ruÀ2
;

1507 
õì80211_ªg_ruÀ
 
öãr£˘ed_ruÀ
;

1508 
õì80211_ªgdomaö
 *
rd
;

1510 i‡(!
rd1
 || !
rd2
)

1511  
NULL
;

1521 
x
 = 0; x < 
rd1
->
n_ªg_ruÀs
; x++) {

1522 
ruÀ1
 = &
rd1
->
ªg_ruÀs
[
x
];

1523 
y
 = 0; y < 
rd2
->
n_ªg_ruÀs
; y++) {

1524 
ruÀ2
 = &
rd2
->
ªg_ruÀs
[
y
];

1525 i‡(!
	`ªg_ruÀs_öãr£˘
(
rd1
, 
rd2
, 
ruÀ1
, 
ruÀ2
,

1526 &
öãr£˘ed_ruÀ
))

1527 
num_ruÀs
++;

1531 i‡(!
num_ruÀs
)

1532  
NULL
;

1534 
rd
 = 
	`kzÆloc
(
	`°ru˘_size
‘d, 
ªg_ruÀs
, 
num_ruÀs
), 
GFP_KERNEL
);

1535 i‡(!
rd
)

1536  
NULL
;

1538 
x
 = 0; x < 
rd1
->
n_ªg_ruÀs
; x++) {

1539 
ruÀ1
 = &
rd1
->
ªg_ruÀs
[
x
];

1540 
y
 = 0; y < 
rd2
->
n_ªg_ruÀs
; y++) {

1541 
ruÀ2
 = &
rd2
->
ªg_ruÀs
[
y
];

1542 
r
 = 
	`ªg_ruÀs_öãr£˘
(
rd1
, 
rd2
, 
ruÀ1
, 
ruÀ2
,

1543 &
öãr£˘ed_ruÀ
);

1548 i‡(
r
)

1551 
	`add_ruÀ
(&
öãr£˘ed_ruÀ
, 
rd
->
ªg_ruÀs
,

1552 &
rd
->
n_ªg_ruÀs
);

1556 
rd
->
Æpha2
[0] = '9';

1557 
rd
->
Æpha2
[1] = '8';

1558 
rd
->
dfs_ªgi⁄
 = 
	`ªg_öãr£˘_dfs_ªgi⁄
(
rd1
->dfs_region,

1559 
rd2
->
dfs_ªgi⁄
);

1561  
rd
;

1562 
	}
}

1568 
u32
 
	$m≠_ªgdom_Êags
(
u32
 
rd_Êags
)

1570 
u32
 
ch™√l_Êags
 = 0;

1571 i‡(
rd_Êags
 & 
NL80211_RRF_NO_IR_ALL
)

1572 
ch™√l_Êags
 |
IEEE80211_CHAN_NO_IR
;

1573 i‡(
rd_Êags
 & 
NL80211_RRF_DFS
)

1574 
ch™√l_Êags
 |
IEEE80211_CHAN_RADAR
;

1575 i‡(
rd_Êags
 & 
NL80211_RRF_NO_OFDM
)

1576 
ch™√l_Êags
 |
IEEE80211_CHAN_NO_OFDM
;

1577 i‡(
rd_Êags
 & 
NL80211_RRF_NO_OUTDOOR
)

1578 
ch™√l_Êags
 |
IEEE80211_CHAN_INDOOR_ONLY
;

1579 i‡(
rd_Êags
 & 
NL80211_RRF_IR_CONCURRENT
)

1580 
ch™√l_Êags
 |
IEEE80211_CHAN_IR_CONCURRENT
;

1581 i‡(
rd_Êags
 & 
NL80211_RRF_NO_HT40MINUS
)

1582 
ch™√l_Êags
 |
IEEE80211_CHAN_NO_HT40MINUS
;

1583 i‡(
rd_Êags
 & 
NL80211_RRF_NO_HT40PLUS
)

1584 
ch™√l_Êags
 |
IEEE80211_CHAN_NO_HT40PLUS
;

1585 i‡(
rd_Êags
 & 
NL80211_RRF_NO_80MHZ
)

1586 
ch™√l_Êags
 |
IEEE80211_CHAN_NO_80MHZ
;

1587 i‡(
rd_Êags
 & 
NL80211_RRF_NO_160MHZ
)

1588 
ch™√l_Êags
 |
IEEE80211_CHAN_NO_160MHZ
;

1589 i‡(
rd_Êags
 & 
NL80211_RRF_NO_HE
)

1590 
ch™√l_Êags
 |
IEEE80211_CHAN_NO_HE
;

1591 i‡(
rd_Êags
 & 
NL80211_RRF_NO_320MHZ
)

1592 
ch™√l_Êags
 |
IEEE80211_CHAN_NO_320MHZ
;

1593 i‡(
rd_Êags
 & 
NL80211_RRF_NO_EHT
)

1594 
ch™√l_Êags
 |
IEEE80211_CHAN_NO_EHT
;

1595 i‡(
rd_Êags
 & 
NL80211_RRF_DFS_CONCURRENT
)

1596 
ch™√l_Êags
 |
IEEE80211_CHAN_DFS_CONCURRENT
;

1597 i‡(
rd_Êags
 & 
NL80211_RRF_NO_6GHZ_VLP_CLIENT
)

1598 
ch™√l_Êags
 |
IEEE80211_CHAN_NO_6GHZ_VLP_CLIENT
;

1599 i‡(
rd_Êags
 & 
NL80211_RRF_NO_6GHZ_AFC_CLIENT
)

1600 
ch™√l_Êags
 |
IEEE80211_CHAN_NO_6GHZ_AFC_CLIENT
;

1601 i‡(
rd_Êags
 & 
NL80211_RRF_PSD
)

1602 
ch™√l_Êags
 |
IEEE80211_CHAN_PSD
;

1603  
ch™√l_Êags
;

1604 
	}
}

1606 c⁄° 
õì80211_ªg_ruÀ
 *

1607 
	$‰eq_ªg_öfo_ªgd
(
u32
 
˚¡î_‰eq
,

1608 c⁄° 
õì80211_ªgdomaö
 *
ªgd
, 
u32
 
bw
)

1610 
i
;

1611 
boﬁ
 
b™d_ruÀ_found
 = 
Ál£
;

1612 
boﬁ
 
bw_fôs
 = 
Ál£
;

1614 i‡(!
ªgd
)

1615  
	`ERR_PTR
(-
EINVAL
);

1617 
i
 = 0; i < 
ªgd
->
n_ªg_ruÀs
; i++) {

1618 c⁄° 
õì80211_ªg_ruÀ
 *
º
;

1619 c⁄° 
õì80211_‰eq_ønge
 *
‰
 = 
NULL
;

1621 
º
 = &
ªgd
->
ªg_ruÀs
[
i
];

1622 
‰
 = &
º
->
‰eq_ønge
;

1629 i‡(!
b™d_ruÀ_found
)

1630 
b™d_ruÀ_found
 = 
	`‰eq_ö_ruÀ_b™d
(
‰
, 
˚¡î_‰eq
);

1632 
bw_fôs
 = 
	`cfg80211_d€s_bw_fô_ønge
(
‰
, 
˚¡î_‰eq
, 
bw
);

1634 i‡(
b™d_ruÀ_found
 && 
bw_fôs
)

1635  
º
;

1638 i‡(!
b™d_ruÀ_found
)

1639  
	`ERR_PTR
(-
ERANGE
);

1641  
	`ERR_PTR
(-
EINVAL
);

1642 
	}
}

1644 c⁄° 
õì80211_ªg_ruÀ
 *

1645 
	$__‰eq_ªg_öfo
(
wùhy
 *wùhy, 
u32
 
˚¡î_‰eq
, u32 
mö_bw
)

1647 c⁄° 
õì80211_ªgdomaö
 *
ªgd
 = 
	`ªg_gë_ªgdomaö
(
wùhy
);

1648 c⁄° 
u32
 
bws
[] = {0, 1, 2, 4, 5, 8, 10, 16, 20};

1649 c⁄° 
õì80211_ªg_ruÀ
 *
ªg_ruÀ
 = 
	`ERR_PTR
(-
ERANGE
);

1650 
i
 = 
	`ARRAY_SIZE
(
bws
) - 1;

1651 
u32
 
bw
;

1653 
bw
 = 
	`MHZ_TO_KHZ
(
bws
[
i
]); bw >
mö_bw
; bw = MHZ_TO_KHZ(bws[i--])) {

1654 
ªg_ruÀ
 = 
	`‰eq_ªg_öfo_ªgd
(
˚¡î_‰eq
, 
ªgd
, 
bw
);

1655 i‡(!
	`IS_ERR
(
ªg_ruÀ
))

1656  
ªg_ruÀ
;

1659  
ªg_ruÀ
;

1660 
	}
}

1662 c⁄° 
õì80211_ªg_ruÀ
 *
	$‰eq_ªg_öfo
(
wùhy
 *wiphy,

1663 
u32
 
˚¡î_‰eq
)

1665 
u32
 
mö_bw
 = 
˚¡î_‰eq
 < 
	`MHZ_TO_KHZ
(1000) ? 1 : 20;

1667  
	`__‰eq_ªg_öfo
(
wùhy
, 
˚¡î_‰eq
, 
	`MHZ_TO_KHZ
(
mö_bw
));

1668 
	}
}

1669 
EXPORT_SYMBOL
(
‰eq_ªg_öfo
);

1671 c⁄° *
	$ªg_öôüt‹_«me
(
∆80211_ªg_öôüt‹
 
öôüt‹
)

1673 
öôüt‹
) {

1674 
NL80211_REGDOM_SET_BY_CORE
:

1676 
NL80211_REGDOM_SET_BY_USER
:

1678 
NL80211_REGDOM_SET_BY_DRIVER
:

1680 
NL80211_REGDOM_SET_BY_COUNTRY_IE
:

1683 
	`WARN_ON
(1);

1686 
	}
}

1687 
EXPORT_SYMBOL
(
ªg_öôüt‹_«me
);

1689 
uöt32_t
 
	$ªg_ruÀ_to_ch™_bw_Êags
(c⁄° 
õì80211_ªgdomaö
 *
ªgd
,

1690 c⁄° 
õì80211_ªg_ruÀ
 *
ªg_ruÀ
,

1691 c⁄° 
õì80211_ch™√l
 *
ch™
)

1693 c⁄° 
õì80211_‰eq_ønge
 *
‰eq_ønge
 = 
NULL
;

1694 
u32
 
max_b™dwidth_khz
, 
˚¡î_‰eq_khz
, 
bw_Êags
 = 0;

1695 
boﬁ
 
is_s1g
 = 
ch™
->
b™d
 =
NL80211_BAND_S1GHZ
;

1697 
‰eq_ønge
 = &
ªg_ruÀ
->freq_range;

1699 
max_b™dwidth_khz
 = 
‰eq_ønge
->max_bandwidth_khz;

1700 
˚¡î_‰eq_khz
 = 
	`õì80211_ch™√l_to_khz
(
ch™
);

1702 i‡(
ªg_ruÀ
->
Êags
 & 
NL80211_RRF_AUTO_BW
)

1703 
max_b™dwidth_khz
 = 
	`ªg_gë_max_b™dwidth
(
ªgd
, 
ªg_ruÀ
);

1706 i‡(!
	`cfg80211_d€s_bw_fô_ønge
(
‰eq_ønge
,

1707 
˚¡î_‰eq_khz
,

1708 
	`MHZ_TO_KHZ
(10)))

1709 
bw_Êags
 |
IEEE80211_CHAN_NO_10MHZ
;

1710 i‡(!
	`cfg80211_d€s_bw_fô_ønge
(
‰eq_ønge
,

1711 
˚¡î_‰eq_khz
,

1712 
	`MHZ_TO_KHZ
(20)))

1713 
bw_Êags
 |
IEEE80211_CHAN_NO_20MHZ
;

1715 i‡(
is_s1g
) {

1720 
edge_off£t
;

1721 
ch_bw
 = 
max_b™dwidth_khz
;

1723 
ch_bw
) {

1724 
edge_off£t
 = (
˚¡î_‰eq_khz
 - 
ch_bw
 / 2) -

1725 
‰eq_ønge
->
°¨t_‰eq_khz
;

1726 i‡(
edge_off£t
 % 
ch_bw
 == 0) {

1727 
	`KHZ_TO_MHZ
(
ch_bw
)) {

1729 
bw_Êags
 |
IEEE80211_CHAN_1MHZ
;

1732 
bw_Êags
 |
IEEE80211_CHAN_2MHZ
;

1735 
bw_Êags
 |
IEEE80211_CHAN_4MHZ
;

1738 
bw_Êags
 |
IEEE80211_CHAN_8MHZ
;

1741 
bw_Êags
 |
IEEE80211_CHAN_16MHZ
;

1747 
bw_Êags
 |
IEEE80211_CHAN_DISABLED
;

1752 
ch_bw
 /= 2;

1755 i‡(
max_b™dwidth_khz
 < 
	`MHZ_TO_KHZ
(10))

1756 
bw_Êags
 |
IEEE80211_CHAN_NO_10MHZ
;

1757 i‡(
max_b™dwidth_khz
 < 
	`MHZ_TO_KHZ
(20))

1758 
bw_Êags
 |
IEEE80211_CHAN_NO_20MHZ
;

1759 i‡(
max_b™dwidth_khz
 < 
	`MHZ_TO_KHZ
(40))

1760 
bw_Êags
 |
IEEE80211_CHAN_NO_HT40
;

1761 i‡(
max_b™dwidth_khz
 < 
	`MHZ_TO_KHZ
(80))

1762 
bw_Êags
 |
IEEE80211_CHAN_NO_80MHZ
;

1763 i‡(
max_b™dwidth_khz
 < 
	`MHZ_TO_KHZ
(160))

1764 
bw_Êags
 |
IEEE80211_CHAN_NO_160MHZ
;

1765 i‡(
max_b™dwidth_khz
 < 
	`MHZ_TO_KHZ
(320))

1766 
bw_Êags
 |
IEEE80211_CHAN_NO_320MHZ
;

1768  
bw_Êags
;

1769 
	}
}

1771 
	$h™dÀ_ch™√l_sögÀ_ruÀ
(
wùhy
 *wiphy,

1772 
∆80211_ªg_öôüt‹
 
öôüt‹
,

1773 
õì80211_ch™√l
 *
ch™
,

1774 
u32
 
Êags
,

1775 
ªguœt‹y_ªque°
 *
Ã
,

1776 
wùhy
 *
ªque°_wùhy
,

1777 c⁄° 
õì80211_ªg_ruÀ
 *
ªg_ruÀ
)

1779 
u32
 
bw_Êags
 = 0;

1780 c⁄° 
õì80211_powî_ruÀ
 *
powî_ruÀ
 = 
NULL
;

1781 c⁄° 
õì80211_ªgdomaö
 *
ªgd
;

1783 
ªgd
 = 
	`ªg_gë_ªgdomaö
(
wùhy
);

1785 
powî_ruÀ
 = &
ªg_ruÀ
->power_rule;

1786 
bw_Êags
 = 
	`ªg_ruÀ_to_ch™_bw_Êags
(
ªgd
, 
ªg_ruÀ
, 
ch™
);

1788 i‡(
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_DRIVER
 &&

1789 
ªque°_wùhy
 &&Ñeque°_wùhy =
wùhy
 &&

1790 
ªque°_wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_STRICT_REG
) {

1796 
ch™
->
Êags
 = ch™->
‹ig_Êags
 =

1797 
	`m≠_ªgdom_Êags
(
ªg_ruÀ
->
Êags
Ë| 
bw_Êags
;

1798 
ch™
->
max_™ã¬a_gaö
 = ch™->
‹ig_mag
 =

1799 (Ë
	`MBI_TO_DBI
(
powî_ruÀ
->
max_™ã¬a_gaö
);

1800 
ch™
->
max_ªg_powî
 = ch™->
max_powî
 = ch™->
‹ig_mpwr
 =

1801 (Ë
	`MBM_TO_DBM
(
powî_ruÀ
->
max_eúp
);

1803 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_RADAR
) {

1804 
ch™
->
dfs_ˇc_ms
 = 
IEEE80211_DFS_MIN_CAC_TIME_MS
;

1805 i‡(
ªg_ruÀ
->
dfs_ˇc_ms
)

1806 
ch™
->
dfs_ˇc_ms
 = 
ªg_ruÀ
->dfs_cac_ms;

1809 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_PSD
)

1810 
ch™
->
psd
 = 
ªg_ruÀ
->psd;

1815 
ch™
->
dfs_°©e
 = 
NL80211_DFS_USABLE
;

1816 
ch™
->
dfs_°©e_íãªd
 = 
jiffõs
;

1818 
ch™
->
bóc⁄_found
 = 
Ál£
;

1819 
ch™
->
Êags
 = fœg†| 
bw_Êags
 | 
	`m≠_ªgdom_Êags
(
ªg_ruÀ
->flags);

1820 
ch™
->
max_™ã¬a_gaö
 =

1821 
	`mö_t
(, 
ch™
->
‹ig_mag
,

1822 
	`MBI_TO_DBI
(
powî_ruÀ
->
max_™ã¬a_gaö
));

1823 
ch™
->
max_ªg_powî
 = (Ë
	`MBM_TO_DBM
(
powî_ruÀ
->
max_eúp
);

1825 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_RADAR
) {

1826 i‡(
ªg_ruÀ
->
dfs_ˇc_ms
)

1827 
ch™
->
dfs_ˇc_ms
 = 
ªg_ruÀ
->dfs_cac_ms;

1829 
ch™
->
dfs_ˇc_ms
 = 
IEEE80211_DFS_MIN_CAC_TIME_MS
;

1832 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_PSD
)

1833 
ch™
->
psd
 = 
ªg_ruÀ
->psd;

1835 i‡(
ch™
->
‹ig_mpwr
) {

1840 i‡(
öôüt‹
 =
NL80211_REGDOM_SET_BY_COUNTRY_IE
 &&

1841 
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_COUNTRY_IE_FOLLOW_POWER
)

1842 
ch™
->
max_powî
 = ch™->
max_ªg_powî
;

1844 
ch™
->
max_powî
 = 
	`mö
(ch™->
‹ig_mpwr
,

1845 
ch™
->
max_ªg_powî
);

1847 
ch™
->
max_powî
 = ch™->
max_ªg_powî
;

1848 
	}
}

1850 
	$h™dÀ_ch™√l_adja˚¡_ruÀs
(
wùhy
 *wiphy,

1851 
∆80211_ªg_öôüt‹
 
öôüt‹
,

1852 
õì80211_ch™√l
 *
ch™
,

1853 
u32
 
Êags
,

1854 
ªguœt‹y_ªque°
 *
Ã
,

1855 
wùhy
 *
ªque°_wùhy
,

1856 c⁄° 
õì80211_ªg_ruÀ
 *
ºuÀ1
,

1857 c⁄° 
õì80211_ªg_ruÀ
 *
ºuÀ2
,

1858 
õì80211_‰eq_ønge
 *
comb_ønge
)

1860 
u32
 
bw_Êags1
 = 0;

1861 
u32
 
bw_Êags2
 = 0;

1862 c⁄° 
õì80211_powî_ruÀ
 *
powî_ruÀ1
 = 
NULL
;

1863 c⁄° 
õì80211_powî_ruÀ
 *
powî_ruÀ2
 = 
NULL
;

1864 c⁄° 
õì80211_ªgdomaö
 *
ªgd
;

1866 
ªgd
 = 
	`ªg_gë_ªgdomaö
(
wùhy
);

1868 
powî_ruÀ1
 = &
ºuÀ1
->
powî_ruÀ
;

1869 
powî_ruÀ2
 = &
ºuÀ2
->
powî_ruÀ
;

1870 
bw_Êags1
 = 
	`ªg_ruÀ_to_ch™_bw_Êags
(
ªgd
, 
ºuÀ1
, 
ch™
);

1871 
bw_Êags2
 = 
	`ªg_ruÀ_to_ch™_bw_Êags
(
ªgd
, 
ºuÀ2
, 
ch™
);

1873 i‡(
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_DRIVER
 &&

1874 
ªque°_wùhy
 &&Ñeque°_wùhy =
wùhy
 &&

1875 
ªque°_wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_STRICT_REG
) {

1880 
ch™
->
Êags
 =

1881 
	`m≠_ªgdom_Êags
(
ºuÀ1
->
Êags
) |

1882 
	`m≠_ªgdom_Êags
(
ºuÀ2
->
Êags
) |

1883 
bw_Êags1
 |

1884 
bw_Êags2
;

1885 
ch™
->
‹ig_Êags
 = ch™->
Êags
;

1886 
ch™
->
max_™ã¬a_gaö
 =

1887 
	`mö_t
(, 
	`MBI_TO_DBI
(
powî_ruÀ1
->
max_™ã¬a_gaö
),

1888 
	`MBI_TO_DBI
(
powî_ruÀ2
->
max_™ã¬a_gaö
));

1889 
ch™
->
‹ig_mag
 = ch™->
max_™ã¬a_gaö
;

1890 
ch™
->
max_ªg_powî
 =

1891 
	`mö_t
(, 
	`MBM_TO_DBM
(
powî_ruÀ1
->
max_eúp
),

1892 
	`MBM_TO_DBM
(
powî_ruÀ2
->
max_eúp
));

1893 
ch™
->
max_powî
 = ch™->
max_ªg_powî
;

1894 
ch™
->
‹ig_mpwr
 = ch™->
max_ªg_powî
;

1896 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_RADAR
) {

1897 
ch™
->
dfs_ˇc_ms
 = 
IEEE80211_DFS_MIN_CAC_TIME_MS
;

1898 i‡(
ºuÀ1
->
dfs_ˇc_ms
 || 
ºuÀ2
->dfs_cac_ms)

1899 
ch™
->
dfs_ˇc_ms
 = 
	`max_t
(,

1900 
ºuÀ1
->
dfs_ˇc_ms
,

1901 
ºuÀ2
->
dfs_ˇc_ms
);

1904 i‡((
ºuÀ1
->
Êags
 & 
NL80211_RRF_PSD
) &&

1905 (
ºuÀ2
->
Êags
 & 
NL80211_RRF_PSD
))

1906 
ch™
->
psd
 = 
	`mö_t
(
s8
, 
ºuÀ1
->psd, 
ºuÀ2
->psd);

1908 
ch™
->
Êags
 &~
NL80211_RRF_PSD
;

1913 
ch™
->
dfs_°©e
 = 
NL80211_DFS_USABLE
;

1914 
ch™
->
dfs_°©e_íãªd
 = 
jiffõs
;

1916 
ch™
->
bóc⁄_found
 = 
Ál£
;

1917 
ch™
->
Êags
 = fœg†| 
bw_Êags1
 | 
bw_Êags2
 |

1918 
	`m≠_ªgdom_Êags
(
ºuÀ1
->
Êags
) |

1919 
	`m≠_ªgdom_Êags
(
ºuÀ2
->
Êags
);

1924 i‡(
	`cfg80211_d€s_bw_fô_ønge
(
comb_ønge
,

1925 
	`õì80211_ch™√l_to_khz
(
ch™
),

1926 
	`MHZ_TO_KHZ
(10)))

1927 
ch™
->
Êags
 &~
IEEE80211_CHAN_NO_10MHZ
;

1928 i‡(
	`cfg80211_d€s_bw_fô_ønge
(
comb_ønge
,

1929 
	`õì80211_ch™√l_to_khz
(
ch™
),

1930 
	`MHZ_TO_KHZ
(20)))

1931 
ch™
->
Êags
 &~
IEEE80211_CHAN_NO_20MHZ
;

1933 
ch™
->
max_™ã¬a_gaö
 =

1934 
	`mö_t
(, 
ch™
->
‹ig_mag
,

1935 
	`mö_t
(,

1936 
	`MBI_TO_DBI
(
powî_ruÀ1
->
max_™ã¬a_gaö
),

1937 
	`MBI_TO_DBI
(
powî_ruÀ2
->
max_™ã¬a_gaö
)));

1938 
ch™
->
max_ªg_powî
 = 
	`mö_t
(,

1939 
	`MBM_TO_DBM
(
powî_ruÀ1
->
max_eúp
),

1940 
	`MBM_TO_DBM
(
powî_ruÀ2
->
max_eúp
));

1942 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_RADAR
) {

1943 i‡(
ºuÀ1
->
dfs_ˇc_ms
 || 
ºuÀ2
->dfs_cac_ms)

1944 
ch™
->
dfs_ˇc_ms
 = 
	`max_t
(,

1945 
ºuÀ1
->
dfs_ˇc_ms
,

1946 
ºuÀ2
->
dfs_ˇc_ms
);

1948 
ch™
->
dfs_ˇc_ms
 = 
IEEE80211_DFS_MIN_CAC_TIME_MS
;

1951 i‡(
ch™
->
‹ig_mpwr
) {

1955 i‡(
öôüt‹
 =
NL80211_REGDOM_SET_BY_COUNTRY_IE
 &&

1956 
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_COUNTRY_IE_FOLLOW_POWER
)

1957 
ch™
->
max_powî
 = ch™->
max_ªg_powî
;

1959 
ch™
->
max_powî
 = 
	`mö
(ch™->
‹ig_mpwr
,

1960 
ch™
->
max_ªg_powî
);

1962 
ch™
->
max_powî
 = ch™->
max_ªg_powî
;

1964 
	}
}

1970 
	$h™dÀ_ch™√l
(
wùhy
 *wiphy,

1971 
∆80211_ªg_öôüt‹
 
öôüt‹
,

1972 
õì80211_ch™√l
 *
ch™
)

1974 c⁄° 
u32
 
‹ig_ch™_‰eq
 = 
	`õì80211_ch™√l_to_khz
(
ch™
);

1975 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

1976 
wùhy
 *
ªque°_wùhy
 = 
	`wùhy_idx_to_wùhy
(
Ã
->
wùhy_idx
);

1977 c⁄° 
õì80211_ªg_ruÀ
 *
ºuÀ
 = 
NULL
;

1978 c⁄° 
õì80211_ªg_ruÀ
 *
ºuÀ1
 = 
NULL
;

1979 c⁄° 
õì80211_ªg_ruÀ
 *
ºuÀ2
 = 
NULL
;

1981 
u32
 
Êags
 = 
ch™
->
‹ig_Êags
;

1983 
ºuÀ
 = 
	`‰eq_ªg_öfo
(
wùhy
, 
‹ig_ch™_‰eq
);

1984 i‡(
	`IS_ERR
(
ºuÀ
)) {

1989 
ºuÀ1
 = 
	`‰eq_ªg_öfo
(
wùhy
,

1990 
‹ig_ch™_‰eq
 - 
	`MHZ_TO_KHZ
(20));

1991 
ºuÀ2
 = 
	`‰eq_ªg_öfo
(
wùhy
,

1992 
‹ig_ch™_‰eq
 + 
	`MHZ_TO_KHZ
(20));

1993 i‡(!
	`IS_ERR
(
ºuÀ1
Ë&& !IS_ERR(
ºuÀ2
)) {

1994 
õì80211_‰eq_ønge
 
comb_ønge
;

1996 i‡(
ºuÀ1
->
‰eq_ønge
.
íd_‰eq_khz
 !=

1997 
ºuÀ2
->
‰eq_ønge
.
°¨t_‰eq_khz
)

1998 
dißbÀ_ch™
;

2000 
comb_ønge
.
°¨t_‰eq_khz
 =

2001 
ºuÀ1
->
‰eq_ønge
.
°¨t_‰eq_khz
;

2002 
comb_ønge
.
íd_‰eq_khz
 =

2003 
ºuÀ2
->
‰eq_ønge
.
íd_‰eq_khz
;

2004 
comb_ønge
.
max_b™dwidth_khz
 =

2005 
	`mö_t
(
u32
,

2006 
ºuÀ1
->
‰eq_ønge
.
max_b™dwidth_khz
,

2007 
ºuÀ2
->
‰eq_ønge
.
max_b™dwidth_khz
);

2009 i‡(!
	`cfg80211_d€s_bw_fô_ønge
(&
comb_ønge
,

2010 
‹ig_ch™_‰eq
,

2011 
	`MHZ_TO_KHZ
(20)))

2012 
dißbÀ_ch™
;

2014 
	`h™dÀ_ch™√l_adja˚¡_ruÀs
(
wùhy
, 
öôüt‹
, 
ch™
,

2015 
Êags
, 
Ã
, 
ªque°_wùhy
,

2016 
ºuÀ1
, 
ºuÀ2
,

2017 &
comb_ønge
);

2021 
dißbÀ_ch™
:

2031 i‡(
öôüt‹
 =
NL80211_REGDOM_SET_BY_COUNTRY_IE
 &&

2032 
	`PTR_ERR
(
ºuÀ
Ë=-
ERANGE
)

2035 i‡(
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_DRIVER
 &&

2036 
ªque°_wùhy
 &&Ñeque°_wùhy =
wùhy
 &&

2037 
ªque°_wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_STRICT_REG
) {

2038 
	`¥_debug
("Disabling freq %d.%03d MHz for good\n",

2039 
ch™
->
˚¡î_‰eq
, ch™->
‰eq_off£t
);

2040 
ch™
->
‹ig_Êags
 |
IEEE80211_CHAN_DISABLED
;

2041 
ch™
->
Êags
 = ch™->
‹ig_Êags
;

2043 
	`¥_debug
("Disabling freq %d.%03d MHz\n",

2044 
ch™
->
˚¡î_‰eq
, ch™->
‰eq_off£t
);

2045 
ch™
->
Êags
 |
IEEE80211_CHAN_DISABLED
;

2050 
	`h™dÀ_ch™√l_sögÀ_ruÀ
(
wùhy
, 
öôüt‹
, 
ch™
, 
Êags
, 
Ã
,

2051 
ªque°_wùhy
, 
ºuÀ
);

2052 
	}
}

2054 
	$h™dÀ_b™d
(
wùhy
 *wiphy,

2055 
∆80211_ªg_öôüt‹
 
öôüt‹
,

2056 
õì80211_suµ‹ãd_b™d
 *
sb™d
)

2058 
i
;

2060 i‡(!
sb™d
)

2063 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++)

2064 
	`h™dÀ_ch™√l
(
wùhy
, 
öôüt‹
, &
sb™d
->
ch™√ls
[
i
]);

2065 
	}
}

2067 
boﬁ
 
	$ªg_ªque°_˚Œ_ba£
(
ªguœt‹y_ªque°
 *
ªque°
)

2069 i‡(
ªque°
->
öôüt‹
 !
NL80211_REGDOM_SET_BY_USER
)

2070  
Ál£
;

2071  
ªque°
->
u£r_ªg_höt_ty≥
 =
NL80211_USER_REG_HINT_CELL_BASE
;

2072 
	}
}

2074 
boﬁ
 
	$ªg_œ°_ªque°_˚Œ_ba£
()

2076  
	`ªg_ªque°_˚Œ_ba£
(
	`gë_œ°_ªque°
());

2077 
	}
}

2079 #ifde‡
CONFIG_CFG80211_REG_CELLULAR_HINTS


2081 
ªg_ªque°_åótmít


2082 
	$ªg_ign‹e_˚Œ_höt
(
ªguœt‹y_ªque°
 *
≥ndög_ªque°
)

2084 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

2086 i‡(!
ªg_num_devs_suµ‹t_ba£höt
)

2087  
REG_REQ_IGNORE
;

2089 i‡(
	`ªg_ªque°_˚Œ_ba£
(
Ã
) &&

2090 !
	`ªgdom_ch™ges
(
≥ndög_ªque°
->
Æpha2
))

2091  
REG_REQ_ALREADY_SET
;

2093  
REG_REQ_OK
;

2094 
	}
}

2097 
boﬁ
 
	$ªg_dev_ign‹e_˚Œ_höt
(
wùhy
 *wiphy)

2099  !(
wùhy
->
„©uªs
 & 
NL80211_FEATURE_CELL_BASE_REG_HINTS
);

2100 
	}
}

2102 
ªg_ªque°_åótmít


2103 
	$ªg_ign‹e_˚Œ_höt
(
ªguœt‹y_ªque°
 *
≥ndög_ªque°
)

2105  
REG_REQ_IGNORE
;

2106 
	}
}

2108 
boﬁ
 
	$ªg_dev_ign‹e_˚Œ_höt
(
wùhy
 *wiphy)

2110  
åue
;

2111 
	}
}

2114 
boﬁ
 
	$wùhy_°ri˘_Æpha2_ªgd
(
wùhy
 *wiphy)

2116 i‡(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_STRICT_REG
 &&

2117 !(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_CUSTOM_REG
))

2118  
åue
;

2119  
Ál£
;

2120 
	}
}

2122 
boﬁ
 
	$ign‹e_ªg_upd©e
(
wùhy
 *wiphy,

2123 
∆80211_ªg_öôüt‹
 
öôüt‹
)

2125 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

2127 i‡(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
)

2128  
åue
;

2130 i‡(!
Ã
) {

2131 
	`¥_debug
("IgnoringÑegulatoryÑequest set by %s sinceÜast_request isÇot set\n",

2132 
	`ªg_öôüt‹_«me
(
öôüt‹
));

2133  
åue
;

2136 i‡(
öôüt‹
 =
NL80211_REGDOM_SET_BY_CORE
 &&

2137 
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_CUSTOM_REG
) {

2138 
	`¥_debug
("IgnoringÑegulatoryÑequest set by %s sinceÅhe driver uses its own customÑegulatory domain\n",

2139 
	`ªg_öôüt‹_«me
(
öôüt‹
));

2140  
åue
;

2147 i‡(
	`wùhy_°ri˘_Æpha2_ªgd
(
wùhy
Ë&& !wùhy->
ªgd
 &&

2148 
öôüt‹
 !
NL80211_REGDOM_SET_BY_COUNTRY_IE
 &&

2149 !
	`is_w‹ld_ªgdom
(
Ã
->
Æpha2
)) {

2150 
	`¥_debug
("IgnoringÑegulatoryÑequest set by %s sinceÅhe driverÑequires its ownÑegulatory domainÅo be set first\n",

2151 
	`ªg_öôüt‹_«me
(
öôüt‹
));

2152  
åue
;

2155 i‡(
	`ªg_ªque°_˚Œ_ba£
(
Ã
))

2156  
	`ªg_dev_ign‹e_˚Œ_höt
(
wùhy
);

2158  
Ál£
;

2159 
	}
}

2161 
boﬁ
 
	$ªg_is_w‹ld_rﬂmög
(
wùhy
 *wiphy)

2163 c⁄° 
õì80211_ªgdomaö
 *
¸
 = 
	`gë_cfg80211_ªgdom
();

2164 c⁄° 
õì80211_ªgdomaö
 *
wr
 = 
	`gë_wùhy_ªgdom
(
wùhy
);

2165 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

2167 i‡(
	`is_w‹ld_ªgdom
(
¸
->
Æpha2
Ë|| (
wr
 && is_world_regdom(wr->alpha2)))

2168  
åue
;

2170 i‡(
Ã
 &&Ür->
öôüt‹
 !
NL80211_REGDOM_SET_BY_COUNTRY_IE
 &&

2171 
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_CUSTOM_REG
)

2172  
åue
;

2174  
Ál£
;

2175 
	}
}

2177 
	$ªg_ˇŒ_nŸifõr
(
wùhy
 *wiphy,

2178 
ªguœt‹y_ªque°
 *
ªque°
)

2180 i‡(
wùhy
->
ªg_nŸifõr
)

2181 
wùhy
->
	`ªg_nŸifõr
(wùhy, 
ªque°
);

2182 
	}
}

2184 
	$h™dÀ_ªg_bóc⁄
(
wùhy
 *wùhy, 
ch™_idx
,

2185 
ªg_bóc⁄
 *reg_beacon)

2187 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

2188 
õì80211_ch™√l
 *
ch™
;

2189 
boﬁ
 
ch™√l_ch™ged
 = 
Ál£
;

2190 
õì80211_ch™√l
 
ch™_bef‹e
;

2191 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

2193 
sb™d
 = 
wùhy
->
b™ds
[
ªg_bóc⁄
->
ch™
.
b™d
];

2194 
ch™
 = &
sb™d
->
ch™√ls
[
ch™_idx
];

2196 i‡(
	`likñy
(!
	`õì80211_ch™√l_equÆ
(
ch™
, &
ªg_bóc⁄
->chan)))

2199 i‡(
ch™
->
bóc⁄_found
)

2202 
ch™
->
bóc⁄_found
 = 
åue
;

2204 i‡(!
	`ªg_is_w‹ld_rﬂmög
(
wùhy
))

2207 i‡(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_DISABLE_BEACON_HINTS
)

2210 
ch™_bef‹e
 = *
ch™
;

2212 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_IR
) {

2213 
ch™
->
Êags
 &~
IEEE80211_CHAN_NO_IR
;

2214 
ch™√l_ch™ged
 = 
åue
;

2217 i‡(
ch™√l_ch™ged
) {

2218 
	`∆80211_£nd_bóc⁄_höt_evít
(
wùhy
, &
ch™_bef‹e
, 
ch™
);

2219 i‡(
wùhy
->
Êags
 & 
WIPHY_FLAG_CHANNEL_CHANGE_ON_BEACON
)

2220 
	`ªg_ˇŒ_nŸifõr
(
wùhy
, 
Ã
);

2222 
	}
}

2228 
	$wùhy_upd©e_√w_bóc⁄
(
wùhy
 *wiphy,

2229 
ªg_bóc⁄
 *reg_beacon)

2231 
i
;

2232 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

2234 i‡(!
wùhy
->
b™ds
[
ªg_bóc⁄
->
ch™
.
b™d
])

2237 
sb™d
 = 
wùhy
->
b™ds
[
ªg_bóc⁄
->
ch™
.
b™d
];

2239 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++)

2240 
	`h™dÀ_ªg_bóc⁄
(
wùhy
, 
i
, 
ªg_bóc⁄
);

2241 
	}
}

2246 
	$wùhy_upd©e_bóc⁄_ªg
(
wùhy
 *wiphy)

2248 
i
;

2249 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

2250 
ªg_bóc⁄
 *reg_beacon;

2252 
	`li°_f‹_óch_íåy
(
ªg_bóc⁄
, &
ªg_bóc⁄_li°
, 
li°
) {

2253 i‡(!
wùhy
->
b™ds
[
ªg_bóc⁄
->
ch™
.
b™d
])

2255 
sb™d
 = 
wùhy
->
b™ds
[
ªg_bóc⁄
->
ch™
.
b™d
];

2256 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++)

2257 
	`h™dÀ_ªg_bóc⁄
(
wùhy
, 
i
, 
ªg_bóc⁄
);

2259 
	}
}

2262 
	$ªg_¥o˚ss_bóc⁄s
(
wùhy
 *wiphy)

2268 i‡(!
œ°_ªque°
)

2270 
	`wùhy_upd©e_bóc⁄_ªg
(
wùhy
);

2271 
	}
}

2273 
boﬁ
 
	$is_ht40_Ælowed
(
õì80211_ch™√l
 *
ch™
)

2275 i‡(!
ch™
)

2276  
Ál£
;

2277 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

2278  
Ál£
;

2280 i‡((
ch™
->
Êags
 & 
IEEE80211_CHAN_NO_HT40
) == IEEE80211_CHAN_NO_HT40)

2281  
Ál£
;

2282  
åue
;

2283 
	}
}

2285 
	$ªg_¥o˚ss_ht_Êags_ch™√l
(
wùhy
 *wiphy,

2286 
õì80211_ch™√l
 *
ch™√l
)

2288 
õì80211_suµ‹ãd_b™d
 *
sb™d
 = 
wùhy
->
b™ds
[
ch™√l
->
b™d
];

2289 
õì80211_ch™√l
 *
ch™√l_bef‹e
 = 
NULL
, *
ch™√l_a·î
 = NULL;

2290 c⁄° 
õì80211_ªgdomaö
 *
ªgd
;

2291 
i
;

2292 
u32
 
Êags
;

2294 i‡(!
	`is_ht40_Ælowed
(
ch™√l
)) {

2295 
ch™√l
->
Êags
 |
IEEE80211_CHAN_NO_HT40
;

2303 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++) {

2304 
õì80211_ch™√l
 *
c
 = &
sb™d
->
ch™√ls
[
i
];

2306 i‡(
c
->
˚¡î_‰eq
 =(
ch™√l
->center_freq - 20))

2307 
ch™√l_bef‹e
 = 
c
;

2308 i‡(
c
->
˚¡î_‰eq
 =(
ch™√l
->center_freq + 20))

2309 
ch™√l_a·î
 = 
c
;

2312 
Êags
 = 0;

2313 
ªgd
 = 
	`gë_wùhy_ªgdom
(
wùhy
);

2314 i‡(
ªgd
) {

2315 c⁄° 
õì80211_ªg_ruÀ
 *
ªg_ruÀ
 =

2316 
	`‰eq_ªg_öfo_ªgd
(
	`MHZ_TO_KHZ
(
ch™√l
->
˚¡î_‰eq
),

2317 
ªgd
, 
	`MHZ_TO_KHZ
(20));

2319 i‡(!
	`IS_ERR
(
ªg_ruÀ
))

2320 
Êags
 = 
ªg_ruÀ
->flags;

2328 i‡(!
	`is_ht40_Ælowed
(
ch™√l_bef‹e
) ||

2329 
Êags
 & 
NL80211_RRF_NO_HT40MINUS
)

2330 
ch™√l
->
Êags
 |
IEEE80211_CHAN_NO_HT40MINUS
;

2332 
ch™√l
->
Êags
 &~
IEEE80211_CHAN_NO_HT40MINUS
;

2334 i‡(!
	`is_ht40_Ælowed
(
ch™√l_a·î
) ||

2335 
Êags
 & 
NL80211_RRF_NO_HT40PLUS
)

2336 
ch™√l
->
Êags
 |
IEEE80211_CHAN_NO_HT40PLUS
;

2338 
ch™√l
->
Êags
 &~
IEEE80211_CHAN_NO_HT40PLUS
;

2339 
	}
}

2341 
	$ªg_¥o˚ss_ht_Êags_b™d
(
wùhy
 *wiphy,

2342 
õì80211_suµ‹ãd_b™d
 *
sb™d
)

2344 
i
;

2346 i‡(!
sb™d
)

2349 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++)

2350 
	`ªg_¥o˚ss_ht_Êags_ch™√l
(
wùhy
, &
sb™d
->
ch™√ls
[
i
]);

2351 
	}
}

2353 
	$ªg_¥o˚ss_ht_Êags
(
wùhy
 *wiphy)

2355 
∆80211_b™d
 
b™d
;

2357 i‡(!
wùhy
)

2360 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++)

2361 
	`ªg_¥o˚ss_ht_Êags_b™d
(
wùhy
, wùhy->
b™ds
[
b™d
]);

2362 
	}
}

2364 
boﬁ
 
	$ªg_wdev_ch™_vÆid
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
)

2366 
cfg80211_ch™_def
 
ch™def
 = {};

2367 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

2368 
∆80211_i·y≥
 
i·y≥
;

2369 
boﬁ
 
ªt
;

2370 
lök
;

2372 
i·y≥
 = 
wdev
->iftype;

2375 i‡(!
wdev
->
√tdev
 || !
	`√tif_ru¬ög
(wdev->netdev))

2376  
åue
;

2378 
lök
 = 0;Üök < 
	`ARRAY_SIZE
(
wdev
->
löks
);Üink++) {

2379 
õì80211_ch™√l
 *
ch™
;

2381 i‡(!
wdev
->
vÆid_löks
 && 
lök
 > 0)

2383 i‡(
wdev
->
vÆid_löks
 && !(wdev->vÆid_lök†& 
	`BIT
(
lök
)))

2385 
i·y≥
) {

2386 
NL80211_IFTYPE_AP
:

2387 
NL80211_IFTYPE_P2P_GO
:

2388 i‡(!
wdev
->
löks
[
lök
].
≠
.
bóc⁄_öãrvÆ
)

2390 
ch™def
 = 
wdev
->
löks
[
lök
].
≠
.chandef;

2392 
NL80211_IFTYPE_MESH_POINT
:

2393 i‡(!
wdev
->
u
.
mesh
.
bóc⁄_öãrvÆ
)

2395 
ch™def
 = 
wdev
->
u
.
mesh
.chandef;

2397 
NL80211_IFTYPE_ADHOC
:

2398 i‡(!
wdev
->
u
.
ibss
.
ssid_Àn
)

2400 
ch™def
 = 
wdev
->
u
.
ibss
.chandef;

2402 
NL80211_IFTYPE_STATION
:

2403 
NL80211_IFTYPE_P2P_CLIENT
:

2405 i‡(!
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
)

2408 
ch™
 = 
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
->
pub
.
ch™√l
;

2409 i‡(!
ch™
)

2412 i‡(!
rdev
->
›s
->
gë_ch™√l
 ||

2413 
	`rdev_gë_ch™√l
(
rdev
, 
wdev
, 
lök
, &
ch™def
))

2414 
	`cfg80211_ch™def_¸óã
(&
ch™def
, 
ch™
,

2415 
NL80211_CHAN_NO_HT
);

2417 
NL80211_IFTYPE_MONITOR
:

2418 
NL80211_IFTYPE_AP_VLAN
:

2419 
NL80211_IFTYPE_P2P_DEVICE
:

2422 
NL80211_IFTYPE_OCB
:

2423 i‡(!
wdev
->
u
.
ocb
.
ch™def
.
ch™
)

2425 
ch™def
 = 
wdev
->
u
.
ocb
.chandef;

2427 
NL80211_IFTYPE_NAN
:

2432 
	`WARN_ON_ONCE
(1);

2436 
i·y≥
) {

2437 
NL80211_IFTYPE_AP
:

2438 
NL80211_IFTYPE_P2P_GO
:

2439 
NL80211_IFTYPE_ADHOC
:

2440 
NL80211_IFTYPE_MESH_POINT
:

2441 
ªt
 = 
	`cfg80211_ªg_ˇn_bóc⁄_ªœx
(
wùhy
, &
ch™def
,

2442 
i·y≥
);

2443 i‡(!
ªt
)

2444  
ªt
;

2446 
NL80211_IFTYPE_STATION
:

2447 
NL80211_IFTYPE_P2P_CLIENT
:

2448 
ªt
 = 
	`cfg80211_ch™def_ußbÀ
(
wùhy
, &
ch™def
,

2449 
IEEE80211_CHAN_DISABLED
);

2450 i‡(!
ªt
)

2451  
ªt
;

2458  
åue
;

2459 
	}
}

2461 
	$ªg_Àave_övÆid_ch™s
(
wùhy
 *wiphy)

2463 
wúñess_dev
 *
wdev
;

2464 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

2466 
	`wùhy_lock
(
wùhy
);

2467 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
)

2468 i‡(!
	`ªg_wdev_ch™_vÆid
(
wùhy
, 
wdev
))

2469 
	`cfg80211_Àave
(
rdev
, 
wdev
);

2470 
	`wùhy_u∆ock
(
wùhy
);

2471 
	}
}

2473 
	$ªg_check_ch™s_w‹k
(
w‹k_°ru˘
 *
w‹k
)

2475 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

2477 
	`¥_debug
("Verifyingáctive interfacesáfterÑeg change\n");

2478 
	`π∆_lock
();

2480 
	`f‹_óch_rdev
(
rdev
)

2481 
	`ªg_Àave_övÆid_ch™s
(&
rdev
->
wùhy
);

2483 
	`π∆_u∆ock
();

2484 
	}
}

2486 
	$ªg_check_ch™√ls
()

2492 
	`mod_dñayed_w‹k
(
sy°em_powî_efficõ¡_wq
,

2493 &
ªg_check_ch™s
,

2494 
	`m£cs_to_jiffõs
(
REG_ENFORCE_GRACE_MS
));

2495 
	}
}

2497 
	$wùhy_upd©e_ªguœt‹y
(
wùhy
 *wiphy,

2498 
∆80211_ªg_öôüt‹
 
öôüt‹
)

2500 
∆80211_b™d
 
b™d
;

2501 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

2503 i‡(
	`ign‹e_ªg_upd©e
(
wùhy
, 
öôüt‹
)) {

2509 i‡(
öôüt‹
 =
NL80211_REGDOM_SET_BY_CORE
 &&

2510 
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_CUSTOM_REG
 &&

2511 !(
wùhy
->
ªguœt‹y_Êags
 &

2512 
REGULATORY_WIPHY_SELF_MANAGED
))

2513 
	`ªg_ˇŒ_nŸifõr
(
wùhy
, 
Ã
);

2517 
Ã
->
dfs_ªgi⁄
 = 
	`gë_cfg80211_ªgdom
()->dfs_region;

2519 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++)

2520 
	`h™dÀ_b™d
(
wùhy
, 
öôüt‹
, wùhy->
b™ds
[
b™d
]);

2522 
	`ªg_¥o˚ss_bóc⁄s
(
wùhy
);

2523 
	`ªg_¥o˚ss_ht_Êags
(
wùhy
);

2524 
	`ªg_ˇŒ_nŸifõr
(
wùhy
, 
Ã
);

2525 
	}
}

2527 
	$upd©e_Æl_wùhy_ªguœt‹y
(
∆80211_ªg_öôüt‹
 
öôüt‹
)

2529 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

2530 
wùhy
 *wiphy;

2532 
	`ASSERT_RTNL
();

2534 
	`f‹_óch_rdev
(
rdev
) {

2535 
wùhy
 = &
rdev
->wiphy;

2536 
	`wùhy_upd©e_ªguœt‹y
(
wùhy
, 
öôüt‹
);

2539 
	`ªg_check_ch™√ls
();

2540 
	}
}

2542 
	$h™dÀ_ch™√l_cu°om
(
wùhy
 *wiphy,

2543 
õì80211_ch™√l
 *
ch™
,

2544 c⁄° 
õì80211_ªgdomaö
 *
ªgd
,

2545 
u32
 
mö_bw
)

2547 
u32
 
bw_Êags
 = 0;

2548 c⁄° 
õì80211_ªg_ruÀ
 *
ªg_ruÀ
 = 
NULL
;

2549 c⁄° 
õì80211_powî_ruÀ
 *
powî_ruÀ
 = 
NULL
;

2550 
u32
 
bw
, 
˚¡î_‰eq_khz
;

2552 
˚¡î_‰eq_khz
 = 
	`õì80211_ch™√l_to_khz
(
ch™
);

2553 
bw
 = 
	`MHZ_TO_KHZ
(20); bw >
mö_bw
; bw = bw / 2) {

2554 
ªg_ruÀ
 = 
	`‰eq_ªg_öfo_ªgd
(
˚¡î_‰eq_khz
, 
ªgd
, 
bw
);

2555 i‡(!
	`IS_ERR
(
ªg_ruÀ
))

2559 i‡(
	`IS_ERR_OR_NULL
(
ªg_ruÀ
)) {

2560 
	`¥_debug
("Disabling freq %d.%03d MHzás customÑegd hasÇoÑuleÅhat fits it\n",

2561 
ch™
->
˚¡î_‰eq
, ch™->
‰eq_off£t
);

2562 i‡(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
) {

2563 
ch™
->
Êags
 |
IEEE80211_CHAN_DISABLED
;

2565 
ch™
->
‹ig_Êags
 |
IEEE80211_CHAN_DISABLED
;

2566 
ch™
->
Êags
 = ch™->
‹ig_Êags
;

2571 
powî_ruÀ
 = &
ªg_ruÀ
->power_rule;

2572 
bw_Êags
 = 
	`ªg_ruÀ_to_ch™_bw_Êags
(
ªgd
, 
ªg_ruÀ
, 
ch™
);

2574 
ch™
->
dfs_°©e_íãªd
 = 
jiffõs
;

2575 
ch™
->
dfs_°©e
 = 
NL80211_DFS_USABLE
;

2577 
ch™
->
bóc⁄_found
 = 
Ál£
;

2579 i‡(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
)

2580 
ch™
->
Êags
 = ch™->
‹ig_Êags
 | 
bw_Êags
 |

2581 
	`m≠_ªgdom_Êags
(
ªg_ruÀ
->
Êags
);

2583 
ch™
->
Êags
 |
	`m≠_ªgdom_Êags
(
ªg_ruÀ
->ÊagsË| 
bw_Êags
;

2585 
ch™
->
max_™ã¬a_gaö
 = (Ë
	`MBI_TO_DBI
(
powî_ruÀ
->max_antenna_gain);

2586 
ch™
->
max_ªg_powî
 = ch™->
max_powî
 =

2587 (Ë
	`MBM_TO_DBM
(
powî_ruÀ
->
max_eúp
);

2589 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_RADAR
) {

2590 i‡(
ªg_ruÀ
->
dfs_ˇc_ms
)

2591 
ch™
->
dfs_ˇc_ms
 = 
ªg_ruÀ
->dfs_cac_ms;

2593 
ch™
->
dfs_ˇc_ms
 = 
IEEE80211_DFS_MIN_CAC_TIME_MS
;

2596 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_PSD
)

2597 
ch™
->
psd
 = 
ªg_ruÀ
->psd;

2599 
ch™
->
max_powî
 = ch™->
max_ªg_powî
;

2600 
	}
}

2602 
	$h™dÀ_b™d_cu°om
(
wùhy
 *wiphy,

2603 
õì80211_suµ‹ãd_b™d
 *
sb™d
,

2604 c⁄° 
õì80211_ªgdomaö
 *
ªgd
)

2606 
i
;

2608 i‡(!
sb™d
)

2616 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++)

2617 
	`h™dÀ_ch™√l_cu°om
(
wùhy
, &
sb™d
->
ch™√ls
[
i
], 
ªgd
,

2618 
	`MHZ_TO_KHZ
(20));

2619 
	}
}

2622 
	$wùhy_≠∂y_cu°om_ªguœt‹y
(
wùhy
 *wiphy,

2623 c⁄° 
õì80211_ªgdomaö
 *
ªgd
)

2625 c⁄° 
õì80211_ªgdomaö
 *
√w_ªgd
, *
tmp
;

2626 
∆80211_b™d
 
b™d
;

2627 
b™ds_£t
 = 0;

2629 
	`WARN
(!(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_CUSTOM_REG
),

2631 
wùhy
->
ªguœt‹y_Êags
 |
REGULATORY_CUSTOM_REG
;

2633 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

2634 i‡(!
wùhy
->
b™ds
[
b™d
])

2636 
	`h™dÀ_b™d_cu°om
(
wùhy
, wùhy->
b™ds
[
b™d
], 
ªgd
);

2637 
b™ds_£t
++;

2644 
	`WARN_ON
(!
b™ds_£t
);

2645 
√w_ªgd
 = 
	`ªg_c›y_ªgd
(
ªgd
);

2646 i‡(
	`IS_ERR
(
√w_ªgd
))

2649 
	`π∆_lock
();

2650 
	`wùhy_lock
(
wùhy
);

2652 
tmp
 = 
	`gë_wùhy_ªgdom
(
wùhy
);

2653 
	`rcu_assign_poöãr
(
wùhy
->
ªgd
, 
√w_ªgd
);

2654 
	`rcu_‰ì_ªgdom
(
tmp
);

2656 
	`wùhy_u∆ock
(
wùhy
);

2657 
	`π∆_u∆ock
();

2658 
	}
}

2659 
EXPORT_SYMBOL
(
wùhy_≠∂y_cu°om_ªguœt‹y
);

2661 
	$ªg_£t_ªque°_¥o˚s£d
()

2663 
boﬁ
 
√ed_m‹e_¥o˚ssög
 = 
Ál£
;

2664 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

2666 
Ã
->
¥o˚s£d
 = 
åue
;

2668 
	`•ö_lock
(&
ªg_ªque°s_lock
);

2669 i‡(!
	`li°_em±y
(&
ªg_ªque°s_li°
))

2670 
√ed_m‹e_¥o˚ssög
 = 
åue
;

2671 
	`•ö_u∆ock
(&
ªg_ªque°s_lock
);

2673 
	`ˇn˚l_¸da_timeout
();

2675 i‡(
√ed_m‹e_¥o˚ssög
)

2676 
	`scheduÀ_w‹k
(&
ªg_w‹k
);

2677 
	}
}

2689 
ªg_ªque°_åótmít


2690 
	$ªg_¥o˚ss_höt_c‹e
(
ªguœt‹y_ªque°
 *
c‹e_ªque°
)

2692 i‡(
	`ªg_quîy_d©aba£
(
c‹e_ªque°
)) {

2693 
c‹e_ªque°
->
öãr£˘
 = 
Ál£
;

2694 
c‹e_ªque°
->
¥o˚s£d
 = 
Ál£
;

2695 
	`ªg_upd©e_œ°_ªque°
(
c‹e_ªque°
);

2696  
REG_REQ_OK
;

2699  
REG_REQ_IGNORE
;

2700 
	}
}

2702 
ªg_ªque°_åótmít


2703 
	$__ªg_¥o˚ss_höt_u£r
(
ªguœt‹y_ªque°
 *
u£r_ªque°
)

2705 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

2707 i‡(
	`ªg_ªque°_˚Œ_ba£
(
u£r_ªque°
))

2708  
	`ªg_ign‹e_˚Œ_höt
(
u£r_ªque°
);

2710 i‡(
	`ªg_ªque°_˚Œ_ba£
(
Ã
))

2711  
REG_REQ_IGNORE
;

2713 i‡(
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_COUNTRY_IE
)

2714  
REG_REQ_INTERSECT
;

2719 i‡(
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_USER
 &&

2720 
Ã
->
öãr£˘
)

2721  
REG_REQ_IGNORE
;

2726 i‡((
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_CORE
 ||

2727 
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_DRIVER
 ||

2728 
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_USER
) &&

2729 
	`ªgdom_ch™ges
(
Ã
->
Æpha2
))

2730  
REG_REQ_IGNORE
;

2732 i‡(!
	`ªgdom_ch™ges
(
u£r_ªque°
->
Æpha2
))

2733  
REG_REQ_ALREADY_SET
;

2735  
REG_REQ_OK
;

2736 
	}
}

2748 
ªg_ªque°_åótmít


2749 
	$ªg_¥o˚ss_höt_u£r
(
ªguœt‹y_ªque°
 *
u£r_ªque°
)

2751 
ªg_ªque°_åótmít
 
åótmít
;

2753 
åótmít
 = 
	`__ªg_¥o˚ss_höt_u£r
(
u£r_ªque°
);

2754 i‡(
åótmít
 =
REG_REQ_IGNORE
 ||

2755 
åótmít
 =
REG_REQ_ALREADY_SET
)

2756  
REG_REQ_IGNORE
;

2758 
u£r_ªque°
->
öãr£˘
 = 
åótmít
 =
REG_REQ_INTERSECT
;

2759 
u£r_ªque°
->
¥o˚s£d
 = 
Ál£
;

2761 i‡(
	`ªg_quîy_d©aba£
(
u£r_ªque°
)) {

2762 
	`ªg_upd©e_œ°_ªque°
(
u£r_ªque°
);

2763 
u£r_Æpha2
[0] = 
u£r_ªque°
->
Æpha2
[0];

2764 
u£r_Æpha2
[1] = 
u£r_ªque°
->
Æpha2
[1];

2765  
REG_REQ_OK
;

2768  
REG_REQ_IGNORE
;

2769 
	}
}

2771 
ªg_ªque°_åótmít


2772 
	$__ªg_¥o˚ss_höt_drivî
(
ªguœt‹y_ªque°
 *
drivî_ªque°
)

2774 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

2776 i‡(
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_CORE
) {

2777 i‡(
	`ªgdom_ch™ges
(
drivî_ªque°
->
Æpha2
))

2778  
REG_REQ_OK
;

2779  
REG_REQ_ALREADY_SET
;

2787 i‡(
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_DRIVER
 &&

2788 !
	`ªgdom_ch™ges
(
drivî_ªque°
->
Æpha2
))

2789  
REG_REQ_ALREADY_SET
;

2791  
REG_REQ_INTERSECT
;

2792 
	}
}

2804 
ªg_ªque°_åótmít


2805 
	$ªg_¥o˚ss_höt_drivî
(
wùhy
 *wiphy,

2806 
ªguœt‹y_ªque°
 *
drivî_ªque°
)

2808 c⁄° 
õì80211_ªgdomaö
 *
ªgd
, *
tmp
;

2809 
ªg_ªque°_åótmít
 
åótmít
;

2811 
åótmít
 = 
	`__ªg_¥o˚ss_höt_drivî
(
drivî_ªque°
);

2813 
åótmít
) {

2814 
REG_REQ_OK
:

2816 
REG_REQ_IGNORE
:

2817  
REG_REQ_IGNORE
;

2818 
REG_REQ_INTERSECT
:

2819 
REG_REQ_ALREADY_SET
:

2820 
ªgd
 = 
	`ªg_c›y_ªgd
(
	`gë_cfg80211_ªgdom
());

2821 i‡(
	`IS_ERR
(
ªgd
))

2822  
REG_REQ_IGNORE
;

2824 
tmp
 = 
	`gë_wùhy_ªgdom
(
wùhy
);

2825 
	`ASSERT_RTNL
();

2826 
	`wùhy_lock
(
wùhy
);

2827 
	`rcu_assign_poöãr
(
wùhy
->
ªgd
,Ñegd);

2828 
	`wùhy_u∆ock
(
wùhy
);

2829 
	`rcu_‰ì_ªgdom
(
tmp
);

2833 
drivî_ªque°
->
öãr£˘
 = 
åótmít
 =
REG_REQ_INTERSECT
;

2834 
drivî_ªque°
->
¥o˚s£d
 = 
Ál£
;

2841 i‡(
åótmít
 =
REG_REQ_ALREADY_SET
) {

2842 
	`∆80211_£nd_ªg_ch™ge_evít
(
drivî_ªque°
);

2843 
	`ªg_upd©e_œ°_ªque°
(
drivî_ªque°
);

2844 
	`ªg_£t_ªque°_¥o˚s£d
();

2845  
REG_REQ_ALREADY_SET
;

2848 i‡(
	`ªg_quîy_d©aba£
(
drivî_ªque°
)) {

2849 
	`ªg_upd©e_œ°_ªque°
(
drivî_ªque°
);

2850  
REG_REQ_OK
;

2853  
REG_REQ_IGNORE
;

2854 
	}
}

2856 
ªg_ªque°_åótmít


2857 
	$__ªg_¥o˚ss_höt_cou¡ry_õ
(
wùhy
 *wiphy,

2858 
ªguœt‹y_ªque°
 *
cou¡ry_õ_ªque°
)

2860 
wùhy
 *
œ°_wùhy
 = 
NULL
;

2861 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

2863 i‡(
	`ªg_ªque°_˚Œ_ba£
(
Ã
)) {

2865 i‡(
	`ªgdom_ch™ges
(
cou¡ry_õ_ªque°
->
Æpha2
))

2866  
REG_REQ_IGNORE
;

2867  
REG_REQ_ALREADY_SET
;

2869 i‡(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_COUNTRY_IE_IGNORE
)

2870  
REG_REQ_IGNORE
;

2873 i‡(
	`u∆ikñy
(!
	`is_™_Æpha2
(
cou¡ry_õ_ªque°
->
Æpha2
)))

2874  -
EINVAL
;

2876 i‡(
Ã
->
öôüt‹
 !
NL80211_REGDOM_SET_BY_COUNTRY_IE
)

2877  
REG_REQ_OK
;

2879 
œ°_wùhy
 = 
	`wùhy_idx_to_wùhy
(
Ã
->
wùhy_idx
);

2881 i‡(
œ°_wùhy
 !
wùhy
) {

2888 i‡(
	`ªgdom_ch™ges
(
cou¡ry_õ_ªque°
->
Æpha2
))

2889  
REG_REQ_IGNORE
;

2890  
REG_REQ_ALREADY_SET
;

2893 i‡(
	`ªgdom_ch™ges
(
cou¡ry_õ_ªque°
->
Æpha2
))

2894  
REG_REQ_OK
;

2895  
REG_REQ_ALREADY_SET
;

2896 
	}
}

2908 
ªg_ªque°_åótmít


2909 
	$ªg_¥o˚ss_höt_cou¡ry_õ
(
wùhy
 *wiphy,

2910 
ªguœt‹y_ªque°
 *
cou¡ry_õ_ªque°
)

2912 
ªg_ªque°_åótmít
 
åótmít
;

2914 
åótmít
 = 
	`__ªg_¥o˚ss_höt_cou¡ry_õ
(
wùhy
, 
cou¡ry_õ_ªque°
);

2916 
åótmít
) {

2917 
REG_REQ_OK
:

2919 
REG_REQ_IGNORE
:

2920  
REG_REQ_IGNORE
;

2921 
REG_REQ_ALREADY_SET
:

2922 
	`ªg_‰ì_ªque°
(
cou¡ry_õ_ªque°
);

2923  
REG_REQ_ALREADY_SET
;

2924 
REG_REQ_INTERSECT
:

2929 
	`WARN_ONCE
(1, "Unexpected intersection for countryÉlements");

2930  
REG_REQ_IGNORE
;

2933 
cou¡ry_õ_ªque°
->
öãr£˘
 = 
Ál£
;

2934 
cou¡ry_õ_ªque°
->
¥o˚s£d
 = 
Ál£
;

2936 i‡(
	`ªg_quîy_d©aba£
(
cou¡ry_õ_ªque°
)) {

2937 
	`ªg_upd©e_œ°_ªque°
(
cou¡ry_õ_ªque°
);

2938  
REG_REQ_OK
;

2941  
REG_REQ_IGNORE
;

2942 
	}
}

2944 
boﬁ
 
	$ªg_dfs_domaö_ßme
(
wùhy
 *
wùhy1
, wùhy *
wùhy2
)

2946 c⁄° 
õì80211_ªgdomaö
 *
wùhy1_ªgd
 = 
NULL
;

2947 c⁄° 
õì80211_ªgdomaö
 *
wùhy2_ªgd
 = 
NULL
;

2948 c⁄° 
õì80211_ªgdomaö
 *
cfg80211_ªgd
 = 
NULL
;

2949 
boﬁ
 
dfs_domaö_ßme
;

2951 
	`rcu_ªad_lock
();

2953 
cfg80211_ªgd
 = 
	`rcu_dîe„ªn˚
(
cfg80211_ªgdomaö
);

2954 
wùhy1_ªgd
 = 
	`rcu_dîe„ªn˚
(
wùhy1
->
ªgd
);

2955 i‡(!
wùhy1_ªgd
)

2956 
wùhy1_ªgd
 = 
cfg80211_ªgd
;

2958 
wùhy2_ªgd
 = 
	`rcu_dîe„ªn˚
(
wùhy2
->
ªgd
);

2959 i‡(!
wùhy2_ªgd
)

2960 
wùhy2_ªgd
 = 
cfg80211_ªgd
;

2962 
dfs_domaö_ßme
 = 
wùhy1_ªgd
->
dfs_ªgi⁄
 =
wùhy2_ªgd
->dfs_region;

2964 
	`rcu_ªad_u∆ock
();

2966  
dfs_domaö_ßme
;

2967 
	}
}

2969 
	$ªg_c›y_dfs_ch™_°©e
(
õì80211_ch™√l
 *
d°_ch™
,

2970 
õì80211_ch™√l
 *
§c_ch™
)

2972 i‡(!(
d°_ch™
->
Êags
 & 
IEEE80211_CHAN_RADAR
) ||

2973 !(
§c_ch™
->
Êags
 & 
IEEE80211_CHAN_RADAR
))

2976 i‡(
d°_ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
 ||

2977 
§c_ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

2980 i‡(
§c_ch™
->
˚¡î_‰eq
 =
d°_ch™
->center_freq &&

2981 
d°_ch™
->
dfs_°©e
 =
NL80211_DFS_USABLE
) {

2982 
d°_ch™
->
dfs_°©e
 = 
§c_ch™
->dfs_state;

2983 
d°_ch™
->
dfs_°©e_íãªd
 = 
§c_ch™
->dfs_state_entered;

2985 
	}
}

2987 
	$wùhy_sh¨e_dfs_ch™_°©e
(
wùhy
 *
d°_wùhy
,

2988 
wùhy
 *
§c_wùhy
)

2990 
õì80211_suµ‹ãd_b™d
 *
§c_sb™d
, *
d°_sb™d
;

2991 
õì80211_ch™√l
 *
§c_ch™
, *
d°_ch™
;

2992 
i
, 
j
, 
b™d
;

2994 i‡(!
	`ªg_dfs_domaö_ßme
(
d°_wùhy
, 
§c_wùhy
))

2997 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

2998 
d°_sb™d
 = 
d°_wùhy
->
b™ds
[
b™d
];

2999 
§c_sb™d
 = 
§c_wùhy
->
b™ds
[
b™d
];

3000 i‡(!
d°_sb™d
 || !
§c_sb™d
)

3003 
i
 = 0; i < 
d°_sb™d
->
n_ch™√ls
; i++) {

3004 
d°_ch™
 = &
d°_sb™d
->
ch™√ls
[
i
];

3005 
j
 = 0; j < 
§c_sb™d
->
n_ch™√ls
; j++) {

3006 
§c_ch™
 = &
§c_sb™d
->
ch™√ls
[
j
];

3007 
	`ªg_c›y_dfs_ch™_°©e
(
d°_ch™
, 
§c_ch™
);

3011 
	}
}

3013 
	$wùhy_Æl_sh¨e_dfs_ch™_°©e
(
wùhy
 *wiphy)

3015 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3017 
	`ASSERT_RTNL
();

3019 
	`f‹_óch_rdev
(
rdev
) {

3020 i‡(
wùhy
 =&
rdev
->wiphy)

3022 
	`wùhy_sh¨e_dfs_ch™_°©e
(
wùhy
, &
rdev
->wiphy);

3024 
	}
}

3027 
	$ªg_¥o˚ss_höt
(
ªguœt‹y_ªque°
 *
ªg_ªque°
)

3029 
wùhy
 *wùhy = 
NULL
;

3030 
ªg_ªque°_åótmít
 
åótmít
;

3031 
∆80211_ªg_öôüt‹
 
öôüt‹
 = 
ªg_ªque°
->initiator;

3033 i‡(
ªg_ªque°
->
wùhy_idx
 !
WIPHY_IDX_INVALID
)

3034 
wùhy
 = 
	`wùhy_idx_to_wùhy
(
ªg_ªque°
->
wùhy_idx
);

3036 
öôüt‹
) {

3037 
NL80211_REGDOM_SET_BY_CORE
:

3038 
åótmít
 = 
	`ªg_¥o˚ss_höt_c‹e
(
ªg_ªque°
);

3040 
NL80211_REGDOM_SET_BY_USER
:

3041 
åótmít
 = 
	`ªg_¥o˚ss_höt_u£r
(
ªg_ªque°
);

3043 
NL80211_REGDOM_SET_BY_DRIVER
:

3044 i‡(!
wùhy
)

3045 
out_‰ì
;

3046 
åótmít
 = 
	`ªg_¥o˚ss_höt_drivî
(
wùhy
, 
ªg_ªque°
);

3048 
NL80211_REGDOM_SET_BY_COUNTRY_IE
:

3049 i‡(!
wùhy
)

3050 
out_‰ì
;

3051 
åótmít
 = 
	`ªg_¥o˚ss_höt_cou¡ry_õ
(
wùhy
, 
ªg_ªque°
);

3054 
	`WARN
(1, "övÆid inôüt‹ %d\n", 
öôüt‹
);

3055 
out_‰ì
;

3058 i‡(
åótmít
 =
REG_REQ_IGNORE
)

3059 
out_‰ì
;

3061 
	`WARN
(
åótmít
 !
REG_REQ_OK
 &&Åª©míà!
REG_REQ_ALREADY_SET
,

3062 "u√x≥˘edÅª©míàvÆuê%d\n", 
åótmít
);

3067 i‡(
åótmít
 =
REG_REQ_ALREADY_SET
 && 
wùhy
 &&

3068 
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_STRICT_REG
) {

3069 
	`wùhy_upd©e_ªguœt‹y
(
wùhy
, 
öôüt‹
);

3070 
	`wùhy_Æl_sh¨e_dfs_ch™_°©e
(
wùhy
);

3071 
	`ªg_check_ch™√ls
();

3076 
out_‰ì
:

3077 
	`ªg_‰ì_ªque°
(
ªg_ªque°
);

3078 
	}
}

3080 
	$nŸify_£lf_m™aged_wùhys
(
ªguœt‹y_ªque°
 *
ªque°
)

3082 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3083 
wùhy
 *wiphy;

3085 
	`f‹_óch_rdev
(
rdev
) {

3086 
wùhy
 = &
rdev
->wiphy;

3087 i‡(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
 &&

3088 
ªque°
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_USER
)

3089 
	`ªg_ˇŒ_nŸifõr
(
wùhy
, 
ªque°
);

3091 
	}
}

3098 
	$ªg_¥o˚ss_≥ndög_höts
()

3100 
ªguœt‹y_ªque°
 *
ªg_ªque°
, *
Ã
;

3102 
Ã
 = 
	`gë_œ°_ªque°
();

3105 i‡(
Ã
 && !Ã->
¥o˚s£d
) {

3106 
	`¥_debug
("PendingÑegulatoryÑequest, waiting for itÅo beÖrocessed...\n");

3110 
	`•ö_lock
(&
ªg_ªque°s_lock
);

3112 i‡(
	`li°_em±y
(&
ªg_ªque°s_li°
)) {

3113 
	`•ö_u∆ock
(&
ªg_ªque°s_lock
);

3117 
ªg_ªque°
 = 
	`li°_fú°_íåy
(&
ªg_ªque°s_li°
,

3118 
ªguœt‹y_ªque°
,

3119 
li°
);

3120 
	`li°_dñ_öô
(&
ªg_ªque°
->
li°
);

3122 
	`•ö_u∆ock
(&
ªg_ªque°s_lock
);

3124 
	`nŸify_£lf_m™aged_wùhys
(
ªg_ªque°
);

3126 
	`ªg_¥o˚ss_höt
(
ªg_ªque°
);

3128 
Ã
 = 
	`gë_œ°_ªque°
();

3130 
	`•ö_lock
(&
ªg_ªque°s_lock
);

3131 i‡(!
	`li°_em±y
(&
ªg_ªque°s_li°
Ë&& 
Ã
 &&Ür->
¥o˚s£d
)

3132 
	`scheduÀ_w‹k
(&
ªg_w‹k
);

3133 
	`•ö_u∆ock
(&
ªg_ªque°s_lock
);

3134 
	}
}

3137 
	$ªg_¥o˚ss_≥ndög_bóc⁄_höts
()

3139 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3140 
ªg_bóc⁄
 *
≥ndög_bóc⁄
, *
tmp
;

3143 
	`•ö_lock_bh
(&
ªg_≥ndög_bóc⁄s_lock
);

3145 
	`li°_f‹_óch_íåy_ß„
(
≥ndög_bóc⁄
, 
tmp
,

3146 &
ªg_≥ndög_bóc⁄s
, 
li°
) {

3147 
	`li°_dñ_öô
(&
≥ndög_bóc⁄
->
li°
);

3150 
	`f‹_óch_rdev
(
rdev
)

3151 
	`wùhy_upd©e_√w_bóc⁄
(&
rdev
->
wùhy
, 
≥ndög_bóc⁄
);

3154 
	`li°_add_èû
(&
≥ndög_bóc⁄
->
li°
, &
ªg_bóc⁄_li°
);

3157 
	`•ö_u∆ock_bh
(&
ªg_≥ndög_bóc⁄s_lock
);

3158 
	}
}

3160 
	$ªg_¥o˚ss_£lf_m™aged_höt
(
wùhy
 *wiphy)

3162 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

3163 c⁄° 
õì80211_ªgdomaö
 *
tmp
;

3164 c⁄° 
õì80211_ªgdomaö
 *
ªgd
;

3165 
∆80211_b™d
 
b™d
;

3166 
ªguœt‹y_ªque°
 
ªque°
 = {};

3168 
	`ASSERT_RTNL
();

3169 
	`lockdï_as£π_wùhy
(
wùhy
);

3171 
	`•ö_lock
(&
ªg_ªque°s_lock
);

3172 
ªgd
 = 
rdev
->
ªque°ed_ªgd
;

3173 
rdev
->
ªque°ed_ªgd
 = 
NULL
;

3174 
	`•ö_u∆ock
(&
ªg_ªque°s_lock
);

3176 i‡(!
ªgd
)

3179 
tmp
 = 
	`gë_wùhy_ªgdom
(
wùhy
);

3180 
	`rcu_assign_poöãr
(
wùhy
->
ªgd
,Ñegd);

3181 
	`rcu_‰ì_ªgdom
(
tmp
);

3183 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++)

3184 
	`h™dÀ_b™d_cu°om
(
wùhy
, wùhy->
b™ds
[
b™d
], 
ªgd
);

3186 
	`ªg_¥o˚ss_ht_Êags
(
wùhy
);

3188 
ªque°
.
wùhy_idx
 = 
	`gë_wùhy_idx
(
wùhy
);

3189 
ªque°
.
Æpha2
[0] = 
ªgd
->alpha2[0];

3190 
ªque°
.
Æpha2
[1] = 
ªgd
->alpha2[1];

3191 
ªque°
.
öôüt‹
 = 
NL80211_REGDOM_SET_BY_DRIVER
;

3193 i‡(
wùhy
->
Êags
 & 
WIPHY_FLAG_NOTIFY_REGDOM_BY_DRIVER
)

3194 
	`ªg_ˇŒ_nŸifõr
(
wùhy
, &
ªque°
);

3196 
	`∆80211_£nd_wùhy_ªg_ch™ge_evít
(&
ªque°
);

3197 
	}
}

3199 
	$ªg_¥o˚ss_£lf_m™aged_höts
()

3201 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3203 
	`ASSERT_RTNL
();

3205 
	`f‹_óch_rdev
(
rdev
) {

3206 
	`wùhy_lock
(&
rdev
->
wùhy
);

3207 
	`ªg_¥o˚ss_£lf_m™aged_höt
(&
rdev
->
wùhy
);

3208 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

3211 
	`ªg_check_ch™√ls
();

3212 
	}
}

3214 
	$ªg_todo
(
w‹k_°ru˘
 *
w‹k
)

3216 
	`π∆_lock
();

3217 
	`ªg_¥o˚ss_≥ndög_höts
();

3218 
	`ªg_¥o˚ss_≥ndög_bóc⁄_höts
();

3219 
	`ªg_¥o˚ss_£lf_m™aged_höts
();

3220 
	`π∆_u∆ock
();

3221 
	}
}

3223 
	$queue_ªguœt‹y_ªque°
(
ªguœt‹y_ªque°
 *
ªque°
)

3225 
ªque°
->
Æpha2
[0] = 
	`touµî
(request->alpha2[0]);

3226 
ªque°
->
Æpha2
[1] = 
	`touµî
(request->alpha2[1]);

3228 
	`•ö_lock
(&
ªg_ªque°s_lock
);

3229 
	`li°_add_èû
(&
ªque°
->
li°
, &
ªg_ªque°s_li°
);

3230 
	`•ö_u∆ock
(&
ªg_ªque°s_lock
);

3232 
	`scheduÀ_w‹k
(&
ªg_w‹k
);

3233 
	}
}

3239 
	$ªguœt‹y_höt_c‹e
(c⁄° *
Æpha2
)

3241 
ªguœt‹y_ªque°
 *
ªque°
;

3243 
ªque°
 = 
	`kzÆloc
((
ªguœt‹y_ªque°
), 
GFP_KERNEL
);

3244 i‡(!
ªque°
)

3245  -
ENOMEM
;

3247 
ªque°
->
Æpha2
[0] =álpha2[0];

3248 
ªque°
->
Æpha2
[1] =álpha2[1];

3249 
ªque°
->
öôüt‹
 = 
NL80211_REGDOM_SET_BY_CORE
;

3250 
ªque°
->
wùhy_idx
 = 
WIPHY_IDX_INVALID
;

3252 
	`queue_ªguœt‹y_ªque°
(
ªque°
);

3255 
	}
}

3258 
	$ªguœt‹y_höt_u£r
(c⁄° *
Æpha2
,

3259 
∆80211_u£r_ªg_höt_ty≥
 
u£r_ªg_höt_ty≥
)

3261 
ªguœt‹y_ªque°
 *
ªque°
;

3263 i‡(
	`WARN_ON
(!
Æpha2
))

3264  -
EINVAL
;

3266 i‡(!
	`is_w‹ld_ªgdom
(
Æpha2
Ë&& !
	`is_™_Æpha2
(alpha2))

3267  -
EINVAL
;

3269 
ªque°
 = 
	`kzÆloc
((
ªguœt‹y_ªque°
), 
GFP_KERNEL
);

3270 i‡(!
ªque°
)

3271  -
ENOMEM
;

3273 
ªque°
->
wùhy_idx
 = 
WIPHY_IDX_INVALID
;

3274 
ªque°
->
Æpha2
[0] =álpha2[0];

3275 
ªque°
->
Æpha2
[1] =álpha2[1];

3276 
ªque°
->
öôüt‹
 = 
NL80211_REGDOM_SET_BY_USER
;

3277 
ªque°
->
u£r_ªg_höt_ty≥
 = user_reg_hint_type;

3280 
	`ª£t_¸da_timeouts
();

3282 
	`queue_ªguœt‹y_ªque°
(
ªque°
);

3285 
	}
}

3287 
	$ªguœt‹y_höt_ödo‹
(
boﬁ
 
is_ödo‹
, 
u32
 
p‹tid
)

3289 
	`•ö_lock
(&
ªg_ödo‹_lock
);

3298 
ªg_is_ödo‹
 = 
is_ödo‹
;

3299 i‡(
ªg_is_ödo‹
) {

3300 i‡(!
ªg_is_ödo‹_p‹tid
)

3301 
ªg_is_ödo‹_p‹tid
 = 
p‹tid
;

3303 
ªg_is_ödo‹_p‹tid
 = 0;

3306 
	`•ö_u∆ock
(&
ªg_ödo‹_lock
);

3308 i‡(!
is_ödo‹
)

3309 
	`ªg_check_ch™√ls
();

3312 
	}
}

3314 
	$ªguœt‹y_√éök_nŸify
(
u32
 
p‹tid
)

3316 
	`•ö_lock
(&
ªg_ödo‹_lock
);

3318 i‡(
ªg_is_ödo‹_p‹tid
 !
p‹tid
) {

3319 
	`•ö_u∆ock
(&
ªg_ödo‹_lock
);

3323 
ªg_is_ödo‹
 = 
Ál£
;

3324 
ªg_is_ödo‹_p‹tid
 = 0;

3326 
	`•ö_u∆ock
(&
ªg_ödo‹_lock
);

3328 
	`ªg_check_ch™√ls
();

3329 
	}
}

3332 
	$ªguœt‹y_höt
(
wùhy
 *wùhy, c⁄° *
Æpha2
)

3334 
ªguœt‹y_ªque°
 *
ªque°
;

3336 i‡(
	`WARN_ON
(!
Æpha2
 || !
wùhy
))

3337  -
EINVAL
;

3339 
wùhy
->
ªguœt‹y_Êags
 &~
REGULATORY_CUSTOM_REG
;

3341 
ªque°
 = 
	`kzÆloc
((
ªguœt‹y_ªque°
), 
GFP_KERNEL
);

3342 i‡(!
ªque°
)

3343  -
ENOMEM
;

3345 
ªque°
->
wùhy_idx
 = 
	`gë_wùhy_idx
(
wùhy
);

3347 
ªque°
->
Æpha2
[0] =álpha2[0];

3348 
ªque°
->
Æpha2
[1] =álpha2[1];

3349 
ªque°
->
öôüt‹
 = 
NL80211_REGDOM_SET_BY_DRIVER
;

3352 
	`ª£t_¸da_timeouts
();

3354 
	`queue_ªguœt‹y_ªque°
(
ªque°
);

3357 
	}
}

3358 
EXPORT_SYMBOL
(
ªguœt‹y_höt
);

3360 
	$ªguœt‹y_höt_cou¡ry_õ
(
wùhy
 *wùhy, 
∆80211_b™d
 
b™d
,

3361 c⁄° 
u8
 *
cou¡ry_õ
, u8 
cou¡ry_õ_Àn
)

3363 
Æpha2
[2];

3364 
ívú⁄mít_ˇp
 
ív
 = 
ENVIRON_ANY
;

3365 
ªguœt‹y_ªque°
 *
ªque°
 = 
NULL
, *
Ã
;

3368 i‡(
cou¡ry_õ_Àn
 & 0x01)

3371 i‡(
cou¡ry_õ_Àn
 < 
IEEE80211_COUNTRY_IE_MIN_LEN
)

3374 
ªque°
 = 
	`kzÆloc
((*ªque°), 
GFP_KERNEL
);

3375 i‡(!
ªque°
)

3378 
Æpha2
[0] = 
cou¡ry_õ
[0];

3379 
Æpha2
[1] = 
cou¡ry_õ
[1];

3381 i‡(
cou¡ry_õ
[2] == 'I')

3382 
ív
 = 
ENVIRON_INDOOR
;

3383 i‡(
cou¡ry_õ
[2] == 'O')

3384 
ív
 = 
ENVIRON_OUTDOOR
;

3386 
	`rcu_ªad_lock
();

3387 
Ã
 = 
	`gë_œ°_ªque°
();

3389 i‡(
	`u∆ikñy
(!
Ã
))

3390 
out
;

3397 i‡(
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_COUNTRY_IE
 &&

3398 
Ã
->
wùhy_idx
 !
WIPHY_IDX_INVALID
)

3399 
out
;

3401 
ªque°
->
wùhy_idx
 = 
	`gë_wùhy_idx
(
wùhy
);

3402 
ªque°
->
Æpha2
[0] =álpha2[0];

3403 
ªque°
->
Æpha2
[1] =álpha2[1];

3404 
ªque°
->
öôüt‹
 = 
NL80211_REGDOM_SET_BY_COUNTRY_IE
;

3405 
ªque°
->
cou¡ry_õ_ív
 = 
ív
;

3408 
	`ª£t_¸da_timeouts
();

3410 
	`queue_ªguœt‹y_ªque°
(
ªque°
);

3411 
ªque°
 = 
NULL
;

3412 
out
:

3413 
	`k‰ì
(
ªque°
);

3414 
	`rcu_ªad_u∆ock
();

3415 
	}
}

3417 
	$ª°‹e_Æpha2
(*
Æpha2
, 
boﬁ
 
ª£t_u£r
)

3420 
Æpha2
[0] = '9';

3421 
Æpha2
[1] = '7';

3424 i‡(
	`is_u£r_ªgdom_ßved
()) {

3426 i‡(
ª£t_u£r
) {

3427 
	`¥_debug
("RestoringÑegulatory settings including userÖreference\n");

3428 
u£r_Æpha2
[0] = '9';

3429 
u£r_Æpha2
[1] = '7';

3436 i‡(!
	`is_w‹ld_ªgdom
(
õì80211_ªgdom
)) {

3437 
	`¥_debug
("KeepingÖreference on moduleÖarameter ieee80211_regdom: %c%c\n",

3438 
õì80211_ªgdom
[0], ieee80211_regdom[1]);

3439 
Æpha2
[0] = 
õì80211_ªgdom
[0];

3440 
Æpha2
[1] = 
õì80211_ªgdom
[1];

3443 
	`¥_debug
("RestoringÑegulatory settings whileÖreserving userÖreference for: %c%c\n",

3444 
u£r_Æpha2
[0], user_alpha2[1]);

3445 
Æpha2
[0] = 
u£r_Æpha2
[0];

3446 
Æpha2
[1] = 
u£r_Æpha2
[1];

3448 } i‡(!
	`is_w‹ld_ªgdom
(
õì80211_ªgdom
)) {

3449 
	`¥_debug
("KeepingÖreference on moduleÖarameter ieee80211_regdom: %c%c\n",

3450 
õì80211_ªgdom
[0], ieee80211_regdom[1]);

3451 
Æpha2
[0] = 
õì80211_ªgdom
[0];

3452 
Æpha2
[1] = 
õì80211_ªgdom
[1];

3454 
	`¥_debug
("RestoringÑegulatory settings\n");

3455 
	}
}

3457 
	$ª°‹e_cu°om_ªg_£âögs
(
wùhy
 *wiphy)

3459 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

3460 
∆80211_b™d
 
b™d
;

3461 
õì80211_ch™√l
 *
ch™
;

3462 
i
;

3464 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

3465 
sb™d
 = 
wùhy
->
b™ds
[
b™d
];

3466 i‡(!
sb™d
)

3468 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++) {

3469 
ch™
 = &
sb™d
->
ch™√ls
[
i
];

3470 
ch™
->
Êags
 = ch™->
‹ig_Êags
;

3471 
ch™
->
max_™ã¬a_gaö
 = ch™->
‹ig_mag
;

3472 
ch™
->
max_powî
 = ch™->
‹ig_mpwr
;

3473 
ch™
->
bóc⁄_found
 = 
Ál£
;

3476 
	}
}

3493 
	$ª°‹e_ªguœt‹y_£âögs
(
boﬁ
 
ª£t_u£r
, boﬁ 
ˇched
)

3495 
Æpha2
[2];

3496 
w‹ld_Æpha2
[2];

3497 
ªg_bóc⁄
 *ªg_bóc⁄, *
btmp
;

3498 
	`LIST_HEAD
(
tmp_ªg_ªq_li°
);

3499 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3501 
	`ASSERT_RTNL
();

3508 
	`•ö_lock
(&
ªg_ödo‹_lock
);

3509 i‡(
ªg_is_ödo‹
 && !
ªg_is_ödo‹_p‹tid
) {

3510 
ªg_is_ödo‹
 = 
Ál£
;

3511 
	`ªg_check_ch™√ls
();

3513 
	`•ö_u∆ock
(&
ªg_ödo‹_lock
);

3515 
	`ª£t_ªgdomaös
(
åue
, &
w‹ld_ªgdom
);

3516 
	`ª°‹e_Æpha2
(
Æpha2
, 
ª£t_u£r
);

3524 
	`•ö_lock
(&
ªg_ªque°s_lock
);

3525 
	`li°_•li˚_èû_öô
(&
ªg_ªque°s_li°
, &
tmp_ªg_ªq_li°
);

3526 
	`•ö_u∆ock
(&
ªg_ªque°s_lock
);

3529 
	`•ö_lock_bh
(&
ªg_≥ndög_bóc⁄s_lock
);

3530 
	`li°_f‹_óch_íåy_ß„
(
ªg_bóc⁄
, 
btmp
, &
ªg_≥ndög_bóc⁄s
, 
li°
) {

3531 
	`li°_dñ
(&
ªg_bóc⁄
->
li°
);

3532 
	`k‰ì
(
ªg_bóc⁄
);

3534 
	`•ö_u∆ock_bh
(&
ªg_≥ndög_bóc⁄s_lock
);

3536 
	`li°_f‹_óch_íåy_ß„
(
ªg_bóc⁄
, 
btmp
, &
ªg_bóc⁄_li°
, 
li°
) {

3537 
	`li°_dñ
(&
ªg_bóc⁄
->
li°
);

3538 
	`k‰ì
(
ªg_bóc⁄
);

3542 
w‹ld_Æpha2
[0] = 
cfg80211_w‹ld_ªgdom
->
Æpha2
[0];

3543 
w‹ld_Æpha2
[1] = 
cfg80211_w‹ld_ªgdom
->
Æpha2
[1];

3545 
	`f‹_óch_rdev
(
rdev
) {

3546 i‡(
rdev
->
wùhy
.
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
)

3548 i‡(
rdev
->
wùhy
.
ªguœt‹y_Êags
 & 
REGULATORY_CUSTOM_REG
)

3549 
	`ª°‹e_cu°om_ªg_£âögs
(&
rdev
->
wùhy
);

3552 i‡(
ˇched
 && (!
	`is_™_Æpha2
(
Æpha2
) ||

3553 !
	`IS_ERR_OR_NULL
(
cfg80211_u£r_ªgdom
))) {

3554 
	`ª£t_ªgdomaös
(
Ál£
, 
cfg80211_w‹ld_ªgdom
);

3555 
	`upd©e_Æl_wùhy_ªguœt‹y
(
NL80211_REGDOM_SET_BY_CORE
);

3556 
	`¥öt_ªgdomaö
(
	`gë_cfg80211_ªgdom
());

3557 
	`∆80211_£nd_ªg_ch™ge_evít
(&
c‹e_ªque°_w‹ld
);

3558 
	`ªg_£t_ªque°_¥o˚s£d
();

3560 i‡(
	`is_™_Æpha2
(
Æpha2
) &&

3561 !
	`ªguœt‹y_höt_u£r
(
Æpha2
, 
NL80211_USER_REG_HINT_USER
)) {

3562 
ªguœt‹y_ªque°
 *
uªq
;

3564 
	`•ö_lock
(&
ªg_ªque°s_lock
);

3565 
uªq
 = 
	`li°_œ°_íåy
(&
ªg_ªque°s_li°
,

3566 
ªguœt‹y_ªque°
,

3567 
li°
);

3568 
	`li°_dñ
(&
uªq
->
li°
);

3569 
	`•ö_u∆ock
(&
ªg_ªque°s_lock
);

3571 
	`nŸify_£lf_m™aged_wùhys
(
uªq
);

3572 
	`ªg_upd©e_œ°_ªque°
(
uªq
);

3573 
	`£t_ªgdom
(
	`ªg_c›y_ªgd
(
cfg80211_u£r_ªgdom
),

3574 
REGD_SOURCE_CACHED
);

3577 
	`ªguœt‹y_höt_c‹e
(
w‹ld_Æpha2
);

3584 i‡(
	`is_™_Æpha2
(
Æpha2
))

3585 
	`ªguœt‹y_höt_u£r
(
Æpha2
, 
NL80211_USER_REG_HINT_USER
);

3588 
	`•ö_lock
(&
ªg_ªque°s_lock
);

3589 
	`li°_•li˚_èû_öô
(&
tmp_ªg_ªq_li°
, &
ªg_ªque°s_li°
);

3590 
	`•ö_u∆ock
(&
ªg_ªque°s_lock
);

3592 
	`¥_debug
("KickingÅhe queue\n");

3594 
	`scheduÀ_w‹k
(&
ªg_w‹k
);

3595 
	}
}

3597 
boﬁ
 
	$is_wùhy_Æl_£t_ªg_Êag
(
õì80211_ªguœt‹y_Êags
 
Êag
)

3599 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3600 
wúñess_dev
 *
wdev
;

3602 
	`f‹_óch_rdev
(
rdev
) {

3603 
	`wùhy_lock
(&
rdev
->
wùhy
);

3604 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

3605 i‡(!(
wdev
->
wùhy
->
ªguœt‹y_Êags
 & 
Êag
)) {

3606 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

3607  
Ál£
;

3610 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

3613  
åue
;

3614 
	}
}

3616 
	$ªguœt‹y_höt_disc⁄√˘
()

3622 i‡(
	`is_wùhy_Æl_£t_ªg_Êag
(
REGULATORY_COUNTRY_IE_IGNORE
)) {

3623 
ªg_bóc⁄
 *ªg_bóc⁄, *
btmp
;

3625 i‡(
	`is_wùhy_Æl_£t_ªg_Êag
(
REGULATORY_DISABLE_BEACON_HINTS
))

3628 
	`•ö_lock_bh
(&
ªg_≥ndög_bóc⁄s_lock
);

3629 
	`li°_f‹_óch_íåy_ß„
(
ªg_bóc⁄
, 
btmp
,

3630 &
ªg_≥ndög_bóc⁄s
, 
li°
) {

3631 
	`li°_dñ
(&
ªg_bóc⁄
->
li°
);

3632 
	`k‰ì
(
ªg_bóc⁄
);

3634 
	`•ö_u∆ock_bh
(&
ªg_≥ndög_bóc⁄s_lock
);

3636 
	`li°_f‹_óch_íåy_ß„
(
ªg_bóc⁄
, 
btmp
,

3637 &
ªg_bóc⁄_li°
, 
li°
) {

3638 
	`li°_dñ
(&
ªg_bóc⁄
->
li°
);

3639 
	`k‰ì
(
ªg_bóc⁄
);

3645 
	`¥_debug
("All devicesáre disconnected, goingÅoÑestoreÑegulatory settings\n");

3646 
	`ª°‹e_ªguœt‹y_£âögs
(
Ál£
, 
åue
);

3647 
	}
}

3649 
boﬁ
 
	$‰eq_is_ch™_12_13_14
(
u32
 
‰eq
)

3651 i‡(
‰eq
 =
	`õì80211_ch™√l_to_‰equícy
(12, 
NL80211_BAND_2GHZ
) ||

3652 
‰eq
 =
	`õì80211_ch™√l_to_‰equícy
(13, 
NL80211_BAND_2GHZ
) ||

3653 
‰eq
 =
	`õì80211_ch™√l_to_‰equícy
(14, 
NL80211_BAND_2GHZ
))

3654  
åue
;

3655  
Ál£
;

3656 
	}
}

3658 
boﬁ
 
	$≥ndög_ªg_bóc⁄
(
õì80211_ch™√l
 *
bóc⁄_ch™
)

3660 
ªg_bóc⁄
 *
≥ndög_bóc⁄
;

3662 
	`li°_f‹_óch_íåy
(
≥ndög_bóc⁄
, &
ªg_≥ndög_bóc⁄s
, 
li°
)

3663 i‡(
	`õì80211_ch™√l_equÆ
(
bóc⁄_ch™
,

3664 &
≥ndög_bóc⁄
->
ch™
))

3665  
åue
;

3666  
Ál£
;

3667 
	}
}

3669 
	$ªguœt‹y_höt_found_bóc⁄
(
wùhy
 *wiphy,

3670 
õì80211_ch™√l
 *
bóc⁄_ch™
,

3671 
gÂ_t
 
gÂ
)

3673 
ªg_bóc⁄
 *reg_beacon;

3674 
boﬁ
 
¥o˚ssög
;

3676 i‡(
bóc⁄_ch™
->
bóc⁄_found
 ||

3677 
bóc⁄_ch™
->
Êags
 & 
IEEE80211_CHAN_RADAR
 ||

3678 (
bóc⁄_ch™
->
b™d
 =
NL80211_BAND_2GHZ
 &&

3679 !
	`‰eq_is_ch™_12_13_14
(
bóc⁄_ch™
->
˚¡î_‰eq
)))

3682 
	`•ö_lock_bh
(&
ªg_≥ndög_bóc⁄s_lock
);

3683 
¥o˚ssög
 = 
	`≥ndög_ªg_bóc⁄
(
bóc⁄_ch™
);

3684 
	`•ö_u∆ock_bh
(&
ªg_≥ndög_bóc⁄s_lock
);

3686 i‡(
¥o˚ssög
)

3689 
ªg_bóc⁄
 = 
	`kzÆloc
((ªg_bóc⁄), 
gÂ
);

3690 i‡(!
ªg_bóc⁄
)

3691  -
ENOMEM
;

3693 
	`¥_debug
("FoundÇew beacon on frequency: %d.%03d MHz (Ch %d) on %s\n",

3694 
bóc⁄_ch™
->
˚¡î_‰eq
, bóc⁄_ch™->
‰eq_off£t
,

3695 
	`õì80211_‰eq_khz_to_ch™√l
(

3696 
	`õì80211_ch™√l_to_khz
(
bóc⁄_ch™
)),

3697 
	`wùhy_«me
(
wùhy
));

3699 
	`mem˝y
(&
ªg_bóc⁄
->
ch™
, 
bóc⁄_ch™
,

3700 (
õì80211_ch™√l
));

3706 
	`•ö_lock_bh
(&
ªg_≥ndög_bóc⁄s_lock
);

3707 
	`li°_add_èû
(&
ªg_bóc⁄
->
li°
, &
ªg_≥ndög_bóc⁄s
);

3708 
	`•ö_u∆ock_bh
(&
ªg_≥ndög_bóc⁄s_lock
);

3710 
	`scheduÀ_w‹k
(&
ªg_w‹k
);

3713 
	}
}

3715 
	$¥öt_rd_ruÀs
(c⁄° 
õì80211_ªgdomaö
 *
rd
)

3717 
i
;

3718 c⁄° 
õì80211_ªg_ruÀ
 *
ªg_ruÀ
 = 
NULL
;

3719 c⁄° 
õì80211_‰eq_ønge
 *
‰eq_ønge
 = 
NULL
;

3720 c⁄° 
õì80211_powî_ruÀ
 *
powî_ruÀ
 = 
NULL
;

3721 
bw
[32], 
ˇc_time
[32];

3723 
	`¥_debug
(" (start_freq -Énd_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)\n");

3725 
i
 = 0; i < 
rd
->
n_ªg_ruÀs
; i++) {

3726 
ªg_ruÀ
 = &
rd
->
ªg_ruÀs
[
i
];

3727 
‰eq_ønge
 = &
ªg_ruÀ
->freq_range;

3728 
powî_ruÀ
 = &
ªg_ruÀ
->power_rule;

3730 i‡(
ªg_ruÀ
->
Êags
 & 
NL80211_RRF_AUTO_BW
)

3731 
	`¢¥ötf
(
bw
, (bw), "%d KHz, %u KHz AUTO",

3732 
‰eq_ønge
->
max_b™dwidth_khz
,

3733 
	`ªg_gë_max_b™dwidth
(
rd
, 
ªg_ruÀ
));

3735 
	`¢¥ötf
(
bw
, (bw), "%d KHz",

3736 
‰eq_ønge
->
max_b™dwidth_khz
);

3738 i‡(
ªg_ruÀ
->
Êags
 & 
NL80211_RRF_DFS
)

3739 
	`s˙¥ötf
(
ˇc_time
, (cac_time), "%u s",

3740 
ªg_ruÀ
->
dfs_ˇc_ms
/1000);

3742 
	`s˙¥ötf
(
ˇc_time
, (cac_time), "N/A");

3749 i‡(
powî_ruÀ
->
max_™ã¬a_gaö
)

3750 
	`¥_debug
(" (%d KHz - %d KHz @ %s), (%d mBi, %d mBm), (%s)\n",

3751 
‰eq_ønge
->
°¨t_‰eq_khz
,

3752 
‰eq_ønge
->
íd_‰eq_khz
,

3753 
bw
,

3754 
powî_ruÀ
->
max_™ã¬a_gaö
,

3755 
powî_ruÀ
->
max_eúp
,

3756 
ˇc_time
);

3758 
	`¥_debug
(" (%d KHz - %d KHz @ %s), (N/A, %d mBm), (%s)\n",

3759 
‰eq_ønge
->
°¨t_‰eq_khz
,

3760 
‰eq_ønge
->
íd_‰eq_khz
,

3761 
bw
,

3762 
powî_ruÀ
->
max_eúp
,

3763 
ˇc_time
);

3765 
	}
}

3767 
boﬁ
 
	$ªg_suµ‹ãd_dfs_ªgi⁄
(
∆80211_dfs_ªgi⁄s
 
dfs_ªgi⁄
)

3769 
dfs_ªgi⁄
) {

3770 
NL80211_DFS_UNSET
:

3771 
NL80211_DFS_FCC
:

3772 
NL80211_DFS_ETSI
:

3773 
NL80211_DFS_JP
:

3774  
åue
;

3776 
	`¥_debug
("Ign‹ög unknow¿DFS ma°îÑegi⁄: %d\n", 
dfs_ªgi⁄
);

3777  
Ál£
;

3779 
	}
}

3781 
	$¥öt_ªgdomaö
(c⁄° 
õì80211_ªgdomaö
 *
rd
)

3783 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

3785 i‡(
	`is_öãr£˘ed_Æpha2
(
rd
->
Æpha2
)) {

3786 i‡(
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_COUNTRY_IE
) {

3787 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3788 
rdev
 = 
	`cfg80211_rdev_by_wùhy_idx
(
Ã
->
wùhy_idx
);

3789 i‡(
rdev
) {

3790 
	`¥_debug
("CurrentÑegulatory domain updated by APÅo: %c%c\n",

3791 
rdev
->
cou¡ry_õ_Æpha2
[0],

3792 
rdev
->
cou¡ry_õ_Æpha2
[1]);

3794 
	`¥_debug
("CurrentÑegulatory domain intersected:\n");

3796 
	`¥_debug
("CurrentÑegulatory domain intersected:\n");

3797 } i‡(
	`is_w‹ld_ªgdom
(
rd
->
Æpha2
)) {

3798 
	`¥_debug
("WorldÑegulatory domain updated:\n");

3800 i‡(
	`is_unknown_Æpha2
(
rd
->
Æpha2
))

3801 
	`¥_debug
("Regulatory domain changedÅo driver built-in settings (unknown country)\n");

3803 i‡(
	`ªg_ªque°_˚Œ_ba£
(
Ã
))

3804 
	`¥_debug
("Regulatory domain changedÅo country: %c%c by Cell Station\n",

3805 
rd
->
Æpha2
[0],Ñd->alpha2[1]);

3807 
	`¥_debug
("Regulatory domain changedÅo country: %c%c\n",

3808 
rd
->
Æpha2
[0],Ñd->alpha2[1]);

3812 
	`¥_debug
(" DFS Ma°îÑegi⁄: %s", 
	`ªg_dfs_ªgi⁄_°r
(
rd
->
dfs_ªgi⁄
));

3813 
	`¥öt_rd_ruÀs
(
rd
);

3814 
	}
}

3816 
	$¥öt_ªgdomaö_öfo
(c⁄° 
õì80211_ªgdomaö
 *
rd
)

3818 
	`¥_debug
("Reguœt‹y domaö: %c%c\n", 
rd
->
Æpha2
[0],Ñd->alpha2[1]);

3819 
	`¥öt_rd_ruÀs
(
rd
);

3820 
	}
}

3822 
	$ªg_£t_rd_c‹e
(c⁄° 
õì80211_ªgdomaö
 *
rd
)

3824 i‡(!
	`is_w‹ld_ªgdom
(
rd
->
Æpha2
))

3825  -
EINVAL
;

3826 
	`upd©e_w‹ld_ªgdomaö
(
rd
);

3828 
	}
}

3830 
	$ªg_£t_rd_u£r
(c⁄° 
õì80211_ªgdomaö
 *
rd
,

3831 
ªguœt‹y_ªque°
 *
u£r_ªque°
)

3833 c⁄° 
õì80211_ªgdomaö
 *
öãr£˘ed_rd
 = 
NULL
;

3835 i‡(!
	`ªgdom_ch™ges
(
rd
->
Æpha2
))

3836  -
EALREADY
;

3838 i‡(!
	`is_vÆid_rd
(
rd
)) {

3839 
	`¥_îr
("InvalidÑegulatory domain detected: %c%c\n",

3840 
rd
->
Æpha2
[0],Ñd->alpha2[1]);

3841 
	`¥öt_ªgdomaö_öfo
(
rd
);

3842  -
EINVAL
;

3845 i‡(!
u£r_ªque°
->
öãr£˘
) {

3846 
	`ª£t_ªgdomaös
(
Ál£
, 
rd
);

3850 
öãr£˘ed_rd
 = 
	`ªgdom_öãr£˘
(
rd
, 
	`gë_cfg80211_ªgdom
());

3851 i‡(!
öãr£˘ed_rd
)

3852  -
EINVAL
;

3854 
	`k‰ì
(
rd
);

3855 
rd
 = 
NULL
;

3856 
	`ª£t_ªgdomaös
(
Ál£
, 
öãr£˘ed_rd
);

3859 
	}
}

3861 
	$ªg_£t_rd_drivî
(c⁄° 
õì80211_ªgdomaö
 *
rd
,

3862 
ªguœt‹y_ªque°
 *
drivî_ªque°
)

3864 c⁄° 
õì80211_ªgdomaö
 *
ªgd
;

3865 c⁄° 
õì80211_ªgdomaö
 *
öãr£˘ed_rd
 = 
NULL
;

3866 c⁄° 
õì80211_ªgdomaö
 *
tmp
 = 
NULL
;

3867 
wùhy
 *
ªque°_wùhy
;

3869 i‡(
	`is_w‹ld_ªgdom
(
rd
->
Æpha2
))

3870  -
EINVAL
;

3872 i‡(!
	`ªgdom_ch™ges
(
rd
->
Æpha2
))

3873  -
EALREADY
;

3875 i‡(!
	`is_vÆid_rd
(
rd
)) {

3876 
	`¥_îr
("InvalidÑegulatory domain detected: %c%c\n",

3877 
rd
->
Æpha2
[0],Ñd->alpha2[1]);

3878 
	`¥öt_ªgdomaö_öfo
(
rd
);

3879  -
EINVAL
;

3882 
ªque°_wùhy
 = 
	`wùhy_idx_to_wùhy
(
drivî_ªque°
->
wùhy_idx
);

3883 i‡(!
ªque°_wùhy
)

3884  -
ENODEV
;

3886 i‡(!
drivî_ªque°
->
öãr£˘
) {

3887 
	`ASSERT_RTNL
();

3888 
	`wùhy_lock
(
ªque°_wùhy
);

3889 i‡(
ªque°_wùhy
->
ªgd
)

3890 
tmp
 = 
	`gë_wùhy_ªgdom
(
ªque°_wùhy
);

3892 
ªgd
 = 
	`ªg_c›y_ªgd
(
rd
);

3893 i‡(
	`IS_ERR
(
ªgd
)) {

3894 
	`wùhy_u∆ock
(
ªque°_wùhy
);

3895  
	`PTR_ERR
(
ªgd
);

3898 
	`rcu_assign_poöãr
(
ªque°_wùhy
->
ªgd
,Ñegd);

3899 
	`rcu_‰ì_ªgdom
(
tmp
);

3900 
	`wùhy_u∆ock
(
ªque°_wùhy
);

3901 
	`ª£t_ªgdomaös
(
Ál£
, 
rd
);

3905 
öãr£˘ed_rd
 = 
	`ªgdom_öãr£˘
(
rd
, 
	`gë_cfg80211_ªgdom
());

3906 i‡(!
öãr£˘ed_rd
)

3907  -
EINVAL
;

3914 
tmp
 = 
	`gë_wùhy_ªgdom
(
ªque°_wùhy
);

3915 
	`rcu_assign_poöãr
(
ªque°_wùhy
->
ªgd
, 
rd
);

3916 
	`rcu_‰ì_ªgdom
(
tmp
);

3918 
rd
 = 
NULL
;

3920 
	`ª£t_ªgdomaös
(
Ál£
, 
öãr£˘ed_rd
);

3923 
	}
}

3925 
	$ªg_£t_rd_cou¡ry_õ
(c⁄° 
õì80211_ªgdomaö
 *
rd
,

3926 
ªguœt‹y_ªque°
 *
cou¡ry_õ_ªque°
)

3928 
wùhy
 *
ªque°_wùhy
;

3930 i‡(!
	`is_Æpha2_£t
(
rd
->
Æpha2
Ë&& !
	`is_™_Æpha2
(rd->alpha2) &&

3931 !
	`is_unknown_Æpha2
(
rd
->
Æpha2
))

3932  -
EINVAL
;

3940 i‡(!
	`is_vÆid_rd
(
rd
)) {

3941 
	`¥_îr
("InvalidÑegulatory domain detected: %c%c\n",

3942 
rd
->
Æpha2
[0],Ñd->alpha2[1]);

3943 
	`¥öt_ªgdomaö_öfo
(
rd
);

3944  -
EINVAL
;

3947 
ªque°_wùhy
 = 
	`wùhy_idx_to_wùhy
(
cou¡ry_õ_ªque°
->
wùhy_idx
);

3948 i‡(!
ªque°_wùhy
)

3949  -
ENODEV
;

3951 i‡(
cou¡ry_õ_ªque°
->
öãr£˘
)

3952  -
EINVAL
;

3954 
	`ª£t_ªgdomaös
(
Ál£
, 
rd
);

3956 
	}
}

3963 
	$£t_ªgdom
(c⁄° 
õì80211_ªgdomaö
 *
rd
,

3964 
õì80211_ªgd_sour˚
 
ªgd_§c
)

3966 
ªguœt‹y_ªque°
 *
Ã
;

3967 
boﬁ
 
u£r_ª£t
 = 
Ál£
;

3968 
r
;

3970 i‡(
	`IS_ERR_OR_NULL
(
rd
))

3971  -
ENODATA
;

3973 i‡(!
	`ªg_is_vÆid_ªque°
(
rd
->
Æpha2
)) {

3974 
	`k‰ì
(
rd
);

3975  -
EINVAL
;

3978 i‡(
ªgd_§c
 =
REGD_SOURCE_CRDA
)

3979 
	`ª£t_¸da_timeouts
();

3981 
Ã
 = 
	`gë_œ°_ªque°
();

3984 
Ã
->
öôüt‹
) {

3985 
NL80211_REGDOM_SET_BY_CORE
:

3986 
r
 = 
	`ªg_£t_rd_c‹e
(
rd
);

3988 
NL80211_REGDOM_SET_BY_USER
:

3989 
	`cfg80211_ßve_u£r_ªgdom
(
rd
);

3990 
r
 = 
	`ªg_£t_rd_u£r
(
rd
, 
Ã
);

3991 
u£r_ª£t
 = 
åue
;

3993 
NL80211_REGDOM_SET_BY_DRIVER
:

3994 
r
 = 
	`ªg_£t_rd_drivî
(
rd
, 
Ã
);

3996 
NL80211_REGDOM_SET_BY_COUNTRY_IE
:

3997 
r
 = 
	`ªg_£t_rd_cou¡ry_õ
(
rd
, 
Ã
);

4000 
	`WARN
(1, "övÆid inôüt‹ %d\n", 
Ã
->
öôüt‹
);

4001 
	`k‰ì
(
rd
);

4002  -
EINVAL
;

4005 i‡(
r
) {

4006 
r
) {

4007 -
EALREADY
:

4008 
	`ªg_£t_ªque°_¥o˚s£d
();

4012 
	`ª°‹e_ªguœt‹y_£âögs
(
u£r_ª£t
, 
Ál£
);

4015 
	`k‰ì
(
rd
);

4016  
r
;

4020 i‡(
	`WARN_ON
(!
Ã
->
öãr£˘
 && 
rd
 !
	`gë_cfg80211_ªgdom
()))

4021  -
EINVAL
;

4024 
	`upd©e_Æl_wùhy_ªguœt‹y
(
Ã
->
öôüt‹
);

4026 
	`¥öt_ªgdomaö
(
	`gë_cfg80211_ªgdom
());

4028 
	`∆80211_£nd_ªg_ch™ge_evít
(
Ã
);

4030 
	`ªg_£t_ªque°_¥o˚s£d
();

4033 
	}
}

4035 
	$__ªguœt‹y_£t_wùhy_ªgd
(
wùhy
 *wiphy,

4036 
õì80211_ªgdomaö
 *
rd
)

4038 c⁄° 
õì80211_ªgdomaö
 *
ªgd
;

4039 c⁄° 
õì80211_ªgdomaö
 *
¥ev_ªgd
;

4040 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

4042 i‡(
	`WARN_ON
(!
wùhy
 || !
rd
))

4043  -
EINVAL
;

4045 i‡(
	`WARN
(!(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
),

4047  -
EPERM
;

4049 i‡(
	`WARN
(!
	`is_vÆid_rd
(
rd
),

4051 
rd
->
Æpha2
[0],Ñd->alpha2[1])) {

4052 
	`¥öt_ªgdomaö_öfo
(
rd
);

4053  -
EINVAL
;

4056 
ªgd
 = 
	`ªg_c›y_ªgd
(
rd
);

4057 i‡(
	`IS_ERR
(
ªgd
))

4058  
	`PTR_ERR
(
ªgd
);

4060 
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

4062 
	`•ö_lock
(&
ªg_ªque°s_lock
);

4063 
¥ev_ªgd
 = 
rdev
->
ªque°ed_ªgd
;

4064 
rdev
->
ªque°ed_ªgd
 = 
ªgd
;

4065 
	`•ö_u∆ock
(&
ªg_ªque°s_lock
);

4067 
	`k‰ì
(
¥ev_ªgd
);

4069 
	}
}

4071 
	$ªguœt‹y_£t_wùhy_ªgd
(
wùhy
 *wiphy,

4072 
õì80211_ªgdomaö
 *
rd
)

4074 
ªt
 = 
	`__ªguœt‹y_£t_wùhy_ªgd
(
wùhy
, 
rd
);

4076 i‡(
ªt
)

4077  
ªt
;

4079 
	`scheduÀ_w‹k
(&
ªg_w‹k
);

4081 
	}
}

4082 
EXPORT_SYMBOL
(
ªguœt‹y_£t_wùhy_ªgd
);

4084 
	$ªguœt‹y_£t_wùhy_ªgd_sync
(
wùhy
 *wiphy,

4085 
õì80211_ªgdomaö
 *
rd
)

4087 
ªt
;

4089 
	`ASSERT_RTNL
();

4091 
ªt
 = 
	`__ªguœt‹y_£t_wùhy_ªgd
(
wùhy
, 
rd
);

4092 i‡(
ªt
)

4093  
ªt
;

4096 
	`ªg_¥o˚ss_£lf_m™aged_höt
(
wùhy
);

4097 
	`ªg_check_ch™√ls
();

4099 
	}
}

4100 
EXPORT_SYMBOL
(
ªguœt‹y_£t_wùhy_ªgd_sync
);

4102 
	$wùhy_ªguœt‹y_ªgi°î
(
wùhy
 *wiphy)

4104 
ªguœt‹y_ªque°
 *
Ã
 = 
	`gë_œ°_ªque°
();

4107 i‡(
wùhy
->
ªguœt‹y_Êags
 & 
REGULATORY_WIPHY_SELF_MANAGED
) {

4108 
wùhy
->
ªguœt‹y_Êags
 |
REGULATORY_DISABLE_BEACON_HINTS
 |

4109 
REGULATORY_COUNTRY_IE_IGNORE
;

4116 i‡(
Ã
->
öôüt‹
 =
NL80211_REGDOM_SET_BY_USER
)

4117 
	`ªg_ˇŒ_nŸifõr
(
wùhy
, 
Ã
);

4120 i‡(!
	`ªg_dev_ign‹e_˚Œ_höt
(
wùhy
))

4121 
ªg_num_devs_suµ‹t_ba£höt
++;

4123 
	`wùhy_upd©e_ªguœt‹y
(
wùhy
, 
Ã
->
öôüt‹
);

4124 
	`wùhy_Æl_sh¨e_dfs_ch™_°©e
(
wùhy
);

4125 
	`ªg_¥o˚ss_£lf_m™aged_höts
();

4126 
	}
}

4128 
	$wùhy_ªguœt‹y_dîegi°î
(
wùhy
 *wiphy)

4130 
wùhy
 *
ªque°_wùhy
 = 
NULL
;

4131 
ªguœt‹y_ªque°
 *
Ã
;

4133 
Ã
 = 
	`gë_œ°_ªque°
();

4135 i‡(!
	`ªg_dev_ign‹e_˚Œ_höt
(
wùhy
))

4136 
ªg_num_devs_suµ‹t_ba£höt
--;

4138 
	`rcu_‰ì_ªgdom
(
	`gë_wùhy_ªgdom
(
wùhy
));

4139 
	`RCU_INIT_POINTER
(
wùhy
->
ªgd
, 
NULL
);

4141 i‡(
Ã
)

4142 
ªque°_wùhy
 = 
	`wùhy_idx_to_wùhy
(
Ã
->
wùhy_idx
);

4144 i‡(!
ªque°_wùhy
 ||Ñeque°_wùhy !
wùhy
)

4147 
Ã
->
wùhy_idx
 = 
WIPHY_IDX_INVALID
;

4148 
Ã
->
cou¡ry_õ_ív
 = 
ENVIRON_ANY
;

4149 
	}
}

4156 
	$cfg80211_gë_unii
(
‰eq
)

4159 i‡(
‰eq
 >= 5150 && freq <= 5250)

4163 i‡(
‰eq
 > 5250 && freq <= 5350)

4167 i‡(
‰eq
 > 5350 && freq <= 5470)

4171 i‡(
‰eq
 > 5470 && freq <= 5725)

4175 i‡(
‰eq
 > 5725 && freq <= 5825)

4179 i‡(
‰eq
 > 5925 && freq <= 6425)

4183 i‡(
‰eq
 > 6425 && freq <= 6525)

4187 i‡(
‰eq
 > 6525 && freq <= 6875)

4191 i‡(
‰eq
 > 6875 && freq <= 7125)

4194  -
EINVAL
;

4195 
	}
}

4197 
boﬁ
 
	$ªguœt‹y_ödo‹_Ælowed
()

4199  
ªg_is_ödo‹
;

4200 
	}
}

4202 
boﬁ
 
	$ªguœt‹y_¥e_ˇc_Ælowed
(
wùhy
 *wiphy)

4204 c⁄° 
õì80211_ªgdomaö
 *
ªgd
 = 
NULL
;

4205 c⁄° 
õì80211_ªgdomaö
 *
wùhy_ªgd
 = 
NULL
;

4206 
boﬁ
 
¥e_ˇc_Ælowed
 = 
Ál£
;

4208 
	`rcu_ªad_lock
();

4210 
ªgd
 = 
	`rcu_dîe„ªn˚
(
cfg80211_ªgdomaö
);

4211 
wùhy_ªgd
 = 
	`rcu_dîe„ªn˚
(
wùhy
->
ªgd
);

4212 i‡(!
wùhy_ªgd
) {

4213 i‡(
ªgd
->
dfs_ªgi⁄
 =
NL80211_DFS_ETSI
)

4214 
¥e_ˇc_Ælowed
 = 
åue
;

4216 
	`rcu_ªad_u∆ock
();

4218  
¥e_ˇc_Ælowed
;

4221 i‡(
ªgd
->
dfs_ªgi⁄
 =
wùhy_ªgd
->dfs_region &&

4222 
wùhy_ªgd
->
dfs_ªgi⁄
 =
NL80211_DFS_ETSI
)

4223 
¥e_ˇc_Ælowed
 = 
åue
;

4225 
	`rcu_ªad_u∆ock
();

4227  
¥e_ˇc_Ælowed
;

4228 
	}
}

4229 
EXPORT_SYMBOL
(
ªguœt‹y_¥e_ˇc_Ælowed
);

4231 
	$cfg80211_check_™d_íd_ˇc
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

4233 
wúñess_dev
 *
wdev
;

4243 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

4244 
cfg80211_ch™_def
 *
ch™def
;

4246 i‡(!
wdev
->
ˇc_°¨ãd
)

4250 
ch™def
 = 
	`wdev_ch™def
(
wdev
, 0);

4251 i‡(!
ch™def
)

4254 i‡(!
	`cfg80211_ch™def_dfs_ußbÀ
(&
rdev
->
wùhy
, 
ch™def
))

4255 
	`rdev_íd_ˇc
(
rdev
, 
wdev
->
√tdev
);

4257 
	}
}

4259 
	$ªguœt‹y_¥›ag©e_dfs_°©e
(
wùhy
 *wiphy,

4260 
cfg80211_ch™_def
 *
ch™def
,

4261 
∆80211_dfs_°©e
 
dfs_°©e
,

4262 
∆80211_ød¨_evít
 
evít
)

4264 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

4266 
	`ASSERT_RTNL
();

4268 i‡(
	`WARN_ON
(!
	`cfg80211_ch™def_vÆid
(
ch™def
)))

4271 
	`f‹_óch_rdev
(
rdev
) {

4272 i‡(
wùhy
 =&
rdev
->wiphy)

4275 i‡(!
	`ªg_dfs_domaö_ßme
(
wùhy
, &
rdev
->wiphy))

4278 i‡(!
	`õì80211_gë_ch™√l
(&
rdev
->
wùhy
,

4279 
ch™def
->
ch™
->
˚¡î_‰eq
))

4282 
	`cfg80211_£t_dfs_°©e
(&
rdev
->
wùhy
, 
ch™def
, 
dfs_°©e
);

4284 i‡(
evít
 =
NL80211_RADAR_DETECTED
 ||

4285 
evít
 =
NL80211_RADAR_CAC_FINISHED
) {

4286 
	`cfg80211_sched_dfs_ch™_upd©e
(
rdev
);

4287 
	`cfg80211_check_™d_íd_ˇc
(
rdev
);

4290 
	`∆80211_ød¨_nŸify
(
rdev
, 
ch™def
, 
evít
, 
NULL
, 
GFP_KERNEL
);

4292 
	}
}

4294 
__öô
 
	$ªguœt‹y_öô_db
()

4296 
îr
;

4304 i‡(
	`IS_ERR_OR_NULL
(
ªg_pdev
))

4305  -
EINVAL
;

4307 
îr
 = 
	`lﬂd_buûtö_ªgdb_keys
();

4308 i‡(
îr
) {

4309 
	`∂©f‹m_devi˚_uƒegi°î
(
ªg_pdev
);

4310  
îr
;

4314 
îr
 = 
	`ªguœt‹y_höt_c‹e
(
cfg80211_w‹ld_ªgdom
->
Æpha2
);

4315 i‡(
îr
) {

4316 i‡(
îr
 =-
ENOMEM
) {

4317 
	`∂©f‹m_devi˚_uƒegi°î
(
ªg_pdev
);

4318  
îr
;

4327 
	`¥_îr
("kobject_uevent_env() was unableÅo call CRDA during init\n");

4334 i‡(!
	`is_w‹ld_ªgdom
(
õì80211_ªgdom
))

4335 
	`ªguœt‹y_höt_u£r
(
õì80211_ªgdom
,

4336 
NL80211_USER_REG_HINT_USER
);

4339 
	}
}

4340 #i‚de‡
MODULE


4341 
œã_öôˇŒ
(
ªguœt‹y_öô_db
);

4344 
__öô
 
	$ªguœt‹y_öô
()

4346 
ªg_pdev
 = 
	`∂©f‹m_devi˚_ªgi°î_sim∂e
("ªguœt‹y", 0, 
NULL
, 0);

4347 i‡(
	`IS_ERR
(
ªg_pdev
))

4348  
	`PTR_ERR
(
ªg_pdev
);

4350 
	`rcu_assign_poöãr
(
cfg80211_ªgdomaö
, 
cfg80211_w‹ld_ªgdom
);

4352 
u£r_Æpha2
[0] = '9';

4353 
u£r_Æpha2
[1] = '7';

4355 #ifde‡
MODULE


4356  
	`ªguœt‹y_öô_db
();

4360 
	}
}

4362 
	$ªguœt‹y_exô
()

4364 
ªguœt‹y_ªque°
 *
ªg_ªque°
, *
tmp
;

4365 
ªg_bóc⁄
 *ªg_bóc⁄, *
btmp
;

4367 
	`ˇn˚l_w‹k_sync
(&
ªg_w‹k
);

4368 
	`ˇn˚l_¸da_timeout_sync
();

4369 
	`ˇn˚l_dñayed_w‹k_sync
(&
ªg_check_ch™s
);

4372 
	`π∆_lock
();

4373 
	`ª£t_ªgdomaös
(
åue
, 
NULL
);

4374 
	`π∆_u∆ock
();

4376 
	`dev_£t_uevít_suµªss
(&
ªg_pdev
->
dev
, 
åue
);

4378 
	`∂©f‹m_devi˚_uƒegi°î
(
ªg_pdev
);

4380 
	`li°_f‹_óch_íåy_ß„
(
ªg_bóc⁄
, 
btmp
, &
ªg_≥ndög_bóc⁄s
, 
li°
) {

4381 
	`li°_dñ
(&
ªg_bóc⁄
->
li°
);

4382 
	`k‰ì
(
ªg_bóc⁄
);

4385 
	`li°_f‹_óch_íåy_ß„
(
ªg_bóc⁄
, 
btmp
, &
ªg_bóc⁄_li°
, 
li°
) {

4386 
	`li°_dñ
(&
ªg_bóc⁄
->
li°
);

4387 
	`k‰ì
(
ªg_bóc⁄
);

4390 
	`li°_f‹_óch_íåy_ß„
(
ªg_ªque°
, 
tmp
, &
ªg_ªque°s_li°
, 
li°
) {

4391 
	`li°_dñ
(&
ªg_ªque°
->
li°
);

4392 
	`k‰ì
(
ªg_ªque°
);

4395 i‡(!
	`IS_ERR_OR_NULL
(
ªgdb
))

4396 
	`k‰ì
(
ªgdb
);

4397 i‡(!
	`IS_ERR_OR_NULL
(
cfg80211_u£r_ªgdom
))

4398 
	`k‰ì
(
cfg80211_u£r_ªgdom
);

4400 
	`‰ì_ªgdb_keyrög
();

4401 
	}
}

	@reg.h

1 #i‚de‡
__NET_WIRELESS_REG_H


2 
	#__NET_WIRELESS_REG_H


	)

4 
	~<√t/cfg80211.h
>

23 
	eõì80211_ªgd_sour˚
 {

24 
	mREGD_SOURCE_INTERNAL_DB
,

25 
	mREGD_SOURCE_CRDA
,

26 
	mREGD_SOURCE_CACHED
,

29 c⁄° 
õì80211_ªgdomaö
 
__rcu
 *
cfg80211_ªgdomaö
;

31 
boﬁ
 
ªg_is_vÆid_ªque°
(c⁄° *
Æpha2
);

32 
boﬁ
 
is_w‹ld_ªgdom
(c⁄° *
Æpha2
);

33 
boﬁ
 
ªg_suµ‹ãd_dfs_ªgi⁄
(
∆80211_dfs_ªgi⁄s
 
dfs_ªgi⁄
);

34 
∆80211_dfs_ªgi⁄s
 
ªg_gë_dfs_ªgi⁄
(
wùhy
 *wiphy);

36 
ªguœt‹y_höt_u£r
(c⁄° *
Æpha2
,

37 
∆80211_u£r_ªg_höt_ty≥
 
u£r_ªg_höt_ty≥
);

45 
ªguœt‹y_höt_ödo‹
(
boﬁ
 
is_ödo‹
, 
u32
 
p‹tid
);

51 
ªguœt‹y_√éök_nŸify
(
u32
 
p‹tid
);

53 
wùhy_ªguœt‹y_ªgi°î
(
wùhy
 *wiphy);

54 
wùhy_ªguœt‹y_dîegi°î
(
wùhy
 *wiphy);

56 
__öô
 
ªguœt‹y_öô
();

57 
ªguœt‹y_exô
();

59 
£t_ªgdom
(c⁄° 
õì80211_ªgdomaö
 *
rd
,

60 
õì80211_ªgd_sour˚
 
ªgd_§c
);

62 
ªg_gë_max_b™dwidth
(c⁄° 
õì80211_ªgdomaö
 *
rd
,

63 c⁄° 
õì80211_ªg_ruÀ
 *
ruÀ
);

65 
boﬁ
 
ªg_œ°_ªque°_˚Œ_ba£
();

85 
ªguœt‹y_höt_found_bóc⁄
(
wùhy
 *wiphy,

86 
õì80211_ch™√l
 *
bóc⁄_ch™
,

87 
gÂ_t
 
gÂ
);

110 
ªguœt‹y_höt_cou¡ry_õ
(
wùhy
 *wiphy,

111 
∆80211_b™d
 
b™d
,

112 c⁄° 
u8
 *
cou¡ry_õ
,

113 
u8
 
cou¡ry_õ_Àn
);

131 
ªguœt‹y_höt_disc⁄√˘
();

143 
cfg80211_gë_unii
(
‰eq
);

148 
boﬁ
 
ªguœt‹y_ödo‹_Ælowed
();

155 
	#REG_PRE_CAC_EXPIRY_GRACE_MS
 2000

	)

167 
ªguœt‹y_¥›ag©e_dfs_°©e
(
wùhy
 *wiphy,

168 
cfg80211_ch™_def
 *
ch™def
,

169 
∆80211_dfs_°©e
 
dfs_°©e
,

170 
∆80211_ød¨_evít
 
evít
);

177 
boﬁ
 
ªg_dfs_domaö_ßme
(
wùhy
 *
wùhy1
, wùhy *
wùhy2
);

182 
ªg_ªlﬂd_ªgdb
();

187 
ªg_check_ch™√ls
();

189 c⁄° 
u8
 
shù≥d_ªgdb_˚πs
[];

190 
shù≥d_ªgdb_˚πs_Àn
;

191 c⁄° 
u8
 
exåa_ªgdb_˚πs
[];

192 
exåa_ªgdb_˚πs_Àn
;

	@scan.c

10 
	~<löux/kî√l.h
>

11 
	~<löux/¶ab.h
>

12 
	~<löux/moduÀ.h
>

13 
	~<löux/√tdevi˚.h
>

14 
	~<löux/wúñess.h
>

15 
	~<löux/∆80211.h
>

16 
	~<löux/ëhîdevi˚.h
>

17 
	~<löux/¸c32.h
>

18 
	~<löux/bôfõld.h
>

19 
	~<√t/¨p.h
>

20 
	~<√t/cfg80211.h
>

21 
	~<√t/cfg80211-wext.h
>

22 
	~<√t/iw_h™dÀr.h
>

23 
	~<kunô/visibûôy.h
>

24 
	~"c‹e.h
"

25 
	~"∆80211.h
"

26 
	~"wext-com∑t.h
"

27 
	~"rdev-›s.h
"

73 
	gbss_íåõs_limô
 = 1000;

74 
moduÀ_∑øm
(
bss_íåõs_limô
, , 0644);

75 
MODULE_PARM_DESC
(
bss_íåõs_limô
,

78 
	#IEEE80211_SCAN_RESULT_EXPIRE
 (30 * 
HZ
)

	)

80 
	$bss_‰ì
(
cfg80211_öã∫Æ_bss
 *
bss
)

82 
cfg80211_bss_õs
 *
õs
;

84 i‡(
	`WARN_ON
(
	`©omic_ªad
(&
bss
->
hﬁd
)))

87 
õs
 = (*)
	`rcu_ac˚ss_poöãr
(
bss
->
pub
.
bóc⁄_õs
);

88 i‡(
õs
 && !
bss
->
pub
.
hiddí_bóc⁄_bss
)

89 
	`k‰ì_rcu
(
õs
, 
rcu_hód
);

90 
õs
 = (*)
	`rcu_ac˚ss_poöãr
(
bss
->
pub
.
¥obîe•_õs
);

91 i‡(
õs
)

92 
	`k‰ì_rcu
(
õs
, 
rcu_hód
);

98 i‡(!
	`li°_em±y
(&
bss
->
hiddí_li°
))

99 
	`li°_dñ
(&
bss
->
hiddí_li°
);

101 
	`k‰ì
(
bss
);

102 
	}
}

104 
ölöe
 
	$bss_ªf_gë
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

105 
cfg80211_öã∫Æ_bss
 *
bss
)

107 
	`lockdï_as£π_hñd
(&
rdev
->
bss_lock
);

109 
bss
->
ªfcou¡
++;

111 i‡(
bss
->
pub
.
hiddí_bóc⁄_bss
)

112 
	`bss_‰om_pub
(
bss
->
pub
.
hiddí_bóc⁄_bss
)->
ªfcou¡
++;

114 i‡(
bss
->
pub
.
å™smôãd_bss
)

115 
	`bss_‰om_pub
(
bss
->
pub
.
å™smôãd_bss
)->
ªfcou¡
++;

116 
	}
}

118 
ölöe
 
	$bss_ªf_put
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

119 
cfg80211_öã∫Æ_bss
 *
bss
)

121 
	`lockdï_as£π_hñd
(&
rdev
->
bss_lock
);

123 i‡(
bss
->
pub
.
hiddí_bóc⁄_bss
) {

124 
cfg80211_öã∫Æ_bss
 *
hbss
;

126 
hbss
 = 
	`bss_‰om_pub
(
bss
->
pub
.
hiddí_bóc⁄_bss
);

127 
hbss
->
ªfcou¡
--;

128 i‡(
hbss
->
ªfcou¡
 == 0)

129 
	`bss_‰ì
(
hbss
);

132 i‡(
bss
->
pub
.
å™smôãd_bss
) {

133 
cfg80211_öã∫Æ_bss
 *
tbss
;

135 
tbss
 = 
	`bss_‰om_pub
(
bss
->
pub
.
å™smôãd_bss
);

136 
tbss
->
ªfcou¡
--;

137 i‡(
tbss
->
ªfcou¡
 == 0)

138 
	`bss_‰ì
(
tbss
);

141 
bss
->
ªfcou¡
--;

142 i‡(
bss
->
ªfcou¡
 == 0)

143 
	`bss_‰ì
(
bss
);

144 
	}
}

146 
boﬁ
 
	$__cfg80211_u∆ök_bss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

147 
cfg80211_öã∫Æ_bss
 *
bss
)

149 
	`lockdï_as£π_hñd
(&
rdev
->
bss_lock
);

151 i‡(!
	`li°_em±y
(&
bss
->
hiddí_li°
)) {

156 i‡(!
bss
->
pub
.
hiddí_bóc⁄_bss
)

157  
Ál£
;

162 
	`li°_dñ_öô
(&
bss
->
hiddí_li°
);

165 
	`li°_dñ_öô
(&
bss
->
li°
);

166 
	`li°_dñ_öô
(&
bss
->
pub
.
n⁄å™s_li°
);

167 
	`rb_îa£
(&
bss
->
rbn
, &
rdev
->
bss_åì
);

168 
rdev
->
bss_íåõs
--;

169 
	`WARN_ONCE
((
rdev
->
bss_íåõs
 =0Ë^ 
	`li°_em±y
(&rdev->
bss_li°
),

171 
rdev
->
bss_íåõs
, 
	`li°_em±y
(&rdev->
bss_li°
));

172 
	`bss_ªf_put
(
rdev
, 
bss
);

173  
åue
;

174 
	}
}

176 
boﬁ
 
	$cfg80211_is_ñemít_öhîôed
(c⁄° 
ñemít
 *
ñem
,

177 c⁄° 
ñemít
 *
n⁄_öhîô_ñem
)

179 
u8
 
id_Àn
, 
ext_id_Àn
, 
i
, 
lo›_Àn
, 
id
;

180 c⁄° 
u8
 *
li°
;

182 i‡(
ñem
->
id
 =
WLAN_EID_MULTIPLE_BSSID
)

183  
Ál£
;

185 i‡(
ñem
->
id
 =
WLAN_EID_EXTENSION
 &&ÉÀm->
d©Æí
 > 1 &&

186 
ñem
->
d©a
[0] =
WLAN_EID_EXT_EHT_MULTI_LINK
)

187  
Ál£
;

189 i‡(!
n⁄_öhîô_ñem
 ||Ç⁄_öhîô_ñem->
d©Æí
 < 2)

190  
åue
;

199 
id_Àn
 = 
n⁄_öhîô_ñem
->
d©a
[1];

200 i‡(
n⁄_öhîô_ñem
->
d©Æí
 < 3 + 
id_Àn
)

201  
åue
;

203 
ext_id_Àn
 = 
n⁄_öhîô_ñem
->
d©a
[2 + 
id_Àn
];

204 i‡(
n⁄_öhîô_ñem
->
d©Æí
 < 3 + 
id_Àn
 + 
ext_id_Àn
)

205  
åue
;

207 i‡(
ñem
->
id
 =
WLAN_EID_EXTENSION
) {

208 i‡(!
ext_id_Àn
)

209  
åue
;

210 
lo›_Àn
 = 
ext_id_Àn
;

211 
li°
 = &
n⁄_öhîô_ñem
->
d©a
[3 + 
id_Àn
];

212 
id
 = 
ñem
->
d©a
[0];

214 i‡(!
id_Àn
)

215  
åue
;

216 
lo›_Àn
 = 
id_Àn
;

217 
li°
 = &
n⁄_öhîô_ñem
->
d©a
[2];

218 
id
 = 
ñem
->id;

221 
i
 = 0; i < 
lo›_Àn
; i++) {

222 i‡(
li°
[
i
] =
id
)

223  
Ál£
;

226  
åue
;

227 
	}
}

228 
EXPORT_SYMBOL
(
cfg80211_is_ñemít_öhîôed
);

230 
size_t
 
	$cfg80211_c›y_ñem_wôh_‰ags
(c⁄° 
ñemít
 *
ñem
,

231 c⁄° 
u8
 *
õ
, 
size_t
 
õ_Àn
,

232 
u8
 **
pos
, u8 *
buf
, 
size_t
 
buf_Àn
)

234 i‡(
	`WARN_ON
((
u8
 *)
ñem
 < 
õ
 ||ÉÀm->
d©a
 > iê+ 
õ_Àn
 ||

235 
ñem
->
d©a
 +ÉÀm->
d©Æí
 > 
õ
 + 
õ_Àn
))

238 i‡(
ñem
->
d©Æí
 + 2 > 
buf
 + 
buf_Àn
 - *
pos
)

241 
	`mem˝y
(*
pos
, 
ñem
,ÉÀm->
d©Æí
 + 2);

242 *
pos
 +
ñem
->
d©Æí
 + 2;

245 i‡(
ñem
->
d©Æí
 != 255)

246  *
pos
 - 
buf
;

248 
õ_Àn
 = 
õ
 + ie_À¿- 
ñem
->
d©a
 -ÉÀm->
d©Æí
;

249 
õ
 = (c⁄° 
u8
 *)
ñem
->
d©a
 +ÉÀm->
d©Æí
;

251 
	`f‹_óch_ñemít
(
ñem
, 
õ
, 
õ_Àn
) {

252 i‡(
ñem
->
id
 !
WLAN_EID_FRAGMENT
)

255 i‡(
ñem
->
d©Æí
 + 2 > 
buf
 + 
buf_Àn
 - *
pos
)

258 
	`mem˝y
(*
pos
, 
ñem
,ÉÀm->
d©Æí
 + 2);

259 *
pos
 +
ñem
->
d©Æí
 + 2;

261 i‡(
ñem
->
d©Æí
 != 255)

265  *
pos
 - 
buf
;

266 
	}
}

268 
VISIBLE_IF_CFG80211_KUNIT
 
size_t


269 
	$cfg80211_gí_√w_õ
(c⁄° 
u8
 *
õ
, 
size_t
 
õÀn
,

270 c⁄° 
u8
 *
subõ
, 
size_t
 
subõ_Àn
,

271 
u8
 *
√w_õ
, 
size_t
 
√w_õ_Àn
)

273 c⁄° 
ñemít
 *
n⁄_öhîô_ñem
, *
∑ª¡
, *
sub
;

274 
u8
 *
pos
 = 
√w_õ
;

275 
u8
 
id
, 
ext_id
;

276 
m©ch_Àn
;

278 
n⁄_öhîô_ñem
 = 
	`cfg80211_föd_ext_ñem
(
WLAN_EID_EXT_NON_INHERITANCE
,

279 
subõ
, 
subõ_Àn
);

287 
	`f‹_óch_ñemít
(
∑ª¡
, 
õ
, 
õÀn
) {

288 i‡(
∑ª¡
->
id
 =
WLAN_EID_FRAGMENT
)

291 i‡(
∑ª¡
->
id
 =
WLAN_EID_EXTENSION
) {

292 i‡(
∑ª¡
->
d©Æí
 < 1)

295 
id
 = 
WLAN_EID_EXTENSION
;

296 
ext_id
 = 
∑ª¡
->
d©a
[0];

297 
m©ch_Àn
 = 1;

299 
id
 = 
∑ª¡
->id;

300 
m©ch_Àn
 = 0;

304 
sub
 = 
	`cfg80211_föd_ñem_m©ch
(
id
, 
subõ
, 
subõ_Àn
,

305 &
ext_id
, 
m©ch_Àn
, 0);

308 i‡(!
sub
 &&

309 
	`cfg80211_is_ñemít_öhîôed
(
∑ª¡
, 
n⁄_öhîô_ñem
)) {

310 i‡(!
	`cfg80211_c›y_ñem_wôh_‰ags
(
∑ª¡
,

311 
õ
, 
õÀn
,

312 &
pos
, 
√w_õ
,

313 
√w_õ_Àn
))

320 i‡(
	`cfg80211_föd_ñem_m©ch
(
id
, 
õ
, (
u8
 *)
∑ª¡
 - ie,

321 &
ext_id
, 
m©ch_Àn
, 0))

325 
sub
) {

326 i‡(!
	`cfg80211_c›y_ñem_wôh_‰ags
(
sub
,

327 
subõ
, 
subõ_Àn
,

328 &
pos
, 
√w_õ
,

329 
√w_õ_Àn
))

332 
sub
 = 
	`cfg80211_föd_ñem_m©ch
(
id
,

333 
sub
->
d©a
 + sub->
d©Æí
,

334 
subõ_Àn
 + 
subõ
 -

335 (
sub
->
d©a
 +

336 
sub
->
d©Æí
),

337 &
ext_id
, 
m©ch_Àn
, 0);

345 
	`f‹_óch_ñemít
(
sub
, 
subõ
, 
subõ_Àn
) {

346 i‡(
sub
->
id
 =
WLAN_EID_NON_TX_BSSID_CAP
)

349 i‡(
sub
->
id
 =
WLAN_EID_FRAGMENT
)

352 i‡(
sub
->
id
 =
WLAN_EID_EXTENSION
) {

353 i‡(
sub
->
d©Æí
 < 1)

356 
id
 = 
WLAN_EID_EXTENSION
;

357 
ext_id
 = 
sub
->
d©a
[0];

358 
m©ch_Àn
 = 1;

360 i‡(
ext_id
 =
WLAN_EID_EXT_NON_INHERITANCE
)

363 
id
 = 
sub
->id;

364 
m©ch_Àn
 = 0;

368 i‡(
	`cfg80211_föd_ñem_m©ch
(
id
, 
õ
, 
õÀn
,

369 &
ext_id
, 
m©ch_Àn
, 0))

372 i‡(!
	`cfg80211_c›y_ñem_wôh_‰ags
(
sub
, 
subõ
, 
subõ_Àn
,

373 &
pos
, 
√w_õ
, 
√w_õ_Àn
))

377  
pos
 - 
√w_õ
;

378 
	}
}

379 
EXPORT_SYMBOL_IF_CFG80211_KUNIT
(
cfg80211_gí_√w_õ
);

381 
boﬁ
 
	$is_bss
(
cfg80211_bss
 *
a
, c⁄° 
u8
 *
bssid
,

382 c⁄° 
u8
 *
ssid
, 
size_t
 
ssid_Àn
)

384 c⁄° 
cfg80211_bss_õs
 *
õs
;

385 c⁄° 
ñemít
 *
ssid_ñem
;

387 i‡(
bssid
 && !
	`ëhî_addr_equÆ
(
a
->bssid, bssid))

388  
Ál£
;

390 i‡(!
ssid
)

391  
åue
;

393 
õs
 = 
	`rcu_ac˚ss_poöãr
(
a
->ies);

394 i‡(!
õs
)

395  
Ál£
;

396 
ssid_ñem
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_SSID
, 
õs
->
d©a
, ies->
Àn
);

397 i‡(!
ssid_ñem
)

398  
Ál£
;

399 i‡(
ssid_ñem
->
d©Æí
 !
ssid_Àn
)

400  
Ál£
;

401  
	`memcmp
(
ssid_ñem
->
d©a
, 
ssid
, 
ssid_Àn
) == 0;

402 
	}
}

405 
	$cfg80211_add_n⁄å™s_li°
(
cfg80211_bss
 *
å™s_bss
,

406 
cfg80211_bss
 *
n⁄å™s_bss
)

408 c⁄° 
ñemít
 *
ssid_ñem
;

409 
cfg80211_bss
 *
bss
 = 
NULL
;

411 
	`rcu_ªad_lock
();

412 
ssid_ñem
 = 
	`õì80211_bss_gë_ñem
(
n⁄å™s_bss
, 
WLAN_EID_SSID
);

413 i‡(!
ssid_ñem
) {

414 
	`rcu_ªad_u∆ock
();

415  -
EINVAL
;

419 
	`li°_f‹_óch_íåy
(
bss
, &
å™s_bss
->
n⁄å™s_li°
,Çontrans_list) {

420 i‡(
	`is_bss
(
bss
, 
n⁄å™s_bss
->
bssid
, 
ssid_ñem
->
d©a
,

421 
ssid_ñem
->
d©Æí
)) {

422 
	`rcu_ªad_u∆ock
();

427 
	`rcu_ªad_u∆ock
();

435 i‡(!
	`li°_em±y
(&
n⁄å™s_bss
->
n⁄å™s_li°
))

436  -
EINVAL
;

439 
	`li°_add_èû
(&
n⁄å™s_bss
->
n⁄å™s_li°
, &
å™s_bss
->nontrans_list);

441 
	}
}

443 
	$__cfg80211_bss_expúe
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

444 
expúe_time
)

446 
cfg80211_öã∫Æ_bss
 *
bss
, *
tmp
;

447 
boﬁ
 
expúed
 = 
Ál£
;

449 
	`lockdï_as£π_hñd
(&
rdev
->
bss_lock
);

451 
	`li°_f‹_óch_íåy_ß„
(
bss
, 
tmp
, &
rdev
->
bss_li°
, 
li°
) {

452 i‡(
	`©omic_ªad
(&
bss
->
hﬁd
))

454 i‡(!
	`time_a·î
(
expúe_time
, 
bss
->
ts
))

457 i‡(
	`__cfg80211_u∆ök_bss
(
rdev
, 
bss
))

458 
expúed
 = 
åue
;

461 i‡(
expúed
)

462 
rdev
->
bss_gíî©i⁄
++;

463 
	}
}

465 
boﬁ
 
	$cfg80211_bss_expúe_ﬁde°
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

467 
cfg80211_öã∫Æ_bss
 *
bss
, *
ﬁde°
 = 
NULL
;

468 
boﬁ
 
ªt
;

470 
	`lockdï_as£π_hñd
(&
rdev
->
bss_lock
);

472 
	`li°_f‹_óch_íåy
(
bss
, &
rdev
->
bss_li°
, 
li°
) {

473 i‡(
	`©omic_ªad
(&
bss
->
hﬁd
))

476 i‡(!
	`li°_em±y
(&
bss
->
hiddí_li°
) &&

477 !
bss
->
pub
.
hiddí_bóc⁄_bss
)

480 i‡(
ﬁde°
 && 
	`time_bef‹e
(ﬁde°->
ts
, 
bss
->ts))

482 
ﬁde°
 = 
bss
;

485 i‡(
	`WARN_ON
(!
ﬁde°
))

486  
Ál£
;

494 
ªt
 = 
	`__cfg80211_u∆ök_bss
(
rdev
, 
ﬁde°
);

495 
	`WARN_ON
(!
ªt
);

496  
ªt
;

497 
	}
}

499 
u8
 
	$cfg80211_∑r£_bss_∑øm
(
u8
 
d©a
,

500 
cfg80211_cﬁoˇãd_≠
 *
cﬁoc_≠
)

502 
cﬁoc_≠
->
o˘_ªcommíded
 =

503 
	`u8_gë_bôs
(
d©a
, 
IEEE80211_RNR_TBTT_PARAMS_OCT_RECOMMENDED
);

504 
cﬁoc_≠
->
ßme_ssid
 =

505 
	`u8_gë_bôs
(
d©a
, 
IEEE80211_RNR_TBTT_PARAMS_SAME_SSID
);

506 
cﬁoc_≠
->
mu…i_bss
 =

507 
	`u8_gë_bôs
(
d©a
, 
IEEE80211_RNR_TBTT_PARAMS_MULTI_BSSID
);

508 
cﬁoc_≠
->
å™smôãd_bssid
 =

509 
	`u8_gë_bôs
(
d©a
, 
IEEE80211_RNR_TBTT_PARAMS_TRANSMITTED_BSSID
);

510 
cﬁoc_≠
->
unsﬁicôed_¥obe
 =

511 
	`u8_gë_bôs
(
d©a
, 
IEEE80211_RNR_TBTT_PARAMS_PROBE_ACTIVE
);

512 
cﬁoc_≠
->
cﬁoˇãd_ess
 =

513 
	`u8_gë_bôs
(
d©a
, 
IEEE80211_RNR_TBTT_PARAMS_COLOC_ESS
);

515  
	`u8_gë_bôs
(
d©a
, 
IEEE80211_RNR_TBTT_PARAMS_COLOC_AP
);

516 
	}
}

518 
	$cfg80211_ˇlc_sh‹t_ssid
(c⁄° 
cfg80211_bss_õs
 *
õs
,

519 c⁄° 
ñemít
 **
ñem
, 
u32
 *
s_ssid
)

522 *
ñem
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_SSID
, 
õs
->
d©a
, ies->
Àn
);

523 i‡(!*
ñem
 || (*ñem)->
d©Æí
 > 
IEEE80211_MAX_SSID_LEN
)

524  -
EINVAL
;

526 *
s_ssid
 = ~
	`¸c32_À
(~0, (*
ñem
)->
d©a
, (*ñem)->
d©Æí
);

528 
	}
}

530 
VISIBLE_IF_CFG80211_KUNIT
 

531 
	$cfg80211_‰ì_cﬁoc_≠_li°
(
li°_hód
 *
cﬁoc_≠_li°
)

533 
cfg80211_cﬁoˇãd_≠
 *
≠
, *
tmp_≠
;

535 
	`li°_f‹_óch_íåy_ß„
(
≠
, 
tmp_≠
, 
cﬁoc_≠_li°
, 
li°
) {

536 
	`li°_dñ
(&
≠
->
li°
);

537 
	`k‰ì
(
≠
);

539 
	}
}

540 
EXPORT_SYMBOL_IF_CFG80211_KUNIT
(
cfg80211_‰ì_cﬁoc_≠_li°
);

542 
	$cfg80211_∑r£_≠_öfo
(
cfg80211_cﬁoˇãd_≠
 *
íåy
,

543 c⁄° 
u8
 *
pos
, u8 
Àngth
,

544 c⁄° 
ñemít
 *
ssid_ñem
,

545 
u32
 
s_ssid_tmp
)

547 
u8
 
bss_∑øms
;

549 
íåy
->
psd_20
 = 
IEEE80211_RNR_TBTT_PARAMS_PSD_RESERVED
;

552 i‡(
Àngth
 > (
õì80211_tbâ_öfo_7_8_9
)) {

553 
õì80211_tbâ_öfo_ge_11
 *
tbâ_öfo
 = (*)
pos
;

555 
	`mem˝y
(
íåy
->
bssid
, 
tbâ_öfo
->bssid, 
ETH_ALEN
);

556 
íåy
->
sh‹t_ssid
 = 
	`À32_to_˝u
(
tbâ_öfo
->short_ssid);

557 
íåy
->
sh‹t_ssid_vÆid
 = 
åue
;

559 
bss_∑øms
 = 
tbâ_öfo
->bss_params;

562 i‡(
Àngth
 >
	`off£to„nd
(
	`ty≥of
(*
tbâ_öfo
), 
mld_∑øms
)) {

563 i‡(
	`À16_gë_bôs
(
tbâ_öfo
->
mld_∑øms
.
∑øms
,

564 
IEEE80211_RNR_MLD_PARAMS_DISABLED_LINK
))

565  -
EINVAL
;

568 i‡(
Àngth
 >
	`off£to„nd
(
õì80211_tbâ_öfo_ge_11
,

569 
psd_20
))

570 
íåy
->
psd_20
 = 
tbâ_öfo
->psd_20;

572 
õì80211_tbâ_öfo_7_8_9
 *
tbâ_öfo
 = (*)
pos
;

574 
	`mem˝y
(
íåy
->
bssid
, 
tbâ_öfo
->bssid, 
ETH_ALEN
);

576 
bss_∑øms
 = 
tbâ_öfo
->bss_params;

578 i‡(
Àngth
 =
	`off£to„nd
(
õì80211_tbâ_öfo_7_8_9
,

579 
psd_20
))

580 
íåy
->
psd_20
 = 
tbâ_öfo
->psd_20;

584 i‡(!
	`is_vÆid_ëhî_addr
(
íåy
->
bssid
))

585  -
EINVAL
;

588 i‡(!
	`cfg80211_∑r£_bss_∑øm
(
bss_∑øms
, 
íåy
))

589  -
EINVAL
;

595 i‡(!
íåy
->
ßme_ssid
 && !íåy->
sh‹t_ssid_vÆid
)

598 i‡(
íåy
->
ßme_ssid
) {

599 
íåy
->
sh‹t_ssid
 = 
s_ssid_tmp
;

600 
íåy
->
sh‹t_ssid_vÆid
 = 
åue
;

607 
	`mem˝y
(&
íåy
->
ssid
, &
ssid_ñem
->
d©a
, ssid_ñem->
d©Æí
);

608 
íåy
->
ssid_Àn
 = 
ssid_ñem
->
d©Æí
;

612 
	}
}

614 
boﬁ
 
	$cfg80211_ôî_∫r
(c⁄° 
u8
 *
ñems
, 
size_t
 
ñems_Àn
,

615 
cfg80211_∫r_ôî_ªt


616 (*
ôî
)(*
d©a
, 
u8
 
ty≥
,

617 c⁄° 
õì80211_√ighb‹_≠_öfo
 *
öfo
,

618 c⁄° 
u8
 *
tbâ_öfo
, u8 
tbâ_öfo_Àn
),

619 *
ôî_d©a
)

621 c⁄° 
ñemít
 *
∫r
;

622 c⁄° 
u8
 *
pos
, *
íd
;

624 
	`f‹_óch_ñemít_id
(
∫r
, 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
,

625 
ñems
, 
ñems_Àn
) {

626 c⁄° 
õì80211_√ighb‹_≠_öfo
 *
öfo
;

628 
pos
 = 
∫r
->
d©a
;

629 
íd
 = 
∫r
->
d©a
 +Ñƒ->
d©Æí
;

632 (*
öfo
Ë<
íd
 - 
pos
) {

633 
u8
 
Àngth
, 
i
, 
cou¡
;

634 
u8
 
ty≥
;

636 
öfo
 = (*)
pos
;

637 
cou¡
 = 
	`u8_gë_bôs
(
öfo
->
tbâ_öfo_hdr
,

638 
IEEE80211_AP_INFO_TBTT_HDR_COUNT
) +

640 
Àngth
 = 
öfo
->
tbâ_öfo_Àn
;

642 
pos
 +(*
öfo
);

644 i‡(
cou¡
 * 
Àngth
 > 
íd
 - 
pos
)

645  
Ál£
;

647 
ty≥
 = 
	`u8_gë_bôs
(
öfo
->
tbâ_öfo_hdr
,

648 
IEEE80211_AP_INFO_TBTT_HDR_TYPE
);

650 
i
 = 0; i < 
cou¡
; i++) {

651 
	`ôî
(
ôî_d©a
, 
ty≥
, 
öfo
,

652 
pos
, 
Àngth
)) {

653 
RNR_ITER_CONTINUE
:

655 
RNR_ITER_BREAK
:

656  
åue
;

657 
RNR_ITER_ERROR
:

658  
Ál£
;

661 
pos
 +
Àngth
;

665 i‡(
pos
 !
íd
)

666  
Ál£
;

669  
åue
;

670 
	}
}

671 
EXPORT_SYMBOL_GPL
(
cfg80211_ôî_∫r
);

673 
	scﬁoˇãd_≠_d©a
 {

674 c⁄° 
ñemít
 *
	mssid_ñem
;

675 
li°_hód
 
	m≠_li°
;

676 
u32
 
	ms_ssid_tmp
;

677 
	mn_cﬁoc
;

680 
cfg80211_∫r_ôî_ªt


681 
	$cfg80211_∑r£_cﬁoˇãd_≠_ôî
(*
_d©a
, 
u8
 
ty≥
,

682 c⁄° 
õì80211_√ighb‹_≠_öfo
 *
öfo
,

683 c⁄° 
u8
 *
tbâ_öfo
, u8 
tbâ_öfo_Àn
)

685 
cﬁoˇãd_≠_d©a
 *
d©a
 = 
_d©a
;

686 
cfg80211_cﬁoˇãd_≠
 *
íåy
;

687 
∆80211_b™d
 
b™d
;

689 i‡(
ty≥
 !
IEEE80211_TBTT_INFO_TYPE_TBTT
)

690  
RNR_ITER_CONTINUE
;

692 i‡(!
	`õì80211_›î©ög_˛ass_to_b™d
(
öfo
->
›_˛ass
, &
b™d
))

693  
RNR_ITER_CONTINUE
;

699 i‡(
b™d
 !
NL80211_BAND_6GHZ
 ||

700 !(
tbâ_öfo_Àn
 =
	`off£to„nd
(
õì80211_tbâ_öfo_7_8_9
,

701 
bss_∑øms
) ||

702 
tbâ_öfo_Àn
 =(
õì80211_tbâ_öfo_7_8_9
) ||

703 
tbâ_öfo_Àn
 >
	`off£to„nd
(
õì80211_tbâ_öfo_ge_11
,

704 
bss_∑øms
)))

705  
RNR_ITER_CONTINUE
;

707 
íåy
 = 
	`kzÆloc
((*íåyË+ 
IEEE80211_MAX_SSID_LEN
, 
GFP_ATOMIC
);

708 i‡(!
íåy
)

709  
RNR_ITER_ERROR
;

711 
íåy
->
˚¡î_‰eq
 =

712 
	`õì80211_ch™√l_to_‰equícy
(
öfo
->
ch™√l
, 
b™d
);

714 i‡(!
	`cfg80211_∑r£_≠_öfo
(
íåy
, 
tbâ_öfo
, 
tbâ_öfo_Àn
,

715 
d©a
->
ssid_ñem
, d©a->
s_ssid_tmp
)) {

716 
d©a
->
n_cﬁoc
++;

717 
	`li°_add_èû
(&
íåy
->
li°
, &
d©a
->
≠_li°
);

719 
	`k‰ì
(
íåy
);

722  
RNR_ITER_CONTINUE
;

723 
	}
}

725 
VISIBLE_IF_CFG80211_KUNIT
 

726 
	$cfg80211_∑r£_cﬁoˇãd_≠
(c⁄° 
cfg80211_bss_õs
 *
õs
,

727 
li°_hód
 *
li°
)

729 
cﬁoˇãd_≠_d©a
 
d©a
 = {};

730 
ªt
;

732 
	`INIT_LIST_HEAD
(&
d©a
.
≠_li°
);

734 
ªt
 = 
	`cfg80211_ˇlc_sh‹t_ssid
(
õs
, &
d©a
.
ssid_ñem
, &d©a.
s_ssid_tmp
);

735 i‡(
ªt
)

738 i‡(!
	`cfg80211_ôî_∫r
(
õs
->
d©a
, ies->
Àn
,

739 
cfg80211_∑r£_cﬁoˇãd_≠_ôî
, &
d©a
)) {

740 
	`cfg80211_‰ì_cﬁoc_≠_li°
(&
d©a
.
≠_li°
);

744 
	`li°_•li˚_èû
(&
d©a
.
≠_li°
, 
li°
);

745  
d©a
.
n_cﬁoc
;

746 
	}
}

747 
EXPORT_SYMBOL_IF_CFG80211_KUNIT
(
cfg80211_∑r£_cﬁoˇãd_≠
);

749 
	$cfg80211_sˇn_ªq_add_ch™
(
cfg80211_sˇn_ªque°
 *
ªque°
,

750 
õì80211_ch™√l
 *
ch™
,

751 
boﬁ
 
add_to_6ghz
)

753 
i
;

754 
u32
 
n_ch™√ls
 = 
ªque°
->n_channels;

755 
cfg80211_sˇn_6ghz_∑øms
 *
∑øms
 =

756 &
ªque°
->
sˇn_6ghz_∑øms
[ªque°->
n_6ghz_∑øms
];

758 
i
 = 0; i < 
n_ch™√ls
; i++) {

759 i‡(
ªque°
->
ch™√ls
[
i
] =
ch™
) {

760 i‡(
add_to_6ghz
)

761 
∑øms
->
ch™√l_idx
 = 
i
;

766 
ªque°
->
ch™√ls
[
n_ch™√ls
] = 
ch™
;

767 i‡(
add_to_6ghz
)

768 
ªque°
->
sˇn_6ghz_∑øms
[ªque°->
n_6ghz_∑øms
].
ch™√l_idx
 =

769 
n_ch™√ls
;

771 
ªque°
->
n_ch™√ls
++;

772 
	}
}

774 
boﬁ
 
	$cfg80211_föd_ssid_m©ch
(
cfg80211_cﬁoˇãd_≠
 *
≠
,

775 
cfg80211_sˇn_ªque°
 *
ªque°
)

777 
i
;

778 
u32
 
s_ssid
;

780 
i
 = 0; i < 
ªque°
->
n_ssids
; i++) {

782 i‡(!
ªque°
->
ssids
[
i
].
ssid_Àn
) {

783 i‡(
≠
->
mu…i_bss
 && !≠->
å™smôãd_bssid
)

786  
åue
;

789 i‡(
≠
->
ssid_Àn
 &&

790 
≠
->
ssid_Àn
 =
ªque°
->
ssids
[
i
].ssid_len) {

791 i‡(!
	`memcmp
(
ªque°
->
ssids
[
i
].
ssid
, 
≠
->ssid,

792 
≠
->
ssid_Àn
))

793  
åue
;

794 } i‡(
≠
->
sh‹t_ssid_vÆid
) {

795 
s_ssid
 = ~
	`¸c32_À
(~0, 
ªque°
->
ssids
[
i
].
ssid
,

796 
ªque°
->
ssids
[
i
].
ssid_Àn
);

798 i‡(
≠
->
sh‹t_ssid
 =
s_ssid
)

799  
åue
;

803  
Ál£
;

804 
	}
}

806 
	$cfg80211_sˇn_6ghz
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

808 
u8
 
i
;

809 
cfg80211_cﬁoˇãd_≠
 *
≠
;

810 
n_ch™√ls
, 
cou¡
 = 0, 
îr
;

811 
cfg80211_sˇn_ªque°
 *
ªque°
, *
rdev_ªq
 = 
rdev
->
sˇn_ªq
;

812 
	`LIST_HEAD
(
cﬁoc_≠_li°
);

813 
boﬁ
 
√ed_sˇn_psc
 = 
åue
;

814 c⁄° 
õì80211_sb™d_i·y≥_d©a
 *
i·d
;

816 
rdev_ªq
->
sˇn_6ghz
 = 
åue
;

818 i‡(!
rdev
->
wùhy
.
b™ds
[
NL80211_BAND_6GHZ
])

819  -
EOPNOTSUPP
;

821 
i·d
 = 
	`õì80211_gë_sb™d_i·y≥_d©a
(
rdev
->
wùhy
.
b™ds
[
NL80211_BAND_6GHZ
],

822 
rdev_ªq
->
wdev
->
i·y≥
);

823 i‡(!
i·d
 || !i·d->
he_ˇp
.
has_he
)

824  -
EOPNOTSUPP
;

826 
n_ch™√ls
 = 
rdev
->
wùhy
.
b™ds
[
NL80211_BAND_6GHZ
]->n_channels;

828 i‡(
rdev_ªq
->
Êags
 & 
NL80211_SCAN_FLAG_COLOCATED_6GHZ
) {

829 
cfg80211_öã∫Æ_bss
 *
ötbss
;

831 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

832 
	`li°_f‹_óch_íåy
(
ötbss
, &
rdev
->
bss_li°
, 
li°
) {

833 
cfg80211_bss
 *
ªs
 = &
ötbss
->
pub
;

834 c⁄° 
cfg80211_bss_õs
 *
õs
;

835 c⁄° 
ñemít
 *
ssid_ñem
;

836 
cfg80211_cﬁoˇãd_≠
 *
íåy
;

837 
u32
 
s_ssid_tmp
;

838 
ªt
;

840 
õs
 = 
	`rcu_ac˚ss_poöãr
(
ªs
->ies);

841 
cou¡
 +
	`cfg80211_∑r£_cﬁoˇãd_≠
(
õs
,

842 &
cﬁoc_≠_li°
);

850 i‡(
	`is_brﬂdˇ°_ëhî_addr
(
rdev_ªq
->
bssid
) ||

851 !
	`ëhî_addr_equÆ
(
rdev_ªq
->
bssid
, 
ªs
->bssid) ||

852 
ªs
->
ch™√l
->
b™d
 !
NL80211_BAND_6GHZ
)

855 
ªt
 = 
	`cfg80211_ˇlc_sh‹t_ssid
(
õs
, &
ssid_ñem
,

856 &
s_ssid_tmp
);

857 i‡(
ªt
)

860 
íåy
 = 
	`kzÆloc
((*íåyË+ 
IEEE80211_MAX_SSID_LEN
,

861 
GFP_ATOMIC
);

863 i‡(!
íåy
)

866 
	`mem˝y
(
íåy
->
bssid
, 
ªs
->bssid, 
ETH_ALEN
);

867 
íåy
->
sh‹t_ssid
 = 
s_ssid_tmp
;

868 
	`mem˝y
(
íåy
->
ssid
, 
ssid_ñem
->
d©a
,

869 
ssid_ñem
->
d©Æí
);

870 
íåy
->
ssid_Àn
 = 
ssid_ñem
->
d©Æí
;

871 
íåy
->
sh‹t_ssid_vÆid
 = 
åue
;

872 
íåy
->
˚¡î_‰eq
 = 
ªs
->
ch™√l
->center_freq;

874 
	`li°_add_èû
(&
íåy
->
li°
, &
cﬁoc_≠_li°
);

875 
cou¡
++;

877 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

880 
ªque°
 = 
	`kzÆloc
(
	`°ru˘_size
‘eque°, 
ch™√ls
, 
n_ch™√ls
) +

881 (*
ªque°
->
sˇn_6ghz_∑øms
Ë* 
cou¡
 +

882 (*
ªque°
->
ssids
Ë* 
rdev_ªq
->
n_ssids
,

883 
GFP_KERNEL
);

884 i‡(!
ªque°
) {

885 
	`cfg80211_‰ì_cﬁoc_≠_li°
(&
cﬁoc_≠_li°
);

886  -
ENOMEM
;

889 *
ªque°
 = *
rdev_ªq
;

890 
ªque°
->
n_ch™√ls
 = 0;

891 
ªque°
->
sˇn_6ghz_∑øms
 =

892 (*)&
ªque°
->
ch™√ls
[
n_ch™√ls
];

899 i‡(
cou¡
 && 
ªque°
->
n_ssids
 =1 &&Ñeque°->
ssids
[0].
ssid_Àn
) {

900 
	`li°_f‹_óch_íåy
(
≠
, &
cﬁoc_≠_li°
, 
li°
) {

901 i‡(
≠
->
cﬁoˇãd_ess
 &&

902 
	`cfg80211_föd_ssid_m©ch
(
≠
, 
ªque°
)) {

903 
√ed_sˇn_psc
 = 
Ál£
;

914 
i
 = 0; i < 
rdev_ªq
->
n_ch™√ls
; i++) {

915 i‡(
rdev_ªq
->
ch™√ls
[
i
]->
b™d
 =
NL80211_BAND_6GHZ
 &&

916 ((
√ed_sˇn_psc
 &&

917 
	`cfg80211_ch™√l_is_psc
(
rdev_ªq
->
ch™√ls
[
i
])) ||

918 !(
rdev_ªq
->
Êags
 & 
NL80211_SCAN_FLAG_COLOCATED_6GHZ
))) {

919 
	`cfg80211_sˇn_ªq_add_ch™
(
ªque°
,

920 
rdev_ªq
->
ch™√ls
[
i
],

921 
Ál£
);

925 i‡(!(
rdev_ªq
->
Êags
 & 
NL80211_SCAN_FLAG_COLOCATED_6GHZ
))

926 
skù
;

928 
	`li°_f‹_óch_íåy
(
≠
, &
cﬁoc_≠_li°
, 
li°
) {

929 
boﬁ
 
found
 = 
Ál£
;

930 
cfg80211_sˇn_6ghz_∑øms
 *
sˇn_6ghz_∑øms
 =

931 &
ªque°
->
sˇn_6ghz_∑øms
[ªque°->
n_6ghz_∑øms
];

932 
õì80211_ch™√l
 *
ch™
 =

933 
	`õì80211_gë_ch™√l
(&
rdev
->
wùhy
, 
≠
->
˚¡î_‰eq
);

935 i‡(!
ch™
 || ch™->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

938 
i
 = 0; i < 
rdev_ªq
->
n_ch™√ls
; i++) {

939 i‡(
rdev_ªq
->
ch™√ls
[
i
] =
ch™
)

940 
found
 = 
åue
;

943 i‡(!
found
)

946 i‡(
ªque°
->
n_ssids
 > 0 &&

947 !
	`cfg80211_föd_ssid_m©ch
(
≠
, 
ªque°
))

950 i‡(!
	`is_brﬂdˇ°_ëhî_addr
(
ªque°
->
bssid
) &&

951 !
	`ëhî_addr_equÆ
(
ªque°
->
bssid
, 
≠
->bssid))

954 i‡(!
ªque°
->
n_ssids
 && 
≠
->
mu…i_bss
 && !≠->
å™smôãd_bssid
)

957 
	`cfg80211_sˇn_ªq_add_ch™
(
ªque°
, 
ch™
, 
åue
);

958 
	`mem˝y
(
sˇn_6ghz_∑øms
->
bssid
, 
≠
->bssid, 
ETH_ALEN
);

959 
sˇn_6ghz_∑øms
->
sh‹t_ssid
 = 
≠
->short_ssid;

960 
sˇn_6ghz_∑øms
->
sh‹t_ssid_vÆid
 = 
≠
->short_ssid_valid;

961 
sˇn_6ghz_∑øms
->
unsﬁicôed_¥obe
 = 
≠
->unsolicited_probe;

962 
sˇn_6ghz_∑øms
->
psd_20
 = 
≠
->psd_20;

970 i‡(
	`cfg80211_ch™√l_is_psc
(
ch™
Ë&& !
√ed_sˇn_psc
)

971 
sˇn_6ghz_∑øms
->
psc_no_li°í
 = 
åue
;

973 
ªque°
->
n_6ghz_∑øms
++;

976 
skù
:

977 
	`cfg80211_‰ì_cﬁoc_≠_li°
(&
cﬁoc_≠_li°
);

979 i‡(
ªque°
->
n_ch™√ls
) {

980 
cfg80211_sˇn_ªque°
 *
ﬁd
 = 
rdev
->
öt_sˇn_ªq
;

981 
rdev
->
öt_sˇn_ªq
 = 
ªque°
;

988 
ªque°
->
ssids
 = (*)&ªque°->
ch™√ls
[ªque°->
n_ch™√ls
];

989 
ªque°
->
n_ssids
 = 
rdev_ªq
->n_ssids;

990 
	`mem˝y
(
ªque°
->
ssids
, 
rdev_ªq
->ssids, (*request->ssids) *

991 
ªque°
->
n_ssids
);

997 i‡(
ﬁd
)

998 
rdev
->
öt_sˇn_ªq
->
öfo
 = 
ﬁd
->info;

1000 
îr
 = 
	`rdev_sˇn
(
rdev
, 
ªque°
);

1001 i‡(
îr
) {

1002 
rdev
->
öt_sˇn_ªq
 = 
ﬁd
;

1003 
	`k‰ì
(
ªque°
);

1005 
	`k‰ì
(
ﬁd
);

1008  
îr
;

1011 
	`k‰ì
(
ªque°
);

1012  -
EINVAL
;

1013 
	}
}

1015 
	$cfg80211_sˇn
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

1017 
cfg80211_sˇn_ªque°
 *
ªque°
;

1018 
cfg80211_sˇn_ªque°
 *
rdev_ªq
 = 
rdev
->
sˇn_ªq
;

1019 
u32
 
n_ch™√ls
 = 0, 
idx
, 
i
;

1021 i‡(!(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SPLIT_SCAN_6GHZ
))

1022  
	`rdev_sˇn
(
rdev
, 
rdev_ªq
);

1024 
i
 = 0; i < 
rdev_ªq
->
n_ch™√ls
; i++) {

1025 i‡(
rdev_ªq
->
ch™√ls
[
i
]->
b™d
 !
NL80211_BAND_6GHZ
)

1026 
n_ch™√ls
++;

1029 i‡(!
n_ch™√ls
)

1030  
	`cfg80211_sˇn_6ghz
(
rdev
);

1032 
ªque°
 = 
	`kzÆloc
(
	`°ru˘_size
‘eque°, 
ch™√ls
, 
n_ch™√ls
),

1033 
GFP_KERNEL
);

1034 i‡(!
ªque°
)

1035  -
ENOMEM
;

1037 *
ªque°
 = *
rdev_ªq
;

1038 
ªque°
->
n_ch™√ls
 =Ç_channels;

1040 
i
 = 
idx
 = 0; i < 
rdev_ªq
->
n_ch™√ls
; i++) {

1041 i‡(
rdev_ªq
->
ch™√ls
[
i
]->
b™d
 !
NL80211_BAND_6GHZ
)

1042 
ªque°
->
ch™√ls
[
idx
++] = 
rdev_ªq
->ch™√ls[
i
];

1045 
rdev_ªq
->
sˇn_6ghz
 = 
Ál£
;

1046 
rdev
->
öt_sˇn_ªq
 = 
ªque°
;

1047  
	`rdev_sˇn
(
rdev
, 
ªque°
);

1048 
	}
}

1050 
	$___cfg80211_sˇn_d⁄e
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1051 
boﬁ
 
£nd_mesßge
)

1053 
cfg80211_sˇn_ªque°
 *
ªque°
, *
rdev_ªq
;

1054 
wúñess_dev
 *
wdev
;

1055 
sk_buff
 *
msg
;

1056 #ifde‡
CONFIG_CFG80211_WEXT


1057 
iwªq_d©a
 
wrqu
;

1060 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1062 i‡(
rdev
->
sˇn_msg
) {

1063 
	`∆80211_£nd_sˇn_msg
(
rdev
,Ñdev->
sˇn_msg
);

1064 
rdev
->
sˇn_msg
 = 
NULL
;

1068 
rdev_ªq
 = 
rdev
->
sˇn_ªq
;

1069 i‡(!
rdev_ªq
)

1072 
wdev
 = 
rdev_ªq
->wdev;

1073 
ªque°
 = 
rdev
->
öt_sˇn_ªq
 ?Ñdev->öt_sˇn_ªq : 
rdev_ªq
;

1075 i‡(
	`wdev_ru¬ög
(
wdev
) &&

1076 (
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_SPLIT_SCAN_6GHZ
) &&

1077 !
rdev_ªq
->
sˇn_6ghz
 && !
ªque°
->
öfo
.
ab‹ãd
 &&

1078 !
	`cfg80211_sˇn_6ghz
(
rdev
))

1086 i‡(
wdev
->
√tdev
)

1087 
	`cfg80211_sme_sˇn_d⁄e
(
wdev
->
√tdev
);

1089 i‡(!
ªque°
->
öfo
.
ab‹ãd
 &&

1090 
ªque°
->
Êags
 & 
NL80211_SCAN_FLAG_FLUSH
) {

1092 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

1093 
	`__cfg80211_bss_expúe
(
rdev
, 
ªque°
->
sˇn_°¨t
);

1094 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

1097 
msg
 = 
	`∆80211_buûd_sˇn_msg
(
rdev
, 
wdev
, 
ªque°
->
öfo
.
ab‹ãd
);

1099 #ifde‡
CONFIG_CFG80211_WEXT


1100 i‡(
wdev
->
√tdev
 && !
ªque°
->
öfo
.
ab‹ãd
) {

1101 
	`mem£t
(&
wrqu
, 0, (wrqu));

1103 
	`wúñess_£nd_evít
(
wdev
->
√tdev
, 
SIOCGIWSCAN
, &
wrqu
, 
NULL
);

1107 
	`dev_put
(
wdev
->
√tdev
);

1109 
	`k‰ì
(
rdev
->
öt_sˇn_ªq
);

1110 
rdev
->
öt_sˇn_ªq
 = 
NULL
;

1112 
	`k‰ì
(
rdev
->
sˇn_ªq
);

1113 
rdev
->
sˇn_ªq
 = 
NULL
;

1115 i‡(!
£nd_mesßge
)

1116 
rdev
->
sˇn_msg
 = 
msg
;

1118 
	`∆80211_£nd_sˇn_msg
(
rdev
, 
msg
);

1119 
	}
}

1121 
	$__cfg80211_sˇn_d⁄e
(
wùhy
 *wùhy, 
wùhy_w‹k
 *
wk
)

1123 
	`___cfg80211_sˇn_d⁄e
(
	`wùhy_to_rdev
(
wùhy
), 
åue
);

1124 
	}
}

1126 
	$cfg80211_sˇn_d⁄e
(
cfg80211_sˇn_ªque°
 *
ªque°
,

1127 
cfg80211_sˇn_öfo
 *
öfo
)

1129 
cfg80211_sˇn_öfo
 
ﬁd_öfo
 = 
ªque°
->
öfo
;

1131 
	`åa˚_cfg80211_sˇn_d⁄e
(
ªque°
, 
öfo
);

1132 
	`WARN_ON
(
ªque°
 !
	`wùhy_to_rdev
‘eque°->
wùhy
)->
sˇn_ªq
 &&

1133 
ªque°
 !
	`wùhy_to_rdev
‘eque°->
wùhy
)->
öt_sˇn_ªq
);

1135 
ªque°
->
öfo
 = *info;

1142 i‡(
ªque°
->
sˇn_6ghz
 && 
ﬁd_öfo
.
sˇn_°¨t_tsf
) {

1143 
ªque°
->
öfo
.
sˇn_°¨t_tsf
 = 
ﬁd_öfo
.scan_start_tsf;

1144 
	`mem˝y
(
ªque°
->
öfo
.
tsf_bssid
, 
ﬁd_öfo
.tsf_bssid,

1145 (
ªque°
->
öfo
.
tsf_bssid
));

1148 
ªque°
->
nŸifõd
 = 
åue
;

1149 
	`wùhy_w‹k_queue
(
ªque°
->
wùhy
,

1150 &
	`wùhy_to_rdev
(
ªque°
->
wùhy
)->
sˇn_d⁄e_wk
);

1151 
	}
}

1152 
EXPORT_SYMBOL
(
cfg80211_sˇn_d⁄e
);

1154 
	$cfg80211_add_sched_sˇn_ªq
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1155 
cfg80211_sched_sˇn_ªque°
 *
ªq
)

1157 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1159 
	`li°_add_rcu
(&
ªq
->
li°
, &
rdev
->
sched_sˇn_ªq_li°
);

1160 
	}
}

1162 
	$cfg80211_dñ_sched_sˇn_ªq
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1163 
cfg80211_sched_sˇn_ªque°
 *
ªq
)

1165 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1167 
	`li°_dñ_rcu
(&
ªq
->
li°
);

1168 
	`k‰ì_rcu
(
ªq
, 
rcu_hód
);

1169 
	}
}

1171 
cfg80211_sched_sˇn_ªque°
 *

1172 
	$cfg80211_föd_sched_sˇn_ªq
(
cfg80211_ªgi°îed_devi˚
 *
rdev
, 
u64
 
ªqid
)

1174 
cfg80211_sched_sˇn_ªque°
 *
pos
;

1176 
	`li°_f‹_óch_íåy_rcu
(
pos
, &
rdev
->
sched_sˇn_ªq_li°
, 
li°
,

1177 
	`lockdï_is_hñd
(&
rdev
->
wùhy
.
mtx
)) {

1178 i‡(
pos
->
ªqid
 ==Ñeqid)

1179  
pos
;

1181  
NULL
;

1182 
	}
}

1192 
	$cfg80211_sched_sˇn_ªq_possibÀ
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1193 
boﬁ
 
w™t_mu…i
)

1195 
cfg80211_sched_sˇn_ªque°
 *
pos
;

1196 
i
 = 0;

1198 
	`li°_f‹_óch_íåy
(
pos
, &
rdev
->
sched_sˇn_ªq_li°
, 
li°
) {

1200 i‡(!
i
 && !
pos
->
ªqid
)

1201  -
EINPROGRESS
;

1202 
i
++;

1205 i‡(
i
) {

1207 i‡(!
w™t_mu…i
)

1208  -
EINPROGRESS
;

1211 i‡(
i
 =
rdev
->
wùhy
.
max_sched_sˇn_ªqs
)

1212  -
ENOSPC
;

1215 
	}
}

1217 
	$cfg80211_sched_sˇn_ªsu…s_wk
(
w‹k_°ru˘
 *
w‹k
)

1219 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

1220 
cfg80211_sched_sˇn_ªque°
 *
ªq
, *
tmp
;

1222 
rdev
 = 
	`c⁄èöî_of
(
w‹k
, 
cfg80211_ªgi°îed_devi˚
,

1223 
sched_sˇn_ªs_wk
);

1225 
	`wùhy_lock
(&
rdev
->
wùhy
);

1226 
	`li°_f‹_óch_íåy_ß„
(
ªq
, 
tmp
, &
rdev
->
sched_sˇn_ªq_li°
, 
li°
) {

1227 i‡(
ªq
->
ªp‹t_ªsu…s
) {

1228 
ªq
->
ªp‹t_ªsu…s
 = 
Ál£
;

1229 i‡(
ªq
->
Êags
 & 
NL80211_SCAN_FLAG_FLUSH
) {

1231 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

1232 
	`__cfg80211_bss_expúe
(
rdev
, 
ªq
->
sˇn_°¨t
);

1233 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

1234 
ªq
->
sˇn_°¨t
 = 
jiffõs
;

1236 
	`∆80211_£nd_sched_sˇn
(
ªq
,

1237 
NL80211_CMD_SCHED_SCAN_RESULTS
);

1240 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1241 
	}
}

1243 
	$cfg80211_sched_sˇn_ªsu…s
(
wùhy
 *wùhy, 
u64
 
ªqid
)

1245 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1246 
cfg80211_sched_sˇn_ªque°
 *
ªque°
;

1248 
	`åa˚_cfg80211_sched_sˇn_ªsu…s
(
wùhy
, 
ªqid
);

1251 
	`rcu_ªad_lock
();

1252 
ªque°
 = 
	`cfg80211_föd_sched_sˇn_ªq
(
rdev
, 
ªqid
);

1253 i‡(
ªque°
) {

1254 
ªque°
->
ªp‹t_ªsu…s
 = 
åue
;

1255 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
sched_sˇn_ªs_wk
);

1257 
	`rcu_ªad_u∆ock
();

1258 
	}
}

1259 
EXPORT_SYMBOL
(
cfg80211_sched_sˇn_ªsu…s
);

1261 
	$cfg80211_sched_sˇn_°›≥d_locked
(
wùhy
 *wùhy, 
u64
 
ªqid
)

1263 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1265 
	`lockdï_as£π_hñd
(&
wùhy
->
mtx
);

1267 
	`åa˚_cfg80211_sched_sˇn_°›≥d
(
wùhy
, 
ªqid
);

1269 
	`__cfg80211_°›_sched_sˇn
(
rdev
, 
ªqid
, 
åue
);

1270 
	}
}

1271 
EXPORT_SYMBOL
(
cfg80211_sched_sˇn_°›≥d_locked
);

1273 
	$cfg80211_sched_sˇn_°›≥d
(
wùhy
 *wùhy, 
u64
 
ªqid
)

1275 
	`wùhy_lock
(
wùhy
);

1276 
	`cfg80211_sched_sˇn_°›≥d_locked
(
wùhy
, 
ªqid
);

1277 
	`wùhy_u∆ock
(
wùhy
);

1278 
	}
}

1279 
EXPORT_SYMBOL
(
cfg80211_sched_sˇn_°›≥d
);

1281 
	$cfg80211_°›_sched_sˇn_ªq
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1282 
cfg80211_sched_sˇn_ªque°
 *
ªq
,

1283 
boﬁ
 
drivî_öôüãd
)

1285 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1287 i‡(!
drivî_öôüãd
) {

1288 
îr
 = 
	`rdev_sched_sˇn_°›
(
rdev
, 
ªq
->
dev
,Ñeq->
ªqid
);

1289 i‡(
îr
)

1290  
îr
;

1293 
	`∆80211_£nd_sched_sˇn
(
ªq
, 
NL80211_CMD_SCHED_SCAN_STOPPED
);

1295 
	`cfg80211_dñ_sched_sˇn_ªq
(
rdev
, 
ªq
);

1298 
	}
}

1300 
	$__cfg80211_°›_sched_sˇn
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1301 
u64
 
ªqid
, 
boﬁ
 
drivî_öôüãd
)

1303 
cfg80211_sched_sˇn_ªque°
 *
sched_sˇn_ªq
;

1305 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1307 
sched_sˇn_ªq
 = 
	`cfg80211_föd_sched_sˇn_ªq
(
rdev
, 
ªqid
);

1308 i‡(!
sched_sˇn_ªq
)

1309  -
ENOENT
;

1311  
	`cfg80211_°›_sched_sˇn_ªq
(
rdev
, 
sched_sˇn_ªq
,

1312 
drivî_öôüãd
);

1313 
	}
}

1315 
	$cfg80211_bss_age
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1316 
age_£cs
)

1318 
cfg80211_öã∫Æ_bss
 *
bss
;

1319 
age_jiffõs
 = 
	`m£cs_to_jiffõs
(
age_£cs
 * 
MSEC_PER_SEC
);

1321 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

1322 
	`li°_f‹_óch_íåy
(
bss
, &
rdev
->
bss_li°
, 
li°
)

1323 
bss
->
ts
 -
age_jiffõs
;

1324 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

1325 
	}
}

1327 
	$cfg80211_bss_expúe
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

1329 
	`__cfg80211_bss_expúe
(
rdev
, 
jiffõs
 - 
IEEE80211_SCAN_RESULT_EXPIRE
);

1330 
	}
}

1332 
	$cfg80211_bss_Êush
(
wùhy
 *wiphy)

1334 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1336 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

1337 
	`__cfg80211_bss_expúe
(
rdev
, 
jiffõs
);

1338 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

1339 
	}
}

1340 
EXPORT_SYMBOL
(
cfg80211_bss_Êush
);

1342 c⁄° 
ñemít
 *

1343 
	$cfg80211_föd_ñem_m©ch
(
u8
 
eid
, c⁄° u8 *
õs
, 
Àn
,

1344 c⁄° 
u8
 *
m©ch
, 
m©ch_Àn
,

1345 
m©ch_off£t
)

1347 c⁄° 
ñemít
 *
ñem
;

1349 
	`f‹_óch_ñemít_id
(
ñem
, 
eid
, 
õs
, 
Àn
) {

1350 i‡(
ñem
->
d©Æí
 >
m©ch_off£t
 + 
m©ch_Àn
 &&

1351 !
	`memcmp
(
ñem
->
d©a
 + 
m©ch_off£t
, 
m©ch
, 
m©ch_Àn
))

1352  
ñem
;

1355  
NULL
;

1356 
	}
}

1357 
EXPORT_SYMBOL
(
cfg80211_föd_ñem_m©ch
);

1359 c⁄° 
ñemít
 *
	$cfg80211_föd_víd‹_ñem
(
oui
, 
oui_ty≥
,

1360 c⁄° 
u8
 *
õs
,

1361 
Àn
)

1363 c⁄° 
ñemít
 *
ñem
;

1364 
u8
 
m©ch
[] = { 
oui
 >> 16, ouò>> 8, oui, 
oui_ty≥
 };

1365 
m©ch_Àn
 = (
oui_ty≥
 < 0Ë? 3 : (
m©ch
);

1367 i‡(
	`WARN_ON
(
oui_ty≥
 > 0xff))

1368  
NULL
;

1370 
ñem
 = 
	`cfg80211_föd_ñem_m©ch
(
WLAN_EID_VENDOR_SPECIFIC
, 
õs
, 
Àn
,

1371 
m©ch
, 
m©ch_Àn
, 0);

1373 i‡(!
ñem
 ||ÉÀm->
d©Æí
 < 4)

1374  
NULL
;

1376  
ñem
;

1377 
	}
}

1378 
EXPORT_SYMBOL
(
cfg80211_föd_víd‹_ñem
);

1386 
	ebss_com∑ª_mode
 {

1387 
	mBSS_CMP_REGULAR
,

1388 
	mBSS_CMP_HIDE_ZLEN
,

1389 
	mBSS_CMP_HIDE_NUL
,

1392 
	$cmp_bss
(
cfg80211_bss
 *
a
,

1393 
cfg80211_bss
 *
b
,

1394 
bss_com∑ª_mode
 
mode
)

1396 c⁄° 
cfg80211_bss_õs
 *
a_õs
, *
b_õs
;

1397 c⁄° 
u8
 *
õ1
 = 
NULL
;

1398 c⁄° 
u8
 *
õ2
 = 
NULL
;

1399 
i
, 
r
;

1401 i‡(
a
->
ch™√l
 !
b
->channel)

1402  (
b
->
ch™√l
->
˚¡î_‰eq
 * 1000 + b->ch™√l->
‰eq_off£t
) -

1403 (
a
->
ch™√l
->
˚¡î_‰eq
 * 1000 +á->ch™√l->
‰eq_off£t
);

1405 
a_õs
 = 
	`rcu_ac˚ss_poöãr
(
a
->
õs
);

1406 i‡(!
a_õs
)

1408 
b_õs
 = 
	`rcu_ac˚ss_poöãr
(
b
->
õs
);

1409 i‡(!
b_õs
)

1412 i‡(
	`WLAN_CAPABILITY_IS_STA_BSS
(
a
->
ˇ∑bûôy
))

1413 
õ1
 = 
	`cfg80211_föd_õ
(
WLAN_EID_MESH_ID
,

1414 
a_õs
->
d©a
,á_õs->
Àn
);

1415 i‡(
	`WLAN_CAPABILITY_IS_STA_BSS
(
b
->
ˇ∑bûôy
))

1416 
õ2
 = 
	`cfg80211_föd_õ
(
WLAN_EID_MESH_ID
,

1417 
b_õs
->
d©a
, b_õs->
Àn
);

1418 i‡(
õ1
 && 
õ2
) {

1419 
mesh_id_cmp
;

1421 i‡(
õ1
[1] =
õ2
[1])

1422 
mesh_id_cmp
 = 
	`memcmp
(
õ1
 + 2, 
õ2
 + 2, ie1[1]);

1424 
mesh_id_cmp
 = 
õ2
[1] - 
õ1
[1];

1426 
õ1
 = 
	`cfg80211_föd_õ
(
WLAN_EID_MESH_CONFIG
,

1427 
a_õs
->
d©a
,á_õs->
Àn
);

1428 
õ2
 = 
	`cfg80211_föd_õ
(
WLAN_EID_MESH_CONFIG
,

1429 
b_õs
->
d©a
, b_õs->
Àn
);

1430 i‡(
õ1
 && 
õ2
) {

1431 i‡(
mesh_id_cmp
)

1432  
mesh_id_cmp
;

1433 i‡(
õ1
[1] !
õ2
[1])

1434  
õ2
[1] - 
õ1
[1];

1435  
	`memcmp
(
õ1
 + 2, 
õ2
 + 2, ie1[1]);

1439 
r
 = 
	`memcmp
(
a
->
bssid
, 
b
->bssid, (a->bssid));

1440 i‡(
r
)

1441  
r
;

1443 
õ1
 = 
	`cfg80211_föd_õ
(
WLAN_EID_SSID
, 
a_õs
->
d©a
,á_õs->
Àn
);

1444 
õ2
 = 
	`cfg80211_föd_õ
(
WLAN_EID_SSID
, 
b_õs
->
d©a
, b_õs->
Àn
);

1446 i‡(!
õ1
 && !
õ2
)

1456 i‡(!
õ1
)

1458 i‡(!
õ2
)

1461 
mode
) {

1462 
BSS_CMP_HIDE_ZLEN
:

1475  
õ2
[1];

1476 
BSS_CMP_REGULAR
:

1479 i‡(
õ1
[1] !
õ2
[1])

1480  
õ2
[1] - 
õ1
[1];

1481  
	`memcmp
(
õ1
 + 2, 
õ2
 + 2, ie1[1]);

1482 
BSS_CMP_HIDE_NUL
:

1483 i‡(
õ1
[1] !
õ2
[1])

1484  
õ2
[1] - 
õ1
[1];

1486 
i
 = 0; i < 
õ2
[1]; i++)

1487 i‡(
õ2
[
i
 + 2])

1491 
	}
}

1493 
boﬁ
 
	$cfg80211_bss_ty≥_m©ch
(
u16
 
ˇ∑bûôy
,

1494 
∆80211_b™d
 
b™d
,

1495 
õì80211_bss_ty≥
 
bss_ty≥
)

1497 
boﬁ
 
ªt
 = 
åue
;

1498 
u16
 
mask
, 
vÆ
;

1500 i‡(
bss_ty≥
 =
IEEE80211_BSS_TYPE_ANY
)

1501  
ªt
;

1503 i‡(
b™d
 =
NL80211_BAND_60GHZ
) {

1504 
mask
 = 
WLAN_CAPABILITY_DMG_TYPE_MASK
;

1505 
bss_ty≥
) {

1506 
IEEE80211_BSS_TYPE_ESS
:

1507 
vÆ
 = 
WLAN_CAPABILITY_DMG_TYPE_AP
;

1509 
IEEE80211_BSS_TYPE_PBSS
:

1510 
vÆ
 = 
WLAN_CAPABILITY_DMG_TYPE_PBSS
;

1512 
IEEE80211_BSS_TYPE_IBSS
:

1513 
vÆ
 = 
WLAN_CAPABILITY_DMG_TYPE_IBSS
;

1516  
Ál£
;

1519 
mask
 = 
WLAN_CAPABILITY_ESS
 | 
WLAN_CAPABILITY_IBSS
;

1520 
bss_ty≥
) {

1521 
IEEE80211_BSS_TYPE_ESS
:

1522 
vÆ
 = 
WLAN_CAPABILITY_ESS
;

1524 
IEEE80211_BSS_TYPE_IBSS
:

1525 
vÆ
 = 
WLAN_CAPABILITY_IBSS
;

1527 
IEEE80211_BSS_TYPE_MBSS
:

1528 
vÆ
 = 0;

1531  
Ál£
;

1535 
ªt
 = ((
ˇ∑bûôy
 & 
mask
Ë=
vÆ
);

1536  
ªt
;

1537 
	}
}

1540 
cfg80211_bss
 *
	$__cfg80211_gë_bss
(
wùhy
 *wiphy,

1541 
õì80211_ch™√l
 *
ch™√l
,

1542 c⁄° 
u8
 *
bssid
,

1543 c⁄° 
u8
 *
ssid
, 
size_t
 
ssid_Àn
,

1544 
õì80211_bss_ty≥
 
bss_ty≥
,

1545 
õì80211_¥ivacy
 
¥ivacy
,

1546 
u32
 
u£_f‹
)

1548 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

1549 
cfg80211_öã∫Æ_bss
 *
bss
, *
ªs
 = 
NULL
;

1550 
now
 = 
jiffõs
;

1551 
bss_¥ivacy
;

1553 
	`åa˚_cfg80211_gë_bss
(
wùhy
, 
ch™√l
, 
bssid
, 
ssid
, 
ssid_Àn
, 
bss_ty≥
,

1554 
¥ivacy
);

1556 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

1558 
	`li°_f‹_óch_íåy
(
bss
, &
rdev
->
bss_li°
, 
li°
) {

1559 i‡(!
	`cfg80211_bss_ty≥_m©ch
(
bss
->
pub
.
ˇ∑bûôy
,

1560 
bss
->
pub
.
ch™√l
->
b™d
, 
bss_ty≥
))

1563 
bss_¥ivacy
 = (
bss
->
pub
.
ˇ∑bûôy
 & 
WLAN_CAPABILITY_PRIVACY
);

1564 i‡((
¥ivacy
 =
IEEE80211_PRIVACY_ON
 && !
bss_¥ivacy
) ||

1565 (
¥ivacy
 =
IEEE80211_PRIVACY_OFF
 && 
bss_¥ivacy
))

1567 i‡(
ch™√l
 && 
bss
->
pub
.channel != channel)

1569 i‡(!
	`is_vÆid_ëhî_addr
(
bss
->
pub
.
bssid
))

1571 i‡((
bss
->
pub
.
u£_f‹
 & use_for) != use_for)

1574 i‡(
	`time_a·î
(
now
, 
bss
->
ts
 + 
IEEE80211_SCAN_RESULT_EXPIRE
) &&

1575 !
	`©omic_ªad
(&
bss
->
hﬁd
))

1577 i‡(
	`is_bss
(&
bss
->
pub
, 
bssid
, 
ssid
, 
ssid_Àn
)) {

1578 
ªs
 = 
bss
;

1579 
	`bss_ªf_gë
(
rdev
, 
ªs
);

1584 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

1585 i‡(!
ªs
)

1586  
NULL
;

1587 
	`åa˚_cfg80211_ªtu∫_bss
(&
ªs
->
pub
);

1588  &
ªs
->
pub
;

1589 
	}
}

1590 
EXPORT_SYMBOL
(
__cfg80211_gë_bss
);

1592 
	$rb_ö£π_bss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1593 
cfg80211_öã∫Æ_bss
 *
bss
)

1595 
rb_node
 **
p
 = &
rdev
->
bss_åì
.rb_node;

1596 
rb_node
 *
∑ª¡
 = 
NULL
;

1597 
cfg80211_öã∫Æ_bss
 *
tbss
;

1598 
cmp
;

1600 *
p
) {

1601 
∑ª¡
 = *
p
;

1602 
tbss
 = 
	`rb_íåy
(
∑ª¡
, 
cfg80211_öã∫Æ_bss
, 
rbn
);

1604 
cmp
 = 
	`cmp_bss
(&
bss
->
pub
, &
tbss
->pub, 
BSS_CMP_REGULAR
);

1606 i‡(
	`WARN_ON
(!
cmp
)) {

1611 i‡(
cmp
 < 0)

1612 
p
 = &(*p)->
rb_À·
;

1614 
p
 = &(*p)->
rb_right
;

1617 
	`rb_lök_node
(&
bss
->
rbn
, 
∑ª¡
, 
p
);

1618 
	`rb_ö£π_cﬁ‹
(&
bss
->
rbn
, &
rdev
->
bss_åì
);

1619 
	}
}

1621 
cfg80211_öã∫Æ_bss
 *

1622 
	$rb_föd_bss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1623 
cfg80211_öã∫Æ_bss
 *
ªs
,

1624 
bss_com∑ª_mode
 
mode
)

1626 
rb_node
 *
n
 = 
rdev
->
bss_åì
.rb_node;

1627 
cfg80211_öã∫Æ_bss
 *
bss
;

1628 
r
;

1630 
n
) {

1631 
bss
 = 
	`rb_íåy
(
n
, 
cfg80211_öã∫Æ_bss
, 
rbn
);

1632 
r
 = 
	`cmp_bss
(&
ªs
->
pub
, &
bss
->pub, 
mode
);

1634 i‡(
r
 == 0)

1635  
bss
;

1636 i‡(
r
 < 0)

1637 
n
 =Ç->
rb_À·
;

1639 
n
 =Ç->
rb_right
;

1642  
NULL
;

1643 
	}
}

1645 
boﬁ
 
	$cfg80211_comböe_bs£s
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1646 
cfg80211_öã∫Æ_bss
 *
√w
)

1648 c⁄° 
cfg80211_bss_õs
 *
õs
;

1649 
cfg80211_öã∫Æ_bss
 *
bss
;

1650 c⁄° 
u8
 *
õ
;

1651 
i
, 
ssidÀn
;

1652 
u8
 
fﬁd
 = 0;

1653 
u32
 
n_íåõs
 = 0;

1655 
õs
 = 
	`rcu_ac˚ss_poöãr
(
√w
->
pub
.
bóc⁄_õs
);

1656 i‡(
	`WARN_ON
(!
õs
))

1657  
Ál£
;

1659 
õ
 = 
	`cfg80211_föd_õ
(
WLAN_EID_SSID
, 
õs
->
d©a
, ies->
Àn
);

1660 i‡(!
õ
) {

1662  
åue
;

1665 
ssidÀn
 = 
õ
[1];

1666 
i
 = 0; i < 
ssidÀn
; i++)

1667 
fﬁd
 |
õ
[2 + 
i
];

1669 i‡(
fﬁd
) {

1671  
åue
;

1676 
	`li°_f‹_óch_íåy
(
bss
, &
rdev
->
bss_li°
, 
li°
) {

1681 
n_íåõs
++;

1683 i‡(!
	`ëhî_addr_equÆ
(
bss
->
pub
.
bssid
, 
√w
->pub.bssid))

1685 i‡(
bss
->
pub
.
ch™√l
 !
√w
->pub.channel)

1687 i‡(
	`rcu_ac˚ss_poöãr
(
bss
->
pub
.
bóc⁄_õs
))

1689 
õs
 = 
	`rcu_ac˚ss_poöãr
(
bss
->
pub
.ies);

1690 i‡(!
õs
)

1692 
õ
 = 
	`cfg80211_föd_õ
(
WLAN_EID_SSID
, 
õs
->
d©a
, ies->
Àn
);

1693 i‡(!
õ
)

1695 i‡(
ssidÀn
 && 
õ
[1] != ssidlen)

1697 i‡(
	`WARN_ON_ONCE
(
bss
->
pub
.
hiddí_bóc⁄_bss
))

1699 i‡(
	`WARN_ON_ONCE
(!
	`li°_em±y
(&
bss
->
hiddí_li°
)))

1700 
	`li°_dñ
(&
bss
->
hiddí_li°
);

1702 
	`li°_add
(&
bss
->
hiddí_li°
, &
√w
->hidden_list);

1703 
bss
->
pub
.
hiddí_bóc⁄_bss
 = &
√w
->pub;

1704 
√w
->
ªfcou¡
 +
bss
->refcount;

1705 
	`rcu_assign_poöãr
(
bss
->
pub
.
bóc⁄_õs
,

1706 
√w
->
pub
.
bóc⁄_õs
);

1709 
	`WARN_ONCE
(
n_íåõs
 !
rdev
->
bss_íåõs
,

1711 
rdev
->
bss_íåõs
, 
n_íåõs
);

1713  
åue
;

1714 
	}
}

1716 
	$cfg80211_upd©e_hiddí_bs£s
(
cfg80211_öã∫Æ_bss
 *
known
,

1717 c⁄° 
cfg80211_bss_õs
 *
√w_õs
,

1718 c⁄° 
cfg80211_bss_õs
 *
ﬁd_õs
)

1720 
cfg80211_öã∫Æ_bss
 *
bss
;

1723 
	`li°_f‹_óch_íåy
(
bss
, &
known
->
hiddí_li°
, hidden_list) {

1724 c⁄° 
cfg80211_bss_õs
 *
õs
;

1726 
õs
 = 
	`rcu_ac˚ss_poöãr
(
bss
->
pub
.
bóc⁄_õs
);

1727 
	`WARN_ON
(
õs
 !
ﬁd_õs
);

1729 
	`rcu_assign_poöãr
(
bss
->
pub
.
bóc⁄_õs
, 
√w_õs
);

1731 
	}
}

1733 
	$cfg80211_check_°uck_ecß
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1734 
cfg80211_öã∫Æ_bss
 *
known
,

1735 c⁄° 
cfg80211_bss_õs
 *
ﬁd
)

1737 c⁄° 
õì80211_ext_ch™sw_õ
 *
ecß
;

1738 c⁄° 
ñemít
 *
ñem_√w
, *
ñem_ﬁd
;

1739 c⁄° 
cfg80211_bss_õs
 *
√w
, *
b˙
;

1741 i‡(
known
->
pub
.
¥obîe•_ecß_°uck
)

1744 
√w
 = 
	`rcu_dîe„ªn˚_¥Ÿe˘ed
(
known
->
pub
.
¥obîe•_õs
,

1745 
	`lockdï_is_hñd
(&
rdev
->
bss_lock
));

1746 i‡(
	`WARN_ON
(!
√w
))

1749 i‡(
√w
->
tsf
 - 
ﬁd
->ts‡< 
USEC_PER_SEC
)

1752 
ñem_ﬁd
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_EXT_CHANSWITCH_ANN
,

1753 
ﬁd
->
d©a
, old->
Àn
);

1754 i‡(!
ñem_ﬁd
)

1757 
ñem_√w
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_EXT_CHANSWITCH_ANN
,

1758 
√w
->
d©a
,Çew->
Àn
);

1759 i‡(!
ñem_√w
)

1762 
b˙
 = 
	`rcu_dîe„ªn˚_¥Ÿe˘ed
(
known
->
pub
.
bóc⁄_õs
,

1763 
	`lockdï_is_hñd
(&
rdev
->
bss_lock
));

1764 i‡(
b˙
 &&

1765 
	`cfg80211_föd_ñem
(
WLAN_EID_EXT_CHANSWITCH_ANN
,

1766 
b˙
->
d©a
, b˙->
Àn
))

1769 i‡(
ñem_√w
->
d©Æí
 !
ñem_ﬁd
->datalen)

1771 i‡(
ñem_√w
->
d©Æí
 < (
õì80211_ext_ch™sw_õ
))

1773 i‡(
	`memcmp
(
ñem_√w
->
d©a
, 
ñem_ﬁd
->d©a,ÉÀm_√w->
d©Æí
))

1776 
ecß
 = (*)
ñem_√w
->
d©a
;

1778 i‡(!
ecß
->
mode
)

1781 i‡(
ecß
->
√w_ch_num
 !=

1782 
	`õì80211_‰equícy_to_ch™√l
(
known
->
pub
.
ch™√l
->
˚¡î_‰eq
))

1785 
known
->
pub
.
¥obîe•_ecß_°uck
 = 1;

1786 
	}
}

1788 
boﬁ


1789 
	$cfg80211_upd©e_known_bss
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1790 
cfg80211_öã∫Æ_bss
 *
known
,

1791 
cfg80211_öã∫Æ_bss
 *
√w
,

1792 
boﬁ
 
sig«l_vÆid
)

1794 
	`lockdï_as£π_hñd
(&
rdev
->
bss_lock
);

1797 i‡(
	`rcu_ac˚ss_poöãr
(
√w
->
pub
.
¥obîe•_õs
)) {

1798 c⁄° 
cfg80211_bss_õs
 *
ﬁd
;

1800 
ﬁd
 = 
	`rcu_ac˚ss_poöãr
(
known
->
pub
.
¥obîe•_õs
);

1802 
	`rcu_assign_poöãr
(
known
->
pub
.
¥obîe•_õs
,

1803 
√w
->
pub
.
¥obîe•_õs
);

1805 
	`rcu_assign_poöãr
(
known
->
pub
.
õs
,

1806 
√w
->
pub
.
¥obîe•_õs
);

1807 i‡(
ﬁd
) {

1808 
	`cfg80211_check_°uck_ecß
(
rdev
, 
known
, 
ﬁd
);

1809 
	`k‰ì_rcu
((
cfg80211_bss_õs
 *)
ﬁd
, 
rcu_hód
);

1813 i‡(
	`rcu_ac˚ss_poöãr
(
√w
->
pub
.
bóc⁄_õs
)) {

1814 c⁄° 
cfg80211_bss_õs
 *
ﬁd
;

1816 i‡(
known
->
pub
.
hiddí_bóc⁄_bss
 &&

1817 !
	`li°_em±y
(&
known
->
hiddí_li°
)) {

1818 c⁄° 
cfg80211_bss_õs
 *
f
;

1829 
f
 = 
	`rcu_ac˚ss_poöãr
(
√w
->
pub
.
bóc⁄_õs
);

1830 
	`k‰ì_rcu
((
cfg80211_bss_õs
 *)
f
, 
rcu_hód
);

1831  
Ál£
;

1834 
ﬁd
 = 
	`rcu_ac˚ss_poöãr
(
known
->
pub
.
bóc⁄_õs
);

1836 
	`rcu_assign_poöãr
(
known
->
pub
.
bóc⁄_õs
, 
√w
->pub.beacon_ies);

1839 i‡(
ﬁd
 =
	`rcu_ac˚ss_poöãr
(
known
->
pub
.
õs
))

1840 
	`rcu_assign_poöãr
(
known
->
pub
.
õs
, 
√w
->pub.
bóc⁄_õs
);

1842 
	`cfg80211_upd©e_hiddí_bs£s
(
known
,

1843 
	`rcu_ac˚ss_poöãr
(
√w
->
pub
.
bóc⁄_õs
),

1844 
ﬁd
);

1846 i‡(
ﬁd
)

1847 
	`k‰ì_rcu
((
cfg80211_bss_õs
 *)
ﬁd
, 
rcu_hód
);

1850 
known
->
pub
.
bóc⁄_öãrvÆ
 = 
√w
->pub.beacon_interval;

1855 i‡(
sig«l_vÆid
)

1856 
known
->
pub
.
sig«l
 = 
√w
->pub.signal;

1857 
known
->
pub
.
ˇ∑bûôy
 = 
√w
->pub.capability;

1858 
known
->
ts
 = 
√w
->ts;

1859 
known
->
ts_boŸtime
 = 
√w
->ts_boottime;

1860 
known
->
∑ª¡_tsf
 = 
√w
->parent_tsf;

1861 
known
->
pub
.
chaös
 = 
√w
->pub.chains;

1862 
	`mem˝y
(
known
->
pub
.
chaö_sig«l
, 
√w
->pub.chain_signal,

1863 
IEEE80211_MAX_CHAINS
);

1864 
	`ëhî_addr_c›y
(
known
->
∑ª¡_bssid
, 
√w
->parent_bssid);

1865 
known
->
pub
.
max_bssid_ödiˇt‹
 = 
√w
->pub.max_bssid_indicator;

1866 
known
->
pub
.
bssid_ödex
 = 
√w
->pub.bssid_index;

1867 
known
->
pub
.
u£_f‹
 &
√w
->pub.use_for;

1868 
known
->
pub
.
ˇ¬Ÿ_u£_ªas⁄s
 = 
√w
->pub.cannot_use_reasons;

1870  
åue
;

1871 
	}
}

1874 
cfg80211_öã∫Æ_bss
 *

1875 
	$__cfg80211_bss_upd©e
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1876 
cfg80211_öã∫Æ_bss
 *
tmp
,

1877 
boﬁ
 
sig«l_vÆid
, 
ts
)

1879 
cfg80211_öã∫Æ_bss
 *
found
 = 
NULL
;

1880 
cfg80211_bss_õs
 *
õs
;

1882 i‡(
	`WARN_ON
(!
tmp
->
pub
.
ch™√l
))

1883 
‰ì_õs
;

1885 
tmp
->
ts
 =Ås;

1887 i‡(
	`WARN_ON
(!
	`rcu_ac˚ss_poöãr
(
tmp
->
pub
.
õs
)))

1888 
‰ì_õs
;

1890 
found
 = 
	`rb_föd_bss
(
rdev
, 
tmp
, 
BSS_CMP_REGULAR
);

1892 i‡(
found
) {

1893 i‡(!
	`cfg80211_upd©e_known_bss
(
rdev
, 
found
, 
tmp
, 
sig«l_vÆid
))

1894  
NULL
;

1896 
cfg80211_öã∫Æ_bss
 *
√w
;

1897 
cfg80211_öã∫Æ_bss
 *
hiddí
;

1904 
√w
 = 
	`kzÆloc
((*√wË+ 
rdev
->
wùhy
.
bss_¥iv_size
,

1905 
GFP_ATOMIC
);

1906 i‡(!
√w
)

1907 
‰ì_õs
;

1908 
	`mem˝y
(
√w
, 
tmp
, (*new));

1909 
√w
->
ªfcou¡
 = 1;

1910 
	`INIT_LIST_HEAD
(&
√w
->
hiddí_li°
);

1911 
	`INIT_LIST_HEAD
(&
√w
->
pub
.
n⁄å™s_li°
);

1913 
√w
->
pub
.
å™smôãd_bss
 = 
NULL
;

1915 i‡(
	`rcu_ac˚ss_poöãr
(
tmp
->
pub
.
¥obîe•_õs
)) {

1916 
hiddí
 = 
	`rb_föd_bss
(
rdev
, 
tmp
, 
BSS_CMP_HIDE_ZLEN
);

1917 i‡(!
hiddí
)

1918 
hiddí
 = 
	`rb_föd_bss
(
rdev
, 
tmp
,

1919 
BSS_CMP_HIDE_NUL
);

1920 i‡(
hiddí
) {

1921 
√w
->
pub
.
hiddí_bóc⁄_bss
 = &
hiddí
->pub;

1922 
	`li°_add
(&
√w
->
hiddí_li°
,

1923 &
hiddí
->
hiddí_li°
);

1924 
hiddí
->
ªfcou¡
++;

1926 
õs
 = (*)
	`rcu_ac˚ss_poöãr
(
√w
->
pub
.
bóc⁄_õs
);

1927 
	`rcu_assign_poöãr
(
√w
->
pub
.
bóc⁄_õs
,

1928 
hiddí
->
pub
.
bóc⁄_õs
);

1929 i‡(
õs
)

1930 
	`k‰ì_rcu
(
õs
, 
rcu_hód
);

1939 i‡(!
	`cfg80211_comböe_bs£s
(
rdev
, 
√w
)) {

1940 
	`bss_ªf_put
(
rdev
, 
√w
);

1941  
NULL
;

1945 i‡(
rdev
->
bss_íåõs
 >
bss_íåõs_limô
 &&

1946 !
	`cfg80211_bss_expúe_ﬁde°
(
rdev
)) {

1947 
	`bss_ªf_put
(
rdev
, 
√w
);

1948  
NULL
;

1952 i‡(
tmp
->
pub
.
å™smôãd_bss
) {

1953 
√w
->
pub
.
å™smôãd_bss
 = 
tmp
->pub.transmitted_bss;

1954 
	`bss_ªf_gë
(
rdev
, 
	`bss_‰om_pub
(
tmp
->
pub
.
å™smôãd_bss
));

1957 
	`li°_add_èû
(&
√w
->
li°
, &
rdev
->
bss_li°
);

1958 
rdev
->
bss_íåõs
++;

1959 
	`rb_ö£π_bss
(
rdev
, 
√w
);

1960 
found
 = 
√w
;

1963 
rdev
->
bss_gíî©i⁄
++;

1964 
	`bss_ªf_gë
(
rdev
, 
found
);

1966  
found
;

1968 
‰ì_õs
:

1969 
õs
 = (*)
	`rcu_dîe„ªn˚
(
tmp
->
pub
.
bóc⁄_õs
);

1970 i‡(
õs
)

1971 
	`k‰ì_rcu
(
õs
, 
rcu_hód
);

1972 
õs
 = (*)
	`rcu_dîe„ªn˚
(
tmp
->
pub
.
¥obîe•_õs
);

1973 i‡(
õs
)

1974 
	`k‰ì_rcu
(
õs
, 
rcu_hód
);

1976  
NULL
;

1977 
	}
}

1979 
cfg80211_öã∫Æ_bss
 *

1980 
	$cfg80211_bss_upd©e
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1981 
cfg80211_öã∫Æ_bss
 *
tmp
,

1982 
boﬁ
 
sig«l_vÆid
, 
ts
)

1984 
cfg80211_öã∫Æ_bss
 *
ªs
;

1986 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

1987 
ªs
 = 
	`__cfg80211_bss_upd©e
(
rdev
, 
tmp
, 
sig«l_vÆid
, 
ts
);

1988 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

1990  
ªs
;

1991 
	}
}

1993 
	$cfg80211_gë_õs_ch™√l_numbî
(c⁄° 
u8
 *
õ
, 
size_t
 
õÀn
,

1994 
∆80211_b™d
 
b™d
)

1996 c⁄° 
ñemít
 *
tmp
;

1998 i‡(
b™d
 =
NL80211_BAND_6GHZ
) {

1999 
õì80211_he_›î©i⁄
 *
he_›î
;

2001 
tmp
 = 
	`cfg80211_föd_ext_ñem
(
WLAN_EID_EXT_HE_OPERATION
, 
õ
,

2002 
õÀn
);

2003 i‡(
tmp
 &&Åmp->
d©Æí
 >(*
he_›î
) &&

2004 
tmp
->
d©Æí
 >
	`õì80211_he_›î_size
(&tmp->
d©a
[1])) {

2005 c⁄° 
õì80211_he_6ghz_›î
 *
he_6ghz_›î
;

2007 
he_›î
 = (*)&
tmp
->
d©a
[1];

2009 
he_6ghz_›î
 = 
	`õì80211_he_6ghz_›î
(
he_›î
);

2010 i‡(!
he_6ghz_›î
)

2013  
he_6ghz_›î
->
¥im¨y
;

2015 } i‡(
b™d
 =
NL80211_BAND_S1GHZ
) {

2016 
tmp
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_S1G_OPERATION
, 
õ
, 
õÀn
);

2017 i‡(
tmp
 &&Åmp->
d©Æí
 >(
õì80211_s1g_›î_õ
)) {

2018 
õì80211_s1g_›î_õ
 *
s1g›
 = (*)
tmp
->
d©a
;

2020  
s1g›
->
›î_ch
;

2023 
tmp
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_DS_PARAMS
, 
õ
, 
õÀn
);

2024 i‡(
tmp
 &&Åmp->
d©Æí
 == 1)

2025  
tmp
->
d©a
[0];

2027 
tmp
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_HT_OPERATION
, 
õ
, 
õÀn
);

2028 i‡(
tmp
 &&

2029 
tmp
->
d©Æí
 >(
õì80211_ht_›î©i⁄
)) {

2030 
õì80211_ht_›î©i⁄
 *
ht›
 = (*)
tmp
->
d©a
;

2032  
ht›
->
¥im¨y_ch™
;

2037 
	}
}

2038 
EXPORT_SYMBOL
(
cfg80211_gë_õs_ch™√l_numbî
);

2048 
õì80211_ch™√l
 *

2049 
	$cfg80211_gë_bss_ch™√l
(
wùhy
 *wùhy, c⁄° 
u8
 *
õ
, 
size_t
 
õÀn
,

2050 
õì80211_ch™√l
 *
ch™√l
)

2052 
u32
 
‰eq
;

2053 
ch™√l_numbî
;

2054 
õì80211_ch™√l
 *
Æt_ch™√l
;

2056 
ch™√l_numbî
 = 
	`cfg80211_gë_õs_ch™√l_numbî
(
õ
, 
õÀn
,

2057 
ch™√l
->
b™d
);

2059 i‡(
ch™√l_numbî
 < 0) {

2061  
ch™√l
;

2064 
‰eq
 = 
	`õì80211_ch™√l_to_‰eq_khz
(
ch™√l_numbî
, 
ch™√l
->
b™d
);

2070 i‡(
‰eq
 =
	`õì80211_ch™√l_to_khz
(
ch™√l
))

2071  
ch™√l
;

2073 
Æt_ch™√l
 = 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
‰eq
);

2074 i‡(!
Æt_ch™√l
) {

2075 i‡(
ch™√l
->
b™d
 =
NL80211_BAND_2GHZ
 ||

2076 
ch™√l
->
b™d
 =
NL80211_BAND_6GHZ
) {

2083  
NULL
;

2087  
ch™√l
;

2094 i‡(
Æt_ch™√l
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

2095  
NULL
;

2096  
Æt_ch™√l
;

2097 
	}
}

2099 
	scfg80211_öf‹m_sögÀ_bss_d©a
 {

2100 
cfg80211_öf‹m_bss
 *
	mdrv_d©a
;

2101 
cfg80211_bss_‰ame_ty≥
 
	m·y≥
;

2102 
õì80211_ch™√l
 *
	mch™√l
;

2103 
u8
 
	mbssid
[
ETH_ALEN
];

2104 
u64
 
	mtsf
;

2105 
u16
 
	mˇ∑bûôy
;

2106 
u16
 
	mbóc⁄_öãrvÆ
;

2107 c⁄° 
u8
 *
	mõ
;

2108 
size_t
 
	mõÀn
;

2111 
	mBSS_SOURCE_DIRECT
 = 0,

2112 
	mBSS_SOURCE_MBSSID
,

2113 
	mBSS_SOURCE_STA_PROFILE
,

2114 } 
	mbss_sour˚
;

2116 
cfg80211_bss
 *
	msour˚_bss
;

2117 
u8
 
	mmax_bssid_ödiˇt‹
;

2118 
u8
 
	mbssid_ödex
;

2120 
u8
 
	mu£_f‹
;

2121 
u64
 
	mˇ¬Ÿ_u£_ªas⁄s
;

2124 
boﬁ
 
	$cfg80211_6ghz_powî_ty≥_vÆid
(c⁄° 
u8
 *
õ
, 
size_t
 
õÀn
,

2125 c⁄° 
u32
 
Êags
)

2127 c⁄° 
ñemít
 *
tmp
;

2128 
õì80211_he_›î©i⁄
 *
he_›î
;

2130 
tmp
 = 
	`cfg80211_föd_ext_ñem
(
WLAN_EID_EXT_HE_OPERATION
, 
õ
, 
õÀn
);

2131 i‡(
tmp
 &&Åmp->
d©Æí
 >(*
he_›î
) + 1) {

2132 c⁄° 
õì80211_he_6ghz_›î
 *
he_6ghz_›î
;

2134 
he_›î
 = (*)&
tmp
->
d©a
[1];

2135 
he_6ghz_›î
 = 
	`õì80211_he_6ghz_›î
(
he_›î
);

2137 i‡(!
he_6ghz_›î
)

2138  
Ál£
;

2140 
	`u8_gë_bôs
(
he_6ghz_›î
->
c⁄åﬁ
,

2141 
IEEE80211_HE_6GHZ_OPER_CTRL_REG_INFO
)) {

2142 
IEEE80211_6GHZ_CTRL_REG_LPI_AP
:

2143  
åue
;

2144 
IEEE80211_6GHZ_CTRL_REG_SP_AP
:

2145  !(
Êags
 & 
IEEE80211_CHAN_NO_6GHZ_AFC_CLIENT
);

2146 
IEEE80211_6GHZ_CTRL_REG_VLP_AP
:

2147  !(
Êags
 & 
IEEE80211_CHAN_NO_6GHZ_VLP_CLIENT
);

2150  
Ál£
;

2151 
	}
}

2154 
cfg80211_bss
 *

2155 
	$cfg80211_öf‹m_sögÀ_bss_d©a
(
wùhy
 *wiphy,

2156 
cfg80211_öf‹m_sögÀ_bss_d©a
 *
d©a
,

2157 
gÂ_t
 
gÂ
)

2159 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

2160 
cfg80211_öf‹m_bss
 *
drv_d©a
 = 
d©a
->drv_data;

2161 
cfg80211_bss_õs
 *
õs
;

2162 
õì80211_ch™√l
 *
ch™√l
;

2163 
cfg80211_öã∫Æ_bss
 
tmp
 = {}, *
ªs
;

2164 
bss_ty≥
;

2165 
boﬁ
 
sig«l_vÆid
;

2166 
ts
;

2168 i‡(
	`WARN_ON
(!
wùhy
))

2169  
NULL
;

2171 i‡(
	`WARN_ON
(
wùhy
->
sig«l_ty≥
 =
CFG80211_SIGNAL_TYPE_UNSPEC
 &&

2172 (
drv_d©a
->
sig«l
 < 0 || drv_data->signal > 100)))

2173  
NULL
;

2175 i‡(
	`WARN_ON
(
d©a
->
bss_sour˚
 !
BSS_SOURCE_DIRECT
 && !d©a->
sour˚_bss
))

2176  
NULL
;

2178 
ch™√l
 = 
d©a
->channel;

2179 i‡(!
ch™√l
)

2180 
ch™√l
 = 
	`cfg80211_gë_bss_ch™√l
(
wùhy
, 
d©a
->
õ
, d©a->
õÀn
,

2181 
drv_d©a
->
ch™
);

2182 i‡(!
ch™√l
)

2183  
NULL
;

2185 i‡(
ch™√l
->
b™d
 =
NL80211_BAND_6GHZ
 &&

2186 !
	`cfg80211_6ghz_powî_ty≥_vÆid
(
d©a
->
õ
, d©a->
õÀn
,

2187 
ch™√l
->
Êags
)) {

2188 
d©a
->
u£_f‹
 = 0;

2189 
d©a
->
ˇ¬Ÿ_u£_ªas⁄s
 =

2190 
NL80211_BSS_CANNOT_USE_6GHZ_PWR_MISMATCH
;

2193 
	`mem˝y
(
tmp
.
pub
.
bssid
, 
d©a
->bssid, 
ETH_ALEN
);

2194 
tmp
.
pub
.
ch™√l
 = channel;

2195 i‡(
d©a
->
bss_sour˚
 !
BSS_SOURCE_STA_PROFILE
)

2196 
tmp
.
pub
.
sig«l
 = 
drv_d©a
->signal;

2198 
tmp
.
pub
.
sig«l
 = 0;

2199 
tmp
.
pub
.
bóc⁄_öãrvÆ
 = 
d©a
->beacon_interval;

2200 
tmp
.
pub
.
ˇ∑bûôy
 = 
d©a
->capability;

2201 
tmp
.
ts_boŸtime
 = 
drv_d©a
->
boŸtime_ns
;

2202 
tmp
.
∑ª¡_tsf
 = 
drv_d©a
->parent_tsf;

2203 
	`ëhî_addr_c›y
(
tmp
.
∑ª¡_bssid
, 
drv_d©a
->parent_bssid);

2204 
tmp
.
pub
.
chaös
 = 
drv_d©a
->chains;

2205 
	`mem˝y
(
tmp
.
pub
.
chaö_sig«l
, 
drv_d©a
->chain_signal,

2206 
IEEE80211_MAX_CHAINS
);

2207 
tmp
.
pub
.
u£_f‹
 = 
d©a
->use_for;

2208 
tmp
.
pub
.
ˇ¬Ÿ_u£_ªas⁄s
 = 
d©a
->cannot_use_reasons;

2210 i‡(
d©a
->
bss_sour˚
 !
BSS_SOURCE_DIRECT
) {

2211 
tmp
.
pub
.
å™smôãd_bss
 = 
d©a
->
sour˚_bss
;

2212 
ts
 = 
	`bss_‰om_pub
(
d©a
->
sour˚_bss
)->ts;

2213 
tmp
.
pub
.
bssid_ödex
 = 
d©a
->bssid_index;

2214 
tmp
.
pub
.
max_bssid_ödiˇt‹
 = 
d©a
->max_bssid_indicator;

2216 
ts
 = 
jiffõs
;

2218 i‡(
ch™√l
->
b™d
 =
NL80211_BAND_60GHZ
) {

2219 
bss_ty≥
 = 
d©a
->
ˇ∑bûôy
 &

2220 
WLAN_CAPABILITY_DMG_TYPE_MASK
;

2221 i‡(
bss_ty≥
 =
WLAN_CAPABILITY_DMG_TYPE_AP
 ||

2222 
bss_ty≥
 =
WLAN_CAPABILITY_DMG_TYPE_PBSS
)

2223 
	`ªguœt‹y_höt_found_bóc⁄
(
wùhy
, 
ch™√l
,

2224 
gÂ
);

2226 i‡(
d©a
->
ˇ∑bûôy
 & 
WLAN_CAPABILITY_ESS
)

2227 
	`ªguœt‹y_höt_found_bóc⁄
(
wùhy
, 
ch™√l
,

2228 
gÂ
);

2240 
õs
 = 
	`kzÆloc
((*õsË+ 
d©a
->
õÀn
, 
gÂ
);

2241 i‡(!
õs
)

2242  
NULL
;

2243 
õs
->
Àn
 = 
d©a
->
õÀn
;

2244 
õs
->
tsf
 = 
d©a
->tsf;

2245 
õs
->
‰om_bóc⁄
 = 
Ál£
;

2246 
	`mem˝y
(
õs
->
d©a
, d©a->
õ
, d©a->
õÀn
);

2248 
d©a
->
·y≥
) {

2249 
CFG80211_BSS_FTYPE_BEACON
:

2250 
CFG80211_BSS_FTYPE_S1G_BEACON
:

2251 
õs
->
‰om_bóc⁄
 = 
åue
;

2252 
ÁŒthrough
;

2253 
CFG80211_BSS_FTYPE_UNKNOWN
:

2254 
	`rcu_assign_poöãr
(
tmp
.
pub
.
bóc⁄_õs
, 
õs
);

2256 
CFG80211_BSS_FTYPE_PRESP
:

2257 
	`rcu_assign_poöãr
(
tmp
.
pub
.
¥obîe•_õs
, 
õs
);

2260 
	`rcu_assign_poöãr
(
tmp
.
pub
.
õs
, ies);

2262 
sig«l_vÆid
 = 
drv_d©a
->
ch™
 =
ch™√l
;

2263 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

2264 
ªs
 = 
	`__cfg80211_bss_upd©e
(
rdev
, &
tmp
, 
sig«l_vÆid
, 
ts
);

2265 i‡(!
ªs
)

2266 
dr›
;

2268 
	`rdev_öf‹m_bss
(
rdev
, &
ªs
->
pub
, 
õs
, 
drv_d©a
->drv_data);

2270 i‡(
d©a
->
bss_sour˚
 =
BSS_SOURCE_MBSSID
) {

2274 i‡(
	`cfg80211_add_n⁄å™s_li°
(
d©a
->
sour˚_bss
, &
ªs
->
pub
)) {

2275 i‡(
	`__cfg80211_u∆ök_bss
(
rdev
, 
ªs
)) {

2276 
rdev
->
bss_gíî©i⁄
++;

2277 
ªs
 = 
NULL
;

2281 i‡(!
ªs
)

2282 
dr›
;

2284 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

2286 
	`åa˚_cfg80211_ªtu∫_bss
(&
ªs
->
pub
);

2288  &
ªs
->
pub
;

2290 
dr›
:

2291 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

2292  
NULL
;

2293 
	}
}

2295 c⁄° 
ñemít


2296 *
	$cfg80211_gë_¥ofûe_c⁄töu©i⁄
(c⁄° 
u8
 *
õ
, 
size_t
 
õÀn
,

2297 c⁄° 
ñemít
 *
mbssid_ñem
,

2298 c⁄° 
ñemít
 *
sub_ñem
)

2300 c⁄° 
u8
 *
mbssid_íd
 = 
mbssid_ñem
->
d©a
 + mbssid_ñem->
d©Æí
;

2301 c⁄° 
ñemít
 *
√xt_mbssid
;

2302 c⁄° 
ñemít
 *
√xt_sub
;

2304 
√xt_mbssid
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_MULTIPLE_BSSID
,

2305 
mbssid_íd
,

2306 
õÀn
 - (
mbssid_íd
 - 
õ
));

2312 i‡((
sub_ñem
->
d©a
 + sub_ñem->
d©Æí
 < 
mbssid_íd
 - 1) ||

2313 !
√xt_mbssid
)

2314  
NULL
;

2318 i‡(
√xt_mbssid
->
d©Æí
 < 4)

2319  
NULL
;

2321 
√xt_sub
 = (*)&
√xt_mbssid
->
d©a
[1];

2323 i‡(
√xt_mbssid
->
d©a
 +Çext_mbssid->
d©Æí
 <

2324 
√xt_sub
->
d©a
 +Çext_sub->
d©Æí
)

2325  
NULL
;

2327 i‡(
√xt_sub
->
id
 !0 ||Çext_sub->
d©Æí
 < 2)

2328  
NULL
;

2334  
√xt_sub
->
d©a
[0] =
WLAN_EID_NON_TX_BSSID_CAP
 ?

2335 
NULL
 : 
√xt_mbssid
;

2336 
	}
}

2338 
size_t
 
	$cfg80211_mîge_¥ofûe
(c⁄° 
u8
 *
õ
, 
size_t
 
õÀn
,

2339 c⁄° 
ñemít
 *
mbssid_ñem
,

2340 c⁄° 
ñemít
 *
sub_ñem
,

2341 
u8
 *
mîged_õ
, 
size_t
 
max_c›y_Àn
)

2343 
size_t
 
c›õd_Àn
 = 
sub_ñem
->
d©Æí
;

2344 c⁄° 
ñemít
 *
√xt_mbssid
;

2346 i‡(
sub_ñem
->
d©Æí
 > 
max_c›y_Àn
)

2349 
	`mem˝y
(
mîged_õ
, 
sub_ñem
->
d©a
, sub_ñem->
d©Æí
);

2351 (
√xt_mbssid
 = 
	`cfg80211_gë_¥ofûe_c⁄töu©i⁄
(
õ
, 
õÀn
,

2352 
mbssid_ñem
,

2353 
sub_ñem
))) {

2354 c⁄° 
ñemít
 *
√xt_sub
 = (*)&
√xt_mbssid
->
d©a
[1];

2356 i‡(
c›õd_Àn
 + 
√xt_sub
->
d©Æí
 > 
max_c›y_Àn
)

2358 
	`mem˝y
(
mîged_õ
 + 
c›õd_Àn
, 
√xt_sub
->
d©a
,

2359 
√xt_sub
->
d©Æí
);

2360 
c›õd_Àn
 +
√xt_sub
->
d©Æí
;

2363  
c›õd_Àn
;

2364 
	}
}

2365 
EXPORT_SYMBOL
(
cfg80211_mîge_¥ofûe
);

2368 
	$cfg80211_∑r£_mbssid_d©a
(
wùhy
 *wiphy,

2369 
cfg80211_öf‹m_sögÀ_bss_d©a
 *
tx_d©a
,

2370 
cfg80211_bss
 *
sour˚_bss
,

2371 
gÂ_t
 
gÂ
)

2373 
cfg80211_öf‹m_sögÀ_bss_d©a
 
d©a
 = {

2374 .
drv_d©a
 = 
tx_d©a
->drv_data,

2375 .
·y≥
 = 
tx_d©a
->ftype,

2376 .
tsf
 = 
tx_d©a
->tsf,

2377 .
bóc⁄_öãrvÆ
 = 
tx_d©a
->beacon_interval,

2378 .
sour˚_bss
 = source_bss,

2379 .
bss_sour˚
 = 
BSS_SOURCE_MBSSID
,

2380 .
u£_f‹
 = 
tx_d©a
->use_for,

2381 .
ˇ¬Ÿ_u£_ªas⁄s
 = 
tx_d©a
->cannot_use_reasons,

2383 c⁄° 
u8
 *
mbssid_ödex_õ
;

2384 c⁄° 
ñemít
 *
ñem
, *
sub
;

2385 
u8
 *
√w_õ
, *
¥ofûe
;

2386 
u64
 
£í_ödi˚s
 = 0;

2387 
cfg80211_bss
 *
bss
;

2389 i‡(!
sour˚_bss
)

2391 i‡(!
	`cfg80211_föd_ñem
(
WLAN_EID_MULTIPLE_BSSID
,

2392 
tx_d©a
->
õ
,Åx_d©a->
õÀn
))

2394 i‡(!
wùhy
->
suµ‹t_mbssid
)

2396 i‡(
wùhy
->
suµ‹t_⁄ly_he_mbssid
 &&

2397 !
	`cfg80211_föd_ext_ñem
(
WLAN_EID_EXT_HE_CAPABILITY
,

2398 
tx_d©a
->
õ
,Åx_d©a->
õÀn
))

2401 
√w_õ
 = 
	`kmÆloc
(
IEEE80211_MAX_DATA_LEN
, 
gÂ
);

2402 i‡(!
√w_õ
)

2405 
¥ofûe
 = 
	`kmÆloc
(
tx_d©a
->
õÀn
, 
gÂ
);

2406 i‡(!
¥ofûe
)

2407 
out
;

2409 
	`f‹_óch_ñemít_id
(
ñem
, 
WLAN_EID_MULTIPLE_BSSID
,

2410 
tx_d©a
->
õ
,Åx_d©a->
õÀn
) {

2411 i‡(
ñem
->
d©Æí
 < 4)

2413 i‡(
ñem
->
d©a
[0] < 1 || ()elem->data[0] > 8)

2415 
	`f‹_óch_ñemít
(
sub
, 
ñem
->
d©a
 + 1,ÉÀm->
d©Æí
 - 1) {

2416 
u8
 
¥ofûe_Àn
;

2418 i‡(
sub
->
id
 !0 || sub->
d©Æí
 < 4) {

2423 i‡(
sub
->
d©a
[0] !
WLAN_EID_NON_TX_BSSID_CAP
 ||

2424 
sub
->
d©a
[1] != 2) {

2432 
	`mem£t
(
¥ofûe
, 0, 
tx_d©a
->
õÀn
);

2433 
¥ofûe_Àn
 = 
	`cfg80211_mîge_¥ofûe
(
tx_d©a
->
õ
,

2434 
tx_d©a
->
õÀn
,

2435 
ñem
,

2436 
sub
,

2437 
¥ofûe
,

2438 
tx_d©a
->
õÀn
);

2441 
mbssid_ödex_õ
 = 
cfg80211_föd_õ


2442 (
WLAN_EID_MULTI_BSSID_IDX
,

2443 
¥ofûe
, 
¥ofûe_Àn
);

2444 i‡(!
mbssid_ödex_õ
 || mbssid_index_ie[1] < 1 ||

2445 
mbssid_ödex_õ
[2] == 0 ||

2446 
mbssid_ödex_õ
[2] > 46) {

2451 i‡(
£í_ödi˚s
 & 
	`BIT_ULL
(
mbssid_ödex_õ
[2]))

2453 
	`√t_dbg_øãlimôed
("Partial info for BSSID index %d\n",

2454 
mbssid_ödex_õ
[2]);

2456 
£í_ödi˚s
 |
	`BIT_ULL
(
mbssid_ödex_õ
[2]);

2458 
d©a
.
bssid_ödex
 = 
mbssid_ödex_õ
[2];

2459 
d©a
.
max_bssid_ödiˇt‹
 = 
ñem
->data[0];

2461 
	`cfg80211_gí_√w_bssid
(
tx_d©a
->
bssid
,

2462 
d©a
.
max_bssid_ödiˇt‹
,

2463 
d©a
.
bssid_ödex
,

2464 
d©a
.
bssid
);

2466 
	`mem£t
(
√w_õ
, 0, 
IEEE80211_MAX_DATA_LEN
);

2467 
d©a
.
õ
 = 
√w_õ
;

2468 
d©a
.
õÀn
 = 
	`cfg80211_gí_√w_õ
(
tx_d©a
->
õ
,

2469 
tx_d©a
->
õÀn
,

2470 
¥ofûe
,

2471 
¥ofûe_Àn
,

2472 
√w_õ
,

2473 
IEEE80211_MAX_DATA_LEN
);

2474 i‡(!
d©a
.
õÀn
)

2477 
d©a
.
ˇ∑bûôy
 = 
	`gë_u«lig√d_À16
(
¥ofûe
 + 2);

2478 
bss
 = 
	`cfg80211_öf‹m_sögÀ_bss_d©a
(
wùhy
, &
d©a
, 
gÂ
);

2479 i‡(!
bss
)

2481 
	`cfg80211_put_bss
(
wùhy
, 
bss
);

2485 
out
:

2486 
	`k‰ì
(
√w_õ
);

2487 
	`k‰ì
(
¥ofûe
);

2488 
	}
}

2490 
ssize_t
 
	$cfg80211_de‰agmít_ñemít
(c⁄° 
ñemít
 *
ñem
, c⁄° 
u8
 *
õs
,

2491 
size_t
 
õ¶í
, 
u8
 *
d©a
, size_à
d©a_Àn
,

2492 
u8
 
‰ag_id
)

2494 c⁄° 
ñemít
 *
√xt
;

2495 
ssize_t
 
c›õd
;

2496 
u8
 
ñem_d©Æí
;

2498 i‡(!
ñem
)

2499  -
EINVAL
;

2502 
√xt
 = (*)(
ñem
->
d©a
 +ÉÀm->
d©Æí
);

2503 
ñem_d©Æí
 = 
ñem
->
d©Æí
;

2505 i‡(
ñem
->
id
 =
WLAN_EID_EXTENSION
) {

2506 
c›õd
 = 
ñem
->
d©Æí
 - 1;

2508 i‡(
d©a
) {

2509 i‡(
c›õd
 > 
d©a_Àn
)

2510  -
ENOSPC
;

2512 
	`memmove
(
d©a
, 
ñem
->d©®+ 1, 
c›õd
);

2515 
c›õd
 = 
ñem
->
d©Æí
;

2517 i‡(
d©a
) {

2518 i‡(
c›õd
 > 
d©a_Àn
)

2519  -
ENOSPC
;

2521 
	`memmove
(
d©a
, 
ñem
->d©a, 
c›õd
);

2526 i‡(
ñem_d©Æí
 < 255)

2527  
c›õd
;

2529 
ñem
 = 
√xt
;

2530 
ñem
->
d©a
 < 
õs
 + 
õ¶í
 &&

2531 
ñem
->
d©a
 +ÉÀm->
d©Æí
 <
õs
 + 
õ¶í
;

2532 
ñem
 = 
√xt
) {

2534 
√xt
 = (*)(
ñem
->
d©a
 +ÉÀm->
d©Æí
);

2536 i‡(
ñem
->
id
 !
‰ag_id
)

2539 
ñem_d©Æí
 = 
ñem
->
d©Æí
;

2541 i‡(
d©a
) {

2542 i‡(
c›õd
 + 
ñem_d©Æí
 > 
d©a_Àn
)

2543  -
ENOSPC
;

2545 
	`memmove
(
d©a
 + 
c›õd
, 
ñem
->d©a, 
ñem_d©Æí
);

2548 
c›õd
 +
ñem_d©Æí
;

2551 i‡(
ñem_d©Æí
 != 255)

2555  
c›õd
;

2556 
	}
}

2557 
EXPORT_SYMBOL
(
cfg80211_de‰agmít_ñemít
);

2559 
	scfg80211_mÀ
 {

2560 
õì80211_mu…i_lök_ñem
 *
	mmÀ
;

2561 
õì80211_mÀ_≥r_°a_¥ofûe


2562 *
	m°a_¥of
[
IEEE80211_MLD_MAX_NUM_LINKS
];

2563 
ssize_t
 
	m°a_¥of_Àn
[
IEEE80211_MLD_MAX_NUM_LINKS
];

2565 
u8
 
	md©a
[];

2568 
cfg80211_mÀ
 *

2569 
	$cfg80211_de‰ag_mÀ
(c⁄° 
ñemít
 *
mÀ
, c⁄° 
u8
 *
õ
, 
size_t
 
õÀn
,

2570 
gÂ_t
 
gÂ
)

2572 c⁄° 
ñemít
 *
ñem
;

2573 
cfg80211_mÀ
 *
ªs
;

2574 
size_t
 
buf_Àn
;

2575 
ssize_t
 
mÀ_Àn
;

2576 
u8
 
comm⁄_size
, 
idx
;

2578 i‡(!
mÀ
 || !
	`õì80211_mÀ_size_ok
(mÀ->
d©a
 + 1, mÀ->
d©Æí
 - 1))

2579  
NULL
;

2582 
buf_Àn
 = 
mÀ
->
d©Æí
 - 1;

2583 
	`f‹_óch_ñemít
(
ñem
, 
mÀ
->
d©a
 + mÀ->
d©Æí
,

2584 
õÀn
 - (*
mÀ
Ë+ mÀ->
d©Æí
) {

2585 i‡(
ñem
->
id
 !
WLAN_EID_FRAGMENT
)

2588 
buf_Àn
 +
ñem
->
d©Æí
;

2591 
ªs
 = 
	`kzÆloc
(
	`°ru˘_size
‘es, 
d©a
, 
buf_Àn
), 
gÂ
);

2592 i‡(!
ªs
)

2593  
NULL
;

2595 
mÀ_Àn
 = 
	`cfg80211_de‰agmít_ñemít
(
mÀ
, 
õ
, 
õÀn
,

2596 
ªs
->
d©a
, 
buf_Àn
,

2597 
WLAN_EID_FRAGMENT
);

2598 i‡(
mÀ_Àn
 < 0)

2599 
îr‹
;

2601 
ªs
->
mÀ
 = (*Ïes->
d©a
;

2604 
comm⁄_size
 = 
	`õì80211_mÀ_comm⁄_size
((
u8
 *)
ªs
->
mÀ
);

2605 
õ
 = 
ªs
->
d©a
 + 
comm⁄_size
;

2606 
õÀn
 = 
mÀ_Àn
 - 
comm⁄_size
;

2608 
idx
 = 0;

2609 
	`f‹_óch_ñemít_id
(
ñem
, 
IEEE80211_MLE_SUBELEM_PER_STA_PROFILE
,

2610 
õ
, 
õÀn
) {

2611 
ªs
->
°a_¥of
[
idx
] = (*)
ñem
->
d©a
;

2612 
ªs
->
°a_¥of_Àn
[
idx
] = 
ñem
->
d©Æí
;

2614 
idx
++;

2615 i‡(
idx
 >
IEEE80211_MLD_MAX_NUM_LINKS
)

2618 i‡(!
	`f‹_óch_ñemít_com∂ëed
(
ñem
, 
õ
, 
õÀn
))

2619 
îr‹
;

2622 
idx
 = 0; idx < 
IEEE80211_MLD_MAX_NUM_LINKS
 && 
ªs
->
°a_¥of
[idx];

2623 
idx
++) {

2624 i‡(
ªs
->
°a_¥of_Àn
[
idx
] < 255)

2627 
ñem
 = (*)
ªs
->
°a_¥of
[
idx
] - 2;

2629 i‡(
idx
 + 1 < 
	`ARRAY_SIZE
(
ªs
->
°a_¥of
) &&

2630 
ªs
->
°a_¥of
[
idx
 + 1])

2631 
buf_Àn
 = (
u8
 *)
ªs
->
°a_¥of
[
idx
 + 1] -

2632 (
u8
 *)
ªs
->
°a_¥of
[
idx
];

2634 
buf_Àn
 = 
õÀn
 + 
õ
 - (
u8
 *)
ñem
;

2636 
ªs
->
°a_¥of_Àn
[
idx
] =

2637 
	`cfg80211_de‰agmít_ñemít
(
ñem
,

2638 (
u8
 *)
ñem
, 
buf_Àn
,

2639 (
u8
 *)
ªs
->
°a_¥of
[
idx
],

2640 
buf_Àn
,

2641 
IEEE80211_MLE_SUBELEM_FRAGMENT
);

2642 i‡(
ªs
->
°a_¥of_Àn
[
idx
] < 0)

2643 
îr‹
;

2646  
ªs
;

2648 
îr‹
:

2649 
	`k‰ì
(
ªs
);

2650  
NULL
;

2651 
	}
}

2653 
	stbâ_öfo_ôî_d©a
 {

2654 c⁄° 
õì80211_√ighb‹_≠_öfo
 *
	m≠_öfo
;

2655 
u8
 
	m∑øm_ch_cou¡
;

2656 
u32
 
	mu£_f‹
;

2657 
u8
 
	mmld_id
, 
	mlök_id
;

2660 
cfg80211_∫r_ôî_ªt


2661 
	$cfg802121_mld_≠_∫r_ôî
(*
_d©a
, 
u8
 
ty≥
,

2662 c⁄° 
õì80211_√ighb‹_≠_öfo
 *
öfo
,

2663 c⁄° 
u8
 *
tbâ_öfo
, u8 
tbâ_öfo_Àn
)

2665 c⁄° 
õì80211_∫r_mld_∑øms
 *
mld_∑øms
;

2666 
tbâ_öfo_ôî_d©a
 *
d©a
 = 
_d©a
;

2667 
u8
 
lök_id
;

2669 i‡(
ty≥
 =
IEEE80211_TBTT_INFO_TYPE_TBTT
 &&

2670 
tbâ_öfo_Àn
 >
	`off£to„nd
(
õì80211_tbâ_öfo_ge_11
,

2671 
mld_∑øms
))

2672 
mld_∑øms
 = (*)(
tbâ_öfo
 +

2673 
	`off£tof
(
õì80211_tbâ_öfo_ge_11
,

2674 
mld_∑øms
));

2675 i‡(
ty≥
 =
IEEE80211_TBTT_INFO_TYPE_MLD
 &&

2676 
tbâ_öfo_Àn
 >(
õì80211_∫r_mld_∑øms
))

2677 
mld_∑øms
 = (*)
tbâ_öfo
;

2679  
RNR_ITER_CONTINUE
;

2681 
lök_id
 = 
	`À16_gë_bôs
(
mld_∑øms
->
∑øms
,

2682 
IEEE80211_RNR_MLD_PARAMS_LINK_ID
);

2684 i‡(
d©a
->
mld_id
 !
mld_∑øms
->mld_id)

2685  
RNR_ITER_CONTINUE
;

2687 i‡(
d©a
->
lök_id
 !=Üink_id)

2688  
RNR_ITER_CONTINUE
;

2690 
d©a
->
≠_öfo
 = 
öfo
;

2691 
d©a
->
∑øm_ch_cou¡
 =

2692 
	`À16_gë_bôs
(
mld_∑øms
->
∑øms
,

2693 
IEEE80211_RNR_MLD_PARAMS_BSS_CHANGE_COUNT
);

2695 i‡(
ty≥
 =
IEEE80211_TBTT_INFO_TYPE_TBTT
)

2696 
d©a
->
u£_f‹
 = 
NL80211_BSS_USE_FOR_ALL
;

2698 
d©a
->
u£_f‹
 = 
NL80211_BSS_USE_FOR_MLD_LINK
;

2699  
RNR_ITER_BREAK
;

2700 
	}
}

2702 
u8


2703 
	$cfg80211_∫r_öfo_f‹_mld_≠
(c⁄° 
u8
 *
õ
, 
size_t
 
õÀn
, u8 
mld_id
, u8 
lök_id
,

2704 c⁄° 
õì80211_√ighb‹_≠_öfo
 **
≠_öfo
,

2705 
u8
 *
∑øm_ch_cou¡
)

2707 
tbâ_öfo_ôî_d©a
 
d©a
 = {

2708 .
mld_id
 = mld_id,

2709 .
lök_id
 =Üink_id,

2712 
	`cfg80211_ôî_∫r
(
õ
, 
õÀn
, 
cfg802121_mld_≠_∫r_ôî
, &
d©a
);

2714 *
≠_öfo
 = 
d©a
.ap_info;

2715 *
∑øm_ch_cou¡
 = 
d©a
.param_ch_count;

2717  
d©a
.
u£_f‹
;

2718 
	}
}

2720 
ñemít
 *

2721 
	$cfg80211_gí_ªp‹ãr_∫r
(
cfg80211_bss
 *
sour˚_bss
, 
boﬁ
 
is_mbssid
,

2722 
boﬁ
 
ßme_mld
, 
u8
 
lök_id
, u8 
bss_ch™ge_cou¡
,

2723 
gÂ_t
 
gÂ
)

2725 c⁄° 
cfg80211_bss_õs
 *
õs
;

2726 
õì80211_√ighb‹_≠_öfo
 
≠_öfo
;

2727 
õì80211_tbâ_öfo_ge_11
 
tbâ_öfo
;

2728 
u32
 
sh‹t_ssid
;

2729 c⁄° 
ñemít
 *
ñem
;

2730 
ñemít
 *
ªs
;

2737 i‡(!
ßme_mld
)

2738  
NULL
;

2741 
	`rcu_ªad_lock
();

2742 
õs
 = 
	`rcu_dîe„ªn˚
(
sour˚_bss
->ies);

2744 
≠_öfo
.
tbâ_öfo_Àn
 = 
	`off£to„nd
(
	`ty≥of
(
tbâ_öfo
), 
mld_∑øms
);

2745 
≠_öfo
.
tbâ_öfo_hdr
 =

2746 
	`u8_ícode_bôs
(
IEEE80211_TBTT_INFO_TYPE_TBTT
,

2747 
IEEE80211_AP_INFO_TBTT_HDR_TYPE
) |

2748 
	`u8_ícode_bôs
(0, 
IEEE80211_AP_INFO_TBTT_HDR_COUNT
);

2750 
≠_öfo
.
ch™√l
 = 
	`õì80211_‰equícy_to_ch™√l
(
sour˚_bss
->ch™√l->
˚¡î_‰eq
);

2753 
ñem
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_SUPPORTED_REGULATORY_CLASSES
,

2754 
õs
->
d©a
, ies->
Àn
);

2755 i‡(
ñem
 &&ÉÀm->
d©Æí
 >= 1) {

2756 
≠_öfo
.
›_˛ass
 = 
ñem
->
d©a
[0];

2758 
cfg80211_ch™_def
 
ch™def
;

2765 
	`cfg80211_ch™def_¸óã
(&
ch™def
, 
sour˚_bss
->
ch™√l
,

2766 
NL80211_CHAN_NO_HT
);

2768 i‡(!
	`õì80211_ch™def_to_›î©ög_˛ass
(&
ch™def
,

2769 &
≠_öfo
.
›_˛ass
))

2770 
out_u∆ock
;

2774 
tbâ_öfo
.
tbâ_off£t
 = 255;

2775 
tbâ_öfo
.
psd_20
 = 
IEEE80211_RNR_TBTT_PARAMS_PSD_RESERVED
;

2777 
	`mem˝y
(
tbâ_öfo
.
bssid
, 
sour˚_bss
->bssid, 
ETH_ALEN
);

2778 i‡(
	`cfg80211_ˇlc_sh‹t_ssid
(
õs
, &
ñem
, &
sh‹t_ssid
))

2779 
out_u∆ock
;

2781 
	`rcu_ªad_u∆ock
();

2783 
tbâ_öfo
.
sh‹t_ssid
 = 
	`˝u_to_À32
(short_ssid);

2785 
tbâ_öfo
.
bss_∑øms
 = 
IEEE80211_RNR_TBTT_PARAMS_SAME_SSID
;

2787 i‡(
is_mbssid
) {

2788 
tbâ_öfo
.
bss_∑øms
 |
IEEE80211_RNR_TBTT_PARAMS_MULTI_BSSID
;

2789 
tbâ_öfo
.
bss_∑øms
 |
IEEE80211_RNR_TBTT_PARAMS_TRANSMITTED_BSSID
;

2792 
tbâ_öfo
.
mld_∑øms
.
mld_id
 = 0;

2793 
tbâ_öfo
.
mld_∑øms
.
∑øms
 =

2794 
	`À16_ícode_bôs
(
lök_id
, 
IEEE80211_RNR_MLD_PARAMS_LINK_ID
) |

2795 
	`À16_ícode_bôs
(
bss_ch™ge_cou¡
,

2796 
IEEE80211_RNR_MLD_PARAMS_BSS_CHANGE_COUNT
);

2798 
ªs
 = 
	`kzÆloc
(
	`°ru˘_size
‘es, 
d©a
,

2799 (
≠_öfo
Ë+áp_öfo.
tbâ_öfo_Àn
),

2800 
gÂ
);

2801 i‡(!
ªs
)

2802  
NULL
;

2805 
ªs
->
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
;

2806 
ªs
->
d©Æí
 = (
≠_öfo
Ë+áp_öfo.
tbâ_öfo_Àn
;

2807 
	`mem˝y
(
ªs
->
d©a
, &
≠_öfo
, (ap_info));

2808 
	`mem˝y
(
ªs
->
d©a
 + (
≠_öfo
), &
tbâ_öfo
,áp_öfo.
tbâ_öfo_Àn
);

2810  
ªs
;

2812 
out_u∆ock
:

2813 
	`rcu_ªad_u∆ock
();

2814  
NULL
;

2815 
	}
}

2818 
	$cfg80211_∑r£_ml_ñem_°a_d©a
(
wùhy
 *wiphy,

2819 
cfg80211_öf‹m_sögÀ_bss_d©a
 *
tx_d©a
,

2820 
cfg80211_bss
 *
sour˚_bss
,

2821 c⁄° 
ñemít
 *
ñem
,

2822 
gÂ_t
 
gÂ
)

2824 
cfg80211_öf‹m_sögÀ_bss_d©a
 
d©a
 = {

2825 .
drv_d©a
 = 
tx_d©a
->drv_data,

2826 .
·y≥
 = 
tx_d©a
->ftype,

2827 .
sour˚_bss
 = source_bss,

2828 .
bss_sour˚
 = 
BSS_SOURCE_STA_PROFILE
,

2830 
ñemít
 *
ªp‹ãr_∫r
 = 
NULL
;

2831 
õì80211_mu…i_lök_ñem
 *
ml_ñem
;

2832 
cfg80211_mÀ
 *
mÀ
;

2833 
u16
 
c⁄åﬁ
;

2834 
u8
 
ml_comm⁄_Àn
;

2835 
u8
 *
√w_õ
 = 
NULL
;

2836 
cfg80211_bss
 *
bss
;

2837 
u8
 
mld_id
, 
ªp‹ãr_lök_id
, 
bss_ch™ge_cou¡
;

2838 
u16
 
£í_löks
 = 0;

2839 
u8
 
i
;

2841 i‡(!
	`õì80211_mÀ_ty≥_ok
(
ñem
->
d©a
 + 1,

2842 
IEEE80211_ML_CONTROL_TYPE_BASIC
,

2843 
ñem
->
d©Æí
 - 1))

2846 
ml_ñem
 = (*)(
ñem
->
d©a
 + 1);

2847 
c⁄åﬁ
 = 
	`À16_to_˝u
(
ml_ñem
->control);

2848 
ml_comm⁄_Àn
 = 
ml_ñem
->
v¨übÀ
[0];

2851 i‡(!(
c⁄åﬁ
 & 
IEEE80211_MLC_BASIC_PRES_BSS_PARAM_CH_CNT
) ||

2852 !(
c⁄åﬁ
 & 
IEEE80211_MLC_BASIC_PRES_LINK_ID
) ||

2853 !(
c⁄åﬁ
 & 
IEEE80211_MLC_BASIC_PRES_MLD_CAPA_OP
))

2856 
ªp‹ãr_lök_id
 = 
	`õì80211_mÀ_gë_lök_id
(
ñem
->
d©a
 + 1);

2857 
bss_ch™ge_cou¡
 = 
	`õì80211_mÀ_gë_bss_∑øm_ch_˙t
(
ñem
->
d©a
 + 1);

2865 
mld_id
 = 
	`õì80211_mÀ_gë_mld_id
(
ñem
->
d©a
 + 1);

2868 
mÀ
 = 
	`cfg80211_de‰ag_mÀ
(
ñem
, 
tx_d©a
->
õ
,Åx_d©a->
õÀn
, 
gÂ
);

2869 i‡(!
mÀ
)

2873 i‡(!
mÀ
->
°a_¥of
[0])

2874 
out
;

2876 
√w_õ
 = 
	`kmÆloc
(
IEEE80211_MAX_DATA_LEN
, 
gÂ
);

2877 i‡(!
√w_õ
)

2878 
out
;

2880 
ªp‹ãr_∫r
 = 
	`cfg80211_gí_ªp‹ãr_∫r
(
sour˚_bss
,

2881 
	`u16_gë_bôs
(
c⁄åﬁ
,

2882 
IEEE80211_MLC_BASIC_PRES_MLD_ID
),

2883 
mld_id
 =0, 
ªp‹ãr_lök_id
,

2884 
bss_ch™ge_cou¡
,

2885 
gÂ
);

2887 
i
 = 0; i < 
	`ARRAY_SIZE
(
mÀ
->
°a_¥of
) && mle->sta_prof[i]; i++) {

2888 c⁄° 
õì80211_√ighb‹_≠_öfo
 *
≠_öfo
;

2889 
∆80211_b™d
 
b™d
;

2890 
u32
 
‰eq
;

2891 c⁄° 
u8
 *
¥ofûe
;

2892 
ssize_t
 
¥ofûe_Àn
;

2893 
u8
 
∑øm_ch_cou¡
;

2894 
u8
 
lök_id
, 
u£_f‹
;

2896 i‡(!
	`õì80211_mÀ_basic_°a_¥of_size_ok
((
u8
 *)
mÀ
->
°a_¥of
[
i
],

2897 
mÀ
->
°a_¥of_Àn
[
i
]))

2900 
c⁄åﬁ
 = 
	`À16_to_˝u
(
mÀ
->
°a_¥of
[
i
]->control);

2902 i‡(!(
c⁄åﬁ
 & 
IEEE80211_MLE_STA_CONTROL_COMPLETE_PROFILE
))

2905 
lök_id
 = 
	`u16_gë_bôs
(
c⁄åﬁ
,

2906 
IEEE80211_MLE_STA_CONTROL_LINK_ID
);

2907 i‡(
£í_löks
 & 
	`BIT
(
lök_id
))

2909 
£í_löks
 |
	`BIT
(
lök_id
);

2911 i‡(!(
c⁄åﬁ
 & 
IEEE80211_MLE_STA_CONTROL_BEACON_INT_PRESENT
) ||

2912 !(
c⁄åﬁ
 & 
IEEE80211_MLE_STA_CONTROL_TSF_OFFS_PRESENT
) ||

2913 !(
c⁄åﬁ
 & 
IEEE80211_MLE_STA_CONTROL_STA_MAC_ADDR_PRESENT
))

2916 
	`mem˝y
(
d©a
.
bssid
, 
mÀ
->
°a_¥of
[
i
]->
v¨übÀ
, 
ETH_ALEN
);

2917 
d©a
.
bóc⁄_öãrvÆ
 =

2918 
	`gë_u«lig√d_À16
(
mÀ
->
°a_¥of
[
i
]->
v¨übÀ
 + 6);

2919 
d©a
.
tsf
 = 
tx_d©a
->tsf +

2920 
	`gë_u«lig√d_À64
(
mÀ
->
°a_¥of
[
i
]->
v¨übÀ
 + 8);

2923 
¥ofûe
 = 
mÀ
->
°a_¥of
[
i
]->
v¨übÀ
 +

2924 
mÀ
->
°a_¥of
[
i
]->
°a_öfo_Àn
 - 1;

2925 
¥ofûe_Àn
 = (
u8
 *)
mÀ
->
°a_¥of
[
i
] + mÀ->
°a_¥of_Àn
[i] -

2926 
¥ofûe
;

2928 i‡(
¥ofûe_Àn
 < 2)

2931 
d©a
.
ˇ∑bûôy
 = 
	`gë_u«lig√d_À16
(
¥ofûe
);

2932 
¥ofûe
 += 2;

2933 
¥ofûe_Àn
 -= 2;

2936 
u£_f‹
 = 
	`cfg80211_∫r_öfo_f‹_mld_≠
(
tx_d©a
->
õ
,

2937 
tx_d©a
->
õÀn
,

2938 
mld_id
, 
lök_id
,

2939 &
≠_öfo
,

2940 &
∑øm_ch_cou¡
);

2941 i‡(!
u£_f‹
)

2946 i‡(!
	`õì80211_›î©ög_˛ass_to_b™d
(
≠_öfo
->
›_˛ass
,

2947 &
b™d
))

2950 
‰eq
 = 
	`õì80211_ch™√l_to_‰eq_khz
(
≠_öfo
->
ch™√l
, 
b™d
);

2951 
d©a
.
ch™√l
 = 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
‰eq
);

2953 i‡(
u£_f‹
 =
NL80211_BSS_USE_FOR_MLD_LINK
 &&

2954 !(
wùhy
->
Êags
 & 
WIPHY_FLAG_SUPPORTS_NSTR_NONPRIMARY
)) {

2955 
u£_f‹
 = 0;

2956 
d©a
.
ˇ¬Ÿ_u£_ªas⁄s
 =

2957 
NL80211_BSS_CANNOT_USE_NSTR_NONPRIMARY
;

2959 
d©a
.
u£_f‹
 = use_for;

2962 
	`mem£t
(
√w_õ
, 0, 
IEEE80211_MAX_DATA_LEN
);

2963 
d©a
.
õ
 = 
√w_õ
;

2964 
d©a
.
õÀn
 = 
	`cfg80211_gí_√w_õ
(
tx_d©a
->
õ
,Åx_data->ielen,

2965 
¥ofûe
, 
¥ofûe_Àn
,

2966 
√w_õ
,

2967 
IEEE80211_MAX_DATA_LEN
);

2968 i‡(!
d©a
.
õÀn
)

2978 i‡(
d©a
.
õÀn
 + 3 + (*
ml_ñem
Ë+ 
ml_comm⁄_Àn
 >

2979 
IEEE80211_MAX_DATA_LEN
)

2988 
√w_õ
[
d©a
.
õÀn
++] = 
WLAN_EID_EXTENSION
;

2989 
√w_õ
[
d©a
.
õÀn
++] = 1 + (*
ml_ñem
Ë+ 
ml_comm⁄_Àn
;

2990 
√w_õ
[
d©a
.
õÀn
++] = 
WLAN_EID_EXT_EHT_MULTI_LINK
;

2991 
	`mem˝y
(
√w_õ
 + 
d©a
.
õÀn
, 
ml_ñem
,

2992 (*
ml_ñem
Ë+ 
ml_comm⁄_Àn
);

2994 
√w_õ
[
d©a
.
õÀn
 + (*
ml_ñem
Ë+ 1 + 
ETH_ALEN
] = 
lök_id
;

2995 
√w_õ
[
d©a
.
õÀn
 + (*
ml_ñem
Ë+ 1 + 
ETH_ALEN
 + 1] =

2996 
∑øm_ch_cou¡
;

2998 
d©a
.
õÀn
 +(*
ml_ñem
Ë+ 
ml_comm⁄_Àn
;

3000 i‡(
ªp‹ãr_∫r
 && (
u£_f‹
 & 
NL80211_BSS_USE_FOR_NORMAL
)) {

3001 i‡(
d©a
.
õÀn
 + (
ñemít
) +

3002 
ªp‹ãr_∫r
->
d©Æí
 > 
IEEE80211_MAX_DATA_LEN
)

3005 
	`mem˝y
(
√w_õ
 + 
d©a
.
õÀn
, 
ªp‹ãr_∫r
,

3006 (
ñemít
Ë+ 
ªp‹ãr_∫r
->
d©Æí
);

3007 
d©a
.
õÀn
 +(
ñemít
) +

3008 
ªp‹ãr_∫r
->
d©Æí
;

3011 
bss
 = 
	`cfg80211_öf‹m_sögÀ_bss_d©a
(
wùhy
, &
d©a
, 
gÂ
);

3012 i‡(!
bss
)

3014 
	`cfg80211_put_bss
(
wùhy
, 
bss
);

3017 
out
:

3018 
	`k‰ì
(
ªp‹ãr_∫r
);

3019 
	`k‰ì
(
√w_õ
);

3020 
	`k‰ì
(
mÀ
);

3021 
	}
}

3023 
	$cfg80211_∑r£_ml_°a_d©a
(
wùhy
 *wiphy,

3024 
cfg80211_öf‹m_sögÀ_bss_d©a
 *
tx_d©a
,

3025 
cfg80211_bss
 *
sour˚_bss
,

3026 
gÂ_t
 
gÂ
)

3028 c⁄° 
ñemít
 *
ñem
;

3030 i‡(!
sour˚_bss
)

3033 i‡(
tx_d©a
->
·y≥
 !
CFG80211_BSS_FTYPE_PRESP
)

3036 
	`f‹_óch_ñemít_extid
(
ñem
, 
WLAN_EID_EXT_EHT_MULTI_LINK
,

3037 
tx_d©a
->
õ
,Åx_d©a->
õÀn
)

3038 
	`cfg80211_∑r£_ml_ñem_°a_d©a
(
wùhy
, 
tx_d©a
, 
sour˚_bss
,

3039 
ñem
, 
gÂ
);

3040 
	}
}

3042 
cfg80211_bss
 *

3043 
	$cfg80211_öf‹m_bss_d©a
(
wùhy
 *wiphy,

3044 
cfg80211_öf‹m_bss
 *
d©a
,

3045 
cfg80211_bss_‰ame_ty≥
 
·y≥
,

3046 c⁄° 
u8
 *
bssid
, 
u64
 
tsf
, 
u16
 
ˇ∑bûôy
,

3047 
u16
 
bóc⁄_öãrvÆ
, c⁄° 
u8
 *
õ
, 
size_t
 
õÀn
,

3048 
gÂ_t
 
gÂ
)

3050 
cfg80211_öf‹m_sögÀ_bss_d©a
 
öf‹m_d©a
 = {

3051 .
drv_d©a
 = 
d©a
,

3052 .
·y≥
 = ftype,

3053 .
tsf
 =Åsf,

3054 .
ˇ∑bûôy
 = capability,

3055 .
bóc⁄_öãrvÆ
 = beacon_interval,

3056 .
õ
 = ie,

3057 .
õÀn
 = ielen,

3058 .
u£_f‹
 = 
d©a
->
ª°ri˘_u£
 ?

3059 
d©a
->
u£_f‹
 :

3060 
NL80211_BSS_USE_FOR_ALL
,

3061 .
ˇ¬Ÿ_u£_ªas⁄s
 = 
d©a
->cannot_use_reasons,

3063 
cfg80211_bss
 *
ªs
;

3065 
	`mem˝y
(
öf‹m_d©a
.
bssid
, bssid, 
ETH_ALEN
);

3067 
ªs
 = 
	`cfg80211_öf‹m_sögÀ_bss_d©a
(
wùhy
, &
öf‹m_d©a
, 
gÂ
);

3068 i‡(!
ªs
)

3069  
NULL
;

3072 i‡(
·y≥
 =
CFG80211_BSS_FTYPE_S1G_BEACON
)

3073  
ªs
;

3075 
	`cfg80211_∑r£_mbssid_d©a
(
wùhy
, &
öf‹m_d©a
, 
ªs
, 
gÂ
);

3077 
	`cfg80211_∑r£_ml_°a_d©a
(
wùhy
, &
öf‹m_d©a
, 
ªs
, 
gÂ
);

3079  
ªs
;

3080 
	}
}

3081 
EXPORT_SYMBOL
(
cfg80211_öf‹m_bss_d©a
);

3083 
cfg80211_bss
 *

3084 
	$cfg80211_öf‹m_bss_‰ame_d©a
(
wùhy
 *wiphy,

3085 
cfg80211_öf‹m_bss
 *
d©a
,

3086 
õì80211_mgmt
 *
mgmt
, 
size_t
 
Àn
,

3087 
gÂ_t
 
gÂ
)

3089 
size_t
 
mö_hdr_Àn
 = 
	`off£tof
(
õì80211_mgmt
,

3090 
u
.
¥obe_ª•
.
v¨übÀ
);

3091 
õì80211_ext
 *
ext
 = 
NULL
;

3092 
cfg80211_bss_‰ame_ty≥
 
·y≥
;

3093 
u16
 
bóc⁄_öãrvÆ
;

3094 c⁄° 
u8
 *
bssid
;

3095 
u16
 
ˇ∑bûôy
;

3096 c⁄° 
u8
 *
õ
;

3097 
size_t
 
õÀn
;

3098 
u64
 
tsf
;

3100 i‡(
	`WARN_ON
(!
mgmt
))

3101  
NULL
;

3103 i‡(
	`WARN_ON
(!
wùhy
))

3104  
NULL
;

3106 
	`BUILD_BUG_ON
(
	`off£tof
(
õì80211_mgmt
, 
u
.
¥obe_ª•
.
v¨übÀ
) !=

3107 
	`off£tof
(
õì80211_mgmt
, 
u
.
bóc⁄
.
v¨übÀ
));

3109 
	`åa˚_cfg80211_öf‹m_bss_‰ame
(
wùhy
, 
d©a
, 
mgmt
, 
Àn
);

3111 i‡(
	`õì80211_is_s1g_bóc⁄
(
mgmt
->
‰ame_c⁄åﬁ
)) {

3112 
ext
 = (*Ë
mgmt
;

3113 
mö_hdr_Àn
 = 
	`off£tof
(
õì80211_ext
, 
u
.
s1g_bóc⁄
);

3114 i‡(
	`õì80211_is_s1g_sh‹t_bóc⁄
(
mgmt
->
‰ame_c⁄åﬁ
))

3115 
mö_hdr_Àn
 = 
	`off£tof
(
õì80211_ext
,

3116 
u
.
s1g_sh‹t_bóc⁄
.
v¨übÀ
);

3119 i‡(
	`WARN_ON
(
Àn
 < 
mö_hdr_Àn
))

3120  
NULL
;

3122 
õÀn
 = 
Àn
 - 
mö_hdr_Àn
;

3123 
õ
 = 
mgmt
->
u
.
¥obe_ª•
.
v¨übÀ
;

3124 i‡(
ext
) {

3125 c⁄° 
õì80211_s1g_b˙_com∑t_õ
 *
com∑t
;

3126 c⁄° 
ñemít
 *
ñem
;

3128 i‡(
	`õì80211_is_s1g_sh‹t_bóc⁄
(
mgmt
->
‰ame_c⁄åﬁ
))

3129 
õ
 = 
ext
->
u
.
s1g_sh‹t_bóc⁄
.
v¨übÀ
;

3131 
õ
 = 
ext
->
u
.
s1g_bóc⁄
.
v¨übÀ
;

3133 
ñem
 = 
	`cfg80211_föd_ñem
(
WLAN_EID_S1G_BCN_COMPAT
, 
õ
, 
õÀn
);

3134 i‡(!
ñem
)

3135  
NULL
;

3136 i‡(
ñem
->
d©Æí
 < (*
com∑t
))

3137  
NULL
;

3138 
com∑t
 = (*)
ñem
->
d©a
;

3139 
bssid
 = 
ext
->
u
.
s1g_bóc⁄
.
ß
;

3140 
ˇ∑bûôy
 = 
	`À16_to_˝u
(
com∑t
->
com∑t_öfo
);

3141 
bóc⁄_öãrvÆ
 = 
	`À16_to_˝u
(
com∑t
->
bóc⁄_öt
);

3143 
bssid
 = 
mgmt
->bssid;

3144 
bóc⁄_öãrvÆ
 = 
	`À16_to_˝u
(
mgmt
->
u
.
¥obe_ª•
.
bóc⁄_öt
);

3145 
ˇ∑bûôy
 = 
	`À16_to_˝u
(
mgmt
->
u
.
¥obe_ª•
.
ˇ∑b_öfo
);

3148 
tsf
 = 
	`À64_to_˝u
(
mgmt
->
u
.
¥obe_ª•
.
time°amp
);

3150 i‡(
	`õì80211_is_¥obe_ª•
(
mgmt
->
‰ame_c⁄åﬁ
))

3151 
·y≥
 = 
CFG80211_BSS_FTYPE_PRESP
;

3152 i‡(
ext
)

3153 
·y≥
 = 
CFG80211_BSS_FTYPE_S1G_BEACON
;

3155 
·y≥
 = 
CFG80211_BSS_FTYPE_BEACON
;

3157  
	`cfg80211_öf‹m_bss_d©a
(
wùhy
, 
d©a
, 
·y≥
,

3158 
bssid
, 
tsf
, 
ˇ∑bûôy
,

3159 
bóc⁄_öãrvÆ
, 
õ
, 
õÀn
,

3160 
gÂ
);

3161 
	}
}

3162 
EXPORT_SYMBOL
(
cfg80211_öf‹m_bss_‰ame_d©a
);

3164 
	$cfg80211_ªf_bss
(
wùhy
 *wùhy, 
cfg80211_bss
 *
pub
)

3166 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

3168 i‡(!
pub
)

3171 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

3172 
	`bss_ªf_gë
(
rdev
, 
	`bss_‰om_pub
(
pub
));

3173 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

3174 
	}
}

3175 
EXPORT_SYMBOL
(
cfg80211_ªf_bss
);

3177 
	$cfg80211_put_bss
(
wùhy
 *wùhy, 
cfg80211_bss
 *
pub
)

3179 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

3181 i‡(!
pub
)

3184 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

3185 
	`bss_ªf_put
(
rdev
, 
	`bss_‰om_pub
(
pub
));

3186 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

3187 
	}
}

3188 
EXPORT_SYMBOL
(
cfg80211_put_bss
);

3190 
	$cfg80211_u∆ök_bss
(
wùhy
 *wùhy, 
cfg80211_bss
 *
pub
)

3192 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

3193 
cfg80211_öã∫Æ_bss
 *
bss
, *
tmp1
;

3194 
cfg80211_bss
 *
n⁄å™s_bss
, *
tmp
;

3196 i‡(
	`WARN_ON
(!
pub
))

3199 
bss
 = 
	`bss_‰om_pub
(
pub
);

3201 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

3202 i‡(
	`li°_em±y
(&
bss
->
li°
))

3203 
out
;

3205 
	`li°_f‹_óch_íåy_ß„
(
n⁄å™s_bss
, 
tmp
,

3206 &
pub
->
n⁄å™s_li°
,

3207 
n⁄å™s_li°
) {

3208 
tmp1
 = 
	`bss_‰om_pub
(
n⁄å™s_bss
);

3209 i‡(
	`__cfg80211_u∆ök_bss
(
rdev
, 
tmp1
))

3210 
rdev
->
bss_gíî©i⁄
++;

3213 i‡(
	`__cfg80211_u∆ök_bss
(
rdev
, 
bss
))

3214 
rdev
->
bss_gíî©i⁄
++;

3215 
out
:

3216 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

3217 
	}
}

3218 
EXPORT_SYMBOL
(
cfg80211_u∆ök_bss
);

3220 
	$cfg80211_bss_ôî
(
wùhy
 *wiphy,

3221 
cfg80211_ch™_def
 *
ch™def
,

3222 (*
ôî
)(
wùhy
 *wiphy,

3223 
cfg80211_bss
 *
bss
,

3224 *
d©a
),

3225 *
ôî_d©a
)

3227 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

3228 
cfg80211_öã∫Æ_bss
 *
bss
;

3230 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

3232 
	`li°_f‹_óch_íåy
(
bss
, &
rdev
->
bss_li°
, 
li°
) {

3233 i‡(!
ch™def
 || 
	`cfg80211_is_sub_ch™
(ch™def, 
bss
->
pub
.
ch™√l
,

3234 
Ál£
))

3235 
	`ôî
(
wùhy
, &
bss
->
pub
, 
ôî_d©a
);

3238 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

3239 
	}
}

3240 
EXPORT_SYMBOL
(
cfg80211_bss_ôî
);

3242 
	$cfg80211_upd©e_assoc_bss_íåy
(
wúñess_dev
 *
wdev
,

3243 
lök_id
,

3244 
õì80211_ch™√l
 *
ch™
)

3246 
wùhy
 *wùhy = 
wdev
->wiphy;

3247 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

3248 
cfg80211_öã∫Æ_bss
 *
cbss
 = 
wdev
->
löks
[
lök_id
].
˛õ¡
.
cuºít_bss
;

3249 
cfg80211_öã∫Æ_bss
 *
√w
 = 
NULL
;

3250 
cfg80211_öã∫Æ_bss
 *
bss
;

3251 
cfg80211_bss
 *
n⁄å™s_bss
;

3252 
cfg80211_bss
 *
tmp
;

3254 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

3260 i‡(
cbss
->
pub
.
ch™√l
 =
ch™
)

3261 
d⁄e
;

3264 i‡(
cbss
->
pub
.
å™smôãd_bss
)

3265 
cbss
 = 
	`bss_‰om_pub
(cbss->
pub
.
å™smôãd_bss
);

3267 
cbss
->
pub
.
ch™√l
 = 
ch™
;

3269 
	`li°_f‹_óch_íåy
(
bss
, &
rdev
->
bss_li°
, 
li°
) {

3270 i‡(!
	`cfg80211_bss_ty≥_m©ch
(
bss
->
pub
.
ˇ∑bûôy
,

3271 
bss
->
pub
.
ch™√l
->
b™d
,

3272 
wdev
->
c⁄n_bss_ty≥
))

3275 i‡(
bss
 =
cbss
)

3278 i‡(!
	`cmp_bss
(&
bss
->
pub
, &
cbss
->pub, 
BSS_CMP_REGULAR
)) {

3279 
√w
 = 
bss
;

3284 i‡(
√w
) {

3286 
	`cfg80211_upd©e_known_bss
(
rdev
, 
cbss
, 
√w
, 
Ál£
);

3287 
√w
->
pub
.
¥obîe•_õs
 = 
NULL
;

3288 
√w
->
pub
.
bóc⁄_õs
 = 
NULL
;

3290 
	`li°_f‹_óch_íåy_ß„
(
n⁄å™s_bss
, 
tmp
,

3291 &
√w
->
pub
.
n⁄å™s_li°
,

3292 
n⁄å™s_li°
) {

3293 
bss
 = 
	`bss_‰om_pub
(
n⁄å™s_bss
);

3294 i‡(
	`__cfg80211_u∆ök_bss
(
rdev
, 
bss
))

3295 
rdev
->
bss_gíî©i⁄
++;

3298 
	`WARN_ON
(
	`©omic_ªad
(&
√w
->
hﬁd
));

3299 i‡(!
	`WARN_ON
(!
	`__cfg80211_u∆ök_bss
(
rdev
, 
√w
)))

3300 
rdev
->
bss_gíî©i⁄
++;

3303 
	`rb_îa£
(&
cbss
->
rbn
, &
rdev
->
bss_åì
);

3304 
	`rb_ö£π_bss
(
rdev
, 
cbss
);

3305 
rdev
->
bss_gíî©i⁄
++;

3307 
	`li°_f‹_óch_íåy_ß„
(
n⁄å™s_bss
, 
tmp
,

3308 &
cbss
->
pub
.
n⁄å™s_li°
,

3309 
n⁄å™s_li°
) {

3310 
bss
 = 
	`bss_‰om_pub
(
n⁄å™s_bss
);

3311 
bss
->
pub
.
ch™√l
 = 
ch™
;

3312 
	`rb_îa£
(&
bss
->
rbn
, &
rdev
->
bss_åì
);

3313 
	`rb_ö£π_bss
(
rdev
, 
bss
);

3314 
rdev
->
bss_gíî©i⁄
++;

3317 
d⁄e
:

3318 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

3319 
	}
}

3321 #ifde‡
CONFIG_CFG80211_WEXT


3322 
cfg80211_ªgi°îed_devi˚
 *

3323 
	$cfg80211_gë_dev_‰om_ifödex
(
√t
 *√t, 
ifödex
)

3325 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3326 
√t_devi˚
 *
dev
;

3328 
	`ASSERT_RTNL
();

3330 
dev
 = 
	`dev_gë_by_ödex
(
√t
, 
ifödex
);

3331 i‡(!
dev
)

3332  
	`ERR_PTR
(-
ENODEV
);

3333 i‡(
dev
->
õì80211_±r
)

3334 
rdev
 = 
	`wùhy_to_rdev
(
dev
->
õì80211_±r
->
wùhy
);

3336 
rdev
 = 
	`ERR_PTR
(-
ENODEV
);

3337 
	`dev_put
(
dev
);

3338  
rdev
;

3339 
	}
}

3341 
	$cfg80211_wext_siwsˇn
(
√t_devi˚
 *
dev
,

3342 
iw_ªque°_öfo
 *
öfo
,

3343 
iwªq_d©a
 *
wrqu
, *
exåa
)

3345 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3346 
wùhy
 *wiphy;

3347 
iw_sˇn_ªq
 *
wªq
 = 
NULL
;

3348 
cfg80211_sˇn_ªque°
 *
¸eq
;

3349 
i
, 
îr
, 
n_ch™√ls
 = 0;

3350 
∆80211_b™d
 
b™d
;

3352 i‡(!
	`√tif_ru¬ög
(
dev
))

3353  -
ENETDOWN
;

3355 i‡(
wrqu
->
d©a
.
Àngth
 =(
iw_sˇn_ªq
))

3356 
wªq
 = (
iw_sˇn_ªq
 *)
exåa
;

3358 
rdev
 = 
	`cfg80211_gë_dev_‰om_ifödex
(
	`dev_√t
(
dev
), dev->
ifödex
);

3360 i‡(
	`IS_ERR
(
rdev
))

3361  
	`PTR_ERR
(
rdev
);

3363 i‡(
rdev
->
sˇn_ªq
 ||Ñdev->
sˇn_msg
)

3364  -
EBUSY
;

3366 
wùhy
 = &
rdev
->wiphy;

3369 i‡(
wªq
 && wªq->
num_ch™√ls
)

3370 
n_ch™√ls
 = 
wªq
->
num_ch™√ls
;

3372 
n_ch™√ls
 = 
	`õì80211_gë_num_suµ‹ãd_ch™√ls
(
wùhy
);

3374 
¸eq
 = 
	`kzÆloc
((*¸eqË+ (
cfg80211_ssid
) +

3375 
n_ch™√ls
 * (*),

3376 
GFP_ATOMIC
);

3377 i‡(!
¸eq
)

3378  -
ENOMEM
;

3380 
¸eq
->
wùhy
 = wiphy;

3381 
¸eq
->
wdev
 = 
dev
->
õì80211_±r
;

3383 
¸eq
->
ssids
 = (*)&¸eq->
ch™√ls
[
n_ch™√ls
];

3384 
¸eq
->
n_ch™√ls
 =Ç_channels;

3385 
¸eq
->
n_ssids
 = 1;

3386 
¸eq
->
sˇn_°¨t
 = 
jiffõs
;

3389 
i
 = 0;

3390 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

3391 
j
;

3393 i‡(!
wùhy
->
b™ds
[
b™d
])

3396 
j
 = 0; j < 
wùhy
->
b™ds
[
b™d
]->
n_ch™√ls
; j++) {

3398 i‡(
wùhy
->
b™ds
[
b™d
]->
ch™√ls
[
j
].
Êags
 &

3399 
IEEE80211_CHAN_DISABLED
)

3406 i‡(
wªq
 && wªq->
num_ch™√ls
) {

3407 
k
;

3408 
wùhy_‰eq
 = 
wùhy
->
b™ds
[
b™d
]->
ch™√ls
[
j
].
˚¡î_‰eq
;

3409 
k
 = 0; k < 
wªq
->
num_ch™√ls
; k++) {

3410 
iw_‰eq
 *
‰eq
 =

3411 &
wªq
->
ch™√l_li°
[
k
];

3412 
wext_‰eq
 =

3413 
	`cfg80211_wext_‰eq
(
‰eq
);

3415 i‡(
wext_‰eq
 =
wùhy_‰eq
)

3416 
wext_‰eq_found
;

3418 
wext_‰eq_nŸ_found
;

3421 
wext_‰eq_found
:

3422 
¸eq
->
ch™√ls
[
i
] = &
wùhy
->
b™ds
[
b™d
]->ch™√ls[
j
];

3423 
i
++;

3424 
wext_‰eq_nŸ_found
: ;

3428 i‡(!
i
) {

3429 
îr
 = -
EINVAL
;

3430 
out
;

3434 
¸eq
->
n_ch™√ls
 = 
i
;

3437 i‡(
wªq
) {

3438 i‡(
wrqu
->
d©a
.
Êags
 & 
IW_SCAN_THIS_ESSID
) {

3439 i‡(
wªq
->
essid_Àn
 > 
IEEE80211_MAX_SSID_LEN
) {

3440 
îr
 = -
EINVAL
;

3441 
out
;

3443 
	`mem˝y
(
¸eq
->
ssids
[0].
ssid
, 
wªq
->
essid
, wªq->
essid_Àn
);

3444 
¸eq
->
ssids
[0].
ssid_Àn
 = 
wªq
->
essid_Àn
;

3446 i‡(
wªq
->
sˇn_ty≥
 =
IW_SCAN_TYPE_PASSIVE
)

3447 
¸eq
->
n_ssids
 = 0;

3450 
i
 = 0; i < 
NUM_NL80211_BANDS
; i++)

3451 i‡(
wùhy
->
b™ds
[
i
])

3452 
¸eq
->
øãs
[
i
] = (1 << 
wùhy
->
b™ds
[i]->
n_bôøãs
) - 1;

3454 
	`ëh_brﬂdˇ°_addr
(
¸eq
->
bssid
);

3456 
	`wùhy_lock
(&
rdev
->
wùhy
);

3458 
rdev
->
sˇn_ªq
 = 
¸eq
;

3459 
îr
 = 
	`rdev_sˇn
(
rdev
, 
¸eq
);

3460 i‡(
îr
) {

3461 
rdev
->
sˇn_ªq
 = 
NULL
;

3464 
	`∆80211_£nd_sˇn_°¨t
(
rdev
, 
dev
->
õì80211_±r
);

3466 
¸eq
 = 
NULL
;

3467 
	`dev_hﬁd
(
dev
);

3469 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

3470 
out
:

3471 
	`k‰ì
(
¸eq
);

3472  
îr
;

3473 
	}
}

3474 
EXPORT_WEXT_HANDLER
(
cfg80211_wext_siwsˇn
);

3476 *
	$õì80211_sˇn_add_õs
(
iw_ªque°_öfo
 *
öfo
,

3477 c⁄° 
cfg80211_bss_õs
 *
õs
,

3478 *
cuºít_ev
, *
íd_buf
)

3480 c⁄° 
u8
 *
pos
, *
íd
, *
√xt
;

3481 
iw_evít
 
iwe
;

3483 i‡(!
õs
)

3484  
cuºít_ev
;

3490 
pos
 = 
õs
->
d©a
;

3491 
íd
 = 
pos
 + 
õs
->
Àn
;

3493 
íd
 - 
pos
 > 
IW_GENERIC_IE_MAX
) {

3494 
√xt
 = 
pos
 + 2 +Öos[1];

3495 
√xt
 + 2 +Çext[1] - 
pos
 < 
IW_GENERIC_IE_MAX
)

3496 
√xt
 =Çext + 2 +Çext[1];

3498 
	`mem£t
(&
iwe
, 0, (iwe));

3499 
iwe
.
cmd
 = 
IWEVGENIE
;

3500 
iwe
.
u
.
d©a
.
Àngth
 = 
√xt
 - 
pos
;

3501 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
, current_ev,

3502 
íd_buf
, &
iwe
,

3503 (*)
pos
);

3504 i‡(
	`IS_ERR
(
cuºít_ev
))

3505  
cuºít_ev
;

3506 
pos
 = 
√xt
;

3509 i‡(
íd
 > 
pos
) {

3510 
	`mem£t
(&
iwe
, 0, (iwe));

3511 
iwe
.
cmd
 = 
IWEVGENIE
;

3512 
iwe
.
u
.
d©a
.
Àngth
 = 
íd
 - 
pos
;

3513 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
, current_ev,

3514 
íd_buf
, &
iwe
,

3515 (*)
pos
);

3516 i‡(
	`IS_ERR
(
cuºít_ev
))

3517  
cuºít_ev
;

3520  
cuºít_ev
;

3521 
	}
}

3524 
	$õì80211_bss
(
wùhy
 *wùhy, 
iw_ªque°_öfo
 *
öfo
,

3525 
cfg80211_öã∫Æ_bss
 *
bss
, *
cuºít_ev
,

3526 *
íd_buf
)

3528 c⁄° 
cfg80211_bss_õs
 *
õs
;

3529 
iw_evít
 
iwe
;

3530 c⁄° 
u8
 *
õ
;

3531 
u8
 
buf
[50];

3532 
u8
 *
cfg
, *
p
, *
tmp
;

3533 
ªm
, 
i
, 
sig
;

3534 
boﬁ
 
ismesh
 = 
Ál£
;

3536 
	`mem£t
(&
iwe
, 0, (iwe));

3537 
iwe
.
cmd
 = 
SIOCGIWAP
;

3538 
iwe
.
u
.
≠_addr
.
ß_Ámûy
 = 
ARPHRD_ETHER
;

3539 
	`mem˝y
(
iwe
.
u
.
≠_addr
.
ß_d©a
, 
bss
->
pub
.
bssid
, 
ETH_ALEN
);

3540 
cuºít_ev
 = 
	`iwe_°ªam_add_evít_check
(
öfo
, cuºít_ev, 
íd_buf
, &
iwe
,

3541 
IW_EV_ADDR_LEN
);

3542 i‡(
	`IS_ERR
(
cuºít_ev
))

3543  
cuºít_ev
;

3545 
	`mem£t
(&
iwe
, 0, (iwe));

3546 
iwe
.
cmd
 = 
SIOCGIWFREQ
;

3547 
iwe
.
u
.
‰eq
.
m
 = 
	`õì80211_‰equícy_to_ch™√l
(
bss
->
pub
.
ch™√l
->
˚¡î_‰eq
);

3548 
iwe
.
u
.
‰eq
.
e
 = 0;

3549 
cuºít_ev
 = 
	`iwe_°ªam_add_evít_check
(
öfo
, cuºít_ev, 
íd_buf
, &
iwe
,

3550 
IW_EV_FREQ_LEN
);

3551 i‡(
	`IS_ERR
(
cuºít_ev
))

3552  
cuºít_ev
;

3554 
	`mem£t
(&
iwe
, 0, (iwe));

3555 
iwe
.
cmd
 = 
SIOCGIWFREQ
;

3556 
iwe
.
u
.
‰eq
.
m
 = 
bss
->
pub
.
ch™√l
->
˚¡î_‰eq
;

3557 
iwe
.
u
.
‰eq
.
e
 = 6;

3558 
cuºít_ev
 = 
	`iwe_°ªam_add_evít_check
(
öfo
, cuºít_ev, 
íd_buf
, &
iwe
,

3559 
IW_EV_FREQ_LEN
);

3560 i‡(
	`IS_ERR
(
cuºít_ev
))

3561  
cuºít_ev
;

3563 i‡(
wùhy
->
sig«l_ty≥
 !
CFG80211_SIGNAL_TYPE_NONE
) {

3564 
	`mem£t
(&
iwe
, 0, (iwe));

3565 
iwe
.
cmd
 = 
IWEVQUAL
;

3566 
iwe
.
u
.
quÆ
.
upd©ed
 = 
IW_QUAL_LEVEL_UPDATED
 |

3567 
IW_QUAL_NOISE_INVALID
 |

3568 
IW_QUAL_QUAL_UPDATED
;

3569 
wùhy
->
sig«l_ty≥
) {

3570 
CFG80211_SIGNAL_TYPE_MBM
:

3571 
sig
 = 
bss
->
pub
.
sig«l
 / 100;

3572 
iwe
.
u
.
quÆ
.
Àvñ
 = 
sig
;

3573 
iwe
.
u
.
quÆ
.
upd©ed
 |
IW_QUAL_DBM
;

3574 i‡(
sig
 < -110)

3575 
sig
 = -110;

3576 i‡(
sig
 > -40)

3577 
sig
 = -40;

3579 
iwe
.
u
.
quÆ
.quÆ = 
sig
 + 110;

3581 
CFG80211_SIGNAL_TYPE_UNSPEC
:

3582 
iwe
.
u
.
quÆ
.
Àvñ
 = 
bss
->
pub
.
sig«l
;

3584 
iwe
.
u
.
quÆ
.quÆ = 
bss
->
pub
.
sig«l
;

3590 
cuºít_ev
 = 
	`iwe_°ªam_add_evít_check
(
öfo
, current_ev,

3591 
íd_buf
, &
iwe
,

3592 
IW_EV_QUAL_LEN
);

3593 i‡(
	`IS_ERR
(
cuºít_ev
))

3594  
cuºít_ev
;

3597 
	`mem£t
(&
iwe
, 0, (iwe));

3598 
iwe
.
cmd
 = 
SIOCGIWENCODE
;

3599 i‡(
bss
->
pub
.
ˇ∑bûôy
 & 
WLAN_CAPABILITY_PRIVACY
)

3600 
iwe
.
u
.
d©a
.
Êags
 = 
IW_ENCODE_ENABLED
 | 
IW_ENCODE_NOKEY
;

3602 
iwe
.
u
.
d©a
.
Êags
 = 
IW_ENCODE_DISABLED
;

3603 
iwe
.
u
.
d©a
.
Àngth
 = 0;

3604 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
, cuºít_ev, 
íd_buf
,

3605 &
iwe
, "");

3606 i‡(
	`IS_ERR
(
cuºít_ev
))

3607  
cuºít_ev
;

3609 
	`rcu_ªad_lock
();

3610 
õs
 = 
	`rcu_dîe„ªn˚
(
bss
->
pub
.ies);

3611 
ªm
 = 
õs
->
Àn
;

3612 
õ
 = 
õs
->
d©a
;

3614 
ªm
 >= 2) {

3616 i‡(
õ
[1] > 
ªm
 - 2)

3619 
õ
[0]) {

3620 
WLAN_EID_SSID
:

3621 
	`mem£t
(&
iwe
, 0, (iwe));

3622 
iwe
.
cmd
 = 
SIOCGIWESSID
;

3623 
iwe
.
u
.
d©a
.
Àngth
 = 
õ
[1];

3624 
iwe
.
u
.
d©a
.
Êags
 = 1;

3625 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
,

3626 
cuºít_ev
,

3627 
íd_buf
, &
iwe
,

3628 (
u8
 *)
õ
 + 2);

3629 i‡(
	`IS_ERR
(
cuºít_ev
))

3630 
u∆ock
;

3632 
WLAN_EID_MESH_ID
:

3633 
	`mem£t
(&
iwe
, 0, (iwe));

3634 
iwe
.
cmd
 = 
SIOCGIWESSID
;

3635 
iwe
.
u
.
d©a
.
Àngth
 = 
õ
[1];

3636 
iwe
.
u
.
d©a
.
Êags
 = 1;

3637 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
,

3638 
cuºít_ev
,

3639 
íd_buf
, &
iwe
,

3640 (
u8
 *)
õ
 + 2);

3641 i‡(
	`IS_ERR
(
cuºít_ev
))

3642 
u∆ock
;

3644 
WLAN_EID_MESH_CONFIG
:

3645 
ismesh
 = 
åue
;

3646 i‡(
õ
[1] !(
õì80211_meshc⁄f_õ
))

3648 
cfg
 = (
u8
 *)
õ
 + 2;

3649 
	`mem£t
(&
iwe
, 0, (iwe));

3650 
iwe
.
cmd
 = 
IWEVCUSTOM
;

3651 
iwe
.
u
.
d©a
.
Àngth
 = 
	`•rötf
(
buf
,

3653 
cfg
[0]);

3654 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
,

3655 
cuºít_ev
,

3656 
íd_buf
,

3657 &
iwe
, 
buf
);

3658 i‡(
	`IS_ERR
(
cuºít_ev
))

3659 
u∆ock
;

3660 
iwe
.
u
.
d©a
.
Àngth
 = 
	`•rötf
(
buf
,

3662 
cfg
[1]);

3663 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
,

3664 
cuºít_ev
,

3665 
íd_buf
,

3666 &
iwe
, 
buf
);

3667 i‡(
	`IS_ERR
(
cuºít_ev
))

3668 
u∆ock
;

3669 
iwe
.
u
.
d©a
.
Àngth
 = 
	`•rötf
(
buf
,

3671 
cfg
[2]);

3672 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
,

3673 
cuºít_ev
,

3674 
íd_buf
,

3675 &
iwe
, 
buf
);

3676 i‡(
	`IS_ERR
(
cuºít_ev
))

3677 
u∆ock
;

3678 
iwe
.
u
.
d©a
.
Àngth
 = 
	`•rötf
(
buf
,

3680 
cfg
[3]);

3681 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
,

3682 
cuºít_ev
,

3683 
íd_buf
,

3684 &
iwe
, 
buf
);

3685 i‡(
	`IS_ERR
(
cuºít_ev
))

3686 
u∆ock
;

3687 
iwe
.
u
.
d©a
.
Àngth
 = 
	`•rötf
(
buf
,

3689 
cfg
[4]);

3690 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
,

3691 
cuºít_ev
,

3692 
íd_buf
,

3693 &
iwe
, 
buf
);

3694 i‡(
	`IS_ERR
(
cuºít_ev
))

3695 
u∆ock
;

3696 
iwe
.
u
.
d©a
.
Àngth
 = 
	`•rötf
(
buf
,

3698 
cfg
[5]);

3699 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
,

3700 
cuºít_ev
,

3701 
íd_buf
,

3702 &
iwe
, 
buf
);

3703 i‡(
	`IS_ERR
(
cuºít_ev
))

3704 
u∆ock
;

3705 
iwe
.
u
.
d©a
.
Àngth
 = 
	`•rötf
(
buf
,

3707 
cfg
[6]);

3708 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
,

3709 
cuºít_ev
,

3710 
íd_buf
,

3711 &
iwe
, 
buf
);

3712 i‡(
	`IS_ERR
(
cuºít_ev
))

3713 
u∆ock
;

3715 
WLAN_EID_SUPP_RATES
:

3716 
WLAN_EID_EXT_SUPP_RATES
:

3718 
p
 = 
cuºít_ev
 + 
	`iwe_°ªam_l˝_Àn
(
öfo
);

3720 
	`mem£t
(&
iwe
, 0, (iwe));

3721 
iwe
.
cmd
 = 
SIOCGIWRATE
;

3723 
iwe
.
u
.
bôøã
.
fixed
 = iwe.u.bôøã.
dißbÀd
 = 0;

3725 
i
 = 0; i < 
õ
[1]; i++) {

3726 
iwe
.
u
.
bôøã
.
vÆue
 =

3727 ((
õ
[
i
 + 2] & 0x7f) * 500000);

3728 
tmp
 = 
p
;

3729 
p
 = 
	`iwe_°ªam_add_vÆue
(
öfo
, 
cuºít_ev
,Ö,

3730 
íd_buf
, &
iwe
,

3731 
IW_EV_PARAM_LEN
);

3732 i‡(
p
 =
tmp
) {

3733 
cuºít_ev
 = 
	`ERR_PTR
(-
E2BIG
);

3734 
u∆ock
;

3737 
cuºít_ev
 = 
p
;

3740 
ªm
 -
õ
[1] + 2;

3741 
õ
 += ie[1] + 2;

3744 i‡(
bss
->
pub
.
ˇ∑bûôy
 & (
WLAN_CAPABILITY_ESS
 | 
WLAN_CAPABILITY_IBSS
) ||

3745 
ismesh
) {

3746 
	`mem£t
(&
iwe
, 0, (iwe));

3747 
iwe
.
cmd
 = 
SIOCGIWMODE
;

3748 i‡(
ismesh
)

3749 
iwe
.
u
.
mode
 = 
IW_MODE_MESH
;

3750 i‡(
bss
->
pub
.
ˇ∑bûôy
 & 
WLAN_CAPABILITY_ESS
)

3751 
iwe
.
u
.
mode
 = 
IW_MODE_MASTER
;

3753 
iwe
.
u
.
mode
 = 
IW_MODE_ADHOC
;

3754 
cuºít_ev
 = 
	`iwe_°ªam_add_evít_check
(
öfo
, current_ev,

3755 
íd_buf
, &
iwe
,

3756 
IW_EV_UINT_LEN
);

3757 i‡(
	`IS_ERR
(
cuºít_ev
))

3758 
u∆ock
;

3761 
	`mem£t
(&
iwe
, 0, (iwe));

3762 
iwe
.
cmd
 = 
IWEVCUSTOM
;

3763 
iwe
.
u
.
d©a
.
Àngth
 = 
	`•rötf
(
buf
, "tsf=%016llx",

3764 ()(
õs
->
tsf
));

3765 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
, cuºít_ev, 
íd_buf
,

3766 &
iwe
, 
buf
);

3767 i‡(
	`IS_ERR
(
cuºít_ev
))

3768 
u∆ock
;

3769 
	`mem£t
(&
iwe
, 0, (iwe));

3770 
iwe
.
cmd
 = 
IWEVCUSTOM
;

3771 
iwe
.
u
.
d©a
.
Àngth
 = 
	`•rötf
(
buf
, " Last beacon: %umságo",

3772 
	`ñ≠£d_jiffõs_m£cs
(
bss
->
ts
));

3773 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt_check
(
öfo
, current_ev,

3774 
íd_buf
, &
iwe
, 
buf
);

3775 i‡(
	`IS_ERR
(
cuºít_ev
))

3776 
u∆ock
;

3778 
cuºít_ev
 = 
	`õì80211_sˇn_add_õs
(
öfo
, 
õs
, cuºít_ev, 
íd_buf
);

3780 
u∆ock
:

3781 
	`rcu_ªad_u∆ock
();

3782  
cuºít_ev
;

3783 
	}
}

3786 
	$õì80211_sˇn_ªsu…s
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

3787 
iw_ªque°_öfo
 *
öfo
,

3788 *
buf
, 
size_t
 
Àn
)

3790 *
cuºít_ev
 = 
buf
;

3791 *
íd_buf
 = 
buf
 + 
Àn
;

3792 
cfg80211_öã∫Æ_bss
 *
bss
;

3793 
îr
 = 0;

3795 
	`•ö_lock_bh
(&
rdev
->
bss_lock
);

3796 
	`cfg80211_bss_expúe
(
rdev
);

3798 
	`li°_f‹_óch_íåy
(
bss
, &
rdev
->
bss_li°
, 
li°
) {

3799 i‡(
buf
 + 
Àn
 - 
cuºít_ev
 <
IW_EV_ADDR_LEN
) {

3800 
îr
 = -
E2BIG
;

3803 
cuºít_ev
 = 
	`õì80211_bss
(&
rdev
->
wùhy
, 
öfo
, 
bss
,

3804 
cuºít_ev
, 
íd_buf
);

3805 i‡(
	`IS_ERR
(
cuºít_ev
)) {

3806 
îr
 = 
	`PTR_ERR
(
cuºít_ev
);

3810 
	`•ö_u∆ock_bh
(&
rdev
->
bss_lock
);

3812 i‡(
îr
)

3813  
îr
;

3814  
cuºít_ev
 - 
buf
;

3815 
	}
}

3818 
	$cfg80211_wext_giwsˇn
(
√t_devi˚
 *
dev
,

3819 
iw_ªque°_öfo
 *
öfo
,

3820 
iwªq_d©a
 *
wrqu
, *
exåa
)

3822 
iw_poöt
 *
d©a
 = &
wrqu
->data;

3823 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

3824 
ªs
;

3826 i‡(!
	`√tif_ru¬ög
(
dev
))

3827  -
ENETDOWN
;

3829 
rdev
 = 
	`cfg80211_gë_dev_‰om_ifödex
(
	`dev_√t
(
dev
), dev->
ifödex
);

3831 i‡(
	`IS_ERR
(
rdev
))

3832  
	`PTR_ERR
(
rdev
);

3834 i‡(
rdev
->
sˇn_ªq
 ||Ñdev->
sˇn_msg
)

3835  -
EAGAIN
;

3837 
ªs
 = 
	`õì80211_sˇn_ªsu…s
(
rdev
, 
öfo
, 
exåa
, 
d©a
->
Àngth
);

3838 
d©a
->
Àngth
 = 0;

3839 i‡(
ªs
 >= 0) {

3840 
d©a
->
Àngth
 = 
ªs
;

3841 
ªs
 = 0;

3844  
ªs
;

3845 
	}
}

3846 
EXPORT_WEXT_HANDLER
(
cfg80211_wext_giwsˇn
);

	@shipped-certs.c

1 
	~"ªg.h
"

2 c⁄° 
u8
 
	gshù≥d_ªgdb_˚πs
[] = {

178 
	gshù≥d_ªgdb_˚πs_Àn
 = (
shù≥d_ªgdb_˚πs
);

	@sme.c

12 
	~<löux/ëhîdevi˚.h
>

13 
	~<löux/if_¨p.h
>

14 
	~<löux/¶ab.h
>

15 
	~<löux/w‹kqueue.h
>

16 
	~<löux/wúñess.h
>

17 
	~<löux/exp‹t.h
>

18 
	~<√t/iw_h™dÀr.h
>

19 
	~<√t/cfg80211.h
>

20 
	~<√t/π√éök.h
>

21 
	~"∆80211.h
"

22 
	~"ªg.h
"

23 
	~"rdev-›s.h
"

31 
	scfg80211_c⁄n
 {

32 
cfg80211_c⁄√˘_∑øms
 
	m∑øms
;

35 
	mCFG80211_CONN_SCANNING
,

36 
	mCFG80211_CONN_SCAN_AGAIN
,

37 
	mCFG80211_CONN_AUTHENTICATE_NEXT
,

38 
	mCFG80211_CONN_AUTHENTICATING
,

39 
	mCFG80211_CONN_AUTH_FAILED_TIMEOUT
,

40 
	mCFG80211_CONN_ASSOCIATE_NEXT
,

41 
	mCFG80211_CONN_ASSOCIATING
,

42 
	mCFG80211_CONN_ASSOC_FAILED
,

43 
	mCFG80211_CONN_ASSOC_FAILED_TIMEOUT
,

44 
	mCFG80211_CONN_DEAUTH
,

45 
	mCFG80211_CONN_ABANDON
,

46 
	mCFG80211_CONN_CONNECTED
,

47 } 
	m°©e
;

48 
u8
 
	mbssid
[
ETH_ALEN
], 
	m¥ev_bssid
[ETH_ALEN];

49 c⁄° 
u8
 *
	mõ
;

50 
size_t
 
	mõ_Àn
;

51 
boﬁ
 
	mauto_auth
, 
	m¥ev_bssid_vÆid
;

54 
	$cfg80211_sme_‰ì
(
wúñess_dev
 *
wdev
)

56 i‡(!
wdev
->
c⁄n
)

59 
	`k‰ì
(
wdev
->
c⁄n
->
õ
);

60 
	`k‰ì
(
wdev
->
c⁄n
);

61 
wdev
->
c⁄n
 = 
NULL
;

62 
	}
}

64 
	$cfg80211_c⁄n_sˇn
(
wúñess_dev
 *
wdev
)

66 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

67 
cfg80211_sˇn_ªque°
 *
ªque°
;

68 
n_ch™√ls
, 
îr
;

70 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

72 i‡(
rdev
->
sˇn_ªq
 ||Ñdev->
sˇn_msg
)

73  -
EBUSY
;

75 i‡(
wdev
->
c⁄n
->
∑øms
.
ch™√l
)

76 
n_ch™√ls
 = 1;

78 
n_ch™√ls
 = 
	`õì80211_gë_num_suµ‹ãd_ch™√ls
(
wdev
->
wùhy
);

80 
ªque°
 = 
	`kzÆloc
((*ªque°Ë+ ‘eque°->
ssids
[0]) +

81 (
ªque°
->
ch™√ls
[0]Ë* 
n_ch™√ls
,

82 
GFP_KERNEL
);

83 i‡(!
ªque°
)

84  -
ENOMEM
;

86 i‡(
wdev
->
c⁄n
->
∑øms
.
ch™√l
) {

87 
∆80211_b™d
 
b™d
 = 
wdev
->
c⁄n
->
∑øms
.
ch™√l
->band;

88 
õì80211_suµ‹ãd_b™d
 *
sb™d
 =

89 
wdev
->
wùhy
->
b™ds
[
b™d
];

91 i‡(!
sb™d
) {

92 
	`k‰ì
(
ªque°
);

93  -
EINVAL
;

95 
ªque°
->
ch™√ls
[0] = 
wdev
->
c⁄n
->
∑øms
.
ch™√l
;

96 
ªque°
->
øãs
[
b™d
] = (1 << 
sb™d
->
n_bôøãs
) - 1;

98 
i
 = 0, 
j
;

99 
∆80211_b™d
 
b™d
;

100 
õì80211_suµ‹ãd_b™d
 *
b™ds
;

101 
õì80211_ch™√l
 *
ch™√l
;

103 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

104 
b™ds
 = 
wdev
->
wùhy
->b™ds[
b™d
];

105 i‡(!
b™ds
)

107 
j
 = 0; j < 
b™ds
->
n_ch™√ls
; j++) {

108 
ch™√l
 = &
b™ds
->
ch™√ls
[
j
];

109 i‡(
ch™√l
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

111 
ªque°
->
ch™√ls
[
i
++] = 
ch™√l
;

113 
ªque°
->
øãs
[
b™d
] = (1 << 
b™ds
->
n_bôøãs
) - 1;

115 
n_ch™√ls
 = 
i
;

117 
ªque°
->
n_ch™√ls
 =Ç_channels;

118 
ªque°
->
ssids
 = (*)&ªque°->
ch™√ls
[
n_ch™√ls
];

119 
ªque°
->
n_ssids
 = 1;

121 
	`mem˝y
(
ªque°
->
ssids
[0].
ssid
, 
wdev
->
c⁄n
->
∑øms
.ssid,

122 
wdev
->
c⁄n
->
∑øms
.
ssid_Àn
);

123 
ªque°
->
ssids
[0].
ssid_Àn
 = 
wdev
->
c⁄n
->
∑øms
.ssid_len;

125 
	`ëh_brﬂdˇ°_addr
(
ªque°
->
bssid
);

127 
ªque°
->
wdev
 = wdev;

128 
ªque°
->
wùhy
 = &
rdev
->wiphy;

129 
ªque°
->
sˇn_°¨t
 = 
jiffõs
;

131 
rdev
->
sˇn_ªq
 = 
ªque°
;

133 
îr
 = 
	`rdev_sˇn
(
rdev
, 
ªque°
);

134 i‡(!
îr
) {

135 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_SCANNING
;

136 
	`∆80211_£nd_sˇn_°¨t
(
rdev
, 
wdev
);

137 
	`dev_hﬁd
(
wdev
->
√tdev
);

139 
rdev
->
sˇn_ªq
 = 
NULL
;

140 
	`k‰ì
(
ªque°
);

142  
îr
;

143 
	}
}

145 
	$cfg80211_c⁄n_do_w‹k
(
wúñess_dev
 *
wdev
,

146 
∆80211_timeout_ªas⁄
 *
åós⁄
)

148 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

149 
cfg80211_c⁄√˘_∑øms
 *
∑øms
;

150 
cfg80211_auth_ªque°
 
auth_ªq
 = {};

151 
cfg80211_assoc_ªque°
 
ªq
 = {};

152 
îr
;

154 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

156 i‡(!
wdev
->
c⁄n
)

159 
∑øms
 = &
wdev
->
c⁄n
->params;

161 
wdev
->
c⁄n
->
°©e
) {

162 
CFG80211_CONN_SCANNING
:

164  -
ENOENT
;

165 
CFG80211_CONN_SCAN_AGAIN
:

166  
	`cfg80211_c⁄n_sˇn
(
wdev
);

167 
CFG80211_CONN_AUTHENTICATE_NEXT
:

168 i‡(
	`WARN_ON
(!
rdev
->
›s
->
auth
))

169  -
EOPNOTSUPP
;

170 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_AUTHENTICATING
;

171 
auth_ªq
.
key
 = 
∑øms
->key;

172 
auth_ªq
.
key_Àn
 = 
∑øms
->key_len;

173 
auth_ªq
.
key_idx
 = 
∑øms
->key_idx;

174 
auth_ªq
.
auth_ty≥
 = 
∑øms
->auth_type;

175 
auth_ªq
.
bss
 = 
	`cfg80211_gë_bss
(&
rdev
->
wùhy
, 
∑øms
->
ch™√l
,

176 
∑øms
->
bssid
,

177 
∑øms
->
ssid
,Ö¨ams->
ssid_Àn
,

178 
IEEE80211_BSS_TYPE_ESS
,

179 
IEEE80211_PRIVACY_ANY
);

180 
auth_ªq
.
lök_id
 = -1;

181 
îr
 = 
	`cfg80211_mlme_auth
(
rdev
, 
wdev
->
√tdev
, &
auth_ªq
);

182 
	`cfg80211_put_bss
(&
rdev
->
wùhy
, 
auth_ªq
.
bss
);

183  
îr
;

184 
CFG80211_CONN_AUTH_FAILED_TIMEOUT
:

185 *
åós⁄
 = 
NL80211_TIMEOUT_AUTH
;

186  -
ENOTCONN
;

187 
CFG80211_CONN_ASSOCIATE_NEXT
:

188 i‡(
	`WARN_ON
(!
rdev
->
›s
->
assoc
))

189  -
EOPNOTSUPP
;

190 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_ASSOCIATING
;

191 i‡(
wdev
->
c⁄n
->
¥ev_bssid_vÆid
)

192 
ªq
.
¥ev_bssid
 = 
wdev
->
c⁄n
->prev_bssid;

193 
ªq
.
õ
 = 
∑øms
->ie;

194 
ªq
.
õ_Àn
 = 
∑øms
->ie_len;

195 
ªq
.
u£_mÂ
 = 
∑øms
->
mÂ
 !
NL80211_MFP_NO
;

196 
ªq
.
¸y±o
 = 
∑øms
->crypto;

197 
ªq
.
Êags
 = 
∑øms
->flags;

198 
ªq
.
ht_ˇ∑
 = 
∑øms
->ht_capa;

199 
ªq
.
ht_ˇ∑_mask
 = 
∑øms
->ht_capa_mask;

200 
ªq
.
vht_ˇ∑
 = 
∑øms
->vht_capa;

201 
ªq
.
vht_ˇ∑_mask
 = 
∑øms
->vht_capa_mask;

202 
ªq
.
lök_id
 = -1;

204 
ªq
.
bss
 = 
	`cfg80211_gë_bss
(&
rdev
->
wùhy
, 
∑øms
->
ch™√l
,

205 
∑øms
->
bssid
,

206 
∑øms
->
ssid
,Ö¨ams->
ssid_Àn
,

207 
IEEE80211_BSS_TYPE_ESS
,

208 
IEEE80211_PRIVACY_ANY
);

209 i‡(!
ªq
.
bss
) {

210 
îr
 = -
ENOENT
;

212 
îr
 = 
	`cfg80211_mlme_assoc
(
rdev
, 
wdev
->
√tdev
,

213 &
ªq
, 
NULL
);

214 
	`cfg80211_put_bss
(&
rdev
->
wùhy
, 
ªq
.
bss
);

217 i‡(
îr
)

218 
	`cfg80211_mlme_dóuth
(
rdev
, 
wdev
->
√tdev
, 
∑øms
->
bssid
,

219 
NULL
, 0,

220 
WLAN_REASON_DEAUTH_LEAVING
,

221 
Ál£
);

222  
îr
;

223 
CFG80211_CONN_ASSOC_FAILED_TIMEOUT
:

224 *
åós⁄
 = 
NL80211_TIMEOUT_ASSOC
;

225 
ÁŒthrough
;

226 
CFG80211_CONN_ASSOC_FAILED
:

227 
	`cfg80211_mlme_dóuth
(
rdev
, 
wdev
->
√tdev
, 
∑øms
->
bssid
,

228 
NULL
, 0,

229 
WLAN_REASON_DEAUTH_LEAVING
, 
Ál£
);

230  -
ENOTCONN
;

231 
CFG80211_CONN_DEAUTH
:

232 
	`cfg80211_mlme_dóuth
(
rdev
, 
wdev
->
√tdev
, 
∑øms
->
bssid
,

233 
NULL
, 0,

234 
WLAN_REASON_DEAUTH_LEAVING
, 
Ál£
);

235 
ÁŒthrough
;

236 
CFG80211_CONN_ABANDON
:

238 
	`cfg80211_sme_‰ì
(
wdev
);

243 
	}
}

245 
	$cfg80211_c⁄n_w‹k
(
w‹k_°ru˘
 *
w‹k
)

247 
cfg80211_ªgi°îed_devi˚
 *
rdev
 =

248 
	`c⁄èöî_of
(
w‹k
, 
cfg80211_ªgi°îed_devi˚
, 
c⁄n_w‹k
);

249 
wúñess_dev
 *
wdev
;

250 
u8
 
bssid_buf
[
ETH_ALEN
], *
bssid
 = 
NULL
;

251 
∆80211_timeout_ªas⁄
 
åós⁄
;

253 
	`wùhy_lock
(&
rdev
->
wùhy
);

255 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

256 i‡(!
wdev
->
√tdev
)

259 i‡(!
	`√tif_ru¬ög
(
wdev
->
√tdev
))

262 i‡(!
wdev
->
c⁄n
 ||

263 
wdev
->
c⁄n
->
°©e
 =
CFG80211_CONN_CONNECTED
)

266 i‡(
wdev
->
c⁄n
->
∑øms
.
bssid
) {

267 
	`mem˝y
(
bssid_buf
, 
wdev
->
c⁄n
->
∑øms
.
bssid
, 
ETH_ALEN
);

268 
bssid
 = 
bssid_buf
;

270 
åós⁄
 = 
NL80211_TIMEOUT_UNSPECIFIED
;

271 i‡(
	`cfg80211_c⁄n_do_w‹k
(
wdev
, &
åós⁄
)) {

272 
cfg80211_c⁄√˘_ª•_∑øms
 
¸
;

274 
	`mem£t
(&
¸
, 0, (cr));

275 
¸
.
°©us
 = -1;

276 
¸
.
löks
[0].
bssid
 = bssid;

277 
¸
.
timeout_ªas⁄
 = 
åós⁄
;

278 
	`__cfg80211_c⁄√˘_ªsu…
(
wdev
->
√tdev
, &
¸
, 
Ál£
);

282 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

283 
	}
}

285 
	$cfg80211_°ï_auth_√xt
(
cfg80211_c⁄n
 *
c⁄n
,

286 
cfg80211_bss
 *
bss
)

288 
	`mem˝y
(
c⁄n
->
bssid
, 
bss
->bssid, 
ETH_ALEN
);

289 
c⁄n
->
∑øms
.
bssid
 = conn->bssid;

290 
c⁄n
->
∑øms
.
ch™√l
 = 
bss
->channel;

291 
c⁄n
->
°©e
 = 
CFG80211_CONN_AUTHENTICATE_NEXT
;

292 
	}
}

295 
cfg80211_bss
 *
	$cfg80211_gë_c⁄n_bss
(
wúñess_dev
 *
wdev
)

297 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

298 
cfg80211_bss
 *
bss
;

300 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

302 
bss
 = 
	`cfg80211_gë_bss
(
wdev
->
wùhy
, wdev->
c⁄n
->
∑øms
.
ch™√l
,

303 
wdev
->
c⁄n
->
∑øms
.
bssid
,

304 
wdev
->
c⁄n
->
∑øms
.
ssid
,

305 
wdev
->
c⁄n
->
∑øms
.
ssid_Àn
,

306 
wdev
->
c⁄n_bss_ty≥
,

307 
	`IEEE80211_PRIVACY
(
wdev
->
c⁄n
->
∑øms
.
¥ivacy
));

308 i‡(!
bss
)

309  
NULL
;

311 
	`cfg80211_°ï_auth_√xt
(
wdev
->
c⁄n
, 
bss
);

312 
	`scheduÀ_w‹k
(&
rdev
->
c⁄n_w‹k
);

314  
bss
;

315 
	}
}

317 
	$cfg80211_sme_sˇn_d⁄e
(
√t_devi˚
 *
dev
)

319 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

320 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

321 
cfg80211_bss
 *
bss
;

323 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

325 i‡(!
wdev
->
c⁄n
)

328 i‡(
wdev
->
c⁄n
->
°©e
 !
CFG80211_CONN_SCANNING
 &&

329 
wdev
->
c⁄n
->
°©e
 !
CFG80211_CONN_SCAN_AGAIN
)

332 
bss
 = 
	`cfg80211_gë_c⁄n_bss
(
wdev
);

333 i‡(
bss
)

334 
	`cfg80211_put_bss
(&
rdev
->
wùhy
, 
bss
);

336 
	`scheduÀ_w‹k
(&
rdev
->
c⁄n_w‹k
);

337 
	}
}

339 
	$cfg80211_sme_rx_auth
(
wúñess_dev
 *
wdev
, c⁄° 
u8
 *
buf
, 
size_t
 
Àn
)

341 
wùhy
 *wùhy = 
wdev
->wiphy;

342 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wùhy
);

343 
õì80211_mgmt
 *
mgmt
 = (õì80211_mgmà*)
buf
;

344 
u16
 
°©us_code
 = 
	`À16_to_˝u
(
mgmt
->
u
.
auth
.status_code);

346 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

348 i‡(!
wdev
->
c⁄n
 || wdev->c⁄n->
°©e
 =
CFG80211_CONN_CONNECTED
)

351 i‡(
°©us_code
 =
WLAN_STATUS_NOT_SUPPORTED_AUTH_ALG
 &&

352 
wdev
->
c⁄n
->
auto_auth
 &&

353 
wdev
->
c⁄n
->
∑øms
.
auth_ty≥
 !
NL80211_AUTHTYPE_NETWORK_EAP
) {

355 
wdev
->
c⁄n
->
∑øms
.
auth_ty≥
) {

356 
NL80211_AUTHTYPE_OPEN_SYSTEM
:

357 i‡(
wdev
->
c⁄√˘_keys
)

358 
wdev
->
c⁄n
->
∑øms
.
auth_ty≥
 =

359 
NL80211_AUTHTYPE_SHARED_KEY
;

361 
wdev
->
c⁄n
->
∑øms
.
auth_ty≥
 =

362 
NL80211_AUTHTYPE_NETWORK_EAP
;

364 
NL80211_AUTHTYPE_SHARED_KEY
:

365 
wdev
->
c⁄n
->
∑øms
.
auth_ty≥
 =

366 
NL80211_AUTHTYPE_NETWORK_EAP
;

370 
wdev
->
c⁄n
->
∑øms
.
auth_ty≥
 =

371 
NL80211_AUTHTYPE_OPEN_SYSTEM
;

374 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_AUTHENTICATE_NEXT
;

375 
	`scheduÀ_w‹k
(&
rdev
->
c⁄n_w‹k
);

376 } i‡(
°©us_code
 !
WLAN_STATUS_SUCCESS
) {

377 
cfg80211_c⁄√˘_ª•_∑øms
 
¸
;

379 
	`mem£t
(&
¸
, 0, (cr));

380 
¸
.
°©us
 = 
°©us_code
;

381 
¸
.
löks
[0].
bssid
 = 
mgmt
->bssid;

382 
¸
.
timeout_ªas⁄
 = 
NL80211_TIMEOUT_UNSPECIFIED
;

383 
	`__cfg80211_c⁄√˘_ªsu…
(
wdev
->
√tdev
, &
¸
, 
Ál£
);

384 } i‡(
wdev
->
c⁄n
->
°©e
 =
CFG80211_CONN_AUTHENTICATING
) {

385 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_ASSOCIATE_NEXT
;

386 
	`scheduÀ_w‹k
(&
rdev
->
c⁄n_w‹k
);

388 
	}
}

390 
boﬁ
 
	$cfg80211_sme_rx_assoc_ª•
(
wúñess_dev
 *
wdev
, 
u16
 
°©us
)

392 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

394 i‡(!
wdev
->
c⁄n
)

395  
Ál£
;

397 i‡(
°©us
 =
WLAN_STATUS_SUCCESS
) {

398 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_CONNECTED
;

399  
Ál£
;

402 i‡(
wdev
->
c⁄n
->
¥ev_bssid_vÆid
) {

408 
wdev
->
c⁄n
->
¥ev_bssid_vÆid
 = 
Ál£
;

409 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_ASSOCIATE_NEXT
;

410 
	`scheduÀ_w‹k
(&
rdev
->
c⁄n_w‹k
);

411  
åue
;

414 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_ASSOC_FAILED
;

415 
	`scheduÀ_w‹k
(&
rdev
->
c⁄n_w‹k
);

416  
Ál£
;

417 
	}
}

419 
	$cfg80211_sme_dóuth
(
wúñess_dev
 *
wdev
)

421 
	`cfg80211_sme_‰ì
(
wdev
);

422 
	}
}

424 
	$cfg80211_sme_auth_timeout
(
wúñess_dev
 *
wdev
)

426 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

428 i‡(!
wdev
->
c⁄n
)

431 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_AUTH_FAILED_TIMEOUT
;

432 
	`scheduÀ_w‹k
(&
rdev
->
c⁄n_w‹k
);

433 
	}
}

435 
	$cfg80211_sme_dißssoc
(
wúñess_dev
 *
wdev
)

437 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

439 i‡(!
wdev
->
c⁄n
)

442 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_DEAUTH
;

443 
	`scheduÀ_w‹k
(&
rdev
->
c⁄n_w‹k
);

444 
	}
}

446 
	$cfg80211_sme_assoc_timeout
(
wúñess_dev
 *
wdev
)

448 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

450 i‡(!
wdev
->
c⁄n
)

453 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_ASSOC_FAILED_TIMEOUT
;

454 
	`scheduÀ_w‹k
(&
rdev
->
c⁄n_w‹k
);

455 
	}
}

457 
	$cfg80211_sme_ab™d⁄_assoc
(
wúñess_dev
 *
wdev
)

459 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

461 i‡(!
wdev
->
c⁄n
)

464 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_ABANDON
;

465 
	`scheduÀ_w‹k
(&
rdev
->
c⁄n_w‹k
);

466 
	}
}

468 
	$cfg80211_wdev_ªÀa£_bs£s
(
wúñess_dev
 *
wdev
)

470 
lök
;

472 
	`f‹_óch_vÆid_lök
(
wdev
, 
lök
) {

473 i‡(!
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
)

475 
	`cfg80211_unhﬁd_bss
(
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
);

476 
	`cfg80211_put_bss
(
wdev
->
wùhy
,

477 &
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
->
pub
);

478 
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
 = 
NULL
;

480 
	}
}

482 
	$cfg80211_wdev_ªÀa£_lök_bs£s
(
wúñess_dev
 *
wdev
, 
u16
 
lök_mask
)

484 
lök
;

486 
	`f‹_óch_vÆid_lök
(
wdev
, 
lök
) {

487 i‡(!
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
 ||

488 !(
lök_mask
 & 
	`BIT
(
lök
)))

490 
	`cfg80211_unhﬁd_bss
(
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
);

491 
	`cfg80211_put_bss
(
wdev
->
wùhy
,

492 &
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
->
pub
);

493 
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
 = 
NULL
;

495 
	}
}

497 
	$cfg80211_sme_gë_c⁄n_õs
(
wúñess_dev
 *
wdev
,

498 c⁄° 
u8
 *
õs
, 
size_t
 
õs_Àn
,

499 c⁄° 
u8
 **
out_õs
, 
size_t
 *
out_õs_Àn
)

501 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

502 
u8
 *
buf
;

503 
size_t
 
offs
;

505 i‡(!
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs_Àn
 ||

506 (
õs
 && 
	`cfg80211_föd_õ
(
WLAN_EID_EXT_CAPABILITY
, ies, 
õs_Àn
))) {

507 *
out_õs
 = 
	`kmemdup
(
õs
, 
õs_Àn
, 
GFP_KERNEL
);

508 i‡(!*
out_õs
)

509  -
ENOMEM
;

510 *
out_õs_Àn
 = 
õs_Àn
;

514 
buf
 = 
	`kmÆloc
(
õs_Àn
 + 
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs_Àn
 + 2,

515 
GFP_KERNEL
);

516 i‡(!
buf
)

517  -
ENOMEM
;

519 i‡(
õs_Àn
) {

520 c⁄° 
u8
 
bef‹e_extˇ∑
[] = {

522 
WLAN_EID_RSN
,

523 
WLAN_EID_QOS_CAPA
,

524 
WLAN_EID_RRM_ENABLED_CAPABILITIES
,

525 
WLAN_EID_MOBILITY_DOMAIN
,

526 
WLAN_EID_SUPPORTED_REGULATORY_CLASSES
,

527 
WLAN_EID_BSS_COEX_2040
,

530 
offs
 = 
	`õì80211_õ_•lô
(
õs
, 
õs_Àn
, 
bef‹e_extˇ∑
,

531 
	`ARRAY_SIZE
(
bef‹e_extˇ∑
), 0);

532 
	`mem˝y
(
buf
, 
õs
, 
offs
);

534 
	`mem˝y
(
buf
 + 
offs
 + 
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs_Àn
 + 2,

535 
õs
 + 
offs
, 
õs_Àn
 - offs);

537 
offs
 = 0;

541 
buf
[
offs
] = 
WLAN_EID_EXT_CAPABILITY
;

542 
buf
[
offs
 + 1] = 
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs_Àn
;

543 
	`mem˝y
(
buf
 + 
offs
 + 2,

544 
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs
,

545 
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs_Àn
);

547 *
out_õs
 = 
buf
;

548 *
out_õs_Àn
 = 
õs_Àn
 + 
rdev
->
wùhy
.
exãnded_ˇ∑bûôõs_Àn
 + 2;

551 
	}
}

553 
	$cfg80211_sme_c⁄√˘
(
wúñess_dev
 *
wdev
,

554 
cfg80211_c⁄√˘_∑øms
 *
c⁄√˘
,

555 c⁄° 
u8
 *
¥ev_bssid
)

557 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

558 
cfg80211_bss
 *
bss
;

559 
îr
;

561 i‡(!
rdev
->
›s
->
auth
 || !rdev->›s->
assoc
)

562  -
EOPNOTSUPP
;

564 
	`cfg80211_wdev_ªÀa£_bs£s
(
wdev
);

566 i‡(
wdev
->
c⁄√˘ed
) {

567 
	`cfg80211_sme_‰ì
(
wdev
);

568 
wdev
->
c⁄√˘ed
 = 
Ál£
;

571 i‡(
wdev
->
c⁄n
)

572  -
EINPROGRESS
;

574 
wdev
->
c⁄n
 = 
	`kzÆloc
((*wdev->c⁄n), 
GFP_KERNEL
);

575 i‡(!
wdev
->
c⁄n
)

576  -
ENOMEM
;

581 
	`mem˝y
(&
wdev
->
c⁄n
->
∑øms
, 
c⁄√˘
, (*connect));

582 i‡(
c⁄√˘
->
bssid
) {

583 
wdev
->
c⁄n
->
∑øms
.
bssid
 = wdev->conn->bssid;

584 
	`mem˝y
(
wdev
->
c⁄n
->
bssid
, 
c⁄√˘
->bssid, 
ETH_ALEN
);

587 i‡(
	`cfg80211_sme_gë_c⁄n_õs
(
wdev
, 
c⁄√˘
->
õ
, c⁄√˘->
õ_Àn
,

588 &
wdev
->
c⁄n
->
õ
,

589 &
wdev
->
c⁄n
->
∑øms
.
õ_Àn
)) {

590 
	`k‰ì
(
wdev
->
c⁄n
);

591 
wdev
->
c⁄n
 = 
NULL
;

592  -
ENOMEM
;

594 
wdev
->
c⁄n
->
∑øms
.
õ
 = wdev->conn->ie;

596 i‡(
c⁄√˘
->
auth_ty≥
 =
NL80211_AUTHTYPE_AUTOMATIC
) {

597 
wdev
->
c⁄n
->
auto_auth
 = 
åue
;

599 
wdev
->
c⁄n
->
∑øms
.
auth_ty≥
 =

600 
NL80211_AUTHTYPE_OPEN_SYSTEM
;

602 
wdev
->
c⁄n
->
auto_auth
 = 
Ál£
;

605 
wdev
->
c⁄n
->
∑øms
.
ssid
 = wdev->
u
.
˛õ¡
.ssid;

606 
wdev
->
c⁄n
->
∑øms
.
ssid_Àn
 = wdev->
u
.
˛õ¡
.ssid_len;

609 
bss
 = 
	`cfg80211_gë_bss
(
wdev
->
wùhy
, wdev->
c⁄n
->
∑øms
.
ch™√l
,

610 
wdev
->
c⁄n
->
∑øms
.
bssid
,

611 
wdev
->
c⁄n
->
∑øms
.
ssid
,

612 
wdev
->
c⁄n
->
∑øms
.
ssid_Àn
,

613 
wdev
->
c⁄n_bss_ty≥
,

614 
	`IEEE80211_PRIVACY
(
wdev
->
c⁄n
->
∑øms
.
¥ivacy
));

616 i‡(
¥ev_bssid
) {

617 
	`mem˝y
(
wdev
->
c⁄n
->
¥ev_bssid
,Öªv_bssid, 
ETH_ALEN
);

618 
wdev
->
c⁄n
->
¥ev_bssid_vÆid
 = 
åue
;

622 i‡(
bss
) {

623 
∆80211_timeout_ªas⁄
 
åós⁄
;

625 
	`cfg80211_°ï_auth_√xt
(
wdev
->
c⁄n
, 
bss
);

626 
îr
 = 
	`cfg80211_c⁄n_do_w‹k
(
wdev
, &
åós⁄
);

627 
	`cfg80211_put_bss
(
wdev
->
wùhy
, 
bss
);

630 
îr
 = 
	`cfg80211_c⁄n_sˇn
(
wdev
);

637 i‡(
îr
 =-
EBUSY
) {

638 
îr
 = 0;

639 
wdev
->
c⁄n
->
°©e
 = 
CFG80211_CONN_SCAN_AGAIN
;

643 i‡(
îr
)

644 
	`cfg80211_sme_‰ì
(
wdev
);

646  
îr
;

647 
	}
}

649 
	$cfg80211_sme_disc⁄√˘
(
wúñess_dev
 *
wdev
, 
u16
 
ªas⁄
)

651 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

652 
îr
;

654 i‡(!
wdev
->
c⁄n
)

657 i‡(!
rdev
->
›s
->
dóuth
)

658  -
EOPNOTSUPP
;

660 i‡(
wdev
->
c⁄n
->
°©e
 =
CFG80211_CONN_SCANNING
 ||

661 
wdev
->
c⁄n
->
°©e
 =
CFG80211_CONN_SCAN_AGAIN
) {

662 
îr
 = 0;

663 
out
;

667 
îr
 = 
	`cfg80211_mlme_dóuth
(
rdev
, 
wdev
->
√tdev
,

668 
wdev
->
c⁄n
->
∑øms
.
bssid
,

669 
NULL
, 0, 
ªas⁄
, 
Ál£
);

670 
out
:

671 
	`cfg80211_sme_‰ì
(
wdev
);

672  
îr
;

673 
	}
}

679 
boﬁ
 
	$cfg80211_is_Æl_idÀ
()

681 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

682 
wúñess_dev
 *
wdev
;

683 
boﬁ
 
is_Æl_idÀ
 = 
åue
;

693 
	`f‹_óch_rdev
(
rdev
) {

694 
	`wùhy_lock
(&
rdev
->
wùhy
);

695 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
) {

696 i‡(
wdev
->
c⁄n
 || wdev->
c⁄√˘ed
 ||

697 
	`cfg80211_bóc⁄ög_iÁ˚_a˘ive
(
wdev
))

698 
is_Æl_idÀ
 = 
Ál£
;

700 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

703  
is_Æl_idÀ
;

704 
	}
}

706 
	$disc⁄√˘_w‹k
(
w‹k_°ru˘
 *
w‹k
)

708 
	`π∆_lock
();

709 i‡(
	`cfg80211_is_Æl_idÀ
())

710 
	`ªguœt‹y_höt_disc⁄√˘
();

711 
	`π∆_u∆ock
();

712 
	}
}

714 
DECLARE_WORK
(
cfg80211_disc⁄√˘_w‹k
, 
disc⁄√˘_w‹k
);

717 
	$cfg80211_c⁄√˘_ªsu…_ªÀa£_bs£s
(
wúñess_dev
 *
wdev
,

718 
cfg80211_c⁄√˘_ª•_∑øms
 *
¸
)

720 
lök
;

722 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
) {

723 i‡(!
¸
->
löks
[
lök
].
bss
)

725 
	`cfg80211_unhﬁd_bss
(
	`bss_‰om_pub
(
¸
->
löks
[
lök
].
bss
));

726 
	`cfg80211_put_bss
(
wdev
->
wùhy
, 
¸
->
löks
[
lök
].
bss
);

728 
	}
}

736 
	$__cfg80211_c⁄√˘_ªsu…
(
√t_devi˚
 *
dev
,

737 
cfg80211_c⁄√˘_ª•_∑øms
 *
¸
,

738 
boﬁ
 
wexãv
)

740 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

741 c⁄° 
ñemít
 *
cou¡ry_ñem
 = 
NULL
;

742 c⁄° 
ñemít
 *
ssid
;

743 c⁄° 
u8
 *
cou¡ry_d©a
;

744 
u8
 
cou¡ry_d©Æí
;

745 #ifde‡
CONFIG_CFG80211_WEXT


746 
iwªq_d©a
 
wrqu
;

748 
lök
;

749 c⁄° 
u8
 *
c⁄√˘ed_addr
;

750 
boﬁ
 
bss_nŸ_found
 = 
Ál£
;

752 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

754 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

755 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
))

756 
out
;

758 i‡(
¸
->
vÆid_löks
) {

759 i‡(
	`WARN_ON
(!
¸
->
≠_mld_addr
))

760 
out
;

762 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
) {

763 i‡(
	`WARN_ON
(!
¸
->
löks
[
lök
].
addr
))

764 
out
;

767 i‡(
	`WARN_ON
(
wdev
->
c⁄√˘_keys
))

768 
out
;

771 
wdev
->
u≈rŸ_bóc⁄_ªp‹ãd
 = 0;

772 
	`∆80211_£nd_c⁄√˘_ªsu…
(
	`wùhy_to_rdev
(
wdev
->
wùhy
), 
dev
, 
¸
,

773 
GFP_KERNEL
);

774 
c⁄√˘ed_addr
 = 
¸
->
vÆid_löks
 ? cr->
≠_mld_addr
 : cr->
löks
[0].
bssid
;

776 #ifde‡
CONFIG_CFG80211_WEXT


777 i‡(
wexãv
 && !
¸
->
vÆid_löks
) {

778 i‡(
¸
->
ªq_õ
 && cr->
°©us
 =
WLAN_STATUS_SUCCESS
) {

779 
	`mem£t
(&
wrqu
, 0, (wrqu));

780 
wrqu
.
d©a
.
Àngth
 = 
¸
->
ªq_õ_Àn
;

781 
	`wúñess_£nd_evít
(
dev
, 
IWEVASSOCREQIE
, &
wrqu
,

782 
¸
->
ªq_õ
);

785 i‡(
¸
->
ª•_õ
 && cr->
°©us
 =
WLAN_STATUS_SUCCESS
) {

786 
	`mem£t
(&
wrqu
, 0, (wrqu));

787 
wrqu
.
d©a
.
Àngth
 = 
¸
->
ª•_õ_Àn
;

788 
	`wúñess_£nd_evít
(
dev
, 
IWEVASSOCRESPIE
, &
wrqu
,

789 
¸
->
ª•_õ
);

792 
	`mem£t
(&
wrqu
, 0, (wrqu));

793 
wrqu
.
≠_addr
.
ß_Ámûy
 = 
ARPHRD_ETHER
;

794 i‡(
c⁄√˘ed_addr
 && 
¸
->
°©us
 =
WLAN_STATUS_SUCCESS
) {

795 
	`mem˝y
(
wrqu
.
≠_addr
.
ß_d©a
, 
c⁄√˘ed_addr
, 
ETH_ALEN
);

796 
	`mem˝y
(
wdev
->
wext
.
¥ev_bssid
, 
c⁄√˘ed_addr
, 
ETH_ALEN
);

797 
wdev
->
wext
.
¥ev_bssid_vÆid
 = 
åue
;

799 
	`wúñess_£nd_evít
(
dev
, 
SIOCGIWAP
, &
wrqu
, 
NULL
);

803 i‡(
¸
->
°©us
 =
WLAN_STATUS_SUCCESS
) {

804 i‡(!
	`wùhy_to_rdev
(
wdev
->
wùhy
)->
›s
->
c⁄√˘
) {

805 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
) {

806 i‡(
	`WARN_ON_ONCE
(!
¸
->
löks
[
lök
].
bss
))

811 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
) {

813 i‡(
¸
->
löks
[
lök
].
°©us
 !
WLAN_STATUS_SUCCESS
)

816 i‡(
¸
->
löks
[
lök
].
bss
)

819 
¸
->
löks
[
lök
].
bss
 =

820 
	`cfg80211_gë_bss
(
wdev
->
wùhy
, 
NULL
,

821 
¸
->
löks
[
lök
].
bssid
,

822 
wdev
->
u
.
˛õ¡
.
ssid
,

823 
wdev
->
u
.
˛õ¡
.
ssid_Àn
,

824 
wdev
->
c⁄n_bss_ty≥
,

825 
IEEE80211_PRIVACY_ANY
);

826 i‡(!
¸
->
löks
[
lök
].
bss
) {

827 
bss_nŸ_found
 = 
åue
;

830 
	`cfg80211_hﬁd_bss
(
	`bss_‰om_pub
(
¸
->
löks
[
lök
].
bss
));

834 
	`cfg80211_wdev_ªÀa£_bs£s
(
wdev
);

836 i‡(
¸
->
°©us
 !
WLAN_STATUS_SUCCESS
) {

837 
	`k‰ì_£nsôive
(
wdev
->
c⁄√˘_keys
);

838 
wdev
->
c⁄√˘_keys
 = 
NULL
;

839 
wdev
->
u
.
˛õ¡
.
ssid_Àn
 = 0;

840 
wdev
->
c⁄n_ow√r_∆p‹tid
 = 0;

841 
	`cfg80211_c⁄√˘_ªsu…_ªÀa£_bs£s
(
wdev
, 
¸
);

842 
	`cfg80211_sme_‰ì
(
wdev
);

846 i‡(
	`WARN_ON
(
bss_nŸ_found
)) {

847 
	`cfg80211_c⁄√˘_ªsu…_ªÀa£_bs£s
(
wdev
, 
¸
);

851 
	`mem£t
(
wdev
->
löks
, 0, (wdev->links));

852 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
) {

853 i‡(
¸
->
löks
[
lök
].
°©us
 =
WLAN_STATUS_SUCCESS
)

855 
¸
->
vÆid_löks
 &~
	`BIT
(
lök
);

857 i‡(!
¸
->
löks
[
lök
].
bss
)

859 
	`cfg80211_unhﬁd_bss
(
	`bss_‰om_pub
(
¸
->
löks
[
lök
].
bss
));

860 
	`cfg80211_put_bss
(
wdev
->
wùhy
, 
¸
->
löks
[
lök
].
bss
);

862 
wdev
->
vÆid_löks
 = 
¸
->valid_links;

863 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
)

864 
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
 =

865 
	`bss_‰om_pub
(
¸
->
löks
[
lök
].
bss
);

866 
wdev
->
c⁄√˘ed
 = 
åue
;

867 
	`ëhî_addr_c›y
(
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
, connected_addr);

868 i‡(
¸
->
vÆid_löks
) {

869 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
)

870 
	`mem˝y
(
wdev
->
löks
[
lök
].
addr
, 
¸
->links[link].addr,

871 
ETH_ALEN
);

874 
	`cfg80211_u∂ﬂd_c⁄√˘_keys
(
wdev
);

876 
	`rcu_ªad_lock
();

877 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
) {

878 
cou¡ry_ñem
 =

879 
	`õì80211_bss_gë_ñem
(
¸
->
löks
[
lök
].
bss
,

880 
WLAN_EID_COUNTRY
);

881 i‡(
cou¡ry_ñem
)

884 i‡(!
cou¡ry_ñem
) {

885 
	`rcu_ªad_u∆ock
();

889 
cou¡ry_d©Æí
 = 
cou¡ry_ñem
->
d©Æí
;

890 
cou¡ry_d©a
 = 
	`kmemdup
(
cou¡ry_ñem
->
d©a
, 
cou¡ry_d©Æí
, 
GFP_ATOMIC
);

891 
	`rcu_ªad_u∆ock
();

893 i‡(!
cou¡ry_d©a
)

896 
	`ªguœt‹y_höt_cou¡ry_õ
(
wdev
->
wùhy
,

897 
¸
->
löks
[
lök
].
bss
->
ch™√l
->
b™d
,

898 
cou¡ry_d©a
, 
cou¡ry_d©Æí
);

899 
	`k‰ì
(
cou¡ry_d©a
);

901 i‡(!
wdev
->
u
.
˛õ¡
.
ssid_Àn
) {

902 
	`rcu_ªad_lock
();

903 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
) {

904 
ssid
 = 
	`õì80211_bss_gë_ñem
(
¸
->
löks
[
lök
].
bss
,

905 
WLAN_EID_SSID
);

907 i‡(!
ssid
 || !ssid->
d©Æí
)

910 
	`mem˝y
(
wdev
->
u
.
˛õ¡
.
ssid
, ssid->
d©a
, ssid->
d©Æí
);

911 
wdev
->
u
.
˛õ¡
.
ssid_Àn
 = 
ssid
->
d©Æí
;

914 
	`rcu_ªad_u∆ock
();

918 
out
:

919 
	`f‹_óch_vÆid_lök
(
¸
, 
lök
)

920 
	`cfg80211_put_bss
(
wdev
->
wùhy
, 
¸
->
löks
[
lök
].
bss
);

921 
	}
}

923 
	$cfg80211_upd©e_lök_bss
(
wúñess_dev
 *
wdev
,

924 
cfg80211_bss
 **
bss
)

926 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

927 
cfg80211_öã∫Æ_bss
 *
ibss
;

929 i‡(!*
bss
)

932 
ibss
 = 
	`bss_‰om_pub
(*
bss
);

933 i‡(
	`li°_em±y
(&
ibss
->
li°
)) {

934 
cfg80211_bss
 *
found
 = 
NULL
, *
tmp
 = *
bss
;

936 
found
 = 
	`cfg80211_gë_bss
(
wdev
->
wùhy
, 
NULL
,

937 (*
bss
)->
bssid
,

938 
wdev
->
u
.
˛õ¡
.
ssid
,

939 
wdev
->
u
.
˛õ¡
.
ssid_Àn
,

940 
wdev
->
c⁄n_bss_ty≥
,

941 
IEEE80211_PRIVACY_ANY
);

942 i‡(
found
) {

946 *
bss
 = 
found
;

957 
	`cfg80211_bss_upd©e
(
rdev
, 
ibss
, 
Ál£
,

958 
ibss
->
ts
);

961 
	`cfg80211_put_bss
(
wdev
->
wùhy
, 
tmp
);

963 
	}
}

966 
	$cfg80211_c⁄√˘_d⁄e
(
√t_devi˚
 *
dev
,

967 
cfg80211_c⁄√˘_ª•_∑øms
 *
∑øms
,

968 
gÂ_t
 
gÂ
)

970 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

971 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

972 
cfg80211_evít
 *
ev
;

973 
Êags
;

974 
u8
 *
√xt
;

975 
size_t
 
lök_öfo_size
 = 0;

976 
lök
;

978 
	`f‹_óch_vÆid_lök
(
∑øms
, 
lök
) {

979 
	`cfg80211_upd©e_lök_bss
(
wdev
, &
∑øms
->
löks
[
lök
].
bss
);

980 
lök_öfo_size
 +
∑øms
->
löks
[
lök
].
bssid
 ? 
ETH_ALEN
 : 0;

981 
lök_öfo_size
 +
∑øms
->
löks
[
lök
].
addr
 ? 
ETH_ALEN
 : 0;

984 
ev
 = 
	`kzÆloc
((*evË+ (
∑øms
->
≠_mld_addr
 ? 
ETH_ALEN
 : 0) +

985 
∑øms
->
ªq_õ_Àn
 +Ö¨ams->
ª•_õ_Àn
 +

986 
∑øms
->
fûs
.
kek_Àn
 +Ö¨ams->fûs.
pmk_Àn
 +

987 (
∑øms
->
fûs
.
pmkid
 ? 
WLAN_PMKID_LEN
 : 0Ë+ 
lök_öfo_size
,

988 
gÂ
);

990 i‡(!
ev
) {

991 
	`f‹_óch_vÆid_lök
(
∑øms
, 
lök
)

992 
	`cfg80211_put_bss
(
wdev
->
wùhy
,

993 
∑øms
->
löks
[
lök
].
bss
);

997 
ev
->
ty≥
 = 
EVENT_CONNECT_RESULT
;

998 
√xt
 = ((
u8
 *)
ev
) + (*ev);

999 i‡(
∑øms
->
≠_mld_addr
) {

1000 
ev
->
¸
.
≠_mld_addr
 = 
√xt
;

1001 
	`mem˝y
((*)
ev
->
¸
.
≠_mld_addr
, 
∑øms
->ap_mld_addr,

1002 
ETH_ALEN
);

1003 
√xt
 +
ETH_ALEN
;

1005 i‡(
∑øms
->
ªq_õ_Àn
) {

1006 
ev
->
¸
.
ªq_õ
 = 
√xt
;

1007 
ev
->
¸
.
ªq_õ_Àn
 = 
∑øms
->req_ie_len;

1008 
	`mem˝y
((*)
ev
->
¸
.
ªq_õ
, 
∑øms
->req_ie,

1009 
∑øms
->
ªq_õ_Àn
);

1010 
√xt
 +
∑øms
->
ªq_õ_Àn
;

1012 i‡(
∑øms
->
ª•_õ_Àn
) {

1013 
ev
->
¸
.
ª•_õ
 = 
√xt
;

1014 
ev
->
¸
.
ª•_õ_Àn
 = 
∑øms
->resp_ie_len;

1015 
	`mem˝y
((*)
ev
->
¸
.
ª•_õ
, 
∑øms
->resp_ie,

1016 
∑øms
->
ª•_õ_Àn
);

1017 
√xt
 +
∑øms
->
ª•_õ_Àn
;

1019 i‡(
∑øms
->
fûs
.
kek_Àn
) {

1020 
ev
->
¸
.
fûs
.
kek
 = 
√xt
;

1021 
ev
->
¸
.
fûs
.
kek_Àn
 = 
∑øms
->fils.kek_len;

1022 
	`mem˝y
((*)
ev
->
¸
.
fûs
.
kek
, 
∑øms
->fils.kek,

1023 
∑øms
->
fûs
.
kek_Àn
);

1024 
√xt
 +
∑øms
->
fûs
.
kek_Àn
;

1026 i‡(
∑øms
->
fûs
.
pmk_Àn
) {

1027 
ev
->
¸
.
fûs
.
pmk
 = 
√xt
;

1028 
ev
->
¸
.
fûs
.
pmk_Àn
 = 
∑øms
->fils.pmk_len;

1029 
	`mem˝y
((*)
ev
->
¸
.
fûs
.
pmk
, 
∑øms
->fils.pmk,

1030 
∑øms
->
fûs
.
pmk_Àn
);

1031 
√xt
 +
∑øms
->
fûs
.
pmk_Àn
;

1033 i‡(
∑øms
->
fûs
.
pmkid
) {

1034 
ev
->
¸
.
fûs
.
pmkid
 = 
√xt
;

1035 
	`mem˝y
((*)
ev
->
¸
.
fûs
.
pmkid
, 
∑øms
->fils.pmkid,

1036 
WLAN_PMKID_LEN
);

1037 
√xt
 +
WLAN_PMKID_LEN
;

1039 
ev
->
¸
.
fûs
.
upd©e_îp_√xt_£q_num
 = 
∑øms
->fils.update_erp_next_seq_num;

1040 i‡(
∑øms
->
fûs
.
upd©e_îp_√xt_£q_num
)

1041 
ev
->
¸
.
fûs
.
îp_√xt_£q_num
 = 
∑øms
->fils.erp_next_seq_num;

1042 
ev
->
¸
.
vÆid_löks
 = 
∑øms
->valid_links;

1043 
	`f‹_óch_vÆid_lök
(
∑øms
, 
lök
) {

1044 i‡(
∑øms
->
löks
[
lök
].
bss
)

1045 
	`cfg80211_hﬁd_bss
(

1046 
	`bss_‰om_pub
(
∑øms
->
löks
[
lök
].
bss
));

1047 
ev
->
¸
.
löks
[
lök
].
bss
 = 
∑øms
->links[link].bss;

1049 i‡(
∑øms
->
löks
[
lök
].
addr
) {

1050 
ev
->
¸
.
löks
[
lök
].
addr
 = 
√xt
;

1051 
	`mem˝y
((*)
ev
->
¸
.
löks
[
lök
].
addr
,

1052 
∑øms
->
löks
[
lök
].
addr
,

1053 
ETH_ALEN
);

1054 
√xt
 +
ETH_ALEN
;

1056 i‡(
∑øms
->
löks
[
lök
].
bssid
) {

1057 
ev
->
¸
.
löks
[
lök
].
bssid
 = 
√xt
;

1058 
	`mem˝y
((*)
ev
->
¸
.
löks
[
lök
].
bssid
,

1059 
∑øms
->
löks
[
lök
].
bssid
,

1060 
ETH_ALEN
);

1061 
√xt
 +
ETH_ALEN
;

1064 
ev
->
¸
.
°©us
 = 
∑øms
->status;

1065 
ev
->
¸
.
timeout_ªas⁄
 = 
∑øms
->timeout_reason;

1067 
	`•ö_lock_úqßve
(&
wdev
->
evít_lock
, 
Êags
);

1068 
	`li°_add_èû
(&
ev
->
li°
, &
wdev
->
evít_li°
);

1069 
	`•ö_u∆ock_úqª°‹e
(&
wdev
->
evít_lock
, 
Êags
);

1070 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
evít_w‹k
);

1071 
	}
}

1072 
EXPORT_SYMBOL
(
cfg80211_c⁄√˘_d⁄e
);

1075 
	$__cfg80211_rﬂmed
(
wúñess_dev
 *
wdev
,

1076 
cfg80211_rﬂm_öfo
 *
öfo
)

1078 #ifde‡
CONFIG_CFG80211_WEXT


1079 
iwªq_d©a
 
wrqu
;

1081 
lök
;

1082 c⁄° 
u8
 *
c⁄√˘ed_addr
;

1084 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

1086 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

1087 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
))

1088 
out
;

1090 i‡(
	`WARN_ON
(!
wdev
->
c⁄√˘ed
))

1091 
out
;

1093 i‡(
öfo
->
vÆid_löks
) {

1094 i‡(
	`WARN_ON
(!
öfo
->
≠_mld_addr
))

1095 
out
;

1097 
	`f‹_óch_vÆid_lök
(
öfo
, 
lök
) {

1098 i‡(
	`WARN_ON
(!
öfo
->
löks
[
lök
].
addr
))

1099 
out
;

1103 
	`cfg80211_wdev_ªÀa£_bs£s
(
wdev
);

1105 
	`f‹_óch_vÆid_lök
(
öfo
, 
lök
) {

1106 i‡(
	`WARN_ON
(!
öfo
->
löks
[
lök
].
bss
))

1107 
out
;

1110 
	`mem£t
(
wdev
->
löks
, 0, (wdev->links));

1111 
wdev
->
vÆid_löks
 = 
öfo
->valid_links;

1112 
	`f‹_óch_vÆid_lök
(
öfo
, 
lök
) {

1113 
	`cfg80211_hﬁd_bss
(
	`bss_‰om_pub
(
öfo
->
löks
[
lök
].
bss
));

1114 
wdev
->
löks
[
lök
].
˛õ¡
.
cuºít_bss
 =

1115 
	`bss_‰om_pub
(
öfo
->
löks
[
lök
].
bss
);

1118 
c⁄√˘ed_addr
 = 
öfo
->
vÆid_löks
 ?

1119 
öfo
->
≠_mld_addr
 :

1120 
öfo
->
löks
[0].
bss
->
bssid
;

1121 
	`ëhî_addr_c›y
(
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
, connected_addr);

1122 i‡(
öfo
->
vÆid_löks
) {

1123 
	`f‹_óch_vÆid_lök
(
öfo
, 
lök
)

1124 
	`mem˝y
(
wdev
->
löks
[
lök
].
addr
, 
öfo
->links[link].addr,

1125 
ETH_ALEN
);

1127 
wdev
->
u≈rŸ_bóc⁄_ªp‹ãd
 = 0;

1128 
	`∆80211_£nd_rﬂmed
(
	`wùhy_to_rdev
(
wdev
->
wùhy
),

1129 
wdev
->
√tdev
, 
öfo
, 
GFP_KERNEL
);

1131 #ifde‡
CONFIG_CFG80211_WEXT


1132 i‡(!
öfo
->
vÆid_löks
) {

1133 i‡(
öfo
->
ªq_õ
) {

1134 
	`mem£t
(&
wrqu
, 0, (wrqu));

1135 
wrqu
.
d©a
.
Àngth
 = 
öfo
->
ªq_õ_Àn
;

1136 
	`wúñess_£nd_evít
(
wdev
->
√tdev
, 
IWEVASSOCREQIE
,

1137 &
wrqu
, 
öfo
->
ªq_õ
);

1140 i‡(
öfo
->
ª•_õ
) {

1141 
	`mem£t
(&
wrqu
, 0, (wrqu));

1142 
wrqu
.
d©a
.
Àngth
 = 
öfo
->
ª•_õ_Àn
;

1143 
	`wúñess_£nd_evít
(
wdev
->
√tdev
, 
IWEVASSOCRESPIE
,

1144 &
wrqu
, 
öfo
->
ª•_õ
);

1147 
	`mem£t
(&
wrqu
, 0, (wrqu));

1148 
wrqu
.
≠_addr
.
ß_Ámûy
 = 
ARPHRD_ETHER
;

1149 
	`mem˝y
(
wrqu
.
≠_addr
.
ß_d©a
, 
c⁄√˘ed_addr
, 
ETH_ALEN
);

1150 
	`mem˝y
(
wdev
->
wext
.
¥ev_bssid
, 
c⁄√˘ed_addr
, 
ETH_ALEN
);

1151 
wdev
->
wext
.
¥ev_bssid_vÆid
 = 
åue
;

1152 
	`wúñess_£nd_evít
(
wdev
->
√tdev
, 
SIOCGIWAP
, &
wrqu
, 
NULL
);

1157 
out
:

1158 
	`f‹_óch_vÆid_lök
(
öfo
, 
lök
)

1159 
	`cfg80211_put_bss
(
wdev
->
wùhy
, 
öfo
->
löks
[
lök
].
bss
);

1160 
	}
}

1163 
	$cfg80211_rﬂmed
(
√t_devi˚
 *
dev
, 
cfg80211_rﬂm_öfo
 *
öfo
,

1164 
gÂ_t
 
gÂ
)

1166 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1167 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1168 
cfg80211_evít
 *
ev
;

1169 
Êags
;

1170 
u8
 *
√xt
;

1171 
lök
;

1172 
size_t
 
lök_öfo_size
 = 0;

1173 
boﬁ
 
bss_nŸ_found
 = 
Ál£
;

1175 
	`f‹_óch_vÆid_lök
(
öfo
, 
lök
) {

1176 
lök_öfo_size
 +
öfo
->
löks
[
lök
].
addr
 ? 
ETH_ALEN
 : 0;

1177 
lök_öfo_size
 +
öfo
->
löks
[
lök
].
bssid
 ? 
ETH_ALEN
 : 0;

1179 i‡(
öfo
->
löks
[
lök
].
bss
)

1182 
öfo
->
löks
[
lök
].
bss
 =

1183 
	`cfg80211_gë_bss
(
wdev
->
wùhy
,

1184 
öfo
->
löks
[
lök
].
ch™√l
,

1185 
öfo
->
löks
[
lök
].
bssid
,

1186 
wdev
->
u
.
˛õ¡
.
ssid
,

1187 
wdev
->
u
.
˛õ¡
.
ssid_Àn
,

1188 
wdev
->
c⁄n_bss_ty≥
,

1189 
IEEE80211_PRIVACY_ANY
);

1191 i‡(!
öfo
->
löks
[
lök
].
bss
) {

1192 
bss_nŸ_found
 = 
åue
;

1197 i‡(
	`WARN_ON
(
bss_nŸ_found
))

1198 
out
;

1200 
ev
 = 
	`kzÆloc
((*evË+ 
öfo
->
ªq_õ_Àn
 + info->
ª•_õ_Àn
 +

1201 
öfo
->
fûs
.
kek_Àn
 + info->fûs.
pmk_Àn
 +

1202 (
öfo
->
fûs
.
pmkid
 ? 
WLAN_PMKID_LEN
 : 0) +

1203 (
öfo
->
≠_mld_addr
 ? 
ETH_ALEN
 : 0Ë+ 
lök_öfo_size
, 
gÂ
);

1204 i‡(!
ev
)

1205 
out
;

1207 
ev
->
ty≥
 = 
EVENT_ROAMED
;

1208 
√xt
 = ((
u8
 *)
ev
) + (*ev);

1209 i‡(
öfo
->
ªq_õ_Àn
) {

1210 
ev
->
rm
.
ªq_õ
 = 
√xt
;

1211 
ev
->
rm
.
ªq_õ_Àn
 = 
öfo
->req_ie_len;

1212 
	`mem˝y
((*)
ev
->
rm
.
ªq_õ
, 
öfo
->ªq_õ, info->
ªq_õ_Àn
);

1213 
√xt
 +
öfo
->
ªq_õ_Àn
;

1215 i‡(
öfo
->
ª•_õ_Àn
) {

1216 
ev
->
rm
.
ª•_õ
 = 
√xt
;

1217 
ev
->
rm
.
ª•_õ_Àn
 = 
öfo
->resp_ie_len;

1218 
	`mem˝y
((*)
ev
->
rm
.
ª•_õ
, 
öfo
->resp_ie,

1219 
öfo
->
ª•_õ_Àn
);

1220 
√xt
 +
öfo
->
ª•_õ_Àn
;

1222 i‡(
öfo
->
fûs
.
kek_Àn
) {

1223 
ev
->
rm
.
fûs
.
kek
 = 
√xt
;

1224 
ev
->
rm
.
fûs
.
kek_Àn
 = 
öfo
->fils.kek_len;

1225 
	`mem˝y
((*)
ev
->
rm
.
fûs
.
kek
, 
öfo
->fils.kek,

1226 
öfo
->
fûs
.
kek_Àn
);

1227 
√xt
 +
öfo
->
fûs
.
kek_Àn
;

1229 i‡(
öfo
->
fûs
.
pmk_Àn
) {

1230 
ev
->
rm
.
fûs
.
pmk
 = 
√xt
;

1231 
ev
->
rm
.
fûs
.
pmk_Àn
 = 
öfo
->fils.pmk_len;

1232 
	`mem˝y
((*)
ev
->
rm
.
fûs
.
pmk
, 
öfo
->fils.pmk,

1233 
öfo
->
fûs
.
pmk_Àn
);

1234 
√xt
 +
öfo
->
fûs
.
pmk_Àn
;

1236 i‡(
öfo
->
fûs
.
pmkid
) {

1237 
ev
->
rm
.
fûs
.
pmkid
 = 
√xt
;

1238 
	`mem˝y
((*)
ev
->
rm
.
fûs
.
pmkid
, 
öfo
->fils.pmkid,

1239 
WLAN_PMKID_LEN
);

1240 
√xt
 +
WLAN_PMKID_LEN
;

1242 
ev
->
rm
.
fûs
.
upd©e_îp_√xt_£q_num
 = 
öfo
->fils.update_erp_next_seq_num;

1243 i‡(
öfo
->
fûs
.
upd©e_îp_√xt_£q_num
)

1244 
ev
->
rm
.
fûs
.
îp_√xt_£q_num
 = 
öfo
->fils.erp_next_seq_num;

1245 i‡(
öfo
->
≠_mld_addr
) {

1246 
ev
->
rm
.
≠_mld_addr
 = 
√xt
;

1247 
	`mem˝y
((*)
ev
->
rm
.
≠_mld_addr
, 
öfo
->ap_mld_addr,

1248 
ETH_ALEN
);

1249 
√xt
 +
ETH_ALEN
;

1251 
ev
->
rm
.
vÆid_löks
 = 
öfo
->valid_links;

1252 
	`f‹_óch_vÆid_lök
(
öfo
, 
lök
) {

1253 
ev
->
rm
.
löks
[
lök
].
bss
 = 
öfo
->links[link].bss;

1255 i‡(
öfo
->
löks
[
lök
].
addr
) {

1256 
ev
->
rm
.
löks
[
lök
].
addr
 = 
√xt
;

1257 
	`mem˝y
((*)
ev
->
rm
.
löks
[
lök
].
addr
,

1258 
öfo
->
löks
[
lök
].
addr
,

1259 
ETH_ALEN
);

1260 
√xt
 +
ETH_ALEN
;

1263 i‡(
öfo
->
löks
[
lök
].
bssid
) {

1264 
ev
->
rm
.
löks
[
lök
].
bssid
 = 
√xt
;

1265 
	`mem˝y
((*)
ev
->
rm
.
löks
[
lök
].
bssid
,

1266 
öfo
->
löks
[
lök
].
bssid
,

1267 
ETH_ALEN
);

1268 
√xt
 +
ETH_ALEN
;

1272 
	`•ö_lock_úqßve
(&
wdev
->
evít_lock
, 
Êags
);

1273 
	`li°_add_èû
(&
ev
->
li°
, &
wdev
->
evít_li°
);

1274 
	`•ö_u∆ock_úqª°‹e
(&
wdev
->
evít_lock
, 
Êags
);

1275 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
evít_w‹k
);

1278 
out
:

1279 
	`f‹_óch_vÆid_lök
(
öfo
, 
lök
)

1280 
	`cfg80211_put_bss
(
wdev
->
wùhy
, 
öfo
->
löks
[
lök
].
bss
);

1282 
	}
}

1283 
EXPORT_SYMBOL
(
cfg80211_rﬂmed
);

1285 
	$__cfg80211_p‹t_auth‹ized
(
wúñess_dev
 *
wdev
, c⁄° 
u8
 *
≥î_addr
,

1286 c⁄° 
u8
 *
td_bôm≠
, u8 
td_bôm≠_Àn
)

1288 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

1290 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

1291 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
 &&

1292 
wdev
->
i·y≥
 !
NL80211_IFTYPE_AP
 &&

1293 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_GO
))

1296 i‡(
wdev
->
i·y≥
 =
NL80211_IFTYPE_STATION
 ||

1297 
wdev
->
i·y≥
 =
NL80211_IFTYPE_P2P_CLIENT
) {

1298 i‡(
	`WARN_ON
(!
wdev
->
c⁄√˘ed
) ||

1299 
	`WARN_ON
(!
	`ëhî_addr_equÆ
(
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
, 
≥î_addr
)))

1303 
	`∆80211_£nd_p‹t_auth‹ized
(
	`wùhy_to_rdev
(
wdev
->
wùhy
), wdev->
√tdev
,

1304 
≥î_addr
, 
td_bôm≠
, 
td_bôm≠_Àn
);

1305 
	}
}

1307 
	$cfg80211_p‹t_auth‹ized
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
≥î_addr
,

1308 c⁄° 
u8
 *
td_bôm≠
, u8 
td_bôm≠_Àn
, 
gÂ_t
 
gÂ
)

1310 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1311 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1312 
cfg80211_evít
 *
ev
;

1313 
Êags
;

1315 i‡(
	`WARN_ON
(!
≥î_addr
))

1318 
ev
 = 
	`kzÆloc
((*evË+ 
td_bôm≠_Àn
, 
gÂ
);

1319 i‡(!
ev
)

1322 
ev
->
ty≥
 = 
EVENT_PORT_AUTHORIZED
;

1323 
	`mem˝y
(
ev
->
∑
.
≥î_addr
,Öìr_addr, 
ETH_ALEN
);

1324 
ev
->
∑
.
td_bôm≠
 = ((
u8
 *)ev) + (*ev);

1325 
ev
->
∑
.
td_bôm≠_Àn
 =Åd_bitmap_len;

1326 
	`mem˝y
((*)
ev
->
∑
.
td_bôm≠
,Åd_bôm≠, 
td_bôm≠_Àn
);

1332 
	`•ö_lock_úqßve
(&
wdev
->
evít_lock
, 
Êags
);

1333 
	`li°_add_èû
(&
ev
->
li°
, &
wdev
->
evít_li°
);

1334 
	`•ö_u∆ock_úqª°‹e
(&
wdev
->
evít_lock
, 
Êags
);

1335 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
evít_w‹k
);

1336 
	}
}

1337 
EXPORT_SYMBOL
(
cfg80211_p‹t_auth‹ized
);

1339 
	$__cfg80211_disc⁄√˘ed
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
õ
,

1340 
size_t
 
õ_Àn
, 
u16
 
ªas⁄
, 
boﬁ
 
‰om_≠
)

1342 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1343 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1344 
i
;

1345 #ifde‡
CONFIG_CFG80211_WEXT


1346 
iwªq_d©a
 
wrqu
;

1349 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

1351 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

1352 
wdev
->
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
))

1355 
	`cfg80211_wdev_ªÀa£_bs£s
(
wdev
);

1356 
wdev
->
c⁄√˘ed
 = 
Ál£
;

1357 
wdev
->
u
.
˛õ¡
.
ssid_Àn
 = 0;

1358 
wdev
->
c⁄n_ow√r_∆p‹tid
 = 0;

1359 
	`k‰ì_£nsôive
(
wdev
->
c⁄√˘_keys
);

1360 
wdev
->
c⁄√˘_keys
 = 
NULL
;

1362 
	`∆80211_£nd_disc⁄√˘ed
(
rdev
, 
dev
, 
ªas⁄
, 
õ
, 
õ_Àn
, 
‰om_≠
);

1365 i‡(
rdev
->
›s
->
¸ô_¥Ÿo_°›
 &&Ñdev->
¸ô_¥Ÿo_∆p‹tid
) {

1366 
rdev
->
¸ô_¥Ÿo_∆p‹tid
 = 0;

1367 
	`rdev_¸ô_¥Ÿo_°›
(
rdev
, 
wdev
);

1374 i‡(
rdev
->
›s
->
dñ_key
) {

1375 
max_key_idx
 = 5;

1377 i‡(
	`wùhy_ext_„©uª_is£t
(

1378 
wdev
->
wùhy
,

1379 
NL80211_EXT_FEATURE_BEACON_PROTECTION
) ||

1380 
	`wùhy_ext_„©uª_is£t
(

1381 
wdev
->
wùhy
,

1382 
NL80211_EXT_FEATURE_BEACON_PROTECTION_CLIENT
))

1383 
max_key_idx
 = 7;

1384 
i
 = 0; i <
max_key_idx
; i++)

1385 
	`rdev_dñ_key
(
rdev
, 
dev
, -1, 
i
, 
Ál£
, 
NULL
);

1388 
	`rdev_£t_qos_m≠
(
rdev
, 
dev
, 
NULL
);

1390 #ifde‡
CONFIG_CFG80211_WEXT


1391 
	`mem£t
(&
wrqu
, 0, (wrqu));

1392 
wrqu
.
≠_addr
.
ß_Ámûy
 = 
ARPHRD_ETHER
;

1393 
	`wúñess_£nd_evít
(
dev
, 
SIOCGIWAP
, &
wrqu
, 
NULL
);

1394 
wdev
->
wext
.
c⁄√˘
.
ssid_Àn
 = 0;

1397 
	`scheduÀ_w‹k
(&
cfg80211_disc⁄√˘_w‹k
);

1399 
	`cfg80211_scheduÀ_ch™√ls_check
(
wdev
);

1400 
	}
}

1402 
	$cfg80211_disc⁄√˘ed
(
√t_devi˚
 *
dev
, 
u16
 
ªas⁄
,

1403 c⁄° 
u8
 *
õ
, 
size_t
 
õ_Àn
,

1404 
boﬁ
 
loˇŒy_gíî©ed
, 
gÂ_t
 
gÂ
)

1406 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1407 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1408 
cfg80211_evít
 *
ev
;

1409 
Êags
;

1411 
ev
 = 
	`kzÆloc
((*evË+ 
õ_Àn
, 
gÂ
);

1412 i‡(!
ev
)

1415 
ev
->
ty≥
 = 
EVENT_DISCONNECTED
;

1416 
ev
->
dc
.
õ
 = ((
u8
 *)ev) + (*ev);

1417 
ev
->
dc
.
õ_Àn
 = ie_len;

1418 
	`mem˝y
((*)
ev
->
dc
.
õ
, ie, 
õ_Àn
);

1419 
ev
->
dc
.
ªas⁄
 =Ñeason;

1420 
ev
->
dc
.
loˇŒy_gíî©ed
 =Üocally_generated;

1422 
	`•ö_lock_úqßve
(&
wdev
->
evít_lock
, 
Êags
);

1423 
	`li°_add_èû
(&
ev
->
li°
, &
wdev
->
evít_li°
);

1424 
	`•ö_u∆ock_úqª°‹e
(&
wdev
->
evít_lock
, 
Êags
);

1425 
	`queue_w‹k
(
cfg80211_wq
, &
rdev
->
evít_w‹k
);

1426 
	}
}

1427 
EXPORT_SYMBOL
(
cfg80211_disc⁄√˘ed
);

1432 
	$cfg80211_c⁄√˘
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1433 
√t_devi˚
 *
dev
,

1434 
cfg80211_c⁄√˘_∑øms
 *
c⁄√˘
,

1435 
cfg80211_ˇched_keys
 *
c⁄nkeys
,

1436 c⁄° 
u8
 *
¥ev_bssid
)

1438 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1439 
îr
;

1441 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

1448 i‡(
wdev
->
u
.
˛õ¡
.
ssid_Àn
 &&

1449 (
wdev
->
u
.
˛õ¡
.
ssid_Àn
 !
c⁄√˘
->ssid_len ||

1450 
	`memcmp
(
wdev
->
u
.
˛õ¡
.
ssid
, 
c⁄√˘
->ssid, wdev->u.˛õ¡.
ssid_Àn
)))

1451  -
EALREADY
;

1457 i‡(
wdev
->
c⁄√˘ed
) {

1458 i‡(!
¥ev_bssid
)

1459  -
EALREADY
;

1460 i‡(!
	`ëhî_addr_equÆ
(
¥ev_bssid
,

1461 
wdev
->
u
.
˛õ¡
.
c⁄√˘ed_addr
))

1462  -
ENOTCONN
;

1470 i‡(
wdev
->
c⁄√˘_keys
)

1471  -
EINPROGRESS
;

1473 
	`cfg80211_›î_™d_ht_ˇ∑
(&
c⁄√˘
->
ht_ˇ∑_mask
,

1474 
rdev
->
wùhy
.
ht_ˇ∑_mod_mask
);

1475 
	`cfg80211_›î_™d_vht_ˇ∑
(&
c⁄√˘
->
vht_ˇ∑_mask
,

1476 
rdev
->
wùhy
.
vht_ˇ∑_mod_mask
);

1478 i‡(
c⁄nkeys
 && c⁄nkeys->
def
 >= 0) {

1479 
idx
;

1480 
u32
 
cùhî
;

1482 
idx
 = 
c⁄nkeys
->
def
;

1483 
cùhî
 = 
c⁄nkeys
->
∑øms
[
idx
].cipher;

1485 i‡(
cùhî
 =
WLAN_CIPHER_SUITE_WEP40
 ||

1486 
cùhî
 =
WLAN_CIPHER_SUITE_WEP104
) {

1487 
c⁄√˘
->
key_idx
 = 
idx
;

1488 
c⁄√˘
->
key
 = 
c⁄nkeys
->
∑øms
[
idx
].key;

1489 
c⁄√˘
->
key_Àn
 = 
c⁄nkeys
->
∑øms
[
idx
].key_len;

1495 i‡(
c⁄√˘
->
¸y±o
.
cùhî_group
 == 0)

1496 
c⁄√˘
->
¸y±o
.
cùhî_group
 = 
cùhî
;

1498 i‡(
c⁄√˘
->
¸y±o
.
n_cùhîs_∑úwi£
 == 0) {

1499 
c⁄√˘
->
¸y±o
.
n_cùhîs_∑úwi£
 = 1;

1500 
c⁄√˘
->
¸y±o
.
cùhîs_∑úwi£
[0] = 
cùhî
;

1504 i‡(
	`WARN_ON
(
c⁄nkeys
))

1505  -
EINVAL
;

1510 
c⁄√˘
->
key
 = 
NULL
;

1511 
c⁄√˘
->
key_Àn
 = 0;

1512 
c⁄√˘
->
key_idx
 = 0;

1515 
wdev
->
c⁄√˘_keys
 = 
c⁄nkeys
;

1516 
	`mem˝y
(
wdev
->
u
.
˛õ¡
.
ssid
, 
c⁄√˘
->ssid, c⁄√˘->
ssid_Àn
);

1517 
wdev
->
u
.
˛õ¡
.
ssid_Àn
 = 
c⁄√˘
->ssid_len;

1519 
wdev
->
c⁄n_bss_ty≥
 = 
c⁄√˘
->
pbss
 ? 
IEEE80211_BSS_TYPE_PBSS
 :

1520 
IEEE80211_BSS_TYPE_ESS
;

1522 i‡(!
rdev
->
›s
->
c⁄√˘
)

1523 
îr
 = 
	`cfg80211_sme_c⁄√˘
(
wdev
, 
c⁄√˘
, 
¥ev_bssid
);

1525 
îr
 = 
	`rdev_c⁄√˘
(
rdev
, 
dev
, 
c⁄√˘
);

1527 i‡(
îr
) {

1528 
wdev
->
c⁄√˘_keys
 = 
NULL
;

1533 i‡(!
wdev
->
c⁄√˘ed
)

1534 
wdev
->
u
.
˛õ¡
.
ssid_Àn
 = 0;

1535  
îr
;

1539 
	}
}

1541 
	$cfg80211_disc⁄√˘
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1542 
√t_devi˚
 *
dev
, 
u16
 
ªas⁄
, 
boﬁ
 
wexãv
)

1544 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1545 
îr
 = 0;

1547 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

1549 
	`k‰ì_£nsôive
(
wdev
->
c⁄√˘_keys
);

1550 
wdev
->
c⁄√˘_keys
 = 
NULL
;

1552 
wdev
->
c⁄n_ow√r_∆p‹tid
 = 0;

1554 i‡(
wdev
->
c⁄n
)

1555 
îr
 = 
	`cfg80211_sme_disc⁄√˘
(
wdev
, 
ªas⁄
);

1556 i‡(!
rdev
->
›s
->
disc⁄√˘
)

1557 
	`cfg80211_mlme_down
(
rdev
, 
dev
);

1558 i‡(
wdev
->
u
.
˛õ¡
.
ssid_Àn
)

1559 
îr
 = 
	`rdev_disc⁄√˘
(
rdev
, 
dev
, 
ªas⁄
);

1566 i‡(!
wdev
->
c⁄√˘ed
)

1567 
wdev
->
u
.
˛õ¡
.
ssid_Àn
 = 0;

1569  
îr
;

1570 
	}
}

1576 
	$cfg80211_autodisc⁄√˘_wk
(
w‹k_°ru˘
 *
w‹k
)

1578 
wúñess_dev
 *
wdev
 =

1579 
	`c⁄èöî_of
(
w‹k
, 
wúñess_dev
, 
disc⁄√˘_wk
);

1580 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1582 
	`wùhy_lock
(
wdev
->
wùhy
);

1584 i‡(
wdev
->
c⁄n_ow√r_∆p‹tid
) {

1585 
wdev
->
i·y≥
) {

1586 
NL80211_IFTYPE_ADHOC
:

1587 
	`cfg80211_Àave_ibss
(
rdev
, 
wdev
->
√tdev
, 
Ál£
);

1589 
NL80211_IFTYPE_AP
:

1590 
NL80211_IFTYPE_P2P_GO
:

1591 
	`cfg80211_°›_≠
(
rdev
, 
wdev
->
√tdev
, -1, 
Ál£
);

1593 
NL80211_IFTYPE_MESH_POINT
:

1594 
	`cfg80211_Àave_mesh
(
rdev
, 
wdev
->
√tdev
);

1596 
NL80211_IFTYPE_STATION
:

1597 
NL80211_IFTYPE_P2P_CLIENT
:

1603 i‡(
rdev
->
›s
->
disc⁄√˘
 || 
wdev
->
c⁄√˘ed
)

1604 
	`cfg80211_disc⁄√˘
(
rdev
, 
wdev
->
√tdev
,

1605 
WLAN_REASON_DEAUTH_LEAVING
,

1606 
åue
);

1608 
	`cfg80211_mlme_dóuth
(
rdev
, 
wdev
->
√tdev
,

1609 
wdev
->
disc⁄√˘_bssid
,

1610 
NULL
, 0,

1611 
WLAN_REASON_DEAUTH_LEAVING
,

1612 
Ál£
);

1619 
	`wùhy_u∆ock
(
wdev
->
wùhy
);

1620 
	}
}

	@sysfs.c

11 
	~<löux/devi˚.h
>

12 
	~<löux/moduÀ.h
>

13 
	~<löux/√tdevi˚.h
>

14 
	~<löux/∆80211.h
>

15 
	~<löux/π√éök.h
>

16 
	~<√t/cfg80211.h
>

17 
	~"sysfs.h
"

18 
	~"c‹e.h
"

19 
	~"rdev-›s.h
"

21 
ölöe
 
cfg80211_ªgi°îed_devi˚
 *
	$dev_to_rdev
(

22 
devi˚
 *
dev
)

24  
	`c⁄èöî_of
(
dev
, 
cfg80211_ªgi°îed_devi˚
, 
wùhy
.dev);

25 
	}
}

27 
	#SHOW_FMT
(
«me
, 
fmt
, 
membî
) \

28 
ssize_t
 
«me
 ## 
	`_show
(
devi˚
 *
dev
, \

29 
devi˚_©åibuã
 *
©å
, \

30 *
buf
) \

32  
	`•rötf
(
buf
, 
fmt
 "\n", 
	`dev_to_rdev
(
dev
)->
membî
); \

34 
	`DEVICE_ATTR_RO
(
«me
)

	)

36 
SHOW_FMT
(
ödex
, "%d", 
wùhy_idx
);

37 
SHOW_FMT
(
maˇddªss
, "%pM", 
wùhy
.
≥rm_addr
);

38 
SHOW_FMT
(
addªss_mask
, "%pM", 
wùhy
.
addr_mask
);

40 
ssize_t
 
	$«me_show
(
devi˚
 *
dev
,

41 
devi˚_©åibuã
 *
©å
,

42 *
buf
)

44 
wùhy
 *wùhy = &
	`dev_to_rdev
(
dev
)->wiphy;

46  
	`•rötf
(
buf
, "%s\n", 
	`wùhy_«me
(
wùhy
));

47 
	}
}

48 
DEVICE_ATTR_RO
(
«me
);

50 
ssize_t
 
	$addªs£s_show
(
devi˚
 *
dev
,

51 
devi˚_©åibuã
 *
©å
,

52 *
buf
)

54 
wùhy
 *wùhy = &
	`dev_to_rdev
(
dev
)->wiphy;

55 *
°¨t
 = 
buf
;

56 
i
;

58 i‡(!
wùhy
->
addªs£s
)

59  
	`•rötf
(
buf
, "%pM\n", 
wùhy
->
≥rm_addr
);

61 
i
 = 0; i < 
wùhy
->
n_addªs£s
; i++)

62 
buf
 +
	`•rötf
(buf, "%pM\n", 
wùhy
->
addªs£s
[
i
].
addr
);

64  
buf
 - 
°¨t
;

65 
	}
}

66 
DEVICE_ATTR_RO
(
addªs£s
);

68 
©åibuã
 *
	gõì80211_©ås
[] = {

69 &
dev_©å_ödex
.
©å
,

70 &
dev_©å_maˇddªss
.
©å
,

71 &
dev_©å_addªss_mask
.
©å
,

72 &
dev_©å_addªs£s
.
©å
,

73 &
dev_©å_«me
.
©å
,

74 
NULL
,

76 
ATTRIBUTE_GROUPS
(
õì80211
);

78 
	$wùhy_dev_ªÀa£
(
devi˚
 *
dev
)

80 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`dev_to_rdev
(
dev
);

82 
	`cfg80211_dev_‰ì
(
rdev
);

83 
	}
}

85 #ifde‡
CONFIG_PM_SLEEP


86 
	$cfg80211_Àave_Æl
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

88 
wúñess_dev
 *
wdev
;

90 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
)

91 
	`cfg80211_Àave
(
rdev
, 
wdev
);

92 
	}
}

94 
	$wùhy_su•íd
(
devi˚
 *
dev
)

96 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`dev_to_rdev
(
dev
);

97 
ªt
 = 0;

99 
rdev
->
su•íd_©
 = 
	`ktime_gë_boŸtime_£c⁄ds
();

101 
	`π∆_lock
();

102 
	`wùhy_lock
(&
rdev
->
wùhy
);

103 i‡(
rdev
->
wùhy
.
ªgi°îed
) {

104 i‡(!
rdev
->
wùhy
.
wowœn_c⁄fig
) {

105 
	`cfg80211_Àave_Æl
(
rdev
);

106 
	`cfg80211_¥o˚ss_rdev_evíts
(
rdev
);

108 
	`cfg80211_¥o˚ss_wùhy_w‹ks
(
rdev
, 
NULL
);

109 i‡(
rdev
->
›s
->
su•íd
)

110 
ªt
 = 
	`rdev_su•íd
(
rdev
,Ñdev->
wùhy
.
wowœn_c⁄fig
);

111 i‡(
ªt
 == 1) {

113 
	`cfg80211_Àave_Æl
(
rdev
);

114 
	`cfg80211_¥o˚ss_rdev_evíts
(
rdev
);

115 
	`cfg80211_¥o˚ss_wùhy_w‹ks
(
rdev
, 
NULL
);

116 
ªt
 = 
	`rdev_su•íd
(
rdev
, 
NULL
);

118 i‡(
ªt
 == 0)

119 
rdev
->
su•íded
 = 
åue
;

121 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

122 
	`π∆_u∆ock
();

124  
ªt
;

125 
	}
}

127 
	$wùhy_ªsume
(
devi˚
 *
dev
)

129 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`dev_to_rdev
(
dev
);

130 
ªt
 = 0;

133 
	`cfg80211_bss_age
(
rdev
, 
	`ktime_gë_boŸtime_£c⁄ds
(Ë-Ñdev->
su•íd_©
);

135 
	`π∆_lock
();

136 
	`wùhy_lock
(&
rdev
->
wùhy
);

137 i‡(
rdev
->
wùhy
.
ªgi°îed
 &&Ñdev->
›s
->
ªsume
)

138 
ªt
 = 
	`rdev_ªsume
(
rdev
);

139 
rdev
->
su•íded
 = 
Ál£
;

140 
	`scheduÀ_w‹k
(&
rdev
->
wùhy_w‹k
);

141 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

143 i‡(
ªt
)

144 
	`cfg80211_shutdown_Æl_öãrÁ˚s
(&
rdev
->
wùhy
);

146 
	`π∆_u∆ock
();

148  
ªt
;

149 
	}
}

151 
SIMPLE_DEV_PM_OPS
(
wùhy_pm_›s
, 
wùhy_su•íd
, 
wùhy_ªsume
);

152 
	#WIPHY_PM_OPS
 (&
wùhy_pm_›s
)

	)

154 
	#WIPHY_PM_OPS
 
NULL


	)

157 c⁄° *
	$wùhy_«me•a˚
(c⁄° 
devi˚
 *
d
)

159 
wùhy
 *wùhy = 
	`c⁄èöî_of
(
d
, wùhy, 
dev
);

161  
	`wùhy_√t
(
wùhy
);

162 
	}
}

164 
˛ass
 
	gõì80211_˛ass
 = {

165 .
«me
 = "ieee80211",

166 .
	gdev_ªÀa£
 = 
wùhy_dev_ªÀa£
,

167 .
	gdev_groups
 = 
õì80211_groups
,

168 .
	gpm
 = 
WIPHY_PM_OPS
,

169 .
	gns_ty≥
 = &
√t_ns_ty≥_›î©i⁄s
,

170 .
	g«me•a˚
 = 
wùhy_«me•a˚
,

173 
	$wùhy_sysfs_öô
()

175  
	`˛ass_ªgi°î
(&
õì80211_˛ass
);

176 
	}
}

178 
	$wùhy_sysfs_exô
()

180 
	`˛ass_uƒegi°î
(&
õì80211_˛ass
);

181 
	}
}

	@sysfs.h

2 #i‚de‡
__WIRELESS_SYSFS_H


3 
	#__WIRELESS_SYSFS_H


	)

5 
wùhy_sysfs_öô
();

6 
wùhy_sysfs_exô
();

8 
˛ass
 
õì80211_˛ass
;

	@tests/chan.c

7 
	~<√t/cfg80211.h
>

8 
	~<kunô/ã°.h
>

10 
MODULE_IMPORT_NS
(
EXPORTED_FOR_KUNIT_TESTING
);

12 
õì80211_ch™√l
 
	gch™_6ghz_1
 = {

13 .
b™d
 = 
NL80211_BAND_6GHZ
,

14 .
	g˚¡î_‰eq
 = 5955,

17 
õì80211_ch™√l
 
	gch™_6ghz_5
 = {

18 .
b™d
 = 
NL80211_BAND_6GHZ
,

19 .
	g˚¡î_‰eq
 = 5975,

22 
õì80211_ch™√l
 
	gch™_6ghz_105
 = {

23 .
b™d
 = 
NL80211_BAND_6GHZ
,

24 .
	g˚¡î_‰eq
 = 6475,

27 c⁄° 
	sch™def_com∑t_ˇ£
 {

28 c⁄° *
	mdesc
;

30 
cfg80211_ch™_def
 
	mc1
, 
	mc2
;

32 
boﬁ
 
	mcom∑t
;

33 } 
	gch™def_com∑t_ˇ£s
[] = {

35 .
desc
 = "identicalÇon-HT",

36 .
	gc2
 = {

37 .
width
 = 
NL80211_CHAN_WIDTH_20_NOHT
,

38 .
	gch™
 = &
ch™_6ghz_1
,

39 .
	g˚¡î_‰eq1
 = 5955,

41 .
	gcom∑t
 = 
åue
,

44 .
	gdesc
 = "identical 20 MHz",

45 .
	gc2
 = {

46 .
width
 = 
NL80211_CHAN_WIDTH_20
,

47 .
	gch™
 = &
ch™_6ghz_1
,

48 .
	g˚¡î_‰eq1
 = 5955,

50 .
	gcom∑t
 = 
åue
,

53 .
	gdesc
 = "identical 40 MHz",

54 .
	gc2
 = {

55 .
width
 = 
NL80211_CHAN_WIDTH_40
,

56 .
	gch™
 = &
ch™_6ghz_1
,

57 .
	g˚¡î_‰eq1
 = 5955 + 10,

59 .
	gcom∑t
 = 
åue
,

62 .
	gdesc
 = "identical 80 MHz",

63 .
	gc2
 = {

64 .
width
 = 
NL80211_CHAN_WIDTH_80
,

65 .
	gch™
 = &
ch™_6ghz_1
,

66 .
	g˚¡î_‰eq1
 = 5955 + 10 + 20,

68 .
	gcom∑t
 = 
åue
,

71 .
	gdesc
 = "identical 160 MHz",

72 .
	gc2
 = {

73 .
width
 = 
NL80211_CHAN_WIDTH_160
,

74 .
	gch™
 = &
ch™_6ghz_1
,

75 .
	g˚¡î_‰eq1
 = 5955 + 10 + 20 + 40,

77 .
	gcom∑t
 = 
åue
,

80 .
	gdesc
 = "identical 320 MHz",

81 .
	gc2
 = {

82 .
width
 = 
NL80211_CHAN_WIDTH_320
,

83 .
	gch™
 = &
ch™_6ghz_1
,

84 .
	g˚¡î_‰eq1
 = 5955 + 10 + 20 + 40 + 80,

86 .
	gcom∑t
 = 
åue
,

89 .
	gdesc
 = "20 MHz in 320 MHz\n",

90 .
	gc1
 = {

91 .
width
 = 
NL80211_CHAN_WIDTH_20
,

92 .
	gch™
 = &
ch™_6ghz_1
,

93 .
	g˚¡î_‰eq1
 = 5955,

95 .
	gc2
 = {

96 .
width
 = 
NL80211_CHAN_WIDTH_320
,

97 .
	gch™
 = &
ch™_6ghz_1
,

98 .
	g˚¡î_‰eq1
 = 5955 + 10 + 20 + 40 + 80,

100 .
	gcom∑t
 = 
åue
,

103 .
	gdesc
 = "different 20 MHz",

104 .
	gc1
 = {

105 .
width
 = 
NL80211_CHAN_WIDTH_20
,

106 .
	gch™
 = &
ch™_6ghz_1
,

107 .
	g˚¡î_‰eq1
 = 5955,

109 .
	gc2
 = {

110 .
width
 = 
NL80211_CHAN_WIDTH_20
,

111 .
	gch™
 = &
ch™_6ghz_5
,

112 .
	g˚¡î_‰eq1
 = 5975,

116 .
	gdesc
 = "differentÖrimary 160 MHz",

117 .
	gc1
 = {

118 .
width
 = 
NL80211_CHAN_WIDTH_320
,

119 .
	gch™
 = &
ch™_6ghz_105
,

120 .
	g˚¡î_‰eq1
 = 6475 + 150,

122 .
	gc2
 = {

123 .
width
 = 
NL80211_CHAN_WIDTH_320
,

124 .
	gch™
 = &
ch™_6ghz_105
,

125 .
	g˚¡î_‰eq1
 = 6475 - 10,

130 .
	gdesc
 = "matchingÖrimary 160 MHz",

131 .
	gc1
 = {

132 .
width
 = 
NL80211_CHAN_WIDTH_160
,

133 .
	gch™
 = &
ch™_6ghz_105
,

134 .
	g˚¡î_‰eq1
 = 6475 + 70,

136 .
	gc2
 = {

137 .
width
 = 
NL80211_CHAN_WIDTH_320
,

138 .
	gch™
 = &
ch™_6ghz_105
,

139 .
	g˚¡î_‰eq1
 = 6475 - 10,

141 .
	gcom∑t
 = 
åue
,

144 .
	gdesc
 = "matchingÖrimary 160 MHz &Öunctured secondary 160 Mhz",

145 .
	gc1
 = {

146 .
width
 = 
NL80211_CHAN_WIDTH_160
,

147 .
	gch™
 = &
ch™_6ghz_105
,

148 .
	g˚¡î_‰eq1
 = 6475 + 70,

150 .
	gc2
 = {

151 .
width
 = 
NL80211_CHAN_WIDTH_320
,

152 .
	gch™
 = &
ch™_6ghz_105
,

153 .
	g˚¡î_‰eq1
 = 6475 - 10,

154 .
	gpun˘uªd
 = 0xf,

156 .
	gcom∑t
 = 
åue
,

159 .
	gdesc
 = "matchingÖrimary 160 MHz &Öunctured matching",

160 .
	gc1
 = {

161 .
width
 = 
NL80211_CHAN_WIDTH_160
,

162 .
	gch™
 = &
ch™_6ghz_105
,

163 .
	g˚¡î_‰eq1
 = 6475 + 70,

164 .
	gpun˘uªd
 = 0xc0,

166 .
	gc2
 = {

167 .
width
 = 
NL80211_CHAN_WIDTH_320
,

168 .
	gch™
 = &
ch™_6ghz_105
,

169 .
	g˚¡î_‰eq1
 = 6475 - 10,

170 .
	gpun˘uªd
 = 0xc000,

172 .
	gcom∑t
 = 
åue
,

175 .
	gdesc
 = "matchingÖrimary 160 MHz &ÖuncturedÇot matching",

176 .
	gc1
 = {

177 .
width
 = 
NL80211_CHAN_WIDTH_160
,

178 .
	gch™
 = &
ch™_6ghz_105
,

179 .
	g˚¡î_‰eq1
 = 6475 + 70,

180 .
	gpun˘uªd
 = 0x80,

182 .
	gc2
 = {

183 .
width
 = 
NL80211_CHAN_WIDTH_320
,

184 .
	gch™
 = &
ch™_6ghz_105
,

185 .
	g˚¡î_‰eq1
 = 6475 - 10,

186 .
	gpun˘uªd
 = 0xc000,

191 
	$KUNIT_ARRAY_PARAM_DESC
(
ch™def_com∑t
, 
ch™def_com∑t_ˇ£s
, 
desc
)

193 
	$ã°_ch™def_com∑t
(
kunô
 *
ã°
)

195 c⁄° 
ch™def_com∑t_ˇ£
 *
∑øms
 = 
ã°
->
∑øm_vÆue
;

196 c⁄° 
cfg80211_ch™_def
 *
ªt
, *
ex≥˘
;

197 
cfg80211_ch™_def
 
c1
 = 
∑øms
->c1;

200 i‡(!
∑øms
->
c1
.
ch™
)

201 
c1
 = 
∑øms
->
c2
;

203 
	`KUNIT_EXPECT_EQ
(
ã°
, 
	`cfg80211_ch™def_vÆid
(&
c1
), 
åue
);

204 
	`KUNIT_EXPECT_EQ
(
ã°
, 
	`cfg80211_ch™def_vÆid
(&
∑øms
->
c2
), 
åue
);

206 
ex≥˘
 = 
∑øms
->
com∑t
 ? &∑øms->
c2
 : 
NULL
;

208 
ªt
 = 
	`cfg80211_ch™def_com∑tibÀ
(&
c1
, &
∑øms
->
c2
);

209 
	`KUNIT_EXPECT_PTR_EQ
(
ã°
, 
ªt
, 
ex≥˘
);

211 i‡(!
∑øms
->
c1
.
ch™
)

212 
ex≥˘
 = &
c1
;

214 
ªt
 = 
	`cfg80211_ch™def_com∑tibÀ
(&
∑øms
->
c2
, &
c1
);

215 
	`KUNIT_EXPECT_PTR_EQ
(
ã°
, 
ªt
, 
ex≥˘
);

216 
	}
}

218 
kunô_ˇ£
 
	gch™def_com∑t_ã°_ˇ£s
[] = {

219 
KUNIT_CASE_PARAM
(
ã°_ch™def_com∑t
, 
ch™def_com∑t_gí_∑øms
),

223 
kunô_suôe
 
	gch™def_com∑t
 = {

224 .
«me
 = "cfg80211-chandef-compat",

225 .
	gã°_ˇ£s
 = 
ch™def_com∑t_ã°_ˇ£s
,

228 
kunô_ã°_suôe
(
ch™def_com∑t
);

	@tests/fragmentation.c

7 
	~<löux/õì80211.h
>

8 
	~<√t/cfg80211.h
>

9 
	~<kunô/ã°.h
>

11 
	$de‰agmít_0
(
kunô
 *
ã°
)

13 
ssize_t
 
ªt
;

14 c⁄° 
u8
 
öput
[] = {

15 [0] = 
WLAN_EID_EXTENSION
,

17 [2] = 
WLAN_EID_EXT_EHT_MULTI_LINK
,

20 [254 + 2] = 
WLAN_EID_FRAGMENT
,

24 
u8
 *
d©a
 = 
	`kunô_kzÆloc
(
ã°
, (
öput
), 
GFP_KERNEL
);

26 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
d©a
);

28 
ªt
 = 
	`cfg80211_de‰agmít_ñemít
((*)
öput
,

29 
öput
, (input),

30 
NULL
, 0,

31 
WLAN_EID_FRAGMENT
);

32 
	`KUNIT_EXPECT_EQ
(
ã°
, 
ªt
, 253);

33 
ªt
 = 
	`cfg80211_de‰agmít_ñemít
((*)
öput
,

34 
öput
, (input),

35 
d©a
, 
ªt
,

36 
WLAN_EID_FRAGMENT
);

37 
	`KUNIT_EXPECT_EQ
(
ã°
, 
ªt
, 253);

38 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
d©a
, 
öput
 + 3, 253);

39 
	}
}

41 
	$de‰agmít_1
(
kunô
 *
ã°
)

43 
ssize_t
 
ªt
;

44 c⁄° 
u8
 
öput
[] = {

45 [0] = 
WLAN_EID_EXTENSION
,

47 [2] = 
WLAN_EID_EXT_EHT_MULTI_LINK
,

50 [255 + 2] = 
WLAN_EID_FRAGMENT
,

53 [255 + 3 + 8] = 
WLAN_EID_FRAGMENT
,

57 
u8
 *
d©a
 = 
	`kunô_kzÆloc
(
ã°
, (
öput
), 
GFP_KERNEL
);

58 c⁄° 
ñemít
 *
ñem
;

59 
cou¡
 = 0;

61 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
d©a
);

63 
	`f‹_óch_ñemít
(
ñem
, 
öput
, (input))

64 
cou¡
++;

67 
	`KUNIT_ASSERT_EQ
(
ã°
, 
cou¡
, 3);

69 
ªt
 = 
	`cfg80211_de‰agmít_ñemít
((*)
öput
,

70 
öput
, (input),

71 
NULL
, 0,

72 
WLAN_EID_FRAGMENT
);

73 
	`KUNIT_EXPECT_EQ
(
ã°
, 
ªt
, 254 + 7);

74 
ªt
 = 
	`cfg80211_de‰agmít_ñemít
((*)
öput
,

75 
öput
, (input),

76 
d©a
, 
ªt
,

77 
WLAN_EID_FRAGMENT
);

79 
	`KUNIT_EXPECT_EQ
(
ã°
, 
ªt
, 254 + 7);

80 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
d©a
, 
öput
 + 3, 254);

81 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
d©a
 + 254, 
öput
 + 255 + 4, 7);

82 
	}
}

84 
	$de‰agmít_2
(
kunô
 *
ã°
)

86 
ssize_t
 
ªt
;

87 c⁄° 
u8
 
öput
[] = {

88 [0] = 
WLAN_EID_EXTENSION
,

90 [2] = 
WLAN_EID_EXT_EHT_MULTI_LINK
,

94 [257 + 0] = 
WLAN_EID_FRAGMENT
,

98 [2 * 257 + 0] = 
WLAN_EID_FRAGMENT
,

101 [2 * 257 + 3] = 
WLAN_EID_FRAGMENT
,

105 
u8
 *
d©a
 = 
	`kunô_kzÆloc
(
ã°
, (
öput
), 
GFP_KERNEL
);

106 c⁄° 
ñemít
 *
ñem
;

107 
cou¡
 = 0;

109 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
d©a
);

111 
	`f‹_óch_ñemít
(
ñem
, 
öput
, (input))

112 
cou¡
++;

115 
	`KUNIT_ASSERT_EQ
(
ã°
, 
cou¡
, 4);

117 
ªt
 = 
	`cfg80211_de‰agmít_ñemít
((*)
öput
,

118 
öput
, (input),

119 
NULL
, 0,

120 
WLAN_EID_FRAGMENT
);

122 
	`KUNIT_EXPECT_EQ
(
ã°
, 
ªt
, 254 + 255 + 1);

123 
ªt
 = 
	`cfg80211_de‰agmít_ñemít
((*)
öput
,

124 
öput
, (input),

125 
d©a
, 
ªt
,

126 
WLAN_EID_FRAGMENT
);

127 
	`KUNIT_EXPECT_EQ
(
ã°
, 
ªt
, 254 + 255 + 1);

128 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
d©a
, 
öput
 + 3, 254);

129 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
d©a
 + 254, 
öput
 + 257 + 2, 255);

130 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
d©a
 + 254 + 255, 
öput
 + 2 * 257 + 2, 1);

131 
	}
}

133 
	$de‰agmít_©_íd
(
kunô
 *
ã°
)

135 
ssize_t
 
ªt
;

136 c⁄° 
u8
 
öput
[] = {

137 [0] = 
WLAN_EID_EXTENSION
,

139 [2] = 
WLAN_EID_EXT_EHT_MULTI_LINK
,

142 [255 + 2] = 
WLAN_EID_FRAGMENT
,

146 
u8
 *
d©a
 = 
	`kunô_kzÆloc
(
ã°
, (
öput
), 
GFP_KERNEL
);

148 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
d©a
);

150 
ªt
 = 
	`cfg80211_de‰agmít_ñemít
((*)
öput
,

151 
öput
, (input),

152 
NULL
, 0,

153 
WLAN_EID_FRAGMENT
);

154 
	`KUNIT_EXPECT_EQ
(
ã°
, 
ªt
, 254 + 7);

155 
ªt
 = 
	`cfg80211_de‰agmít_ñemít
((*)
öput
,

156 
öput
, (input),

157 
d©a
, 
ªt
,

158 
WLAN_EID_FRAGMENT
);

159 
	`KUNIT_EXPECT_EQ
(
ã°
, 
ªt
, 254 + 7);

160 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
d©a
, 
öput
 + 3, 254);

161 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
d©a
 + 254, 
öput
 + 255 + 4, 7);

162 
	}
}

164 
kunô_ˇ£
 
	gñemít_‰agmíèti⁄_ã°_ˇ£s
[] = {

165 
KUNIT_CASE
(
de‰agmít_0
),

166 
KUNIT_CASE
(
de‰agmít_1
),

167 
KUNIT_CASE
(
de‰agmít_2
),

168 
KUNIT_CASE
(
de‰agmít_©_íd
),

172 
kunô_suôe
 
	gñemít_‰agmíèti⁄
 = {

173 .
«me
 = "cfg80211-element-defragmentation",

174 .
	gã°_ˇ£s
 = 
ñemít_‰agmíèti⁄_ã°_ˇ£s
,

177 
kunô_ã°_suôe
(
ñemít_‰agmíèti⁄
);

	@tests/module.c

7 
	~<löux/moduÀ.h
>

9 
MODULE_LICENSE
("GPL");

10 
MODULE_DESCRIPTION
("tests for cfg80211");

	@tests/scan.c

7 
	~<löux/õì80211.h
>

8 
	~<√t/cfg80211.h
>

9 
	~<kunô/ã°.h
>

10 
	~<kunô/skbuff.h
>

11 
	~"../c‹e.h
"

12 
	~"utû.h
"

15 
	~"../../mac80211/õì80211_i.h
"

17 
MODULE_IMPORT_NS
(
EXPORTED_FOR_KUNIT_TESTING
);

19 
	sã°_ñem
 {

20 
u8
 
	mid
;

21 
u8
 
	mÀn
;

23 
u8
 
	md©a
[255];

25 
u8
 
	meid
;

26 
u8
 
	med©a
[254];

31 
	sgí_√w_õ_ˇ£
 {

32 c⁄° *
	mdesc
;

33 
ã°_ñem
 
	m∑ª¡_õs
[16];

34 
ã°_ñem
 
	mchûd_õs
[16];

35 
ã°_ñem
 
	mªsu…_õs
[16];

36 } 
	ggí_√w_õ_ˇ£s
[] = {

38 .
desc
 = "MLÇot inherited",

39 .
	g∑ª¡_õs
 = {

40 { .
id
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 255,

41 .
	geid
 = 
WLAN_EID_EXT_EHT_MULTI_LINK
 },

43 .
	gchûd_õs
 = {

44 { .
id
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

46 .
	gªsu…_õs
 = {

47 { .
id
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

51 .
	gdesc
 = "fragmentsáre ignored ifÖreviousÜenÇot 255",

52 .
	g∑ª¡_õs
 = {

53 { .
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 254, },

54 { .
	gid
 = 
WLAN_EID_FRAGMENT
, .
	gÀn
 = 125, },

56 .
	gchûd_õs
 = {

57 { .
id
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

58 { .
	gid
 = 
WLAN_EID_FRAGMENT
, .
	gÀn
 = 125, },

60 .
	gªsu…_õs
 = {

61 { .
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 254, },

62 { .
	gid
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

66 .
	gdesc
 = "fragments inherited",

67 .
	g∑ª¡_õs
 = {

68 { .
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 255, },

69 { .
	gid
 = 
WLAN_EID_FRAGMENT
, .
	gÀn
 = 125, },

71 .
	gchûd_õs
 = {

72 { .
id
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

74 .
	gªsu…_õs
 = {

75 { .
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 255, },

76 { .
	gid
 = 
WLAN_EID_FRAGMENT
, .
	gÀn
 = 125, },

77 { .
	gid
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

81 .
	gdesc
 = "fragments copied",

82 .
	g∑ª¡_õs
 = {

83 { .
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 255, },

84 { .
	gid
 = 
WLAN_EID_FRAGMENT
, .
	gÀn
 = 125, },

86 .
	gchûd_õs
 = {

87 { .
id
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

89 .
	gªsu…_õs
 = {

90 { .
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 255, },

91 { .
	gid
 = 
WLAN_EID_FRAGMENT
, .
	gÀn
 = 125, },

92 { .
	gid
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

96 .
	gdesc
 = "multipleÉlements inherit",

97 .
	g∑ª¡_õs
 = {

98 { .
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 255, },

99 { .
	gid
 = 
WLAN_EID_FRAGMENT
, .
	gÀn
 = 125, },

100 { .
	gid
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 123, },

102 .
	gchûd_õs
 = {

103 { .
id
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

105 .
	gªsu…_õs
 = {

106 { .
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 255, },

107 { .
	gid
 = 
WLAN_EID_FRAGMENT
, .
	gÀn
 = 125, },

108 { .
	gid
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 123, },

109 { .
	gid
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

113 .
	gdesc
 = "one childÉlement overrides",

114 .
	g∑ª¡_õs
 = {

115 { .
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 255, },

116 { .
	gid
 = 
WLAN_EID_FRAGMENT
, .
	gÀn
 = 125, },

117 { .
	gid
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 123, },

119 .
	gchûd_õs
 = {

120 { .
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 127, },

121 { .
	gid
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

123 .
	gªsu…_õs
 = {

124 { .
id
 = 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
, .
	gÀn
 = 127, },

125 { .
	gid
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

129 .
	gdesc
 = "emptyÉlements fromÖarent",

130 .
	g∑ª¡_õs
 = {

131 { .
id
 = 0x1, .
	gÀn
 = 0, },

132 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 1, .
	geid
 = 0x10 },

134 .
	gchûd_õs
 = {

136 .
	gªsu…_õs
 = {

137 { .
id
 = 0x1, .
	gÀn
 = 0, },

138 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 1, .
	geid
 = 0x10 },

142 .
	gdesc
 = "emptyÉlements from child",

143 .
	g∑ª¡_õs
 = {

145 .
	gchûd_õs
 = {

146 { .
id
 = 0x1, .
	gÀn
 = 0, },

147 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 1, .
	geid
 = 0x10 },

149 .
	gªsu…_õs
 = {

150 { .
id
 = 0x1, .
	gÀn
 = 0, },

151 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 1, .
	geid
 = 0x10 },

155 .
	gdesc
 = "invalidÉxtendedÉlements ignored",

156 .
	g∑ª¡_õs
 = {

157 { .
id
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 0 },

159 .
	gchûd_õs
 = {

160 { .
id
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 0 },

162 .
	gªsu…_õs
 = {

166 .
	gdesc
 = "multipleÉxtendedÉlements",

167 .
	g∑ª¡_õs
 = {

168 { .
id
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 3,

169 .
	geid
 = 
WLAN_EID_EXT_HE_CAPABILITY
 },

170 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 5,

171 .
	geid
 = 
WLAN_EID_EXT_ASSOC_DELAY_INFO
 },

172 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 7,

173 .
	geid
 = 
WLAN_EID_EXT_HE_OPERATION
 },

174 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 11,

175 .
	geid
 = 
WLAN_EID_EXT_FILS_REQ_PARAMS
 },

177 .
	gchûd_õs
 = {

178 { .
id
 = 
WLAN_EID_SSID
, .
	gÀn
 = 13 },

179 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 17,

180 .
	geid
 = 
WLAN_EID_EXT_HE_CAPABILITY
 },

181 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 11,

182 .
	geid
 = 
WLAN_EID_EXT_FILS_KEY_CONFIRM
 },

183 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 19,

184 .
	geid
 = 
WLAN_EID_EXT_HE_OPERATION
 },

186 .
	gªsu…_õs
 = {

187 { .
id
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 17,

188 .
	geid
 = 
WLAN_EID_EXT_HE_CAPABILITY
 },

189 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 5,

190 .
	geid
 = 
WLAN_EID_EXT_ASSOC_DELAY_INFO
 },

191 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 19,

192 .
	geid
 = 
WLAN_EID_EXT_HE_OPERATION
 },

193 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 11,

194 .
	geid
 = 
WLAN_EID_EXT_FILS_REQ_PARAMS
 },

195 { .
	gid
 = 
WLAN_EID_SSID
, .
	gÀn
 = 13 },

196 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 11,

197 .
	geid
 = 
WLAN_EID_EXT_FILS_KEY_CONFIRM
 },

201 .
	gdesc
 = "non-inheritÉlement",

202 .
	g∑ª¡_õs
 = {

203 { .
id
 = 0x1, .
	gÀn
 = 7, },

204 { .
	gid
 = 0x2, .
	gÀn
 = 11, },

205 { .
	gid
 = 0x3, .
	gÀn
 = 13, },

206 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 17, .
	geid
 = 0x10 },

207 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 19, .
	geid
 = 0x11 },

208 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 23, .
	geid
 = 0x12 },

209 { .
	gid
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 29, .
	geid
 = 0x14 },

211 .
	gchûd_õs
 = {

212 { .
id
 = 
WLAN_EID_EXTENSION
,

213 .
	geid
 = 
WLAN_EID_EXT_NON_INHERITANCE
,

214 .
	gÀn
 = 10,

215 .
	ged©a
 = { 0x3, 0x1, 0x2, 0x3,

217 { .
	gid
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

219 .
	gªsu…_õs
 = {

220 { .
id
 = 
WLAN_EID_EXTENSION
, .
	gÀn
 = 23, .
	geid
 = 0x12 },

221 { .
	gid
 = 
WLAN_EID_SSID
, .
	gÀn
 = 2 },

225 
	$KUNIT_ARRAY_PARAM_DESC
(
gí_√w_õ
, 
gí_√w_õ_ˇ£s
, 
desc
)

227 
	$ã°_gí_√w_õ
(
kunô
 *
ã°
)

229 c⁄° 
gí_√w_õ_ˇ£
 *
∑øms
 = 
ã°
->
∑øm_vÆue
;

230 
sk_buff
 *
∑ª¡
 = 
	`kunô_zÆloc_skb
(
ã°
, 1024, 
GFP_KERNEL
);

231 
sk_buff
 *
chûd
 = 
	`kunô_zÆloc_skb
(
ã°
, 1024, 
GFP_KERNEL
);

232 
sk_buff
 *
ª„ªn˚
 = 
	`kunô_zÆloc_skb
(
ã°
, 1024, 
GFP_KERNEL
);

233 
u8
 *
out
 = 
	`kunô_kzÆloc
(
ã°
, 
IEEE80211_MAX_DATA_LEN
, 
GFP_KERNEL
);

234 
size_t
 
Àn
;

235 
i
;

237 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
∑ª¡
);

238 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
chûd
);

239 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
ª„ªn˚
);

240 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
out
);

242 
i
 = 0; i < 
	`ARRAY_SIZE
(
∑øms
->
∑ª¡_õs
); i++) {

243 i‡(
∑øms
->
∑ª¡_õs
[
i
].
Àn
 != 0) {

244 
	`skb_put_u8
(
∑ª¡
, 
∑øms
->
∑ª¡_õs
[
i
].
id
);

245 
	`skb_put_u8
(
∑ª¡
, 
∑øms
->
∑ª¡_õs
[
i
].
Àn
);

246 
	`skb_put_d©a
(
∑ª¡
, 
∑øms
->
∑ª¡_õs
[
i
].
d©a
,

247 
∑øms
->
∑ª¡_õs
[
i
].
Àn
);

250 i‡(
∑øms
->
chûd_õs
[
i
].
Àn
 != 0) {

251 
	`skb_put_u8
(
chûd
, 
∑øms
->
chûd_õs
[
i
].
id
);

252 
	`skb_put_u8
(
chûd
, 
∑øms
->
chûd_õs
[
i
].
Àn
);

253 
	`skb_put_d©a
(
chûd
, 
∑øms
->
chûd_õs
[
i
].
d©a
,

254 
∑øms
->
chûd_õs
[
i
].
Àn
);

257 i‡(
∑øms
->
ªsu…_õs
[
i
].
Àn
 != 0) {

258 
	`skb_put_u8
(
ª„ªn˚
, 
∑øms
->
ªsu…_õs
[
i
].
id
);

259 
	`skb_put_u8
(
ª„ªn˚
, 
∑øms
->
ªsu…_õs
[
i
].
Àn
);

260 
	`skb_put_d©a
(
ª„ªn˚
, 
∑øms
->
ªsu…_õs
[
i
].
d©a
,

261 
∑øms
->
ªsu…_õs
[
i
].
Àn
);

265 
Àn
 = 
	`cfg80211_gí_√w_õ
(
∑ª¡
->
d©a
,Öarent->len,

266 
chûd
->
d©a
, chûd->
Àn
,

267 
out
, 
IEEE80211_MAX_DATA_LEN
);

268 
	`KUNIT_EXPECT_EQ
(
ã°
, 
Àn
, 
ª„ªn˚
->len);

269 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
out
, 
ª„ªn˚
->
d©a
,Ñe„ªn˚->
Àn
);

270 
	`mem£t
(
out
, 0, 
IEEE80211_MAX_DATA_LEN
);

273 
Àn
 = 
	`cfg80211_gí_√w_õ
(
∑ª¡
->
d©a
,Öarent->len,

274 
chûd
->
d©a
, chûd->
Àn
,

275 
out
, 
ª„ªn˚
->
Àn
);

276 
	`KUNIT_EXPECT_EQ
(
ã°
, 
Àn
, 
ª„ªn˚
->len);

277 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
out
, 
ª„ªn˚
->
d©a
,Ñe„ªn˚->
Àn
);

278 
	`mem£t
(
out
, 0, 
IEEE80211_MAX_DATA_LEN
);

281 
Àn
 = 
	`cfg80211_gí_√w_õ
(
∑ª¡
->
d©a
,Öarent->len,

282 
chûd
->
d©a
, chûd->
Àn
,

283 
out
, 
ª„ªn˚
->
Àn
 - 1);

284 
	`KUNIT_EXPECT_EQ
(
ã°
, 
Àn
, 0);

285 
	}
}

287 
	$ã°_gí_√w_õ_mÆf‹med
(
kunô
 *
ã°
)

289 
sk_buff
 *
mÆf‹med
 = 
	`kunô_zÆloc_skb
(
ã°
, 1024, 
GFP_KERNEL
);

290 
u8
 *
out
 = 
	`kunô_kzÆloc
(
ã°
, 
IEEE80211_MAX_DATA_LEN
, 
GFP_KERNEL
);

291 
size_t
 
Àn
;

293 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
mÆf‹med
);

294 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
out
);

296 
	`skb_put_u8
(
mÆf‹med
, 
WLAN_EID_SSID
);

297 
	`skb_put_u8
(
mÆf‹med
, 3);

298 
	`skb_put
(
mÆf‹med
, 3);

299 
	`skb_put_u8
(
mÆf‹med
, 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
);

300 
	`skb_put_u8
(
mÆf‹med
, 10);

301 
	`skb_put
(
mÆf‹med
, 9);

303 
Àn
 = 
	`cfg80211_gí_√w_õ
(
mÆf‹med
->
d©a
, malformed->len,

304 
out
, 0,

305 
out
, 
IEEE80211_MAX_DATA_LEN
);

306 
	`KUNIT_EXPECT_EQ
(
ã°
, 
Àn
, 5);

308 
Àn
 = 
	`cfg80211_gí_√w_õ
(
out
, 0,

309 
mÆf‹med
->
d©a
, mÆf‹med->
Àn
,

310 
out
, 
IEEE80211_MAX_DATA_LEN
);

311 
	`KUNIT_EXPECT_EQ
(
ã°
, 
Àn
, 5);

312 
	}
}

314 
	söf‹m_bss
 {

315 
kunô
 *
	mã°
;

317 
	möf‹m_bss_cou¡
;

320 
	$öf‹m_bss_öc_cou¡î
(
wùhy
 *wiphy,

321 
cfg80211_bss
 *
bss
,

322 c⁄° 
cfg80211_bss_õs
 *
õs
,

323 *
drv_d©a
)

325 
öf‹m_bss
 *
˘x
 = 
	`t_wùhy_˘x
(
wùhy
);

327 
˘x
->
öf‹m_bss_cou¡
++;

329 
	`rcu_ªad_lock
();

330 
	`KUNIT_EXPECT_PTR_EQ
(
˘x
->
ã°
, 
drv_d©a
, ctx);

331 
	`KUNIT_EXPECT_PTR_EQ
(
˘x
->
ã°
, 
õs
, 
	`rcu_dîe„ªn˚
(
bss
->ies));

332 
	`rcu_ªad_u∆ock
();

333 
	}
}

335 
	$ã°_öf‹m_bss_ssid_⁄ly
(
kunô
 *
ã°
)

337 
öf‹m_bss
 
˘x
 = {

338 .
ã°
 =Åest,

340 
wùhy
 *wùhy = 
	`T_WIPHY
(
ã°
, 
˘x
);

341 
t_wùhy_¥iv
 *
w_¥iv
 = 
	`wùhy_¥iv
(
wùhy
);

342 
cfg80211_öf‹m_bss
 
öf‹m_bss
 = {

343 .
sig«l
 = 50,

344 .
drv_d©a
 = &
˘x
,

346 c⁄° 
u8
 
bssid
[
ETH_ALEN
] = { 0x10, 0x22, 0x33, 0x44, 0x55, 0x66 };

347 
u64
 
tsf
 = 0x1000000000000000ULL;

348 
bóc⁄_öt
 = 100;

349 
u16
 
ˇ∑bûôy
 = 0x1234;

350 c⁄° 
u8
 
öput
[] = {

351 [0] = 
WLAN_EID_SSID
,

355 
cfg80211_bss
 *
bss
, *
Ÿhî
;

356 c⁄° 
cfg80211_bss_õs
 *
õs
;

358 
w_¥iv
->
›s
->
öf‹m_bss
 = 
öf‹m_bss_öc_cou¡î
;

360 
öf‹m_bss
.
ch™
 = 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
	`MHZ_TO_KHZ
(2412));

361 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
öf‹m_bss
.
ch™
);

363 
bss
 = 
	`cfg80211_öf‹m_bss_d©a
(
wùhy
, &
öf‹m_bss
,

364 
CFG80211_BSS_FTYPE_PRESP
, 
bssid
, 
tsf
,

365 
ˇ∑bûôy
, 
bóc⁄_öt
,

366 
öput
, (input),

367 
GFP_KERNEL
);

368 
	`KUNIT_EXPECT_NOT_NULL
(
ã°
, 
bss
);

369 
	`KUNIT_EXPECT_EQ
(
ã°
, 
˘x
.
öf‹m_bss_cou¡
, 1);

372 
	`KUNIT_EXPECT_EQ
(
ã°
, 
bss
->
sig«l
, 
öf‹m_bss
.signal);

373 
	`KUNIT_EXPECT_EQ
(
ã°
, 
bss
->
bóc⁄_öãrvÆ
, 
bóc⁄_öt
);

374 
	`KUNIT_EXPECT_EQ
(
ã°
, 
bss
->
ˇ∑bûôy
, capability);

375 
	`KUNIT_EXPECT_EQ
(
ã°
, 
bss
->
bssid_ödex
, 0);

376 
	`KUNIT_EXPECT_PTR_EQ
(
ã°
, 
bss
->
ch™√l
, 
öf‹m_bss
.
ch™
);

377 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
bssid
, 
bss
->bssid, (bssid));

380 
	`rcu_ªad_lock
();

381 
õs
 = 
	`rcu_dîe„ªn˚
(
bss
->ies);

382 
	`KUNIT_EXPECT_NOT_NULL
(
ã°
, 
õs
);

383 
	`KUNIT_EXPECT_EQ
(
ã°
, 
õs
->
tsf
,Åsf);

384 
	`KUNIT_EXPECT_EQ
(
ã°
, 
õs
->
Àn
, (
öput
));

385 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
õs
->
d©a
, 
öput
, (input));

386 
	`rcu_ªad_u∆ock
();

389 
Ÿhî
 = 
	`cfg80211_gë_bss
(
wùhy
, 
NULL
, NULL, "TEST", 4,

390 
IEEE80211_BSS_TYPE_ANY
,

391 
IEEE80211_PRIVACY_ANY
);

392 
	`KUNIT_EXPECT_PTR_EQ
(
ã°
, 
bss
, 
Ÿhî
);

393 
	`cfg80211_put_bss
(
wùhy
, 
Ÿhî
);

396 
Ÿhî
 = 
	`cfg80211_gë_bss
(
wùhy
, 
NULL
, 
bssid
, NULL, 0,

397 
IEEE80211_BSS_TYPE_ANY
,

398 
IEEE80211_PRIVACY_ANY
);

399 
	`KUNIT_EXPECT_PTR_EQ
(
ã°
, 
bss
, 
Ÿhî
);

400 
	`cfg80211_put_bss
(
wùhy
, 
Ÿhî
);

402 
	`cfg80211_put_bss
(
wùhy
, 
bss
);

403 
	}
}

405 
	söf‹m_bss_ml_°a_ˇ£
 {

406 c⁄° *
	mdesc
;

407 
	mmld_id
;

408 
boﬁ
 
	m°a_¥of_víd‹_ñems
;

409 
boﬁ
 
	mö˛ude_›î_˛ass
;

410 
boﬁ
 
	mn°r
;

411 } 
	göf‹m_bss_ml_°a_ˇ£s
[] = {

413 .
desc
 = "zero_mld_id",

414 .
	gmld_id
 = 0,

415 .
	g°a_¥of_víd‹_ñems
 = 
Ál£
,

417 .
	gdesc
 = "zero_mld_id_with_oper_class",

418 .
	gmld_id
 = 0,

419 .
	g°a_¥of_víd‹_ñems
 = 
Ál£
,

420 .
	gö˛ude_›î_˛ass
 = 
åue
,

422 .
	gdesc
 = "mld_id_eq_1",

423 .
	gmld_id
 = 1,

424 .
	g°a_¥of_víd‹_ñems
 = 
åue
,

426 .
	gdesc
 = "mld_id_eq_1_with_oper_class",

427 .
	gmld_id
 = 1,

428 .
	g°a_¥of_víd‹_ñems
 = 
åue
,

429 .
	gö˛ude_›î_˛ass
 = 
åue
,

431 .
	gdesc
 = "nstr",

432 .
	gmld_id
 = 0,

433 .
	gn°r
 = 
åue
,

436 
	$KUNIT_ARRAY_PARAM_DESC
(
öf‹m_bss_ml_°a
, 
öf‹m_bss_ml_°a_ˇ£s
, 
desc
)

438 
	$ã°_öf‹m_bss_ml_°a
(
kunô
 *
ã°
)

440 c⁄° 
öf‹m_bss_ml_°a_ˇ£
 *
∑øms
 = 
ã°
->
∑øm_vÆue
;

441 
öf‹m_bss
 
˘x
 = {

442 .
ã°
 =Åest,

444 
wùhy
 *wùhy = 
	`T_WIPHY
(
ã°
, 
˘x
);

445 
t_wùhy_¥iv
 *
w_¥iv
 = 
	`wùhy_¥iv
(
wùhy
);

446 
cfg80211_öf‹m_bss
 
öf‹m_bss
 = {

447 .
sig«l
 = 50,

448 .
drv_d©a
 = &
˘x
,

450 
cfg80211_bss
 *
bss
, *
lök_bss
;

451 c⁄° 
cfg80211_bss_õs
 *
õs
;

454 c⁄° 
u8
 
bssid
[
ETH_ALEN
] = { 0x10, 0x22, 0x33, 0x44, 0x55, 0x66 };

455 
u64
 
tsf
 = 0x1000000000000000ULL;

456 
bóc⁄_öt
 = 100;

457 
u16
 
ˇ∑bûôy
 = 0x1234;

460 
sk_buff
 *
öput
 = 
	`kunô_zÆloc_skb
(
ã°
, 1024, 
GFP_KERNEL
);

461 
u8
 *
Àn_mÀ
, *
Àn_¥of
;

462 
u8
 
lök_id
 = 2;

464 
õì80211_√ighb‹_≠_öfo
 
öfo
;

465 
õì80211_tbâ_öfo_ge_11
 
≠
;

466 } 
__∑cked
 
∫r_n‹mÆ
 = {

467 .
öfo
 = {

468 .
tbâ_öfo_hdr
 = 
	`u8_ícode_bôs
(0, 
IEEE80211_AP_INFO_TBTT_HDR_COUNT
),

469 .
tbâ_öfo_Àn
 = (
õì80211_tbâ_öfo_ge_11
),

470 .
›_˛ass
 = 81,

471 .
ch™√l
 = 11,

473 .
≠
 = {

474 .
tbâ_off£t
 = 0xff,

475 .
bssid
 = { 0x10, 0x22, 0x33, 0x44, 0x55, 0x67 },

476 .
sh‹t_ssid
 = 0,

477 .
bss_∑øms
 = 0,

478 .
psd_20
 = 0,

479 .
mld_∑øms
.
mld_id
 = 
∑øms
->mld_id,

480 .
mld_∑øms
.
∑øms
 =

481 
	`À16_ícode_bôs
(
lök_id
,

482 
IEEE80211_RNR_MLD_PARAMS_LINK_ID
),

486 
õì80211_√ighb‹_≠_öfo
 
öfo
;

487 
õì80211_∫r_mld_∑øms
 
mld_∑øms
;

488 } 
__∑cked
 
∫r_n°r
 = {

489 .
öfo
 = {

490 .
tbâ_öfo_hdr
 =

491 
	`u8_ícode_bôs
(0, 
IEEE80211_AP_INFO_TBTT_HDR_COUNT
) |

492 
	`u8_ícode_bôs
(
IEEE80211_TBTT_INFO_TYPE_MLD
,

493 
IEEE80211_AP_INFO_TBTT_HDR_TYPE
),

494 .
tbâ_öfo_Àn
 = (
õì80211_∫r_mld_∑øms
),

495 .
›_˛ass
 = 81,

496 .
ch™√l
 = 11,

498 .
mld_∑øms
 = {

499 .
mld_id
 = 
∑øms
->mld_id,

500 .
∑øms
 =

501 
	`À16_ícode_bôs
(
lök_id
,

502 
IEEE80211_RNR_MLD_PARAMS_LINK_ID
),

505 
size_t
 
∫r_Àn
 = 
∑øms
->
n°r
 ? (
∫r_n°r
Ë: (
∫r_n‹mÆ
);

506 *
∫r
 = 
∑øms
->
n°r
 ? (*)&
∫r_n°r
 : (*)&
∫r_n‹mÆ
;

508 
__À16
 
c⁄åﬁ
;

509 
u8
 
v¨_Àn
;

510 
u8
 
mld_mac_addr
[
ETH_ALEN
];

511 
u8
 
lök_id_öfo
;

512 
u8
 
∑øms_ch™ge_cou¡
;

513 
__À16
 
mld_ˇps_™d_›s
;

514 
u8
 
mld_id
;

515 
__À16
 
ext_mld_ˇps_™d_›s
;

516 } 
__∑cked
 
mÀ_basic_comm⁄_öfo
 = {

517 .
c⁄åﬁ
 =

518 
	`˝u_to_À16
(
IEEE80211_ML_CONTROL_TYPE_BASIC
 |

519 
IEEE80211_MLC_BASIC_PRES_BSS_PARAM_CH_CNT
 |

520 
IEEE80211_MLC_BASIC_PRES_LINK_ID
 |

521 (
∑øms
->
mld_id
 ? 
IEEE80211_MLC_BASIC_PRES_MLD_ID
 : 0) |

522 
IEEE80211_MLC_BASIC_PRES_MLD_CAPA_OP
),

523 .
mld_id
 = 
∑øms
->mld_id,

524 .
mld_ˇps_™d_›s
 = 
	`˝u_to_À16
(0x0102),

525 .
ext_mld_ˇps_™d_›s
 = 
	`˝u_to_À16
(0x0304),

526 .
v¨_Àn
 = (
mÀ_basic_comm⁄_öfo
) - 2 -

527 (
∑øms
->
mld_id
 ? 0 : 1),

528 .
mld_mac_addr
 = { 0x10, 0x22, 0x33, 0x44, 0x55, 0x60 },

531 
__À16
 
c⁄åﬁ
;

532 
u8
 
v¨_Àn
;

533 
u8
 
bssid
[
ETH_ALEN
];

534 
__À16
 
bóc⁄_öt
;

535 
__À64
 
tsf_off£t
;

536 
__À16
 
ˇ∑bûôõs
;

537 } 
__∑cked
 
°a_¥of
 = {

538 .
c⁄åﬁ
 =

539 
	`˝u_to_À16
(
IEEE80211_MLE_STA_CONTROL_COMPLETE_PROFILE
 |

540 
IEEE80211_MLE_STA_CONTROL_STA_MAC_ADDR_PRESENT
 |

541 
IEEE80211_MLE_STA_CONTROL_BEACON_INT_PRESENT
 |

542 
IEEE80211_MLE_STA_CONTROL_TSF_OFFS_PRESENT
 |

543 
	`u16_ícode_bôs
(
lök_id
,

544 
IEEE80211_MLE_STA_CONTROL_LINK_ID
)),

545 .
v¨_Àn
 = (
°a_¥of
) - 2 - 2,

546 .
bssid
 = { *
∫r_n‹mÆ
.
≠
.bssid },

547 .
bóc⁄_öt
 = 
	`˝u_to_À16
(101),

548 .
tsf_off£t
 = 
	`˝u_to_À64
(-123ll),

549 .
ˇ∑bûôõs
 = 
	`˝u_to_À16
(0xdead),

552 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
öput
);

554 
w_¥iv
->
›s
->
öf‹m_bss
 = 
öf‹m_bss_öc_cou¡î
;

556 
öf‹m_bss
.
ch™
 = 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
	`MHZ_TO_KHZ
(2412));

557 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
öf‹m_bss
.
ch™
);

559 
	`skb_put_u8
(
öput
, 
WLAN_EID_SSID
);

560 
	`skb_put_u8
(
öput
, 4);

561 
	`skb_put_d©a
(
öput
, "TEST", 4);

563 i‡(
∑øms
->
ö˛ude_›î_˛ass
) {

564 
	`skb_put_u8
(
öput
, 
WLAN_EID_SUPPORTED_REGULATORY_CLASSES
);

565 
	`skb_put_u8
(
öput
, 1);

566 
	`skb_put_u8
(
öput
, 81);

569 
	`skb_put_u8
(
öput
, 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
);

570 
	`skb_put_u8
(
öput
, 
∫r_Àn
);

571 
	`skb_put_d©a
(
öput
, 
∫r
, 
∫r_Àn
);

574 
	`skb_put_u8
(
öput
, 
WLAN_EID_EXTENSION
);

575 
Àn_mÀ
 = 
	`skb_put
(
öput
, 1);

576 
	`skb_put_u8
(
öput
, 
WLAN_EID_EXT_EHT_MULTI_LINK
);

577 
	`skb_put_d©a
(
öput
, &
mÀ_basic_comm⁄_öfo
, (mle_basic_common_info));

578 i‡(!
∑øms
->
mld_id
)

579 
	`t_skb_ªmove_membî
(
öput
, 
	`ty≥of
(
mÀ_basic_comm⁄_öfo
), 
mld_id
);

581 
	`skb_put_u8
(
öput
, 
IEEE80211_MLE_SUBELEM_PER_STA_PROFILE
);

582 
Àn_¥of
 = 
	`skb_put
(
öput
, 1);

583 
	`skb_put_d©a
(
öput
, &
°a_¥of
, (sta_prof));

585 i‡(
∑øms
->
°a_¥of_víd‹_ñems
) {

587 
	`skb_put_u8
(
öput
, 
WLAN_EID_VENDOR_SPECIFIC
);

588 
	`skb_put_u8
(
öput
, 160);

589 
	`skb_put
(
öput
, 160);

591 
	`skb_put_u8
(
öput
, 
WLAN_EID_VENDOR_SPECIFIC
);

592 
	`skb_put_u8
(
öput
, 165);

593 
	`skb_put
(
öput
, 165);

597 
	`õì80211_‰agmít_ñemít
(
öput
, 
Àn_¥of
,

598 
IEEE80211_MLE_SUBELEM_FRAGMENT
);

600 
	`õì80211_‰agmít_ñemít
(
öput
, 
Àn_mÀ
, 
WLAN_EID_FRAGMENT
);

603 
	`skb_put_u8
(
öput
, 
WLAN_EID_VENDOR_SPECIFIC
);

604 
	`skb_put_u8
(
öput
, 155);

605 
	`skb_put
(
öput
, 155);

608 
bss
 = 
	`cfg80211_öf‹m_bss_d©a
(
wùhy
, &
öf‹m_bss
,

609 
CFG80211_BSS_FTYPE_PRESP
, 
bssid
, 
tsf
,

610 
ˇ∑bûôy
, 
bóc⁄_öt
,

611 
öput
->
d©a
, i≈ut->
Àn
,

612 
GFP_KERNEL
);

613 
	`KUNIT_EXPECT_NOT_NULL
(
ã°
, 
bss
);

614 
	`KUNIT_EXPECT_EQ
(
ã°
, 
˘x
.
öf‹m_bss_cou¡
, 2);

617 
lök_bss
 = 
	`__cfg80211_gë_bss
(
wùhy
, 
NULL
, 
°a_¥of
.
bssid
, NULL, 0,

618 
IEEE80211_BSS_TYPE_ANY
,

619 
IEEE80211_PRIVACY_ANY
,

621 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
lök_bss
);

622 
	`KUNIT_EXPECT_EQ
(
ã°
, 
lök_bss
->
sig«l
, 0);

623 
	`KUNIT_EXPECT_EQ
(
ã°
, 
lök_bss
->
bóc⁄_öãrvÆ
,

624 
	`À16_to_˝u
(
°a_¥of
.
bóc⁄_öt
));

625 
	`KUNIT_EXPECT_EQ
(
ã°
, 
lök_bss
->
ˇ∑bûôy
,

626 
	`À16_to_˝u
(
°a_¥of
.
ˇ∑bûôõs
));

627 
	`KUNIT_EXPECT_EQ
(
ã°
, 
lök_bss
->
bssid_ödex
, 0);

628 
	`KUNIT_EXPECT_PTR_EQ
(
ã°
, 
lök_bss
->
ch™√l
,

629 
	`õì80211_gë_ch™√l_khz
(
wùhy
, 
	`MHZ_TO_KHZ
(2462)));

632 i‡(
∑øms
->
n°r
) {

633 
	`KUNIT_EXPECT_EQ
(
ã°
, 
lök_bss
->
u£_f‹
, 0);

634 
	`KUNIT_EXPECT_EQ
(
ã°
, 
lök_bss
->
ˇ¬Ÿ_u£_ªas⁄s
,

635 
NL80211_BSS_CANNOT_USE_NSTR_NONPRIMARY
);

636 
	`KUNIT_EXPECT_NULL
(
ã°
,

637 
	`cfg80211_gë_bss
(
wùhy
, 
NULL
, 
°a_¥of
.
bssid
,

638 
NULL
, 0,

639 
IEEE80211_BSS_TYPE_ANY
,

640 
IEEE80211_PRIVACY_ANY
));

642 
	`KUNIT_EXPECT_EQ
(
ã°
, 
lök_bss
->
u£_f‹
,

643 
NL80211_BSS_USE_FOR_ALL
);

644 
	`KUNIT_EXPECT_EQ
(
ã°
, 
lök_bss
->
ˇ¬Ÿ_u£_ªas⁄s
, 0);

647 
	`rcu_ªad_lock
();

648 
õs
 = 
	`rcu_dîe„ªn˚
(
lök_bss
->ies);

649 
	`KUNIT_EXPECT_NOT_NULL
(
ã°
, 
õs
);

650 
	`KUNIT_EXPECT_EQ
(
ã°
, 
õs
->
tsf
,Ås‡+ 
	`À64_to_˝u
(
°a_¥of
.
tsf_off£t
));

657 i‡(
∑øms
->
°a_¥of_víd‹_ñems
)

658 
	`KUNIT_EXPECT_EQ
(
ã°
, 
õs
->
Àn
,

659 6 + 2 + 
∫r_Àn
 + 2 + 160 + 2 + 165 +

660 (
∑øms
->
ö˛ude_›î_˛ass
 ? 3 : 0) +

661 (!
∑øms
->
mld_id
 && !∑øms->
n°r
 ? 22 : 0) +

662 
mÀ_basic_comm⁄_öfo
.
v¨_Àn
 + 5);

664 
	`KUNIT_EXPECT_EQ
(
ã°
, 
õs
->
Àn
,

665 6 + 2 + 
∫r_Àn
 + 2 + 155 +

666 (
∑øms
->
ö˛ude_›î_˛ass
 ? 3 : 0) +

667 (!
∑øms
->
mld_id
 && !∑øms->
n°r
 ? 22 : 0) +

668 
mÀ_basic_comm⁄_öfo
.
v¨_Àn
 + 5);

669 
	`rcu_ªad_u∆ock
();

671 
	`cfg80211_put_bss
(
wùhy
, 
bss
);

672 
	`cfg80211_put_bss
(
wùhy
, 
lök_bss
);

673 
	}
}

675 
	scfg80211_∑r£_cﬁoˇãd_≠_ˇ£
 {

676 c⁄° *
	mdesc
;

677 
u8
 
	m›_˛ass
;

678 
u8
 
	mch™√l
;

679 
õì80211_√ighb‹_≠_öfo
 
	möfo
;

681 
õì80211_tbâ_öfo_ge_11
 
	mtbâ_l⁄g
;

682 
õì80211_tbâ_öfo_7_8_9
 
	mtbâ_sh‹t
;

684 
boﬁ
 
	madd_junk
;

685 
boﬁ
 
	mßme_ssid
;

686 
boﬁ
 
	mvÆid
;

687 } 
	gcfg80211_∑r£_cﬁoˇãd_≠_ˇ£s
[] = {

689 .
desc
 = "wrong_band",

690 .
	göfo
.
	g›_˛ass
 = 81,

691 .
	göfo
.
	gch™√l
 = 11,

692 .
	gtbâ_l⁄g
 = {

693 .
bssid
 = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55 },

694 .
	gbss_∑øms
 = 
IEEE80211_RNR_TBTT_PARAMS_COLOC_AP
,

696 .
	gvÆid
 = 
Ál£
,

699 .
	gdesc
 = "wrong_type",

701 .
	göfo
.
	gtbâ_öfo_hdr
 = 
IEEE80211_TBTT_INFO_TYPE_MLD
,

702 .
	gtbâ_l⁄g
 = {

703 .
bssid
 = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55 },

704 .
	gbss_∑øms
 = 
IEEE80211_RNR_TBTT_PARAMS_COLOC_AP
,

706 .
	gvÆid
 = 
Ál£
,

709 .
	gdesc
 = "colocated_invalid_len_short",

710 .
	göfo
.
	gtbâ_öfo_Àn
 = 6,

711 .
	gtbâ_sh‹t
 = {

712 .
bssid
 = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55 },

713 .
	gbss_∑øms
 = 
IEEE80211_RNR_TBTT_PARAMS_COLOC_AP
 |

714 
IEEE80211_RNR_TBTT_PARAMS_SAME_SSID
,

716 .
	gvÆid
 = 
Ál£
,

719 .
	gdesc
 = "colocated_invalid_len_short_mld",

720 .
	göfo
.
	gtbâ_öfo_Àn
 = 10,

721 .
	gtbâ_l⁄g
 = {

722 .
bssid
 = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55 },

723 .
	gbss_∑øms
 = 
IEEE80211_RNR_TBTT_PARAMS_COLOC_AP
,

725 .
	gvÆid
 = 
Ál£
,

728 .
	gdesc
 = "colocated_non_mld",

729 .
	göfo
.
	gtbâ_öfo_Àn
 = (
õì80211_tbâ_öfo_7_8_9
),

730 .
	gtbâ_sh‹t
 = {

731 .
bssid
 = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55 },

732 .
	gbss_∑øms
 = 
IEEE80211_RNR_TBTT_PARAMS_COLOC_AP
 |

733 
IEEE80211_RNR_TBTT_PARAMS_SAME_SSID
,

735 .
	gßme_ssid
 = 
åue
,

736 .
	gvÆid
 = 
åue
,

739 .
	gdesc
 = "colocated_non_mld_invalid_bssid",

740 .
	göfo
.
	gtbâ_öfo_Àn
 = (
õì80211_tbâ_öfo_7_8_9
),

741 .
	gtbâ_sh‹t
 = {

742 .
bssid
 = { 0xff, 0x11, 0x22, 0x33, 0x44, 0x55 },

743 .
	gbss_∑øms
 = 
IEEE80211_RNR_TBTT_PARAMS_COLOC_AP
 |

744 
IEEE80211_RNR_TBTT_PARAMS_SAME_SSID
,

746 .
	gßme_ssid
 = 
åue
,

747 .
	gvÆid
 = 
Ál£
,

750 .
	gdesc
 = "colocated_mld",

751 .
	gtbâ_l⁄g
 = {

752 .
bssid
 = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55 },

753 .
	gbss_∑øms
 = 
IEEE80211_RNR_TBTT_PARAMS_COLOC_AP
,

755 .
	gvÆid
 = 
åue
,

758 .
	gdesc
 = "colocated_mld",

759 .
	gtbâ_l⁄g
 = {

760 .
bssid
 = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55 },

761 .
	gbss_∑øms
 = 
IEEE80211_RNR_TBTT_PARAMS_COLOC_AP
,

763 .
	gadd_junk
 = 
åue
,

764 .
	gvÆid
 = 
Ál£
,

767 .
	gdesc
 = "colocated_disabled_mld",

768 .
	gtbâ_l⁄g
 = {

769 .
bssid
 = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55 },

770 .
	gbss_∑øms
 = 
IEEE80211_RNR_TBTT_PARAMS_COLOC_AP
,

771 .
	gmld_∑øms
.
	g∑øms
 = 
˝u_to_À16
(
IEEE80211_RNR_MLD_PARAMS_DISABLED_LINK
),

773 .
	gvÆid
 = 
Ál£
,

776 
	$KUNIT_ARRAY_PARAM_DESC
(
cfg80211_∑r£_cﬁoˇãd_≠
, 
cfg80211_∑r£_cﬁoˇãd_≠_ˇ£s
, 
desc
)

778 
	$ã°_cfg80211_∑r£_cﬁoˇãd_≠
(
kunô
 *
ã°
)

780 c⁄° 
cfg80211_∑r£_cﬁoˇãd_≠_ˇ£
 *
∑øms
 = 
ã°
->
∑øm_vÆue
;

781 
sk_buff
 *
öput
 = 
	`kunô_zÆloc_skb
(
ã°
, 1024, 
GFP_KERNEL
);

782 
cfg80211_bss_õs
 *
õs
;

783 
õì80211_√ighb‹_≠_öfo
 
öfo
;

784 
	`LIST_HEAD
(
cﬁoc_≠_li°
);

785 
cou¡
;

787 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
öput
);

789 
öfo
 = 
∑øms
->info;

792 i‡(!
öfo
.
tbâ_öfo_Àn
)

793 
öfo
.
tbâ_öfo_Àn
 = (
∑øms
->
tbâ_l⁄g
);

794 i‡(!
öfo
.
›_˛ass
)

795 
öfo
.
›_˛ass
 = 131;

796 i‡(!
öfo
.
ch™√l
)

797 
öfo
.
ch™√l
 = 33;

800 
	`skb_put_u8
(
öput
, 
WLAN_EID_SSID
);

801 
	`skb_put_u8
(
öput
, 4);

802 
	`skb_put_d©a
(
öput
, "TEST", 4);

804 
	`skb_put_u8
(
öput
, 
WLAN_EID_REDUCED_NEIGHBOR_REPORT
);

805 
	`skb_put_u8
(
öput
, (
öfo
Ë+ info.
tbâ_öfo_Àn
 + (
∑øms
->
add_junk
 ? 3 : 0));

806 
	`skb_put_d©a
(
öput
, &
öfo
, (info));

807 
	`skb_put_d©a
(
öput
, &
∑øms
->
tbâ_l⁄g
, 
öfo
.
tbâ_öfo_Àn
);

809 i‡(
∑øms
->
add_junk
)

810 
	`skb_put_d©a
(
öput
, "123", 3);

812 
õs
 = 
	`kunô_kzÆloc
(
ã°
, 
	`°ru˘_size
(õs, 
d©a
, 
öput
->
Àn
), 
GFP_KERNEL
);

813 
õs
->
Àn
 = 
öput
->len;

814 
	`mem˝y
(
õs
->
d©a
, 
öput
->d©a, i≈ut->
Àn
);

816 
cou¡
 = 
	`cfg80211_∑r£_cﬁoˇãd_≠
(
õs
, &
cﬁoc_≠_li°
);

818 
	`KUNIT_EXPECT_EQ
(
ã°
, 
cou¡
, 
∑øms
->
vÆid
);

819 
	`KUNIT_EXPECT_EQ
(
ã°
, 
	`li°_cou¡_nodes
(&
cﬁoc_≠_li°
), 
∑øms
->
vÆid
);

821 i‡(
∑øms
->
vÆid
 && !
	`li°_em±y
(&
cﬁoc_≠_li°
)) {

822 
cfg80211_cﬁoˇãd_≠
 *
≠
;

824 
≠
 = 
	`li°_fú°_íåy
(&
cﬁoc_≠_li°
, 
	`ty≥of
(*≠), 
li°
);

825 i‡(
öfo
.
tbâ_öfo_Àn
 <(
∑øms
->
tbâ_sh‹t
))

826 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
≠
->
bssid
, 
∑øms
->
tbâ_sh‹t
.bssid, 
ETH_ALEN
);

828 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
≠
->
bssid
, 
∑øms
->
tbâ_l⁄g
.bssid, 
ETH_ALEN
);

830 i‡(
∑øms
->
ßme_ssid
) {

831 
	`KUNIT_EXPECT_EQ
(
ã°
, 
≠
->
ssid_Àn
, 4);

832 
	`KUNIT_EXPECT_MEMEQ
(
ã°
, 
≠
->
ssid
, "TEST", 4);

834 
	`KUNIT_EXPECT_EQ
(
ã°
, 
≠
->
ssid_Àn
, 0);

838 
	`cfg80211_‰ì_cﬁoc_≠_li°
(&
cﬁoc_≠_li°
);

839 
	}
}

841 
kunô_ˇ£
 
	ggí_√w_õ_ã°_ˇ£s
[] = {

842 
KUNIT_CASE_PARAM
(
ã°_gí_√w_õ
, 
gí_√w_õ_gí_∑øms
),

843 
KUNIT_CASE
(
ã°_gí_√w_õ_mÆf‹med
),

847 
kunô_suôe
 
	ggí_√w_õ
 = {

848 .
«me
 = "cfg80211-ie-generation",

849 .
	gã°_ˇ£s
 = 
gí_√w_õ_ã°_ˇ£s
,

852 
kunô_ã°_suôe
(
gí_√w_õ
);

854 
kunô_ˇ£
 
	göf‹m_bss_ã°_ˇ£s
[] = {

855 
KUNIT_CASE
(
ã°_öf‹m_bss_ssid_⁄ly
),

856 
KUNIT_CASE_PARAM
(
ã°_öf‹m_bss_ml_°a
, 
öf‹m_bss_ml_°a_gí_∑øms
),

860 
kunô_suôe
 
	göf‹m_bss
 = {

861 .
«me
 = "cfg80211-inform-bss",

862 .
	gã°_ˇ£s
 = 
öf‹m_bss_ã°_ˇ£s
,

865 
kunô_ã°_suôe
(
öf‹m_bss
);

867 
kunô_ˇ£
 
	gsˇn_6ghz_ˇ£s
[] = {

868 
KUNIT_CASE_PARAM
(
ã°_cfg80211_∑r£_cﬁoˇãd_≠
,

869 
cfg80211_∑r£_cﬁoˇãd_≠_gí_∑øms
),

873 
kunô_suôe
 
	gsˇn_6ghz
 = {

874 .
«me
 = "cfg80211-scan-6ghz",

875 .
	gã°_ˇ£s
 = 
sˇn_6ghz_ˇ£s
,

878 
kunô_ã°_suôe
(
sˇn_6ghz
);

	@tests/util.c

7 
	~<löux/õì80211.h
>

8 
	~<√t/cfg80211.h
>

9 
	~<kunô/ã°.h
>

10 
	~<kunô/ã°-bug.h
>

11 
	~"utû.h
"

13 
	$t_wùhy_öô
(
kunô_ªsour˚
 *
ªsour˚
, *
˘x
)

15 
kunô
 *
ã°
 = 
	`kunô_gë_cuºít_ã°
();

16 
cfg80211_›s
 *
›s
;

17 
wùhy
 *wiphy;

18 
t_wùhy_¥iv
 *
¥iv
;

20 
›s
 = 
	`kzÆloc
((*›s), 
GFP_KERNEL
);

21 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
›s
);

23 
wùhy
 = 
	`wùhy_√w_nm
(
›s
, (*
¥iv
), "kunit");

24 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
wùhy
);

26 
¥iv
 = 
	`wùhy_¥iv
(
wùhy
);

27 
¥iv
->
˘x
 = ctx;

28 
¥iv
->
›s
 = ops;

31 
	`mem˝y
(
¥iv
->
ch™√ls_2ghz
, channels_2ghz, (channels_2ghz));

32 
wùhy
->
b™ds
[
NL80211_BAND_2GHZ
] = &
¥iv
->
b™d_2ghz
;

33 
¥iv
->
b™d_2ghz
.
ch™√ls
 =Öriv->
ch™√ls_2ghz
;

34 
¥iv
->
b™d_2ghz
.
n_ch™√ls
 = 
	`ARRAY_SIZE
(
ch™√ls_2ghz
);

36 
ªsour˚
->
d©a
 = 
wùhy
;

37 
ªsour˚
->
«me
 = "wiphy";

40 
	}
}

42 
	$t_wùhy_exô
(
kunô_ªsour˚
 *
ªsour˚
)

44 
t_wùhy_¥iv
 *
¥iv
;

45 
cfg80211_›s
 *
›s
;

47 
¥iv
 = 
	`wùhy_¥iv
(
ªsour˚
->
d©a
);

48 
›s
 = 
¥iv
->ops;

54 
	`wùhy_‰ì
(
ªsour˚
->
d©a
);

55 
	`k‰ì
(
›s
);

56 
	}
}

	@tests/util.h

7 #i‚de‡
__CFG80211_UTILS_H


8 
	#__CFG80211_UTILS_H


	)

10 
	#CHAN2G
(
_‰eq
) { \

11 .
b™d
 = 
NL80211_BAND_2GHZ
, \

12 .
˚¡î_‰eq
 = (
_‰eq
), \

13 .
hw_vÆue
 = (
_‰eq
), \

14 }

	)

16 c⁄° 
õì80211_ch™√l
 
	gch™√ls_2ghz
[] = {

17 
CHAN2G
(2412),

18 
CHAN2G
(2417),

19 
CHAN2G
(2422),

20 
CHAN2G
(2427),

21 
CHAN2G
(2432),

22 
CHAN2G
(2437),

23 
CHAN2G
(2442),

24 
CHAN2G
(2447),

25 
CHAN2G
(2452),

26 
CHAN2G
(2457),

27 
CHAN2G
(2462),

28 
CHAN2G
(2467),

29 
CHAN2G
(2472),

30 
CHAN2G
(2484),

33 
	st_wùhy_¥iv
 {

34 
kunô
 *
	mã°
;

35 
cfg80211_›s
 *
	m›s
;

37 *
	m˘x
;

39 
õì80211_suµ‹ãd_b™d
 
	mb™d_2ghz
;

40 
õì80211_ch™√l
 
	mch™√ls_2ghz
[
ARRAY_SIZE
(
ch™√ls_2ghz
)];

43 
	#T_WIPHY
(
ã°
, 
˘x
) ({ \

44 
wùhy
 *
__wùhy
 = \

45 
	`kunô_Æloc_ªsour˚
(
ã°
, 
t_wùhy_öô
, \

46 
t_wùhy_exô
, \

47 
GFP_KERNEL
, &(
˘x
)); \

49 
	`KUNIT_ASSERT_NOT_NULL
(
ã°
, 
__wùhy
); \

50 
__wùhy
; \

51 })

	)

52 
	#t_wùhy_˘x
(
wùhy
Ë(((
t_wùhy_¥iv
 *)
	`wùhy_¥iv
(wùhy))->
˘x
)

	)

54 
t_wùhy_öô
(
kunô_ªsour˚
 *
ªsour˚
, *
d©a
);

55 
t_wùhy_exô
(
kunô_ªsour˚
 *
ªsour˚
);

57 
	#t_skb_ªmove_membî
(
skb
, 
ty≥
, 
membî
) do { \

58 
	`memmove
((
skb
)->
d©a
 + (skb)->
Àn
 - (
ty≥
) + \

59 
	`off£tof
(
ty≥
, 
membî
), \

60 (
skb
)->
d©a
 + (skb)->
Àn
 - (
ty≥
) + \

61 
	`off£to„nd
(
ty≥
, 
membî
), \

62 
	`off£to„nd
(
ty≥
, 
membî
)); \

63 
	`skb_åim
(
skb
, (skb)->
Àn
 - 
	`sizeof_fõld
(
ty≥
, 
membî
)); \

64 } 0)

	)

	@thread_name.c

3 
	~<löux/sched.h
>

4 
	~"thªad_«me.h
"

7 c⁄° * 
	$gë_thªad_«me
()

9 i‡(
cuºít
 && cuºít->
comm
) {

10  
cuºít
->
comm
;

13 
	}
}

	@thread_name.h

3 #i‚de‡
_THREAD_NAME_H


4 
	#_THREAD_NAME_H


	)

7 c⁄° * 
gë_thªad_«me
();

	@time.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/kî√l.h
>

3 
	~<löux/öô.h
>

4 
	~<löux/sched.h
>

5 
	~<löux/time.h
>

7 
__kî√l_time•ec
 
__u£r
 *
	guts
;

9 
__öô
 
	$my_moduÀ_öô
()

13 
time•ec64
 
ts
;

14 
	`gë_time•ec64
(&
ts
, 
uts
);

17 
uöt8_t
 
£c⁄ds
 = 
ts
.
tv_£c
;

18 
uöt8_t
 
möuãs
 = ((uöt8_tË
£c⁄ds
) / 60;

19 
uöt8_t
 
hours
 = ((uöt8_tË
möuãs
) / 60;

20 
mûli£c⁄ds
 = (
£c⁄ds
 * 1000);

25 
uöt8_t
 
£c⁄ds
 = 
ts
.
tv_£c
;

26 
£c⁄ds
 %= 60;

27 
uöt8_t
 
möuãs
 = ((uöt8_tË
£c⁄ds
) / 60;

28 
uöt8_t
 
hours
 = ((uöt8_tË
£c⁄ds
) / 3600;

29 
mûli£c⁄ds
 = (
£c⁄ds
 * 1000);

32 c⁄° *
moduÀ_«me
 = 
THIS_MODULE
->
«me
;

35 *
thªad_«me
 = 
cuºít
->
comm
;

39 
	`¥_öfo
("Timestamp: [%02u:%02u:%02u:%05lu], Module: [%s], Thread Name: [%s], Function: [%s], Line: [%d], Message: [nl80211_send_rx_auth : NL80211_CMD_AUTHENTICATE]\n",

40 
hours
, 
möuãs
, 
£c⁄ds
, 
mûli£c⁄ds
,

41 
moduÀ_«me
, 
thªad_«me
, 
__func__
, 
__LINE__
);

44 
	}
}

46 
__exô
 
	$my_moduÀ_exô
()

48 
	`¥_öfo
("Exiting module\n");

49 
	}
}

51 
moduÀ_öô
(
my_moduÀ_öô
);

52 
moduÀ_exô
(
my_moduÀ_exô
);

54 
MODULE_LICENSE
("GPL");

55 
MODULE_AUTHOR
("Bharathi");

56 
MODULE_DESCRIPTION
("Kernel module withÅimestamp, moduleÇame,ándÅhreadÇame inÜog");

	@time.mod.c

1 
	~<löux/moduÀ.h
>

2 
	#INCLUDE_VERMAGIC


	)

3 
	~<löux/buûd-ß….h
>

4 
	~<löux/ñ‚Ÿe-…o.h
>

5 
	~<löux/exp‹t-öã∫Æ.h
>

6 
	~<löux/vîmagic.h
>

7 
	~<löux/compûî.h
>

9 #ifde‡
CONFIG_UNWINDER_ORC


10 
	~<asm/‹c_hódî.h
>

11 
	gORC_HEADER
;

14 
	gBUILD_SALT
;

15 
	gBUILD_LTO_INFO
;

17 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

18 
MODULE_INFO
(
«me
, 
KBUILD_MODNAME
);

20 
__visibÀ
 
moduÀ
 
__this_moduÀ


21 
__£˘i⁄
(".gnu.linkonce.this_module") = {

22 .
«me
 = 
KBUILD_MODNAME
,

23 .
	göô
 = 
öô_moduÀ
,

24 #ifde‡
CONFIG_MODULE_UNLOAD


25 .
	gexô
 = 
˛ónup_moduÀ
,

27 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

30 #ifde‡
CONFIG_MITIGATION_RETPOLINE


31 
MODULE_INFO
(
ªçﬁöe
, "Y");

36 c⁄° 
modvîsi⁄_öfo
 
	g____vîsi⁄s
[]

37 
__u£d
 
__£˘i⁄
("__versions") = {

47 
MODULE_INFO
(
dïíds
, "");

50 
MODULE_INFO
(
§cvîsi⁄
, "703451876ADFE020D8CDBAC");

	@time/debug_print.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/kî√l.h
>

3 
	~<löux/ktime.h
>

4 
	~<löux/time.h
>

5 
	~"debug_¥öt.h
"

7 
MODULE_LICENSE
("GPL");

8 
MODULE_AUTHOR
("Linux_usr");

10 
	gödex
;

13 *
	$time°amp_func
(*
buff
)

15 
u64
 
ts
 = 
	`ktime_gë_ns
();

16 
ªm_n£c
 = 
	`do_div
(
ts
, 1000000000);

20 
	`•rötf
(
buff
, "%5lu.%06lu", ()
ts
, (
ªm_n£c
 / 1000));

24  
buff
;

25 
	}
}

27 
	$debug_func
(c⁄° * 
func
)

29 
debug
 
dbg
[
FUNCTIONS_STORED
];

30 
buff
[
BUFFER_SIZE
];

31 
cou¡
;

33 
	`¥ötk
("*** CG_DEBUG [%d] ***\n", 
ödex
);

34 
dbg
[
ödex
].
time°amp
 = 
	`time°amp_func
(
buff
);

35 
dbg
[
ödex
].
«me
 = 
func
;

37 
	`¥ötk
("*** CG_DEBUG [%s] [%s] [%d] ***\n", 
dbg
[
ödex
].
time°amp
, dbg[ödex].
«me
, index);

38 
ödex
 = (ödex + 1Ë% 
FUNCTIONS_STORED
;

40 i‡((
ödex
 % 
FUNCTIONS_PRINT
) == 0)

42 
cou¡
 = 0; cou¡ < 
FUNCTIONS_STORED
; count++)

44 i‡(
dbg
[
cou¡
].
«me
 !
NULL
)

46 
	`¥ötk
("[%s] [%s] [%d] \n", 
dbg
[
cou¡
].
time°amp
, dbg[cou¡].
«me
, count);

50 
	`¥ötk
("[%s] [%s] \n", 
dbg
[0].
time°amp
, dbg[0].
«me
);

51 
	`¥ötk
("[%s] [%s] \n", 
dbg
[1].
time°amp
, dbg[1].
«me
);

52 
	`¥ötk
("[%s] [%s] \n", 
dbg
[2].
time°amp
, dbg[2].
«me
);

53 
	`¥ötk
("[%s] [%s] \n", 
dbg
[3].
time°amp
, dbg[3].
«me
);

54 
	`¥ötk
("[%s] [%s] \n", 
dbg
[4].
time°amp
, dbg[4].
«me
);

55 
	`¥ötk
("[%s] [%s] \n", 
dbg
[5].
time°amp
, dbg[5].
«me
);

56 
	`¥ötk
("[%s] [%s] \n", 
dbg
[6].
time°amp
, dbg[6].
«me
);

59 
	}
}

	@time/debug_print.h

3 #i‚de‡
LINUX_DEBUG_PRINT_H


4 
	#LINUX_DEBUG_PRINT_H


	)

6 
	#BUFFER_SIZE
 100

7 
	#FUNCTIONS_STORED
 10

8 
	#FUNCTIONS_PRINT
 7

9 

	)

18 
	sdebug
 {

20 *
	mtime°amp
;

21 c⁄° * 
	m«me
;

25 *
time°amp_func
(*
buff
);

26 
debug_func
(c⁄° * 
func
);

28 
add
();

29 
sub
();

30 
mul
();

31 
div
();

32 
mod
();

33 
abc
();

	@time/hello.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/kî√l.h
>

3 
	~<löux/öô.h
>

4 
	~<löux/dñay.h
>

5 
	~"debug_¥öt.h
"

7 
MODULE_LICENSE
("GPL");

8 
MODULE_AUTHOR
("Linux_usr");

10 
	$add
()

12 
	`m¶ìp
(1000);

13 
	`debug_func
(
__func__
);

14 
	}
}

16 
	$sub
()

18 
	`m¶ìp
(1000);

19 
	`debug_func
(
__func__
);

20 
	}
}

22 
	$mul
()

24 
	`m¶ìp
(1000);

25 
	`debug_func
(
__func__
);

26 
	}
}

28 
	$div
()

30 
	`m¶ìp
(1000);

31 
	`debug_func
(
__func__
);

32 
	}
}

34 
	$mod
()

36 
	`m¶ìp
(1000);

37 
	`debug_func
(
__func__
);

38 
	}
}

40 
	$abc
()

42 
	`m¶ìp
(1000);

43 
	`debug_func
(
__func__
);

44 
	}
}

46 
__öô
 
	$hñlo_°¨t
()

48 
	`¥_öfo
("Hello world \n");

50 
	`debug_func
(
__func__
);

51 
	`add
();

52 
	`sub
();

53 
	`mul
();

54 
	`div
();

55 
	`mod
();

56 
	`abc
();

59 
	}
}

61 
__exô
 
	$hñlo_exô
()

63 
	`¥_öfo
("Good bye world \n");

64 
	}
}

65 
moduÀ_öô
(
hñlo_°¨t
);

66 
moduÀ_exô
(
hñlo_exô
);

	@time_module.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/kî√l.h
>

3 
	~<löux/öô.h
>

4 
	~<löux/sched.h
>

5 
	~<löux/time.h
>

9 
__öô
 
	$my_moduÀ_öô
()

12 
time•ec
 
ts
;

13 
	`ktime_gë_ªÆ
(&
ts
);

16 
hours
 = 
ts
.
tv_£c
 / 3600;

17 
möuãs
 = (
ts
.
tv_£c
 % 3600) / 60;

18 
£c⁄ds
 = 
ts
.
tv_£c
 % 60;

19 
mûli£c⁄ds
 = 
ts
.
tv_n£c
 / 1000000;

22 *
thªad_«me
 = 
cuºít
->
comm
;

25 
	`¥_öfo
("Module Name: [%s], Timestamp: [%02lu:%02lu:%02lu.%03lu], Thread Name: [%s], Function: [%s], Line: [%d], Message: [%s]\n",

26 
THIS_MODULE
->
«me
, 
hours
, 
möuãs
, 
£c⁄ds
, 
mûli£c⁄ds
,

27 
thªad_«me
, 
__func__
, 
__LINE__
,

31 
	}
}

33 
__exô
 
	$my_moduÀ_exô
()

35 
	`¥_öfo
("Exiting module\n");

36 
	}
}

38 
moduÀ_öô
(
my_moduÀ_öô
);

39 
moduÀ_exô
(
my_moduÀ_exô
);

41 
MODULE_LICENSE
("GPL");

42 
MODULE_AUTHOR
("CFG80211");

43 
MODULE_DESCRIPTION
("Kernel moduleÉxample with detailedÜog information");

	@trace.c

1 
	~<löux/moduÀ.h
>

3 #i‚de‡
__CHECKER__


4 
	#CREATE_TRACE_POINTS


	)

5 
	~"åa˚.h
"

	@trace.h

7 #unde‡
TRACE_SYSTEM


8 
	#TRACE_SYSTEM
 
cfg80211


	)

10 #i‡!
deföed
(
__RDEV_OPS_TRACE
Ë|| deföed(
TRACE_HEADER_MULTI_READ
)

11 
	#__RDEV_OPS_TRACE


	)

13 
	~<löux/åa˚poöt.h
>

15 
	~<löux/π√éök.h
>

16 
	~<löux/ëhîdevi˚.h
>

17 
	~<√t/cfg80211.h
>

18 
	~"c‹e.h
"

20 
	#MAC_ENTRY
(
íåy_mac
Ë
	`__¨øy
(
u8
,É¡ry_mac, 
ETH_ALEN
)

	)

21 
	#MAC_ASSIGN
(
íåy_mac
, 
giví_mac
) do { \

22 i‡(
giví_mac
) \

23 
	`mem˝y
(
__íåy
->
íåy_mac
, 
giví_mac
, 
ETH_ALEN
); \

25 
	`ëh_zîo_addr
(
__íåy
->
íåy_mac
); \

26 } 0)

	)

28 
	#MAXNAME
 32

	)

29 
	#WIPHY_ENTRY
 
	`__¨øy
(, 
wùhy_«me
, 32)

	)

30 
	#WIPHY_ASSIGN
 
	`°rs˝y
(
__íåy
->
wùhy_«me
, 
	`wùhy_«me
(
wùhy
), 
MAXNAME
)

	)

31 
	#WIPHY_PR_FMT
 "%s"

	)

32 
	#WIPHY_PR_ARG
 
__íåy
->
wùhy_«me


	)

34 
	#WDEV_ENTRY
 
	`__fõld
(
u32
, 
id
)

	)

35 
	#WDEV_ASSIGN
 (
__íåy
->
id
Ë(!
	`IS_ERR_OR_NULL
(
wdev
) \

36 ? 
wdev
->
idítifõr
 : 0)

	)

37 
	#WDEV_PR_FMT
 "wdev(%u)"

	)

38 
	#WDEV_PR_ARG
 (
__íåy
->
id
)

	)

40 
	#NETDEV_ENTRY
 
	`__¨øy
(, 
«me
, 
IFNAMSIZ
) \

41 
	`__fõld
(, 
ifödex
)

	)

42 
	#NETDEV_ASSIGN
 \

44 
	`mem˝y
(
__íåy
->
«me
, 
√tdev
->«me, 
IFNAMSIZ
); \

45 (
__íåy
->
ifödex
Ë(
√tdev
->ifindex); \

46 } 0)

	)

47 
	#NETDEV_PR_FMT
 "√tdev:%s(%d)"

	)

48 
	#NETDEV_PR_ARG
 
__íåy
->
«me
, __íåy->
ifödex


	)

50 
	#MESH_CFG_ENTRY
 
	`__fõld
(
u16
, 
dŸ11MeshRëryTimeout
) \

51 
	`__fõld
(
u16
, 
dŸ11MeshC⁄fúmTimeout
) \

52 
	`__fõld
(
u16
, 
dŸ11MeshHﬁdögTimeout
) \

53 
	`__fõld
(
u16
, 
dŸ11MeshMaxPìrLöks
) \

54 
	`__fõld
(
u8
, 
dŸ11MeshMaxRërõs
) \

55 
	`__fõld
(
u8
, 
dŸ11MeshTTL
) \

56 
	`__fõld
(
u8
, 
ñemít_âl
) \

57 
	`__fõld
(
boﬁ
, 
auto_›í_∂öks
) \

58 
	`__fõld
(
u32
, 
dŸ11MeshNbrOff£tMaxNeighb‹
) \

59 
	`__fõld
(
u8
, 
dŸ11MeshHWMPmaxPREQªåõs
) \

60 
	`__fõld
(
u32
, 
∑th_ª‰esh_time
) \

61 
	`__fõld
(
u32
, 
dŸ11MeshHWMPa˘iveP©hTimeout
) \

62 
	`__fõld
(
u16
, 
mö_discovîy_timeout
) \

63 
	`__fõld
(
u16
, 
dŸ11MeshHWMP¥eqMöI¡îvÆ
) \

64 
	`__fõld
(
u16
, 
dŸ11MeshHWMP≥ºMöI¡îvÆ
) \

65 
	`__fõld
(
u16
, 
dŸ11MeshHWMP√tDümëîTøvîßlTime
) \

66 
	`__fõld
(
u8
, 
dŸ11MeshHWMPRoŸMode
) \

67 
	`__fõld
(
u16
, 
dŸ11MeshHWMPR™nI¡îvÆ
) \

68 
	`__fõld
(
boﬁ
, 
dŸ11MeshG©eA¬oun˚mítPrŸocﬁ
) \

69 
	`__fõld
(
boﬁ
, 
dŸ11MeshF‹w¨dög
) \

70 
	`__fõld
(
s32
, 
rssi_thªshﬁd
) \

71 
	`__fõld
(
u16
, 
ht_›mode
) \

72 
	`__fõld
(
u32
, 
dŸ11MeshHWMPa˘iveP©hToRoŸTimeout
) \

73 
	`__fõld
(
u16
, 
dŸ11MeshHWMProŸI¡îvÆ
) \

74 
	`__fõld
(
u16
, 
dŸ11MeshHWMPc⁄fúm©i⁄I¡îvÆ
) \

75 
	`__fõld
(
boﬁ
, 
dŸ11MeshNﬁó∫
)

	)

76 
	#MESH_CFG_ASSIGN
 \

78 
__íåy
->
dŸ11MeshRëryTimeout
 = 
c⁄f
->dot11MeshRetryTimeout; \

79 
__íåy
->
dŸ11MeshC⁄fúmTimeout
 = \

80 
c⁄f
->
dŸ11MeshC⁄fúmTimeout
; \

81 
__íåy
->
dŸ11MeshHﬁdögTimeout
 = \

82 
c⁄f
->
dŸ11MeshHﬁdögTimeout
; \

83 
__íåy
->
dŸ11MeshMaxPìrLöks
 = 
c⁄f
->dot11MeshMaxPeerLinks; \

84 
__íåy
->
dŸ11MeshMaxRërõs
 = 
c⁄f
->dot11MeshMaxRetries; \

85 
__íåy
->
dŸ11MeshTTL
 = 
c⁄f
->dot11MeshTTL; \

86 
__íåy
->
ñemít_âl
 = 
c⁄f
->element_ttl; \

87 
__íåy
->
auto_›í_∂öks
 = 
c⁄f
->auto_open_plinks; \

88 
__íåy
->
dŸ11MeshNbrOff£tMaxNeighb‹
 = \

89 
c⁄f
->
dŸ11MeshNbrOff£tMaxNeighb‹
; \

90 
__íåy
->
dŸ11MeshHWMPmaxPREQªåõs
 = \

91 
c⁄f
->
dŸ11MeshHWMPmaxPREQªåõs
; \

92 
__íåy
->
∑th_ª‰esh_time
 = 
c⁄f
->path_refresh_time; \

93 
__íåy
->
dŸ11MeshHWMPa˘iveP©hTimeout
 = \

94 
c⁄f
->
dŸ11MeshHWMPa˘iveP©hTimeout
; \

95 
__íåy
->
mö_discovîy_timeout
 = 
c⁄f
->min_discovery_timeout; \

96 
__íåy
->
dŸ11MeshHWMP¥eqMöI¡îvÆ
 = \

97 
c⁄f
->
dŸ11MeshHWMP¥eqMöI¡îvÆ
; \

98 
__íåy
->
dŸ11MeshHWMP≥ºMöI¡îvÆ
 = \

99 
c⁄f
->
dŸ11MeshHWMP≥ºMöI¡îvÆ
; \

100 
__íåy
->
dŸ11MeshHWMP√tDümëîTøvîßlTime
 = \

101 
c⁄f
->
dŸ11MeshHWMP√tDümëîTøvîßlTime
; \

102 
__íåy
->
dŸ11MeshHWMPRoŸMode
 = 
c⁄f
->dot11MeshHWMPRootMode; \

103 
__íåy
->
dŸ11MeshHWMPR™nI¡îvÆ
 = \

104 
c⁄f
->
dŸ11MeshHWMPR™nI¡îvÆ
; \

105 
__íåy
->
dŸ11MeshG©eA¬oun˚mítPrŸocﬁ
 = \

106 
c⁄f
->
dŸ11MeshG©eA¬oun˚mítPrŸocﬁ
; \

107 
__íåy
->
dŸ11MeshF‹w¨dög
 = 
c⁄f
->dot11MeshForwarding; \

108 
__íåy
->
rssi_thªshﬁd
 = 
c⁄f
->rssi_threshold; \

109 
__íåy
->
ht_›mode
 = 
c⁄f
->ht_opmode; \

110 
__íåy
->
dŸ11MeshHWMPa˘iveP©hToRoŸTimeout
 = \

111 
c⁄f
->
dŸ11MeshHWMPa˘iveP©hToRoŸTimeout
; \

112 
__íåy
->
dŸ11MeshHWMProŸI¡îvÆ
 = \

113 
c⁄f
->
dŸ11MeshHWMProŸI¡îvÆ
; \

114 
__íåy
->
dŸ11MeshHWMPc⁄fúm©i⁄I¡îvÆ
 = \

115 
c⁄f
->
dŸ11MeshHWMPc⁄fúm©i⁄I¡îvÆ
; \

116 
__íåy
->
dŸ11MeshNﬁó∫
 = 
c⁄f
->dot11MeshNolearn; \

117 } 0)

	)

119 
	#CHAN_ENTRY
 
	`__fõld
(
∆80211_b™d
, 
b™d
) \

120 
	`__fõld
(
u32
, 
˚¡î_‰eq
) \

121 
	`__fõld
(
u16
, 
‰eq_off£t
)

	)

122 
	#CHAN_ASSIGN
(
ch™
) \

124 i‡(
ch™
) { \

125 
__íåy
->
b™d
 = 
ch™
->band; \

126 
__íåy
->
˚¡î_‰eq
 = 
ch™
->center_freq; \

127 
__íåy
->
‰eq_off£t
 = 
ch™
->freq_offset; \

129 
__íåy
->
b™d
 = 0; \

130 
__íåy
->
˚¡î_‰eq
 = 0; \

131 
__íåy
->
‰eq_off£t
 = 0; \

133 } 0)

	)

134 
	#CHAN_PR_FMT
 "b™d: %d, fªq: %u.%03u"

	)

135 
	#CHAN_PR_ARG
 
__íåy
->
b™d
, __íåy->
˚¡î_‰eq
, __íåy->
‰eq_off£t


	)

137 
	#CHAN_DEF_ENTRY
 
	`__fõld
(
∆80211_b™d
, 
b™d
) \

138 
	`__fõld
(
u32
, 
c⁄åﬁ_‰eq
) \

139 
	`__fõld
(
u32
, 
‰eq_off£t
) \

140 
	`__fõld
(
u32
, 
width
) \

141 
	`__fõld
(
u32
, 
˚¡î_‰eq1
) \

142 
	`__fõld
(
u32
, 
‰eq1_off£t
) \

143 
	`__fõld
(
u32
, 
˚¡î_‰eq2
) \

144 
	`__fõld
(
u16
, 
pun˘uªd
)

	)

145 
	#CHAN_DEF_ASSIGN
(
ch™def
) \

147 i‡((
ch™def
Ë&& (ch™def)->
ch™
) { \

148 
__íåy
->
b™d
 = (
ch™def
)->
ch™
->band; \

149 
__íåy
->
c⁄åﬁ_‰eq
 = \

150 (
ch™def
)->
ch™
->
˚¡î_‰eq
; \

151 
__íåy
->
‰eq_off£t
 = \

152 (
ch™def
)->
ch™
->
‰eq_off£t
; \

153 
__íåy
->
width
 = (
ch™def
)->width; \

154 
__íåy
->
˚¡î_‰eq1
 = (
ch™def
)->center_freq1;\

155 
__íåy
->
‰eq1_off£t
 = (
ch™def
)->freq1_offset;\

156 
__íåy
->
˚¡î_‰eq2
 = (
ch™def
)->center_freq2;\

157 
__íåy
->
pun˘uªd
 = (
ch™def
)->punctured; \

159 
__íåy
->
b™d
 = 0; \

160 
__íåy
->
c⁄åﬁ_‰eq
 = 0; \

161 
__íåy
->
‰eq_off£t
 = 0; \

162 
__íåy
->
width
 = 0; \

163 
__íåy
->
˚¡î_‰eq1
 = 0; \

164 
__íåy
->
‰eq1_off£t
 = 0; \

165 
__íåy
->
˚¡î_‰eq2
 = 0; \

166 
__íåy
->
pun˘uªd
 = 0; \

168 } 0)

	)

169 
	#CHAN_DEF_PR_FMT
 \

170 "b™d: %d, c⁄åﬁ fªq: %u.%03u, width: %d, cf1: %u.%03u, cf2: %u,Öun˘: 0x%x"

	)

171 
	#CHAN_DEF_PR_ARG
 
__íåy
->
b™d
, __íåy->
c⁄åﬁ_‰eq
, \

172 
__íåy
->
‰eq_off£t
, __íåy->
width
, \

173 
__íåy
->
˚¡î_‰eq1
, __íåy->
‰eq1_off£t
, \

174 
__íåy
->
˚¡î_‰eq2
, __íåy->
pun˘uªd


	)

176 
	#FILS_AAD_ASSIGN
(
Á
) \

178 i‡(
Á
) { \

179 
	`ëhî_addr_c›y
(
__íåy
->
maˇddr
, 
Á
->macaddr); \

180 
__íåy
->
kek_Àn
 = 
Á
->kek_len; \

182 
	`ëh_zîo_addr
(
__íåy
->
maˇddr
); \

183 
__íåy
->
kek_Àn
 = 0; \

185 } 0)

	)

186 
	#FILS_AAD_PR_FMT
 \

187 "maˇddr: %pM, kek_Àn: %d"

	)

189 
	#SINFO_ENTRY
 
	`__fõld
(, 
gíî©i⁄
) \

190 
	`__fõld
(
u32
, 
c⁄√˘ed_time
) \

191 
	`__fõld
(
u32
, 
öa˘ive_time
) \

192 
	`__fõld
(
u32
, 
rx_byãs
) \

193 
	`__fõld
(
u32
, 
tx_byãs
) \

194 
	`__fõld
(
u32
, 
rx_∑ckës
) \

195 
	`__fõld
(
u32
, 
tx_∑ckës
) \

196 
	`__fõld
(
u32
, 
tx_ªåõs
) \

197 
	`__fõld
(
u32
, 
tx_Áûed
) \

198 
	`__fõld
(
u32
, 
rx_dr›≥d_misc
) \

199 
	`__fõld
(
u32
, 
bóc⁄_loss_cou¡
) \

200 
	`__fõld
(
u16
, 
Œid
) \

201 
	`__fõld
(
u16
, 
∂id
) \

202 
	`__fõld
(
u8
, 
∂ök_°©e
)

	)

203 
	#SINFO_ASSIGN
 \

205 
__íåy
->
gíî©i⁄
 = 
söfo
->generation; \

206 
__íåy
->
c⁄√˘ed_time
 = 
söfo
->connected_time; \

207 
__íåy
->
öa˘ive_time
 = 
söfo
->inactive_time; \

208 
__íåy
->
rx_byãs
 = 
söfo
->rx_bytes; \

209 
__íåy
->
tx_byãs
 = 
söfo
->tx_bytes; \

210 
__íåy
->
rx_∑ckës
 = 
söfo
->rx_packets; \

211 
__íåy
->
tx_∑ckës
 = 
söfo
->tx_packets; \

212 
__íåy
->
tx_ªåõs
 = 
söfo
->tx_retries; \

213 
__íåy
->
tx_Áûed
 = 
söfo
->tx_failed; \

214 
__íåy
->
rx_dr›≥d_misc
 = 
söfo
->rx_dropped_misc; \

215 
__íåy
->
bóc⁄_loss_cou¡
 = 
söfo
->beacon_loss_count; \

216 
__íåy
->
Œid
 = 
söfo
->llid; \

217 
__íåy
->
∂id
 = 
söfo
->plid; \

218 
__íåy
->
∂ök_°©e
 = 
söfo
->plink_state; \

219 } 0)

	)

221 
	#BOOL_TO_STR
(
bo
Ë(boË? "åue" : "Ál£"

	)

223 
	#QOS_MAP_ENTRY
 
	`__fõld
(
u8
, 
num_des
) \

224 
	`__¨øy
(
u8
, 
ds˝_ex˚±i⁄
, \

225 2 * 
IEEE80211_QOS_MAP_MAX_EX
) \

226 
	`__¨øy
(
u8
, 
up
, 
IEEE80211_QOS_MAP_LEN_MIN
)

	)

227 
	#QOS_MAP_ASSIGN
(
qos_m≠
) \

229 i‡((
qos_m≠
)) { \

230 
__íåy
->
num_des
 = (
qos_m≠
)->num_des; \

231 
	`mem˝y
(
__íåy
->
ds˝_ex˚±i⁄
, \

232 &(
qos_m≠
)->
ds˝_ex˚±i⁄
, \

233 2 * 
IEEE80211_QOS_MAP_MAX_EX
); \

234 
	`mem˝y
(
__íåy
->
up
, &(
qos_m≠
)->up, \

235 
IEEE80211_QOS_MAP_LEN_MIN
); \

237 
__íåy
->
num_des
 = 0; \

238 
	`mem£t
(
__íåy
->
ds˝_ex˚±i⁄
, 0, \

239 2 * 
IEEE80211_QOS_MAP_MAX_EX
); \

240 
	`mem£t
(
__íåy
->
up
, 0, \

241 
IEEE80211_QOS_MAP_LEN_MIN
); \

243 } 0)

	)

249 
TRACE_EVENT
(
rdev_su•íd
,

250 
TP_PROTO
(
wùhy
 *wùhy, 
cfg80211_wowœn
 *
wow
),

251 
TP_ARGS
(
wùhy
, 
wow
),

252 
TP_STRUCT__íåy
(

253 
WIPHY_ENTRY


254 
	$__fõld
(
boﬁ
, 
™y
)

255 
	$__fõld
(
boﬁ
, 
disc⁄√˘
)

256 
	$__fõld
(
boﬁ
, 
magic_pkt
)

257 
	$__fõld
(
boﬁ
, 
gtk_ªkey_Áûuª
)

258 
	$__fõld
(
boﬁ
, 
óp_idítôy_ªq
)

259 
	$__fõld
(
boﬁ
, 
four_way_h™dshake
)

260 
	$__fõld
(
boﬁ
, 
rfkûl_ªÀa£
)

261 
	`__fõld
(
boﬁ
, 
vÆid_wow
)

263 
	`TP_Á°_assign
(

264 
WIPHY_ASSIGN
;

265 i‡(
wow
) {

266 
__íåy
->
™y
 = 
wow
->any;

267 
__íåy
->
disc⁄√˘
 = 
wow
->disconnect;

268 
__íåy
->
magic_pkt
 = 
wow
->magic_pkt;

269 
__íåy
->
gtk_ªkey_Áûuª
 = 
wow
->gtk_rekey_failure;

270 
__íåy
->
óp_idítôy_ªq
 = 
wow
->eap_identity_req;

271 
__íåy
->
four_way_h™dshake
 = 
wow
->four_way_handshake;

272 
__íåy
->
rfkûl_ªÀa£
 = 
wow
->rfkill_release;

273 
__íåy
->
vÆid_wow
 = 
åue
;

274 
	}
} {

275 
__íåy
->
vÆid_wow
 = 
Ál£
;

278 
TP_¥ötk
(
WIPHY_PR_FMT
 ", wow%s -ány: %d, disconnect: %d, "

281 
WIPHY_PR_ARG
, 
__íåy
->
vÆid_wow
 ? "" : "(Not configured!)",

282 
__íåy
->
™y
, __íåy->
disc⁄√˘
, __íåy->
magic_pkt
,

283 
__íåy
->
gtk_ªkey_Áûuª
, __íåy->
óp_idítôy_ªq
,

284 
__íåy
->
four_way_h™dshake
, __íåy->
rfkûl_ªÀa£
)

287 
TRACE_EVENT
(
rdev_ªtu∫_öt
,

288 
TP_PROTO
(
wùhy
 *wùhy, 
ªt
),

289 
TP_ARGS
(
wùhy
, 
ªt
),

290 
TP_STRUCT__íåy
(

291 
WIPHY_ENTRY


292 
__fõld
(, 
ªt
)

294 
TP_Á°_assign
(

295 
WIPHY_ASSIGN
;

296 
__íåy
->
ªt
 =Ñet;

298 
TP_¥ötk
(
WIPHY_PR_FMT
 ",Ñëu∫ed: %d", 
WIPHY_PR_ARG
, 
__íåy
->
ªt
)

301 
TRACE_EVENT
(
rdev_sˇn
,

302 
TP_PROTO
(
wùhy
 *wùhy, 
cfg80211_sˇn_ªque°
 *
ªque°
),

303 
TP_ARGS
(
wùhy
, 
ªque°
),

304 
TP_STRUCT__íåy
(

305 
WIPHY_ENTRY


307 
TP_Á°_assign
(

308 
WIPHY_ASSIGN
;

310 
TP_¥ötk
(
WIPHY_PR_FMT
, 
WIPHY_PR_ARG
)

313 
DECLARE_EVENT_CLASS
(
wùhy_⁄ly_evt
,

314 
TP_PROTO
(
wùhy
 *wiphy),

315 
TP_ARGS
(
wùhy
),

316 
TP_STRUCT__íåy
(

317 
WIPHY_ENTRY


319 
TP_Á°_assign
(

320 
WIPHY_ASSIGN
;

322 
TP_¥ötk
(
WIPHY_PR_FMT
, 
WIPHY_PR_ARG
)

325 
DEFINE_EVENT
(
wùhy_⁄ly_evt
, 
rdev_ªsume
,

326 
TP_PROTO
(
wùhy
 *wiphy),

327 
TP_ARGS
(
wùhy
)

330 
DEFINE_EVENT
(
wùhy_⁄ly_evt
, 
rdev_ªtu∫_void
,

331 
TP_PROTO
(
wùhy
 *wiphy),

332 
TP_ARGS
(
wùhy
)

335 
DEFINE_EVENT
(
wùhy_⁄ly_evt
, 
rdev_gë_™ã¬a
,

336 
TP_PROTO
(
wùhy
 *wiphy),

337 
TP_ARGS
(
wùhy
)

340 
DEFINE_EVENT
(
wùhy_⁄ly_evt
, 
rdev_rfkûl_pﬁl
,

341 
TP_PROTO
(
wùhy
 *wiphy),

342 
TP_ARGS
(
wùhy
)

345 
DECLARE_EVENT_CLASS
(
wùhy_íabÀd_evt
,

346 
TP_PROTO
(
wùhy
 *wùhy, 
boﬁ
 
íabÀd
),

347 
TP_ARGS
(
wùhy
, 
íabÀd
),

348 
TP_STRUCT__íåy
(

349 
WIPHY_ENTRY


350 
__fõld
(
boﬁ
, 
íabÀd
)

352 
TP_Á°_assign
(

353 
WIPHY_ASSIGN
;

354 
__íåy
->
íabÀd
 =Énabled;

356 
TP_¥ötk
(
WIPHY_PR_FMT
 ", %senabled ",

357 
WIPHY_PR_ARG
, 
__íåy
->
íabÀd
 ? "" : "not ")

360 
DEFINE_EVENT
(
wùhy_íabÀd_evt
, 
rdev_£t_wakeup
,

361 
TP_PROTO
(
wùhy
 *wùhy, 
boﬁ
 
íabÀd
),

362 
TP_ARGS
(
wùhy
, 
íabÀd
)

365 
TRACE_EVENT
(
rdev_add_vútuÆ_ötf
,

366 
TP_PROTO
(
wùhy
 *wùhy, *
«me
, 
∆80211_i·y≥
 
ty≥
),

367 
TP_ARGS
(
wùhy
, 
«me
, 
ty≥
),

368 
TP_STRUCT__íåy
(

369 
WIPHY_ENTRY


370 
__°rög
(
vú_ötf_«me
, 
«me
 ?Çame : "<noname>")

371 
__fõld
(
∆80211_i·y≥
, 
ty≥
)

373 
TP_Á°_assign
(

374 
WIPHY_ASSIGN
;

375 
__assign_°r
(
vú_ötf_«me
, 
«me
 ?Çame : "<noname>");

376 
__íåy
->
ty≥
 =Åype;

378 
TP_¥ötk
(
WIPHY_PR_FMT
 ", virtual intfÇame: %s,Åype: %d",

379 
WIPHY_PR_ARG
, 
__gë_°r
(
vú_ötf_«me
), 
__íåy
->
ty≥
)

382 
DECLARE_EVENT_CLASS
(
wùhy_wdev_evt
,

383 
TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

384 
TP_ARGS
(
wùhy
, 
wdev
),

385 
TP_STRUCT__íåy
(

386 
WIPHY_ENTRY


387 
WDEV_ENTRY


389 
TP_Á°_assign
(

390 
WIPHY_ASSIGN
;

391 
WDEV_ASSIGN
;

393 
TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
, 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
)

396 
DECLARE_EVENT_CLASS
(
wùhy_wdev_cookõ_evt
,

397 
TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
, 
u64
 
cookõ
),

398 
TP_ARGS
(
wùhy
, 
wdev
, 
cookõ
),

399 
TP_STRUCT__íåy
(

400 
WIPHY_ENTRY


401 
WDEV_ENTRY


402 
__fõld
(
u64
, 
cookõ
)

404 
TP_Á°_assign
(

405 
WIPHY_ASSIGN
;

406 
WDEV_ASSIGN
;

407 
__íåy
->
cookõ
 = cookie;

409 
TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ", cookie: %lld",

410 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
,

411 ()
__íåy
->
cookõ
)

414 
DEFINE_EVENT
(
wùhy_wdev_evt
, 
rdev_ªtu∫_wdev
,

415 
TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

416 
TP_ARGS
(
wùhy
, 
wdev
)

419 
DEFINE_EVENT
(
wùhy_wdev_evt
, 
rdev_dñ_vútuÆ_ötf
,

420 
TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

421 
TP_ARGS
(
wùhy
, 
wdev
)

424 
TRACE_EVENT
(
rdev_ch™ge_vútuÆ_ötf
,

425 
TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

426 
∆80211_i·y≥
 
ty≥
),

427 
TP_ARGS
(
wùhy
, 
√tdev
, 
ty≥
),

428 
TP_STRUCT__íåy
(

429 
WIPHY_ENTRY


430 
NETDEV_ENTRY


431 
__fõld
(
∆80211_i·y≥
, 
ty≥
)

433 
TP_Á°_assign
(

434 
WIPHY_ASSIGN
;

435 
NETDEV_ASSIGN
;

436 
__íåy
->
ty≥
 =Åype;

438 
TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Åype: %d",

439 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
ty≥
)

442 
DECLARE_EVENT_CLASS
(
key_h™dÀ
,

443 
TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
lök_id
,

444 
u8
 
key_ödex
, 
boﬁ
 
∑úwi£
, c⁄° u8 *
mac_addr
),

445 
TP_ARGS
(
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
, 
∑úwi£
, 
mac_addr
),

446 
TP_STRUCT__íåy
(

447 
WIPHY_ENTRY


448 
NETDEV_ENTRY


449 
	$MAC_ENTRY
(
mac_addr
)

450 
	$__fõld
(, 
lök_id
)

451 
	$__fõld
(
u8
, 
key_ödex
)

452 
	`__fõld
(
boﬁ
, 
∑úwi£
)

454 
	`TP_Á°_assign
(

455 
WIPHY_ASSIGN
;

456 
NETDEV_ASSIGN
;

457 
	`MAC_ASSIGN
(
mac_addr
, mac_addr);

458 
__íåy
->
lök_id
 =Üink_id;

459 
__íåy
->
key_ödex
 = key_index;

460 
__íåy
->
∑úwi£
 =Öairwise;

462 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Üink_id: %d, "

464 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
lök_id
,

465 
__íåy
->
key_ödex
, 
	`BOOL_TO_STR
(__íåy->
∑úwi£
),

466 
__íåy
->
mac_addr
)

469 
	`DEFINE_EVENT
(
key_h™dÀ
, 
rdev_gë_key
,

470 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
lök_id
,

471 
u8
 
key_ödex
, 
boﬁ
 
∑úwi£
, c⁄° u8 *
mac_addr
),

472 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
, 
∑úwi£
, 
mac_addr
)

475 
	`DEFINE_EVENT
(
key_h™dÀ
, 
rdev_dñ_key
,

476 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
lök_id
,

477 
u8
 
key_ödex
, 
boﬁ
 
∑úwi£
, c⁄° u8 *
mac_addr
),

478 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
, 
∑úwi£
, 
mac_addr
)

481 
	`TRACE_EVENT
(
rdev_add_key
,

482 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
lök_id
,

483 
u8
 
key_ödex
, 
boﬁ
 
∑úwi£
, c⁄° u8 *
mac_addr
, u8 
mode
),

484 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
, 
∑úwi£
, 
mac_addr
, 
mode
),

485 
	`TP_STRUCT__íåy
(

486 
WIPHY_ENTRY


487 
NETDEV_ENTRY


488 
	$MAC_ENTRY
(
mac_addr
)

489 
	$__fõld
(, 
lök_id
)

490 
	$__fõld
(
u8
, 
key_ödex
)

491 
	$__fõld
(
boﬁ
, 
∑úwi£
)

492 
	`__fõld
(
u8
, 
mode
)

494 
	`TP_Á°_assign
(

495 
WIPHY_ASSIGN
;

496 
NETDEV_ASSIGN
;

497 
	`MAC_ASSIGN
(
mac_addr
, mac_addr);

498 
__íåy
->
lök_id
 =Üink_id;

499 
__íåy
->
key_ödex
 = key_index;

500 
__íåy
->
∑úwi£
 =Öairwise;

501 
__íåy
->
mode
 = mode;

503 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Üink_id: %d, "

506 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
lök_id
,

507 
__íåy
->
key_ödex
, __íåy->
mode
,

508 
	`BOOL_TO_STR
(
__íåy
->
∑úwi£
), __íåy->
mac_addr
)

511 
	`TRACE_EVENT
(
rdev_£t_deÁu…_key
,

512 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
lök_id
,

513 
u8
 
key_ödex
, 
boﬁ
 
uniˇ°
, boﬁ 
mu…iˇ°
),

514 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
, 
uniˇ°
, 
mu…iˇ°
),

515 
	`TP_STRUCT__íåy
(

516 
WIPHY_ENTRY


517 
NETDEV_ENTRY


518 
	$__fõld
(, 
lök_id
)

519 
	$__fõld
(
u8
, 
key_ödex
)

520 
	$__fõld
(
boﬁ
, 
uniˇ°
)

521 
	`__fõld
(
boﬁ
, 
mu…iˇ°
)

523 
	`TP_Á°_assign
(

524 
WIPHY_ASSIGN
;

525 
NETDEV_ASSIGN
;

526 
__íåy
->
lök_id
 =Üink_id;

527 
__íåy
->
key_ödex
 = key_index;

528 
__íåy
->
uniˇ°
 = unicast;

529 
__íåy
->
mu…iˇ°
 = multicast;

531 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Üink_id: %d, "

533 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
lök_id
,

534 
__íåy
->
key_ödex
, 
	`BOOL_TO_STR
(__íåy->
uniˇ°
),

535 
	`BOOL_TO_STR
(
__íåy
->
mu…iˇ°
))

538 
	`TRACE_EVENT
(
rdev_£t_deÁu…_mgmt_key
,

539 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
lök_id
,

540 
u8
 
key_ödex
),

541 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
),

542 
	`TP_STRUCT__íåy
(

543 
WIPHY_ENTRY


544 
NETDEV_ENTRY


545 
	$__fõld
(, 
lök_id
)

546 
	`__fõld
(
u8
, 
key_ödex
)

548 
	`TP_Á°_assign
(

549 
WIPHY_ASSIGN
;

550 
NETDEV_ASSIGN
;

551 
__íåy
->
lök_id
 =Üink_id;

552 
__íåy
->
key_ödex
 = key_index;

554 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Üink_id: %d, "

555 "key index: %u", 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
,

556 
__íåy
->
lök_id
, __íåy->
key_ödex
)

559 
	`TRACE_EVENT
(
rdev_£t_deÁu…_bóc⁄_key
,

560 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
lök_id
,

561 
u8
 
key_ödex
),

562 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
lök_id
, 
key_ödex
),

563 
	`TP_STRUCT__íåy
(

564 
WIPHY_ENTRY


565 
NETDEV_ENTRY


566 
	$__fõld
(, 
lök_id
)

567 
	`__fõld
(
u8
, 
key_ödex
)

569 
	`TP_Á°_assign
(

570 
WIPHY_ASSIGN
;

571 
NETDEV_ASSIGN
;

572 
__íåy
->
lök_id
 =Üink_id;

573 
__íåy
->
key_ödex
 = key_index;

575 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Üink_id: %d, "

576 "key index: %u", 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
,

577 
__íåy
->
lök_id
, __íåy->
key_ödex
)

580 
	`TRACE_EVENT
(
rdev_°¨t_≠
,

581 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

582 
cfg80211_≠_£âögs
 *
£âögs
),

583 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
£âögs
),

584 
	`TP_STRUCT__íåy
(

585 
WIPHY_ENTRY


586 
NETDEV_ENTRY


587 
CHAN_DEF_ENTRY


588 
	$__fõld
(, 
bóc⁄_öãrvÆ
)

589 
	$__fõld
(, 
dtim_≥riod
)

590 
	`__¨øy
(, 
ssid
, 
IEEE80211_MAX_SSID_LEN
 + 1)

591 
	$__fõld
(
∆80211_hiddí_ssid
, 
hiddí_ssid
)

592 
	$__fõld
(
u32
, 
w∑_vî
)

593 
	$__fõld
(
boﬁ
, 
¥ivacy
)

594 
	$__fõld
(
∆80211_auth_ty≥
, 
auth_ty≥
)

595 
	$__fõld
(, 
öa˘ivôy_timeout
)

596 
	`__fõld
(, 
lök_id
)

598 
	`TP_Á°_assign
(

599 
WIPHY_ASSIGN
;

600 
NETDEV_ASSIGN
;

601 
	`CHAN_DEF_ASSIGN
(&
£âögs
->
ch™def
);

602 
__íåy
->
bóc⁄_öãrvÆ
 = 
£âögs
->beacon_interval;

603 
__íåy
->
dtim_≥riod
 = 
£âögs
->dtim_period;

604 
__íåy
->
hiddí_ssid
 = 
£âögs
->hidden_ssid;

605 
__íåy
->
w∑_vî
 = 
£âögs
->
¸y±o
.
w∑_vîsi⁄s
;

606 
__íåy
->
¥ivacy
 = 
£âögs
->privacy;

607 
__íåy
->
auth_ty≥
 = 
£âögs
->auth_type;

608 
__íåy
->
öa˘ivôy_timeout
 = 
£âögs
->inactivity_timeout;

609 
	`mem£t
(
__íåy
->
ssid
, 0, 
IEEE80211_MAX_SSID_LEN
 + 1);

610 
	`mem˝y
(
__íåy
->
ssid
, 
£âögs
->ssid, sëtögs->
ssid_Àn
);

611 
__íåy
->
lök_id
 = 
£âögs
->
bóc⁄
.link_id;

613 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", AP settings - ssid: %s, "

614 
CHAN_DEF_PR_FMT
 ", beacon interval: %d, dtimÖeriod: %d, "

617 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
ssid
, 
CHAN_DEF_PR_ARG
,

618 
__íåy
->
bóc⁄_öãrvÆ
, __íåy->
dtim_≥riod
,

619 
__íåy
->
hiddí_ssid
, __íåy->
w∑_vî
,

620 
	`BOOL_TO_STR
(
__íåy
->
¥ivacy
), __íåy->
auth_ty≥
,

621 
__íåy
->
öa˘ivôy_timeout
, __íåy->
lök_id
)

624 
	`TRACE_EVENT
(
rdev_ch™ge_bóc⁄
,

625 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

626 
cfg80211_≠_upd©e
 *
öfo
),

627 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
öfo
),

628 
	`TP_STRUCT__íåy
(

629 
WIPHY_ENTRY


630 
NETDEV_ENTRY


631 
	$__fõld
(, 
lök_id
)

632 
	`__dy«mic_¨øy
(
u8
, 
hód
, 
öfo
->
bóc⁄
.
hód_Àn
)

633 
	`__dy«mic_¨øy
(
u8
, 
èû
, 
öfo
->
bóc⁄
.
èû_Àn
)

634 
	`__dy«mic_¨øy
(
u8
, 
bóc⁄_õs
, 
öfo
->
bóc⁄
.
bóc⁄_õs_Àn
)

635 
	`__dy«mic_¨øy
(
u8
, 
¥obîe•_õs
, 
öfo
->
bóc⁄
.
¥obîe•_õs_Àn
)

636 
	`__dy«mic_¨øy
(
u8
, 
asso¸e•_õs
, 
öfo
->
bóc⁄
.
asso¸e•_õs_Àn
)

637 
	`__dy«mic_¨øy
(
u8
, 
¥obe_ª•
, 
öfo
->
bóc⁄
.
¥obe_ª•_Àn
)

639 
	`TP_Á°_assign
(

640 
WIPHY_ASSIGN
;

641 
NETDEV_ASSIGN
;

642 
__íåy
->
lök_id
 = 
öfo
->
bóc⁄
.link_id;

643 i‡(
öfo
->
bóc⁄
.
hód
)

644 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
hód
),

645 
öfo
->
bóc⁄
.
hód
,

646 
öfo
->
bóc⁄
.
hód_Àn
);

647 i‡(
öfo
->
bóc⁄
.
èû
)

648 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
èû
),

649 
öfo
->
bóc⁄
.
èû
,

650 
öfo
->
bóc⁄
.
èû_Àn
);

651 i‡(
öfo
->
bóc⁄
.
bóc⁄_õs
)

652 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
bóc⁄_õs
),

653 
öfo
->
bóc⁄
.
bóc⁄_õs
,

654 
öfo
->
bóc⁄
.
bóc⁄_õs_Àn
);

655 i‡(
öfo
->
bóc⁄
.
¥obîe•_õs
)

656 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
¥obîe•_õs
),

657 
öfo
->
bóc⁄
.
¥obîe•_õs
,

658 
öfo
->
bóc⁄
.
¥obîe•_õs_Àn
);

659 i‡(
öfo
->
bóc⁄
.
asso¸e•_õs
)

660 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
asso¸e•_õs
),

661 
öfo
->
bóc⁄
.
asso¸e•_õs
,

662 
öfo
->
bóc⁄
.
asso¸e•_õs_Àn
);

663 i‡(
öfo
->
bóc⁄
.
¥obe_ª•
)

664 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
¥obe_ª•
),

665 
öfo
->
bóc⁄
.
¥obe_ª•
,

666 
öfo
->
bóc⁄
.
¥obe_ª•_Àn
);

668 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Üink_id:%d",

669 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
lök_id
)

672 
	`TRACE_EVENT
(
rdev_°›_≠
,

673 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

674 
lök_id
),

675 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
lök_id
),

676 
	`TP_STRUCT__íåy
(

677 
WIPHY_ENTRY


678 
NETDEV_ENTRY


679 
	`__fõld
(, 
lök_id
)

681 
	`TP_Á°_assign
(

682 
WIPHY_ASSIGN
;

683 
NETDEV_ASSIGN
;

684 
__íåy
->
lök_id
 =Üink_id;

686 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Üink_id: %d",

687 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
lök_id
)

690 
	`DECLARE_EVENT_CLASS
(
wùhy_√tdev_evt
,

691 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
),

692 
	`TP_ARGS
(
wùhy
, 
√tdev
),

693 
	`TP_STRUCT__íåy
(

694 
WIPHY_ENTRY


695 
NETDEV_ENTRY


697 
	`TP_Á°_assign
(

698 
WIPHY_ASSIGN
;

699 
NETDEV_ASSIGN
;

701 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
, 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
)

704 
	`DEFINE_EVENT
(
wùhy_√tdev_evt
, 
rdev_£t_ªkey_d©a
,

705 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
),

706 
	`TP_ARGS
(
wùhy
, 
√tdev
)

709 
	`DEFINE_EVENT
(
wùhy_√tdev_evt
, 
rdev_gë_mesh_c⁄fig
,

710 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
),

711 
	`TP_ARGS
(
wùhy
, 
√tdev
)

714 
	`DEFINE_EVENT
(
wùhy_√tdev_evt
, 
rdev_Àave_mesh
,

715 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
),

716 
	`TP_ARGS
(
wùhy
, 
√tdev
)

719 
	`DEFINE_EVENT
(
wùhy_√tdev_evt
, 
rdev_Àave_ibss
,

720 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
),

721 
	`TP_ARGS
(
wùhy
, 
√tdev
)

724 
	`DEFINE_EVENT
(
wùhy_√tdev_evt
, 
rdev_Àave_ocb
,

725 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
),

726 
	`TP_ARGS
(
wùhy
, 
√tdev
)

729 
	`DEFINE_EVENT
(
wùhy_√tdev_evt
, 
rdev_Êush_pmkß
,

730 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
),

731 
	`TP_ARGS
(
wùhy
, 
√tdev
)

734 
	`DEFINE_EVENT
(
wùhy_√tdev_evt
, 
rdev_íd_ˇc
,

735 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
),

736 
	`TP_ARGS
(
wùhy
, 
√tdev
)

739 
	`DECLARE_EVENT_CLASS
(
°©i⁄_add_ch™ge
,

740 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u8
 *
mac
,

741 
°©i⁄_∑ømëîs
 *
∑øms
),

742 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
mac
, 
∑øms
),

743 
	`TP_STRUCT__íåy
(

744 
WIPHY_ENTRY


745 
NETDEV_ENTRY


746 
	$MAC_ENTRY
(
°a_mac
)

747 
	$__fõld
(
u32
, 
°a_Êags_mask
)

748 
	$__fõld
(
u32
, 
°a_Êags_£t
)

749 
	$__fõld
(
u32
, 
°a_modify_mask
)

750 
	$__fõld
(, 
li°í_öãrvÆ
)

751 
	$__fõld
(
u16
, 
ˇ∑bûôy
)

752 
	$__fõld
(
u16
, 
aid
)

753 
	$__fõld
(
u8
, 
∂ök_a˘i⁄
)

754 
	$__fõld
(
u8
, 
∂ök_°©e
)

755 
	$__fõld
(
u8
, 
u≠sd_queues
)

756 
	$__fõld
(
u8
, 
max_•
)

757 
	$__fõld
(
u8
, 
›mode_nŸif
)

758 
	$__fõld
(
boﬁ
, 
›mode_nŸif_u£d
)

759 
	`__¨øy
(
u8
, 
ht_ˇ∑
, ()(
õì80211_ht_ˇp
))

760 
	`__¨øy
(
u8
, 
vht_ˇ∑
, ()(
õì80211_vht_ˇp
))

761 
	$__¨øy
(, 
vœn
, 
IFNAMSIZ
)

762 
	`__dy«mic_¨øy
(
u8
, 
suµ‹ãd_øãs
,

763 
∑øms
->
lök_°a_∑øms
.
suµ‹ãd_øãs_Àn
)

764 
	`__dy«mic_¨øy
(
u8
, 
ext_ˇ∑b
, 
∑øms
->
ext_ˇ∑b_Àn
)

765 
	`__dy«mic_¨øy
(
u8
, 
suµ‹ãd_ch™√ls
,

766 
∑øms
->
suµ‹ãd_ch™√ls_Àn
)

767 
	`__dy«mic_¨øy
(
u8
, 
suµ‹ãd_›î_˛as£s
,

768 
∑øms
->
suµ‹ãd_›î_˛as£s_Àn
)

770 
	`TP_Á°_assign
(

771 
WIPHY_ASSIGN
;

772 
NETDEV_ASSIGN
;

773 
	`MAC_ASSIGN
(
°a_mac
, 
mac
);

774 
__íåy
->
°a_Êags_mask
 = 
∑øms
->sta_flags_mask;

775 
__íåy
->
°a_Êags_£t
 = 
∑øms
->sta_flags_set;

776 
__íåy
->
°a_modify_mask
 = 
∑øms
->sta_modify_mask;

777 
__íåy
->
li°í_öãrvÆ
 = 
∑øms
->listen_interval;

778 
__íåy
->
aid
 = 
∑øms
->aid;

779 
__íåy
->
∂ök_a˘i⁄
 = 
∑øms
->plink_action;

780 
__íåy
->
∂ök_°©e
 = 
∑øms
->plink_state;

781 
__íåy
->
u≠sd_queues
 = 
∑øms
->uapsd_queues;

782 
	`mem£t
(
__íåy
->
ht_ˇ∑
, 0, (
õì80211_ht_ˇp
));

783 i‡(
∑øms
->
lök_°a_∑øms
.
ht_ˇ∑
)

784 
	`mem˝y
(
__íåy
->
ht_ˇ∑
,

785 
∑øms
->
lök_°a_∑øms
.
ht_ˇ∑
,

786 (
õì80211_ht_ˇp
));

787 
	`mem£t
(
__íåy
->
vht_ˇ∑
, 0, (
õì80211_vht_ˇp
));

788 i‡(
∑øms
->
lök_°a_∑øms
.
vht_ˇ∑
)

789 
	`mem˝y
(
__íåy
->
vht_ˇ∑
,

790 
∑øms
->
lök_°a_∑øms
.
vht_ˇ∑
,

791 (
õì80211_vht_ˇp
));

792 
	`mem£t
(
__íåy
->
vœn
, 0, (__entry->vlan));

793 i‡(
∑øms
->
vœn
)

794 
	`mem˝y
(
__íåy
->
vœn
, 
∑øms
->vœn->
«me
, 
IFNAMSIZ
);

795 i‡(
∑øms
->
lök_°a_∑øms
.
suµ‹ãd_øãs
 &&

796 
∑øms
->
lök_°a_∑øms
.
suµ‹ãd_øãs_Àn
)

797 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
suµ‹ãd_øãs
),

798 
∑øms
->
lök_°a_∑øms
.
suµ‹ãd_øãs
,

799 
∑øms
->
lök_°a_∑øms
.
suµ‹ãd_øãs_Àn
);

800 i‡(
∑øms
->
ext_ˇ∑b
 &&Ö¨ams->
ext_ˇ∑b_Àn
)

801 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
ext_ˇ∑b
),

802 
∑øms
->
ext_ˇ∑b
,

803 
∑øms
->
ext_ˇ∑b_Àn
);

804 i‡(
∑øms
->
suµ‹ãd_ch™√ls
 &&

805 
∑øms
->
suµ‹ãd_ch™√ls_Àn
)

806 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
suµ‹ãd_ch™√ls
),

807 
∑øms
->
suµ‹ãd_ch™√ls
,

808 
∑øms
->
suµ‹ãd_ch™√ls_Àn
);

809 i‡(
∑øms
->
suµ‹ãd_›î_˛as£s
 &&

810 
∑øms
->
suµ‹ãd_›î_˛as£s_Àn
)

811 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
suµ‹ãd_›î_˛as£s
),

812 
∑øms
->
suµ‹ãd_›î_˛as£s
,

813 
∑øms
->
suµ‹ãd_›î_˛as£s_Àn
);

814 
__íåy
->
max_•
 = 
∑øms
->max_sp;

815 
__íåy
->
ˇ∑bûôy
 = 
∑øms
->capability;

816 
__íåy
->
›mode_nŸif
 = 
∑øms
->
lök_°a_∑øms
.opmode_notif;

817 
__íåy
->
›mode_nŸif_u£d
 =

818 
∑øms
->
lök_°a_∑øms
.
›mode_nŸif_u£d
;

820 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", station mac: %pM"

824 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
°a_mac
,

825 
__íåy
->
°a_Êags_mask
, __íåy->
°a_Êags_£t
,

826 
__íåy
->
°a_modify_mask
, __íåy->
li°í_öãrvÆ
,

827 
__íåy
->
aid
, __íåy->
∂ök_a˘i⁄
, __íåy->
∂ök_°©e
,

828 
__íåy
->
u≠sd_queues
, __íåy->
vœn
)

831 
	`DEFINE_EVENT
(
°©i⁄_add_ch™ge
, 
rdev_add_°©i⁄
,

832 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u8
 *
mac
,

833 
°©i⁄_∑ømëîs
 *
∑øms
),

834 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
mac
, 
∑øms
)

837 
	`DEFINE_EVENT
(
°©i⁄_add_ch™ge
, 
rdev_ch™ge_°©i⁄
,

838 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u8
 *
mac
,

839 
°©i⁄_∑ømëîs
 *
∑øms
),

840 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
mac
, 
∑øms
)

843 
	`DECLARE_EVENT_CLASS
(
wùhy_√tdev_mac_evt
,

844 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
mac
),

845 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
mac
),

846 
	`TP_STRUCT__íåy
(

847 
WIPHY_ENTRY


848 
NETDEV_ENTRY


849 
	`MAC_ENTRY
(
°a_mac
)

851 
	`TP_Á°_assign
(

852 
WIPHY_ASSIGN
;

853 
NETDEV_ASSIGN
;

854 
	`MAC_ASSIGN
(
°a_mac
, 
mac
);

856 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", mac: %pM",

857 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
°a_mac
)

860 
	`DECLARE_EVENT_CLASS
(
°©i⁄_dñ
,

861 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

862 
°©i⁄_dñ_∑ømëîs
 *
∑øms
),

863 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
),

864 
	`TP_STRUCT__íåy
(

865 
WIPHY_ENTRY


866 
NETDEV_ENTRY


867 
	$MAC_ENTRY
(
°a_mac
)

868 
	$__fõld
(
u8
, 
subty≥
)

869 
	$__fõld
(
u16
, 
ªas⁄_code
)

870 
	`__fõld
(, 
lök_id
)

872 
	`TP_Á°_assign
(

873 
WIPHY_ASSIGN
;

874 
NETDEV_ASSIGN
;

875 
	`MAC_ASSIGN
(
°a_mac
, 
∑øms
->
mac
);

876 
__íåy
->
subty≥
 = 
∑øms
->subtype;

877 
__íåy
->
ªas⁄_code
 = 
∑øms
->reason_code;

878 
__íåy
->
lök_id
 = 
∑øms
->link_id;

880 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", station mac: %pM"

882 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
°a_mac
,

883 
__íåy
->
subty≥
, __íåy->
ªas⁄_code
,

884 
__íåy
->
lök_id
)

887 
	`DEFINE_EVENT
(
°©i⁄_dñ
, 
rdev_dñ_°©i⁄
,

888 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

889 
°©i⁄_dñ_∑ømëîs
 *
∑øms
),

890 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
)

893 
	`DEFINE_EVENT
(
wùhy_√tdev_mac_evt
, 
rdev_gë_°©i⁄
,

894 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
mac
),

895 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
mac
)

898 
	`DEFINE_EVENT
(
wùhy_√tdev_mac_evt
, 
rdev_dñ_m∑th
,

899 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
mac
),

900 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
mac
)

903 
	`TRACE_EVENT
(
rdev_dump_°©i⁄
,

904 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
_idx
,

905 
u8
 *
mac
),

906 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
_idx
, 
mac
),

907 
	`TP_STRUCT__íåy
(

908 
WIPHY_ENTRY


909 
NETDEV_ENTRY


910 
	$MAC_ENTRY
(
°a_mac
)

911 
	`__fõld
(, 
idx
)

913 
	`TP_Á°_assign
(

914 
WIPHY_ASSIGN
;

915 
NETDEV_ASSIGN
;

916 
	`MAC_ASSIGN
(
°a_mac
, 
mac
);

917 
__íåy
->
idx
 = 
_idx
;

919 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", station mac: %pM, idx: %d",

920 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
°a_mac
,

921 
__íåy
->
idx
)

924 
	`TRACE_EVENT
(
rdev_ªtu∫_öt_°©i⁄_öfo
,

925 
	`TP_PROTO
(
wùhy
 *wùhy, 
ªt
, 
°©i⁄_öfo
 *
söfo
),

926 
	`TP_ARGS
(
wùhy
, 
ªt
, 
söfo
),

927 
	`TP_STRUCT__íåy
(

928 
WIPHY_ENTRY


929 
	$__fõld
(, 
ªt
)

930 
SINFO_ENTRY


932 
	`TP_Á°_assign
(

933 
WIPHY_ASSIGN
;

934 
__íåy
->
ªt
 =Ñet;

935 
SINFO_ASSIGN
;

937 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ",Ñeturned %d" ,

938 
WIPHY_PR_ARG
, 
__íåy
->
ªt
)

941 
	`DECLARE_EVENT_CLASS
(
m∑th_evt
,

942 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u8
 *
d°
,

943 
u8
 *
√xt_h›
),

944 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
d°
, 
√xt_h›
),

945 
	`TP_STRUCT__íåy
(

946 
WIPHY_ENTRY


947 
NETDEV_ENTRY


948 
	$MAC_ENTRY
(
d°
)

949 
	`MAC_ENTRY
(
√xt_h›
)

951 
	`TP_Á°_assign
(

952 
WIPHY_ASSIGN
;

953 
NETDEV_ASSIGN
;

954 
	`MAC_ASSIGN
(
d°
, dst);

955 
	`MAC_ASSIGN
(
√xt_h›
,Çext_hop);

957 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", destination: %pM,Çext hop: %pM",

958 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
d°
,

959 
__íåy
->
√xt_h›
)

962 
	`DEFINE_EVENT
(
m∑th_evt
, 
rdev_add_m∑th
,

963 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u8
 *
d°
,

964 
u8
 *
√xt_h›
),

965 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
d°
, 
√xt_h›
)

968 
	`DEFINE_EVENT
(
m∑th_evt
, 
rdev_ch™ge_m∑th
,

969 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u8
 *
d°
,

970 
u8
 *
√xt_h›
),

971 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
d°
, 
√xt_h›
)

974 
	`DEFINE_EVENT
(
m∑th_evt
, 
rdev_gë_m∑th
,

975 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u8
 *
d°
,

976 
u8
 *
√xt_h›
),

977 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
d°
, 
√xt_h›
)

980 
	`TRACE_EVENT
(
rdev_dump_m∑th
,

981 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
_idx
,

982 
u8
 *
d°
, u8 *
√xt_h›
),

983 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
_idx
, 
d°
, 
√xt_h›
),

984 
	`TP_STRUCT__íåy
(

985 
WIPHY_ENTRY


986 
NETDEV_ENTRY


987 
	$MAC_ENTRY
(
d°
)

988 
	$MAC_ENTRY
(
√xt_h›
)

989 
	`__fõld
(, 
idx
)

991 
	`TP_Á°_assign
(

992 
WIPHY_ASSIGN
;

993 
NETDEV_ASSIGN
;

994 
	`MAC_ASSIGN
(
d°
, dst);

995 
	`MAC_ASSIGN
(
√xt_h›
,Çext_hop);

996 
__íåy
->
idx
 = 
_idx
;

998 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", index: %d, destination: %pM,Çext hop: %pM",

999 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
idx
, __íåy->
d°
,

1000 
__íåy
->
√xt_h›
)

1003 
	`TRACE_EVENT
(
rdev_gë_mµ
,

1004 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1005 
u8
 *
d°
, u8 *
mµ
),

1006 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
d°
, 
mµ
),

1007 
	`TP_STRUCT__íåy
(

1008 
WIPHY_ENTRY


1009 
NETDEV_ENTRY


1010 
	$MAC_ENTRY
(
d°
)

1011 
	`MAC_ENTRY
(
mµ
)

1013 
	`TP_Á°_assign
(

1014 
WIPHY_ASSIGN
;

1015 
NETDEV_ASSIGN
;

1016 
	`MAC_ASSIGN
(
d°
, dst);

1017 
	`MAC_ASSIGN
(
mµ
, mpp);

1019 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", destination: %pM"

1020 ", mµ: %pM", 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
,

1021 
__íåy
->
d°
, __íåy->
mµ
)

1024 
	`TRACE_EVENT
(
rdev_dump_mµ
,

1025 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
_idx
,

1026 
u8
 *
d°
, u8 *
mµ
),

1027 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
_idx
, 
d°
, 
mµ
),

1028 
	`TP_STRUCT__íåy
(

1029 
WIPHY_ENTRY


1030 
NETDEV_ENTRY


1031 
	$MAC_ENTRY
(
d°
)

1032 
	$MAC_ENTRY
(
mµ
)

1033 
	`__fõld
(, 
idx
)

1035 
	`TP_Á°_assign
(

1036 
WIPHY_ASSIGN
;

1037 
NETDEV_ASSIGN
;

1038 
	`MAC_ASSIGN
(
d°
, dst);

1039 
	`MAC_ASSIGN
(
mµ
, mpp);

1040 
__íåy
->
idx
 = 
_idx
;

1042 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", index: %d, destination: %pM, mpp: %pM",

1043 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
idx
, __íåy->
d°
,

1044 
__íåy
->
mµ
)

1047 
	`TRACE_EVENT
(
rdev_ªtu∫_öt_m∑th_öfo
,

1048 
	`TP_PROTO
(
wùhy
 *wùhy, 
ªt
, 
m∑th_öfo
 *
pöfo
),

1049 
	`TP_ARGS
(
wùhy
, 
ªt
, 
pöfo
),

1050 
	`TP_STRUCT__íåy
(

1051 
WIPHY_ENTRY


1052 
	$__fõld
(, 
ªt
)

1053 
	$__fõld
(, 
gíî©i⁄
)

1054 
	$__fõld
(
u32
, 
fûÀd
)

1055 
	$__fõld
(
u32
, 
‰ame_qÀn
)

1056 
	$__fõld
(
u32
, 
¢
)

1057 
	$__fõld
(
u32
, 
mëric
)

1058 
	$__fõld
(
u32
, 
ex±ime
)

1059 
	$__fõld
(
u32
, 
discovîy_timeout
)

1060 
	$__fõld
(
u8
, 
discovîy_ªåõs
)

1061 
	`__fõld
(
u8
, 
Êags
)

1063 
	`TP_Á°_assign
(

1064 
WIPHY_ASSIGN
;

1065 
__íåy
->
ªt
 =Ñet;

1066 
__íåy
->
gíî©i⁄
 = 
pöfo
->generation;

1067 
__íåy
->
fûÀd
 = 
pöfo
->filled;

1068 
__íåy
->
‰ame_qÀn
 = 
pöfo
->frame_qlen;

1069 
__íåy
->
¢
 = 
pöfo
->sn;

1070 
__íåy
->
mëric
 = 
pöfo
->metric;

1071 
__íåy
->
ex±ime
 = 
pöfo
->exptime;

1072 
__íåy
->
discovîy_timeout
 = 
pöfo
->discovery_timeout;

1073 
__íåy
->
discovîy_ªåõs
 = 
pöfo
->discovery_retries;

1074 
__íåy
->
Êags
 = 
pöfo
->flags;

1076 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ",Ñeturned %d. mpath info - generation: %d, "

1079 
WIPHY_PR_ARG
, 
__íåy
->
ªt
, __íåy->
gíî©i⁄
,

1080 
__íåy
->
fûÀd
, __íåy->
‰ame_qÀn
, __íåy->
¢
,

1081 
__íåy
->
mëric
, __íåy->
ex±ime
, __íåy->
discovîy_timeout
,

1082 
__íåy
->
discovîy_ªåõs
, __íåy->
Êags
)

1085 
	`TRACE_EVENT
(
rdev_ªtu∫_öt_mesh_c⁄fig
,

1086 
	`TP_PROTO
(
wùhy
 *wùhy, 
ªt
, 
mesh_c⁄fig
 *
c⁄f
),

1087 
	`TP_ARGS
(
wùhy
, 
ªt
, 
c⁄f
),

1088 
	`TP_STRUCT__íåy
(

1089 
WIPHY_ENTRY


1090 
MESH_CFG_ENTRY


1091 
	`__fõld
(, 
ªt
)

1093 
	`TP_Á°_assign
(

1094 
WIPHY_ASSIGN
;

1095 
MESH_CFG_ASSIGN
;

1096 
__íåy
->
ªt
 =Ñet;

1098 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ",Ñeturned: %d",

1099 
WIPHY_PR_ARG
, 
__íåy
->
ªt
)

1102 
	`TRACE_EVENT
(
rdev_upd©e_mesh_c⁄fig
,

1103 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u32
 
mask
,

1104 c⁄° 
mesh_c⁄fig
 *
c⁄f
),

1105 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
mask
, 
c⁄f
),

1106 
	`TP_STRUCT__íåy
(

1107 
WIPHY_ENTRY


1108 
NETDEV_ENTRY


1109 
MESH_CFG_ENTRY


1110 
	`__fõld
(
u32
, 
mask
)

1112 
	`TP_Á°_assign
(

1113 
WIPHY_ASSIGN
;

1114 
NETDEV_ASSIGN
;

1115 
MESH_CFG_ASSIGN
;

1116 
__íåy
->
mask
 = mask;

1118 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", mask: %u",

1119 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
mask
)

1122 
	`TRACE_EVENT
(
rdev_joö_mesh
,

1123 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1124 c⁄° 
mesh_c⁄fig
 *
c⁄f
,

1125 c⁄° 
mesh_£tup
 *
£tup
),

1126 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
c⁄f
, 
£tup
),

1127 
	`TP_STRUCT__íåy
(

1128 
WIPHY_ENTRY


1129 
NETDEV_ENTRY


1130 
MESH_CFG_ENTRY


1132 
	`TP_Á°_assign
(

1133 
WIPHY_ASSIGN
;

1134 
NETDEV_ASSIGN
;

1135 
MESH_CFG_ASSIGN
;

1137 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
,

1138 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
)

1141 
	`TRACE_EVENT
(
rdev_ch™ge_bss
,

1142 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1143 
bss_∑ømëîs
 *
∑øms
),

1144 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
),

1145 
	`TP_STRUCT__íåy
(

1146 
WIPHY_ENTRY


1147 
NETDEV_ENTRY


1148 
	$__fõld
(, 
u£_˘s_¥Ÿ
)

1149 
	$__fõld
(, 
u£_sh‹t_¥ómbÀ
)

1150 
	$__fõld
(, 
u£_sh‹t_¶Ÿ_time
)

1151 
	$__fõld
(, 
≠_isﬁ©e
)

1152 
	`__fõld
(, 
ht_›mode
)

1154 
	`TP_Á°_assign
(

1155 
WIPHY_ASSIGN
;

1156 
NETDEV_ASSIGN
;

1157 
__íåy
->
u£_˘s_¥Ÿ
 = 
∑øms
->use_cts_prot;

1158 
__íåy
->
u£_sh‹t_¥ómbÀ
 = 
∑øms
->use_short_preamble;

1159 
__íåy
->
u£_sh‹t_¶Ÿ_time
 = 
∑øms
->use_short_slot_time;

1160 
__íåy
->
≠_isﬁ©e
 = 
∑øms
->ap_isolate;

1161 
__íåy
->
ht_›mode
 = 
∑øms
->ht_opmode;

1163 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", use ctsÖrot: %d, "

1166 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
u£_˘s_¥Ÿ
,

1167 
__íåy
->
u£_sh‹t_¥ómbÀ
, __íåy->
u£_sh‹t_¶Ÿ_time
,

1168 
__íåy
->
≠_isﬁ©e
, __íåy->
ht_›mode
)

1171 
	`TRACE_EVENT
(
rdev_öf‹m_bss
,

1172 
	`TP_PROTO
(
wùhy
 *wùhy, 
cfg80211_bss
 *
bss
),

1173 
	`TP_ARGS
(
wùhy
, 
bss
),

1174 
	`TP_STRUCT__íåy
(

1175 
WIPHY_ENTRY


1176 
	$MAC_ENTRY
(
bssid
)

1177 
CHAN_ENTRY


1179 
	`TP_Á°_assign
(

1180 
WIPHY_ASSIGN
;

1181 
	`MAC_ASSIGN
(
bssid
, 
bss
->bssid);

1182 
	`CHAN_ASSIGN
(
bss
->
ch™√l
);

1184 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", %pM, " 
CHAN_PR_FMT
,

1185 
WIPHY_PR_ARG
, 
__íåy
->
bssid
, 
CHAN_PR_ARG
)

1188 
	`TRACE_EVENT
(
rdev_£t_txq_∑øms
,

1189 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1190 
õì80211_txq_∑øms
 *
∑øms
),

1191 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
),

1192 
	`TP_STRUCT__íåy
(

1193 
WIPHY_ENTRY


1194 
NETDEV_ENTRY


1195 
	$__fõld
(
∆80211_ac
, 
ac
)

1196 
	$__fõld
(
u16
, 
tx›
)

1197 
	$__fõld
(
u16
, 
cwmö
)

1198 
	$__fõld
(
u16
, 
cwmax
)

1199 
	`__fõld
(
u8
, 
aifs
)

1201 
	`TP_Á°_assign
(

1202 
WIPHY_ASSIGN
;

1203 
NETDEV_ASSIGN
;

1204 
__íåy
->
ac
 = 
∑øms
->ac;

1205 
__íåy
->
tx›
 = 
∑øms
->txop;

1206 
__íåy
->
cwmö
 = 
∑øms
->cwmin;

1207 
__íåy
->
cwmax
 = 
∑øms
->cwmax;

1208 
__íåy
->
aifs
 = 
∑øms
->aifs;

1210 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",ác: %d,Åxop: %u, cwmin: %u, cwmax: %u,áifs: %u",

1211 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
ac
, __íåy->
tx›
,

1212 
__íåy
->
cwmö
, __íåy->
cwmax
, __íåy->
aifs
)

1215 
	`TRACE_EVENT
(
rdev_libîès_£t_mesh_ch™√l
,

1216 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1217 
õì80211_ch™√l
 *
ch™
),

1218 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
ch™
),

1219 
	`TP_STRUCT__íåy
(

1220 
WIPHY_ENTRY


1221 
NETDEV_ENTRY


1222 
CHAN_ENTRY


1224 
	`TP_Á°_assign
(

1225 
WIPHY_ASSIGN
;

1226 
NETDEV_ASSIGN
;

1227 
	`CHAN_ASSIGN
(
ch™
);

1229 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", " 
CHAN_PR_FMT
, 
WIPHY_PR_ARG
,

1230 
NETDEV_PR_ARG
, 
CHAN_PR_ARG
)

1233 
	`TRACE_EVENT
(
rdev_£t_m⁄ô‹_ch™√l
,

1234 
	`TP_PROTO
(
wùhy
 *wiphy,

1235 
cfg80211_ch™_def
 *
ch™def
),

1236 
	`TP_ARGS
(
wùhy
, 
ch™def
),

1237 
	`TP_STRUCT__íåy
(

1238 
WIPHY_ENTRY


1239 
CHAN_DEF_ENTRY


1241 
	`TP_Á°_assign
(

1242 
WIPHY_ASSIGN
;

1243 
	`CHAN_DEF_ASSIGN
(
ch™def
);

1245 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
CHAN_DEF_PR_FMT
,

1246 
WIPHY_PR_ARG
, 
CHAN_DEF_PR_ARG
)

1249 
	`TRACE_EVENT
(
rdev_auth
,

1250 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1251 
cfg80211_auth_ªque°
 *
ªq
),

1252 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
ªq
),

1253 
	`TP_STRUCT__íåy
(

1254 
WIPHY_ENTRY


1255 
NETDEV_ENTRY


1256 
	$MAC_ENTRY
(
bssid
)

1257 
	`__fõld
(
∆80211_auth_ty≥
, 
auth_ty≥
)

1259 
	`TP_Á°_assign
(

1260 
WIPHY_ASSIGN
;

1261 
NETDEV_ASSIGN
;

1262 i‡(
ªq
->
bss
)

1263 
	`MAC_ASSIGN
(
bssid
, 
ªq
->
bss
->bssid);

1265 
	`ëh_zîo_addr
(
__íåy
->
bssid
);

1266 
__íåy
->
auth_ty≥
 = 
ªq
->auth_type;

1268 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",áuthÅype: %d, bssid: %pM",

1269 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
auth_ty≥
,

1270 
__íåy
->
bssid
)

1273 
	`TRACE_EVENT
(
rdev_assoc
,

1274 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1275 
cfg80211_assoc_ªque°
 *
ªq
),

1276 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
ªq
),

1277 
	`TP_STRUCT__íåy
(

1278 
WIPHY_ENTRY


1279 
NETDEV_ENTRY


1280 
	$MAC_ENTRY
(
bssid
)

1281 
	$MAC_ENTRY
(
¥ev_bssid
)

1282 
	$__fõld
(
boﬁ
, 
u£_mÂ
)

1283 
	$__fõld
(
u32
, 
Êags
)

1284 
	`__dy«mic_¨øy
(
u8
, 
ñemíts
, 
ªq
->
õ_Àn
)

1285 
	`__¨øy
(
u8
, 
ht_ˇ∑
, (
õì80211_ht_ˇp
))

1286 
	`__¨øy
(
u8
, 
ht_ˇ∑_mask
, (
õì80211_ht_ˇp
))

1287 
	`__¨øy
(
u8
, 
vht_ˇ∑
, (
õì80211_vht_ˇp
))

1288 
	`__¨øy
(
u8
, 
vht_ˇ∑_mask
, (
õì80211_vht_ˇp
))

1289 
	`__dy«mic_¨øy
(
u8
, 
fûs_kek
, 
ªq
->
fûs_kek_Àn
)

1290 
	`__dy«mic_¨øy
(
u8
, 
fûs_n⁄˚s
,

1291 
ªq
->
fûs_n⁄˚s
 ? 2 * 
FILS_NONCE_LEN
 : 0)

1293 
	`TP_Á°_assign
(

1294 
WIPHY_ASSIGN
;

1295 
NETDEV_ASSIGN
;

1296 i‡(
ªq
->
bss
)

1297 
	`MAC_ASSIGN
(
bssid
, 
ªq
->
bss
->bssid);

1299 
	`ëh_zîo_addr
(
__íåy
->
bssid
);

1300 
	`MAC_ASSIGN
(
¥ev_bssid
, 
ªq
->prev_bssid);

1301 
__íåy
->
u£_mÂ
 = 
ªq
->use_mfp;

1302 
__íåy
->
Êags
 = 
ªq
->flags;

1303 i‡(
ªq
->
õ
)

1304 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
ñemíts
),

1305 
ªq
->
õ
,Ñeq->
õ_Àn
);

1306 
	`mem˝y
(
__íåy
->
ht_ˇ∑
, &
ªq
->ht_capa, (req->ht_capa));

1307 
	`mem˝y
(
__íåy
->
ht_ˇ∑_mask
, &
ªq
->ht_capa_mask,

1308 (
ªq
->
ht_ˇ∑_mask
));

1309 
	`mem˝y
(
__íåy
->
vht_ˇ∑
, &
ªq
->vht_capa, (req->vht_capa));

1310 
	`mem˝y
(
__íåy
->
vht_ˇ∑_mask
, &
ªq
->vht_capa_mask,

1311 (
ªq
->
vht_ˇ∑_mask
));

1312 i‡(
ªq
->
fûs_kek
)

1313 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
fûs_kek
),

1314 
ªq
->
fûs_kek
,Ñeq->
fûs_kek_Àn
);

1315 i‡(
ªq
->
fûs_n⁄˚s
)

1316 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
fûs_n⁄˚s
),

1317 
ªq
->
fûs_n⁄˚s
, 2 * 
FILS_NONCE_LEN
);

1319 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", bssid: %pM"

1321 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
bssid
,

1322 
__íåy
->
¥ev_bssid
, 
	`BOOL_TO_STR
(__íåy->
u£_mÂ
),

1323 
__íåy
->
Êags
)

1326 
	`TRACE_EVENT
(
rdev_dóuth
,

1327 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1328 
cfg80211_dóuth_ªque°
 *
ªq
),

1329 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
ªq
),

1330 
	`TP_STRUCT__íåy
(

1331 
WIPHY_ENTRY


1332 
NETDEV_ENTRY


1333 
	$MAC_ENTRY
(
bssid
)

1334 
	$__fõld
(
u16
, 
ªas⁄_code
)

1335 
	`__fõld
(
boﬁ
, 
loˇl_°©e_ch™ge
)

1337 
	`TP_Á°_assign
(

1338 
WIPHY_ASSIGN
;

1339 
NETDEV_ASSIGN
;

1340 
	`MAC_ASSIGN
(
bssid
, 
ªq
->bssid);

1341 
__íåy
->
ªas⁄_code
 = 
ªq
->reason_code;

1342 
__íåy
->
loˇl_°©e_ch™ge
 = 
ªq
->local_state_change;

1344 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", bssid: %pM,Ñeason: %u,Üocal_state_change:%d",

1345 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
bssid
,

1346 
__íåy
->
ªas⁄_code
, __íåy->
loˇl_°©e_ch™ge
)

1349 
	`TRACE_EVENT
(
rdev_dißssoc
,

1350 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1351 
cfg80211_dißssoc_ªque°
 *
ªq
),

1352 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
ªq
),

1353 
	`TP_STRUCT__íåy
(

1354 
WIPHY_ENTRY


1355 
NETDEV_ENTRY


1356 
	$MAC_ENTRY
(
bssid
)

1357 
	$__fõld
(
u16
, 
ªas⁄_code
)

1358 
	`__fõld
(
boﬁ
, 
loˇl_°©e_ch™ge
)

1360 
	`TP_Á°_assign
(

1361 
WIPHY_ASSIGN
;

1362 
NETDEV_ASSIGN
;

1363 
	`MAC_ASSIGN
(
bssid
, 
ªq
->
≠_addr
);

1364 
__íåy
->
ªas⁄_code
 = 
ªq
->reason_code;

1365 
__íåy
->
loˇl_°©e_ch™ge
 = 
ªq
->local_state_change;

1367 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", bssid: %pM"

1369 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
bssid
,

1370 
__íåy
->
ªas⁄_code
,

1371 
	`BOOL_TO_STR
(
__íåy
->
loˇl_°©e_ch™ge
))

1374 
	`TRACE_EVENT
(
rdev_mgmt_tx_ˇn˚l_waô
,

1375 
	`TP_PROTO
(
wùhy
 *wiphy,

1376 
wúñess_dev
 *
wdev
, 
u64
 
cookõ
),

1377 
	`TP_ARGS
(
wùhy
, 
wdev
, 
cookõ
),

1378 
	`TP_STRUCT__íåy
(

1379 
WIPHY_ENTRY


1380 
WDEV_ENTRY


1381 
	`__fõld
(
u64
, 
cookõ
)

1383 
	`TP_Á°_assign
(

1384 
WIPHY_ASSIGN
;

1385 
WDEV_ASSIGN
;

1386 
__íåy
->
cookõ
 = cookie;

1388 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ", cookie: %llu ",

1389 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
, 
__íåy
->
cookõ
)

1392 
	`TRACE_EVENT
(
rdev_£t_powî_mgmt
,

1393 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1394 
boﬁ
 
íabÀd
, 
timeout
),

1395 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
íabÀd
, 
timeout
),

1396 
	`TP_STRUCT__íåy
(

1397 
WIPHY_ENTRY


1398 
NETDEV_ENTRY


1399 
	$__fõld
(
boﬁ
, 
íabÀd
)

1400 
	`__fõld
(, 
timeout
)

1402 
	`TP_Á°_assign
(

1403 
WIPHY_ASSIGN
;

1404 
NETDEV_ASSIGN
;

1405 
__íåy
->
íabÀd
 =Énabled;

1406 
__íåy
->
timeout
 =Åimeout;

1408 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %senabled,Åimeout: %d ",

1409 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
,

1410 
__íåy
->
íabÀd
 ? "" : "nŸ ", __íåy->
timeout
)

1413 
	`TRACE_EVENT
(
rdev_c⁄√˘
,

1414 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1415 
cfg80211_c⁄√˘_∑øms
 *
sme
),

1416 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
sme
),

1417 
	`TP_STRUCT__íåy
(

1418 
WIPHY_ENTRY


1419 
NETDEV_ENTRY


1420 
	$MAC_ENTRY
(
bssid
)

1421 
	`__¨øy
(, 
ssid
, 
IEEE80211_MAX_SSID_LEN
 + 1)

1422 
	$__fõld
(
∆80211_auth_ty≥
, 
auth_ty≥
)

1423 
	$__fõld
(
boﬁ
, 
¥ivacy
)

1424 
	$__fõld
(
u32
, 
w∑_vîsi⁄s
)

1425 
	$__fõld
(
u32
, 
Êags
)

1426 
	`MAC_ENTRY
(
¥ev_bssid
)

1428 
	`TP_Á°_assign
(

1429 
WIPHY_ASSIGN
;

1430 
NETDEV_ASSIGN
;

1431 
	`MAC_ASSIGN
(
bssid
, 
sme
->bssid);

1432 
	`mem£t
(
__íåy
->
ssid
, 0, 
IEEE80211_MAX_SSID_LEN
 + 1);

1433 
	`mem˝y
(
__íåy
->
ssid
, 
sme
->ssid, sme->
ssid_Àn
);

1434 
__íåy
->
auth_ty≥
 = 
sme
->auth_type;

1435 
__íåy
->
¥ivacy
 = 
sme
->privacy;

1436 
__íåy
->
w∑_vîsi⁄s
 = 
sme
->
¸y±o
.wpa_versions;

1437 
__íåy
->
Êags
 = 
sme
->flags;

1438 
	`MAC_ASSIGN
(
¥ev_bssid
, 
sme
->prev_bssid);

1440 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", bssid: %pM"

1443 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
bssid
, __íåy->
ssid
,

1444 
__íåy
->
auth_ty≥
, 
	`BOOL_TO_STR
(__íåy->
¥ivacy
),

1445 
__íåy
->
w∑_vîsi⁄s
, __íåy->
Êags
, __íåy->
¥ev_bssid
)

1448 
	`TRACE_EVENT
(
rdev_upd©e_c⁄√˘_∑øms
,

1449 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1450 
cfg80211_c⁄√˘_∑øms
 *
sme
, 
u32
 
ch™ged
),

1451 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
sme
, 
ch™ged
),

1452 
	`TP_STRUCT__íåy
(

1453 
WIPHY_ENTRY


1454 
NETDEV_ENTRY


1455 
	`__fõld
(
u32
, 
ch™ged
)

1457 
	`TP_Á°_assign
(

1458 
WIPHY_ASSIGN
;

1459 
NETDEV_ASSIGN
;

1460 
__íåy
->
ch™ged
 = changed;

1462 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Öarameters changed: %u",

1463 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
ch™ged
)

1466 
	`TRACE_EVENT
(
rdev_£t_cqm_rssi_c⁄fig
,

1467 
	`TP_PROTO
(
wùhy
 *wiphy,

1468 
√t_devi˚
 *
√tdev
, 
s32
 
rssi_thﬁd
,

1469 
u32
 
rssi_hy°
),

1470 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
rssi_thﬁd
, 
rssi_hy°
),

1471 
	`TP_STRUCT__íåy
(

1472 
WIPHY_ENTRY


1473 
NETDEV_ENTRY


1474 
	$__fõld
(
s32
, 
rssi_thﬁd
)

1475 
	`__fõld
(
u32
, 
rssi_hy°
)

1477 
	`TP_Á°_assign
(

1478 
WIPHY_ASSIGN
;

1479 
NETDEV_ASSIGN
;

1480 
__íåy
->
rssi_thﬁd
 =Ñssi_thold;

1481 
__íåy
->
rssi_hy°
 =Ñssi_hyst;

1483 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT


1485 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
,

1486 
__íåy
->
rssi_thﬁd
, __íåy->
rssi_hy°
)

1489 
	`TRACE_EVENT
(
rdev_£t_cqm_rssi_ønge_c⁄fig
,

1490 
	`TP_PROTO
(
wùhy
 *wiphy,

1491 
√t_devi˚
 *
√tdev
, 
s32
 
low
, s32 
high
),

1492 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
low
, 
high
),

1493 
	`TP_STRUCT__íåy
(

1494 
WIPHY_ENTRY


1495 
NETDEV_ENTRY


1496 
	$__fõld
(
s32
, 
rssi_low
)

1497 
	`__fõld
(
s32
, 
rssi_high
)

1499 
	`TP_Á°_assign
(

1500 
WIPHY_ASSIGN
;

1501 
NETDEV_ASSIGN
;

1502 
__íåy
->
rssi_low
 = 
low
;

1503 
__íåy
->
rssi_high
 = 
high
;

1505 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT


1507 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
,

1508 
__íåy
->
rssi_low
, __íåy->
rssi_high
)

1511 
	`TRACE_EVENT
(
rdev_£t_cqm_txe_c⁄fig
,

1512 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u32
 
øã
,

1513 
u32
 
pkts
, u32 
ötvl
),

1514 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
øã
, 
pkts
, 
ötvl
),

1515 
	`TP_STRUCT__íåy
(

1516 
WIPHY_ENTRY


1517 
NETDEV_ENTRY


1518 
	$__fõld
(
u32
, 
øã
)

1519 
	$__fõld
(
u32
, 
pkts
)

1520 
	`__fõld
(
u32
, 
ötvl
)

1522 
	`TP_Á°_assign
(

1523 
WIPHY_ASSIGN
;

1524 
NETDEV_ASSIGN
;

1525 
__íåy
->
øã
 =Ñate;

1526 
__íåy
->
pkts
 =Ökts;

1527 
__íåy
->
ötvl
 = intvl;

1529 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Ñate: %u,Öackets: %u, interval: %u",

1530 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
øã
, __íåy->
pkts
,

1531 
__íåy
->
ötvl
)

1534 
	`TRACE_EVENT
(
rdev_disc⁄√˘
,

1535 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1536 
u16
 
ªas⁄_code
),

1537 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
ªas⁄_code
),

1538 
	`TP_STRUCT__íåy
(

1539 
WIPHY_ENTRY


1540 
NETDEV_ENTRY


1541 
	`__fõld
(
u16
, 
ªas⁄_code
)

1543 
	`TP_Á°_assign
(

1544 
WIPHY_ASSIGN
;

1545 
NETDEV_ASSIGN
;

1546 
__íåy
->
ªas⁄_code
 =Ñeason_code;

1548 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Ñós⁄ code: %u", 
WIPHY_PR_ARG
,

1549 
NETDEV_PR_ARG
, 
__íåy
->
ªas⁄_code
)

1552 
	`TRACE_EVENT
(
rdev_joö_ibss
,

1553 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1554 
cfg80211_ibss_∑øms
 *
∑øms
),

1555 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
),

1556 
	`TP_STRUCT__íåy
(

1557 
WIPHY_ENTRY


1558 
NETDEV_ENTRY


1559 
	$MAC_ENTRY
(
bssid
)

1560 
	`__¨øy
(, 
ssid
, 
IEEE80211_MAX_SSID_LEN
 + 1)

1562 
	`TP_Á°_assign
(

1563 
WIPHY_ASSIGN
;

1564 
NETDEV_ASSIGN
;

1565 
	`MAC_ASSIGN
(
bssid
, 
∑øms
->bssid);

1566 
	`mem£t
(
__íåy
->
ssid
, 0, 
IEEE80211_MAX_SSID_LEN
 + 1);

1567 
	`mem˝y
(
__íåy
->
ssid
, 
∑øms
->ssid,Ö¨ams->
ssid_Àn
);

1569 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", bssid: %pM, ssid: %s",

1570 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
bssid
, __íåy->
ssid
)

1573 
	`TRACE_EVENT
(
rdev_joö_ocb
,

1574 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1575 c⁄° 
ocb_£tup
 *
£tup
),

1576 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
£tup
),

1577 
	`TP_STRUCT__íåy
(

1578 
WIPHY_ENTRY


1579 
NETDEV_ENTRY


1581 
	`TP_Á°_assign
(

1582 
WIPHY_ASSIGN
;

1583 
NETDEV_ASSIGN
;

1585 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
,

1586 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
)

1589 
	`TRACE_EVENT
(
rdev_£t_wùhy_∑øms
,

1590 
	`TP_PROTO
(
wùhy
 *wùhy, 
u32
 
ch™ged
),

1591 
	`TP_ARGS
(
wùhy
, 
ch™ged
),

1592 
	`TP_STRUCT__íåy
(

1593 
WIPHY_ENTRY


1594 
	`__fõld
(
u32
, 
ch™ged
)

1596 
	`TP_Á°_assign
(

1597 
WIPHY_ASSIGN
;

1598 
__íåy
->
ch™ged
 = changed;

1600 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", changed: %u",

1601 
WIPHY_PR_ARG
, 
__íåy
->
ch™ged
)

1604 
	`DEFINE_EVENT
(
wùhy_wdev_evt
, 
rdev_gë_tx_powî
,

1605 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

1606 
	`TP_ARGS
(
wùhy
, 
wdev
)

1609 
	`TRACE_EVENT
(
rdev_£t_tx_powî
,

1610 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

1611 
∆80211_tx_powî_£âög
 
ty≥
, 
mbm
),

1612 
	`TP_ARGS
(
wùhy
, 
wdev
, 
ty≥
, 
mbm
),

1613 
	`TP_STRUCT__íåy
(

1614 
WIPHY_ENTRY


1615 
WDEV_ENTRY


1616 
	$__fõld
(
∆80211_tx_powî_£âög
, 
ty≥
)

1617 
	`__fõld
(, 
mbm
)

1619 
	`TP_Á°_assign
(

1620 
WIPHY_ASSIGN
;

1621 
WDEV_ASSIGN
;

1622 
__íåy
->
ty≥
 =Åype;

1623 
__íåy
->
mbm
 = mbm;

1625 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ",Åype: %u, mbm: %d",

1626 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
,
__íåy
->
ty≥
, __íåy->
mbm
)

1629 
	`TRACE_EVENT
(
rdev_ªtu∫_öt_öt
,

1630 
	`TP_PROTO
(
wùhy
 *wùhy, 
func_ªt
, 
func_fûl
),

1631 
	`TP_ARGS
(
wùhy
, 
func_ªt
, 
func_fûl
),

1632 
	`TP_STRUCT__íåy
(

1633 
WIPHY_ENTRY


1634 
	$__fõld
(, 
func_ªt
)

1635 
	`__fõld
(, 
func_fûl
)

1637 
	`TP_Á°_assign
(

1638 
WIPHY_ASSIGN
;

1639 
__íåy
->
func_ªt
 = func_ret;

1640 
__íåy
->
func_fûl
 = func_fill;

1642 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", functionÑeturns: %d, function filled: %d",

1643 
WIPHY_PR_ARG
, 
__íåy
->
func_ªt
, __íåy->
func_fûl
)

1646 #ifde‡
CONFIG_NL80211_TESTMODE


1647 
	`TRACE_EVENT
(
rdev_ã°mode_cmd
,

1648 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

1649 
	`TP_ARGS
(
wùhy
, 
wdev
),

1650 
	`TP_STRUCT__íåy
(

1651 
WIPHY_ENTRY


1652 
WDEV_ENTRY


1654 
	`TP_Á°_assign
(

1655 
WIPHY_ASSIGN
;

1656 
WDEV_ASSIGN
;

1658 
	`TP_¥ötk
(
WIPHY_PR_FMT
 
WDEV_PR_FMT
, 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
)

1661 
	`TRACE_EVENT
(
rdev_ã°mode_dump
,

1662 
	`TP_PROTO
(
wùhy
 *wiphy),

1663 
	`TP_ARGS
(
wùhy
),

1664 
	`TP_STRUCT__íåy
(

1665 
WIPHY_ENTRY


1667 
	`TP_Á°_assign
(

1668 
WIPHY_ASSIGN
;

1670 
	`TP_¥ötk
(
WIPHY_PR_FMT
, 
WIPHY_PR_ARG
)

1674 
	`TRACE_EVENT
(
rdev_£t_bôøã_mask
,

1675 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1676 
lök_id
,

1677 c⁄° 
u8
 *
≥î
, c⁄° 
cfg80211_bôøã_mask
 *
mask
),

1678 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
lök_id
, 
≥î
, 
mask
),

1679 
	`TP_STRUCT__íåy
(

1680 
WIPHY_ENTRY


1681 
NETDEV_ENTRY


1682 
	$__fõld
(, 
lök_id
)

1683 
	`MAC_ENTRY
(
≥î
)

1685 
	`TP_Á°_assign
(

1686 
WIPHY_ASSIGN
;

1687 
NETDEV_ASSIGN
;

1688 
__íåy
->
lök_id
 =Üink_id;

1689 
	`MAC_ASSIGN
(
≥î
,Öeer);

1691 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Üink_id: %d,Öeer: %pM",

1692 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
lök_id
,

1693 
__íåy
->
≥î
)

1696 
	`TRACE_EVENT
(
rdev_upd©e_mgmt_‰ame_ªgi°øti⁄s
,

1697 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

1698 
mgmt_‰ame_ªgs
 *
upd
),

1699 
	`TP_ARGS
(
wùhy
, 
wdev
, 
upd
),

1700 
	`TP_STRUCT__íåy
(

1701 
WIPHY_ENTRY


1702 
WDEV_ENTRY


1703 
	$__fõld
(
u16
, 
globÆ_°y≥s
)

1704 
	`__fõld
(
u16
, 
öãrÁ˚_°y≥s
)

1706 
	`TP_Á°_assign
(

1707 
WIPHY_ASSIGN
;

1708 
WDEV_ASSIGN
;

1709 
__íåy
->
globÆ_°y≥s
 = 
upd
->global_stypes;

1710 
__íåy
->
öãrÁ˚_°y≥s
 = 
upd
->interface_stypes;

1712 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ", global: 0x%.2x, intf: 0x%.2x",

1713 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
,

1714 
__íåy
->
globÆ_°y≥s
, __íåy->
öãrÁ˚_°y≥s
)

1717 
	`TRACE_EVENT
(
rdev_ªtu∫_öt_tx_rx
,

1718 
	`TP_PROTO
(
wùhy
 *wùhy, 
ªt
, 
u32
 
tx
, u32 
rx
),

1719 
	`TP_ARGS
(
wùhy
, 
ªt
, 
tx
, 
rx
),

1720 
	`TP_STRUCT__íåy
(

1721 
WIPHY_ENTRY


1722 
	$__fõld
(, 
ªt
)

1723 
	$__fõld
(
u32
, 
tx
)

1724 
	`__fõld
(
u32
, 
rx
)

1726 
	`TP_Á°_assign
(

1727 
WIPHY_ASSIGN
;

1728 
__íåy
->
ªt
 =Ñet;

1729 
__íåy
->
tx
 =Åx;

1730 
__íåy
->
rx
 =Ñx;

1732 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ",Ñeturned %d,Åx: %u,Ñx: %u",

1733 
WIPHY_PR_ARG
, 
__íåy
->
ªt
, __íåy->
tx
, __íåy->
rx
)

1736 
	`TRACE_EVENT
(
rdev_ªtu∫_void_tx_rx
,

1737 
	`TP_PROTO
(
wùhy
 *wùhy, 
u32
 
tx
, u32 
tx_max
,

1738 
u32
 
rx
, u32 
rx_max
),

1739 
	`TP_ARGS
(
wùhy
, 
tx
, 
tx_max
, 
rx
, 
rx_max
),

1740 
	`TP_STRUCT__íåy
(

1741 
WIPHY_ENTRY


1742 
	$__fõld
(
u32
, 
tx
)

1743 
	$__fõld
(
u32
, 
tx_max
)

1744 
	$__fõld
(
u32
, 
rx
)

1745 
	`__fõld
(
u32
, 
rx_max
)

1747 
	`TP_Á°_assign
(

1748 
WIPHY_ASSIGN
;

1749 
__íåy
->
tx
 =Åx;

1750 
__íåy
->
tx_max
 =Åx_max;

1751 
__íåy
->
rx
 =Ñx;

1752 
__íåy
->
rx_max
 =Ñx_max;

1754 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ",Åx: %u,Åx_max: %u,Ñx: %u,Ñx_max: %u ",

1755 
WIPHY_PR_ARG
, 
__íåy
->
tx
, __íåy->
tx_max
, __íåy->
rx
,

1756 
__íåy
->
rx_max
)

1759 
	`DECLARE_EVENT_CLASS
(
tx_rx_evt
,

1760 
	`TP_PROTO
(
wùhy
 *wùhy, 
u32
 
tx
, u32 
rx
),

1761 
	`TP_ARGS
(
wùhy
, 
tx
, 
rx
),

1762 
	`TP_STRUCT__íåy
(

1763 
WIPHY_ENTRY


1764 
	$__fõld
(
u32
, 
tx
)

1765 
	`__fõld
(
u32
, 
rx
)

1767 
	`TP_Á°_assign
(

1768 
WIPHY_ASSIGN
;

1769 
__íåy
->
tx
 =Åx;

1770 
__íåy
->
rx
 =Ñx;

1772 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ",Åx: %u,Ñx: %u ",

1773 
WIPHY_PR_ARG
, 
__íåy
->
tx
, __íåy->
rx
)

1776 
	`DEFINE_EVENT
(
tx_rx_evt
, 
rdev_£t_™ã¬a
,

1777 
	`TP_PROTO
(
wùhy
 *wùhy, 
u32
 
tx
, u32 
rx
),

1778 
	`TP_ARGS
(
wùhy
, 
tx
, 
rx
)

1781 
	`DECLARE_EVENT_CLASS
(
wùhy_√tdev_id_evt
,

1782 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u64
 
id
),

1783 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
id
),

1784 
	`TP_STRUCT__íåy
(

1785 
WIPHY_ENTRY


1786 
NETDEV_ENTRY


1787 
	`__fõld
(
u64
, 
id
)

1789 
	`TP_Á°_assign
(

1790 
WIPHY_ASSIGN
;

1791 
NETDEV_ASSIGN
;

1792 
__íåy
->
id
 = id;

1794 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", id: %llu",

1795 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
id
)

1798 
	`DEFINE_EVENT
(
wùhy_√tdev_id_evt
, 
rdev_sched_sˇn_°¨t
,

1799 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u64
 
id
),

1800 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
id
)

1803 
	`DEFINE_EVENT
(
wùhy_√tdev_id_evt
, 
rdev_sched_sˇn_°›
,

1804 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
u64
 
id
),

1805 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
id
)

1808 
	`TRACE_EVENT
(
rdev_tdls_mgmt
,

1809 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1810 
u8
 *
≥î
, 
lök_id
, u8 
a˘i⁄_code
, u8 
dülog_tokí
,

1811 
u16
 
°©us_code
, 
u32
 
≥î_ˇ∑bûôy
,

1812 
boﬁ
 
öôüt‹
, c⁄° 
u8
 *
buf
, 
size_t
 
Àn
),

1813 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
≥î
, 
lök_id
, 
a˘i⁄_code
, 
dülog_tokí
,

1814 
°©us_code
, 
≥î_ˇ∑bûôy
, 
öôüt‹
, 
buf
, 
Àn
),

1815 
	`TP_STRUCT__íåy
(

1816 
WIPHY_ENTRY


1817 
NETDEV_ENTRY


1818 
	$MAC_ENTRY
(
≥î
)

1819 
	$__fõld
(, 
lök_id
)

1820 
	$__fõld
(
u8
, 
a˘i⁄_code
)

1821 
	$__fõld
(
u8
, 
dülog_tokí
)

1822 
	$__fõld
(
u16
, 
°©us_code
)

1823 
	$__fõld
(
u32
, 
≥î_ˇ∑bûôy
)

1824 
	$__fõld
(
boﬁ
, 
öôüt‹
)

1825 
	`__dy«mic_¨øy
(
u8
, 
buf
, 
Àn
)

1827 
	`TP_Á°_assign
(

1828 
WIPHY_ASSIGN
;

1829 
NETDEV_ASSIGN
;

1830 
	`MAC_ASSIGN
(
≥î
,Öeer);

1831 
__íåy
->
lök_id
 =Üink_id;

1832 
__íåy
->
a˘i⁄_code
 =áction_code;

1833 
__íåy
->
dülog_tokí
 = dialog_token;

1834 
__íåy
->
°©us_code
 = status_code;

1835 
__íåy
->
≥î_ˇ∑bûôy
 =Öeer_capability;

1836 
__íåy
->
öôüt‹
 = initiator;

1837 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
buf
), buf, 
Àn
);

1839 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %pM"

1843 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
≥î
,

1844 
__íåy
->
lök_id
, __íåy->
a˘i⁄_code
, __íåy->
dülog_tokí
,

1845 
__íåy
->
°©us_code
, __íåy->
≥î_ˇ∑bûôy
,

1846 
	`BOOL_TO_STR
(
__íåy
->
öôüt‹
),

1847 ((
u8
 *)
	`__gë_dy«mic_¨øy
(
buf
))[0])

1850 
	`TRACE_EVENT
(
rdev_dump_survey
,

1851 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, 
_idx
),

1852 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
_idx
),

1853 
	`TP_STRUCT__íåy
(

1854 
WIPHY_ENTRY


1855 
NETDEV_ENTRY


1856 
	`__fõld
(, 
idx
)

1858 
	`TP_Á°_assign
(

1859 
WIPHY_ASSIGN
;

1860 
NETDEV_ASSIGN
;

1861 
__íåy
->
idx
 = 
_idx
;

1863 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", index: %d",

1864 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
idx
)

1867 
	`TRACE_EVENT
(
rdev_ªtu∫_öt_survey_öfo
,

1868 
	`TP_PROTO
(
wùhy
 *wùhy, 
ªt
, 
survey_öfo
 *
öfo
),

1869 
	`TP_ARGS
(
wùhy
, 
ªt
, 
öfo
),

1870 
	`TP_STRUCT__íåy
(

1871 
WIPHY_ENTRY


1872 
CHAN_ENTRY


1873 
	$__fõld
(, 
ªt
)

1874 
	$__fõld
(
u64
, 
time
)

1875 
	$__fõld
(
u64
, 
time_busy
)

1876 
	$__fõld
(
u64
, 
time_ext_busy
)

1877 
	$__fõld
(
u64
, 
time_rx
)

1878 
	$__fõld
(
u64
, 
time_tx
)

1879 
	$__fõld
(
u64
, 
time_sˇn
)

1880 
	$__fõld
(
u32
, 
fûÀd
)

1881 
	`__fõld
(
s8
, 
noi£
)

1883 
	`TP_Á°_assign
(

1884 
WIPHY_ASSIGN
;

1885 
	`CHAN_ASSIGN
(
öfo
->
ch™√l
);

1886 
__íåy
->
ªt
 =Ñet;

1887 
__íåy
->
time
 = 
öfo
->time;

1888 
__íåy
->
time_busy
 = 
öfo
->time_busy;

1889 
__íåy
->
time_ext_busy
 = 
öfo
->time_ext_busy;

1890 
__íåy
->
time_rx
 = 
öfo
->time_rx;

1891 
__íåy
->
time_tx
 = 
öfo
->time_tx;

1892 
__íåy
->
time_sˇn
 = 
öfo
->time_scan;

1893 
__íåy
->
fûÀd
 = 
öfo
->filled;

1894 
__íåy
->
noi£
 = 
öfo
->noise;

1896 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ",Ñëu∫ed: %d, " 
CHAN_PR_FMT


1900 
WIPHY_PR_ARG
, 
__íåy
->
ªt
, 
CHAN_PR_ARG
,

1901 
__íåy
->
time
, __íåy->
time_busy
,

1902 
__íåy
->
time_ext_busy
, __íåy->
time_rx
,

1903 
__íåy
->
time_tx
, __íåy->
time_sˇn
,

1904 
__íåy
->
fûÀd
, __íåy->
noi£
)

1907 
	`TRACE_EVENT
(
rdev_tdls_›î
,

1908 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1909 
u8
 *
≥î
, 
∆80211_tdls_›î©i⁄
 
›î
),

1910 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
≥î
, 
›î
),

1911 
	`TP_STRUCT__íåy
(

1912 
WIPHY_ENTRY


1913 
NETDEV_ENTRY


1914 
	$MAC_ENTRY
(
≥î
)

1915 
	`__fõld
(
∆80211_tdls_›î©i⁄
, 
›î
)

1917 
	`TP_Á°_assign
(

1918 
WIPHY_ASSIGN
;

1919 
NETDEV_ASSIGN
;

1920 
	`MAC_ASSIGN
(
≥î
,Öeer);

1921 
__íåy
->
›î
 = oper;

1923 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %pM, oper: %d",

1924 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
≥î
, __íåy->
›î
)

1927 
	`DECLARE_EVENT_CLASS
(
rdev_pmkß
,

1928 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1929 
cfg80211_pmkß
 *
pmkß
),

1930 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
pmkß
),

1931 
	`TP_STRUCT__íåy
(

1932 
WIPHY_ENTRY


1933 
NETDEV_ENTRY


1934 
	`MAC_ENTRY
(
bssid
)

1936 
	`TP_Á°_assign
(

1937 
WIPHY_ASSIGN
;

1938 
NETDEV_ASSIGN
;

1939 
	`MAC_ASSIGN
(
bssid
, 
pmkß
->bssid);

1941 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", bssid: %pM",

1942 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
bssid
)

1945 
	`TRACE_EVENT
(
rdev_¥obe_˛õ¡
,

1946 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1947 c⁄° 
u8
 *
≥î
),

1948 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
≥î
),

1949 
	`TP_STRUCT__íåy
(

1950 
WIPHY_ENTRY


1951 
NETDEV_ENTRY


1952 
	`MAC_ENTRY
(
≥î
)

1954 
	`TP_Á°_assign
(

1955 
WIPHY_ASSIGN
;

1956 
NETDEV_ASSIGN
;

1957 
	`MAC_ASSIGN
(
≥î
,Öeer);

1959 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %pM",

1960 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
≥î
)

1963 
	`DEFINE_EVENT
(
rdev_pmkß
, 
rdev_£t_pmkß
,

1964 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1965 
cfg80211_pmkß
 *
pmkß
),

1966 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
pmkß
)

1969 
	`DEFINE_EVENT
(
rdev_pmkß
, 
rdev_dñ_pmkß
,

1970 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

1971 
cfg80211_pmkß
 *
pmkß
),

1972 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
pmkß
)

1975 
	`TRACE_EVENT
(
rdev_ªmaö_⁄_ch™√l
,

1976 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

1977 
õì80211_ch™√l
 *
ch™
,

1978 
duøti⁄
),

1979 
	`TP_ARGS
(
wùhy
, 
wdev
, 
ch™
, 
duøti⁄
),

1980 
	`TP_STRUCT__íåy
(

1981 
WIPHY_ENTRY


1982 
WDEV_ENTRY


1983 
CHAN_ENTRY


1984 
	`__fõld
(, 
duøti⁄
)

1986 
	`TP_Á°_assign
(

1987 
WIPHY_ASSIGN
;

1988 
WDEV_ASSIGN
;

1989 
	`CHAN_ASSIGN
(
ch™
);

1990 
__íåy
->
duøti⁄
 = duration;

1992 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ", " 
CHAN_PR_FMT
 ", duration: %u",

1993 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
, 
CHAN_PR_ARG
, 
__íåy
->
duøti⁄
)

1996 
	`TRACE_EVENT
(
rdev_ªtu∫_öt_cookõ
,

1997 
	`TP_PROTO
(
wùhy
 *wùhy, 
ªt
, 
u64
 
cookõ
),

1998 
	`TP_ARGS
(
wùhy
, 
ªt
, 
cookõ
),

1999 
	`TP_STRUCT__íåy
(

2000 
WIPHY_ENTRY


2001 
	$__fõld
(, 
ªt
)

2002 
	`__fõld
(
u64
, 
cookõ
)

2004 
	`TP_Á°_assign
(

2005 
WIPHY_ASSIGN
;

2006 
__íåy
->
ªt
 =Ñet;

2007 
__íåy
->
cookõ
 = cookie;

2009 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ",Ñeturned %d, cookie: %llu",

2010 
WIPHY_PR_ARG
, 
__íåy
->
ªt
, __íåy->
cookõ
)

2013 
	`TRACE_EVENT
(
rdev_ˇn˚l_ªmaö_⁄_ch™√l
,

2014 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
, 
u64
 
cookõ
),

2015 
	`TP_ARGS
(
wùhy
, 
wdev
, 
cookõ
),

2016 
	`TP_STRUCT__íåy
(

2017 
WIPHY_ENTRY


2018 
WDEV_ENTRY


2019 
	`__fõld
(
u64
, 
cookõ
)

2021 
	`TP_Á°_assign
(

2022 
WIPHY_ASSIGN
;

2023 
WDEV_ASSIGN
;

2024 
__íåy
->
cookõ
 = cookie;

2026 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ", cookie: %llu",

2027 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
, 
__íåy
->
cookõ
)

2030 
	`TRACE_EVENT
(
rdev_mgmt_tx
,

2031 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

2032 
cfg80211_mgmt_tx_∑øms
 *
∑øms
),

2033 
	`TP_ARGS
(
wùhy
, 
wdev
, 
∑øms
),

2034 
	`TP_STRUCT__íåy
(

2035 
WIPHY_ENTRY


2036 
WDEV_ENTRY


2037 
CHAN_ENTRY


2038 
	$__fõld
(
boﬁ
, 
offch™
)

2039 
	$__fõld
(, 
waô
)

2040 
	$__fõld
(
boﬁ
, 
no_cck
)

2041 
	`__fõld
(
boﬁ
, 
d⁄t_waô_f‹_ack
)

2043 
	`TP_Á°_assign
(

2044 
WIPHY_ASSIGN
;

2045 
WDEV_ASSIGN
;

2046 
	`CHAN_ASSIGN
(
∑øms
->
ch™
);

2047 
__íåy
->
offch™
 = 
∑øms
->offchan;

2048 
__íåy
->
waô
 = 
∑øms
->wait;

2049 
__íåy
->
no_cck
 = 
∑øms
->no_cck;

2050 
__íåy
->
d⁄t_waô_f‹_ack
 = 
∑øms
->dont_wait_for_ack;

2052 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ", " 
CHAN_PR_FMT
 ", offchan: %s,"

2054 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
, 
CHAN_PR_ARG
,

2055 
	`BOOL_TO_STR
(
__íåy
->
offch™
), __íåy->
waô
,

2056 
	`BOOL_TO_STR
(
__íåy
->
no_cck
),

2057 
	`BOOL_TO_STR
(
__íåy
->
d⁄t_waô_f‹_ack
))

2060 
	`TRACE_EVENT
(
rdev_tx_c⁄åﬁ_p‹t
,

2061 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2062 c⁄° 
u8
 *
buf
, 
size_t
 
Àn
, c⁄° u8 *
de°
, 
__be16
 
¥Ÿo
,

2063 
boﬁ
 
u√n¸y±ed
, 
lök_id
),

2064 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
buf
, 
Àn
, 
de°
, 
¥Ÿo
, 
u√n¸y±ed
, 
lök_id
),

2065 
	`TP_STRUCT__íåy
(

2066 
WIPHY_ENTRY


2067 
NETDEV_ENTRY


2068 
	$MAC_ENTRY
(
de°
)

2069 
	$__fõld
(
__be16
, 
¥Ÿo
)

2070 
	$__fõld
(
boﬁ
, 
u√n¸y±ed
)

2071 
	`__fõld
(, 
lök_id
)

2073 
	`TP_Á°_assign
(

2074 
WIPHY_ASSIGN
;

2075 
NETDEV_ASSIGN
;

2076 
	`MAC_ASSIGN
(
de°
, dest);

2077 
__íåy
->
¥Ÿo
 =Öroto;

2078 
__íåy
->
u√n¸y±ed
 = unencrypted;

2079 
__íåy
->
lök_id
 =Üink_id;

2081 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %pM,"

2083 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
de°
,

2084 
	`be16_to_˝u
(
__íåy
->
¥Ÿo
),

2085 
	`BOOL_TO_STR
(
__íåy
->
u√n¸y±ed
),

2086 
__íåy
->
lök_id
)

2089 
	`TRACE_EVENT
(
rdev_£t_nﬂck_m≠
,

2090 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2091 
u16
 
nﬂck_m≠
),

2092 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
nﬂck_m≠
),

2093 
	`TP_STRUCT__íåy
(

2094 
WIPHY_ENTRY


2095 
NETDEV_ENTRY


2096 
	`__fõld
(
u16
, 
nﬂck_m≠
)

2098 
	`TP_Á°_assign
(

2099 
WIPHY_ASSIGN
;

2100 
NETDEV_ASSIGN
;

2101 
__íåy
->
nﬂck_m≠
 =Çoack_map;

2103 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Çoack_map: %u",

2104 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
nﬂck_m≠
)

2107 
	`DECLARE_EVENT_CLASS
(
wùhy_wdev_lök_evt
,

2108 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

2109 
lök_id
),

2110 
	`TP_ARGS
(
wùhy
, 
wdev
, 
lök_id
),

2111 
	`TP_STRUCT__íåy
(

2112 
WIPHY_ENTRY


2113 
WDEV_ENTRY


2114 
	`__fõld
(, 
lök_id
)

2116 
	`TP_Á°_assign
(

2117 
WIPHY_ASSIGN
;

2118 
WDEV_ASSIGN
;

2119 
__íåy
->
lök_id
 =Üink_id;

2121 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ",Üink_id: %u",

2122 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
, 
__íåy
->
lök_id
)

2125 
	`DEFINE_EVENT
(
wùhy_wdev_lök_evt
, 
rdev_gë_ch™√l
,

2126 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

2127 
lök_id
),

2128 
	`TP_ARGS
(
wùhy
, 
wdev
, 
lök_id
)

2131 
	`TRACE_EVENT
(
rdev_ªtu∫_ch™def
,

2132 
	`TP_PROTO
(
wùhy
 *wùhy, 
ªt
,

2133 
cfg80211_ch™_def
 *
ch™def
),

2134 
	`TP_ARGS
(
wùhy
, 
ªt
, 
ch™def
),

2135 
	`TP_STRUCT__íåy
(

2136 
WIPHY_ENTRY


2137 
	$__fõld
(, 
ªt
)

2138 
CHAN_DEF_ENTRY


2140 
	`TP_Á°_assign
(

2141 
WIPHY_ASSIGN
;

2142 i‡(
ªt
 == 0)

2143 
	`CHAN_DEF_ASSIGN
(
ch™def
);

2145 
	`CHAN_DEF_ASSIGN
((
cfg80211_ch™_def
 *)
NULL
);

2146 
__íåy
->
ªt
 =Ñet;

2148 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
CHAN_DEF_PR_FMT
 ",Ñet: %d",

2149 
WIPHY_PR_ARG
, 
CHAN_DEF_PR_ARG
, 
__íåy
->
ªt
)

2152 
	`DEFINE_EVENT
(
wùhy_wdev_evt
, 
rdev_°¨t_p2p_devi˚
,

2153 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

2154 
	`TP_ARGS
(
wùhy
, 
wdev
)

2157 
	`DEFINE_EVENT
(
wùhy_wdev_evt
, 
rdev_°›_p2p_devi˚
,

2158 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

2159 
	`TP_ARGS
(
wùhy
, 
wdev
)

2162 
	`TRACE_EVENT
(
rdev_°¨t_«n
,

2163 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

2164 
cfg80211_«n_c⁄f
 *
c⁄f
),

2165 
	`TP_ARGS
(
wùhy
, 
wdev
, 
c⁄f
),

2166 
	`TP_STRUCT__íåy
(

2167 
WIPHY_ENTRY


2168 
WDEV_ENTRY


2169 
	$__fõld
(
u8
, 
ma°î_¥ef
)

2170 
	`__fõld
(
u8
, 
b™ds
)

2172 
	`TP_Á°_assign
(

2173 
WIPHY_ASSIGN
;

2174 
WDEV_ASSIGN
;

2175 
__íåy
->
ma°î_¥ef
 = 
c⁄f
->master_pref;

2176 
__íåy
->
b™ds
 = 
c⁄f
->bands;

2178 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT


2180 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
, 
__íåy
->
ma°î_¥ef
,

2181 
__íåy
->
b™ds
)

2184 
	`TRACE_EVENT
(
rdev_«n_ch™ge_c⁄f
,

2185 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

2186 
cfg80211_«n_c⁄f
 *
c⁄f
, 
u32
 
ch™ges
),

2187 
	`TP_ARGS
(
wùhy
, 
wdev
, 
c⁄f
, 
ch™ges
),

2188 
	`TP_STRUCT__íåy
(

2189 
WIPHY_ENTRY


2190 
WDEV_ENTRY


2191 
	$__fõld
(
u8
, 
ma°î_¥ef
)

2192 
	$__fõld
(
u8
, 
b™ds
)

2193 
	`__fõld
(
u32
, 
ch™ges
)

2195 
	`TP_Á°_assign
(

2196 
WIPHY_ASSIGN
;

2197 
WDEV_ASSIGN
;

2198 
__íåy
->
ma°î_¥ef
 = 
c⁄f
->master_pref;

2199 
__íåy
->
b™ds
 = 
c⁄f
->bands;

2200 
__íåy
->
ch™ges
 = changes;

2202 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT


2204 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
, 
__íåy
->
ma°î_¥ef
,

2205 
__íåy
->
b™ds
, __íåy->
ch™ges
)

2208 
	`DEFINE_EVENT
(
wùhy_wdev_evt
, 
rdev_°›_«n
,

2209 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

2210 
	`TP_ARGS
(
wùhy
, 
wdev
)

2213 
	`TRACE_EVENT
(
rdev_add_«n_func
,

2214 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

2215 c⁄° 
cfg80211_«n_func
 *
func
),

2216 
	`TP_ARGS
(
wùhy
, 
wdev
, 
func
),

2217 
	`TP_STRUCT__íåy
(

2218 
WIPHY_ENTRY


2219 
WDEV_ENTRY


2220 
	$__fõld
(
u8
, 
func_ty≥
)

2221 
	`__fõld
(
u64
, 
cookõ
)

2223 
	`TP_Á°_assign
(

2224 
WIPHY_ASSIGN
;

2225 
WDEV_ASSIGN
;

2226 
__íåy
->
func_ty≥
 = 
func
->
ty≥
;

2227 
__íåy
->
cookõ
 = 
func
->cookie

2229 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ",Åype=%u, cookie=%llu",

2230 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
, 
__íåy
->
func_ty≥
,

2231 
__íåy
->
cookõ
)

2234 
	`TRACE_EVENT
(
rdev_dñ_«n_func
,

2235 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

2236 
u64
 
cookõ
),

2237 
	`TP_ARGS
(
wùhy
, 
wdev
, 
cookõ
),

2238 
	`TP_STRUCT__íåy
(

2239 
WIPHY_ENTRY


2240 
WDEV_ENTRY


2241 
	`__fõld
(
u64
, 
cookõ
)

2243 
	`TP_Á°_assign
(

2244 
WIPHY_ASSIGN
;

2245 
WDEV_ASSIGN
;

2246 
__íåy
->
cookõ
 = cookie;

2248 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ", cookie=%llu",

2249 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
, 
__íåy
->
cookõ
)

2252 
	`TRACE_EVENT
(
rdev_£t_mac_a˛
,

2253 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2254 
cfg80211_a˛_d©a
 *
∑øms
),

2255 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
),

2256 
	`TP_STRUCT__íåy
(

2257 
WIPHY_ENTRY


2258 
NETDEV_ENTRY


2259 
	`__fõld
(
u32
, 
a˛_pﬁicy
)

2261 
	`TP_Á°_assign
(

2262 
WIPHY_ASSIGN
;

2263 
NETDEV_ASSIGN
;

2264 
__íåy
->
a˛_pﬁicy
 = 
∑øms
->acl_policy;

2266 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",áclÖolicy: %d",

2267 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
a˛_pﬁicy
)

2270 
	`TRACE_EVENT
(
rdev_upd©e_·_õs
,

2271 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2272 
cfg80211_upd©e_·_õs_∑øms
 *
·õ
),

2273 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
·õ
),

2274 
	`TP_STRUCT__íåy
(

2275 
WIPHY_ENTRY


2276 
NETDEV_ENTRY


2277 
	$__fõld
(
u16
, 
md
)

2278 
	`__dy«mic_¨øy
(
u8
, 
õ
, 
·õ
->
õ_Àn
)

2280 
	`TP_Á°_assign
(

2281 
WIPHY_ASSIGN
;

2282 
NETDEV_ASSIGN
;

2283 
__íåy
->
md
 = 
·õ
->md;

2284 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
õ
), 
·õ
->õ, ftõ->
õ_Àn
);

2286 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", md: 0x%x",

2287 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
md
)

2290 
	`TRACE_EVENT
(
rdev_¸ô_¥Ÿo_°¨t
,

2291 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

2292 
∆80211_¸ô_¥Ÿo_id
 
¥Ÿocﬁ
, 
u16
 
duøti⁄
),

2293 
	`TP_ARGS
(
wùhy
, 
wdev
, 
¥Ÿocﬁ
, 
duøti⁄
),

2294 
	`TP_STRUCT__íåy
(

2295 
WIPHY_ENTRY


2296 
WDEV_ENTRY


2297 
	$__fõld
(
u16
, 
¥Ÿo
)

2298 
	`__fõld
(
u16
, 
duøti⁄
)

2300 
	`TP_Á°_assign
(

2301 
WIPHY_ASSIGN
;

2302 
WDEV_ASSIGN
;

2303 
__íåy
->
¥Ÿo
 = 
¥Ÿocﬁ
;

2304 
__íåy
->
duøti⁄
 = duration;

2306 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ",Öroto=%x, duration=%u",

2307 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
, 
__íåy
->
¥Ÿo
, __íåy->
duøti⁄
)

2310 
	`TRACE_EVENT
(
rdev_¸ô_¥Ÿo_°›
,

2311 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

2312 
	`TP_ARGS
(
wùhy
, 
wdev
),

2313 
	`TP_STRUCT__íåy
(

2314 
WIPHY_ENTRY


2315 
WDEV_ENTRY


2317 
	`TP_Á°_assign
(

2318 
WIPHY_ASSIGN
;

2319 
WDEV_ASSIGN
;

2321 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
,

2322 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
)

2325 
	`TRACE_EVENT
(
rdev_ch™√l_swôch
,

2326 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2327 
cfg80211_cß_£âögs
 *
∑øms
),

2328 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
),

2329 
	`TP_STRUCT__íåy
(

2330 
WIPHY_ENTRY


2331 
NETDEV_ENTRY


2332 
CHAN_DEF_ENTRY


2333 
	$__fõld
(
boﬁ
, 
ød¨_ªquúed
)

2334 
	$__fõld
(
boﬁ
, 
block_tx
)

2335 
	$__fõld
(
u8
, 
cou¡
)

2336 
	`__dy«mic_¨øy
(
u16
, 
b˙_ofs
, 
∑øms
->
n_cou¡î_off£ts_bóc⁄
)

2337 
	`__dy«mic_¨øy
(
u16
, 
¥es_ofs
, 
∑øms
->
n_cou¡î_off£ts_¥e•
)

2338 
	`__fõld
(
u8
, 
lök_id
)

2340 
	`TP_Á°_assign
(

2341 
WIPHY_ASSIGN
;

2342 
NETDEV_ASSIGN
;

2343 
	`CHAN_DEF_ASSIGN
(&
∑øms
->
ch™def
);

2344 
__íåy
->
ød¨_ªquúed
 = 
∑øms
->radar_required;

2345 
__íåy
->
block_tx
 = 
∑øms
->block_tx;

2346 
__íåy
->
cou¡
 = 
∑øms
->count;

2347 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
b˙_ofs
),

2348 
∑øms
->
cou¡î_off£ts_bóc⁄
,

2349 
∑øms
->
n_cou¡î_off£ts_bóc⁄
 * (
u16
));

2352 i‡(
∑øms
->
n_cou¡î_off£ts_¥e•
)

2353 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
¥es_ofs
),

2354 
∑øms
->
cou¡î_off£ts_¥e•
,

2355 
∑øms
->
n_cou¡î_off£ts_¥e•
 * (
u16
));

2356 
__íåy
->
lök_id
 = 
∑øms
->link_id;

2358 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", " 
CHAN_DEF_PR_FMT


2360 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
CHAN_DEF_PR_ARG
,

2361 
__íåy
->
block_tx
, __íåy->
cou¡
, __íåy->
ød¨_ªquúed
,

2362 
__íåy
->
lök_id
)

2365 
	`TRACE_EVENT
(
rdev_£t_qos_m≠
,

2366 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2367 
cfg80211_qos_m≠
 *
qos_m≠
),

2368 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
qos_m≠
),

2369 
	`TP_STRUCT__íåy
(

2370 
WIPHY_ENTRY


2371 
NETDEV_ENTRY


2372 
QOS_MAP_ENTRY


2374 
	`TP_Á°_assign
(

2375 
WIPHY_ASSIGN
;

2376 
NETDEV_ASSIGN
;

2377 
	`QOS_MAP_ASSIGN
(
qos_m≠
);

2379 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Çum_des: %u",

2380 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
num_des
)

2383 
	`TRACE_EVENT
(
rdev_£t_≠_ch™width
,

2384 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2385 
lök_id
,

2386 
cfg80211_ch™_def
 *
ch™def
),

2387 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
lök_id
, 
ch™def
),

2388 
	`TP_STRUCT__íåy
(

2389 
WIPHY_ENTRY


2390 
NETDEV_ENTRY


2391 
CHAN_DEF_ENTRY


2392 
	`__fõld
(, 
lök_id
)

2394 
	`TP_Á°_assign
(

2395 
WIPHY_ASSIGN
;

2396 
NETDEV_ASSIGN
;

2397 
	`CHAN_DEF_ASSIGN
(
ch™def
);

2398 
__íåy
->
lök_id
 =Üink_id;

2400 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", " 
CHAN_DEF_PR_FMT
 ",Üink:%d",

2401 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
CHAN_DEF_PR_ARG
,

2402 
__íåy
->
lök_id
)

2405 
	`TRACE_EVENT
(
rdev_add_tx_ts
,

2406 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2407 
u8
 
tsid
, c⁄° u8 *
≥î
, u8 
u£r_¥io
, 
u16
 
admôãd_time
),

2408 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
tsid
, 
≥î
, 
u£r_¥io
, 
admôãd_time
),

2409 
	`TP_STRUCT__íåy
(

2410 
WIPHY_ENTRY


2411 
NETDEV_ENTRY


2412 
	$MAC_ENTRY
(
≥î
)

2413 
	$__fõld
(
u8
, 
tsid
)

2414 
	$__fõld
(
u8
, 
u£r_¥io
)

2415 
	`__fõld
(
u16
, 
admôãd_time
)

2417 
	`TP_Á°_assign
(

2418 
WIPHY_ASSIGN
;

2419 
NETDEV_ASSIGN
;

2420 
	`MAC_ASSIGN
(
≥î
,Öeer);

2421 
__íåy
->
tsid
 =Åsid;

2422 
__íåy
->
u£r_¥io
 = user_prio;

2423 
__íåy
->
admôãd_time
 =ádmitted_time;

2425 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %pM, TSID %d, UP %d,Åime %d",

2426 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
≥î
,

2427 
__íåy
->
tsid
, __íåy->
u£r_¥io
, __íåy->
admôãd_time
)

2430 
	`TRACE_EVENT
(
rdev_dñ_tx_ts
,

2431 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2432 
u8
 
tsid
, c⁄° u8 *
≥î
),

2433 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
tsid
, 
≥î
),

2434 
	`TP_STRUCT__íåy
(

2435 
WIPHY_ENTRY


2436 
NETDEV_ENTRY


2437 
	$MAC_ENTRY
(
≥î
)

2438 
	`__fõld
(
u8
, 
tsid
)

2440 
	`TP_Á°_assign
(

2441 
WIPHY_ASSIGN
;

2442 
NETDEV_ASSIGN
;

2443 
	`MAC_ASSIGN
(
≥î
,Öeer);

2444 
__íåy
->
tsid
 =Åsid;

2446 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %pM, TSID %d",

2447 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
≥î
, __íåy->
tsid
)

2450 
	`TRACE_EVENT
(
rdev_tdls_ch™√l_swôch
,

2451 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2452 c⁄° 
u8
 *
addr
, u8 
›î_˛ass
,

2453 
cfg80211_ch™_def
 *
ch™def
),

2454 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
addr
, 
›î_˛ass
, 
ch™def
),

2455 
	`TP_STRUCT__íåy
(

2456 
WIPHY_ENTRY


2457 
NETDEV_ENTRY


2458 
	$MAC_ENTRY
(
addr
)

2459 
	$__fõld
(
u8
, 
›î_˛ass
)

2460 
CHAN_DEF_ENTRY


2462 
	`TP_Á°_assign
(

2463 
WIPHY_ASSIGN
;

2464 
NETDEV_ASSIGN
;

2465 
	`MAC_ASSIGN
(
addr
,áddr);

2466 
	`CHAN_DEF_ASSIGN
(
ch™def
);

2468 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %pM"

2469 " o≥∏˛as†%d, " 
CHAN_DEF_PR_FMT
,

2470 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
addr
,

2471 
__íåy
->
›î_˛ass
, 
CHAN_DEF_PR_ARG
)

2474 
	`TRACE_EVENT
(
rdev_tdls_ˇn˚l_ch™√l_swôch
,

2475 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2476 c⁄° 
u8
 *
addr
),

2477 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
addr
),

2478 
	`TP_STRUCT__íåy
(

2479 
WIPHY_ENTRY


2480 
NETDEV_ENTRY


2481 
	`MAC_ENTRY
(
addr
)

2483 
	`TP_Á°_assign
(

2484 
WIPHY_ASSIGN
;

2485 
NETDEV_ASSIGN
;

2486 
	`MAC_ASSIGN
(
addr
,áddr);

2488 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %pM",

2489 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
addr
)

2492 
	`TRACE_EVENT
(
rdev_£t_pmk
,

2493 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2494 
cfg80211_pmk_c⁄f
 *
pmk_c⁄f
),

2496 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
pmk_c⁄f
),

2498 
	`TP_STRUCT__íåy
(

2499 
WIPHY_ENTRY


2500 
NETDEV_ENTRY


2501 
	$MAC_ENTRY
(
Ø
)

2502 
	$__fõld
(
u8
, 
pmk_Àn
)

2503 
	$__fõld
(
u8
, 
pmk_r0_«me_Àn
)

2504 
	`__dy«mic_¨øy
(
u8
, 
pmk
, 
pmk_c⁄f
->
pmk_Àn
)

2505 
	`__dy«mic_¨øy
(
u8
, 
pmk_r0_«me
, 
WLAN_PMK_NAME_LEN
)

2508 
	`TP_Á°_assign
(

2509 
WIPHY_ASSIGN
;

2510 
NETDEV_ASSIGN
;

2511 
	`MAC_ASSIGN
(
Ø
, 
pmk_c⁄f
->aa);

2512 
__íåy
->
pmk_Àn
 = 
pmk_c⁄f
->pmk_len;

2513 
__íåy
->
pmk_r0_«me_Àn
 =

2514 
pmk_c⁄f
->
pmk_r0_«me
 ? 
WLAN_PMK_NAME_LEN
 : 0;

2515 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
pmk
), 
pmk_c⁄f
->pmk,

2516 
pmk_c⁄f
->
pmk_Àn
);

2517 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
pmk_r0_«me
), 
pmk_c⁄f
->pmk_r0_name,

2518 
pmk_c⁄f
->
pmk_r0_«me
 ? 
WLAN_PMK_NAME_LEN
 : 0);

2521 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %pM"

2522 "pmk_Àn=%u,Ömk: %†pmk_r0_«me: %s", 
WIPHY_PR_ARG
,

2523 
NETDEV_PR_ARG
, 
__íåy
->
Ø
, __íåy->
pmk_Àn
,

2524 
	`__¥öt_¨øy
(
	`__gë_dy«mic_¨øy
(
pmk
),

2525 
	`__gë_dy«mic_¨øy_Àn
(
pmk
), 1),

2526 
__íåy
->
pmk_r0_«me_Àn
 ?

2527 
	`__¥öt_¨øy
(
	`__gë_dy«mic_¨øy
(
pmk_r0_«me
),

2528 
	`__gë_dy«mic_¨øy_Àn
(
pmk_r0_«me
), 1) : "")

2531 
	`TRACE_EVENT
(
rdev_dñ_pmk
,

2532 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
Ø
),

2534 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
Ø
),

2536 
	`TP_STRUCT__íåy
(

2537 
WIPHY_ENTRY


2538 
NETDEV_ENTRY


2539 
	`MAC_ENTRY
(
Ø
)

2542 
	`TP_Á°_assign
(

2543 
WIPHY_ASSIGN
;

2544 
NETDEV_ASSIGN
;

2545 
	`MAC_ASSIGN
(
Ø
,áa);

2548 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %pM",

2549 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
Ø
)

2552 
	`TRACE_EVENT
(
rdev_exã∫Æ_auth
,

2553 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2554 
cfg80211_exã∫Æ_auth_∑øms
 *
∑øms
),

2555 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
),

2556 
	`TP_STRUCT__íåy
(
WIPHY_ENTRY


2557 
NETDEV_ENTRY


2558 
	$MAC_ENTRY
(
bssid
)

2559 
	`__¨øy
(
u8
, 
ssid
, 
IEEE80211_MAX_SSID_LEN
 + 1)

2560 
	$__fõld
(
u16
, 
°©us
)

2561 
	`MAC_ENTRY
(
mld_addr
)

2563 
	`TP_Á°_assign
(
WIPHY_ASSIGN
;

2564 
NETDEV_ASSIGN
;

2565 
	`MAC_ASSIGN
(
bssid
, 
∑øms
->bssid);

2566 
	`mem£t
(
__íåy
->
ssid
, 0, 
IEEE80211_MAX_SSID_LEN
 + 1);

2567 
	`mem˝y
(
__íåy
->
ssid
, 
∑øms
->ssid.ssid,

2568 
∑øms
->
ssid
.
ssid_Àn
);

2569 
__íåy
->
°©us
 = 
∑øms
->status;

2570 
	`MAC_ASSIGN
(
mld_addr
, 
∑øms
->mld_addr);

2572 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", bssid: %pM"

2574 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
bssid
,

2575 
__íåy
->
ssid
, __íåy->
°©us
, __íåy->
mld_addr
)

2578 
	`TRACE_EVENT
(
rdev_°¨t_ød¨_dëe˘i⁄
,

2579 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2580 
cfg80211_ch™_def
 *
ch™def
,

2581 
u32
 
ˇc_time_ms
),

2582 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
ch™def
, 
ˇc_time_ms
),

2583 
	`TP_STRUCT__íåy
(

2584 
WIPHY_ENTRY


2585 
NETDEV_ENTRY


2586 
CHAN_DEF_ENTRY


2587 
	`__fõld
(
u32
, 
ˇc_time_ms
)

2589 
	`TP_Á°_assign
(

2590 
WIPHY_ASSIGN
;

2591 
NETDEV_ASSIGN
;

2592 
	`CHAN_DEF_ASSIGN
(
ch™def
);

2593 
__íåy
->
ˇc_time_ms
 = cac_time_ms;

2595 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", " 
CHAN_DEF_PR_FMT


2597 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
CHAN_DEF_PR_ARG
,

2598 
__íåy
->
ˇc_time_ms
)

2601 
	`TRACE_EVENT
(
rdev_£t_mˇ°_øã
,

2602 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2603 *
mˇ°_øã
),

2604 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
mˇ°_øã
),

2605 
	`TP_STRUCT__íåy
(

2606 
WIPHY_ENTRY


2607 
NETDEV_ENTRY


2608 
	`__¨øy
(, 
mˇ°_øã
, 
NUM_NL80211_BANDS
)

2610 
	`TP_Á°_assign
(

2611 
WIPHY_ASSIGN
;

2612 
NETDEV_ASSIGN
;

2613 
	`mem˝y
(
__íåy
->
mˇ°_øã
, mcast_rate,

2614 (Ë* 
NUM_NL80211_BANDS
);

2616 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", "

2618 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
,

2619 
__íåy
->
mˇ°_øã
[
NL80211_BAND_2GHZ
],

2620 
__íåy
->
mˇ°_øã
[
NL80211_BAND_5GHZ
],

2621 
__íåy
->
mˇ°_øã
[
NL80211_BAND_6GHZ
],

2622 
__íåy
->
mˇ°_øã
[
NL80211_BAND_60GHZ
])

2625 
	`TRACE_EVENT
(
rdev_£t_cﬂÀs˚
,

2626 
	`TP_PROTO
(
wùhy
 *wùhy, 
cfg80211_cﬂÀs˚
 *
cﬂÀs˚
),

2627 
	`TP_ARGS
(
wùhy
, 
cﬂÀs˚
),

2628 
	`TP_STRUCT__íåy
(

2629 
WIPHY_ENTRY


2630 
	`__fõld
(, 
n_ruÀs
)

2632 
	`TP_Á°_assign
(

2633 
WIPHY_ASSIGN
;

2634 
__íåy
->
n_ruÀs
 = 
cﬂÀs˚
 ? coalesce->n_rules : 0;

2636 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ",Ç_rules=%d",

2637 
WIPHY_PR_ARG
, 
__íåy
->
n_ruÀs
)

2640 
	`DEFINE_EVENT
(
wùhy_wdev_evt
, 
rdev_ab‹t_sˇn
,

2641 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

2642 
	`TP_ARGS
(
wùhy
, 
wdev
)

2645 
	`TRACE_EVENT
(
rdev_£t_mu…iˇ°_to_uniˇ°
,

2646 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2647 c⁄° 
boﬁ
 
íabÀd
),

2648 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
íabÀd
),

2649 
	`TP_STRUCT__íåy
(

2650 
WIPHY_ENTRY


2651 
NETDEV_ENTRY


2652 
	`__fõld
(
boﬁ
, 
íabÀd
)

2654 
	`TP_Á°_assign
(

2655 
WIPHY_ASSIGN
;

2656 
NETDEV_ASSIGN
;

2657 
__íåy
->
íabÀd
 =Énabled;

2659 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", unicast: %s",

2660 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
,

2661 
	`BOOL_TO_STR
(
__íåy
->
íabÀd
))

2664 
	`DEFINE_EVENT
(
wùhy_wdev_evt
, 
rdev_gë_txq_°©s
,

2665 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

2666 
	`TP_ARGS
(
wùhy
, 
wdev
)

2669 
	`TRACE_EVENT
(
rdev_gë_·m_ª•⁄dî_°©s
,

2670 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2671 
cfg80211_·m_ª•⁄dî_°©s
 *
·m_°©s
),

2673 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
·m_°©s
),

2675 
	`TP_STRUCT__íåy
(

2676 
WIPHY_ENTRY


2677 
NETDEV_ENTRY


2678 
	$__fõld
(
u64
, 
time°amp
)

2679 
	$__fõld
(
u32
, 
suc˚ss_num
)

2680 
	$__fõld
(
u32
, 
∑πül_num
)

2681 
	$__fõld
(
u32
, 
Áûed_num
)

2682 
	$__fõld
(
u32
, 
aßp_num
)

2683 
	$__fõld
(
u32
, 
n⁄_aßp_num
)

2684 
	$__fõld
(
u64
, 
duøti⁄
)

2685 
	$__fõld
(
u32
, 
unknown_åiggîs
)

2686 
	$__fõld
(
u32
, 
ªscheduÀ
)

2687 
	`__fõld
(
u32
, 
out_of_wödow
)

2690 
	`TP_Á°_assign
(

2691 
WIPHY_ASSIGN
;

2692 
NETDEV_ASSIGN
;

2693 
__íåy
->
suc˚ss_num
 = 
·m_°©s
->success_num;

2694 
__íåy
->
∑πül_num
 = 
·m_°©s
->partial_num;

2695 
__íåy
->
Áûed_num
 = 
·m_°©s
->failed_num;

2696 
__íåy
->
aßp_num
 = 
·m_°©s
->asap_num;

2697 
__íåy
->
n⁄_aßp_num
 = 
·m_°©s
->non_asap_num;

2698 
__íåy
->
duøti⁄
 = 
·m_°©s
->
tŸÆ_duøti⁄_ms
;

2699 
__íåy
->
unknown_åiggîs
 = 
·m_°©s
->
unknown_åiggîs_num
;

2700 
__íåy
->
ªscheduÀ
 = 
·m_°©s
->
ªscheduÀ_ªque°s_num
;

2701 
__íåy
->
out_of_wödow
 = 
·m_°©s
->
out_of_wödow_åiggîs_num
;

2704 
	`TP_¥ötk
(
WIPHY_PR_FMT
 "FtmÑesponder stats: success %u,Öartial %u, "

2706 "åiggî†%u,ÑescheduÀd %u, ouào‡wödow %u", 
WIPHY_PR_ARG
,

2707 
__íåy
->
suc˚ss_num
, __íåy->
∑πül_num
, __íåy->
Áûed_num
,

2708 
__íåy
->
aßp_num
, __íåy->
n⁄_aßp_num
, __íåy->
duøti⁄
,

2709 
__íåy
->
unknown_åiggîs
, __íåy->
ªscheduÀ
,

2710 
__íåy
->
out_of_wödow
)

2713 
	`DEFINE_EVENT
(
wùhy_wdev_cookõ_evt
, 
rdev_°¨t_pm§
,

2714 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
, 
u64
 
cookõ
),

2715 
	`TP_ARGS
(
wùhy
, 
wdev
, 
cookõ
)

2718 
	`DEFINE_EVENT
(
wùhy_wdev_cookõ_evt
, 
rdev_ab‹t_pm§
,

2719 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
, 
u64
 
cookõ
),

2720 
	`TP_ARGS
(
wùhy
, 
wdev
, 
cookõ
)

2723 
	`TRACE_EVENT
(
rdev_£t_fûs_Ød
,

2724 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2725 
cfg80211_fûs_Ød
 *
fûs_Ød
),

2726 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
fûs_Ød
),

2727 
	`TP_STRUCT__íåy
(
WIPHY_ENTRY


2728 
NETDEV_ENTRY


2729 
	$__¨øy
(
u8
, 
maˇddr
, 
ETH_ALEN
)

2730 
	`__fõld
(
u8
, 
kek_Àn
)

2732 
	`TP_Á°_assign
(
WIPHY_ASSIGN
;

2733 
NETDEV_ASSIGN
;

2734 
	`FILS_AAD_ASSIGN
(
fûs_Ød
);

2736 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", " 
FILS_AAD_PR_FMT
,

2737 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
maˇddr
,

2738 
__íåy
->
kek_Àn
)

2741 
	`TRACE_EVENT
(
rdev_upd©e_owe_öfo
,

2742 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2743 
cfg80211_upd©e_owe_öfo
 *
owe_öfo
),

2744 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
owe_öfo
),

2745 
	`TP_STRUCT__íåy
(
WIPHY_ENTRY


2746 
NETDEV_ENTRY


2747 
	$MAC_ENTRY
(
≥î
)

2748 
	$__fõld
(
u16
, 
°©us
)

2749 
	`__dy«mic_¨øy
(
u8
, 
õ
, 
owe_öfo
->
õ_Àn
)),

2750 
	`TP_Á°_assign
(
WIPHY_ASSIGN
;

2751 
NETDEV_ASSIGN
;

2752 
	`MAC_ASSIGN
(
≥î
, 
owe_öfo
->peer);

2753 
__íåy
->
°©us
 = 
owe_öfo
->status;

2754 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
õ
),

2755 
owe_öfo
->
õ
, owe_öfo->
õ_Àn
);),

2756 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Öeer: %pM"

2757 " sètu†%d", 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
≥î
,

2758 
__íåy
->
°©us
)

2761 
	`TRACE_EVENT
(
rdev_¥obe_mesh_lök
,

2762 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2763 c⁄° 
u8
 *
de°
, c⁄° u8 *
buf
, 
size_t
 
Àn
),

2764 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
de°
, 
buf
, 
Àn
),

2765 
	`TP_STRUCT__íåy
(

2766 
WIPHY_ENTRY


2767 
NETDEV_ENTRY


2768 
	`MAC_ENTRY
(
de°
)

2770 
	`TP_Á°_assign
(

2771 
WIPHY_ASSIGN
;

2772 
NETDEV_ASSIGN
;

2773 
	`MAC_ASSIGN
(
de°
, dest);

2775 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", %pM",

2776 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
de°
)

2779 
	`TRACE_EVENT
(
rdev_£t_tid_c⁄fig
,

2780 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2781 
cfg80211_tid_c⁄fig
 *
tid_c⁄f
),

2782 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
tid_c⁄f
),

2783 
	`TP_STRUCT__íåy
(

2784 
WIPHY_ENTRY


2785 
NETDEV_ENTRY


2786 
	`MAC_ENTRY
(
≥î
)

2788 
	`TP_Á°_assign
(

2789 
WIPHY_ASSIGN
;

2790 
NETDEV_ASSIGN
;

2791 
	`MAC_ASSIGN
(
≥î
, 
tid_c⁄f
->peer);

2793 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Öeer: %pM",

2794 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
≥î
)

2797 
	`TRACE_EVENT
(
rdev_ª£t_tid_c⁄fig
,

2798 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2799 c⁄° 
u8
 *
≥î
, u8 
tids
),

2800 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
≥î
, 
tids
),

2801 
	`TP_STRUCT__íåy
(

2802 
WIPHY_ENTRY


2803 
NETDEV_ENTRY


2804 
	$MAC_ENTRY
(
≥î
)

2805 
	`__fõld
(
u8
, 
tids
)

2807 
	`TP_Á°_assign
(

2808 
WIPHY_ASSIGN
;

2809 
NETDEV_ASSIGN
;

2810 
	`MAC_ASSIGN
(
≥î
,Öeer);

2811 
__íåy
->
tids
 =Åids;

2813 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Öeer: %pM,Åids: 0x%x",

2814 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
≥î
, __íåy->
tids
)

2817 
	`TRACE_EVENT
(
rdev_£t_ßr_•ecs
,

2818 
	`TP_PROTO
(
wùhy
 *wùhy, 
cfg80211_ßr_•ecs
 *
ßr
),

2819 
	`TP_ARGS
(
wùhy
, 
ßr
),

2820 
	`TP_STRUCT__íåy
(

2821 
WIPHY_ENTRY


2822 
	$__fõld
(
u16
, 
ty≥
)

2823 
	`__fõld
(
u16
, 
num
)

2825 
	`TP_Á°_assign
(

2826 
WIPHY_ASSIGN
;

2827 
__íåy
->
ty≥
 = 
ßr
->type;

2828 
__íåy
->
num
 = 
ßr
->
num_sub_•ecs
;

2831 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", SetÅype:%d,Çum_specs:%d",

2832 
WIPHY_PR_ARG
, 
__íåy
->
ty≥
, __íåy->
num
)

2835 
	`TRACE_EVENT
(
rdev_cﬁ‹_ch™ge
,

2836 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

2837 
cfg80211_cﬁ‹_ch™ge_£âögs
 *
∑øms
),

2838 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
),

2839 
	`TP_STRUCT__íåy
(

2840 
WIPHY_ENTRY


2841 
NETDEV_ENTRY


2842 
	$__fõld
(
u8
, 
cou¡
)

2843 
	$__fõld
(
u16
, 
b˙_ofs
)

2844 
	`__fõld
(
u16
, 
¥es_ofs
)

2846 
	`TP_Á°_assign
(

2847 
WIPHY_ASSIGN
;

2848 
NETDEV_ASSIGN
;

2849 
__íåy
->
cou¡
 = 
∑øms
->count;

2850 
__íåy
->
b˙_ofs
 = 
∑øms
->
cou¡î_off£t_bóc⁄
;

2851 
__íåy
->
¥es_ofs
 = 
∑øms
->
cou¡î_off£t_¥e•
;

2853 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT


2855 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
,

2856 
__íåy
->
cou¡
)

2859 
	`TRACE_EVENT
(
rdev_£t_ød¨_background
,

2860 
	`TP_PROTO
(
wùhy
 *wùhy, 
cfg80211_ch™_def
 *
ch™def
),

2862 
	`TP_ARGS
(
wùhy
, 
ch™def
),

2864 
	`TP_STRUCT__íåy
(

2865 
WIPHY_ENTRY


2866 
CHAN_DEF_ENTRY


2869 
	`TP_Á°_assign
(

2870 
WIPHY_ASSIGN
;

2871 
	`CHAN_DEF_ASSIGN
(
ch™def
)

2874 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
CHAN_DEF_PR_FMT
,

2875 
WIPHY_PR_ARG
, 
CHAN_DEF_PR_ARG
)

2878 
	`DEFINE_EVENT
(
wùhy_wdev_lök_evt
, 
rdev_add_ötf_lök
,

2879 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

2880 
lök_id
),

2881 
	`TP_ARGS
(
wùhy
, 
wdev
, 
lök_id
)

2884 
	`DEFINE_EVENT
(
wùhy_wdev_lök_evt
, 
rdev_dñ_ötf_lök
,

2885 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

2886 
lök_id
),

2887 
	`TP_ARGS
(
wùhy
, 
wdev
, 
lök_id
)

2894 
	`TRACE_EVENT
(
cfg80211_ªtu∫_boﬁ
,

2895 
	`TP_PROTO
(
boﬁ
 
ªt
),

2896 
	`TP_ARGS
(
ªt
),

2897 
	`TP_STRUCT__íåy
(

2898 
	`__fõld
(
boﬁ
, 
ªt
)

2900 
	`TP_Á°_assign
(

2901 
__íåy
->
ªt
 =Ñet;

2903 
	`TP_¥ötk
("ªtu∫ed %s", 
	`BOOL_TO_STR
(
__íåy
->
ªt
))

2906 
	`DECLARE_EVENT_CLASS
(
cfg80211_√tdev_mac_evt
,

2907 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
maˇddr
),

2908 
	`TP_ARGS
(
√tdev
, 
maˇddr
),

2909 
	`TP_STRUCT__íåy
(

2910 
NETDEV_ENTRY


2911 
	`MAC_ENTRY
(
maˇddr
)

2913 
	`TP_Á°_assign
(

2914 
NETDEV_ASSIGN
;

2915 
	`MAC_ASSIGN
(
maˇddr
, macaddr);

2917 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", mac: %pM",

2918 
NETDEV_PR_ARG
, 
__íåy
->
maˇddr
)

2921 
	`DEFINE_EVENT
(
cfg80211_√tdev_mac_evt
, 
cfg80211_nŸify_√w_≥î_ˇndid©e
,

2922 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
maˇddr
),

2923 
	`TP_ARGS
(
√tdev
, 
maˇddr
)

2926 
	`DECLARE_EVENT_CLASS
(
√tdev_evt_⁄ly
,

2927 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
),

2928 
	`TP_ARGS
(
√tdev
),

2929 
	`TP_STRUCT__íåy
(

2930 
NETDEV_ENTRY


2932 
	`TP_Á°_assign
(

2933 
NETDEV_ASSIGN
;

2935 
	`TP_¥ötk
(
NETDEV_PR_FMT
 , 
NETDEV_PR_ARG
)

2938 
	`DEFINE_EVENT
(
√tdev_evt_⁄ly
, 
cfg80211_£nd_rx_auth
,

2939 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
),

2940 
	`TP_ARGS
(
√tdev
)

2943 
	`TRACE_EVENT
(
cfg80211_£nd_rx_assoc
,

2944 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
,

2945 c⁄° 
cfg80211_rx_assoc_ª•_d©a
 *
d©a
),

2946 
	`TP_ARGS
(
√tdev
, 
d©a
),

2947 
	`TP_STRUCT__íåy
(

2948 
NETDEV_ENTRY


2949 
	`MAC_ENTRY
(
≠_addr
)

2951 
	`TP_Á°_assign
(

2952 
NETDEV_ASSIGN
;

2953 
	`MAC_ASSIGN
(
≠_addr
,

2954 
d©a
->
≠_mld_addr
 ?: d©a->
löks
[0].
bss
->
bssid
);

2956 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", %pM",

2957 
NETDEV_PR_ARG
, 
__íåy
->
≠_addr
)

2960 
	`DECLARE_EVENT_CLASS
(
√tdev_‰ame_evít
,

2961 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
buf
, 
Àn
),

2962 
	`TP_ARGS
(
√tdev
, 
buf
, 
Àn
),

2963 
	`TP_STRUCT__íåy
(

2964 
NETDEV_ENTRY


2965 
	`__dy«mic_¨øy
(
u8
, 
‰ame
, 
Àn
)

2967 
	`TP_Á°_assign
(

2968 
NETDEV_ASSIGN
;

2969 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
‰ame
), 
buf
, 
Àn
);

2971 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", ftype:0x%.2x",

2972 
NETDEV_PR_ARG
,

2973 
	`À16_to_˝up
((
__À16
 *)
	`__gë_dy«mic_¨øy
(
‰ame
)))

2976 
	`DEFINE_EVENT
(
√tdev_‰ame_evít
, 
cfg80211_rx_u≈rŸ_mlme_mgmt
,

2977 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
buf
, 
Àn
),

2978 
	`TP_ARGS
(
√tdev
, 
buf
, 
Àn
)

2981 
	`DEFINE_EVENT
(
√tdev_‰ame_evít
, 
cfg80211_rx_mlme_mgmt
,

2982 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
buf
, 
Àn
),

2983 
	`TP_ARGS
(
√tdev
, 
buf
, 
Àn
)

2986 
	`TRACE_EVENT
(
cfg80211_tx_mlme_mgmt
,

2987 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
buf
, 
Àn
,

2988 
boﬁ
 
ªc⁄√˘
),

2989 
	`TP_ARGS
(
√tdev
, 
buf
, 
Àn
, 
ªc⁄√˘
),

2990 
	`TP_STRUCT__íåy
(

2991 
NETDEV_ENTRY


2992 
	$__dy«mic_¨øy
(
u8
, 
‰ame
, 
Àn
)

2993 
	`__fõld
(, 
ªc⁄√˘
)

2995 
	`TP_Á°_assign
(

2996 
NETDEV_ASSIGN
;

2997 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
‰ame
), 
buf
, 
Àn
);

2998 
__íåy
->
ªc⁄√˘
 =Ñeconnect;

3000 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", ftype:0x%.2xÑeconnect:%d",

3001 
NETDEV_PR_ARG
,

3002 
	`À16_to_˝up
((
__À16
 *)
	`__gë_dy«mic_¨øy
(
‰ame
)),

3003 
__íåy
->
ªc⁄√˘
)

3006 
	`DECLARE_EVENT_CLASS
(
√tdev_mac_evt
,

3007 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
mac
),

3008 
	`TP_ARGS
(
√tdev
, 
mac
),

3009 
	`TP_STRUCT__íåy
(

3010 
NETDEV_ENTRY


3011 
	`MAC_ENTRY
(
mac
)

3013 
	`TP_Á°_assign
(

3014 
NETDEV_ASSIGN
;

3015 
	`MAC_ASSIGN
(
mac
, mac)

3017 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", mac: %pM",

3018 
NETDEV_PR_ARG
, 
__íåy
->
mac
)

3021 
	`DEFINE_EVENT
(
√tdev_mac_evt
, 
cfg80211_£nd_auth_timeout
,

3022 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
mac
),

3023 
	`TP_ARGS
(
√tdev
, 
mac
)

3026 
	`TRACE_EVENT
(
cfg80211_£nd_assoc_Áûuª
,

3027 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
,

3028 
cfg80211_assoc_Áûuª
 *
d©a
),

3029 
	`TP_ARGS
(
√tdev
, 
d©a
),

3030 
	`TP_STRUCT__íåy
(

3031 
NETDEV_ENTRY


3032 
	$MAC_ENTRY
(
≠_addr
)

3033 
	`__fõld
(
boﬁ
, 
timeout
)

3035 
	`TP_Á°_assign
(

3036 
NETDEV_ASSIGN
;

3037 
	`MAC_ASSIGN
(
≠_addr
, 
d©a
->
≠_mld_addr
 ?: d©a->
bss
[0]->
bssid
);

3038 
__íåy
->
timeout
 = 
d©a
->timeout;

3040 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", mac: %pM,Åimeout: %d",

3041 
NETDEV_PR_ARG
, 
__íåy
->
≠_addr
, __íåy->
timeout
)

3044 
	`TRACE_EVENT
(
cfg80211_mich´l_mic_Áûuª
,

3045 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
addr
,

3046 
∆80211_key_ty≥
 
key_ty≥
, 
key_id
, c⁄° 
u8
 *
tsc
),

3047 
	`TP_ARGS
(
√tdev
, 
addr
, 
key_ty≥
, 
key_id
, 
tsc
),

3048 
	`TP_STRUCT__íåy
(

3049 
NETDEV_ENTRY


3050 
	$MAC_ENTRY
(
addr
)

3051 
	$__fõld
(
∆80211_key_ty≥
, 
key_ty≥
)

3052 
	$__fõld
(, 
key_id
)

3053 
	`__¨øy
(
u8
, 
tsc
, 6)

3055 
	`TP_Á°_assign
(

3056 
NETDEV_ASSIGN
;

3057 
	`MAC_ASSIGN
(
addr
,áddr);

3058 
__íåy
->
key_ty≥
 = key_type;

3059 
__íåy
->
key_id
 = key_id;

3060 i‡(
tsc
)

3061 
	`mem˝y
(
__íåy
->
tsc
,Åsc, 6);

3063 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", %pM, keyÅype: %d, key id: %d,Åsc: %pm",

3064 
NETDEV_PR_ARG
, 
__íåy
->
addr
, __íåy->
key_ty≥
,

3065 
__íåy
->
key_id
, __íåy->
tsc
)

3068 
	`TRACE_EVENT
(
cfg80211_ªady_⁄_ch™√l
,

3069 
	`TP_PROTO
(
wúñess_dev
 *
wdev
, 
u64
 
cookõ
,

3070 
õì80211_ch™√l
 *
ch™
,

3071 
duøti⁄
),

3072 
	`TP_ARGS
(
wdev
, 
cookõ
, 
ch™
, 
duøti⁄
),

3073 
	`TP_STRUCT__íåy
(

3074 
WDEV_ENTRY


3075 
	$__fõld
(
u64
, 
cookõ
)

3076 
CHAN_ENTRY


3077 
	`__fõld
(, 
duøti⁄
)

3079 
	`TP_Á°_assign
(

3080 
WDEV_ASSIGN
;

3081 
__íåy
->
cookõ
 = cookie;

3082 
	`CHAN_ASSIGN
(
ch™
);

3083 
__íåy
->
duøti⁄
 = duration;

3085 
	`TP_¥ötk
(
WDEV_PR_FMT
 ", cookõ: %Œu, " 
CHAN_PR_FMT
 ", duration: %u",

3086 
WDEV_PR_ARG
, 
__íåy
->
cookõ
, 
CHAN_PR_ARG
,

3087 
__íåy
->
duøti⁄
)

3090 
	`TRACE_EVENT
(
cfg80211_ªady_⁄_ch™√l_expúed
,

3091 
	`TP_PROTO
(
wúñess_dev
 *
wdev
, 
u64
 
cookõ
,

3092 
õì80211_ch™√l
 *
ch™
),

3093 
	`TP_ARGS
(
wdev
, 
cookõ
, 
ch™
),

3094 
	`TP_STRUCT__íåy
(

3095 
WDEV_ENTRY


3096 
	$__fõld
(
u64
, 
cookõ
)

3097 
CHAN_ENTRY


3099 
	`TP_Á°_assign
(

3100 
WDEV_ASSIGN
;

3101 
__íåy
->
cookõ
 = cookie;

3102 
	`CHAN_ASSIGN
(
ch™
);

3104 
	`TP_¥ötk
(
WDEV_PR_FMT
 ", cookõ: %Œu, " 
CHAN_PR_FMT
,

3105 
WDEV_PR_ARG
, 
__íåy
->
cookõ
, 
CHAN_PR_ARG
)

3108 
	`TRACE_EVENT
(
cfg80211_tx_mgmt_expúed
,

3109 
	`TP_PROTO
(
wúñess_dev
 *
wdev
, 
u64
 
cookõ
,

3110 
õì80211_ch™√l
 *
ch™
),

3111 
	`TP_ARGS
(
wdev
, 
cookõ
, 
ch™
),

3112 
	`TP_STRUCT__íåy
(

3113 
WDEV_ENTRY


3114 
	$__fõld
(
u64
, 
cookõ
)

3115 
CHAN_ENTRY


3117 
	`TP_Á°_assign
(

3118 
WDEV_ASSIGN
;

3119 
__íåy
->
cookõ
 = cookie;

3120 
	`CHAN_ASSIGN
(
ch™
);

3122 
	`TP_¥ötk
(
WDEV_PR_FMT
 ", cookõ: %Œu, " 
CHAN_PR_FMT
,

3123 
WDEV_PR_ARG
, 
__íåy
->
cookõ
, 
CHAN_PR_ARG
)

3126 
	`TRACE_EVENT
(
cfg80211_√w_°a
,

3127 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
mac_addr
,

3128 
°©i⁄_öfo
 *
söfo
),

3129 
	`TP_ARGS
(
√tdev
, 
mac_addr
, 
söfo
),

3130 
	`TP_STRUCT__íåy
(

3131 
NETDEV_ENTRY


3132 
	$MAC_ENTRY
(
mac_addr
)

3133 
SINFO_ENTRY


3135 
	`TP_Á°_assign
(

3136 
NETDEV_ASSIGN
;

3137 
	`MAC_ASSIGN
(
mac_addr
, mac_addr);

3138 
SINFO_ASSIGN
;

3140 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", %pM",

3141 
NETDEV_PR_ARG
, 
__íåy
->
mac_addr
)

3144 
	`DEFINE_EVENT
(
cfg80211_√tdev_mac_evt
, 
cfg80211_dñ_°a
,

3145 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
maˇddr
),

3146 
	`TP_ARGS
(
√tdev
, 
maˇddr
)

3149 
	`TRACE_EVENT
(
cfg80211_rx_mgmt
,

3150 
	`TP_PROTO
(
wúñess_dev
 *
wdev
, 
cfg80211_rx_öfo
 *
öfo
),

3151 
	`TP_ARGS
(
wdev
, 
öfo
),

3152 
	`TP_STRUCT__íåy
(

3153 
WDEV_ENTRY


3154 
	$__fõld
(, 
‰eq
)

3155 
	`__fõld
(, 
sig_dbm
)

3157 
	`TP_Á°_assign
(

3158 
WDEV_ASSIGN
;

3159 
__íåy
->
‰eq
 = 
öfo
->freq;

3160 
__íåy
->
sig_dbm
 = 
öfo
->sig_dbm;

3162 
	`TP_¥ötk
(
WDEV_PR_FMT
 ", fªq: "
KHZ_F
", sig dbm: %d",

3163 
WDEV_PR_ARG
, 
	`PR_KHZ
(
__íåy
->
‰eq
), __íåy->
sig_dbm
)

3166 
	`TRACE_EVENT
(
cfg80211_mgmt_tx_°©us
,

3167 
	`TP_PROTO
(
wúñess_dev
 *
wdev
, 
u64
 
cookõ
, 
boﬁ
 
ack
),

3168 
	`TP_ARGS
(
wdev
, 
cookõ
, 
ack
),

3169 
	`TP_STRUCT__íåy
(

3170 
WDEV_ENTRY


3171 
	$__fõld
(
u64
, 
cookõ
)

3172 
	`__fõld
(
boﬁ
, 
ack
)

3174 
	`TP_Á°_assign
(

3175 
WDEV_ASSIGN
;

3176 
__íåy
->
cookõ
 = cookie;

3177 
__íåy
->
ack
 =áck;

3179 
	`TP_¥ötk
(
WDEV_PR_FMT
", cookie: %llu,áck: %s",

3180 
WDEV_PR_ARG
, 
__íåy
->
cookõ
, 
	`BOOL_TO_STR
(__íåy->
ack
))

3183 
	`TRACE_EVENT
(
cfg80211_c⁄åﬁ_p‹t_tx_°©us
,

3184 
	`TP_PROTO
(
wúñess_dev
 *
wdev
, 
u64
 
cookõ
, 
boﬁ
 
ack
),

3185 
	`TP_ARGS
(
wdev
, 
cookõ
, 
ack
),

3186 
	`TP_STRUCT__íåy
(

3187 
WDEV_ENTRY


3188 
	$__fõld
(
u64
, 
cookõ
)

3189 
	`__fõld
(
boﬁ
, 
ack
)

3191 
	`TP_Á°_assign
(

3192 
WDEV_ASSIGN
;

3193 
__íåy
->
cookõ
 = cookie;

3194 
__íåy
->
ack
 =áck;

3196 
	`TP_¥ötk
(
WDEV_PR_FMT
", cookie: %llu,áck: %s",

3197 
WDEV_PR_ARG
, 
__íåy
->
cookõ
, 
	`BOOL_TO_STR
(__íåy->
ack
))

3200 
	`TRACE_EVENT
(
cfg80211_rx_c⁄åﬁ_p‹t
,

3201 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, 
sk_buff
 *
skb
,

3202 
boﬁ
 
u√n¸y±ed
, 
lök_id
),

3203 
	`TP_ARGS
(
√tdev
, 
skb
, 
u√n¸y±ed
, 
lök_id
),

3204 
	`TP_STRUCT__íåy
(

3205 
NETDEV_ENTRY


3206 
	$__fõld
(, 
Àn
)

3207 
	$MAC_ENTRY
(
‰om
)

3208 
	$__fõld
(
u16
, 
¥Ÿo
)

3209 
	$__fõld
(
boﬁ
, 
u√n¸y±ed
)

3210 
	`__fõld
(, 
lök_id
)

3212 
	`TP_Á°_assign
(

3213 
NETDEV_ASSIGN
;

3214 
__íåy
->
Àn
 = 
skb
->len;

3215 
	`MAC_ASSIGN
(
‰om
, 
	`ëh_hdr
(
skb
)->
h_sour˚
);

3216 
__íåy
->
¥Ÿo
 = 
	`be16_to_˝u
(
skb
->
¥Ÿocﬁ
);

3217 
__íåy
->
u√n¸y±ed
 = unencrypted;

3218 
__íåy
->
lök_id
 =Üink_id;

3220 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ",Üen=%d, %pM,Öroto: 0x%x, unencrypted: %s,Üink: %d",

3221 
NETDEV_PR_ARG
, 
__íåy
->
Àn
, __íåy->
‰om
,

3222 
__íåy
->
¥Ÿo
, 
	`BOOL_TO_STR
(__íåy->
u√n¸y±ed
),

3223 
__íåy
->
lök_id
)

3226 
	`TRACE_EVENT
(
cfg80211_cqm_rssi_nŸify
,

3227 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
,

3228 
∆80211_cqm_rssi_thªshﬁd_evít
 
rssi_evít
,

3229 
s32
 
rssi_Àvñ
),

3230 
	`TP_ARGS
(
√tdev
, 
rssi_evít
, 
rssi_Àvñ
),

3231 
	`TP_STRUCT__íåy
(

3232 
NETDEV_ENTRY


3233 
	$__fõld
(
∆80211_cqm_rssi_thªshﬁd_evít
, 
rssi_evít
)

3234 
	`__fõld
(
s32
, 
rssi_Àvñ
)

3236 
	`TP_Á°_assign
(

3237 
NETDEV_ASSIGN
;

3238 
__íåy
->
rssi_evít
 =Ñssi_event;

3239 
__íåy
->
rssi_Àvñ
 =Ñssi_level;

3241 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ",ÑssiÉvent: %d,Üevel: %d",

3242 
NETDEV_PR_ARG
, 
__íåy
->
rssi_evít
, __íåy->
rssi_Àvñ
)

3245 
	`TRACE_EVENT
(
cfg80211_ªg_ˇn_bóc⁄
,

3246 
	`TP_PROTO
(
wùhy
 *wùhy, 
cfg80211_ch™_def
 *
ch™def
,

3247 
∆80211_i·y≥
 
i·y≥
, 
boﬁ
 
check_no_ú
),

3248 
	`TP_ARGS
(
wùhy
, 
ch™def
, 
i·y≥
, 
check_no_ú
),

3249 
	`TP_STRUCT__íåy
(

3250 
WIPHY_ENTRY


3251 
CHAN_DEF_ENTRY


3252 
	$__fõld
(
∆80211_i·y≥
, 
i·y≥
)

3253 
	`__fõld
(
boﬁ
, 
check_no_ú
)

3255 
	`TP_Á°_assign
(

3256 
WIPHY_ASSIGN
;

3257 
	`CHAN_DEF_ASSIGN
(
ch™def
);

3258 
__íåy
->
i·y≥
 = iftype;

3259 
__íåy
->
check_no_ú
 = check_no_ir;

3261 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
CHAN_DEF_PR_FMT
 ", iftype=%d check_no_ir=%s",

3262 
WIPHY_PR_ARG
, 
CHAN_DEF_PR_ARG
, 
__íåy
->
i·y≥
,

3263 
	`BOOL_TO_STR
(
__íåy
->
check_no_ú
))

3266 
	`TRACE_EVENT
(
cfg80211_ch™def_dfs_ªquúed
,

3267 
	`TP_PROTO
(
wùhy
 *wùhy, 
cfg80211_ch™_def
 *
ch™def
),

3268 
	`TP_ARGS
(
wùhy
, 
ch™def
),

3269 
	`TP_STRUCT__íåy
(

3270 
WIPHY_ENTRY


3271 
CHAN_DEF_ENTRY


3273 
	`TP_Á°_assign
(

3274 
WIPHY_ASSIGN
;

3275 
	`CHAN_DEF_ASSIGN
(
ch™def
);

3277 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
CHAN_DEF_PR_FMT
,

3278 
WIPHY_PR_ARG
, 
CHAN_DEF_PR_ARG
)

3281 
	`TRACE_EVENT
(
cfg80211_ch_swôch_nŸify
,

3282 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
,

3283 
cfg80211_ch™_def
 *
ch™def
,

3284 
lök_id
),

3285 
	`TP_ARGS
(
√tdev
, 
ch™def
, 
lök_id
),

3286 
	`TP_STRUCT__íåy
(

3287 
NETDEV_ENTRY


3288 
CHAN_DEF_ENTRY


3289 
	`__fõld
(, 
lök_id
)

3291 
	`TP_Á°_assign
(

3292 
NETDEV_ASSIGN
;

3293 
	`CHAN_DEF_ASSIGN
(
ch™def
);

3294 
__íåy
->
lök_id
 =Üink_id;

3296 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", " 
CHAN_DEF_PR_FMT
 ",Üink:%d",

3297 
NETDEV_PR_ARG
, 
CHAN_DEF_PR_ARG
, 
__íåy
->
lök_id
)

3300 
	`TRACE_EVENT
(
cfg80211_ch_swôch_°¨ãd_nŸify
,

3301 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
,

3302 
cfg80211_ch™_def
 *
ch™def
,

3303 
lök_id
),

3304 
	`TP_ARGS
(
√tdev
, 
ch™def
, 
lök_id
),

3305 
	`TP_STRUCT__íåy
(

3306 
NETDEV_ENTRY


3307 
CHAN_DEF_ENTRY


3308 
	`__fõld
(, 
lök_id
)

3310 
	`TP_Á°_assign
(

3311 
NETDEV_ASSIGN
;

3312 
	`CHAN_DEF_ASSIGN
(
ch™def
);

3313 
__íåy
->
lök_id
 =Üink_id;

3315 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", " 
CHAN_DEF_PR_FMT
 ",Üink:%d",

3316 
NETDEV_PR_ARG
, 
CHAN_DEF_PR_ARG
, 
__íåy
->
lök_id
)

3319 
	`TRACE_EVENT
(
cfg80211_ød¨_evít
,

3320 
	`TP_PROTO
(
wùhy
 *wùhy, 
cfg80211_ch™_def
 *
ch™def
,

3321 
boﬁ
 
offch™
),

3322 
	`TP_ARGS
(
wùhy
, 
ch™def
, 
offch™
),

3323 
	`TP_STRUCT__íåy
(

3324 
WIPHY_ENTRY


3325 
CHAN_DEF_ENTRY


3326 
	`__fõld
(
boﬁ
, 
offch™
)

3328 
	`TP_Á°_assign
(

3329 
WIPHY_ASSIGN
;

3330 
	`CHAN_DEF_ASSIGN
(
ch™def
);

3331 
__íåy
->
offch™
 = offchan;

3333 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
CHAN_DEF_PR_FMT
 ", offchan %d",

3334 
WIPHY_PR_ARG
, 
CHAN_DEF_PR_ARG
, 
__íåy
->
offch™
)

3337 
	`TRACE_EVENT
(
cfg80211_ˇc_evít
,

3338 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, 
∆80211_ød¨_evít
 
evt
),

3339 
	`TP_ARGS
(
√tdev
, 
evt
),

3340 
	`TP_STRUCT__íåy
(

3341 
NETDEV_ENTRY


3342 
	`__fõld
(
∆80211_ød¨_evít
, 
evt
)

3344 
	`TP_Á°_assign
(

3345 
NETDEV_ASSIGN
;

3346 
__íåy
->
evt
 =Évt;

3348 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ",Évent: %d",

3349 
NETDEV_PR_ARG
, 
__íåy
->
evt
)

3352 
	`DECLARE_EVENT_CLASS
(
cfg80211_rx_evt
,

3353 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
addr
),

3354 
	`TP_ARGS
(
√tdev
, 
addr
),

3355 
	`TP_STRUCT__íåy
(

3356 
NETDEV_ENTRY


3357 
	`MAC_ENTRY
(
addr
)

3359 
	`TP_Á°_assign
(

3360 
NETDEV_ASSIGN
;

3361 
	`MAC_ASSIGN
(
addr
,áddr);

3363 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", %pM", 
NETDEV_PR_ARG
, 
__íåy
->
addr
)

3366 
	`DEFINE_EVENT
(
cfg80211_rx_evt
, 
cfg80211_rx_•urious_‰ame
,

3367 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
addr
),

3368 
	`TP_ARGS
(
√tdev
, 
addr
)

3371 
	`DEFINE_EVENT
(
cfg80211_rx_evt
, 
cfg80211_rx_u√x≥˘ed_4addr_‰ame
,

3372 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
addr
),

3373 
	`TP_ARGS
(
√tdev
, 
addr
)

3376 
	`TRACE_EVENT
(
cfg80211_ibss_joöed
,

3377 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
bssid
,

3378 
õì80211_ch™√l
 *
ch™√l
),

3379 
	`TP_ARGS
(
√tdev
, 
bssid
, 
ch™√l
),

3380 
	`TP_STRUCT__íåy
(

3381 
NETDEV_ENTRY


3382 
	$MAC_ENTRY
(
bssid
)

3383 
CHAN_ENTRY


3385 
	`TP_Á°_assign
(

3386 
NETDEV_ASSIGN
;

3387 
	`MAC_ASSIGN
(
bssid
, bssid);

3388 
	`CHAN_ASSIGN
(
ch™√l
);

3390 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", bssid: %pM, " 
CHAN_PR_FMT
,

3391 
NETDEV_PR_ARG
, 
__íåy
->
bssid
, 
CHAN_PR_ARG
)

3394 
	`TRACE_EVENT
(
cfg80211_¥obe_°©us
,

3395 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
addr
, 
u64
 
cookõ
,

3396 
boﬁ
 
acked
),

3397 
	`TP_ARGS
(
√tdev
, 
addr
, 
cookõ
, 
acked
),

3398 
	`TP_STRUCT__íåy
(

3399 
NETDEV_ENTRY


3400 
	$MAC_ENTRY
(
addr
)

3401 
	$__fõld
(
u64
, 
cookõ
)

3402 
	`__fõld
(
boﬁ
, 
acked
)

3404 
	`TP_Á°_assign
(

3405 
NETDEV_ASSIGN
;

3406 
	`MAC_ASSIGN
(
addr
,áddr);

3407 
__íåy
->
cookõ
 = cookie;

3408 
__íåy
->
acked
 =ácked;

3410 
	`TP_¥ötk
(
NETDEV_PR_FMT
 "áddr:%pM, cookie: %llu,ácked: %s",

3411 
NETDEV_PR_ARG
, 
__íåy
->
addr
, __íåy->
cookõ
,

3412 
	`BOOL_TO_STR
(
__íåy
->
acked
))

3415 
	`TRACE_EVENT
(
cfg80211_cqm_pkéoss_nŸify
,

3416 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
≥î
, 
u32
 
num_∑ckës
),

3417 
	`TP_ARGS
(
√tdev
, 
≥î
, 
num_∑ckës
),

3418 
	`TP_STRUCT__íåy
(

3419 
NETDEV_ENTRY


3420 
	$MAC_ENTRY
(
≥î
)

3421 
	`__fõld
(
u32
, 
num_∑ckës
)

3423 
	`TP_Á°_assign
(

3424 
NETDEV_ASSIGN
;

3425 
	`MAC_ASSIGN
(
≥î
,Öeer);

3426 
__íåy
->
num_∑ckës
 =Çum_packets;

3428 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ",Öeer: %pM,Çum ofÜostÖackets: %u",

3429 
NETDEV_PR_ARG
, 
__íåy
->
≥î
, __íåy->
num_∑ckës
)

3432 
	`DEFINE_EVENT
(
cfg80211_√tdev_mac_evt
, 
cfg80211_gtk_ªkey_nŸify
,

3433 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
maˇddr
),

3434 
	`TP_ARGS
(
√tdev
, 
maˇddr
)

3437 
	`TRACE_EVENT
(
cfg80211_pmkß_ˇndid©e_nŸify
,

3438 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, 
ödex
, c⁄° 
u8
 *
bssid
,

3439 
boﬁ
 
¥óuth
),

3440 
	`TP_ARGS
(
√tdev
, 
ödex
, 
bssid
, 
¥óuth
),

3441 
	`TP_STRUCT__íåy
(

3442 
NETDEV_ENTRY


3443 
	$__fõld
(, 
ödex
)

3444 
	$MAC_ENTRY
(
bssid
)

3445 
	`__fõld
(
boﬁ
, 
¥óuth
)

3447 
	`TP_Á°_assign
(

3448 
NETDEV_ASSIGN
;

3449 
__íåy
->
ödex
 = index;

3450 
	`MAC_ASSIGN
(
bssid
, bssid);

3451 
__íåy
->
¥óuth
 =Öreauth;

3453 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", index:%d, bssid: %pM,Öreáuth: %s",

3454 
NETDEV_PR_ARG
, 
__íåy
->
ödex
, __íåy->
bssid
,

3455 
	`BOOL_TO_STR
(
__íåy
->
¥óuth
))

3458 
	`TRACE_EVENT
(
cfg80211_ªp‹t_obss_bóc⁄
,

3459 
	`TP_PROTO
(
wùhy
 *wùhy, c⁄° 
u8
 *
‰ame
, 
size_t
 
Àn
,

3460 
‰eq
, 
sig_dbm
),

3461 
	`TP_ARGS
(
wùhy
, 
‰ame
, 
Àn
, 
‰eq
, 
sig_dbm
),

3462 
	`TP_STRUCT__íåy
(

3463 
WIPHY_ENTRY


3464 
	$__fõld
(, 
‰eq
)

3465 
	`__fõld
(, 
sig_dbm
)

3467 
	`TP_Á°_assign
(

3468 
WIPHY_ASSIGN
;

3469 
__íåy
->
‰eq
 = freq;

3470 
__íåy
->
sig_dbm
 = sig_dbm;

3472 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", fªq: "
KHZ_F
", sig_dbm: %d",

3473 
WIPHY_PR_ARG
, 
	`PR_KHZ
(
__íåy
->
‰eq
), __íåy->
sig_dbm
)

3476 
	`TRACE_EVENT
(
cfg80211_tdls_›î_ªque°
,

3477 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
, c⁄° 
u8
 *
≥î
,

3478 
∆80211_tdls_›î©i⁄
 
›î
, 
u16
 
ªas⁄_code
),

3479 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
≥î
, 
›î
, 
ªas⁄_code
),

3480 
	`TP_STRUCT__íåy
(

3481 
WIPHY_ENTRY


3482 
NETDEV_ENTRY


3483 
	$MAC_ENTRY
(
≥î
)

3484 
	$__fõld
(
∆80211_tdls_›î©i⁄
, 
›î
)

3485 
	`__fõld
(
u16
, 
ªas⁄_code
)

3487 
	`TP_Á°_assign
(

3488 
WIPHY_ASSIGN
;

3489 
NETDEV_ASSIGN
;

3490 
	`MAC_ASSIGN
(
≥î
,Öeer);

3491 
__íåy
->
›î
 = oper;

3492 
__íåy
->
ªas⁄_code
 =Ñeason_code;

3494 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Öeer: %pM, oper: %d,Ñeason_code %u",

3495 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
≥î
, __íåy->
›î
,

3496 
__íåy
->
ªas⁄_code
)

3499 
	`TRACE_EVENT
(
cfg80211_sˇn_d⁄e
,

3500 
	`TP_PROTO
(
cfg80211_sˇn_ªque°
 *
ªque°
,

3501 
cfg80211_sˇn_öfo
 *
öfo
),

3502 
	`TP_ARGS
(
ªque°
, 
öfo
),

3503 
	`TP_STRUCT__íåy
(

3504 
	$__fõld
(
u32
, 
n_ch™√ls
)

3505 
	`__dy«mic_¨øy
(
u8
, 
õ
, 
ªque°
 ?Ñeque°->
õ_Àn
 : 0)

3506 
	$__¨øy
(
u32
, 
øãs
, 
NUM_NL80211_BANDS
)

3507 
	$__fõld
(
u32
, 
wdev_id
)

3508 
	$MAC_ENTRY
(
wùhy_mac
)

3509 
	$__fõld
(
boﬁ
, 
no_cck
)

3510 
	$__fõld
(
boﬁ
, 
ab‹ãd
)

3511 
	$__fõld
(
u64
, 
sˇn_°¨t_tsf
)

3512 
	`MAC_ENTRY
(
tsf_bssid
)

3514 
	`TP_Á°_assign
(

3515 i‡(
ªque°
) {

3516 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
õ
), 
ªque°
->ie,

3517 
ªque°
->
õ_Àn
);

3518 
	`mem˝y
(
__íåy
->
øãs
, 
ªque°
->rates,

3519 
NUM_NL80211_BANDS
);

3520 
__íåy
->
wdev_id
 = 
ªque°
->
wdev
 ?

3521 
ªque°
->
wdev
->
idítifõr
 : 0;

3522 i‡(
ªque°
->
wùhy
)

3523 
	`MAC_ASSIGN
(
wùhy_mac
,

3524 
ªque°
->
wùhy
->
≥rm_addr
);

3525 
__íåy
->
no_cck
 = 
ªque°
->no_cck;

3526 
	}
}

3527 i‡(
	göfo
) {

3528 
	g__íåy
->
	gab‹ãd
 = 
öfo
->
ab‹ãd
;

3529 
	g__íåy
->
	gsˇn_°¨t_tsf
 = 
öfo
->
sˇn_°¨t_tsf
;

3530 
MAC_ASSIGN
(
tsf_bssid
, 
öfo
->tsf_bssid);

3533 
TP_¥ötk
("aborted: %s, scan start (TSF): %llu,Åsf_bssid: %pM",

3534 
BOOL_TO_STR
(
__íåy
->
ab‹ãd
),

3535 ()
__íåy
->
sˇn_°¨t_tsf
,

3536 
__íåy
->
tsf_bssid
)

3539 
DECLARE_EVENT_CLASS
(
wùhy_id_evt
,

3540 
TP_PROTO
(
wùhy
 *wùhy, 
u64
 
id
),

3541 
TP_ARGS
(
wùhy
, 
id
),

3542 
TP_STRUCT__íåy
(

3543 
WIPHY_ENTRY


3544 
__fõld
(
u64
, 
id
)

3546 
TP_Á°_assign
(

3547 
WIPHY_ASSIGN
;

3548 
__íåy
->
id
 = id;

3550 
TP_¥ötk
(
WIPHY_PR_FMT
 ", id: %Œu", 
WIPHY_PR_ARG
, 
__íåy
->
id
)

3553 
DEFINE_EVENT
(
wùhy_id_evt
, 
cfg80211_sched_sˇn_°›≥d
,

3554 
TP_PROTO
(
wùhy
 *wùhy, 
u64
 
id
),

3555 
TP_ARGS
(
wùhy
, 
id
)

3558 
DEFINE_EVENT
(
wùhy_id_evt
, 
cfg80211_sched_sˇn_ªsu…s
,

3559 
TP_PROTO
(
wùhy
 *wùhy, 
u64
 
id
),

3560 
TP_ARGS
(
wùhy
, 
id
)

3563 
TRACE_EVENT
(
cfg80211_gë_bss
,

3564 
TP_PROTO
(
wùhy
 *wùhy, 
õì80211_ch™√l
 *
ch™√l
,

3565 c⁄° 
u8
 *
bssid
, c⁄° u8 *
ssid
, 
size_t
 
ssid_Àn
,

3566 
õì80211_bss_ty≥
 
bss_ty≥
,

3567 
õì80211_¥ivacy
 
¥ivacy
),

3568 
TP_ARGS
(
wùhy
, 
ch™√l
, 
bssid
, 
ssid
, 
ssid_Àn
, 
bss_ty≥
, 
¥ivacy
),

3569 
TP_STRUCT__íåy
(

3570 
WIPHY_ENTRY


3571 
CHAN_ENTRY


3572 
	$MAC_ENTRY
(
bssid
)

3573 
	$__dy«mic_¨øy
(
u8
, 
ssid
, 
ssid_Àn
)

3574 
	$__fõld
(
õì80211_bss_ty≥
, 
bss_ty≥
)

3575 
	`__fõld
(
õì80211_¥ivacy
, 
¥ivacy
)

3577 
	`TP_Á°_assign
(

3578 
WIPHY_ASSIGN
;

3579 
	`CHAN_ASSIGN
(
ch™√l
);

3580 
	`MAC_ASSIGN
(
bssid
, bssid);

3581 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
ssid
), ssid, 
ssid_Àn
);

3582 
__íåy
->
bss_ty≥
 = bss_type;

3583 
__íåy
->
¥ivacy
 =Örivacy;

3585 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
CHAN_PR_FMT
 ", %pM"

3587 
WIPHY_PR_ARG
, 
CHAN_PR_ARG
, 
__íåy
->
bssid
,

3588 ((
u8
 *)
	`__gë_dy«mic_¨øy
(
ssid
))[0], 
__íåy
->
bss_ty≥
,

3589 
__íåy
->
¥ivacy
)

3592 
	`TRACE_EVENT
(
cfg80211_öf‹m_bss_‰ame
,

3593 
	`TP_PROTO
(
wùhy
 *wùhy, 
cfg80211_öf‹m_bss
 *
d©a
,

3594 
õì80211_mgmt
 *
mgmt
, 
size_t
 
Àn
),

3595 
	`TP_ARGS
(
wùhy
, 
d©a
, 
mgmt
, 
Àn
),

3596 
	`TP_STRUCT__íåy
(

3597 
WIPHY_ENTRY


3598 
CHAN_ENTRY


3599 
	$__dy«mic_¨øy
(
u8
, 
mgmt
, 
Àn
)

3600 
	$__fõld
(
s32
, 
sig«l
)

3601 
	$__fõld
(
u64
, 
ts_boŸtime
)

3602 
	$__fõld
(
u64
, 
∑ª¡_tsf
)

3603 
	`MAC_ENTRY
(
∑ª¡_bssid
)

3605 
	`TP_Á°_assign
(

3606 
WIPHY_ASSIGN
;

3607 
	`CHAN_ASSIGN
(
d©a
->
ch™
);

3608 i‡(
mgmt
)

3609 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
mgmt
), mgmt, 
Àn
);

3610 
__íåy
->
sig«l
 = 
d©a
->signal;

3611 
__íåy
->
ts_boŸtime
 = 
d©a
->
boŸtime_ns
;

3612 
__íåy
->
∑ª¡_tsf
 = 
d©a
->parent_tsf;

3613 
	`MAC_ASSIGN
(
∑ª¡_bssid
, 
d©a
->parent_bssid);

3615 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
CHAN_PR_FMT


3617 
WIPHY_PR_ARG
, 
CHAN_PR_ARG
,

3618 
__íåy
->
sig«l
, ()__íåy->
ts_boŸtime
,

3619 ()
__íåy
->
∑ª¡_tsf
,

3620 
__íåy
->
∑ª¡_bssid
)

3623 
	`DECLARE_EVENT_CLASS
(
cfg80211_bss_evt
,

3624 
	`TP_PROTO
(
cfg80211_bss
 *
pub
),

3625 
	`TP_ARGS
(
pub
),

3626 
	`TP_STRUCT__íåy
(

3627 
	$MAC_ENTRY
(
bssid
)

3628 
CHAN_ENTRY


3630 
	`TP_Á°_assign
(

3631 
	`MAC_ASSIGN
(
bssid
, 
pub
->bssid);

3632 
	`CHAN_ASSIGN
(
pub
->
ch™√l
);

3634 
	`TP_¥ötk
("%pM, " 
CHAN_PR_FMT
, 
__íåy
->
bssid
, 
CHAN_PR_ARG
)

3637 
	`DEFINE_EVENT
(
cfg80211_bss_evt
, 
cfg80211_ªtu∫_bss
,

3638 
	`TP_PROTO
(
cfg80211_bss
 *
pub
),

3639 
	`TP_ARGS
(
pub
)

3642 
	`TRACE_EVENT
(
cfg80211_ªtu∫_uöt
,

3643 
	`TP_PROTO
(
ªt
),

3644 
	`TP_ARGS
(
ªt
),

3645 
	`TP_STRUCT__íåy
(

3646 
	`__fõld
(, 
ªt
)

3648 
	`TP_Á°_assign
(

3649 
__íåy
->
ªt
 =Ñet;

3651 
	`TP_¥ötk
("ªt: %d", 
__íåy
->
ªt
)

3654 
	`TRACE_EVENT
(
cfg80211_ªtu∫_u32
,

3655 
	`TP_PROTO
(
u32
 
ªt
),

3656 
	`TP_ARGS
(
ªt
),

3657 
	`TP_STRUCT__íåy
(

3658 
	`__fõld
(
u32
, 
ªt
)

3660 
	`TP_Á°_assign
(

3661 
__íåy
->
ªt
 =Ñet;

3663 
	`TP_¥ötk
("ªt: %u", 
__íåy
->
ªt
)

3666 
	`TRACE_EVENT
(
cfg80211_ªp‹t_wowœn_wakeup
,

3667 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

3668 
cfg80211_wowœn_wakeup
 *
wakeup
),

3669 
	`TP_ARGS
(
wùhy
, 
wdev
, 
wakeup
),

3670 
	`TP_STRUCT__íåy
(

3671 
WIPHY_ENTRY


3672 
WDEV_ENTRY


3673 
	$__fõld
(
boﬁ
, 
n⁄_wúñess
)

3674 
	$__fõld
(
boﬁ
, 
disc⁄√˘
)

3675 
	$__fõld
(
boﬁ
, 
magic_pkt
)

3676 
	$__fõld
(
boﬁ
, 
gtk_ªkey_Áûuª
)

3677 
	$__fõld
(
boﬁ
, 
óp_idítôy_ªq
)

3678 
	$__fõld
(
boﬁ
, 
four_way_h™dshake
)

3679 
	$__fõld
(
boﬁ
, 
rfkûl_ªÀa£
)

3680 
	$__fõld
(
s32
, 
∑âîn_idx
)

3681 
	$__fõld
(
u32
, 
∑ckë_Àn
)

3682 
	`__dy«mic_¨øy
(
u8
, 
∑ckë
,

3683 
wakeup
 ? wakeup->
∑ckë_¥e£¡_Àn
 : 0)

3685 
	`TP_Á°_assign
(

3686 
WIPHY_ASSIGN
;

3687 
WDEV_ASSIGN
;

3688 
__íåy
->
n⁄_wúñess
 = !
wakeup
;

3689 
__íåy
->
disc⁄√˘
 = 
wakeup
 ? wakeup->disc⁄√˘ : 
Ál£
;

3690 
__íåy
->
magic_pkt
 = 
wakeup
 ? wakeup->magic_pkà: 
Ál£
;

3691 
__íåy
->
gtk_ªkey_Áûuª
 = 
wakeup
 ? wakeup->gtk_ªkey_Áûuª : 
Ál£
;

3692 
__íåy
->
óp_idítôy_ªq
 = 
wakeup
 ? wakeup->óp_idítôy_ªq : 
Ál£
;

3693 
__íåy
->
four_way_h™dshake
 = 
wakeup
 ? wakeup->four_way_h™dshakê: 
Ál£
;

3694 
__íåy
->
rfkûl_ªÀa£
 = 
wakeup
 ? wakeup->rfkûl_ªÀa£ : 
Ál£
;

3695 
__íåy
->
∑âîn_idx
 = 
wakeup
 ? wakeup->∑âîn_idx : 
Ál£
;

3696 
__íåy
->
∑ckë_Àn
 = 
wakeup
 ? wakeup->∑ckë_À¿: 
Ál£
;

3697 i‡(
wakeup
 && wakeup->
∑ckë
 && wakeup->
∑ckë_¥e£¡_Àn
)

3698 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
∑ckë
), 
wakeup
->packet,

3699 
wakeup
->
∑ckë_¥e£¡_Àn
);

3701 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
, 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
)

3704 
	`TRACE_EVENT
(
cfg80211_·_evít
,

3705 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

3706 
cfg80211_·_evít_∑øms
 *
·_evít
),

3707 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
·_evít
),

3708 
	`TP_STRUCT__íåy
(

3709 
WIPHY_ENTRY


3710 
NETDEV_ENTRY


3711 
	`__dy«mic_¨øy
(
u8
, 
õs
, 
·_evít
->
õs_Àn
)

3712 
	$MAC_ENTRY
(
èrgë_≠
)

3713 
	`__dy«mic_¨øy
(
u8
, 
ric_õs
, 
·_evít
->
ric_õs_Àn
)

3715 
	`TP_Á°_assign
(

3716 
WIPHY_ASSIGN
;

3717 
NETDEV_ASSIGN
;

3718 i‡(
·_evít
->
õs
)

3719 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
õs
), 
·_evít
->ies,

3720 
·_evít
->
õs_Àn
);

3721 
	`MAC_ASSIGN
(
èrgë_≠
, 
·_evít
->target_ap);

3722 i‡(
·_evít
->
ric_õs
)

3723 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
ric_õs
), 
·_evít
->ric_ies,

3724 
·_evít
->
ric_õs_Àn
);

3726 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Åarget_ap: %pM",

3727 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
èrgë_≠
)

3730 
	`TRACE_EVENT
(
cfg80211_°›_iÁ˚
,

3731 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
),

3732 
	`TP_ARGS
(
wùhy
, 
wdev
),

3733 
	`TP_STRUCT__íåy
(

3734 
WIPHY_ENTRY


3735 
WDEV_ENTRY


3737 
	`TP_Á°_assign
(

3738 
WIPHY_ASSIGN
;

3739 
WDEV_ASSIGN
;

3741 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
,

3742 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
)

3745 
	`TRACE_EVENT
(
cfg80211_pm§_ªp‹t
,

3746 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
,

3747 
u64
 
cookõ
, c⁄° 
u8
 *
addr
),

3748 
	`TP_ARGS
(
wùhy
, 
wdev
, 
cookõ
, 
addr
),

3749 
	`TP_STRUCT__íåy
(

3750 
WIPHY_ENTRY


3751 
WDEV_ENTRY


3752 
	$__fõld
(
u64
, 
cookõ
)

3753 
	`MAC_ENTRY
(
addr
)

3755 
	`TP_Á°_assign
(

3756 
WIPHY_ASSIGN
;

3757 
WDEV_ASSIGN
;

3758 
__íåy
->
cookõ
 = cookie;

3759 
	`MAC_ASSIGN
(
addr
,áddr);

3761 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ", cookie:%lld, %pM",

3762 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
,

3763 ()
__íåy
->
cookõ
,

3764 
__íåy
->
addr
)

3767 
	`TRACE_EVENT
(
cfg80211_pm§_com∂ëe
,

3768 
	`TP_PROTO
(
wùhy
 *wùhy, 
wúñess_dev
 *
wdev
, 
u64
 
cookõ
),

3769 
	`TP_ARGS
(
wùhy
, 
wdev
, 
cookõ
),

3770 
	`TP_STRUCT__íåy
(

3771 
WIPHY_ENTRY


3772 
WDEV_ENTRY


3773 
	`__fõld
(
u64
, 
cookõ
)

3775 
	`TP_Á°_assign
(

3776 
WIPHY_ASSIGN
;

3777 
WDEV_ASSIGN
;

3778 
__íåy
->
cookõ
 = cookie;

3780 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
WDEV_PR_FMT
 ", cookie:%lld",

3781 
WIPHY_PR_ARG
, 
WDEV_PR_ARG
,

3782 ()
__íåy
->
cookõ
)

3785 
	`TRACE_EVENT
(
cfg80211_upd©e_owe_öfo_evít
,

3786 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

3787 
cfg80211_upd©e_owe_öfo
 *
owe_öfo
),

3788 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
owe_öfo
),

3789 
	`TP_STRUCT__íåy
(

3790 
WIPHY_ENTRY


3791 
NETDEV_ENTRY


3792 
	$MAC_ENTRY
(
≥î
)

3793 
	`__dy«mic_¨øy
(
u8
, 
õ
, 
owe_öfo
->
õ_Àn
)

3794 
	$__fõld
(, 
assoc_lök_id
)

3795 
	`MAC_ENTRY
(
≥î_mld_addr
)

3797 
	`TP_Á°_assign
(

3798 
WIPHY_ASSIGN
;

3799 
NETDEV_ASSIGN
;

3800 
	`MAC_ASSIGN
(
≥î
, 
owe_öfo
->peer);

3801 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
õ
), 
owe_öfo
->ie,

3802 
owe_öfo
->
õ_Àn
);

3803 
__íåy
->
assoc_lök_id
 = 
owe_öfo
->assoc_link_id;

3804 
	`MAC_ASSIGN
(
≥î_mld_addr
, 
owe_öfo
->peer_mld_addr);

3806 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ",Öeer: %pM,"

3808 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
≥î
,

3809 
__íåy
->
assoc_lök_id
, __íåy->
≥î_mld_addr
)

3812 
	`TRACE_EVENT
(
cfg80211_bss_cﬁ‹_nŸify
,

3813 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
,

3814 
∆80211_comm™ds
 
cmd
,

3815 
u8
 
cou¡
, 
u64
 
cﬁ‹_bôm≠
),

3816 
	`TP_ARGS
(
√tdev
, 
cmd
, 
cou¡
, 
cﬁ‹_bôm≠
),

3817 
	`TP_STRUCT__íåy
(

3818 
NETDEV_ENTRY


3819 
	$__fõld
(
u32
, 
cmd
)

3820 
	$__fõld
(
u8
, 
cou¡
)

3821 
	`__fõld
(
u64
, 
cﬁ‹_bôm≠
)

3823 
	`TP_Á°_assign
(

3824 
NETDEV_ASSIGN
;

3825 
__íåy
->
cmd
 = cmd;

3826 
__íåy
->
cou¡
 = count;

3827 
__íåy
->
cﬁ‹_bôm≠
 = color_bitmap;

3829 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ", cmd: %x, count: %u, bitmap: %llx",

3830 
NETDEV_PR_ARG
, 
__íåy
->
cmd
, __íåy->
cou¡
,

3831 
__íåy
->
cﬁ‹_bôm≠
)

3834 
	`TRACE_EVENT
(
cfg80211_assoc_comeback
,

3835 
	`TP_PROTO
(
wúñess_dev
 *
wdev
, c⁄° 
u8
 *
≠_addr
, 
u32
 
timeout
),

3836 
	`TP_ARGS
(
wdev
, 
≠_addr
, 
timeout
),

3837 
	`TP_STRUCT__íåy
(

3838 
WDEV_ENTRY


3839 
	$MAC_ENTRY
(
≠_addr
)

3840 
	`__fõld
(
u32
, 
timeout
)

3842 
	`TP_Á°_assign
(

3843 
WDEV_ASSIGN
;

3844 
	`MAC_ASSIGN
(
≠_addr
,áp_addr);

3845 
__íåy
->
timeout
 =Åimeout;

3847 
	`TP_¥ötk
(
WDEV_PR_FMT
 ", %pM,Åimeout: %u TUs",

3848 
WDEV_PR_ARG
, 
__íåy
->
≠_addr
, __íåy->
timeout
)

3851 
	`DECLARE_EVENT_CLASS
(
lök_°©i⁄_add_mod
,

3852 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

3853 
lök_°©i⁄_∑ømëîs
 *
∑øms
),

3854 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
),

3855 
	`TP_STRUCT__íåy
(

3856 
WIPHY_ENTRY


3857 
NETDEV_ENTRY


3858 
	$__¨øy
(
u8
, 
mld_mac
, 6)

3859 
	$__¨øy
(
u8
, 
lök_mac
, 6)

3860 
	$__fõld
(
u32
, 
lök_id
)

3861 
	`__dy«mic_¨øy
(
u8
, 
suµ‹ãd_øãs
,

3862 
∑øms
->
suµ‹ãd_øãs_Àn
)

3863 
	`__¨øy
(
u8
, 
ht_ˇ∑
, ()(
õì80211_ht_ˇp
))

3864 
	`__¨øy
(
u8
, 
vht_ˇ∑
, ()(
õì80211_vht_ˇp
))

3865 
	$__fõld
(
u8
, 
›mode_nŸif
)

3866 
	$__fõld
(
boﬁ
, 
›mode_nŸif_u£d
)

3867 
	`__dy«mic_¨øy
(
u8
, 
he_ˇ∑
, 
∑øms
->
he_ˇ∑_Àn
)

3868 
	`__¨øy
(
u8
, 
he_6ghz_ˇ∑
, ()(
õì80211_he_6ghz_ˇ∑
))

3869 
	`__dy«mic_¨øy
(
u8
, 
eht_ˇ∑
, 
∑øms
->
eht_ˇ∑_Àn
)

3871 
	`TP_Á°_assign
(

3872 
WIPHY_ASSIGN
;

3873 
NETDEV_ASSIGN
;

3874 
	`mem£t
(
__íåy
->
mld_mac
, 0, 6);

3875 
	`mem£t
(
__íåy
->
lök_mac
, 0, 6);

3876 i‡(
∑øms
->
mld_mac
)

3877 
	`mem˝y
(
__íåy
->
mld_mac
, 
∑øms
->mld_mac, 6);

3878 i‡(
∑øms
->
lök_mac
)

3879 
	`mem˝y
(
__íåy
->
lök_mac
, 
∑øms
->link_mac, 6);

3880 
__íåy
->
lök_id
 = 
∑øms
->link_id;

3881 i‡(
∑øms
->
suµ‹ãd_øãs
 &&Ö¨ams->
suµ‹ãd_øãs_Àn
)

3882 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
suµ‹ãd_øãs
),

3883 
∑øms
->
suµ‹ãd_øãs
,

3884 
∑øms
->
suµ‹ãd_øãs_Àn
);

3885 
	`mem£t
(
__íåy
->
ht_ˇ∑
, 0, (
õì80211_ht_ˇp
));

3886 i‡(
∑øms
->
ht_ˇ∑
)

3887 
	`mem˝y
(
__íåy
->
ht_ˇ∑
, 
∑øms
->ht_capa,

3888 (
õì80211_ht_ˇp
));

3889 
	`mem£t
(
__íåy
->
vht_ˇ∑
, 0, (
õì80211_vht_ˇp
));

3890 i‡(
∑øms
->
vht_ˇ∑
)

3891 
	`mem˝y
(
__íåy
->
vht_ˇ∑
, 
∑øms
->vht_capa,

3892 (
õì80211_vht_ˇp
));

3893 
__íåy
->
›mode_nŸif
 = 
∑øms
->opmode_notif;

3894 
__íåy
->
›mode_nŸif_u£d
 = 
∑øms
->opmode_notif_used;

3895 i‡(
∑øms
->
he_ˇ∑
 &&Ö¨ams->
he_ˇ∑_Àn
)

3896 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
he_ˇ∑
), 
∑øms
->he_capa,

3897 
∑øms
->
he_ˇ∑_Àn
);

3898 
	`mem£t
(
__íåy
->
he_6ghz_ˇ∑
, 0, (
õì80211_he_6ghz_ˇ∑
));

3899 i‡(
∑øms
->
he_6ghz_ˇ∑
)

3900 
	`mem˝y
(
__íåy
->
he_6ghz_ˇ∑
, 
∑øms
->he_6ghz_capa,

3901 (
õì80211_he_6ghz_ˇ∑
));

3902 i‡(
∑øms
->
eht_ˇ∑
 &&Ö¨ams->
eht_ˇ∑_Àn
)

3903 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
eht_ˇ∑
), 
∑øms
->eht_capa,

3904 
∑øms
->
eht_ˇ∑_Àn
);

3906 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", station mac: %pM"

3908 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
mld_mac
,

3909 
__íåy
->
lök_mac
, __íåy->
lök_id
)

3912 
	`DEFINE_EVENT
(
lök_°©i⁄_add_mod
, 
rdev_add_lök_°©i⁄
,

3913 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

3914 
lök_°©i⁄_∑ømëîs
 *
∑øms
),

3915 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
)

3918 
	`DEFINE_EVENT
(
lök_°©i⁄_add_mod
, 
rdev_mod_lök_°©i⁄
,

3919 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

3920 
lök_°©i⁄_∑ømëîs
 *
∑øms
),

3921 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
)

3924 
	`TRACE_EVENT
(
rdev_dñ_lök_°©i⁄
,

3925 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

3926 
lök_°©i⁄_dñ_∑ømëîs
 *
∑øms
),

3927 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
),

3928 
	`TP_STRUCT__íåy
(

3929 
WIPHY_ENTRY


3930 
NETDEV_ENTRY


3931 
	$__¨øy
(
u8
, 
mld_mac
, 6)

3932 
	`__fõld
(
u32
, 
lök_id
)

3934 
	`TP_Á°_assign
(

3935 
WIPHY_ASSIGN
;

3936 
NETDEV_ASSIGN
;

3937 
	`mem£t
(
__íåy
->
mld_mac
, 0, 6);

3938 i‡(
∑øms
->
mld_mac
)

3939 
	`mem˝y
(
__íåy
->
mld_mac
, 
∑øms
->mld_mac, 6);

3940 
__íåy
->
lök_id
 = 
∑øms
->link_id;

3942 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", station mac: %pM"

3944 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
mld_mac
,

3945 
__íåy
->
lök_id
)

3948 
	`TRACE_EVENT
(
rdev_£t_hw_time°amp
,

3949 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

3950 
cfg80211_£t_hw_time°amp
 *
hwts
),

3952 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
hwts
),

3954 
	`TP_STRUCT__íåy
(

3955 
WIPHY_ENTRY


3956 
NETDEV_ENTRY


3957 
	$MAC_ENTRY
(
maˇddr
)

3958 
	`__fõld
(
boﬁ
, 
íabÀ
)

3961 
	`TP_Á°_assign
(

3962 
WIPHY_ASSIGN
;

3963 
NETDEV_ASSIGN
;

3964 
	`MAC_ASSIGN
(
maˇddr
, 
hwts
->macaddr);

3965 
__íåy
->
íabÀ
 = 
hwts
->enable;

3968 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
 ", mac %pM,Énable: %u",

3969 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
, 
__íåy
->
maˇddr
,

3970 
__íåy
->
íabÀ
)

3973 
	`TRACE_EVENT
(
cfg80211_löks_ªmoved
,

3974 
	`TP_PROTO
(
√t_devi˚
 *
√tdev
, 
u16
 
lök_mask
),

3975 
	`TP_ARGS
(
√tdev
, 
lök_mask
),

3976 
	`TP_STRUCT__íåy
(

3977 
NETDEV_ENTRY


3978 
	`__fõld
(
u16
, 
lök_mask
)

3980 
	`TP_Á°_assign
(

3981 
NETDEV_ASSIGN
;

3982 
__íåy
->
lök_mask
 =Üink_mask;

3984 
	`TP_¥ötk
(
NETDEV_PR_FMT
 ",Üök_mask:%u", 
NETDEV_PR_ARG
,

3985 
__íåy
->
lök_mask
)

3988 
	`TRACE_EVENT
(
rdev_£t_âlm
,

3989 
	`TP_PROTO
(
wùhy
 *wùhy, 
√t_devi˚
 *
√tdev
,

3990 
cfg80211_âlm_∑øms
 *
∑øms
),

3991 
	`TP_ARGS
(
wùhy
, 
√tdev
, 
∑øms
),

3992 
	`TP_STRUCT__íåy
(

3993 
WIPHY_ENTRY


3994 
NETDEV_ENTRY


3995 
	`__¨øy
(
u8
, 
dlök
, (
u16
) * 8)

3996 
	`__¨øy
(
u8
, 
ulök
, (
u16
) * 8)

3998 
	`TP_Á°_assign
(

3999 
WIPHY_ASSIGN
;

4000 
NETDEV_ASSIGN
;

4001 
	`mem˝y
(
__íåy
->
dlök
, 
∑øms
->dlink, (params->dlink));

4002 
	`mem˝y
(
__íåy
->
ulök
, 
∑øms
->ulink, (params->ulink));

4004 
	`TP_¥ötk
(
WIPHY_PR_FMT
 ", " 
NETDEV_PR_FMT
,

4005 
WIPHY_PR_ARG
, 
NETDEV_PR_ARG
)

4010 #unde‡
TRACE_INCLUDE_PATH


4011 
	#TRACE_INCLUDE_PATH
 .

	)

4012 #unde‡
TRACE_INCLUDE_FILE


4013 
	#TRACE_INCLUDE_FILE
 
åa˚


	)

4014 
	~<åa˚/deföe_åa˚.h
>

	@util.c

10 
	~<löux/exp‹t.h
>

11 
	~<löux/bô›s.h
>

12 
	~<löux/ëhîdevi˚.h
>

13 
	~<löux/¶ab.h
>

14 
	~<löux/õì80211.h
>

15 
	~<√t/cfg80211.h
>

16 
	~<√t/ù.h
>

17 
	~<√t/dsfõld.h
>

18 
	~<löux/if_vœn.h
>

19 
	~<löux/m∂s.h
>

20 
	~<löux/gcd.h
>

21 
	~<löux/bôfõld.h
>

22 
	~<löux/no•ec.h
>

23 
	~"c‹e.h
"

24 
	~"rdev-›s.h
"

27 c⁄° 
õì80211_øã
 *

28 
	$õì80211_gë_ª•⁄£_øã
(
õì80211_suµ‹ãd_b™d
 *
sb™d
,

29 
u32
 
basic_øãs
, 
bôøã
)

31 
õì80211_øã
 *
ªsu…
 = &
sb™d
->
bôøãs
[0];

32 
i
;

34 
i
 = 0; i < 
sb™d
->
n_bôøãs
; i++) {

35 i‡(!(
basic_øãs
 & 
	`BIT
(
i
)))

37 i‡(
sb™d
->
bôøãs
[
i
].
bôøã
 > bitrate)

39 
ªsu…
 = &
sb™d
->
bôøãs
[
i
];

42  
ªsu…
;

43 
	}
}

44 
EXPORT_SYMBOL
(
õì80211_gë_ª•⁄£_øã
);

46 
u32
 
	$õì80211_m™d©‹y_øãs
(
õì80211_suµ‹ãd_b™d
 *
sb™d
)

48 
õì80211_øã
 *
bôøãs
;

49 
u32
 
m™d©‹y_øãs
 = 0;

50 
õì80211_øã_Êags
 
m™d©‹y_Êag
;

51 
i
;

53 i‡(
	`WARN_ON
(!
sb™d
))

56 i‡(
sb™d
->
b™d
 =
NL80211_BAND_2GHZ
)

57 
m™d©‹y_Êag
 = 
IEEE80211_RATE_MANDATORY_B
;

59 
m™d©‹y_Êag
 = 
IEEE80211_RATE_MANDATORY_A
;

61 
bôøãs
 = 
sb™d
->bitrates;

62 
i
 = 0; i < 
sb™d
->
n_bôøãs
; i++)

63 i‡(
bôøãs
[
i
].
Êags
 & 
m™d©‹y_Êag
)

64 
m™d©‹y_øãs
 |
	`BIT
(
i
);

65  
m™d©‹y_øãs
;

66 
	}
}

67 
EXPORT_SYMBOL
(
õì80211_m™d©‹y_øãs
);

69 
u32
 
	$õì80211_ch™√l_to_‰eq_khz
(
ch™
, 
∆80211_b™d
 
b™d
)

73 i‡(
ch™
 <= 0)

75 
b™d
) {

76 
NL80211_BAND_2GHZ
:

77 
NL80211_BAND_LC
:

78 i‡(
ch™
 == 14)

79  
	`MHZ_TO_KHZ
(2484);

80 i‡(
ch™
 < 14)

81  
	`MHZ_TO_KHZ
(2407 + 
ch™
 * 5);

83 
NL80211_BAND_5GHZ
:

84 i‡(
ch™
 >= 182 && chan <= 196)

85  
	`MHZ_TO_KHZ
(4000 + 
ch™
 * 5);

87  
	`MHZ_TO_KHZ
(5000 + 
ch™
 * 5);

89 
NL80211_BAND_6GHZ
:

91 i‡(
ch™
 == 2)

92  
	`MHZ_TO_KHZ
(5935);

93 i‡(
ch™
 <= 233)

94  
	`MHZ_TO_KHZ
(5950 + 
ch™
 * 5);

96 
NL80211_BAND_60GHZ
:

97 i‡(
ch™
 < 7)

98  
	`MHZ_TO_KHZ
(56160 + 
ch™
 * 2160);

100 
NL80211_BAND_S1GHZ
:

101  902000 + 
ch™
 * 500;

106 
	}
}

107 
EXPORT_SYMBOL
(
õì80211_ch™√l_to_‰eq_khz
);

109 
∆80211_ch™_width


110 
	$õì80211_s1g_ch™√l_width
(c⁄° 
õì80211_ch™√l
 *
ch™
)

112 i‡(
	`WARN_ON
(!
ch™
 || ch™->
b™d
 !
NL80211_BAND_S1GHZ
))

113  
NL80211_CHAN_WIDTH_20_NOHT
;

118 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_1MHZ
)

119  
NL80211_CHAN_WIDTH_1
;

120 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_2MHZ
)

121  
NL80211_CHAN_WIDTH_2
;

122 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_4MHZ
)

123  
NL80211_CHAN_WIDTH_4
;

124 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_8MHZ
)

125  
NL80211_CHAN_WIDTH_8
;

126 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_16MHZ
)

127  
NL80211_CHAN_WIDTH_16
;

129 
	`¥_îr
("unknown channel width for channelát %dKHz?\n",

130 
	`õì80211_ch™√l_to_khz
(
ch™
));

132  
NL80211_CHAN_WIDTH_1
;

133 
	}
}

134 
EXPORT_SYMBOL
(
õì80211_s1g_ch™√l_width
);

136 
	$õì80211_‰eq_khz_to_ch™√l
(
u32
 
‰eq
)

139 
‰eq
 = 
	`KHZ_TO_MHZ
(freq);

142 i‡(
‰eq
 == 2484)

144 i‡(
‰eq
 < 2484)

145  (
‰eq
 - 2407) / 5;

146 i‡(
‰eq
 >= 4910 && freq <= 4980)

147  (
‰eq
 - 4000) / 5;

148 i‡(
‰eq
 < 5925)

149  (
‰eq
 - 5000) / 5;

150 i‡(
‰eq
 == 5935)

152 i‡(
‰eq
 <= 45000)

154  (
‰eq
 - 5950) / 5;

155 i‡(
‰eq
 >= 58320 && freq <= 70200)

156  (
‰eq
 - 56160) / 2160;

159 
	}
}

160 
EXPORT_SYMBOL
(
õì80211_‰eq_khz_to_ch™√l
);

162 
õì80211_ch™√l
 *
	$õì80211_gë_ch™√l_khz
(
wùhy
 *wiphy,

163 
u32
 
‰eq
)

165 
∆80211_b™d
 
b™d
;

166 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

167 
i
;

169 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

170 
sb™d
 = 
wùhy
->
b™ds
[
b™d
];

172 i‡(!
sb™d
)

175 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++) {

176 
õì80211_ch™√l
 *
ch™
 = &
sb™d
->
ch™√ls
[
i
];

178 i‡(
	`õì80211_ch™√l_to_khz
(
ch™
Ë=
‰eq
)

179  
ch™
;

183  
NULL
;

184 
	}
}

185 
EXPORT_SYMBOL
(
õì80211_gë_ch™√l_khz
);

187 
	$£t_m™d©‹y_Êags_b™d
(
õì80211_suµ‹ãd_b™d
 *
sb™d
)

189 
i
, 
w™t
;

191 
sb™d
->
b™d
) {

192 
NL80211_BAND_5GHZ
:

193 
NL80211_BAND_6GHZ
:

194 
w™t
 = 3;

195 
i
 = 0; i < 
sb™d
->
n_bôøãs
; i++) {

196 i‡(
sb™d
->
bôøãs
[
i
].
bôøã
 == 60 ||

197 
sb™d
->
bôøãs
[
i
].
bôøã
 == 120 ||

198 
sb™d
->
bôøãs
[
i
].
bôøã
 == 240) {

199 
sb™d
->
bôøãs
[
i
].
Êags
 |=

200 
IEEE80211_RATE_MANDATORY_A
;

201 
w™t
--;

204 
	`WARN_ON
(
w™t
);

206 
NL80211_BAND_2GHZ
:

207 
NL80211_BAND_LC
:

208 
w™t
 = 7;

209 
i
 = 0; i < 
sb™d
->
n_bôøãs
; i++) {

210 
sb™d
->
bôøãs
[
i
].
bôøã
) {

215 
sb™d
->
bôøãs
[
i
].
Êags
 |=

216 
IEEE80211_RATE_MANDATORY_B
 |

217 
IEEE80211_RATE_MANDATORY_G
;

218 
w™t
--;

223 
sb™d
->
bôøãs
[
i
].
Êags
 |=

224 
IEEE80211_RATE_MANDATORY_G
;

225 
w™t
--;

226 
ÁŒthrough
;

228 
sb™d
->
bôøãs
[
i
].
Êags
 |=

229 
IEEE80211_RATE_ERP_G
;

233 
	`WARN_ON
(
w™t
 != 0 && want != 3);

235 
NL80211_BAND_60GHZ
:

237 
	`WARN_ON
(!
sb™d
->
ht_ˇp
.
ht_suµ‹ãd
);

238 
	`WARN_ON
((
sb™d
->
ht_ˇp
.
mcs
.
rx_mask
[0] & 0x1e) != 0x1e);

240 
NL80211_BAND_S1GHZ
:

244 
	`WARN_ON
((
sb™d
->
s1g_ˇp
.
nss_mcs
[0] & 0x3) == 0x3);

246 
NUM_NL80211_BANDS
:

248 
	`WARN_ON
(1);

251 
	}
}

253 
	$õì80211_£t_bôøã_Êags
(
wùhy
 *wiphy)

255 
∆80211_b™d
 
b™d
;

257 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++)

258 i‡(
wùhy
->
b™ds
[
b™d
])

259 
	`£t_m™d©‹y_Êags_b™d
(
wùhy
->
b™ds
[
b™d
]);

260 
	}
}

262 
boﬁ
 
	$cfg80211_suµ‹ãd_cùhî_suôe
(
wùhy
 *wùhy, 
u32
 
cùhî
)

264 
i
;

265 
i
 = 0; i < 
wùhy
->
n_cùhî_suôes
; i++)

266 i‡(
cùhî
 =
wùhy
->
cùhî_suôes
[
i
])

267  
åue
;

268  
Ál£
;

269 
	}
}

271 
boﬁ


272 
	$cfg80211_igtk_cùhî_suµ‹ãd
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

274 
wùhy
 *wùhy = &
rdev
->wiphy;

275 
i
;

277 
i
 = 0; i < 
wùhy
->
n_cùhî_suôes
; i++) {

278 
wùhy
->
cùhî_suôes
[
i
]) {

279 
WLAN_CIPHER_SUITE_AES_CMAC
:

280 
WLAN_CIPHER_SUITE_BIP_CMAC_256
:

281 
WLAN_CIPHER_SUITE_BIP_GMAC_128
:

282 
WLAN_CIPHER_SUITE_BIP_GMAC_256
:

283  
åue
;

287  
Ál£
;

288 
	}
}

290 
boﬁ
 
	$cfg80211_vÆid_key_idx
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

291 
key_idx
, 
boﬁ
 
∑úwi£
)

293 
max_key_idx
;

295 i‡(
∑úwi£
)

296 
max_key_idx
 = 3;

297 i‡(
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

298 
NL80211_EXT_FEATURE_BEACON_PROTECTION
) ||

299 
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

300 
NL80211_EXT_FEATURE_BEACON_PROTECTION_CLIENT
))

301 
max_key_idx
 = 7;

302 i‡(
	`cfg80211_igtk_cùhî_suµ‹ãd
(
rdev
))

303 
max_key_idx
 = 5;

305 
max_key_idx
 = 3;

307 i‡(
key_idx
 < 0 || key_idx > 
max_key_idx
)

308  
Ál£
;

310  
åue
;

311 
	}
}

313 
	$cfg80211_vÆid©e_key_£âögs
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

314 
key_∑øms
 *
∑øms
, 
key_idx
,

315 
boﬁ
 
∑úwi£
, c⁄° 
u8
 *
mac_addr
)

317 i‡(!
	`cfg80211_vÆid_key_idx
(
rdev
, 
key_idx
, 
∑úwi£
))

318  -
EINVAL
;

320 i‡(!
∑úwi£
 && 
mac_addr
 && !(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_IBSS_RSN
))

321  -
EINVAL
;

323 i‡(
∑úwi£
 && !
mac_addr
)

324  -
EINVAL
;

326 
∑øms
->
cùhî
) {

327 
WLAN_CIPHER_SUITE_TKIP
:

329 i‡((
∑úwi£
 && 
key_idx
) ||

330 
∑øms
->
mode
 !
NL80211_KEY_RX_TX
)

331  -
EINVAL
;

333 
WLAN_CIPHER_SUITE_CCMP
:

334 
WLAN_CIPHER_SUITE_CCMP_256
:

335 
WLAN_CIPHER_SUITE_GCMP
:

336 
WLAN_CIPHER_SUITE_GCMP_256
:

344 i‡((
∑øms
->
mode
 =
NL80211_KEY_NO_TX
 && !
∑úwi£
) ||

345 
∑øms
->
mode
 =
NL80211_KEY_SET_TX
)

346  -
EINVAL
;

347 i‡(
	`wùhy_ext_„©uª_is£t
(&
rdev
->
wùhy
,

348 
NL80211_EXT_FEATURE_EXT_KEY_ID
)) {

349 i‡(
∑úwi£
 && (
key_idx
 < 0 || key_idx > 1))

350  -
EINVAL
;

351 } i‡(
∑úwi£
 && 
key_idx
) {

352  -
EINVAL
;

355 
WLAN_CIPHER_SUITE_AES_CMAC
:

356 
WLAN_CIPHER_SUITE_BIP_CMAC_256
:

357 
WLAN_CIPHER_SUITE_BIP_GMAC_128
:

358 
WLAN_CIPHER_SUITE_BIP_GMAC_256
:

360 i‡(
∑úwi£
)

361  -
EINVAL
;

362 i‡(
key_idx
 < 4)

363  -
EINVAL
;

365 
WLAN_CIPHER_SUITE_WEP40
:

366 
WLAN_CIPHER_SUITE_WEP104
:

367 i‡(
key_idx
 > 3)

368  -
EINVAL
;

374 
∑øms
->
cùhî
) {

375 
WLAN_CIPHER_SUITE_WEP40
:

376 i‡(
∑øms
->
key_Àn
 !
WLAN_KEY_LEN_WEP40
)

377  -
EINVAL
;

379 
WLAN_CIPHER_SUITE_TKIP
:

380 i‡(
∑øms
->
key_Àn
 !
WLAN_KEY_LEN_TKIP
)

381  -
EINVAL
;

383 
WLAN_CIPHER_SUITE_CCMP
:

384 i‡(
∑øms
->
key_Àn
 !
WLAN_KEY_LEN_CCMP
)

385  -
EINVAL
;

387 
WLAN_CIPHER_SUITE_CCMP_256
:

388 i‡(
∑øms
->
key_Àn
 !
WLAN_KEY_LEN_CCMP_256
)

389  -
EINVAL
;

391 
WLAN_CIPHER_SUITE_GCMP
:

392 i‡(
∑øms
->
key_Àn
 !
WLAN_KEY_LEN_GCMP
)

393  -
EINVAL
;

395 
WLAN_CIPHER_SUITE_GCMP_256
:

396 i‡(
∑øms
->
key_Àn
 !
WLAN_KEY_LEN_GCMP_256
)

397  -
EINVAL
;

399 
WLAN_CIPHER_SUITE_WEP104
:

400 i‡(
∑øms
->
key_Àn
 !
WLAN_KEY_LEN_WEP104
)

401  -
EINVAL
;

403 
WLAN_CIPHER_SUITE_AES_CMAC
:

404 i‡(
∑øms
->
key_Àn
 !
WLAN_KEY_LEN_AES_CMAC
)

405  -
EINVAL
;

407 
WLAN_CIPHER_SUITE_BIP_CMAC_256
:

408 i‡(
∑øms
->
key_Àn
 !
WLAN_KEY_LEN_BIP_CMAC_256
)

409  -
EINVAL
;

411 
WLAN_CIPHER_SUITE_BIP_GMAC_128
:

412 i‡(
∑øms
->
key_Àn
 !
WLAN_KEY_LEN_BIP_GMAC_128
)

413  -
EINVAL
;

415 
WLAN_CIPHER_SUITE_BIP_GMAC_256
:

416 i‡(
∑øms
->
key_Àn
 !
WLAN_KEY_LEN_BIP_GMAC_256
)

417  -
EINVAL
;

430 i‡(
∑øms
->
£q
) {

431 
∑øms
->
cùhî
) {

432 
WLAN_CIPHER_SUITE_WEP40
:

433 
WLAN_CIPHER_SUITE_WEP104
:

435  -
EINVAL
;

436 
WLAN_CIPHER_SUITE_TKIP
:

437 
WLAN_CIPHER_SUITE_CCMP
:

438 
WLAN_CIPHER_SUITE_CCMP_256
:

439 
WLAN_CIPHER_SUITE_GCMP
:

440 
WLAN_CIPHER_SUITE_GCMP_256
:

441 
WLAN_CIPHER_SUITE_AES_CMAC
:

442 
WLAN_CIPHER_SUITE_BIP_CMAC_256
:

443 
WLAN_CIPHER_SUITE_BIP_GMAC_128
:

444 
WLAN_CIPHER_SUITE_BIP_GMAC_256
:

445 i‡(
∑øms
->
£q_Àn
 != 6)

446  -
EINVAL
;

451 i‡(!
	`cfg80211_suµ‹ãd_cùhî_suôe
(&
rdev
->
wùhy
, 
∑øms
->
cùhî
))

452  -
EINVAL
;

455 
	}
}

457 
__©åibuã_c⁄°__
 
	$õì80211_hdæí
(
__À16
 
fc
)

459 
hdæí
 = 24;

461 i‡(
	`õì80211_is_ext
(
fc
)) {

462 
hdæí
 = 4;

463 
out
;

466 i‡(
	`õì80211_is_d©a
(
fc
)) {

467 i‡(
	`õì80211_has_a4
(
fc
))

468 
hdæí
 = 30;

469 i‡(
	`õì80211_is_d©a_qos
(
fc
)) {

470 
hdæí
 +
IEEE80211_QOS_CTL_LEN
;

471 i‡(
	`õì80211_has_‹dî
(
fc
))

472 
hdæí
 +
IEEE80211_HT_CTL_LEN
;

474 
out
;

477 i‡(
	`õì80211_is_mgmt
(
fc
)) {

478 i‡(
	`õì80211_has_‹dî
(
fc
))

479 
hdæí
 +
IEEE80211_HT_CTL_LEN
;

480 
out
;

483 i‡(
	`õì80211_is_˘l
(
fc
)) {

493 i‡((
fc
 & 
	`˝u_to_À16
(0x00E0)) == cpu_to_le16(0x00C0))

494 
hdæí
 = 10;

496 
hdæí
 = 16;

498 
out
:

499  
hdæí
;

500 
	}
}

501 
EXPORT_SYMBOL
(
õì80211_hdæí
);

503 
	$õì80211_gë_hdæí_‰om_skb
(c⁄° 
sk_buff
 *
skb
)

505 c⁄° 
õì80211_hdr
 *
hdr
 =

506 (c⁄° 
õì80211_hdr
 *)
skb
->
d©a
;

507 
hdæí
;

509 i‡(
	`u∆ikñy
(
skb
->
Àn
 < 10))

511 
hdæí
 = 
	`õì80211_hdæí
(
hdr
->
‰ame_c⁄åﬁ
);

512 i‡(
	`u∆ikñy
(
hdæí
 > 
skb
->
Àn
))

514  
hdæí
;

515 
	}
}

516 
EXPORT_SYMBOL
(
õì80211_gë_hdæí_‰om_skb
);

518 
	$__õì80211_gë_mesh_hdæí
(
u8
 
Êags
)

520 
´
 = 
Êags
 & 
MESH_FLAGS_AE
;

522 
´
) {

526 
MESH_FLAGS_AE_A4
:

528 
MESH_FLAGS_AE_A5_A6
:

531 
	}
}

533 
	$õì80211_gë_mesh_hdæí
(
õì80211s_hdr
 *
meshhdr
)

535  
	`__õì80211_gë_mesh_hdæí
(
meshhdr
->
Êags
);

536 
	}
}

537 
EXPORT_SYMBOL
(
õì80211_gë_mesh_hdæí
);

539 
boﬁ
 
	$õì80211_gë_8023_tu¬ñ_¥Ÿo
(c⁄° *
hdr
, 
__be16
 *
¥Ÿo
)

541 c⁄° 
__be16
 *
hdr_¥Ÿo
 = 
hdr
 + 
ETH_ALEN
;

543 i‡(!(
	`ëhî_addr_equÆ
(
hdr
, 
rfc1042_hódî
) &&

544 *
hdr_¥Ÿo
 !
	`ht⁄s
(
ETH_P_AARP
) &&

545 *
hdr_¥Ÿo
 !
	`ht⁄s
(
ETH_P_IPX
)) &&

546 !
	`ëhî_addr_equÆ
(
hdr
, 
bridge_tu¬ñ_hódî
))

547  
Ál£
;

549 *
¥Ÿo
 = *
hdr_¥Ÿo
;

551  
åue
;

552 
	}
}

553 
EXPORT_SYMBOL
(
õì80211_gë_8023_tu¬ñ_¥Ÿo
);

555 
	$õì80211_°rù_8023_mesh_hdr
(
sk_buff
 *
skb
)

557 c⁄° *
mesh_addr
;

559 
ëhhdr
 
ëh
;

560 
u8
 
Êags
;

561 } 
∑ylﬂd
;

562 
hdæí
;

563 
ªt
;

565 
ªt
 = 
	`skb_c›y_bôs
(
skb
, 0, &
∑ylﬂd
, (payload));

566 i‡(
ªt
)

567  
ªt
;

569 
hdæí
 = (
∑ylﬂd
.
ëh
Ë+ 
	`__õì80211_gë_mesh_hdæí
’aylﬂd.
Êags
);

571 i‡(
	`likñy
(
	`pskb_may_puŒ
(
skb
, 
hdæí
 + 8) &&

572 
	`õì80211_gë_8023_tu¬ñ_¥Ÿo
(
skb
->
d©a
 + 
hdæí
,

573 &
∑ylﬂd
.
ëh
.
h_¥Ÿo
)))

574 
hdæí
 +
ETH_ALEN
 + 2;

575 i‡(!
	`pskb_may_puŒ
(
skb
, 
hdæí
))

576  -
EINVAL
;

578 
∑ylﬂd
.
ëh
.
h_¥Ÿo
 = 
	`ht⁄s
(
skb
->
Àn
 - 
hdæí
);

580 
mesh_addr
 = 
skb
->
d©a
 + (
∑ylﬂd
.
ëh
Ë+ 
ETH_ALEN
;

581 
∑ylﬂd
.
Êags
 & 
MESH_FLAGS_AE
) {

582 
MESH_FLAGS_AE_A4
:

583 
	`mem˝y
(&
∑ylﬂd
.
ëh
.
h_sour˚
, 
mesh_addr
, 
ETH_ALEN
);

585 
MESH_FLAGS_AE_A5_A6
:

586 
	`mem˝y
(&
∑ylﬂd
.
ëh
, 
mesh_addr
, 2 * 
ETH_ALEN
);

592 
	`pskb_puŒ
(
skb
, 
hdæí
 - (
∑ylﬂd
.
ëh
));

593 
	`mem˝y
(
skb
->
d©a
, &
∑ylﬂd
.
ëh
, (payload.eth));

596 
	}
}

597 
EXPORT_SYMBOL
(
õì80211_°rù_8023_mesh_hdr
);

599 
	$õì80211_d©a_to_8023_exthdr
(
sk_buff
 *
skb
, 
ëhhdr
 *
ehdr
,

600 c⁄° 
u8
 *
addr
, 
∆80211_i·y≥
 
i·y≥
,

601 
u8
 
d©a_off£t
, 
boﬁ
 
is_amsdu
)

603 
õì80211_hdr
 *
hdr
 = (õì80211_hd∏*Ë
skb
->
d©a
;

605 
u8
 
hdr
[
ETH_ALEN
] 
	`__Æig√d
(2);

606 
__be16
 
¥Ÿo
;

607 } 
∑ylﬂd
;

608 
ëhhdr
 
tmp
;

609 
u16
 
hdæí
;

611 i‡(
	`u∆ikñy
(!
	`õì80211_is_d©a_¥e£¡
(
hdr
->
‰ame_c⁄åﬁ
)))

614 
hdæí
 = 
	`õì80211_hdæí
(
hdr
->
‰ame_c⁄åﬁ
Ë+ 
d©a_off£t
;

615 i‡(
skb
->
Àn
 < 
hdæí
)

627 
	`mem˝y
(
tmp
.
h_de°
, 
	`õì80211_gë_DA
(
hdr
), 
ETH_ALEN
);

628 
	`mem˝y
(
tmp
.
h_sour˚
, 
	`õì80211_gë_SA
(
hdr
), 
ETH_ALEN
);

630 
hdr
->
‰ame_c⁄åﬁ
 &

631 
	`˝u_to_À16
(
IEEE80211_FCTL_TODS
 | 
IEEE80211_FCTL_FROMDS
)) {

632 
	`˝u_to_À16
(
IEEE80211_FCTL_TODS
):

633 i‡(
	`u∆ikñy
(
i·y≥
 !
NL80211_IFTYPE_AP
 &&

634 
i·y≥
 !
NL80211_IFTYPE_AP_VLAN
 &&

635 
i·y≥
 !
NL80211_IFTYPE_P2P_GO
))

638 
	`˝u_to_À16
(
IEEE80211_FCTL_TODS
 | 
IEEE80211_FCTL_FROMDS
):

639 i‡(
	`u∆ikñy
(
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
 &&

640 
i·y≥
 !
NL80211_IFTYPE_AP_VLAN
 &&

641 
i·y≥
 !
NL80211_IFTYPE_STATION
))

644 
	`˝u_to_À16
(
IEEE80211_FCTL_FROMDS
):

645 i‡((
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

646 
i·y≥
 !
NL80211_IFTYPE_P2P_CLIENT
 &&

647 
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
) ||

648 (
	`is_mu…iˇ°_ëhî_addr
(
tmp
.
h_de°
) &&

649 
	`ëhî_addr_equÆ
(
tmp
.
h_sour˚
, 
addr
)))

652 
	`˝u_to_À16
(0):

653 i‡(
i·y≥
 !
NL80211_IFTYPE_ADHOC
 &&

654 
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

655 
i·y≥
 !
NL80211_IFTYPE_OCB
)

660 i‡(
	`likñy
(!
is_amsdu
 && 
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
 &&

661 
	`skb_c›y_bôs
(
skb
, 
hdæí
, &
∑ylﬂd
, (payload)) == 0 &&

662 
	`õì80211_gë_8023_tu¬ñ_¥Ÿo
(&
∑ylﬂd
, &
tmp
.
h_¥Ÿo
))) {

664 
hdæí
 +
ETH_ALEN
 + 2;

665 
	`skb_po°puŒ_rcsum
(
skb
, &
∑ylﬂd
, 
ETH_ALEN
 + 2);

667 
tmp
.
h_¥Ÿo
 = 
	`ht⁄s
(
skb
->
Àn
 - 
hdæí
);

670 
	`pskb_puŒ
(
skb
, 
hdæí
);

672 i‡(!
ehdr
)

673 
ehdr
 = 
	`skb_push
(
skb
, (
ëhhdr
));

674 
	`mem˝y
(
ehdr
, &
tmp
, (tmp));

677 
	}
}

678 
EXPORT_SYMBOL
(
õì80211_d©a_to_8023_exthdr
);

681 
	$__‰ame_add_‰ag
(
sk_buff
 *
skb
, 
∑ge
 *page,

682 *
±r
, 
Àn
, 
size
)

684 
skb_sh¨ed_öfo
 *
sh
 = 
	`skb_shöfo
(
skb
);

685 
∑ge_off£t
;

687 
	`gë_∑ge
(
∑ge
);

688 
∑ge_off£t
 = 
±r
 - 
	`∑ge_addªss
(
∑ge
);

689 
	`skb_add_rx_‰ag
(
skb
, 
sh
->
ƒ_‰ags
, 
∑ge
, 
∑ge_off£t
, 
Àn
, 
size
);

690 
	}
}

693 
	$__õì80211_amsdu_c›y_‰ag
(
sk_buff
 *
skb
, sk_buf‡*
‰ame
,

694 
off£t
, 
Àn
)

696 
skb_sh¨ed_öfo
 *
sh
 = 
	`skb_shöfo
(
skb
);

697 c⁄° 
skb_‰ag_t
 *
‰ag
 = &
sh
->
‰ags
[0];

698 
∑ge
 *
‰ag_∑ge
;

699 *
‰ag_±r
;

700 
‰ag_Àn
, 
‰ag_size
;

701 
hód_size
 = 
skb
->
Àn
 - skb->
d©a_Àn
;

702 
cur_Àn
;

704 
‰ag_∑ge
 = 
	`vút_to_hód_∑ge
(
skb
->
hód
);

705 
‰ag_±r
 = 
skb
->
d©a
;

706 
‰ag_size
 = 
hód_size
;

708 
off£t
 >
‰ag_size
) {

709 
off£t
 -
‰ag_size
;

710 
‰ag_∑ge
 = 
	`skb_‰ag_∑ge
(
‰ag
);

711 
‰ag_±r
 = 
	`skb_‰ag_addªss
(
‰ag
);

712 
‰ag_size
 = 
	`skb_‰ag_size
(
‰ag
);

713 
‰ag
++;

716 
‰ag_±r
 +
off£t
;

717 
‰ag_Àn
 = 
‰ag_size
 - 
off£t
;

719 
cur_Àn
 = 
	`mö
(
Àn
, 
‰ag_Àn
);

721 
	`__‰ame_add_‰ag
(
‰ame
, 
‰ag_∑ge
, 
‰ag_±r
, 
cur_Àn
, 
‰ag_size
);

722 
Àn
 -
cur_Àn
;

724 
Àn
 > 0) {

725 
‰ag_Àn
 = 
	`skb_‰ag_size
(
‰ag
);

726 
cur_Àn
 = 
	`mö
(
Àn
, 
‰ag_Àn
);

727 
	`__‰ame_add_‰ag
(
‰ame
, 
	`skb_‰ag_∑ge
(
‰ag
),

728 
	`skb_‰ag_addªss
(
‰ag
), 
cur_Àn
, 
‰ag_Àn
);

729 
Àn
 -
cur_Àn
;

730 
‰ag
++;

732 
	}
}

734 
sk_buff
 *

735 
	$__õì80211_amsdu_c›y
(
sk_buff
 *
skb
, 
hÀn
,

736 
off£t
, 
Àn
, 
boﬁ
 
ªu£_‰ag
,

737 
mö_Àn
)

739 
sk_buff
 *
‰ame
;

740 
cur_Àn
 = 
Àn
;

742 i‡(
skb
->
Àn
 - 
off£t
 <Üen)

743  
NULL
;

750 i‡(
ªu£_‰ag
)

751 
cur_Àn
 = 
	`mö_t
(, 
Àn
, 
mö_Àn
);

757 
‰ame
 = 
	`dev_Æloc_skb
(
hÀn
 + (
ëhhdr
Ë+ 2 + 
cur_Àn
);

758 i‡(!
‰ame
)

759  
NULL
;

761 
‰ame
->
¥i‹ôy
 = 
skb
->priority;

762 
	`skb_ª£rve
(
‰ame
, 
hÀn
 + (
ëhhdr
) + 2);

763 
	`skb_c›y_bôs
(
skb
, 
off£t
, 
	`skb_put
(
‰ame
, 
cur_Àn
), cur_len);

765 
Àn
 -
cur_Àn
;

766 i‡(!
Àn
)

767  
‰ame
;

769 
off£t
 +
cur_Àn
;

770 
	`__õì80211_amsdu_c›y_‰ag
(
skb
, 
‰ame
, 
off£t
, 
Àn
);

772  
‰ame
;

773 
	}
}

775 
u16


776 
	$õì80211_amsdu_sub‰ame_Àngth
(*
fõld
, 
u8
 
mesh_Êags
, u8 
hdr_ty≥
)

778 
__À16
 *
fõld_À
 = 
fõld
;

779 
__be16
 *
fõld_be
 = 
fõld
;

780 
u16
 
Àn
;

782 i‡(
hdr_ty≥
 >= 2)

783 
Àn
 = 
	`À16_to_˝u
(*
fõld_À
);

785 
Àn
 = 
	`be16_to_˝u
(*
fõld_be
);

786 i‡(
hdr_ty≥
)

787 
Àn
 +
	`__õì80211_gë_mesh_hdæí
(
mesh_Êags
);

789  
Àn
;

790 
	}
}

792 
boﬁ
 
	$õì80211_is_vÆid_amsdu
(
sk_buff
 *
skb
, 
u8
 
mesh_hdr
)

794 
off£t
 = 0, 
sub‰ame_Àn
, 
∑ddög
;

796 
off£t
 = 0; off£à< 
skb
->
Àn
; off£à+
sub‰ame_Àn
 + 
∑ddög
) {

797 
ªmaöög
 = 
skb
->
Àn
 - 
off£t
;

799 
__be16
 
Àn
;

800 
u8
 
mesh_Êags
;

801 } 
hdr
;

802 
u16
 
Àn
;

804 i‡((
hdr
Ë> 
ªmaöög
)

805  
Ál£
;

807 i‡(
	`skb_c›y_bôs
(
skb
, 
off£t
 + 2 * 
ETH_ALEN
, &
hdr
, (hdr)) < 0)

808  
Ál£
;

810 
Àn
 = 
	`õì80211_amsdu_sub‰ame_Àngth
(&
hdr
.Àn, hdr.
mesh_Êags
,

811 
mesh_hdr
);

812 
sub‰ame_Àn
 = (
ëhhdr
Ë+ 
Àn
;

813 
∑ddög
 = (4 - 
sub‰ame_Àn
) & 0x3;

815 i‡(
sub‰ame_Àn
 > 
ªmaöög
)

816  
Ál£
;

819  
åue
;

820 
	}
}

821 
EXPORT_SYMBOL
(
õì80211_is_vÆid_amsdu
);

823 
	$õì80211_amsdu_to_8023s
(
sk_buff
 *
skb
, 
sk_buff_hód
 *
li°
,

824 c⁄° 
u8
 *
addr
, 
∆80211_i·y≥
 
i·y≥
,

825 c⁄° 
exåa_hódroom
,

826 c⁄° 
u8
 *
check_da
, c⁄° u8 *
check_ß
,

827 
u8
 
mesh_c⁄åﬁ
)

829 
hÀn
 = 
	`ALIGN
(
exåa_hódroom
, 4);

830 
sk_buff
 *
‰ame
 = 
NULL
;

831 
off£t
 = 0;

833 
ëhhdr
 
ëh
;

834 
uöt8_t
 
Êags
;

835 } 
hdr
;

836 
boﬁ
 
ªu£_‰ag
 = 
skb
->
hód_‰ag
 && !
	`skb_has_‰ag_li°
(skb);

837 
boﬁ
 
ªu£_skb
 = 
Ál£
;

838 
boﬁ
 
œ°
 = 
Ál£
;

839 
c›y_Àn
 = (
hdr
.
ëh
);

841 i‡(
i·y≥
 =
NL80211_IFTYPE_MESH_POINT
)

842 
c›y_Àn
 = (
hdr
);

844 !
œ°
) {

845 
ªmaöög
 = 
skb
->
Àn
 - 
off£t
;

846 
sub‰ame_Àn
;

847 
Àn
, 
mesh_Àn
 = 0;

848 
u8
 
∑ddög
;

850 i‡(
c›y_Àn
 > 
ªmaöög
)

851 
purge
;

853 
	`skb_c›y_bôs
(
skb
, 
off£t
, &
hdr
, 
c›y_Àn
);

854 i‡(
i·y≥
 =
NL80211_IFTYPE_MESH_POINT
)

855 
mesh_Àn
 = 
	`__õì80211_gë_mesh_hdæí
(
hdr
.
Êags
);

856 
Àn
 = 
	`õì80211_amsdu_sub‰ame_Àngth
(&
hdr
.
ëh
.
h_¥Ÿo
, hdr.
Êags
,

857 
mesh_c⁄åﬁ
);

858 
sub‰ame_Àn
 = (
ëhhdr
Ë+ 
Àn
;

859 
∑ddög
 = (4 - 
sub‰ame_Àn
) & 0x3;

862 i‡(
sub‰ame_Àn
 > 
ªmaöög
)

863 
purge
;

865 i‡(
	`ëhî_addr_equÆ
(
hdr
.
ëh
.
h_de°
, 
rfc1042_hódî
))

866 
purge
;

868 
off£t
 +(
ëhhdr
);

869 
œ°
 = 
ªmaöög
 <
sub‰ame_Àn
 + 
∑ddög
;

872 i‡((
check_da
 && !
	`is_mu…iˇ°_ëhî_addr
(
hdr
.
ëh
.
h_de°
) &&

873 !
	`ëhî_addr_equÆ
(
check_da
, 
hdr
.
ëh
.
h_de°
)) ||

874 (
check_ß
 && !
	`ëhî_addr_equÆ
(check_ß, 
hdr
.
ëh
.
h_sour˚
))) {

875 
off£t
 +
Àn
 + 
∑ddög
;

880 i‡(!
	`skb_is_n⁄löór
(
skb
Ë&& !
ªu£_‰ag
 && 
œ°
) {

881 
	`skb_puŒ
(
skb
, 
off£t
);

882 
‰ame
 = 
skb
;

883 
ªu£_skb
 = 
åue
;

885 
‰ame
 = 
	`__õì80211_amsdu_c›y
(
skb
, 
hÀn
, 
off£t
, 
Àn
,

886 
ªu£_‰ag
, 32 + 
mesh_Àn
);

887 i‡(!
‰ame
)

888 
purge
;

890 
off£t
 +
Àn
 + 
∑ddög
;

893 
	`skb_ª£t_√tw‹k_hódî
(
‰ame
);

894 
‰ame
->
dev
 = 
skb
->dev;

895 
‰ame
->
¥i‹ôy
 = 
skb
->priority;

897 i‡(
	`likñy
(
i·y≥
 !
NL80211_IFTYPE_MESH_POINT
 &&

898 
	`õì80211_gë_8023_tu¬ñ_¥Ÿo
(
‰ame
->
d©a
, &
hdr
.
ëh
.
h_¥Ÿo
)))

899 
	`skb_puŒ
(
‰ame
, 
ETH_ALEN
 + 2);

901 
	`mem˝y
(
	`skb_push
(
‰ame
, (
hdr
.
ëh
)), &hdr.eth, (hdr.eth));

902 
	`__skb_queue_èû
(
li°
, 
‰ame
);

905 i‡(!
ªu£_skb
)

906 
	`dev_k‰ì_skb
(
skb
);

910 
purge
:

911 
	`__skb_queue_purge
(
li°
);

912 
	`dev_k‰ì_skb
(
skb
);

913 
	}
}

914 
EXPORT_SYMBOL
(
õì80211_amsdu_to_8023s
);

917 
	$cfg80211_˛assify8021d
(
sk_buff
 *
skb
,

918 
cfg80211_qos_m≠
 *
qos_m≠
)

920 
ds˝
;

921 
vœn_¥i‹ôy
;

922 
ªt
;

929 i‡(
skb
->
¥i‹ôy
 >= 256 && skb->priority <= 263) {

930 
ªt
 = 
skb
->
¥i‹ôy
 - 256;

931 
out
;

934 i‡(
	`skb_vœn_èg_¥e£¡
(
skb
)) {

935 
vœn_¥i‹ôy
 = (
	`skb_vœn_èg_gë
(
skb
Ë& 
VLAN_PRIO_MASK
)

936 >> 
VLAN_PRIO_SHIFT
;

937 i‡(
vœn_¥i‹ôy
 > 0) {

938 
ªt
 = 
vœn_¥i‹ôy
;

939 
out
;

943 
skb
->
¥Ÿocﬁ
) {

944 
	`ht⁄s
(
ETH_P_IP
):

945 
ds˝
 = 
	`ùv4_gë_dsfõld
(
	`ù_hdr
(
skb
)) & 0xfc;

947 
	`ht⁄s
(
ETH_P_IPV6
):

948 
ds˝
 = 
	`ùv6_gë_dsfõld
(
	`ùv6_hdr
(
skb
)) & 0xfc;

950 
	`ht⁄s
(
ETH_P_MPLS_UC
):

951 
	`ht⁄s
(
ETH_P_MPLS_MC
): {

952 
m∂s_œbñ
 
m∂s_tmp
, *
m∂s
;

954 
m∂s
 = 
	`skb_hódî_poöãr
(
skb
, (
ëhhdr
),

955 (*
m∂s
), &
m∂s_tmp
);

956 i‡(!
m∂s
)

959 
ªt
 = (
	`¡ohl
(
m∂s
->
íåy
Ë& 
MPLS_LS_TC_MASK
)

960 >> 
MPLS_LS_TC_SHIFT
;

961 
out
;

963 
	`ht⁄s
(
ETH_P_80221
):

970 i‡(
qos_m≠
) {

971 
i
, 
tmp_ds˝
 = 
ds˝
 >> 2;

973 
i
 = 0; i < 
qos_m≠
->
num_des
; i++) {

974 i‡(
tmp_ds˝
 =
qos_m≠
->
ds˝_ex˚±i⁄
[
i
].
ds˝
) {

975 
ªt
 = 
qos_m≠
->
ds˝_ex˚±i⁄
[
i
].
up
;

976 
out
;

980 
i
 = 0; i < 8; i++) {

981 i‡(
tmp_ds˝
 >
qos_m≠
->
up
[
i
].
low
 &&

982 
tmp_ds˝
 <
qos_m≠
->
up
[
i
].
high
) {

983 
ªt
 = 
i
;

984 
out
;

993 
ªt
 = 
ds˝
 >> 5;

1006 
ds˝
 >> 2) {

1011 
ªt
 = 0;

1017 
ªt
 = 0;

1023 
ªt
 = 3;

1027 
ªt
 = 4;

1031 
ªt
 = 5;

1035 
ªt
 = 6;

1039 
ªt
 = 6;

1043 
ªt
 = 7;

1046 
out
:

1047  
	`¨øy_ödex_no•ec
(
ªt
, 
IEEE80211_NUM_TIDS
);

1048 
	}
}

1049 
EXPORT_SYMBOL
(
cfg80211_˛assify8021d
);

1051 c⁄° 
ñemít
 *
	$õì80211_bss_gë_ñem
(
cfg80211_bss
 *
bss
, 
u8
 
id
)

1053 c⁄° 
cfg80211_bss_õs
 *
õs
;

1055 
õs
 = 
	`rcu_dîe„ªn˚
(
bss
->ies);

1056 i‡(!
õs
)

1057  
NULL
;

1059  
	`cfg80211_föd_ñem
(
id
, 
õs
->
d©a
, ies->
Àn
);

1060 
	}
}

1061 
EXPORT_SYMBOL
(
õì80211_bss_gë_ñem
);

1063 
	$cfg80211_u∂ﬂd_c⁄√˘_keys
(
wúñess_dev
 *
wdev
)

1065 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1066 
√t_devi˚
 *
dev
 = 
wdev
->
√tdev
;

1067 
i
;

1069 i‡(!
wdev
->
c⁄√˘_keys
)

1072 
i
 = 0; i < 4; i++) {

1073 i‡(!
wdev
->
c⁄√˘_keys
->
∑øms
[
i
].
cùhî
)

1075 i‡(
	`rdev_add_key
(
rdev
, 
dev
, -1, 
i
, 
Ál£
, 
NULL
,

1076 &
wdev
->
c⁄√˘_keys
->
∑øms
[
i
])) {

1077 
	`√tdev_îr
(
dev
, "ÁûedÅÿ£àkey %d\n", 
i
);

1080 i‡(
wdev
->
c⁄√˘_keys
->
def
 =
i
 &&

1081 
	`rdev_£t_deÁu…_key
(
rdev
, 
dev
, -1, 
i
, 
åue
,Årue)) {

1082 
	`√tdev_îr
(
dev
, "ÁûedÅÿ£àdefkey %d\n", 
i
);

1087 
	`k‰ì_£nsôive
(
wdev
->
c⁄√˘_keys
);

1088 
wdev
->
c⁄√˘_keys
 = 
NULL
;

1089 
	}
}

1091 
	$cfg80211_¥o˚ss_wdev_evíts
(
wúñess_dev
 *
wdev
)

1093 
cfg80211_evít
 *
ev
;

1094 
Êags
;

1096 
	`•ö_lock_úqßve
(&
wdev
->
evít_lock
, 
Êags
);

1097 !
	`li°_em±y
(&
wdev
->
evít_li°
)) {

1098 
ev
 = 
	`li°_fú°_íåy
(&
wdev
->
evít_li°
,

1099 
cfg80211_evít
, 
li°
);

1100 
	`li°_dñ
(&
ev
->
li°
);

1101 
	`•ö_u∆ock_úqª°‹e
(&
wdev
->
evít_lock
, 
Êags
);

1103 
ev
->
ty≥
) {

1104 
EVENT_CONNECT_RESULT
:

1105 
	`__cfg80211_c⁄√˘_ªsu…
(

1106 
wdev
->
√tdev
,

1107 &
ev
->
¸
,

1108 
ev
->
¸
.
°©us
 =
WLAN_STATUS_SUCCESS
);

1110 
EVENT_ROAMED
:

1111 
	`__cfg80211_rﬂmed
(
wdev
, &
ev
->
rm
);

1113 
EVENT_DISCONNECTED
:

1114 
	`__cfg80211_disc⁄√˘ed
(
wdev
->
√tdev
,

1115 
ev
->
dc
.
õ
,Év->dc.
õ_Àn
,

1116 
ev
->
dc
.
ªas⁄
,

1117 !
ev
->
dc
.
loˇŒy_gíî©ed
);

1119 
EVENT_IBSS_JOINED
:

1120 
	`__cfg80211_ibss_joöed
(
wdev
->
√tdev
, 
ev
->
ij
.
bssid
,

1121 
ev
->
ij
.
ch™√l
);

1123 
EVENT_STOPPED
:

1124 
	`cfg80211_Àave
(
	`wùhy_to_rdev
(
wdev
->
wùhy
), wdev);

1126 
EVENT_PORT_AUTHORIZED
:

1127 
	`__cfg80211_p‹t_auth‹ized
(
wdev
, 
ev
->
∑
.
≥î_addr
,

1128 
ev
->
∑
.
td_bôm≠
,

1129 
ev
->
∑
.
td_bôm≠_Àn
);

1133 
	`k‰ì
(
ev
);

1135 
	`•ö_lock_úqßve
(&
wdev
->
evít_lock
, 
Êags
);

1137 
	`•ö_u∆ock_úqª°‹e
(&
wdev
->
evít_lock
, 
Êags
);

1138 
	}
}

1140 
	$cfg80211_¥o˚ss_rdev_evíts
(
cfg80211_ªgi°îed_devi˚
 *
rdev
)

1142 
wúñess_dev
 *
wdev
;

1144 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1146 
	`li°_f‹_óch_íåy
(
wdev
, &
rdev
->
wùhy
.
wdev_li°
, 
li°
)

1147 
	`cfg80211_¥o˚ss_wdev_evíts
(
wdev
);

1148 
	}
}

1150 
	$cfg80211_ch™ge_iÁ˚
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

1151 
√t_devi˚
 *
dev
, 
∆80211_i·y≥
 
¡y≥
,

1152 
vif_∑øms
 *
∑øms
)

1154 
îr
;

1155 
∆80211_i·y≥
 
Ÿy≥
 = 
dev
->
õì80211_±r
->
i·y≥
;

1157 
	`lockdï_as£π_hñd
(&
rdev
->
wùhy
.
mtx
);

1160 i‡(
Ÿy≥
 =
NL80211_IFTYPE_AP_VLAN
)

1161  -
EOPNOTSUPP
;

1164 i‡(
¡y≥
 =
NL80211_IFTYPE_P2P_DEVICE
 ||

1165 
¡y≥
 =
NL80211_IFTYPE_NAN
)

1166  -
EOPNOTSUPP
;

1168 i‡(!
rdev
->
›s
->
ch™ge_vútuÆ_ötf
 ||

1169 !(
rdev
->
wùhy
.
öãrÁ˚_modes
 & (1 << 
¡y≥
)))

1170  -
EOPNOTSUPP
;

1172 i‡(
¡y≥
 !
Ÿy≥
) {

1174 i‡(
	`√tif_is_bridge_p‹t
(
dev
) &&

1175 (
¡y≥
 =
NL80211_IFTYPE_ADHOC
 ||

1176 
¡y≥
 =
NL80211_IFTYPE_STATION
 ||

1177 
¡y≥
 =
NL80211_IFTYPE_P2P_CLIENT
))

1178  -
EBUSY
;

1180 
dev
->
õì80211_±r
->
u£_4addr
 = 
Ál£
;

1181 
	`rdev_£t_qos_m≠
(
rdev
, 
dev
, 
NULL
);

1183 
Ÿy≥
) {

1184 
NL80211_IFTYPE_AP
:

1185 
NL80211_IFTYPE_P2P_GO
:

1186 
	`cfg80211_°›_≠
(
rdev
, 
dev
, -1, 
åue
);

1188 
NL80211_IFTYPE_ADHOC
:

1189 
	`cfg80211_Àave_ibss
(
rdev
, 
dev
, 
Ál£
);

1191 
NL80211_IFTYPE_STATION
:

1192 
NL80211_IFTYPE_P2P_CLIENT
:

1193 
	`cfg80211_disc⁄√˘
(
rdev
, 
dev
,

1194 
WLAN_REASON_DEAUTH_LEAVING
, 
åue
);

1196 
NL80211_IFTYPE_MESH_POINT
:

1199 
NL80211_IFTYPE_OCB
:

1200 
	`cfg80211_Àave_ocb
(
rdev
, 
dev
);

1206 
	`cfg80211_¥o˚ss_rdev_evíts
(
rdev
);

1207 
	`cfg80211_mlme_purge_ªgi°øti⁄s
(
dev
->
õì80211_±r
);

1209 
	`mem£t
(&
dev
->
õì80211_±r
->
u
, 0,

1210 (
dev
->
õì80211_±r
->
u
));

1211 
	`mem£t
(&
dev
->
õì80211_±r
->
löks
, 0,

1212 (
dev
->
õì80211_±r
->
löks
));

1215 
îr
 = 
	`rdev_ch™ge_vútuÆ_ötf
(
rdev
, 
dev
, 
¡y≥
, 
∑øms
);

1217 
	`WARN_ON
(!
îr
 && 
dev
->
õì80211_±r
->
i·y≥
 !
¡y≥
);

1219 i‡(!
îr
 && 
∑øms
 &&Ö¨ams->
u£_4addr
 != -1)

1220 
dev
->
õì80211_±r
->
u£_4addr
 = 
∑øms
->use_4addr;

1222 i‡(!
îr
) {

1223 
dev
->
¥iv_Êags
 &~
IFF_DONT_BRIDGE
;

1224 
¡y≥
) {

1225 
NL80211_IFTYPE_STATION
:

1226 i‡(
dev
->
õì80211_±r
->
u£_4addr
)

1228 
ÁŒthrough
;

1229 
NL80211_IFTYPE_OCB
:

1230 
NL80211_IFTYPE_P2P_CLIENT
:

1231 
NL80211_IFTYPE_ADHOC
:

1232 
dev
->
¥iv_Êags
 |
IFF_DONT_BRIDGE
;

1234 
NL80211_IFTYPE_P2P_GO
:

1235 
NL80211_IFTYPE_AP
:

1236 
NL80211_IFTYPE_AP_VLAN
:

1237 
NL80211_IFTYPE_MESH_POINT
:

1240 
NL80211_IFTYPE_MONITOR
:

1243 
NL80211_IFTYPE_UNSPECIFIED
:

1244 
NUM_NL80211_IFTYPES
:

1247 
NL80211_IFTYPE_P2P_DEVICE
:

1248 
NL80211_IFTYPE_WDS
:

1249 
NL80211_IFTYPE_NAN
:

1250 
	`WARN_ON
(1);

1255 i‡(!
îr
 && 
¡y≥
 !
Ÿy≥
 && 
	`√tif_ru¬ög
(
dev
)) {

1256 
	`cfg80211_upd©e_iÁ˚_num
(
rdev
, 
¡y≥
, 1);

1257 
	`cfg80211_upd©e_iÁ˚_num
(
rdev
, 
Ÿy≥
, -1);

1260  
îr
;

1261 
	}
}

1263 
u32
 
	$cfg80211_ˇlcuœã_bôøã_ht
(
øã_öfo
 *
øã
)

1265 
moduœti⁄
, 
°ªams
, 
bôøã
;

1268 i‡(
	`WARN_ON_ONCE
(
øã
->
mcs
 >= 32))

1271 
moduœti⁄
 = 
øã
->
mcs
 & 7;

1272 
°ªams
 = (
øã
->
mcs
 >> 3) + 1;

1274 
bôøã
 = (
øã
->
bw
 =
RATE_INFO_BW_40
) ? 13500000 : 6500000;

1276 i‡(
moduœti⁄
 < 4)

1277 
bôøã
 *(
moduœti⁄
 + 1);

1278 i‡(
moduœti⁄
 == 4)

1279 
bôøã
 *(
moduœti⁄
 + 2);

1281 
bôøã
 *(
moduœti⁄
 + 3);

1283 
bôøã
 *
°ªams
;

1285 i‡(
øã
->
Êags
 & 
RATE_INFO_FLAGS_SHORT_GI
)

1286 
bôøã
 = (bitrate / 9) * 10;

1289  (
bôøã
 + 50000) / 100000;

1290 
	}
}

1292 
u32
 
	$cfg80211_ˇlcuœã_bôøã_dmg
(
øã_öfo
 *
øã
)

1294 c⁄° 
u32
 
__mcs2bôøã
[] = {

1333 i‡(
	`WARN_ON_ONCE
(
øã
->
mcs
 >
	`ARRAY_SIZE
(
__mcs2bôøã
)))

1336  
__mcs2bôøã
[
øã
->
mcs
];

1337 
	}
}

1339 
u32
 
	$cfg80211_ˇlcuœã_bôøã_exãnded_sc_dmg
(
øã_öfo
 *
øã
)

1341 c⁄° 
u32
 
__mcs2bôøã
[] = {

1352 i‡(
	`WARN_ON_ONCE
(
øã
->
mcs
 < 6 ||Ñate->mcs > 12))

1355  
__mcs2bôøã
[
øã
->
mcs
 - 6];

1356 
	}
}

1358 
u32
 
	$cfg80211_ˇlcuœã_bôøã_edmg
(
øã_öfo
 *
øã
)

1360 c⁄° 
u32
 
__mcs2bôøã
[] = {

1386 i‡(
	`WARN_ON_ONCE
(
øã
->
mcs
 >
	`ARRAY_SIZE
(
__mcs2bôøã
)))

1389  
__mcs2bôøã
[
øã
->
mcs
] *Ñ©e->
n_b⁄ded_ch
;

1390 
	}
}

1392 
u32
 
	$cfg80211_ˇlcuœã_bôøã_vht
(
øã_öfo
 *
øã
)

1394 c⁄° 
u32
 
ba£
[4][12] = {

1449 
u32
 
bôøã
;

1450 
idx
;

1452 i‡(
øã
->
mcs
 > 11)

1453 
w¨n
;

1455 
øã
->
bw
) {

1456 
RATE_INFO_BW_160
:

1457 
idx
 = 3;

1459 
RATE_INFO_BW_80
:

1460 
idx
 = 2;

1462 
RATE_INFO_BW_40
:

1463 
idx
 = 1;

1465 
RATE_INFO_BW_5
:

1466 
RATE_INFO_BW_10
:

1468 
w¨n
;

1469 
RATE_INFO_BW_20
:

1470 
idx
 = 0;

1473 
bôøã
 = 
ba£
[
idx
][
øã
->
mcs
];

1474 
bôøã
 *
øã
->
nss
;

1476 i‡(
øã
->
Êags
 & 
RATE_INFO_FLAGS_SHORT_GI
)

1477 
bôøã
 = (bitrate / 9) * 10;

1480  (
bôøã
 + 50000) / 100000;

1481 
w¨n
:

1482 
	`WARN_ONCE
(1, "invalidÑate bw=%d, mcs=%d,Çss=%d\n",

1483 
øã
->
bw
,Ñ©e->
mcs
,Ñ©e->
nss
);

1485 
	}
}

1487 
u32
 
	$cfg80211_ˇlcuœã_bôøã_he
(
øã_öfo
 *
øã
)

1489 
	#SCALE
 6144

	)

1490 
u32
 
mcs_divis‹s
[14] = {

1506 
u32
 
øãs_160M
[3] = { 960777777, 907400000, 816666666 };

1507 
u32
 
øãs_969
[3] = { 480388888, 453700000, 408333333 };

1508 
u32
 
øãs_484
[3] = { 229411111, 216666666, 195000000 };

1509 
u32
 
øãs_242
[3] = { 114711111, 108333333, 97500000 };

1510 
u32
 
øãs_106
[3] = { 40000000, 37777777, 34000000 };

1511 
u32
 
øãs_52
[3] = { 18820000, 17777777, 16000000 };

1512 
u32
 
øãs_26
[3] = { 9411111, 8888888, 8000000 };

1513 
u64
 
tmp
;

1514 
u32
 
ªsu…
;

1516 i‡(
	`WARN_ON_ONCE
(
øã
->
mcs
 > 13))

1519 i‡(
	`WARN_ON_ONCE
(
øã
->
he_gi
 > 
NL80211_RATE_INFO_HE_GI_3_2
))

1521 i‡(
	`WARN_ON_ONCE
(
øã
->
he_ru_Æloc
 >

1522 
NL80211_RATE_INFO_HE_RU_ALLOC_2x996
))

1524 i‡(
	`WARN_ON_ONCE
(
øã
->
nss
 < 1 ||Ñate->nss > 8))

1527 i‡(
øã
->
bw
 =
RATE_INFO_BW_160
)

1528 
ªsu…
 = 
øãs_160M
[
øã
->
he_gi
];

1529 i‡(
øã
->
bw
 =
RATE_INFO_BW_80
 ||

1530 (
øã
->
bw
 =
RATE_INFO_BW_HE_RU
 &&

1531 
øã
->
he_ru_Æloc
 =
NL80211_RATE_INFO_HE_RU_ALLOC_996
))

1532 
ªsu…
 = 
øãs_969
[
øã
->
he_gi
];

1533 i‡(
øã
->
bw
 =
RATE_INFO_BW_40
 ||

1534 (
øã
->
bw
 =
RATE_INFO_BW_HE_RU
 &&

1535 
øã
->
he_ru_Æloc
 =
NL80211_RATE_INFO_HE_RU_ALLOC_484
))

1536 
ªsu…
 = 
øãs_484
[
øã
->
he_gi
];

1537 i‡(
øã
->
bw
 =
RATE_INFO_BW_20
 ||

1538 (
øã
->
bw
 =
RATE_INFO_BW_HE_RU
 &&

1539 
øã
->
he_ru_Æloc
 =
NL80211_RATE_INFO_HE_RU_ALLOC_242
))

1540 
ªsu…
 = 
øãs_242
[
øã
->
he_gi
];

1541 i‡(
øã
->
bw
 =
RATE_INFO_BW_HE_RU
 &&

1542 
øã
->
he_ru_Æloc
 =
NL80211_RATE_INFO_HE_RU_ALLOC_106
)

1543 
ªsu…
 = 
øãs_106
[
øã
->
he_gi
];

1544 i‡(
øã
->
bw
 =
RATE_INFO_BW_HE_RU
 &&

1545 
øã
->
he_ru_Æloc
 =
NL80211_RATE_INFO_HE_RU_ALLOC_52
)

1546 
ªsu…
 = 
øãs_52
[
øã
->
he_gi
];

1547 i‡(
øã
->
bw
 =
RATE_INFO_BW_HE_RU
 &&

1548 
øã
->
he_ru_Æloc
 =
NL80211_RATE_INFO_HE_RU_ALLOC_26
)

1549 
ªsu…
 = 
øãs_26
[
øã
->
he_gi
];

1551 
	`WARN
(1, "invalid HE MCS: bw:%d,Ñu:%d\n",

1552 
øã
->
bw
,Ñ©e->
he_ru_Æloc
);

1557 
tmp
 = 
ªsu…
;

1558 
tmp
 *
SCALE
;

1559 
	`do_div
(
tmp
, 
mcs_divis‹s
[
øã
->
mcs
]);

1560 
ªsu…
 = 
tmp
;

1563 
ªsu…
 = (ªsu… * 
øã
->
nss
) / 8;

1564 i‡(
øã
->
he_dcm
)

1565 
ªsu…
 /= 2;

1567  
ªsu…
 / 10000;

1568 
	}
}

1570 
u32
 
	$cfg80211_ˇlcuœã_bôøã_eht
(
øã_öfo
 *
øã
)

1572 
	#SCALE
 6144

	)

1573 c⁄° 
u32
 
mcs_divis‹s
[16] = {

1591 c⁄° 
u32
 
øãs_996
[3] = { 480388888, 453700000, 408333333 };

1592 c⁄° 
u32
 
øãs_484
[3] = { 229411111, 216666666, 195000000 };

1593 c⁄° 
u32
 
øãs_242
[3] = { 114711111, 108333333, 97500000 };

1594 c⁄° 
u32
 
øãs_106
[3] = { 40000000, 37777777, 34000000 };

1595 c⁄° 
u32
 
øãs_52
[3] = { 18820000, 17777777, 16000000 };

1596 c⁄° 
u32
 
øãs_26
[3] = { 9411111, 8888888, 8000000 };

1597 
u64
 
tmp
;

1598 
u32
 
ªsu…
;

1600 i‡(
	`WARN_ON_ONCE
(
øã
->
mcs
 > 15))

1602 i‡(
	`WARN_ON_ONCE
(
øã
->
eht_gi
 > 
NL80211_RATE_INFO_EHT_GI_3_2
))

1604 i‡(
	`WARN_ON_ONCE
(
øã
->
eht_ru_Æloc
 >

1605 
NL80211_RATE_INFO_EHT_RU_ALLOC_4x996
))

1607 i‡(
	`WARN_ON_ONCE
(
øã
->
nss
 < 1 ||Ñate->nss > 8))

1611 i‡(
øã
->
mcs
 == 14) {

1612 i‡((
øã
->
bw
 !
RATE_INFO_BW_EHT_RU
 &&

1613 
øã
->
bw
 !
RATE_INFO_BW_80
 &&

1614 
øã
->
bw
 !
RATE_INFO_BW_160
 &&

1615 
øã
->
bw
 !
RATE_INFO_BW_320
) ||

1616 (
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1617 
øã
->
eht_ru_Æloc
 !
NL80211_RATE_INFO_EHT_RU_ALLOC_996
 &&

1618 
øã
->
eht_ru_Æloc
 !
NL80211_RATE_INFO_EHT_RU_ALLOC_2x996
 &&

1619 
øã
->
eht_ru_Æloc
 !
NL80211_RATE_INFO_EHT_RU_ALLOC_4x996
)) {

1620 
	`WARN
(1, "invalid EHT BW for MCS 14: bw:%d,Ñu:%d\n",

1621 
øã
->
bw
,Ñ©e->
eht_ru_Æloc
);

1626 i‡(
øã
->
bw
 =
RATE_INFO_BW_320
 ||

1627 (
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1628 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_4x996
))

1629 
ªsu…
 = 4 * 
øãs_996
[
øã
->
eht_gi
];

1630 i‡(
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1631 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_3x996P484
)

1632 
ªsu…
 = 3 * 
øãs_996
[
øã
->
eht_gi
] + 
øãs_484
[rate->eht_gi];

1633 i‡(
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1634 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_3x996
)

1635 
ªsu…
 = 3 * 
øãs_996
[
øã
->
eht_gi
];

1636 i‡(
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1637 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_2x996P484
)

1638 
ªsu…
 = 2 * 
øãs_996
[
øã
->
eht_gi
] + 
øãs_484
[rate->eht_gi];

1639 i‡(
øã
->
bw
 =
RATE_INFO_BW_160
 ||

1640 (
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1641 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_2x996
))

1642 
ªsu…
 = 2 * 
øãs_996
[
øã
->
eht_gi
];

1643 i‡(
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1644 
øã
->
eht_ru_Æloc
 ==

1645 
NL80211_RATE_INFO_EHT_RU_ALLOC_996P484P242
)

1646 
ªsu…
 = 
øãs_996
[
øã
->
eht_gi
] + 
øãs_484
[rate->eht_gi]

1647 + 
øãs_242
[
øã
->
eht_gi
];

1648 i‡(
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1649 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_996P484
)

1650 
ªsu…
 = 
øãs_996
[
øã
->
eht_gi
] + 
øãs_484
[rate->eht_gi];

1651 i‡(
øã
->
bw
 =
RATE_INFO_BW_80
 ||

1652 (
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1653 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_996
))

1654 
ªsu…
 = 
øãs_996
[
øã
->
eht_gi
];

1655 i‡(
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1656 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_484P242
)

1657 
ªsu…
 = 
øãs_484
[
øã
->
eht_gi
] + 
øãs_242
[rate->eht_gi];

1658 i‡(
øã
->
bw
 =
RATE_INFO_BW_40
 ||

1659 (
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1660 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_484
))

1661 
ªsu…
 = 
øãs_484
[
øã
->
eht_gi
];

1662 i‡(
øã
->
bw
 =
RATE_INFO_BW_20
 ||

1663 (
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1664 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_242
))

1665 
ªsu…
 = 
øãs_242
[
øã
->
eht_gi
];

1666 i‡(
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1667 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_106P26
)

1668 
ªsu…
 = 
øãs_106
[
øã
->
eht_gi
] + 
øãs_26
[rate->eht_gi];

1669 i‡(
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1670 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_106
)

1671 
ªsu…
 = 
øãs_106
[
øã
->
eht_gi
];

1672 i‡(
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1673 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_52P26
)

1674 
ªsu…
 = 
øãs_52
[
øã
->
eht_gi
] + 
øãs_26
[rate->eht_gi];

1675 i‡(
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1676 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_52
)

1677 
ªsu…
 = 
øãs_52
[
øã
->
eht_gi
];

1678 i‡(
øã
->
bw
 =
RATE_INFO_BW_EHT_RU
 &&

1679 
øã
->
eht_ru_Æloc
 =
NL80211_RATE_INFO_EHT_RU_ALLOC_26
)

1680 
ªsu…
 = 
øãs_26
[
øã
->
eht_gi
];

1682 
	`WARN
(1, "invalid EHT MCS: bw:%d,Ñu:%d\n",

1683 
øã
->
bw
,Ñ©e->
eht_ru_Æloc
);

1688 
tmp
 = 
ªsu…
;

1689 
tmp
 *
SCALE
;

1690 
	`do_div
(
tmp
, 
mcs_divis‹s
[
øã
->
mcs
]);

1693 
tmp
 *
øã
->
nss
;

1694 
	`do_div
(
tmp
, 8);

1696 
ªsu…
 = 
tmp
;

1698  
ªsu…
 / 10000;

1699 
	}
}

1701 
u32
 
	$cfg80211_ˇlcuœã_bôøã_s1g
(
øã_öfo
 *
øã
)

1704 c⁄° 
u32
 
ba£
[5][11] = {

1763 
u32
 
bôøã
;

1765 
idx
 = 0;

1767 i‡(
øã
->
mcs
 >= 11)

1768 
w¨n
;

1770 
øã
->
bw
) {

1771 
RATE_INFO_BW_16
:

1772 
idx
 = 4;

1774 
RATE_INFO_BW_8
:

1775 
idx
 = 3;

1777 
RATE_INFO_BW_4
:

1778 
idx
 = 2;

1780 
RATE_INFO_BW_2
:

1781 
idx
 = 1;

1783 
RATE_INFO_BW_1
:

1784 
idx
 = 0;

1786 
RATE_INFO_BW_5
:

1787 
RATE_INFO_BW_10
:

1788 
RATE_INFO_BW_20
:

1789 
RATE_INFO_BW_40
:

1790 
RATE_INFO_BW_80
:

1791 
RATE_INFO_BW_160
:

1793 
w¨n
;

1796 
bôøã
 = 
ba£
[
idx
][
øã
->
mcs
];

1797 
bôøã
 *
øã
->
nss
;

1799 i‡(
øã
->
Êags
 & 
RATE_INFO_FLAGS_SHORT_GI
)

1800 
bôøã
 = (bitrate / 9) * 10;

1802  (
bôøã
 + 50000) / 100000;

1803 
w¨n
:

1804 
	`WARN_ONCE
(1, "invalidÑate bw=%d, mcs=%d,Çss=%d\n",

1805 
øã
->
bw
,Ñ©e->
mcs
,Ñ©e->
nss
);

1807 
	}
}

1809 
u32
 
	$cfg80211_ˇlcuœã_bôøã
(
øã_öfo
 *
øã
)

1811 i‡(
øã
->
Êags
 & 
RATE_INFO_FLAGS_MCS
)

1812  
	`cfg80211_ˇlcuœã_bôøã_ht
(
øã
);

1813 i‡(
øã
->
Êags
 & 
RATE_INFO_FLAGS_DMG
)

1814  
	`cfg80211_ˇlcuœã_bôøã_dmg
(
øã
);

1815 i‡(
øã
->
Êags
 & 
RATE_INFO_FLAGS_EXTENDED_SC_DMG
)

1816  
	`cfg80211_ˇlcuœã_bôøã_exãnded_sc_dmg
(
øã
);

1817 i‡(
øã
->
Êags
 & 
RATE_INFO_FLAGS_EDMG
)

1818  
	`cfg80211_ˇlcuœã_bôøã_edmg
(
øã
);

1819 i‡(
øã
->
Êags
 & 
RATE_INFO_FLAGS_VHT_MCS
)

1820  
	`cfg80211_ˇlcuœã_bôøã_vht
(
øã
);

1821 i‡(
øã
->
Êags
 & 
RATE_INFO_FLAGS_HE_MCS
)

1822  
	`cfg80211_ˇlcuœã_bôøã_he
(
øã
);

1823 i‡(
øã
->
Êags
 & 
RATE_INFO_FLAGS_EHT_MCS
)

1824  
	`cfg80211_ˇlcuœã_bôøã_eht
(
øã
);

1825 i‡(
øã
->
Êags
 & 
RATE_INFO_FLAGS_S1G_MCS
)

1826  
	`cfg80211_ˇlcuœã_bôøã_s1g
(
øã
);

1828  
øã
->
Àgacy
;

1829 
	}
}

1830 
EXPORT_SYMBOL
(
cfg80211_ˇlcuœã_bôøã
);

1832 
	$cfg80211_gë_p2p_©å
(c⁄° 
u8
 *
õs
, 
Àn
,

1833 
õì80211_p2p_©å_id
 
©å
,

1834 
u8
 *
buf
, 
bufsize
)

1836 
u8
 *
out
 = 
buf
;

1837 
u16
 
©å_ªmaöög
 = 0;

1838 
boﬁ
 
desúed_©å
 = 
Ál£
;

1839 
u16
 
desúed_Àn
 = 0;

1841 
Àn
 > 0) {

1842 
õd©Æí
;

1843 
c›y
;

1844 c⁄° 
u8
 *
õd©a
;

1846 i‡(
Àn
 < 2)

1847  -
EILSEQ
;

1848 
õd©Æí
 = 
õs
[1];

1849 i‡(
õd©Æí
 + 2 > 
Àn
)

1850  -
EILSEQ
;

1852 i‡(
õs
[0] !
WLAN_EID_VENDOR_SPECIFIC
)

1853 
c⁄t
;

1855 i‡(
õd©Æí
 < 4)

1856 
c⁄t
;

1858 
õd©a
 = 
õs
 + 2;

1861 i‡(
õd©a
[0] != 0x50 || iedata[1] != 0x6f ||

1862 
õd©a
[2] != 0x9a || iedata[3] != 0x09)

1863 
c⁄t
;

1865 
õd©Æí
 -= 4;

1866 
õd©a
 += 4;

1869 
c›y
 = 
	`mö_t
(, 
©å_ªmaöög
, 
õd©Æí
);

1870 i‡(
c›y
 && 
desúed_©å
) {

1871 
desúed_Àn
 +
c›y
;

1872 i‡(
out
) {

1873 
	`mem˝y
(
out
, 
õd©a
, 
	`mö
(
bufsize
, 
c›y
));

1874 
out
 +
	`mö
(
bufsize
, 
c›y
);

1875 
bufsize
 -
	`mö
(bufsize, 
c›y
);

1879 i‡(
c›y
 =
©å_ªmaöög
)

1880  
desúed_Àn
;

1883 
©å_ªmaöög
 -
c›y
;

1884 i‡(
©å_ªmaöög
)

1885 
c⁄t
;

1887 
õd©Æí
 -
c›y
;

1888 
õd©a
 +
c›y
;

1890 
õd©Æí
 > 0) {

1891 
u16
 
©å_Àn
;

1894 i‡(
õd©Æí
 < 3)

1895  -
EILSEQ
;

1896 
desúed_©å
 = 
õd©a
[0] =
©å
;

1897 
©å_Àn
 = 
	`gë_u«lig√d_À16
(
õd©a
 + 1);

1898 
õd©Æí
 -= 3;

1899 
õd©a
 += 3;

1901 
c›y
 = 
	`mö_t
(, 
©å_Àn
, 
õd©Æí
);

1903 i‡(
desúed_©å
) {

1904 
desúed_Àn
 +
c›y
;

1905 i‡(
out
) {

1906 
	`mem˝y
(
out
, 
õd©a
, 
	`mö
(
bufsize
, 
c›y
));

1907 
out
 +
	`mö
(
bufsize
, 
c›y
);

1908 
bufsize
 -
	`mö
(bufsize, 
c›y
);

1911 i‡(
c›y
 =
©å_Àn
)

1912  
desúed_Àn
;

1915 
õd©a
 +
c›y
;

1916 
õd©Æí
 -
c›y
;

1917 
©å_ªmaöög
 = 
©å_Àn
 - 
c›y
;

1920 
c⁄t
:

1921 
Àn
 -
õs
[1] + 2;

1922 
õs
 += ies[1] + 2;

1925 i‡(
©å_ªmaöög
 && 
desúed_©å
)

1926  -
EILSEQ
;

1928  -
ENOENT
;

1929 
	}
}

1930 
EXPORT_SYMBOL
(
cfg80211_gë_p2p_©å
);

1932 
boﬁ
 
	$õì80211_id_ö_li°
(c⁄° 
u8
 *
ids
, 
n_ids
, u8 
id
, 
boﬁ
 
id_ext
)

1934 
i
;

1937 i‡(
	`WARN_ON
(
ids
[
n_ids
 - 1] =
WLAN_EID_EXTENSION
))

1938  
Ál£
;

1940 
i
 = 0;

1941 
i
 < 
n_ids
) {

1942 i‡(
ids
[
i
] =
WLAN_EID_EXTENSION
) {

1943 i‡(
id_ext
 && (
ids
[
i
 + 1] =
id
))

1944  
åue
;

1946 
i
 += 2;

1950 i‡(
ids
[
i
] =
id
 && !
id_ext
)

1951  
åue
;

1953 
i
++;

1955  
Ál£
;

1956 
	}
}

1958 
size_t
 
	$skù_õ
(c⁄° 
u8
 *
õs
, 
size_t
 
õÀn
, size_à
pos
)

1961 
u8
 
Àn
 = 
õs
[
pos
 + 1];

1963 
pos
 +2 + 
Àn
;

1966 i‡(
Àn
 < 255)

1967  
pos
;

1969 
pos
 < 
õÀn
 && 
õs
[pos] =
WLAN_EID_FRAGMENT
) {

1970 
Àn
 = 
õs
[
pos
 + 1];

1971 
pos
 +2 + 
Àn
;

1974  
pos
;

1975 
	}
}

1977 
size_t
 
	$õì80211_õ_•lô_ric
(c⁄° 
u8
 *
õs
, 
size_t
 
õÀn
,

1978 c⁄° 
u8
 *
ids
, 
n_ids
,

1979 c⁄° 
u8
 *
a·î_ric
, 
n_a·î_ric
,

1980 
size_t
 
off£t
)

1982 
size_t
 
pos
 = 
off£t
;

1984 
pos
 < 
õÀn
) {

1985 
u8
 
ext
 = 0;

1987 i‡(
õs
[
pos
] =
WLAN_EID_EXTENSION
)

1988 
ext
 = 2;

1989 i‡((
pos
 + 
ext
Ë>
õÀn
)

1992 i‡(!
	`õì80211_id_ö_li°
(
ids
, 
n_ids
, 
õs
[
pos
 + 
ext
],

1993 
õs
[
pos
] =
WLAN_EID_EXTENSION
))

1996 i‡(
õs
[
pos
] =
WLAN_EID_RIC_DATA
 && 
n_a·î_ric
) {

1997 
pos
 = 
	`skù_õ
(
õs
, 
õÀn
,Öos);

1999 
pos
 < 
õÀn
) {

2000 i‡(
õs
[
pos
] =
WLAN_EID_EXTENSION
)

2001 
ext
 = 2;

2003 
ext
 = 0;

2005 i‡((
pos
 + 
ext
Ë>
õÀn
)

2008 i‡(!
	`õì80211_id_ö_li°
(
a·î_ric
,

2009 
n_a·î_ric
,

2010 
õs
[
pos
 + 
ext
],

2011 
ext
 == 2))

2012 
pos
 = 
	`skù_õ
(
õs
, 
õÀn
,Öos);

2017 
pos
 = 
	`skù_õ
(
õs
, 
õÀn
,Öos);

2021  
pos
;

2022 
	}
}

2023 
EXPORT_SYMBOL
(
õì80211_õ_•lô_ric
);

2025 
	$õì80211_‰agmít_ñemít
(
sk_buff
 *
skb
, 
u8
 *
Àn_pos
, u8 
‰ag_id
)

2027 
ñem_Àn
;

2029 i‡(!
Àn_pos
)

2032 
ñem_Àn
 = 
skb
->
d©a
 + skb->
Àn
 - 
Àn_pos
 - 1;

2034 
ñem_Àn
 > 255) {

2036 *
Àn_pos
 = 255;

2038 
ñem_Àn
 -= 255;

2040 
	`skb_put
(
skb
, 2);

2042 
	`memmove
(
Àn_pos
 + 255 + 3,Üí_po†+ 255 + 1, 
ñem_Àn
);

2044 
Àn_pos
 += 255 + 1;

2045 *
Àn_pos
 = 
‰ag_id
;

2047 
Àn_pos
++;

2050 *
Àn_pos
 = 
ñem_Àn
;

2051 
	}
}

2052 
EXPORT_SYMBOL
(
õì80211_‰agmít_ñemít
);

2054 
boﬁ
 
	$õì80211_›î©ög_˛ass_to_b™d
(
u8
 
›î©ög_˛ass
,

2055 
∆80211_b™d
 *
b™d
)

2057 
›î©ög_˛ass
) {

2061 *
b™d
 = 
NL80211_BAND_5GHZ
;

2062  
åue
;

2065 *
b™d
 = 
NL80211_BAND_6GHZ
;

2066  
åue
;

2071 *
b™d
 = 
NL80211_BAND_2GHZ
;

2072  
åue
;

2074 *
b™d
 = 
NL80211_BAND_60GHZ
;

2075  
åue
;

2078  
Ál£
;

2079 
	}
}

2080 
EXPORT_SYMBOL
(
õì80211_›î©ög_˛ass_to_b™d
);

2082 
boﬁ
 
	$õì80211_›î©ög_˛ass_to_ch™def
(
u8
 
›î©ög_˛ass
,

2083 
õì80211_ch™√l
 *
ch™
,

2084 
cfg80211_ch™_def
 *
ch™def
)

2086 
u32
 
c⁄åﬁ_‰eq
, 
off£t
 = 0;

2087 
∆80211_b™d
 
b™d
;

2089 i‡(!
	`õì80211_›î©ög_˛ass_to_b™d
(
›î©ög_˛ass
, &
b™d
) ||

2090 !
ch™
 || 
b™d
 != chan->band)

2091  
Ál£
;

2093 
c⁄åﬁ_‰eq
 = 
ch™
->
˚¡î_‰eq
;

2094 
ch™def
->
ch™
 = chan;

2096 i‡(
c⁄åﬁ_‰eq
 >= 5955)

2097 
off£t
 = 
c⁄åﬁ_‰eq
 - 5955;

2098 i‡(
c⁄åﬁ_‰eq
 >= 5745)

2099 
off£t
 = 
c⁄åﬁ_‰eq
 - 5745;

2100 i‡(
c⁄åﬁ_‰eq
 >= 5180)

2101 
off£t
 = 
c⁄åﬁ_‰eq
 - 5180;

2102 
off£t
 /= 20;

2104 
›î©ög_˛ass
) {

2114 
ch™def
->
˚¡î_‰eq1
 = 
c⁄åﬁ_‰eq
;

2115 
ch™def
->
width
 = 
NL80211_CHAN_WIDTH_20
;

2116  
åue
;

2122 
ch™def
->
˚¡î_‰eq1
 = 
c⁄åﬁ_‰eq
 + 10;

2123 
ch™def
->
width
 = 
NL80211_CHAN_WIDTH_40
;

2124  
åue
;

2130 
ch™def
->
˚¡î_‰eq1
 = 
c⁄åﬁ_‰eq
 - 10;

2131 
ch™def
->
width
 = 
NL80211_CHAN_WIDTH_40
;

2132  
åue
;

2134 
ch™def
->
˚¡î_‰eq1
 = 
c⁄åﬁ_‰eq
 + 10 - (
off£t
 & 1) * 20;

2135 
ch™def
->
width
 = 
NL80211_CHAN_WIDTH_40
;

2136  
åue
;

2139 
ch™def
->
˚¡î_‰eq1
 = 
c⁄åﬁ_‰eq
 + 30 - (
off£t
 & 3) * 20;

2140 
ch™def
->
width
 = 
NL80211_CHAN_WIDTH_80
;

2141  
åue
;

2144 
ch™def
->
˚¡î_‰eq1
 = 
c⁄åﬁ_‰eq
 + 70 - (
off£t
 & 7) * 20;

2145 
ch™def
->
width
 = 
NL80211_CHAN_WIDTH_160
;

2146  
åue
;

2153  
Ál£
;

2155 
	}
}

2156 
EXPORT_SYMBOL
(
õì80211_›î©ög_˛ass_to_ch™def
);

2158 
boﬁ
 
	$õì80211_ch™def_to_›î©ög_˛ass
(
cfg80211_ch™_def
 *
ch™def
,

2159 
u8
 *
›_˛ass
)

2161 
u8
 
vht_›˛ass
;

2162 
u32
 
‰eq
 = 
ch™def
->
˚¡î_‰eq1
;

2164 i‡(
‰eq
 >= 2412 && freq <= 2472) {

2165 i‡(
ch™def
->
width
 > 
NL80211_CHAN_WIDTH_40
)

2166  
Ál£
;

2169 i‡(
ch™def
->
width
 =
NL80211_CHAN_WIDTH_40
) {

2170 i‡(
‰eq
 > 
ch™def
->
ch™
->
˚¡î_‰eq
)

2171 *
›_˛ass
 = 83;

2173 *
›_˛ass
 = 84;

2175 *
›_˛ass
 = 81;

2178  
åue
;

2181 i‡(
‰eq
 == 2484) {

2183 i‡(
ch™def
->
width
 !
NL80211_CHAN_WIDTH_20_NOHT
)

2184  
Ál£
;

2186 *
›_˛ass
 = 82;

2187  
åue
;

2190 
ch™def
->
width
) {

2191 
NL80211_CHAN_WIDTH_80
:

2192 
vht_›˛ass
 = 128;

2194 
NL80211_CHAN_WIDTH_160
:

2195 
vht_›˛ass
 = 129;

2197 
NL80211_CHAN_WIDTH_80P80
:

2198 
vht_›˛ass
 = 130;

2200 
NL80211_CHAN_WIDTH_10
:

2201 
NL80211_CHAN_WIDTH_5
:

2202  
Ál£
;

2204 
vht_›˛ass
 = 0;

2209 i‡(
‰eq
 >= 5180 && freq <= 5240) {

2210 i‡(
vht_›˛ass
) {

2211 *
›_˛ass
 = 
vht_›˛ass
;

2212 } i‡(
ch™def
->
width
 =
NL80211_CHAN_WIDTH_40
) {

2213 i‡(
‰eq
 > 
ch™def
->
ch™
->
˚¡î_‰eq
)

2214 *
›_˛ass
 = 116;

2216 *
›_˛ass
 = 117;

2218 *
›_˛ass
 = 115;

2221  
åue
;

2225 i‡(
‰eq
 >= 5260 && freq <= 5320) {

2226 i‡(
vht_›˛ass
) {

2227 *
›_˛ass
 = 
vht_›˛ass
;

2228 } i‡(
ch™def
->
width
 =
NL80211_CHAN_WIDTH_40
) {

2229 i‡(
‰eq
 > 
ch™def
->
ch™
->
˚¡î_‰eq
)

2230 *
›_˛ass
 = 119;

2232 *
›_˛ass
 = 120;

2234 *
›_˛ass
 = 118;

2237  
åue
;

2241 i‡(
‰eq
 >= 5500 && freq <= 5720) {

2242 i‡(
vht_›˛ass
) {

2243 *
›_˛ass
 = 
vht_›˛ass
;

2244 } i‡(
ch™def
->
width
 =
NL80211_CHAN_WIDTH_40
) {

2245 i‡(
‰eq
 > 
ch™def
->
ch™
->
˚¡î_‰eq
)

2246 *
›_˛ass
 = 122;

2248 *
›_˛ass
 = 123;

2250 *
›_˛ass
 = 121;

2253  
åue
;

2257 i‡(
‰eq
 >= 5745 && freq <= 5845) {

2258 i‡(
vht_›˛ass
) {

2259 *
›_˛ass
 = 
vht_›˛ass
;

2260 } i‡(
ch™def
->
width
 =
NL80211_CHAN_WIDTH_40
) {

2261 i‡(
‰eq
 > 
ch™def
->
ch™
->
˚¡î_‰eq
)

2262 *
›_˛ass
 = 126;

2264 *
›_˛ass
 = 127;

2265 } i‡(
‰eq
 <= 5805) {

2266 *
›_˛ass
 = 124;

2268 *
›_˛ass
 = 125;

2271  
åue
;

2275 i‡(
‰eq
 >= 56160 + 2160 * 1 && freq <= 56160 + 2160 * 6) {

2276 i‡(
ch™def
->
width
 >
NL80211_CHAN_WIDTH_40
)

2277  
Ál£
;

2279 *
›_˛ass
 = 180;

2280  
åue
;

2284  
Ál£
;

2285 
	}
}

2286 
EXPORT_SYMBOL
(
õì80211_ch™def_to_›î©ög_˛ass
);

2288 
	$cfg80211_wdev_bi
(
wúñess_dev
 *
wdev
)

2290 
wdev
->
i·y≥
) {

2291 
NL80211_IFTYPE_AP
:

2292 
NL80211_IFTYPE_P2P_GO
:

2293 
	`WARN_ON
(
wdev
->
vÆid_löks
);

2294  
wdev
->
löks
[0].
≠
.
bóc⁄_öãrvÆ
;

2295 
NL80211_IFTYPE_MESH_POINT
:

2296  
wdev
->
u
.
mesh
.
bóc⁄_öãrvÆ
;

2297 
NL80211_IFTYPE_ADHOC
:

2298  
wdev
->
u
.
ibss
.
bóc⁄_öãrvÆ
;

2304 
	}
}

2306 
	$cfg80211_ˇlcuœã_bi_d©a
(
wùhy
 *wùhy, 
u32
 
√w_bóc⁄_öt
,

2307 
u32
 *
bóc⁄_öt_gcd
,

2308 
boﬁ
 *
bóc⁄_öt_dif„ª¡
)

2310 
wúñess_dev
 *
wdev
;

2312 *
bóc⁄_öt_gcd
 = 0;

2313 *
bóc⁄_öt_dif„ª¡
 = 
Ál£
;

2315 
	`li°_f‹_óch_íåy
(
wdev
, &
wùhy
->
wdev_li°
, 
li°
) {

2316 
wdev_bi
;

2319 i‡(
wdev
->
vÆid_löks
)

2322 
wdev_bi
 = 
	`cfg80211_wdev_bi
(
wdev
);

2324 i‡(!
wdev_bi
)

2327 i‡(!*
bóc⁄_öt_gcd
) {

2328 *
bóc⁄_öt_gcd
 = 
wdev_bi
;

2332 i‡(
wdev_bi
 =*
bóc⁄_öt_gcd
)

2335 *
bóc⁄_öt_dif„ª¡
 = 
åue
;

2336 *
bóc⁄_öt_gcd
 = 
	`gcd
(*bóc⁄_öt_gcd, 
wdev_bi
);

2339 i‡(
√w_bóc⁄_öt
 && *
bóc⁄_öt_gcd
 !=Çew_beacon_int) {

2340 i‡(*
bóc⁄_öt_gcd
)

2341 *
bóc⁄_öt_dif„ª¡
 = 
åue
;

2342 *
bóc⁄_öt_gcd
 = 
	`gcd
(*bóc⁄_öt_gcd, 
√w_bóc⁄_öt
);

2344 
	}
}

2346 
	$cfg80211_vÆid©e_bóc⁄_öt
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

2347 
∆80211_i·y≥
 
i·y≥
, 
u32
 
bóc⁄_öt
)

2357 i‡(
bóc⁄_öt
 < 10 || beacon_int > 10000)

2358  -
EINVAL
;

2361 
	}
}

2363 
	$cfg80211_ôî_combö©i⁄s
(
wùhy
 *wiphy,

2364 
iÁ˚_combö©i⁄_∑øms
 *
∑øms
,

2365 (*
ôî
)(c⁄° 
õì80211_iÁ˚_combö©i⁄
 *
c
,

2366 *
d©a
),

2367 *
d©a
)

2369 c⁄° 
õì80211_ªgdomaö
 *
ªgdom
;

2370 
∆80211_dfs_ªgi⁄s
 
ªgi⁄
 = 0;

2371 
i
, 
j
, 
i·y≥
;

2372 
num_öãrÁ˚s
 = 0;

2373 
u32
 
u£d_i·y≥s
 = 0;

2374 
u32
 
bóc⁄_öt_gcd
;

2375 
boﬁ
 
bóc⁄_öt_dif„ª¡
;

2387 
	`cfg80211_ˇlcuœã_bi_d©a
(
wùhy
, 
∑øms
->
√w_bóc⁄_öt
,

2388 &
bóc⁄_öt_gcd
, &
bóc⁄_öt_dif„ª¡
);

2390 i‡(
∑øms
->
ød¨_dëe˘
) {

2391 
	`rcu_ªad_lock
();

2392 
ªgdom
 = 
	`rcu_dîe„ªn˚
(
cfg80211_ªgdomaö
);

2393 i‡(
ªgdom
)

2394 
ªgi⁄
 = 
ªgdom
->
dfs_ªgi⁄
;

2395 
	`rcu_ªad_u∆ock
();

2398 
i·y≥
 = 0; i·y≥ < 
NUM_NL80211_IFTYPES
; iftype++) {

2399 
num_öãrÁ˚s
 +
∑øms
->
i·y≥_num
[
i·y≥
];

2400 i‡(
∑øms
->
i·y≥_num
[
i·y≥
] > 0 &&

2401 !
	`cfg80211_i·y≥_Ælowed
(
wùhy
, 
i·y≥
, 0, 1))

2402 
u£d_i·y≥s
 |
	`BIT
(
i·y≥
);

2405 
i
 = 0; i < 
wùhy
->
n_iÁ˚_combö©i⁄s
; i++) {

2406 c⁄° 
õì80211_iÁ˚_combö©i⁄
 *
c
;

2407 
õì80211_iÁ˚_limô
 *
limôs
;

2408 
u32
 
Æl_i·y≥s
 = 0;

2410 
c
 = &
wùhy
->
iÁ˚_combö©i⁄s
[
i
];

2412 i‡(
num_öãrÁ˚s
 > 
c
->
max_öãrÁ˚s
)

2414 i‡(
∑øms
->
num_dif„ª¡_ch™√ls
 > 
c
->num_different_channels)

2417 
limôs
 = 
	`kmemdup
(
c
->limôs, ÷imôs[0]Ë* c->
n_limôs
,

2418 
GFP_KERNEL
);

2419 i‡(!
limôs
)

2420  -
ENOMEM
;

2422 
i·y≥
 = 0; i·y≥ < 
NUM_NL80211_IFTYPES
; iftype++) {

2423 i‡(
	`cfg80211_i·y≥_Ælowed
(
wùhy
, 
i·y≥
, 0, 1))

2425 
j
 = 0; j < 
c
->
n_limôs
; j++) {

2426 
Æl_i·y≥s
 |
limôs
[
j
].
ty≥s
;

2427 i‡(!(
limôs
[
j
].
ty≥s
 & 
	`BIT
(
i·y≥
)))

2429 i‡(
limôs
[
j
].
max
 < 
∑øms
->
i·y≥_num
[
i·y≥
])

2430 
c⁄t
;

2431 
limôs
[
j
].
max
 -
∑øms
->
i·y≥_num
[
i·y≥
];

2435 i‡(
∑øms
->
ød¨_dëe˘
 !=

2436 (
c
->
ød¨_dëe˘_widths
 & 
∑øms
->
ød¨_dëe˘
))

2437 
c⁄t
;

2439 i‡(
∑øms
->
ød¨_dëe˘
 && 
c
->
ød¨_dëe˘_ªgi⁄s
 &&

2440 !(
c
->
ød¨_dëe˘_ªgi⁄s
 & 
	`BIT
(
ªgi⁄
)))

2441 
c⁄t
;

2448 i‡((
Æl_i·y≥s
 & 
u£d_i·y≥s
) != used_iftypes)

2449 
c⁄t
;

2451 i‡(
bóc⁄_öt_gcd
) {

2452 i‡(
c
->
bóc⁄_öt_mö_gcd
 &&

2453 
bóc⁄_öt_gcd
 < 
c
->
bóc⁄_öt_mö_gcd
)

2454 
c⁄t
;

2455 i‡(!
c
->
bóc⁄_öt_mö_gcd
 && 
bóc⁄_öt_dif„ª¡
)

2456 
c⁄t
;

2463 (*
ôî
)(
c
, 
d©a
);

2464 
c⁄t
:

2465 
	`k‰ì
(
limôs
);

2469 
	}
}

2470 
EXPORT_SYMBOL
(
cfg80211_ôî_combö©i⁄s
);

2473 
	$cfg80211_ôî_sum_ifcombs
(c⁄° 
õì80211_iÁ˚_combö©i⁄
 *
c
,

2474 *
d©a
)

2476 *
num
 = 
d©a
;

2477 (*
num
)++;

2478 
	}
}

2480 
	$cfg80211_check_combö©i⁄s
(
wùhy
 *wiphy,

2481 
iÁ˚_combö©i⁄_∑øms
 *
∑øms
)

2483 
îr
, 
num
 = 0;

2485 
îr
 = 
	`cfg80211_ôî_combö©i⁄s
(
wùhy
, 
∑øms
,

2486 
cfg80211_ôî_sum_ifcombs
, &
num
);

2487 i‡(
îr
)

2488  
îr
;

2489 i‡(
num
 == 0)

2490  -
EBUSY
;

2493 
	}
}

2494 
EXPORT_SYMBOL
(
cfg80211_check_combö©i⁄s
);

2496 
	$õì80211_gë_øãmask
(
õì80211_suµ‹ãd_b™d
 *
sb™d
,

2497 c⁄° 
u8
 *
øãs
, 
n_øãs
,

2498 
u32
 *
mask
)

2500 
i
, 
j
;

2502 i‡(!
sb™d
)

2503  -
EINVAL
;

2505 i‡(
n_øãs
 =0 ||Ç_øã†> 
NL80211_MAX_SUPP_RATES
)

2506  -
EINVAL
;

2508 *
mask
 = 0;

2510 
i
 = 0; i < 
n_øãs
; i++) {

2511 
øã
 = (
øãs
[
i
] & 0x7f) * 5;

2512 
boﬁ
 
found
 = 
Ál£
;

2514 
j
 = 0; j < 
sb™d
->
n_bôøãs
; j++) {

2515 i‡(
sb™d
->
bôøãs
[
j
].
bôøã
 =
øã
) {

2516 
found
 = 
åue
;

2517 *
mask
 |
	`BIT
(
j
);

2521 i‡(!
found
)

2522  -
EINVAL
;

2532 
	}
}

2534 
	$õì80211_gë_num_suµ‹ãd_ch™√ls
(
wùhy
 *wiphy)

2536 
∆80211_b™d
 
b™d
;

2537 
n_ch™√ls
 = 0;

2539 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++)

2540 i‡(
wùhy
->
b™ds
[
b™d
])

2541 
n_ch™√ls
 +
wùhy
->
b™ds
[
b™d
]->n_channels;

2543  
n_ch™√ls
;

2544 
	}
}

2545 
EXPORT_SYMBOL
(
õì80211_gë_num_suµ‹ãd_ch™√ls
);

2547 
	$cfg80211_gë_°©i⁄
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
mac_addr
,

2548 
°©i⁄_öfo
 *
söfo
)

2550 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

2551 
wúñess_dev
 *
wdev
;

2553 
wdev
 = 
dev
->
õì80211_±r
;

2554 i‡(!
wdev
)

2555  -
EOPNOTSUPP
;

2557 
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

2558 i‡(!
rdev
->
›s
->
gë_°©i⁄
)

2559  -
EOPNOTSUPP
;

2561 
	`mem£t
(
söfo
, 0, (*sinfo));

2563  
	`rdev_gë_°©i⁄
(
rdev
, 
dev
, 
mac_addr
, 
söfo
);

2564 
	}
}

2565 
EXPORT_SYMBOL
(
cfg80211_gë_°©i⁄
);

2567 
	$cfg80211_‰ì_«n_func
(
cfg80211_«n_func
 *
f
)

2569 
i
;

2571 i‡(!
f
)

2574 
	`k‰ì
(
f
->
£rv_•ec_öfo
);

2575 
	`k‰ì
(
f
->
§f_bf
);

2576 
	`k‰ì
(
f
->
§f_macs
);

2577 
i
 = 0; i < 
f
->
num_rx_fûãrs
; i++)

2578 
	`k‰ì
(
f
->
rx_fûãrs
[
i
].
fûãr
);

2580 
i
 = 0; i < 
f
->
num_tx_fûãrs
; i++)

2581 
	`k‰ì
(
f
->
tx_fûãrs
[
i
].
fûãr
);

2583 
	`k‰ì
(
f
->
rx_fûãrs
);

2584 
	`k‰ì
(
f
->
tx_fûãrs
);

2585 
	`k‰ì
(
f
);

2586 
	}
}

2587 
EXPORT_SYMBOL
(
cfg80211_‰ì_«n_func
);

2589 
boﬁ
 
	$cfg80211_d€s_bw_fô_ønge
(c⁄° 
õì80211_‰eq_ønge
 *
‰eq_ønge
,

2590 
u32
 
˚¡î_‰eq_khz
, u32 
bw_khz
)

2592 
u32
 
°¨t_‰eq_khz
, 
íd_‰eq_khz
;

2594 
°¨t_‰eq_khz
 = 
˚¡î_‰eq_khz
 - (
bw_khz
 / 2);

2595 
íd_‰eq_khz
 = 
˚¡î_‰eq_khz
 + (
bw_khz
 / 2);

2597 i‡(
°¨t_‰eq_khz
 >
‰eq_ønge
->start_freq_khz &&

2598 
íd_‰eq_khz
 <
‰eq_ønge
->end_freq_khz)

2599  
åue
;

2601  
Ál£
;

2602 
	}
}

2604 
	$cfg80211_söfo_Æloc_tid_°©s
(
°©i⁄_öfo
 *
söfo
, 
gÂ_t
 
gÂ
)

2606 
söfo
->
≥πid
 = 
	`kˇŒoc
(
IEEE80211_NUM_TIDS
 + 1,

2607 (*(
söfo
->
≥πid
)),

2608 
gÂ
);

2609 i‡(!
söfo
->
≥πid
)

2610  -
ENOMEM
;

2613 
	}
}

2614 
EXPORT_SYMBOL
(
cfg80211_söfo_Æloc_tid_°©s
);

2618 c⁄° 
	grfc1042_hódî
[] 
__Æig√d
(2) =

2620 
EXPORT_SYMBOL
(
rfc1042_hódî
);

2623 c⁄° 
	gbridge_tu¬ñ_hódî
[] 
__Æig√d
(2) =

2625 
EXPORT_SYMBOL
(
bridge_tu¬ñ_hódî
);

2628 
	süµ_œyî2_upd©e
 {

2629 
u8
 
	mda
[
ETH_ALEN
];

2630 
u8
 
	mß
[
ETH_ALEN
];

2631 
__be16
 
	mÀn
;

2632 
u8
 
	mdßp
;

2633 
u8
 
	msßp
;

2634 
u8
 
	mc⁄åﬁ
;

2635 
u8
 
	mxid_öfo
[3];

2636 } 
	g__∑cked
;

2638 
	$cfg80211_£nd_œyî2_upd©e
(
√t_devi˚
 *
dev
, c⁄° 
u8
 *
addr
)

2640 
üµ_œyî2_upd©e
 *
msg
;

2641 
sk_buff
 *
skb
;

2646 
skb
 = 
	`dev_Æloc_skb
((*
msg
));

2647 i‡(!
skb
)

2649 
msg
 = 
	`skb_put
(
skb
, (*msg));

2654 
	`ëh_brﬂdˇ°_addr
(
msg
->
da
);

2655 
	`ëhî_addr_c›y
(
msg
->
ß
, 
addr
);

2656 
msg
->
Àn
 = 
	`ht⁄s
(6);

2657 
msg
->
dßp
 = 0;

2658 
msg
->
sßp
 = 0x01;

2659 
msg
->
c⁄åﬁ
 = 0xaf;

2661 
msg
->
xid_öfo
[0] = 0x81;

2662 
msg
->
xid_öfo
[1] = 1;

2663 
msg
->
xid_öfo
[2] = 0;

2665 
skb
->
dev
 = dev;

2666 
skb
->
¥Ÿocﬁ
 = 
	`ëh_ty≥_å™s
(skb, 
dev
);

2667 
	`mem£t
(
skb
->
cb
, 0, (skb->cb));

2668 
	`√tif_rx
(
skb
);

2669 
	}
}

2670 
EXPORT_SYMBOL
(
cfg80211_£nd_œyî2_upd©e
);

2672 
	$õì80211_gë_vht_max_nss
(
õì80211_vht_ˇp
 *
ˇp
,

2673 
õì80211_vht_ch™width
 
bw
,

2674 
mcs
, 
boﬁ
 
ext_nss_bw_ˇ∑bÀ
,

2675 
max_vht_nss
)

2677 
u16
 
m≠
 = 
	`À16_to_˝u
(
ˇp
->
suµ_mcs
.
rx_mcs_m≠
);

2678 
ext_nss_bw
;

2679 
suµ_width
;

2680 
i
, 
mcs_ícodög
;

2682 i‡(
m≠
 == 0xffff)

2685 i‡(
	`WARN_ON
(
mcs
 > 9 || 
max_vht_nss
 > 8))

2687 i‡(
mcs
 <= 7)

2688 
mcs_ícodög
 = 0;

2689 i‡(
mcs
 == 8)

2690 
mcs_ícodög
 = 1;

2692 
mcs_ícodög
 = 2;

2694 i‡(!
max_vht_nss
) {

2696 
i
 = 7; i >= 0; i--) {

2697 
suµ
 = (
m≠
 >> (2 * 
i
)) & 3;

2699 i‡(
suµ
 == 3)

2702 i‡(
suµ
 >
mcs_ícodög
) {

2703 
max_vht_nss
 = 
i
 + 1;

2709 i‡(!(
ˇp
->
suµ_mcs
.
tx_mcs_m≠
 &

2710 
	`˝u_to_À16
(
IEEE80211_VHT_EXT_NSS_BW_CAPABLE
)))

2711  
max_vht_nss
;

2713 
ext_nss_bw
 = 
	`À32_gë_bôs
(
ˇp
->
vht_ˇp_öfo
,

2714 
IEEE80211_VHT_CAP_EXT_NSS_BW_MASK
);

2715 
suµ_width
 = 
	`À32_gë_bôs
(
ˇp
->
vht_ˇp_öfo
,

2716 
IEEE80211_VHT_CAP_SUPP_CHAN_WIDTH_MASK
);

2719 i‡(!
ext_nss_bw_ˇ∑bÀ
)

2720 
ext_nss_bw
 = 0;

2723 i‡(
suµ_width
 == 3)

2727 i‡(
suµ_width
 =2 && (
ext_nss_bw
 == 1 ||Éxt_nss_bw == 2))

2735 
bw
) {

2736 
IEEE80211_VHT_CHANWIDTH_USE_HT
:

2737 
IEEE80211_VHT_CHANWIDTH_80MHZ
:

2738 i‡((
suµ_width
 == 1 || supp_width == 2) &&

2739 
ext_nss_bw
 == 3)

2740  2 * 
max_vht_nss
;

2742 
IEEE80211_VHT_CHANWIDTH_160MHZ
:

2743 i‡(
suµ_width
 == 0 &&

2744 (
ext_nss_bw
 == 1 ||Éxt_nss_bw == 2))

2745  
max_vht_nss
 / 2;

2746 i‡(
suµ_width
 == 0 &&

2747 
ext_nss_bw
 == 3)

2748  (3 * 
max_vht_nss
) / 4;

2749 i‡(
suµ_width
 == 1 &&

2750 
ext_nss_bw
 == 3)

2751  2 * 
max_vht_nss
;

2753 
IEEE80211_VHT_CHANWIDTH_80P80MHZ
:

2754 i‡(
suµ_width
 =0 && 
ext_nss_bw
 == 1)

2756 i‡(
suµ_width
 == 0 &&

2757 
ext_nss_bw
 == 2)

2758  
max_vht_nss
 / 2;

2759 i‡(
suµ_width
 == 0 &&

2760 
ext_nss_bw
 == 3)

2761  (3 * 
max_vht_nss
) / 4;

2762 i‡(
suµ_width
 == 1 &&

2763 
ext_nss_bw
 == 0)

2765 i‡(
suµ_width
 == 1 &&

2766 
ext_nss_bw
 == 1)

2767  
max_vht_nss
 / 2;

2768 i‡(
suµ_width
 == 1 &&

2769 
ext_nss_bw
 == 2)

2770  (3 * 
max_vht_nss
) / 4;

2775  
max_vht_nss
;

2776 
	}
}

2777 
EXPORT_SYMBOL
(
õì80211_gë_vht_max_nss
);

2779 
boﬁ
 
	$cfg80211_i·y≥_Ælowed
(
wùhy
 *wùhy, 
∆80211_i·y≥
 
i·y≥
,

2780 
boﬁ
 
is_4addr
, 
u8
 
check_swif
)

2783 
boﬁ
 
is_vœn
 = 
i·y≥
 =
NL80211_IFTYPE_AP_VLAN
;

2785 
check_swif
) {

2787 i‡(
is_vœn
 && 
is_4addr
)

2788  
wùhy
->
Êags
 & 
WIPHY_FLAG_4ADDR_AP
;

2789  
wùhy
->
öãrÁ˚_modes
 & 
	`BIT
(
i·y≥
);

2791 i‡(!(
wùhy
->
so·w¨e_i·y≥s
 & 
	`BIT
(
i·y≥
)Ë&& 
is_vœn
)

2792  
wùhy
->
Êags
 & 
WIPHY_FLAG_4ADDR_AP
;

2793  
wùhy
->
so·w¨e_i·y≥s
 & 
	`BIT
(
i·y≥
);

2798  
Ál£
;

2799 
	}
}

2800 
EXPORT_SYMBOL
(
cfg80211_i·y≥_Ælowed
);

2802 
	$cfg80211_ªmove_lök
(
wúñess_dev
 *
wdev
, 
lök_id
)

2804 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

2806 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

2808 
wdev
->
i·y≥
) {

2809 
NL80211_IFTYPE_AP
:

2810 
NL80211_IFTYPE_P2P_GO
:

2811 
	`cfg80211_°›_≠
(
rdev
, 
wdev
->
√tdev
, 
lök_id
, 
åue
);

2818 
wdev
->
vÆid_löks
 &~
	`BIT
(
lök_id
);

2820 
	`rdev_dñ_ötf_lök
(
rdev
, 
wdev
, 
lök_id
);

2822 
	`ëh_zîo_addr
(
wdev
->
löks
[
lök_id
].
addr
);

2823 
	}
}

2825 
	$cfg80211_ªmove_löks
(
wúñess_dev
 *
wdev
)

2827 
lök_id
;

2833 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_AP
)

2836 i‡(
wdev
->
vÆid_löks
) {

2837 
	`f‹_óch_vÆid_lök
(
wdev
, 
lök_id
)

2838 
	`cfg80211_ªmove_lök
(
wdev
, 
lök_id
);

2840 
	}
}

2842 
	$cfg80211_ªmove_vútuÆ_ötf
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

2843 
wúñess_dev
 *
wdev
)

2845 
	`cfg80211_ªmove_löks
(
wdev
);

2847  
	`rdev_dñ_vútuÆ_ötf
(
rdev
, 
wdev
);

2848 
	}
}

2850 c⁄° 
wùhy_i·y≥_ext_ˇ∑b
 *

2851 
	$cfg80211_gë_i·y≥_ext_ˇ∑
(
wùhy
 *wùhy, 
∆80211_i·y≥
 
ty≥
)

2853 
i
;

2855 
i
 = 0; i < 
wùhy
->
num_i·y≥_ext_ˇ∑b
; i++) {

2856 i‡(
wùhy
->
i·y≥_ext_ˇ∑b
[
i
].
i·y≥
 =
ty≥
)

2857  &
wùhy
->
i·y≥_ext_ˇ∑b
[
i
];

2860  
NULL
;

2861 
	}
}

2862 
EXPORT_SYMBOL
(
cfg80211_gë_i·y≥_ext_ˇ∑
);

	@wext-compat.c

13 
	~<löux/exp‹t.h
>

14 
	~<löux/wúñess.h
>

15 
	~<löux/∆80211.h
>

16 
	~<löux/if_¨p.h
>

17 
	~<löux/ëhîdevi˚.h
>

18 
	~<löux/¶ab.h
>

19 
	~<√t/iw_h™dÀr.h
>

20 
	~<√t/cfg80211.h
>

21 
	~<√t/cfg80211-wext.h
>

22 
	~"wext-com∑t.h
"

23 
	~"c‹e.h
"

24 
	~"rdev-›s.h
"

26 
	$cfg80211_wext_giw«me
(
√t_devi˚
 *
dev
,

27 
iw_ªque°_öfo
 *
öfo
,

28 
iwªq_d©a
 *
wrqu
, *
exåa
)

30 
	`°r˝y
(
wrqu
->
«me
, "IEEE 802.11");

32 
	}
}

33 
EXPORT_WEXT_HANDLER
(
cfg80211_wext_giw«me
);

35 
	$cfg80211_wext_siwmode
(
√t_devi˚
 *
dev
, 
iw_ªque°_öfo
 *
öfo
,

36 
iwªq_d©a
 *
wrqu
, *
exåa
)

38 
__u32
 *
mode
 = &
wrqu
->mode;

39 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

40 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

41 
vif_∑øms
 
viÂ¨ams
;

42 
∆80211_i·y≥
 
ty≥
;

43 
ªt
;

45 
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

47 *
mode
) {

48 
IW_MODE_INFRA
:

49 
ty≥
 = 
NL80211_IFTYPE_STATION
;

51 
IW_MODE_ADHOC
:

52 
ty≥
 = 
NL80211_IFTYPE_ADHOC
;

54 
IW_MODE_MONITOR
:

55 
ty≥
 = 
NL80211_IFTYPE_MONITOR
;

58  -
EINVAL
;

61 i‡(
ty≥
 =
wdev
->
i·y≥
)

64 
	`mem£t
(&
viÂ¨ams
, 0, (vifparams));

66 
	`wùhy_lock
(
wdev
->
wùhy
);

67 
ªt
 = 
	`cfg80211_ch™ge_iÁ˚
(
rdev
, 
dev
, 
ty≥
, &
viÂ¨ams
);

68 
	`wùhy_u∆ock
(
wdev
->
wùhy
);

70  
ªt
;

71 
	}
}

72 
EXPORT_WEXT_HANDLER
(
cfg80211_wext_siwmode
);

74 
	$cfg80211_wext_giwmode
(
√t_devi˚
 *
dev
, 
iw_ªque°_öfo
 *
öfo
,

75 
iwªq_d©a
 *
wrqu
, *
exåa
)

77 
__u32
 *
mode
 = &
wrqu
->mode;

78 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

80 i‡(!
wdev
)

81  -
EOPNOTSUPP
;

83 
wdev
->
i·y≥
) {

84 
NL80211_IFTYPE_AP
:

85 *
mode
 = 
IW_MODE_MASTER
;

87 
NL80211_IFTYPE_STATION
:

88 *
mode
 = 
IW_MODE_INFRA
;

90 
NL80211_IFTYPE_ADHOC
:

91 *
mode
 = 
IW_MODE_ADHOC
;

93 
NL80211_IFTYPE_MONITOR
:

94 *
mode
 = 
IW_MODE_MONITOR
;

96 
NL80211_IFTYPE_WDS
:

97 *
mode
 = 
IW_MODE_REPEAT
;

99 
NL80211_IFTYPE_AP_VLAN
:

100 *
mode
 = 
IW_MODE_SECOND
;

103 *
mode
 = 
IW_MODE_AUTO
;

107 
	}
}

108 
EXPORT_WEXT_HANDLER
(
cfg80211_wext_giwmode
);

111 
	$cfg80211_wext_giwønge
(
√t_devi˚
 *
dev
,

112 
iw_ªque°_öfo
 *
öfo
,

113 
iwªq_d©a
 *
wrqu
, *
exåa
)

115 
iw_poöt
 *
d©a
 = &
wrqu
->data;

116 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

117 
iw_ønge
 *
ønge
 = (iw_øngê*Ë
exåa
;

118 
∆80211_b™d
 
b™d
;

119 
i
, 
c
 = 0;

121 i‡(!
wdev
)

122  -
EOPNOTSUPP
;

124 
d©a
->
Àngth
 = (
iw_ønge
);

125 
	`mem£t
(
ønge
, 0, (
iw_ønge
));

127 
ønge
->
we_vîsi⁄_compûed
 = 
WIRELESS_EXT
;

128 
ønge
->
we_vîsi⁄_sour˚
 = 21;

129 
ønge
->
ªåy_ˇ∑
 = 
IW_RETRY_LIMIT
;

130 
ønge
->
ªåy_Êags
 = 
IW_RETRY_LIMIT
;

131 
ønge
->
mö_ªåy
 = 0;

132 
ønge
->
max_ªåy
 = 255;

133 
ønge
->
mö_πs
 = 0;

134 
ønge
->
max_πs
 = 2347;

135 
ønge
->
mö_‰ag
 = 256;

136 
ønge
->
max_‰ag
 = 2346;

138 
ønge
->
max_ícodög_tokís
 = 4;

140 
ønge
->
max_quÆ
.
upd©ed
 = 
IW_QUAL_NOISE_INVALID
;

142 
wdev
->
wùhy
->
sig«l_ty≥
) {

143 
CFG80211_SIGNAL_TYPE_NONE
:

145 
CFG80211_SIGNAL_TYPE_MBM
:

146 
ønge
->
max_quÆ
.
Àvñ
 = (
u8
)-110;

147 
ønge
->
max_quÆ
.
quÆ
 = 70;

148 
ønge
->
avg_quÆ
.
quÆ
 = 35;

149 
ønge
->
max_quÆ
.
upd©ed
 |
IW_QUAL_DBM
;

150 
ønge
->
max_quÆ
.
upd©ed
 |
IW_QUAL_QUAL_UPDATED
;

151 
ønge
->
max_quÆ
.
upd©ed
 |
IW_QUAL_LEVEL_UPDATED
;

153 
CFG80211_SIGNAL_TYPE_UNSPEC
:

154 
ønge
->
max_quÆ
.
Àvñ
 = 100;

155 
ønge
->
max_quÆ
.
quÆ
 = 100;

156 
ønge
->
avg_quÆ
.
quÆ
 = 50;

157 
ønge
->
max_quÆ
.
upd©ed
 |
IW_QUAL_QUAL_UPDATED
;

158 
ønge
->
max_quÆ
.
upd©ed
 |
IW_QUAL_LEVEL_UPDATED
;

162 
ønge
->
avg_quÆ
.
Àvñ
 =Ñ™ge->
max_quÆ
.level / 2;

163 
ønge
->
avg_quÆ
.
noi£
 =Ñ™ge->
max_quÆ
.noise / 2;

164 
ønge
->
avg_quÆ
.
upd©ed
 =Ñ™ge->
max_quÆ
.updated;

166 
i
 = 0; i < 
wdev
->
wùhy
->
n_cùhî_suôes
; i++) {

167 
wdev
->
wùhy
->
cùhî_suôes
[
i
]) {

168 
WLAN_CIPHER_SUITE_TKIP
:

169 
ønge
->
íc_ˇ∑
 |(
IW_ENC_CAPA_CIPHER_TKIP
 |

170 
IW_ENC_CAPA_WPA
);

173 
WLAN_CIPHER_SUITE_CCMP
:

174 
ønge
->
íc_ˇ∑
 |(
IW_ENC_CAPA_CIPHER_CCMP
 |

175 
IW_ENC_CAPA_WPA2
);

178 
WLAN_CIPHER_SUITE_WEP40
:

179 
ønge
->
ícodög_size
[ønge->
num_ícodög_sizes
++] =

180 
WLAN_KEY_LEN_WEP40
;

183 
WLAN_CIPHER_SUITE_WEP104
:

184 
ønge
->
ícodög_size
[ønge->
num_ícodög_sizes
++] =

185 
WLAN_KEY_LEN_WEP104
;

190 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band ++) {

191 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

193 
sb™d
 = 
wdev
->
wùhy
->
b™ds
[
b™d
];

195 i‡(!
sb™d
)

198 
i
 = 0; i < 
sb™d
->
n_ch™√ls
 && 
c
 < 
IW_MAX_FREQUENCIES
; i++) {

199 
õì80211_ch™√l
 *
ch™
 = &
sb™d
->
ch™√ls
[
i
];

201 i‡(!(
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)) {

202 
ønge
->
‰eq
[
c
].
i
 =

203 
	`õì80211_‰equícy_to_ch™√l
(

204 
ch™
->
˚¡î_‰eq
);

205 
ønge
->
‰eq
[
c
].
m
 = 
ch™
->
˚¡î_‰eq
;

206 
ønge
->
‰eq
[
c
].
e
 = 6;

207 
c
++;

211 
ønge
->
num_ch™√ls
 = 
c
;

212 
ønge
->
num_‰equícy
 = 
c
;

214 
	`IW_EVENT_CAPA_SET_KERNEL
(
ønge
->
evít_ˇ∑
);

215 
	`IW_EVENT_CAPA_SET
(
ønge
->
evít_ˇ∑
, 
SIOCGIWAP
);

216 
	`IW_EVENT_CAPA_SET
(
ønge
->
evít_ˇ∑
, 
SIOCGIWSCAN
);

218 i‡(
wdev
->
wùhy
->
max_sˇn_ssids
 > 0)

219 
ønge
->
sˇn_ˇ∑
 |
IW_SCAN_CAPA_ESSID
;

222 
	}
}

223 
EXPORT_WEXT_HANDLER
(
cfg80211_wext_giwønge
);

232 
	$cfg80211_wext_‰eq
(
iw_‰eq
 *
‰eq
)

238 i‡(
‰eq
->
e
 == 0) {

239 
∆80211_b™d
 
b™d
 = 
NL80211_BAND_2GHZ
;

240 i‡(
‰eq
->
m
 < 0)

242 i‡(
‰eq
->
m
 > 14)

243 
b™d
 = 
NL80211_BAND_5GHZ
;

244  
	`õì80211_ch™√l_to_‰equícy
(
‰eq
->
m
, 
b™d
);

246 
i
, 
div
 = 1000000;

247 
i
 = 0; i < 
‰eq
->
e
; i++)

248 
div
 /= 10;

249 i‡(
div
 <= 0)

250  -
EINVAL
;

251  
‰eq
->
m
 / 
div
;

253 
	}
}

255 
	$cfg80211_wext_siwπs
(
√t_devi˚
 *
dev
,

256 
iw_ªque°_öfo
 *
öfo
,

257 
iwªq_d©a
 *
wrqu
, *
exåa
)

259 
iw_∑øm
 *
πs
 = &
wrqu
->rts;

260 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

261 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

262 
u32
 
‹ts
 = 
wdev
->
wùhy
->
πs_thªshﬁd
;

263 
îr
;

265 
	`wùhy_lock
(&
rdev
->
wùhy
);

266 i‡(
πs
->
dißbÀd
 || !πs->
fixed
) {

267 
wdev
->
wùhy
->
πs_thªshﬁd
 = (
u32
) -1;

268 } i‡(
πs
->
vÆue
 < 0) {

269 
îr
 = -
EINVAL
;

270 
out
;

272 
wdev
->
wùhy
->
πs_thªshﬁd
 = 
πs
->
vÆue
;

275 
îr
 = 
	`rdev_£t_wùhy_∑øms
(
rdev
, 
WIPHY_PARAM_RTS_THRESHOLD
);

277 i‡(
îr
)

278 
wdev
->
wùhy
->
πs_thªshﬁd
 = 
‹ts
;

280 
out
:

281 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

282  
îr
;

283 
	}
}

284 
EXPORT_WEXT_HANDLER
(
cfg80211_wext_siwπs
);

286 
	$cfg80211_wext_giwπs
(
√t_devi˚
 *
dev
,

287 
iw_ªque°_öfo
 *
öfo
,

288 
iwªq_d©a
 *
wrqu
, *
exåa
)

290 
iw_∑øm
 *
πs
 = &
wrqu
->rts;

291 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

293 
πs
->
vÆue
 = 
wdev
->
wùhy
->
πs_thªshﬁd
;

294 
πs
->
dißbÀd
 =Ñts->
vÆue
 =(
u32
) -1;

295 
πs
->
fixed
 = 1;

298 
	}
}

299 
EXPORT_WEXT_HANDLER
(
cfg80211_wext_giwπs
);

301 
	$cfg80211_wext_siw‰ag
(
√t_devi˚
 *
dev
,

302 
iw_ªque°_öfo
 *
öfo
,

303 
iwªq_d©a
 *
wrqu
, *
exåa
)

305 
iw_∑øm
 *
‰ag
 = &
wrqu
->frag;

306 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

307 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

308 
u32
 
o‰ag
 = 
wdev
->
wùhy
->
‰ag_thªshﬁd
;

309 
îr
;

311 
	`wùhy_lock
(&
rdev
->
wùhy
);

312 i‡(
‰ag
->
dißbÀd
 || !‰ag->
fixed
) {

313 
wdev
->
wùhy
->
‰ag_thªshﬁd
 = (
u32
) -1;

314 } i‡(
‰ag
->
vÆue
 < 256) {

315 
îr
 = -
EINVAL
;

316 
out
;

319 
wdev
->
wùhy
->
‰ag_thªshﬁd
 = 
‰ag
->
vÆue
 & ~0x1;

322 
îr
 = 
	`rdev_£t_wùhy_∑øms
(
rdev
, 
WIPHY_PARAM_FRAG_THRESHOLD
);

323 i‡(
îr
)

324 
wdev
->
wùhy
->
‰ag_thªshﬁd
 = 
o‰ag
;

325 
out
:

326 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

328  
îr
;

329 
	}
}

330 
EXPORT_WEXT_HANDLER
(
cfg80211_wext_siw‰ag
);

332 
	$cfg80211_wext_giw‰ag
(
√t_devi˚
 *
dev
,

333 
iw_ªque°_öfo
 *
öfo
,

334 
iwªq_d©a
 *
wrqu
, *
exåa
)

336 
iw_∑øm
 *
‰ag
 = &
wrqu
->frag;

337 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

339 
‰ag
->
vÆue
 = 
wdev
->
wùhy
->
‰ag_thªshﬁd
;

340 
‰ag
->
dißbÀd
 = føg->
vÆue
 =(
u32
) -1;

341 
‰ag
->
fixed
 = 1;

344 
	}
}

345 
EXPORT_WEXT_HANDLER
(
cfg80211_wext_giw‰ag
);

347 
	$cfg80211_wext_siwªåy
(
√t_devi˚
 *
dev
,

348 
iw_ªque°_öfo
 *
öfo
,

349 
iwªq_d©a
 *
wrqu
, *
exåa
)

351 
iw_∑øm
 *
ªåy
 = &
wrqu
->retry;

352 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

353 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

354 
u32
 
ch™ged
 = 0;

355 
u8
 
ﬁ⁄g
 = 
wdev
->
wùhy
->
ªåy_l⁄g
;

356 
u8
 
osh‹t
 = 
wdev
->
wùhy
->
ªåy_sh‹t
;

357 
îr
;

359 i‡(
ªåy
->
dißbÀd
 ||Ñëry->
vÆue
 < 1 ||Ñetry->value > 255 ||

360 (
ªåy
->
Êags
 & 
IW_RETRY_TYPE
Ë!
IW_RETRY_LIMIT
)

361  -
EINVAL
;

363 
	`wùhy_lock
(&
rdev
->
wùhy
);

364 i‡(
ªåy
->
Êags
 & 
IW_RETRY_LONG
) {

365 
wdev
->
wùhy
->
ªåy_l⁄g
 = 
ªåy
->
vÆue
;

366 
ch™ged
 |
WIPHY_PARAM_RETRY_LONG
;

367 } i‡(
ªåy
->
Êags
 & 
IW_RETRY_SHORT
) {

368 
wdev
->
wùhy
->
ªåy_sh‹t
 = 
ªåy
->
vÆue
;

369 
ch™ged
 |
WIPHY_PARAM_RETRY_SHORT
;

371 
wdev
->
wùhy
->
ªåy_sh‹t
 = 
ªåy
->
vÆue
;

372 
wdev
->
wùhy
->
ªåy_l⁄g
 = 
ªåy
->
vÆue
;

373 
ch™ged
 |
WIPHY_PARAM_RETRY_LONG
;

374 
ch™ged
 |
WIPHY_PARAM_RETRY_SHORT
;

377 
îr
 = 
	`rdev_£t_wùhy_∑øms
(
rdev
, 
ch™ged
);

378 i‡(
îr
) {

379 
wdev
->
wùhy
->
ªåy_sh‹t
 = 
osh‹t
;

380 
wdev
->
wùhy
->
ªåy_l⁄g
 = 
ﬁ⁄g
;

382 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

384  
îr
;

385 
	}
}

387 
	$cfg80211_wext_giwªåy
(
√t_devi˚
 *
dev
,

388 
iw_ªque°_öfo
 *
öfo
,

389 
iwªq_d©a
 *
wrqu
, *
exåa
)

391 
iw_∑øm
 *
ªåy
 = &
wrqu
->retry;

392 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

394 
ªåy
->
dißbÀd
 = 0;

396 i‡(
ªåy
->
Êags
 =0 || (ªåy->Êag†& 
IW_RETRY_SHORT
)) {

401 
ªåy
->
Êags
 |
IW_RETRY_LIMIT
 | 
IW_RETRY_SHORT
;

402 
ªåy
->
vÆue
 = 
wdev
->
wùhy
->
ªåy_sh‹t
;

403 i‡(
wdev
->
wùhy
->
ªåy_l⁄g
 =wdev->wùhy->
ªåy_sh‹t
)

404 
ªåy
->
Êags
 |
IW_RETRY_LONG
;

409 i‡(
ªåy
->
Êags
 & 
IW_RETRY_LONG
) {

410 
ªåy
->
Êags
 = 
IW_RETRY_LIMIT
 | 
IW_RETRY_LONG
;

411 
ªåy
->
vÆue
 = 
wdev
->
wùhy
->
ªåy_l⁄g
;

415 
	}
}

416 
EXPORT_WEXT_HANDLER
(
cfg80211_wext_giwªåy
);

418 
	$cfg80211_£t_í¸y±i⁄
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

419 
√t_devi˚
 *
dev
, 
boﬁ
 
∑úwi£
,

420 c⁄° 
u8
 *
addr
, 
boﬁ
 
ªmove
, boﬁ 
tx_key
,

421 
idx
, 
key_∑øms
 *
∑øms
)

423 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

424 
îr
, 
i
;

425 
boﬁ
 
ªjoö
 = 
Ál£
;

427 i‡(
wdev
->
vÆid_löks
)

428  -
EINVAL
;

430 i‡(
∑úwi£
 && !
addr
)

431  -
EINVAL
;

437 i‡(!
wdev
->
wext
.
keys
) {

438 
wdev
->
wext
.
keys
 = 
	`kzÆloc
((*wdev->wext.keys),

439 
GFP_KERNEL
);

440 i‡(!
wdev
->
wext
.
keys
)

441  -
ENOMEM
;

442 
i
 = 0; i < 4; i++)

443 
wdev
->
wext
.
keys
->
∑øms
[
i
].
key
 =

444 
wdev
->
wext
.
keys
->
d©a
[
i
];

447 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
 &&

448 
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
)

449  -
EOPNOTSUPP
;

451 i‡(
∑øms
->
cùhî
 =
WLAN_CIPHER_SUITE_AES_CMAC
) {

452 i‡(!
wdev
->
c⁄√˘ed
)

453  -
ENOLINK
;

455 i‡(!
rdev
->
›s
->
£t_deÁu…_mgmt_key
)

456  -
EOPNOTSUPP
;

458 i‡(
idx
 < 4 || idx > 5)

459  -
EINVAL
;

460 } i‡(
idx
 < 0 || idx > 3)

461  -
EINVAL
;

463 i‡(
ªmove
) {

464 
îr
 = 0;

465 i‡(
wdev
->
c⁄√˘ed
 ||

466 (
wdev
->
i·y≥
 =
NL80211_IFTYPE_ADHOC
 &&

467 
wdev
->
u
.
ibss
.
cuºít_bss
)) {

472 i‡(
idx
 =
wdev
->
wext
.
deÁu…_key
 &&

473 
wdev
->
i·y≥
 =
NL80211_IFTYPE_ADHOC
) {

474 
	`cfg80211_Àave_ibss
(
rdev
, 
wdev
->
√tdev
, 
åue
);

475 
ªjoö
 = 
åue
;

478 i‡(!
∑úwi£
 && 
addr
 &&

479 !(
rdev
->
wùhy
.
Êags
 & 
WIPHY_FLAG_IBSS_RSN
))

480 
îr
 = -
ENOENT
;

482 
îr
 = 
	`rdev_dñ_key
(
rdev
, 
dev
, -1, 
idx
, 
∑úwi£
,

483 
addr
);

485 
wdev
->
wext
.
c⁄√˘
.
¥ivacy
 = 
Ál£
;

490 i‡(
îr
 =-
ENOENT
)

491 
îr
 = 0;

492 i‡(!
îr
) {

493 i‡(!
addr
 && 
idx
 < 4) {

494 
	`mem£t
(
wdev
->
wext
.
keys
->
d©a
[
idx
], 0,

495 (
wdev
->
wext
.
keys
->
d©a
[
idx
]));

496 
wdev
->
wext
.
keys
->
∑øms
[
idx
].
key_Àn
 = 0;

497 
wdev
->
wext
.
keys
->
∑øms
[
idx
].
cùhî
 = 0;

499 i‡(
idx
 =
wdev
->
wext
.
deÁu…_key
)

500 
wdev
->
wext
.
deÁu…_key
 = -1;

501 i‡(
idx
 =
wdev
->
wext
.
deÁu…_mgmt_key
)

502 
wdev
->
wext
.
deÁu…_mgmt_key
 = -1;

505 i‡(!
îr
 && 
ªjoö
)

506 
îr
 = 
	`cfg80211_ibss_wext_joö
(
rdev
, 
wdev
);

508  
îr
;

511 i‡(
addr
)

512 
tx_key
 = 
Ál£
;

514 i‡(
	`cfg80211_vÆid©e_key_£âögs
(
rdev
, 
∑øms
, 
idx
, 
∑úwi£
, 
addr
))

515  -
EINVAL
;

517 
îr
 = 0;

518 i‡(
wdev
->
c⁄√˘ed
 ||

519 (
wdev
->
i·y≥
 =
NL80211_IFTYPE_ADHOC
 &&

520 
wdev
->
u
.
ibss
.
cuºít_bss
))

521 
îr
 = 
	`rdev_add_key
(
rdev
, 
dev
, -1, 
idx
, 
∑úwi£
, 
addr
, 
∑øms
);

522 i‡(
∑øms
->
cùhî
 !
WLAN_CIPHER_SUITE_WEP40
 &&

523 
∑øms
->
cùhî
 !
WLAN_CIPHER_SUITE_WEP104
)

524  -
EINVAL
;

525 i‡(
îr
)

526  
îr
;

533 i‡(!
addr
 && (
∑øms
->
cùhî
 =
WLAN_CIPHER_SUITE_WEP40
 ||

534 
∑øms
->
cùhî
 =
WLAN_CIPHER_SUITE_WEP104
)) {

535 
wdev
->
wext
.
keys
->
∑øms
[
idx
] = *params;

536 
	`mem˝y
(
wdev
->
wext
.
keys
->
d©a
[
idx
],

537 
∑øms
->
key
,Ö¨ams->
key_Àn
);

538 
wdev
->
wext
.
keys
->
∑øms
[
idx
].
key
 =

539 
wdev
->
wext
.
keys
->
d©a
[
idx
];

542 i‡((
∑øms
->
cùhî
 =
WLAN_CIPHER_SUITE_WEP40
 ||

543 
∑øms
->
cùhî
 =
WLAN_CIPHER_SUITE_WEP104
) &&

544 (
tx_key
 || (!
addr
 && 
wdev
->
wext
.
deÁu…_key
 == -1))) {

545 i‡(
wdev
->
c⁄√˘ed
 ||

546 (
wdev
->
i·y≥
 =
NL80211_IFTYPE_ADHOC
 &&

547 
wdev
->
u
.
ibss
.
cuºít_bss
)) {

553 i‡(
wdev
->
i·y≥
 =
NL80211_IFTYPE_ADHOC
 &&

554 
wdev
->
wext
.
deÁu…_key
 == -1) {

555 
	`cfg80211_Àave_ibss
(
rdev
, 
wdev
->
√tdev
, 
åue
);

556 
ªjoö
 = 
åue
;

558 
îr
 = 
	`rdev_£t_deÁu…_key
(
rdev
, 
dev
, -1, 
idx
, 
åue
,

559 
åue
);

561 i‡(!
îr
) {

562 
wdev
->
wext
.
deÁu…_key
 = 
idx
;

563 i‡(
ªjoö
)

564 
îr
 = 
	`cfg80211_ibss_wext_joö
(
rdev
, 
wdev
);

566  
îr
;

569 i‡(
∑øms
->
cùhî
 =
WLAN_CIPHER_SUITE_AES_CMAC
 &&

570 (
tx_key
 || (!
addr
 && 
wdev
->
wext
.
deÁu…_mgmt_key
 == -1))) {

571 i‡(
wdev
->
c⁄√˘ed
 ||

572 (
wdev
->
i·y≥
 =
NL80211_IFTYPE_ADHOC
 &&

573 
wdev
->
u
.
ibss
.
cuºít_bss
))

574 
îr
 = 
	`rdev_£t_deÁu…_mgmt_key
(
rdev
, 
dev
, -1, 
idx
);

575 i‡(!
îr
)

576 
wdev
->
wext
.
deÁu…_mgmt_key
 = 
idx
;

577  
îr
;

581 
	}
}

583 
	$cfg80211_wext_siwícode
(
√t_devi˚
 *
dev
,

584 
iw_ªque°_öfo
 *
öfo
,

585 
iwªq_d©a
 *
wrqu
, *
keybuf
)

587 
iw_poöt
 *
îq
 = &
wrqu
->
ícodög
;

588 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

589 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

590 
idx
, 
îr
;

591 
boﬁ
 
ªmove
 = 
Ál£
;

592 
key_∑øms
 
∑øms
;

594 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

595 
wdev
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
)

596  -
EOPNOTSUPP
;

599 i‡(!
rdev
->
›s
->
dñ_key
 ||

600 !
rdev
->
›s
->
add_key
 ||

601 !
rdev
->
›s
->
£t_deÁu…_key
)

602  -
EOPNOTSUPP
;

604 
	`wùhy_lock
(&
rdev
->
wùhy
);

605 i‡(
wdev
->
vÆid_löks
) {

606 
îr
 = -
EOPNOTSUPP
;

607 
out
;

610 
idx
 = 
îq
->
Êags
 & 
IW_ENCODE_INDEX
;

611 i‡(
idx
 == 0) {

612 
idx
 = 
wdev
->
wext
.
deÁu…_key
;

613 i‡(
idx
 < 0)

614 
idx
 = 0;

615 } i‡(
idx
 < 1 || idx > 4) {

616 
îr
 = -
EINVAL
;

617 
out
;

619 
idx
--;

622 i‡(
îq
->
Êags
 & 
IW_ENCODE_DISABLED
)

623 
ªmove
 = 
åue
;

624 i‡(
îq
->
Àngth
 == 0) {

626 
îr
 = 0;

627 i‡(
wdev
->
c⁄√˘ed
 ||

628 (
wdev
->
i·y≥
 =
NL80211_IFTYPE_ADHOC
 &&

629 
wdev
->
u
.
ibss
.
cuºít_bss
))

630 
îr
 = 
	`rdev_£t_deÁu…_key
(
rdev
, 
dev
, -1, 
idx
, 
åue
,

631 
åue
);

632 i‡(!
îr
)

633 
wdev
->
wext
.
deÁu…_key
 = 
idx
;

634 
out
;

637 
	`mem£t
(&
∑øms
, 0, (params));

638 
∑øms
.
key
 = 
keybuf
;

639 
∑øms
.
key_Àn
 = 
îq
->
Àngth
;

640 i‡(
îq
->
Àngth
 == 5) {

641 
∑øms
.
cùhî
 = 
WLAN_CIPHER_SUITE_WEP40
;

642 } i‡(
îq
->
Àngth
 == 13) {

643 
∑øms
.
cùhî
 = 
WLAN_CIPHER_SUITE_WEP104
;

644 } i‡(!
ªmove
) {

645 
îr
 = -
EINVAL
;

646 
out
;

649 
îr
 = 
	`cfg80211_£t_í¸y±i⁄
(
rdev
, 
dev
, 
Ál£
, 
NULL
, 
ªmove
,

650 
wdev
->
wext
.
deÁu…_key
 == -1,

651 
idx
, &
∑øms
);

652 
out
:

653 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

655  
îr
;

656 
	}
}

658 
	$cfg80211_wext_siwícodìxt
(
√t_devi˚
 *
dev
,

659 
iw_ªque°_öfo
 *
öfo
,

660 
iwªq_d©a
 *
wrqu
, *
exåa
)

662 
iw_poöt
 *
îq
 = &
wrqu
->
ícodög
;

663 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

664 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

665 
iw_ícode_ext
 *
ext
 = (iw_ícode_exà*Ë
exåa
;

666 c⁄° 
u8
 *
addr
;

667 
idx
;

668 
boﬁ
 
ªmove
 = 
Ál£
;

669 
key_∑øms
 
∑øms
;

670 
u32
 
cùhî
;

671 
ªt
;

673 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

674 
wdev
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
)

675  -
EOPNOTSUPP
;

678 i‡(!
rdev
->
›s
->
dñ_key
 ||

679 !
rdev
->
›s
->
add_key
 ||

680 !
rdev
->
›s
->
£t_deÁu…_key
)

681  -
EOPNOTSUPP
;

683 i‡(
wdev
->
vÆid_löks
)

684  -
EOPNOTSUPP
;

686 
ext
->
Æg
) {

687 
IW_ENCODE_ALG_NONE
:

688 
ªmove
 = 
åue
;

689 
cùhî
 = 0;

691 
IW_ENCODE_ALG_WEP
:

692 i‡(
ext
->
key_Àn
 == 5)

693 
cùhî
 = 
WLAN_CIPHER_SUITE_WEP40
;

694 i‡(
ext
->
key_Àn
 == 13)

695 
cùhî
 = 
WLAN_CIPHER_SUITE_WEP104
;

697  -
EINVAL
;

699 
IW_ENCODE_ALG_TKIP
:

700 
cùhî
 = 
WLAN_CIPHER_SUITE_TKIP
;

702 
IW_ENCODE_ALG_CCMP
:

703 
cùhî
 = 
WLAN_CIPHER_SUITE_CCMP
;

705 
IW_ENCODE_ALG_AES_CMAC
:

706 
cùhî
 = 
WLAN_CIPHER_SUITE_AES_CMAC
;

709  -
EOPNOTSUPP
;

712 i‡(
îq
->
Êags
 & 
IW_ENCODE_DISABLED
)

713 
ªmove
 = 
åue
;

715 
idx
 = 
îq
->
Êags
 & 
IW_ENCODE_INDEX
;

716 i‡(
cùhî
 =
WLAN_CIPHER_SUITE_AES_CMAC
) {

717 i‡(
idx
 < 4 || idx > 5) {

718 
idx
 = 
wdev
->
wext
.
deÁu…_mgmt_key
;

719 i‡(
idx
 < 0)

720  -
EINVAL
;

722 
idx
--;

724 i‡(
idx
 < 1 || idx > 4) {

725 
idx
 = 
wdev
->
wext
.
deÁu…_key
;

726 i‡(
idx
 < 0)

727  -
EINVAL
;

729 
idx
--;

732 
addr
 = 
ext
->addr.
ß_d©a
;

733 i‡(
	`is_brﬂdˇ°_ëhî_addr
(
addr
))

734 
addr
 = 
NULL
;

736 
	`mem£t
(&
∑øms
, 0, (params));

737 
∑øms
.
key
 = 
ext
->key;

738 
∑øms
.
key_Àn
 = 
ext
->key_len;

739 
∑øms
.
cùhî
 = cipher;

741 i‡(
ext
->
ext_Êags
 & 
IW_ENCODE_EXT_RX_SEQ_VALID
) {

742 
∑øms
.
£q
 = 
ext
->
rx_£q
;

743 
∑øms
.
£q_Àn
 = 6;

746 
	`wùhy_lock
(
wdev
->
wùhy
);

747 
ªt
 = 
	`cfg80211_£t_í¸y±i⁄
(

748 
rdev
, 
dev
,

749 !(
ext
->
ext_Êags
 & 
IW_ENCODE_EXT_GROUP_KEY
),

750 
addr
, 
ªmove
,

751 
ext
->
ext_Êags
 & 
IW_ENCODE_EXT_SET_TX_KEY
,

752 
idx
, &
∑øms
);

753 
	`wùhy_u∆ock
(
wdev
->
wùhy
);

755  
ªt
;

756 
	}
}

758 
	$cfg80211_wext_giwícode
(
√t_devi˚
 *
dev
,

759 
iw_ªque°_öfo
 *
öfo
,

760 
iwªq_d©a
 *
wrqu
, *
keybuf
)

762 
iw_poöt
 *
îq
 = &
wrqu
->
ícodög
;

763 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

764 
idx
;

766 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
 &&

767 
wdev
->
i·y≥
 !
NL80211_IFTYPE_ADHOC
)

768  -
EOPNOTSUPP
;

770 
idx
 = 
îq
->
Êags
 & 
IW_ENCODE_INDEX
;

771 i‡(
idx
 == 0) {

772 
idx
 = 
wdev
->
wext
.
deÁu…_key
;

773 i‡(
idx
 < 0)

774 
idx
 = 0;

775 } i‡(
idx
 < 1 || idx > 4)

776  -
EINVAL
;

778 
idx
--;

780 
îq
->
Êags
 = 
idx
 + 1;

782 i‡(!
wdev
->
wext
.
keys
 || !wdev->wext.keys->
∑øms
[
idx
].
cùhî
) {

783 
îq
->
Êags
 |
IW_ENCODE_DISABLED
;

784 
îq
->
Àngth
 = 0;

788 
îq
->
Àngth
 = 
	`mö_t
(
size_t
,Érq->length,

789 
wdev
->
wext
.
keys
->
∑øms
[
idx
].
key_Àn
);

790 
	`mem˝y
(
keybuf
, 
wdev
->
wext
.
keys
->
∑øms
[
idx
].
key
, 
îq
->
Àngth
);

791 
îq
->
Êags
 |
IW_ENCODE_ENABLED
;

794 
	}
}

796 
	$cfg80211_wext_siw‰eq
(
√t_devi˚
 *
dev
,

797 
iw_ªque°_öfo
 *
öfo
,

798 
iwªq_d©a
 *
wrqu
, *
exåa
)

800 
iw_‰eq
 *
wext‰eq
 = &
wrqu
->
‰eq
;

801 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

802 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

803 
cfg80211_ch™_def
 
ch™def
 = {

804 .
width
 = 
NL80211_CHAN_WIDTH_20_NOHT
,

806 
‰eq
, 
ªt
;

808 
	`wùhy_lock
(&
rdev
->
wùhy
);

810 
wdev
->
i·y≥
) {

811 
NL80211_IFTYPE_STATION
:

812 
ªt
 = 
	`cfg80211_mgd_wext_siw‰eq
(
dev
, 
öfo
, 
wext‰eq
, 
exåa
);

814 
NL80211_IFTYPE_ADHOC
:

815 
ªt
 = 
	`cfg80211_ibss_wext_siw‰eq
(
dev
, 
öfo
, 
wext‰eq
, 
exåa
);

817 
NL80211_IFTYPE_MONITOR
:

818 
‰eq
 = 
	`cfg80211_wext_‰eq
(
wext‰eq
);

819 i‡(
‰eq
 < 0) {

820 
ªt
 = 
‰eq
;

823 i‡(
‰eq
 == 0) {

824 
ªt
 = -
EINVAL
;

827 
ch™def
.
˚¡î_‰eq1
 = 
‰eq
;

828 
ch™def
.
ch™
 = 
	`õì80211_gë_ch™√l
(&
rdev
->
wùhy
, 
‰eq
);

829 i‡(!
ch™def
.
ch™
) {

830 
ªt
 = -
EINVAL
;

833 
ªt
 = 
	`cfg80211_£t_m⁄ô‹_ch™√l
(
rdev
, &
ch™def
);

835 
NL80211_IFTYPE_MESH_POINT
:

836 
‰eq
 = 
	`cfg80211_wext_‰eq
(
wext‰eq
);

837 i‡(
‰eq
 < 0) {

838 
ªt
 = 
‰eq
;

841 i‡(
‰eq
 == 0) {

842 
ªt
 = -
EINVAL
;

845 
ch™def
.
˚¡î_‰eq1
 = 
‰eq
;

846 
ch™def
.
ch™
 = 
	`õì80211_gë_ch™√l
(&
rdev
->
wùhy
, 
‰eq
);

847 i‡(!
ch™def
.
ch™
) {

848 
ªt
 = -
EINVAL
;

851 
ªt
 = 
	`cfg80211_£t_mesh_ch™√l
(
rdev
, 
wdev
, &
ch™def
);

854 
ªt
 = -
EOPNOTSUPP
;

858 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

860  
ªt
;

861 
	}
}

863 
	$cfg80211_wext_giw‰eq
(
√t_devi˚
 *
dev
,

864 
iw_ªque°_öfo
 *
öfo
,

865 
iwªq_d©a
 *
wrqu
, *
exåa
)

867 
iw_‰eq
 *
‰eq
 = &
wrqu
->freq;

868 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

869 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

870 
cfg80211_ch™_def
 
ch™def
 = {};

871 
ªt
;

873 
	`wùhy_lock
(&
rdev
->
wùhy
);

874 
wdev
->
i·y≥
) {

875 
NL80211_IFTYPE_STATION
:

876 
ªt
 = 
	`cfg80211_mgd_wext_giw‰eq
(
dev
, 
öfo
, 
‰eq
, 
exåa
);

878 
NL80211_IFTYPE_ADHOC
:

879 
ªt
 = 
	`cfg80211_ibss_wext_giw‰eq
(
dev
, 
öfo
, 
‰eq
, 
exåa
);

881 
NL80211_IFTYPE_MONITOR
:

882 i‡(!
rdev
->
›s
->
gë_ch™√l
) {

883 
ªt
 = -
EINVAL
;

887 
ªt
 = 
	`rdev_gë_ch™√l
(
rdev
, 
wdev
, 0, &
ch™def
);

888 i‡(
ªt
)

890 
‰eq
->
m
 = 
ch™def
.
ch™
->
˚¡î_‰eq
;

891 
‰eq
->
e
 = 6;

892 
ªt
 = 0;

895 
ªt
 = -
EINVAL
;

899 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

901  
ªt
;

902 
	}
}

904 
	$cfg80211_wext_siwtxpowî
(
√t_devi˚
 *
dev
,

905 
iw_ªque°_öfo
 *
öfo
,

906 
iwªq_d©a
 *
d©a
, *
exåa
)

908 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

909 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

910 
∆80211_tx_powî_£âög
 
ty≥
;

911 
dbm
 = 0;

912 
ªt
;

914 i‡((
d©a
->
txpowî
.
Êags
 & 
IW_TXPOW_TYPE
Ë!
IW_TXPOW_DBM
)

915  -
EINVAL
;

916 i‡(
d©a
->
txpowî
.
Êags
 & 
IW_TXPOW_RANGE
)

917  -
EINVAL
;

919 i‡(!
rdev
->
›s
->
£t_tx_powî
)

920  -
EOPNOTSUPP
;

923 i‡(!
d©a
->
txpowî
.
dißbÀd
) {

924 
	`rfkûl_£t_sw_°©e
(
rdev
->
wùhy
.
rfkûl
, 
Ál£
);

926 i‡(
d©a
->
txpowî
.
fixed
) {

931 i‡(
d©a
->
txpowî
.
vÆue
 < 0)

932  -
EINVAL
;

933 
dbm
 = 
d©a
->
txpowî
.
vÆue
;

934 
ty≥
 = 
NL80211_TX_POWER_FIXED
;

941 i‡(
d©a
->
txpowî
.
vÆue
 < 0) {

942 
ty≥
 = 
NL80211_TX_POWER_AUTOMATIC
;

944 
dbm
 = 
d©a
->
txpowî
.
vÆue
;

945 
ty≥
 = 
NL80211_TX_POWER_LIMITED
;

949 i‡(
	`rfkûl_£t_sw_°©e
(
rdev
->
wùhy
.
rfkûl
, 
åue
))

950 
	`scheduÀ_w‹k
(&
rdev
->
rfkûl_block
);

954 
	`wùhy_lock
(&
rdev
->
wùhy
);

955 
ªt
 = 
	`rdev_£t_tx_powî
(
rdev
, 
wdev
, 
ty≥
, 
	`DBM_TO_MBM
(
dbm
));

956 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

958  
ªt
;

959 
	}
}

961 
	$cfg80211_wext_giwtxpowî
(
√t_devi˚
 *
dev
,

962 
iw_ªque°_öfo
 *
öfo
,

963 
iwªq_d©a
 *
d©a
, *
exåa
)

965 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

966 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

967 
îr
, 
vÆ
;

969 i‡((
d©a
->
txpowî
.
Êags
 & 
IW_TXPOW_TYPE
Ë!
IW_TXPOW_DBM
)

970  -
EINVAL
;

971 i‡(
d©a
->
txpowî
.
Êags
 & 
IW_TXPOW_RANGE
)

972  -
EINVAL
;

974 i‡(!
rdev
->
›s
->
gë_tx_powî
)

975  -
EOPNOTSUPP
;

977 
	`wùhy_lock
(&
rdev
->
wùhy
);

978 
îr
 = 
	`rdev_gë_tx_powî
(
rdev
, 
wdev
, &
vÆ
);

979 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

980 i‡(
îr
)

981  
îr
;

984 
d©a
->
txpowî
.
fixed
 = 1;

985 
d©a
->
txpowî
.
dißbÀd
 = 
	`rfkûl_blocked
(
rdev
->
wùhy
.
rfkûl
);

986 
d©a
->
txpowî
.
vÆue
 = 
vÆ
;

987 
d©a
->
txpowî
.
Êags
 = 
IW_TXPOW_DBM
;

990 
	}
}

992 
	$cfg80211_£t_auth_Æg
(
wúñess_dev
 *
wdev
,

993 
s32
 
auth_Æg
)

995 
ƒ_Æg
 = 0;

997 i‡(!
auth_Æg
)

998  -
EINVAL
;

1000 i‡(
auth_Æg
 & ~(
IW_AUTH_ALG_OPEN_SYSTEM
 |

1001 
IW_AUTH_ALG_SHARED_KEY
 |

1002 
IW_AUTH_ALG_LEAP
))

1003  -
EINVAL
;

1005 i‡(
auth_Æg
 & 
IW_AUTH_ALG_OPEN_SYSTEM
) {

1006 
ƒ_Æg
++;

1007 
wdev
->
wext
.
c⁄√˘
.
auth_ty≥
 = 
NL80211_AUTHTYPE_OPEN_SYSTEM
;

1010 i‡(
auth_Æg
 & 
IW_AUTH_ALG_SHARED_KEY
) {

1011 
ƒ_Æg
++;

1012 
wdev
->
wext
.
c⁄√˘
.
auth_ty≥
 = 
NL80211_AUTHTYPE_SHARED_KEY
;

1015 i‡(
auth_Æg
 & 
IW_AUTH_ALG_LEAP
) {

1016 
ƒ_Æg
++;

1017 
wdev
->
wext
.
c⁄√˘
.
auth_ty≥
 = 
NL80211_AUTHTYPE_NETWORK_EAP
;

1020 i‡(
ƒ_Æg
 > 1)

1021 
wdev
->
wext
.
c⁄√˘
.
auth_ty≥
 = 
NL80211_AUTHTYPE_AUTOMATIC
;

1024 
	}
}

1026 
	$cfg80211_£t_w∑_vîsi⁄
(
wúñess_dev
 *
wdev
, 
u32
 
w∑_vîsi⁄s
)

1028 i‡(
w∑_vîsi⁄s
 & ~(
IW_AUTH_WPA_VERSION_WPA
 |

1029 
IW_AUTH_WPA_VERSION_WPA2
|

1030 
IW_AUTH_WPA_VERSION_DISABLED
))

1031  -
EINVAL
;

1033 i‡((
w∑_vîsi⁄s
 & 
IW_AUTH_WPA_VERSION_DISABLED
) &&

1034 (
w∑_vîsi⁄s
 & (
IW_AUTH_WPA_VERSION_WPA
|

1035 
IW_AUTH_WPA_VERSION_WPA2
)))

1036  -
EINVAL
;

1038 i‡(
w∑_vîsi⁄s
 & 
IW_AUTH_WPA_VERSION_DISABLED
)

1039 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
w∑_vîsi⁄s
 &=

1040 ~(
NL80211_WPA_VERSION_1
|
NL80211_WPA_VERSION_2
);

1042 i‡(
w∑_vîsi⁄s
 & 
IW_AUTH_WPA_VERSION_WPA
)

1043 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
w∑_vîsi⁄s
 |=

1044 
NL80211_WPA_VERSION_1
;

1046 i‡(
w∑_vîsi⁄s
 & 
IW_AUTH_WPA_VERSION_WPA2
)

1047 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
w∑_vîsi⁄s
 |=

1048 
NL80211_WPA_VERSION_2
;

1051 
	}
}

1053 
	$cfg80211_£t_cùhî_group
(
wúñess_dev
 *
wdev
, 
u32
 
cùhî
)

1055 i‡(
cùhî
 & 
IW_AUTH_CIPHER_WEP40
)

1056 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
cùhî_group
 =

1057 
WLAN_CIPHER_SUITE_WEP40
;

1058 i‡(
cùhî
 & 
IW_AUTH_CIPHER_WEP104
)

1059 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
cùhî_group
 =

1060 
WLAN_CIPHER_SUITE_WEP104
;

1061 i‡(
cùhî
 & 
IW_AUTH_CIPHER_TKIP
)

1062 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
cùhî_group
 =

1063 
WLAN_CIPHER_SUITE_TKIP
;

1064 i‡(
cùhî
 & 
IW_AUTH_CIPHER_CCMP
)

1065 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
cùhî_group
 =

1066 
WLAN_CIPHER_SUITE_CCMP
;

1067 i‡(
cùhî
 & 
IW_AUTH_CIPHER_AES_CMAC
)

1068 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
cùhî_group
 =

1069 
WLAN_CIPHER_SUITE_AES_CMAC
;

1070 i‡(
cùhî
 & 
IW_AUTH_CIPHER_NONE
)

1071 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
cùhî_group
 = 0;

1073  -
EINVAL
;

1076 
	}
}

1078 
	$cfg80211_£t_cùhî_∑úwi£
(
wúñess_dev
 *
wdev
, 
u32
 
cùhî
)

1080 
ƒ_cùhîs
 = 0;

1081 
u32
 *
cùhîs_∑úwi£
 = 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.ciphers_pairwise;

1083 i‡(
cùhî
 & 
IW_AUTH_CIPHER_WEP40
) {

1084 
cùhîs_∑úwi£
[
ƒ_cùhîs
] = 
WLAN_CIPHER_SUITE_WEP40
;

1085 
ƒ_cùhîs
++;

1088 i‡(
cùhî
 & 
IW_AUTH_CIPHER_WEP104
) {

1089 
cùhîs_∑úwi£
[
ƒ_cùhîs
] = 
WLAN_CIPHER_SUITE_WEP104
;

1090 
ƒ_cùhîs
++;

1093 i‡(
cùhî
 & 
IW_AUTH_CIPHER_TKIP
) {

1094 
cùhîs_∑úwi£
[
ƒ_cùhîs
] = 
WLAN_CIPHER_SUITE_TKIP
;

1095 
ƒ_cùhîs
++;

1098 i‡(
cùhî
 & 
IW_AUTH_CIPHER_CCMP
) {

1099 
cùhîs_∑úwi£
[
ƒ_cùhîs
] = 
WLAN_CIPHER_SUITE_CCMP
;

1100 
ƒ_cùhîs
++;

1103 i‡(
cùhî
 & 
IW_AUTH_CIPHER_AES_CMAC
) {

1104 
cùhîs_∑úwi£
[
ƒ_cùhîs
] = 
WLAN_CIPHER_SUITE_AES_CMAC
;

1105 
ƒ_cùhîs
++;

1108 
	`BUILD_BUG_ON
(
NL80211_MAX_NR_CIPHER_SUITES
 < 5);

1110 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
n_cùhîs_∑úwi£
 = 
ƒ_cùhîs
;

1113 
	}
}

1116 
	$cfg80211_£t_key_mgt
(
wúñess_dev
 *
wdev
, 
u32
 
key_mgt
)

1118 
ƒ_akm_suôes
 = 0;

1120 i‡(
key_mgt
 & ~(
IW_AUTH_KEY_MGMT_802_1X
 |

1121 
IW_AUTH_KEY_MGMT_PSK
))

1122  -
EINVAL
;

1124 i‡(
key_mgt
 & 
IW_AUTH_KEY_MGMT_802_1X
) {

1125 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
akm_suôes
[
ƒ_akm_suôes
] =

1126 
WLAN_AKM_SUITE_8021X
;

1127 
ƒ_akm_suôes
++;

1130 i‡(
key_mgt
 & 
IW_AUTH_KEY_MGMT_PSK
) {

1131 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
akm_suôes
[
ƒ_akm_suôes
] =

1132 
WLAN_AKM_SUITE_PSK
;

1133 
ƒ_akm_suôes
++;

1136 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
n_akm_suôes
 = 
ƒ_akm_suôes
;

1139 
	}
}

1141 
	$cfg80211_wext_siwauth
(
√t_devi˚
 *
dev
,

1142 
iw_ªque°_öfo
 *
öfo
,

1143 
iwªq_d©a
 *
wrqu
, *
exåa
)

1145 
iw_∑øm
 *
d©a
 = &
wrqu
->
∑øm
;

1146 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1148 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
)

1149  -
EOPNOTSUPP
;

1151 
d©a
->
Êags
 & 
IW_AUTH_INDEX
) {

1152 
IW_AUTH_PRIVACY_INVOKED
:

1153 
wdev
->
wext
.
c⁄√˘
.
¥ivacy
 = 
d©a
->
vÆue
;

1155 
IW_AUTH_WPA_VERSION
:

1156  
	`cfg80211_£t_w∑_vîsi⁄
(
wdev
, 
d©a
->
vÆue
);

1157 
IW_AUTH_CIPHER_GROUP
:

1158  
	`cfg80211_£t_cùhî_group
(
wdev
, 
d©a
->
vÆue
);

1159 
IW_AUTH_KEY_MGMT
:

1160  
	`cfg80211_£t_key_mgt
(
wdev
, 
d©a
->
vÆue
);

1161 
IW_AUTH_CIPHER_PAIRWISE
:

1162  
	`cfg80211_£t_cùhî_∑úwi£
(
wdev
, 
d©a
->
vÆue
);

1163 
IW_AUTH_80211_AUTH_ALG
:

1164  
	`cfg80211_£t_auth_Æg
(
wdev
, 
d©a
->
vÆue
);

1165 
IW_AUTH_WPA_ENABLED
:

1166 
IW_AUTH_RX_UNENCRYPTED_EAPOL
:

1167 
IW_AUTH_DROP_UNENCRYPTED
:

1168 
IW_AUTH_MFP
:

1171  -
EOPNOTSUPP
;

1173 
	}
}

1175 
	$cfg80211_wext_giwauth
(
√t_devi˚
 *
dev
,

1176 
iw_ªque°_öfo
 *
öfo
,

1177 
iwªq_d©a
 *
wrqu
, *
exåa
)

1181  -
EOPNOTSUPP
;

1182 
	}
}

1184 
	$cfg80211_wext_siwpowî
(
√t_devi˚
 *
dev
,

1185 
iw_ªque°_öfo
 *
öfo
,

1186 
iwªq_d©a
 *
wrqu
, *
exåa
)

1188 
iw_∑øm
 *
wrq
 = &
wrqu
->
powî
;

1189 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1190 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1191 
boﬁ
 
ps
;

1192 
timeout
 = 
wdev
->
ps_timeout
;

1193 
îr
;

1195 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
)

1196  -
EINVAL
;

1198 i‡(!
rdev
->
›s
->
£t_powî_mgmt
)

1199  -
EOPNOTSUPP
;

1201 i‡(
wrq
->
dißbÀd
) {

1202 
ps
 = 
Ál£
;

1204 
wrq
->
Êags
 & 
IW_POWER_MODE
) {

1205 
IW_POWER_ON
:

1206 
IW_POWER_MODE
:

1207 
IW_POWER_ALL_R
:

1208 
ps
 = 
åue
;

1211  -
EINVAL
;

1214 i‡(
wrq
->
Êags
 & ~(
IW_POWER_MODE
 | 
IW_POWER_TIMEOUT
))

1215  -
EINVAL
;

1217 i‡(
wrq
->
Êags
 & 
IW_POWER_TIMEOUT
)

1218 
timeout
 = 
wrq
->
vÆue
 / 1000;

1221 
	`wùhy_lock
(&
rdev
->
wùhy
);

1222 
îr
 = 
	`rdev_£t_powî_mgmt
(
rdev
, 
dev
, 
ps
, 
timeout
);

1223 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1224 i‡(
îr
)

1225  
îr
;

1227 
wdev
->
ps
 =Ös;

1228 
wdev
->
ps_timeout
 = 
timeout
;

1232 
	}
}

1234 
	$cfg80211_wext_giwpowî
(
√t_devi˚
 *
dev
,

1235 
iw_ªque°_öfo
 *
öfo
,

1236 
iwªq_d©a
 *
wrqu
, *
exåa
)

1238 
iw_∑øm
 *
wrq
 = &
wrqu
->
powî
;

1239 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1241 
wrq
->
dißbÀd
 = !
wdev
->
ps
;

1244 
	}
}

1246 
	$cfg80211_wext_siwøã
(
√t_devi˚
 *
dev
,

1247 
iw_ªque°_öfo
 *
öfo
,

1248 
iwªq_d©a
 *
wrqu
, *
exåa
)

1250 
iw_∑øm
 *
øã
 = &
wrqu
->
bôøã
;

1251 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1252 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1253 
cfg80211_bôøã_mask
 
mask
;

1254 
u32
 
fixed
, 
maxøã
;

1255 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

1256 
b™d
, 
ridx
, 
ªt
;

1257 
boﬁ
 
m©ch
 = 
Ál£
;

1259 i‡(!
rdev
->
›s
->
£t_bôøã_mask
)

1260  -
EOPNOTSUPP
;

1262 
	`mem£t
(&
mask
, 0, (mask));

1263 
fixed
 = 0;

1264 
maxøã
 = (
u32
)-1;

1266 i‡(
øã
->
vÆue
 < 0) {

1268 } i‡(
øã
->
fixed
) {

1269 
fixed
 = 
øã
->
vÆue
 / 100000;

1271 
maxøã
 = 
øã
->
vÆue
 / 100000;

1274 
b™d
 = 0; b™d < 
NUM_NL80211_BANDS
; band++) {

1275 
sb™d
 = 
wdev
->
wùhy
->
b™ds
[
b™d
];

1276 i‡(
sb™d
 =
NULL
)

1278 
ridx
 = 0;Ñidx < 
sb™d
->
n_bôøãs
;Ñidx++) {

1279 
õì80211_øã
 *
§©e
 = &
sb™d
->
bôøãs
[
ridx
];

1280 i‡(
fixed
 =
§©e
->
bôøã
) {

1281 
mask
.
c⁄åﬁ
[
b™d
].
Àgacy
 = 1 << 
ridx
;

1282 
m©ch
 = 
åue
;

1285 i‡(
§©e
->
bôøã
 <
maxøã
) {

1286 
mask
.
c⁄åﬁ
[
b™d
].
Àgacy
 |1 << 
ridx
;

1287 
m©ch
 = 
åue
;

1292 i‡(!
m©ch
)

1293  -
EINVAL
;

1295 
	`wùhy_lock
(&
rdev
->
wùhy
);

1296 i‡(
dev
->
õì80211_±r
->
vÆid_löks
)

1297 
ªt
 = -
EOPNOTSUPP
;

1299 
ªt
 = 
	`rdev_£t_bôøã_mask
(
rdev
, 
dev
, 0, 
NULL
, &
mask
);

1300 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1302  
ªt
;

1303 
	}
}

1305 
	$cfg80211_wext_giwøã
(
√t_devi˚
 *
dev
,

1306 
iw_ªque°_öfo
 *
öfo
,

1307 
iwªq_d©a
 *
wrqu
, *
exåa
)

1309 
iw_∑øm
 *
øã
 = &
wrqu
->
bôøã
;

1310 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1311 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1312 
°©i⁄_öfo
 
söfo
 = {};

1313 
u8
 
addr
[
ETH_ALEN
];

1314 
îr
;

1316 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
)

1317  -
EOPNOTSUPP
;

1319 i‡(!
rdev
->
›s
->
gë_°©i⁄
)

1320  -
EOPNOTSUPP
;

1322 
îr
 = 0;

1323 i‡(!
wdev
->
vÆid_löks
 && wdev->
löks
[0].
˛õ¡
.
cuºít_bss
)

1324 
	`mem˝y
(
addr
, 
wdev
->
löks
[0].
˛õ¡
.
cuºít_bss
->
pub
.
bssid
,

1325 
ETH_ALEN
);

1327 
îr
 = -
EOPNOTSUPP
;

1328 i‡(
îr
)

1329  
îr
;

1331 
	`wùhy_lock
(&
rdev
->
wùhy
);

1332 
îr
 = 
	`rdev_gë_°©i⁄
(
rdev
, 
dev
, 
addr
, &
söfo
);

1333 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1334 i‡(
îr
)

1335  
îr
;

1337 i‡(!(
söfo
.
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_TX_BITRATE
))) {

1338 
îr
 = -
EOPNOTSUPP
;

1339 
‰ì
;

1342 
øã
->
vÆue
 = 100000 * 
	`cfg80211_ˇlcuœã_bôøã
(&
söfo
.
txøã
);

1344 
‰ì
:

1345 
	`cfg80211_söfo_ªÀa£_c⁄ã¡
(&
söfo
);

1346  
îr
;

1347 
	}
}

1350 
iw_°©i°ics
 *
	$cfg80211_wúñess_°©s
(
√t_devi˚
 *
dev
)

1352 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1353 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1355 
iw_°©i°ics
 
w°©s
;

1356 
°©i⁄_öfo
 
söfo
 = {};

1357 
u8
 
bssid
[
ETH_ALEN
];

1358 
ªt
;

1360 i‡(
dev
->
õì80211_±r
->
i·y≥
 !
NL80211_IFTYPE_STATION
)

1361  
NULL
;

1363 i‡(!
rdev
->
›s
->
gë_°©i⁄
)

1364  
NULL
;

1367 
	`wùhy_lock
(&
rdev
->
wùhy
);

1368 i‡(
wdev
->
vÆid_löks
 || !wdev->
löks
[0].
˛õ¡
.
cuºít_bss
) {

1369 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1370  
NULL
;

1372 
	`mem˝y
(
bssid
, 
wdev
->
löks
[0].
˛õ¡
.
cuºít_bss
->
pub
.bssid, 
ETH_ALEN
);

1374 
	`mem£t
(&
söfo
, 0, (sinfo));

1376 
ªt
 = 
	`rdev_gë_°©i⁄
(
rdev
, 
dev
, 
bssid
, &
söfo
);

1377 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1379 i‡(
ªt
)

1380  
NULL
;

1382 
	`mem£t
(&
w°©s
, 0, (wstats));

1384 
rdev
->
wùhy
.
sig«l_ty≥
) {

1385 
CFG80211_SIGNAL_TYPE_MBM
:

1386 i‡(
söfo
.
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_SIGNAL
)) {

1387 
sig
 = 
söfo
.
sig«l
;

1388 
w°©s
.
quÆ
.
upd©ed
 |
IW_QUAL_LEVEL_UPDATED
;

1389 
w°©s
.
quÆ
.
upd©ed
 |
IW_QUAL_QUAL_UPDATED
;

1390 
w°©s
.
quÆ
.
upd©ed
 |
IW_QUAL_DBM
;

1391 
w°©s
.
quÆ
.
Àvñ
 = 
sig
;

1392 i‡(
sig
 < -110)

1393 
sig
 = -110;

1394 i‡(
sig
 > -40)

1395 
sig
 = -40;

1396 
w°©s
.
quÆ
.quÆ = 
sig
 + 110;

1399 
ÁŒthrough
;

1400 
CFG80211_SIGNAL_TYPE_UNSPEC
:

1401 i‡(
söfo
.
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_SIGNAL
)) {

1402 
w°©s
.
quÆ
.
upd©ed
 |
IW_QUAL_LEVEL_UPDATED
;

1403 
w°©s
.
quÆ
.
upd©ed
 |
IW_QUAL_QUAL_UPDATED
;

1404 
w°©s
.
quÆ
.
Àvñ
 = 
söfo
.
sig«l
;

1405 
w°©s
.
quÆ
.quÆ = 
söfo
.
sig«l
;

1408 
ÁŒthrough
;

1410 
w°©s
.
quÆ
.
upd©ed
 |
IW_QUAL_LEVEL_INVALID
;

1411 
w°©s
.
quÆ
.
upd©ed
 |
IW_QUAL_QUAL_INVALID
;

1414 
w°©s
.
quÆ
.
upd©ed
 |
IW_QUAL_NOISE_INVALID
;

1415 i‡(
söfo
.
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_RX_DROP_MISC
))

1416 
w°©s
.
disˇrd
.
misc
 = 
söfo
.
rx_dr›≥d_misc
;

1417 i‡(
söfo
.
fûÀd
 & 
	`BIT_ULL
(
NL80211_STA_INFO_TX_FAILED
))

1418 
w°©s
.
disˇrd
.
ªåõs
 = 
söfo
.
tx_Áûed
;

1420 
	`cfg80211_söfo_ªÀa£_c⁄ã¡
(&
söfo
);

1422  &
w°©s
;

1423 
	}
}

1425 
	$cfg80211_wext_siw≠
(
√t_devi˚
 *
dev
,

1426 
iw_ªque°_öfo
 *
öfo
,

1427 
iwªq_d©a
 *
wrqu
, *
exåa
)

1429 
sockaddr
 *
≠_addr
 = &
wrqu
->ap_addr;

1430 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1431 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1432 
ªt
;

1434 
	`wùhy_lock
(&
rdev
->
wùhy
);

1435 
wdev
->
i·y≥
) {

1436 
NL80211_IFTYPE_ADHOC
:

1437 
ªt
 = 
	`cfg80211_ibss_wext_siw≠
(
dev
, 
öfo
, 
≠_addr
, 
exåa
);

1439 
NL80211_IFTYPE_STATION
:

1440 
ªt
 = 
	`cfg80211_mgd_wext_siw≠
(
dev
, 
öfo
, 
≠_addr
, 
exåa
);

1443 
ªt
 = -
EOPNOTSUPP
;

1446 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1448  
ªt
;

1449 
	}
}

1451 
	$cfg80211_wext_giw≠
(
√t_devi˚
 *
dev
,

1452 
iw_ªque°_öfo
 *
öfo
,

1453 
iwªq_d©a
 *
wrqu
, *
exåa
)

1455 
sockaddr
 *
≠_addr
 = &
wrqu
->ap_addr;

1456 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1457 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1458 
ªt
;

1460 
	`wùhy_lock
(&
rdev
->
wùhy
);

1461 
wdev
->
i·y≥
) {

1462 
NL80211_IFTYPE_ADHOC
:

1463 
ªt
 = 
	`cfg80211_ibss_wext_giw≠
(
dev
, 
öfo
, 
≠_addr
, 
exåa
);

1465 
NL80211_IFTYPE_STATION
:

1466 
ªt
 = 
	`cfg80211_mgd_wext_giw≠
(
dev
, 
öfo
, 
≠_addr
, 
exåa
);

1469 
ªt
 = -
EOPNOTSUPP
;

1472 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1474  
ªt
;

1475 
	}
}

1477 
	$cfg80211_wext_siwessid
(
√t_devi˚
 *
dev
,

1478 
iw_ªque°_öfo
 *
öfo
,

1479 
iwªq_d©a
 *
wrqu
, *
ssid
)

1481 
iw_poöt
 *
d©a
 = &
wrqu
->data;

1482 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1483 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1484 
ªt
;

1486 
	`wùhy_lock
(&
rdev
->
wùhy
);

1487 
wdev
->
i·y≥
) {

1488 
NL80211_IFTYPE_ADHOC
:

1489 
ªt
 = 
	`cfg80211_ibss_wext_siwessid
(
dev
, 
öfo
, 
d©a
, 
ssid
);

1491 
NL80211_IFTYPE_STATION
:

1492 
ªt
 = 
	`cfg80211_mgd_wext_siwessid
(
dev
, 
öfo
, 
d©a
, 
ssid
);

1495 
ªt
 = -
EOPNOTSUPP
;

1498 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1500  
ªt
;

1501 
	}
}

1503 
	$cfg80211_wext_giwessid
(
√t_devi˚
 *
dev
,

1504 
iw_ªque°_öfo
 *
öfo
,

1505 
iwªq_d©a
 *
wrqu
, *
ssid
)

1507 
iw_poöt
 *
d©a
 = &
wrqu
->data;

1508 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1509 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1510 
ªt
;

1512 
d©a
->
Êags
 = 0;

1513 
d©a
->
Àngth
 = 0;

1515 
	`wùhy_lock
(&
rdev
->
wùhy
);

1516 
wdev
->
i·y≥
) {

1517 
NL80211_IFTYPE_ADHOC
:

1518 
ªt
 = 
	`cfg80211_ibss_wext_giwessid
(
dev
, 
öfo
, 
d©a
, 
ssid
);

1520 
NL80211_IFTYPE_STATION
:

1521 
ªt
 = 
	`cfg80211_mgd_wext_giwessid
(
dev
, 
öfo
, 
d©a
, 
ssid
);

1524 
ªt
 = -
EOPNOTSUPP
;

1527 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1529  
ªt
;

1530 
	}
}

1532 
	$cfg80211_wext_siwpmkß
(
√t_devi˚
 *
dev
,

1533 
iw_ªque°_öfo
 *
öfo
,

1534 
iwªq_d©a
 *
wrqu
, *
exåa
)

1536 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

1537 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

1538 
cfg80211_pmkß
 
cfg_pmkß
;

1539 
iw_pmkß
 *
pmkß
 = (iw_pmkß *)
exåa
;

1540 
ªt
;

1542 
	`mem£t
(&
cfg_pmkß
, 0, (
cfg80211_pmkß
));

1544 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
)

1545  -
EINVAL
;

1547 
cfg_pmkß
.
bssid
 = 
pmkß
->bssid.
ß_d©a
;

1548 
cfg_pmkß
.
pmkid
 = 
pmkß
->pmkid;

1550 
	`wùhy_lock
(&
rdev
->
wùhy
);

1551 
pmkß
->
cmd
) {

1552 
IW_PMKSA_ADD
:

1553 i‡(!
rdev
->
›s
->
£t_pmkß
) {

1554 
ªt
 = -
EOPNOTSUPP
;

1558 
ªt
 = 
	`rdev_£t_pmkß
(
rdev
, 
dev
, &
cfg_pmkß
);

1560 
IW_PMKSA_REMOVE
:

1561 i‡(!
rdev
->
›s
->
dñ_pmkß
) {

1562 
ªt
 = -
EOPNOTSUPP
;

1566 
ªt
 = 
	`rdev_dñ_pmkß
(
rdev
, 
dev
, &
cfg_pmkß
);

1568 
IW_PMKSA_FLUSH
:

1569 i‡(!
rdev
->
›s
->
Êush_pmkß
) {

1570 
ªt
 = -
EOPNOTSUPP
;

1574 
ªt
 = 
	`rdev_Êush_pmkß
(
rdev
, 
dev
);

1577 
ªt
 = -
EOPNOTSUPP
;

1580 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

1582  
ªt
;

1583 
	}
}

1585 c⁄° 
iw_h™dÀr
 
	gcfg80211_h™dÀrs
[] = {

1586 
IW_HANDLER
(
SIOCGIWNAME
, 
cfg80211_wext_giw«me
),

1587 
IW_HANDLER
(
SIOCSIWFREQ
, 
cfg80211_wext_siw‰eq
),

1588 
IW_HANDLER
(
SIOCGIWFREQ
, 
cfg80211_wext_giw‰eq
),

1589 
IW_HANDLER
(
SIOCSIWMODE
, 
cfg80211_wext_siwmode
),

1590 
IW_HANDLER
(
SIOCGIWMODE
, 
cfg80211_wext_giwmode
),

1591 
IW_HANDLER
(
SIOCGIWRANGE
, 
cfg80211_wext_giwønge
),

1592 
IW_HANDLER
(
SIOCSIWAP
, 
cfg80211_wext_siw≠
),

1593 
IW_HANDLER
(
SIOCGIWAP
, 
cfg80211_wext_giw≠
),

1594 
IW_HANDLER
(
SIOCSIWMLME
, 
cfg80211_wext_siwmlme
),

1595 
IW_HANDLER
(
SIOCSIWSCAN
, 
cfg80211_wext_siwsˇn
),

1596 
IW_HANDLER
(
SIOCGIWSCAN
, 
cfg80211_wext_giwsˇn
),

1597 
IW_HANDLER
(
SIOCSIWESSID
, 
cfg80211_wext_siwessid
),

1598 
IW_HANDLER
(
SIOCGIWESSID
, 
cfg80211_wext_giwessid
),

1599 
IW_HANDLER
(
SIOCSIWRATE
, 
cfg80211_wext_siwøã
),

1600 
IW_HANDLER
(
SIOCGIWRATE
, 
cfg80211_wext_giwøã
),

1601 
IW_HANDLER
(
SIOCSIWRTS
, 
cfg80211_wext_siwπs
),

1602 
IW_HANDLER
(
SIOCGIWRTS
, 
cfg80211_wext_giwπs
),

1603 
IW_HANDLER
(
SIOCSIWFRAG
, 
cfg80211_wext_siw‰ag
),

1604 
IW_HANDLER
(
SIOCGIWFRAG
, 
cfg80211_wext_giw‰ag
),

1605 
IW_HANDLER
(
SIOCSIWTXPOW
, 
cfg80211_wext_siwtxpowî
),

1606 
IW_HANDLER
(
SIOCGIWTXPOW
, 
cfg80211_wext_giwtxpowî
),

1607 
IW_HANDLER
(
SIOCSIWRETRY
, 
cfg80211_wext_siwªåy
),

1608 
IW_HANDLER
(
SIOCGIWRETRY
, 
cfg80211_wext_giwªåy
),

1609 
IW_HANDLER
(
SIOCSIWENCODE
, 
cfg80211_wext_siwícode
),

1610 
IW_HANDLER
(
SIOCGIWENCODE
, 
cfg80211_wext_giwícode
),

1611 
IW_HANDLER
(
SIOCSIWPOWER
, 
cfg80211_wext_siwpowî
),

1612 
IW_HANDLER
(
SIOCGIWPOWER
, 
cfg80211_wext_giwpowî
),

1613 
IW_HANDLER
(
SIOCSIWGENIE
, 
cfg80211_wext_siwgíõ
),

1614 
IW_HANDLER
(
SIOCSIWAUTH
, 
cfg80211_wext_siwauth
),

1615 
IW_HANDLER
(
SIOCGIWAUTH
, 
cfg80211_wext_giwauth
),

1616 
IW_HANDLER
(
SIOCSIWENCODEEXT
, 
cfg80211_wext_siwícodìxt
),

1617 
IW_HANDLER
(
SIOCSIWPMKSA
, 
cfg80211_wext_siwpmkß
),

1620 c⁄° 
iw_h™dÀr_def
 
	gcfg80211_wext_h™dÀr
 = {

1621 .
num_°™d¨d
 = 
ARRAY_SIZE
(
cfg80211_h™dÀrs
),

1622 .
	g°™d¨d
 = 
cfg80211_h™dÀrs
,

1623 .
	ggë_wúñess_°©s
 = 
cfg80211_wúñess_°©s
,

	@wext-compat.h

2 #i‚de‡
__WEXT_COMPAT


3 
	#__WEXT_COMPAT


	)

5 
	~<√t/iw_h™dÀr.h
>

6 
	~<löux/wúñess.h
>

8 #ifde‡
CONFIG_CFG80211_WEXT_EXPORT


9 
	#EXPORT_WEXT_HANDLER
(
h
Ë
	`EXPORT_SYMBOL_GPL
(h)

	)

11 
	#EXPORT_WEXT_HANDLER
(
h
)

	)

14 
cfg80211_ibss_wext_siw‰eq
(
√t_devi˚
 *
dev
,

15 
iw_ªque°_öfo
 *
öfo
,

16 
iw_‰eq
 *
wext‰eq
, *
exåa
);

17 
cfg80211_ibss_wext_giw‰eq
(
√t_devi˚
 *
dev
,

18 
iw_ªque°_öfo
 *
öfo
,

19 
iw_‰eq
 *
‰eq
, *
exåa
);

20 
cfg80211_ibss_wext_siw≠
(
√t_devi˚
 *
dev
,

21 
iw_ªque°_öfo
 *
öfo
,

22 
sockaddr
 *
≠_addr
, *
exåa
);

23 
cfg80211_ibss_wext_giw≠
(
√t_devi˚
 *
dev
,

24 
iw_ªque°_öfo
 *
öfo
,

25 
sockaddr
 *
≠_addr
, *
exåa
);

26 
cfg80211_ibss_wext_siwessid
(
√t_devi˚
 *
dev
,

27 
iw_ªque°_öfo
 *
öfo
,

28 
iw_poöt
 *
d©a
, *
ssid
);

29 
cfg80211_ibss_wext_giwessid
(
√t_devi˚
 *
dev
,

30 
iw_ªque°_öfo
 *
öfo
,

31 
iw_poöt
 *
d©a
, *
ssid
);

33 
cfg80211_mgd_wext_siw‰eq
(
√t_devi˚
 *
dev
,

34 
iw_ªque°_öfo
 *
öfo
,

35 
iw_‰eq
 *
wext‰eq
, *
exåa
);

36 
cfg80211_mgd_wext_giw‰eq
(
√t_devi˚
 *
dev
,

37 
iw_ªque°_öfo
 *
öfo
,

38 
iw_‰eq
 *
‰eq
, *
exåa
);

39 
cfg80211_mgd_wext_siw≠
(
√t_devi˚
 *
dev
,

40 
iw_ªque°_öfo
 *
öfo
,

41 
sockaddr
 *
≠_addr
, *
exåa
);

42 
cfg80211_mgd_wext_giw≠
(
√t_devi˚
 *
dev
,

43 
iw_ªque°_öfo
 *
öfo
,

44 
sockaddr
 *
≠_addr
, *
exåa
);

45 
cfg80211_mgd_wext_siwessid
(
√t_devi˚
 *
dev
,

46 
iw_ªque°_öfo
 *
öfo
,

47 
iw_poöt
 *
d©a
, *
ssid
);

48 
cfg80211_mgd_wext_giwessid
(
√t_devi˚
 *
dev
,

49 
iw_ªque°_öfo
 *
öfo
,

50 
iw_poöt
 *
d©a
, *
ssid
);

52 
cfg80211_wext_siwmlme
(
√t_devi˚
 *
dev
,

53 
iw_ªque°_öfo
 *
öfo
,

54 
iwªq_d©a
 *
wrqu
, *
exåa
);

55 
cfg80211_wext_siwgíõ
(
√t_devi˚
 *
dev
,

56 
iw_ªque°_öfo
 *
öfo
,

57 
iwªq_d©a
 *
wrqu
, *
exåa
);

60 
cfg80211_wext_‰eq
(
iw_‰eq
 *
‰eq
);

63 c⁄° 
iw_h™dÀr_def
 
cfg80211_wext_h™dÀr
;

	@wext-core.c

11 
	~<löux/kî√l.h
>

12 
	~<löux/√tdevi˚.h
>

13 
	~<löux/π√éök.h
>

14 
	~<löux/¶ab.h
>

15 
	~<löux/wúñess.h
>

16 
	~<löux/uac˚ss.h
>

17 
	~<löux/exp‹t.h
>

18 
	~<√t/cfg80211.h
>

19 
	~<√t/iw_h™dÀr.h
>

20 
	~<√t/√éök.h
>

21 
	~<√t/wext.h
>

22 
	~<√t/√t_«me•a˚.h
>

24 (*
	twext_io˘l_func
)(
	t√t_devi˚
 *, 
	tiwªq
 *,

25 , 
	tiw_ªque°_öfo
 *,

26 
	tiw_h™dÀr
);

33 c⁄° 
iw_io˘l_des¸ùti⁄
 
°™d¨d_io˘l
[] = {

34 [
	`IW_IOCTL_IDX
(
SIOCSIWCOMMIT
)] = {

35 .
hódî_ty≥
 = 
IW_HEADER_TYPE_NULL
,

37 [
	`IW_IOCTL_IDX
(
SIOCGIWNAME
)] = {

38 .
hódî_ty≥
 = 
IW_HEADER_TYPE_CHAR
,

39 .
Êags
 = 
IW_DESCR_FLAG_DUMP
,

41 [
	`IW_IOCTL_IDX
(
SIOCSIWNWID
)] = {

42 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

43 .
Êags
 = 
IW_DESCR_FLAG_EVENT
,

45 [
	`IW_IOCTL_IDX
(
SIOCGIWNWID
)] = {

46 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

47 .
Êags
 = 
IW_DESCR_FLAG_DUMP
,

49 [
	`IW_IOCTL_IDX
(
SIOCSIWFREQ
)] = {

50 .
hódî_ty≥
 = 
IW_HEADER_TYPE_FREQ
,

51 .
Êags
 = 
IW_DESCR_FLAG_EVENT
,

53 [
	`IW_IOCTL_IDX
(
SIOCGIWFREQ
)] = {

54 .
hódî_ty≥
 = 
IW_HEADER_TYPE_FREQ
,

55 .
Êags
 = 
IW_DESCR_FLAG_DUMP
,

57 [
	`IW_IOCTL_IDX
(
SIOCSIWMODE
)] = {

58 .
hódî_ty≥
 = 
IW_HEADER_TYPE_UINT
,

59 .
Êags
 = 
IW_DESCR_FLAG_EVENT
,

61 [
	`IW_IOCTL_IDX
(
SIOCGIWMODE
)] = {

62 .
hódî_ty≥
 = 
IW_HEADER_TYPE_UINT
,

63 .
Êags
 = 
IW_DESCR_FLAG_DUMP
,

65 [
	`IW_IOCTL_IDX
(
SIOCSIWSENS
)] = {

66 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

68 [
	`IW_IOCTL_IDX
(
SIOCGIWSENS
)] = {

69 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

71 [
	`IW_IOCTL_IDX
(
SIOCSIWRANGE
)] = {

72 .
hódî_ty≥
 = 
IW_HEADER_TYPE_NULL
,

74 [
	`IW_IOCTL_IDX
(
SIOCGIWRANGE
)] = {

75 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

76 .
tokí_size
 = 1,

77 .
max_tokís
 = (
iw_ønge
),

78 .
Êags
 = 
IW_DESCR_FLAG_DUMP
,

80 [
	`IW_IOCTL_IDX
(
SIOCSIWPRIV
)] = {

81 .
hódî_ty≥
 = 
IW_HEADER_TYPE_NULL
,

83 [
	`IW_IOCTL_IDX
(
SIOCGIWPRIV
)] = {

84 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

85 .
tokí_size
 = (
iw_¥iv_¨gs
),

86 .
max_tokís
 = 16,

87 .
Êags
 = 
IW_DESCR_FLAG_NOMAX
,

89 [
	`IW_IOCTL_IDX
(
SIOCSIWSTATS
)] = {

90 .
hódî_ty≥
 = 
IW_HEADER_TYPE_NULL
,

92 [
	`IW_IOCTL_IDX
(
SIOCGIWSTATS
)] = {

93 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

94 .
tokí_size
 = 1,

95 .
max_tokís
 = (
iw_°©i°ics
),

96 .
Êags
 = 
IW_DESCR_FLAG_DUMP
,

98 [
	`IW_IOCTL_IDX
(
SIOCSIWSPY
)] = {

99 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

100 .
tokí_size
 = (
sockaddr
),

101 .
max_tokís
 = 
IW_MAX_SPY
,

103 [
	`IW_IOCTL_IDX
(
SIOCGIWSPY
)] = {

104 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

105 .
tokí_size
 = (
sockaddr
) +

106 (
iw_quÆôy
),

107 .
max_tokís
 = 
IW_MAX_SPY
,

109 [
	`IW_IOCTL_IDX
(
SIOCSIWTHRSPY
)] = {

110 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

111 .
tokí_size
 = (
iw_thr•y
),

112 .
mö_tokís
 = 1,

113 .
max_tokís
 = 1,

115 [
	`IW_IOCTL_IDX
(
SIOCGIWTHRSPY
)] = {

116 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

117 .
tokí_size
 = (
iw_thr•y
),

118 .
mö_tokís
 = 1,

119 .
max_tokís
 = 1,

121 [
	`IW_IOCTL_IDX
(
SIOCSIWAP
)] = {

122 .
hódî_ty≥
 = 
IW_HEADER_TYPE_ADDR
,

124 [
	`IW_IOCTL_IDX
(
SIOCGIWAP
)] = {

125 .
hódî_ty≥
 = 
IW_HEADER_TYPE_ADDR
,

126 .
Êags
 = 
IW_DESCR_FLAG_DUMP
,

128 [
	`IW_IOCTL_IDX
(
SIOCSIWMLME
)] = {

129 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

130 .
tokí_size
 = 1,

131 .
mö_tokís
 = (
iw_mlme
),

132 .
max_tokís
 = (
iw_mlme
),

134 [
	`IW_IOCTL_IDX
(
SIOCGIWAPLIST
)] = {

135 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

136 .
tokí_size
 = (
sockaddr
) +

137 (
iw_quÆôy
),

138 .
max_tokís
 = 
IW_MAX_AP
,

139 .
Êags
 = 
IW_DESCR_FLAG_NOMAX
,

141 [
	`IW_IOCTL_IDX
(
SIOCSIWSCAN
)] = {

142 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

143 .
tokí_size
 = 1,

144 .
mö_tokís
 = 0,

145 .
max_tokís
 = (
iw_sˇn_ªq
),

147 [
	`IW_IOCTL_IDX
(
SIOCGIWSCAN
)] = {

148 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

149 .
tokí_size
 = 1,

150 .
max_tokís
 = 
IW_SCAN_MAX_DATA
,

151 .
Êags
 = 
IW_DESCR_FLAG_NOMAX
,

153 [
	`IW_IOCTL_IDX
(
SIOCSIWESSID
)] = {

154 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

155 .
tokí_size
 = 1,

156 .
max_tokís
 = 
IW_ESSID_MAX_SIZE
,

157 .
Êags
 = 
IW_DESCR_FLAG_EVENT
,

159 [
	`IW_IOCTL_IDX
(
SIOCGIWESSID
)] = {

160 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

161 .
tokí_size
 = 1,

162 .
max_tokís
 = 
IW_ESSID_MAX_SIZE
,

163 .
Êags
 = 
IW_DESCR_FLAG_DUMP
,

165 [
	`IW_IOCTL_IDX
(
SIOCSIWNICKN
)] = {

166 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

167 .
tokí_size
 = 1,

168 .
max_tokís
 = 
IW_ESSID_MAX_SIZE
,

170 [
	`IW_IOCTL_IDX
(
SIOCGIWNICKN
)] = {

171 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

172 .
tokí_size
 = 1,

173 .
max_tokís
 = 
IW_ESSID_MAX_SIZE
,

175 [
	`IW_IOCTL_IDX
(
SIOCSIWRATE
)] = {

176 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

178 [
	`IW_IOCTL_IDX
(
SIOCGIWRATE
)] = {

179 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

181 [
	`IW_IOCTL_IDX
(
SIOCSIWRTS
)] = {

182 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

184 [
	`IW_IOCTL_IDX
(
SIOCGIWRTS
)] = {

185 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

187 [
	`IW_IOCTL_IDX
(
SIOCSIWFRAG
)] = {

188 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

190 [
	`IW_IOCTL_IDX
(
SIOCGIWFRAG
)] = {

191 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

193 [
	`IW_IOCTL_IDX
(
SIOCSIWTXPOW
)] = {

194 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

196 [
	`IW_IOCTL_IDX
(
SIOCGIWTXPOW
)] = {

197 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

199 [
	`IW_IOCTL_IDX
(
SIOCSIWRETRY
)] = {

200 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

202 [
	`IW_IOCTL_IDX
(
SIOCGIWRETRY
)] = {

203 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

205 [
	`IW_IOCTL_IDX
(
SIOCSIWENCODE
)] = {

206 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

207 .
tokí_size
 = 1,

208 .
max_tokís
 = 
IW_ENCODING_TOKEN_MAX
,

209 .
Êags
 = 
IW_DESCR_FLAG_EVENT
 | 
IW_DESCR_FLAG_RESTRICT
,

211 [
	`IW_IOCTL_IDX
(
SIOCGIWENCODE
)] = {

212 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

213 .
tokí_size
 = 1,

214 .
max_tokís
 = 
IW_ENCODING_TOKEN_MAX
,

215 .
Êags
 = 
IW_DESCR_FLAG_DUMP
 | 
IW_DESCR_FLAG_RESTRICT
,

217 [
	`IW_IOCTL_IDX
(
SIOCSIWPOWER
)] = {

218 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

220 [
	`IW_IOCTL_IDX
(
SIOCGIWPOWER
)] = {

221 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

223 [
	`IW_IOCTL_IDX
(
SIOCSIWGENIE
)] = {

224 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

225 .
tokí_size
 = 1,

226 .
max_tokís
 = 
IW_GENERIC_IE_MAX
,

228 [
	`IW_IOCTL_IDX
(
SIOCGIWGENIE
)] = {

229 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

230 .
tokí_size
 = 1,

231 .
max_tokís
 = 
IW_GENERIC_IE_MAX
,

233 [
	`IW_IOCTL_IDX
(
SIOCSIWAUTH
)] = {

234 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

236 [
	`IW_IOCTL_IDX
(
SIOCGIWAUTH
)] = {

237 .
hódî_ty≥
 = 
IW_HEADER_TYPE_PARAM
,

239 [
	`IW_IOCTL_IDX
(
SIOCSIWENCODEEXT
)] = {

240 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

241 .
tokí_size
 = 1,

242 .
mö_tokís
 = (
iw_ícode_ext
),

243 .
max_tokís
 = (
iw_ícode_ext
) +

244 
IW_ENCODING_TOKEN_MAX
,

246 [
	`IW_IOCTL_IDX
(
SIOCGIWENCODEEXT
)] = {

247 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

248 .
tokí_size
 = 1,

249 .
mö_tokís
 = (
iw_ícode_ext
),

250 .
max_tokís
 = (
iw_ícode_ext
) +

251 
IW_ENCODING_TOKEN_MAX
,

253 [
	`IW_IOCTL_IDX
(
SIOCSIWPMKSA
)] = {

254 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

255 .
tokí_size
 = 1,

256 .
mö_tokís
 = (
iw_pmkß
),

257 .
max_tokís
 = (
iw_pmkß
),

259 
	}
};

260 c⁄° 
	g°™d¨d_io˘l_num
 = 
ARRAY_SIZE
(
°™d¨d_io˘l
);

266 c⁄° 
iw_io˘l_des¸ùti⁄
 
	g°™d¨d_evít
[] = {

267 [
IW_EVENT_IDX
(
IWEVTXDROP
)] = {

268 .
hódî_ty≥
 = 
IW_HEADER_TYPE_ADDR
,

270 [
IW_EVENT_IDX
(
IWEVQUAL
)] = {

271 .
hódî_ty≥
 = 
IW_HEADER_TYPE_QUAL
,

273 [
IW_EVENT_IDX
(
IWEVCUSTOM
)] = {

274 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

275 .
	gtokí_size
 = 1,

276 .
	gmax_tokís
 = 
IW_CUSTOM_MAX
,

278 [
IW_EVENT_IDX
(
IWEVREGISTERED
)] = {

279 .
hódî_ty≥
 = 
IW_HEADER_TYPE_ADDR
,

281 [
IW_EVENT_IDX
(
IWEVEXPIRED
)] = {

282 .
hódî_ty≥
 = 
IW_HEADER_TYPE_ADDR
,

284 [
IW_EVENT_IDX
(
IWEVGENIE
)] = {

285 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

286 .
	gtokí_size
 = 1,

287 .
	gmax_tokís
 = 
IW_GENERIC_IE_MAX
,

289 [
IW_EVENT_IDX
(
IWEVMICHAELMICFAILURE
)] = {

290 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

291 .
	gtokí_size
 = 1,

292 .
	gmax_tokís
 = (
iw_mich´lmicÁûuª
),

294 [
IW_EVENT_IDX
(
IWEVASSOCREQIE
)] = {

295 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

296 .
	gtokí_size
 = 1,

297 .
	gmax_tokís
 = 
IW_GENERIC_IE_MAX
,

299 [
IW_EVENT_IDX
(
IWEVASSOCRESPIE
)] = {

300 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

301 .
	gtokí_size
 = 1,

302 .
	gmax_tokís
 = 
IW_GENERIC_IE_MAX
,

304 [
IW_EVENT_IDX
(
IWEVPMKIDCAND
)] = {

305 .
hódî_ty≥
 = 
IW_HEADER_TYPE_POINT
,

306 .
	gtokí_size
 = 1,

307 .
	gmax_tokís
 = (
iw_pmkid_ˇnd
),

310 c⁄° 
	g°™d¨d_evít_num
 = 
ARRAY_SIZE
(
°™d¨d_evít
);

313 c⁄° 
	gevít_ty≥_size
[] = {

314 
IW_EV_LCP_LEN
,

316 
IW_EV_CHAR_LEN
,

318 
IW_EV_UINT_LEN
,

319 
IW_EV_FREQ_LEN
,

320 
IW_EV_ADDR_LEN
,

322 
IW_EV_POINT_LEN
,

323 
IW_EV_PARAM_LEN
,

324 
IW_EV_QUAL_LEN
,

327 #ifde‡
CONFIG_COMPAT


328 c⁄° 
	gcom∑t_evít_ty≥_size
[] = {

329 
IW_EV_COMPAT_LCP_LEN
,

331 
IW_EV_COMPAT_CHAR_LEN
,

333 
IW_EV_COMPAT_UINT_LEN
,

334 
IW_EV_COMPAT_FREQ_LEN
,

335 
IW_EV_COMPAT_ADDR_LEN
,

337 
IW_EV_COMPAT_POINT_LEN
,

338 
IW_EV_COMPAT_PARAM_LEN
,

339 
IW_EV_COMPAT_QUAL_LEN
,

346 
	$wúñess_∆evít_Êush
()

348 
sk_buff
 *
skb
;

349 
√t
 *net;

351 
	`down_ªad
(&
√t_rw£m
);

352 
	`f‹_óch_√t
(
√t
) {

353 (
skb
 = 
	`skb_dequeue
(&
√t
->
wext_∆evíts
)))

354 
	`π∆_nŸify
(
skb
, 
√t
, 0, 
RTNLGRP_LINK
, 
NULL
,

355 
GFP_KERNEL
);

357 
	`up_ªad
(&
√t_rw£m
);

358 
	}
}

359 
EXPORT_SYMBOL_GPL
(
wúñess_∆evít_Êush
);

361 
	$wext_√tdev_nŸifõr_ˇŒ
(
nŸifõr_block
 *
nb
,

362 
°©e
, *
±r
)

371 
	`wúñess_∆evít_Êush
();

373  
NOTIFY_OK
;

374 
	}
}

376 
nŸifõr_block
 
	gwext_√tdev_nŸifõr
 = {

377 .
nŸifõr_ˇŒ
 = 
wext_√tdev_nŸifõr_ˇŒ
,

380 
__√t_öô
 
	$wext_≥∫ë_öô
(
√t
 *net)

382 
	`skb_queue_hód_öô
(&
√t
->
wext_∆evíts
);

384 
	}
}

386 
__√t_exô
 
	$wext_≥∫ë_exô
(
√t
 *net)

388 
	`skb_queue_purge
(&
√t
->
wext_∆evíts
);

389 
	}
}

391 
≥∫ë_›î©i⁄s
 
	gwext_≥∫ë_›s
 = {

392 .
öô
 = 
wext_≥∫ë_öô
,

393 .
	gexô
 = 
wext_≥∫ë_exô
,

396 
__öô
 
	$wúñess_∆evít_öô
()

398 
îr
 = 
	`ªgi°î_≥∫ë_subsys
(&
wext_≥∫ë_›s
);

400 i‡(
îr
)

401  
îr
;

403 
îr
 = 
	`ªgi°î_√tdevi˚_nŸifõr
(&
wext_√tdev_nŸifõr
);

404 i‡(
îr
)

405 
	`uƒegi°î_≥∫ë_subsys
(&
wext_≥∫ë_›s
);

406  
îr
;

407 
	}
}

409 
subsys_öôˇŒ
(
wúñess_∆evít_öô
);

412 
	$wúñess_∆evít_¥o˚ss
(
w‹k_°ru˘
 *
w‹k
)

414 
	`wúñess_∆evít_Êush
();

415 
	}
}

417 
DECLARE_WORK
(
wúñess_∆evít_w‹k
, 
wúñess_∆evít_¥o˚ss
);

419 
∆msghdr
 *
	$π√éök_iföfo_¥ï
(
√t_devi˚
 *
dev
,

420 
sk_buff
 *
skb
)

422 
iföfomsg
 *
r
;

423 
∆msghdr
 *
∆h
;

425 
∆h
 = 
	`∆msg_put
(
skb
, 0, 0, 
RTM_NEWLINK
, (*
r
), 0);

426 i‡(!
∆h
)

427  
NULL
;

429 
r
 = 
	`∆msg_d©a
(
∆h
);

430 
r
->
ifi_Ámûy
 = 
AF_UNSPEC
;

431 
r
->
__ifi_∑d
 = 0;

432 
r
->
ifi_ty≥
 = 
dev
->
ty≥
;

433 
r
->
ifi_ödex
 = 
dev
->
ifödex
;

434 
r
->
ifi_Êags
 = 
	`dev_gë_Êags
(
dev
);

435 
r
->
ifi_ch™ge
 = 0;

437 i‡(
	`∆a_put_°rög
(
skb
, 
IFLA_IFNAME
, 
dev
->
«me
))

438 
∆a_put_Áûuª
;

440  
∆h
;

441 
∆a_put_Áûuª
:

442 
	`∆msg_ˇn˚l
(
skb
, 
∆h
);

443  
NULL
;

444 
	}
}

452 
	$wúñess_£nd_evít
(
√t_devi˚
 * 
dev
,

453 
cmd
,

454 
iwªq_d©a
 * 
wrqu
,

455 c⁄° * 
exåa
)

457 c⁄° 
iw_io˘l_des¸ùti⁄
 * 
des¸
 = 
NULL
;

458 
exåa_Àn
 = 0;

459 
iw_evít
 *
evít
;

460 
evít_Àn
;

461 
hdr_Àn
;

462 
wrqu_off
 = 0;

464 
cmd_ödex
;

465 
sk_buff
 *
skb
;

466 
∆msghdr
 *
∆h
;

467 
∆©å
 *
∆a
;

468 #ifde‡
CONFIG_COMPAT


469 
__com∑t_iw_evít
 *
com∑t_evít
;

470 
com∑t_iw_poöt
 
com∑t_wrqu
;

471 
sk_buff
 *
compskb
;

472 
±r_Àn
;

483 i‡(
	`WARN_ON
(
cmd
 =
SIOCGIWSCAN
 && 
exåa
))

484 
exåa
 = 
NULL
;

487 i‡(
cmd
 <
SIOCIWLAST
) {

488 
cmd_ödex
 = 
	`IW_IOCTL_IDX
(
cmd
);

489 i‡(
cmd_ödex
 < 
°™d¨d_io˘l_num
)

490 
des¸
 = &(
°™d¨d_io˘l
[
cmd_ödex
]);

492 
cmd_ödex
 = 
	`IW_EVENT_IDX
(
cmd
);

493 i‡(
cmd_ödex
 < 
°™d¨d_evít_num
)

494 
des¸
 = &(
°™d¨d_evít
[
cmd_ödex
]);

497 i‡(
des¸
 =
NULL
) {

505 
	`√tdev_îr
(
dev
, "(WE) : Invalid/Unknown Wireless Event (0x%04X)\n",

506 
cmd
);

511 i‡(
des¸
->
hódî_ty≥
 =
IW_HEADER_TYPE_POINT
) {

513 i‡(
wrqu
->
d©a
.
Àngth
 > 
des¸
->
max_tokís
) {

514 
	`√tdev_îr
(
dev
, "(WE) : Wireless Event (cmd=0x%04X)Åoo big (%d)\n",

515 
cmd
, 
wrqu
->
d©a
.
Àngth
);

518 i‡(
wrqu
->
d©a
.
Àngth
 < 
des¸
->
mö_tokís
) {

519 
	`√tdev_îr
(
dev
, "(WE) : Wireless Event (cmd=0x%04X)Åoo small (%d)\n",

520 
cmd
, 
wrqu
->
d©a
.
Àngth
);

524 i‡(
exåa
 !
NULL
)

525 
exåa_Àn
 = 
wrqu
->
d©a
.
Àngth
 * 
des¸
->
tokí_size
;

527 
wrqu_off
 = 
IW_EV_POINT_OFF
;

531 
hdr_Àn
 = 
evít_ty≥_size
[
des¸
->
hódî_ty≥
];

532 
evít_Àn
 = 
hdr_Àn
 + 
exåa_Àn
;

557 
skb
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_ATOMIC
);

558 i‡(!
skb
)

562 
∆h
 = 
	`π√éök_iföfo_¥ï
(
dev
, 
skb
);

563 i‡(
	`WARN_ON
(!
∆h
)) {

564 
	`k‰ì_skb
(
skb
);

569 
∆a
 = 
	`∆a_ª£rve
(
skb
, 
IFLA_WIRELESS
, 
evít_Àn
);

570 i‡(!
∆a
) {

571 
	`k‰ì_skb
(
skb
);

574 
evít
 = 
	`∆a_d©a
(
∆a
);

577 
	`mem£t
(
evít
, 0, 
hdr_Àn
);

578 
evít
->
Àn
 = 
evít_Àn
;

579 
evít
->
cmd
 = cmd;

580 
	`mem˝y
(&
evít
->
u
, ((*Ë
wrqu
Ë+ 
wrqu_off
, 
hdr_Àn
 - 
IW_EV_LCP_LEN
);

581 i‡(
exåa_Àn
)

582 
	`mem˝y
(((*Ë
evít
Ë+ 
hdr_Àn
, 
exåa
, 
exåa_Àn
);

584 
	`∆msg_íd
(
skb
, 
∆h
);

585 #ifde‡
CONFIG_COMPAT


586 
hdr_Àn
 = 
com∑t_evít_ty≥_size
[
des¸
->
hódî_ty≥
];

589 
±r_Àn
 = 
hdr_Àn
 - 
IW_EV_COMPAT_LCP_LEN
;

590 
evít_Àn
 = 
hdr_Àn
 + 
exåa_Àn
;

592 
compskb
 = 
	`∆msg_√w
(
NLMSG_DEFAULT_SIZE
, 
GFP_ATOMIC
);

593 i‡(!
compskb
) {

594 
	`k‰ì_skb
(
skb
);

599 
∆h
 = 
	`π√éök_iföfo_¥ï
(
dev
, 
compskb
);

600 i‡(
	`WARN_ON
(!
∆h
)) {

601 
	`k‰ì_skb
(
skb
);

602 
	`k‰ì_skb
(
compskb
);

607 
∆a
 = 
	`∆a_ª£rve
(
compskb
, 
IFLA_WIRELESS
, 
evít_Àn
);

608 i‡(!
∆a
) {

609 
	`k‰ì_skb
(
skb
);

610 
	`k‰ì_skb
(
compskb
);

613 
com∑t_evít
 = 
	`∆a_d©a
(
∆a
);

615 
com∑t_evít
->
Àn
 = 
evít_Àn
;

616 
com∑t_evít
->
cmd
 = cmd;

617 i‡(
des¸
->
hódî_ty≥
 =
IW_HEADER_TYPE_POINT
) {

618 
com∑t_wrqu
.
Àngth
 = 
wrqu
->
d©a
.length;

619 
com∑t_wrqu
.
Êags
 = 
wrqu
->
d©a
.flags;

620 
	`mem˝y
(
com∑t_evít
->
±r_byãs
,

621 ((*)&
com∑t_wrqu
Ë+ 
IW_EV_COMPAT_POINT_OFF
,

622 
±r_Àn
);

623 i‡(
exåa_Àn
)

624 
	`mem˝y
(&
com∑t_evít
->
±r_byãs
[
±r_Àn
],

625 
exåa
, 
exåa_Àn
);

628 
	`mem˝y
(
com∑t_evít
->
±r_byãs
, 
wrqu
, 
±r_Àn
);

631 
	`∆msg_íd
(
compskb
, 
∆h
);

633 
	`skb_shöfo
(
skb
)->
‰ag_li°
 = 
compskb
;

635 
	`skb_queue_èû
(&
	`dev_√t
(
dev
)->
wext_∆evíts
, 
skb
);

636 
	`scheduÀ_w‹k
(&
wúñess_∆evít_w‹k
);

637 
	}
}

638 
EXPORT_SYMBOL
(
wúñess_£nd_evít
);

640 #ifde‡
CONFIG_CFG80211_WEXT


641 
	$wúñess_w¨n_cfg80211_wext
()

643 
«me
[(
cuºít
->
comm
)];

645 
	`¥_w¨n_⁄˚
("warning: `%s' uses wirelessÉxtensions which will stop working for Wi-Fi 7 hardware; useÇl80211\n",

646 
	`gë_èsk_comm
(
«me
, 
cuºít
));

647 
	}
}

652 
iw_°©i°ics
 *
	$gë_wúñess_°©s
(
√t_devi˚
 *
dev
)

654 #ifde‡
CONFIG_WIRELESS_EXT


655 i‡((
dev
->
wúñess_h™dÀrs
 !
NULL
) &&

656 (
dev
->
wúñess_h™dÀrs
->
gë_wúñess_°©s
 !
NULL
))

657  
dev
->
wúñess_h™dÀrs
->
	`gë_wúñess_°©s
(dev);

660 #ifde‡
CONFIG_CFG80211_WEXT


661 i‡(
dev
->
õì80211_±r
 &&

662 
dev
->
õì80211_±r
->
wùhy
 &&

663 
dev
->
õì80211_±r
->
wùhy
->
wext
 &&

664 
dev
->
õì80211_±r
->
wùhy
->
wext
->
gë_wúñess_°©s
) {

665 
	`wúñess_w¨n_cfg80211_wext
();

666 i‡(
dev
->
õì80211_±r
->
wùhy
->
Êags
 & (
WIPHY_FLAG_SUPPORTS_MLO
 |

667 
WIPHY_FLAG_DISABLE_WEXT
))

668  
NULL
;

669  
dev
->
õì80211_±r
->
wùhy
->
wext
->
	`gë_wúñess_°©s
(dev);

674  
NULL
;

675 
	}
}

678 
noölöe
 
	$iw_h™dÀr_gë_iw°©s
(
√t_devi˚
 * 
dev
,

679 
iw_ªque°_öfo
 * 
öfo
,

680 
iwªq_d©a
 * 
wrqu
,

681 * 
exåa
)

684 
iw_°©i°ics
 *
°©s
;

686 
°©s
 = 
	`gë_wúñess_°©s
(
dev
);

687 i‡(
°©s
) {

689 
	`mem˝y
(
exåa
, 
°©s
, (
iw_°©i°ics
));

690 
wrqu
->
d©a
.
Àngth
 = (
iw_°©i°ics
);

693 i‡(
wrqu
->
d©a
.
Êags
 != 0)

694 
°©s
->
quÆ
.
upd©ed
 &~
IW_QUAL_ALL_UPDATED
;

697  -
EOPNOTSUPP
;

698 
	}
}

700 
iw_h™dÀr
 
	$gë_h™dÀr
(
√t_devi˚
 *
dev
, 
cmd
)

703 
ödex
;

704 c⁄° 
iw_h™dÀr_def
 *
h™dÀrs
 = 
NULL
;

706 #ifde‡
CONFIG_CFG80211_WEXT


707 i‡(
dev
->
õì80211_±r
 && dev->õì80211_±r->
wùhy
) {

708 
	`wúñess_w¨n_cfg80211_wext
();

709 i‡(
dev
->
õì80211_±r
->
wùhy
->
Êags
 & (
WIPHY_FLAG_SUPPORTS_MLO
 |

710 
WIPHY_FLAG_DISABLE_WEXT
))

711  
NULL
;

712 
h™dÀrs
 = 
dev
->
õì80211_±r
->
wùhy
->
wext
;

715 #ifde‡
CONFIG_WIRELESS_EXT


716 i‡(
dev
->
wúñess_h™dÀrs
)

717 
h™dÀrs
 = 
dev
->
wúñess_h™dÀrs
;

720 i‡(!
h™dÀrs
)

721  
NULL
;

724 
ödex
 = 
	`IW_IOCTL_IDX
(
cmd
);

725 i‡(
ödex
 < 
h™dÀrs
->
num_°™d¨d
)

726  
h™dÀrs
->
°™d¨d
[
ödex
];

728 #ifde‡
CONFIG_WEXT_PRIV


730 
ödex
 = 
cmd
 - 
SIOCIWFIRSTPRIV
;

731 i‡(
ödex
 < 
h™dÀrs
->
num_¥iv©e
)

732  
h™dÀrs
->
¥iv©e
[
ödex
];

736  
NULL
;

737 
	}
}

739 
	$io˘l_°™d¨d_iw_poöt
(
iw_poöt
 *
iwp
, 
cmd
,

740 c⁄° 
iw_io˘l_des¸ùti⁄
 *
des¸
,

741 
iw_h™dÀr
 
h™dÀr
, 
√t_devi˚
 *
dev
,

742 
iw_ªque°_öfo
 *
öfo
)

744 
îr
, 
exåa_size
, 
u£r_Àngth
 = 0, 
essid_com∑t
 = 0;

745 *
exåa
;

750 
exåa_size
 = 
des¸
->
max_tokís
 * des¸->
tokí_size
;

753 
cmd
) {

754 
SIOCSIWESSID
:

755 
SIOCGIWESSID
:

756 
SIOCSIWNICKN
:

757 
SIOCGIWNICKN
:

758 i‡(
iwp
->
Àngth
 =
des¸
->
max_tokís
 + 1)

759 
essid_com∑t
 = 1;

760 i‡(
	`IW_IS_SET
(
cmd
Ë&& (
iwp
->
Àngth
 != 0)) {

761 
essid
[
IW_ESSID_MAX_SIZE
 + 1];

762 
Àn
;

763 
Àn
 = 
iwp
->
Àngth
 * 
des¸
->
tokí_size
;

765 i‡(
Àn
 > 
IW_ESSID_MAX_SIZE
)

766  -
EFAULT
;

768 
îr
 = 
	`c›y_‰om_u£r
(
essid
, 
iwp
->
poöãr
, 
Àn
);

769 i‡(
îr
)

770  -
EFAULT
;

772 i‡(
essid
[
iwp
->
Àngth
 - 1] == '\0')

773 
essid_com∑t
 = 1;

780 
iwp
->
Àngth
 -
essid_com∑t
;

783 i‡(
	`IW_IS_SET
(
cmd
)) {

785 i‡(!
iwp
->
poöãr
 && iwp->
Àngth
 != 0)

786  -
EFAULT
;

788 i‡(
iwp
->
Àngth
 > 
des¸
->
max_tokís
)

789  -
E2BIG
;

790 i‡(
iwp
->
Àngth
 < 
des¸
->
mö_tokís
)

791  -
EINVAL
;

794 i‡(!
iwp
->
poöãr
)

795  -
EFAULT
;

797 
u£r_Àngth
 = 
iwp
->
Àngth
;

805 i‡((
des¸
->
Êags
 & 
IW_DESCR_FLAG_NOMAX
) &&

806 (
u£r_Àngth
 > 
des¸
->
max_tokís
)) {

811 
exåa_size
 = 
u£r_Àngth
 * 
des¸
->
tokí_size
;

824 i‡(
exåa_size
 <= 0)

825  -
EFAULT
;

828 
exåa
 = 
	`kzÆloc
(
exåa_size
, 
GFP_KERNEL
);

829 i‡(!
exåa
)

830  -
ENOMEM
;

833 i‡(
	`IW_IS_SET
(
cmd
Ë&& (
iwp
->
Àngth
 != 0)) {

834 i‡(
	`c›y_‰om_u£r
(
exåa
, 
iwp
->
poöãr
,

835 
iwp
->
Àngth
 *

836 
des¸
->
tokí_size
)) {

837 
îr
 = -
EFAULT
;

838 
out
;

841 i‡(
cmd
 =
SIOCSIWENCODEEXT
) {

842 
iw_ícode_ext
 *
ì
 = (*Ë
exåa
;

844 i‡(
iwp
->
Àngth
 < (*
ì
Ë+Ée->
key_Àn
) {

845 
îr
 = -
EFAULT
;

846 
out
;

851 i‡(
	`IW_IS_GET
(
cmd
Ë&& !(
des¸
->
Êags
 & 
IW_DESCR_FLAG_NOMAX
)) {

864 
iwp
->
Àngth
 = 
des¸
->
max_tokís
;

867 
îr
 = 
	`h™dÀr
(
dev
, 
öfo
, (
iwªq_d©a
 *Ë
iwp
, 
exåa
);

869 
iwp
->
Àngth
 +
essid_com∑t
;

872 i‡(!
îr
 && 
	`IW_IS_GET
(
cmd
)) {

874 i‡(
u£r_Àngth
 < 
iwp
->
Àngth
) {

875 
îr
 = -
E2BIG
;

876 
out
;

879 i‡(
	`c›y_to_u£r
(
iwp
->
poöãr
, 
exåa
,

880 
iwp
->
Àngth
 *

881 
des¸
->
tokí_size
)) {

882 
îr
 = -
EFAULT
;

883 
out
;

888 i‡((
des¸
->
Êags
 & 
IW_DESCR_FLAG_EVENT
) &&

889 ((
îr
 =0Ë|| (î∏=-
EIWCOMMIT
))) {

890 
iwªq_d©a
 *
d©a
 = (iwªq_d©®*Ë
iwp
;

892 i‡(
des¸
->
Êags
 & 
IW_DESCR_FLAG_RESTRICT
)

896 
	`wúñess_£nd_evít
(
dev
, 
cmd
, 
d©a
, 
NULL
);

898 
	`wúñess_£nd_evít
(
dev
, 
cmd
, 
d©a
, 
exåa
);

901 
out
:

902 
	`k‰ì
(
exåa
);

903  
îr
;

904 
	}
}

924 
	$ˇŒ_commô_h™dÀr
(
√t_devi˚
 *
dev
)

926 #ifde‡
CONFIG_WIRELESS_EXT


927 i‡(
	`√tif_ru¬ög
(
dev
) &&

928 
dev
->
wúñess_h™dÀrs
 &&

929 
dev
->
wúñess_h™dÀrs
->
°™d¨d
[0])

931  
dev
->
wúñess_h™dÀrs
->
°™d¨d
[0](dev, 
NULL
,

932 
NULL
, NULL);

939 
	}
}

945 
	$wúñess_¥o˚ss_io˘l
(
√t
 *√t, 
iwªq
 *
iwr
,

946 
cmd
,

947 
iw_ªque°_öfo
 *
öfo
,

948 
wext_io˘l_func
 
°™d¨d
,

949 
wext_io˘l_func
 
¥iv©e
)

951 
√t_devi˚
 *
dev
;

952 
iw_h™dÀr
 
h™dÀr
;

958 i‡((
dev
 = 
	`__dev_gë_by_«me
(
√t
, 
iwr
->
i‰_«me
)Ë=
NULL
)

959  -
ENODEV
;

964 i‡(
cmd
 =
SIOCGIWSTATS
)

965  
	`°™d¨d
(
dev
, 
iwr
, 
cmd
, 
öfo
,

966 &
iw_h™dÀr_gë_iw°©s
);

968 #ifde‡
CONFIG_WEXT_PRIV


969 i‡(
cmd
 =
SIOCGIWPRIV
 && 
dev
->
wúñess_h™dÀrs
)

970  
	`°™d¨d
(
dev
, 
iwr
, 
cmd
, 
öfo
,

971 
iw_h™dÀr_gë_¥iv©e
);

975 i‡(!
	`√tif_devi˚_¥e£¡
(
dev
))

976  -
ENODEV
;

979 
h™dÀr
 = 
	`gë_h™dÀr
(
dev
, 
cmd
);

980 i‡(
h™dÀr
) {

982 i‡(
cmd
 < 
SIOCIWFIRSTPRIV
)

983  
	`°™d¨d
(
dev
, 
iwr
, 
cmd
, 
öfo
, 
h™dÀr
);

984 i‡(
¥iv©e
)

985  
	`¥iv©e
(
dev
, 
iwr
, 
cmd
, 
öfo
, 
h™dÀr
);

987  -
EOPNOTSUPP
;

988 
	}
}

993 
	$wext_≥rmissi⁄_check
(
cmd
)

995 i‡((
	`IW_IS_SET
(
cmd
Ë|| cmd =
SIOCGIWENCODE
 ||

996 
cmd
 =
SIOCGIWENCODEEXT
) &&

997 !
	`ˇ∑bÀ
(
CAP_NET_ADMIN
))

998  -
EPERM
;

1001 
	}
}

1004 
	$wext_io˘l_di•©ch
(
√t
 *√t, 
iwªq
 *
iwr
,

1005 
cmd
, 
iw_ªque°_öfo
 *
öfo
,

1006 
wext_io˘l_func
 
°™d¨d
,

1007 
wext_io˘l_func
 
¥iv©e
)

1009 
ªt
 = 
	`wext_≥rmissi⁄_check
(
cmd
);

1011 i‡(
ªt
)

1012  
ªt
;

1014 
	`dev_lﬂd
(
√t
, 
iwr
->
i‰_«me
);

1015 
	`π∆_lock
();

1016 
ªt
 = 
	`wúñess_¥o˚ss_io˘l
(
√t
, 
iwr
, 
cmd
, 
öfo
, 
°™d¨d
, 
¥iv©e
);

1017 
	`π∆_u∆ock
();

1019  
ªt
;

1020 
	}
}

1027 
	$io˘l_°™d¨d_ˇŒ
(
√t_devi˚
 * 
dev
,

1028 
iwªq
 *
iwr
,

1029 
cmd
,

1030 
iw_ªque°_öfo
 *
öfo
,

1031 
iw_h™dÀr
 
h™dÀr
)

1033 c⁄° 
iw_io˘l_des¸ùti⁄
 * 
des¸
;

1034 
ªt
 = -
EINVAL
;

1037 i‡(
	`IW_IOCTL_IDX
(
cmd
Ë>
°™d¨d_io˘l_num
)

1038  -
EOPNOTSUPP
;

1039 
des¸
 = &(
°™d¨d_io˘l
[
	`IW_IOCTL_IDX
(
cmd
)]);

1042 i‡(
des¸
->
hódî_ty≥
 !
IW_HEADER_TYPE_POINT
) {

1045 
ªt
 = 
	`h™dÀr
(
dev
, 
öfo
, &(
iwr
->
u
), 
NULL
);

1048 i‡((
des¸
->
Êags
 & 
IW_DESCR_FLAG_EVENT
) &&

1049 ((
ªt
 =0Ë|| (ªà=-
EIWCOMMIT
)))

1050 
	`wúñess_£nd_evít
(
dev
, 
cmd
, &(
iwr
->
u
), 
NULL
);

1052 
ªt
 = 
	`io˘l_°™d¨d_iw_poöt
(&
iwr
->
u
.
d©a
, 
cmd
, 
des¸
,

1053 
h™dÀr
, 
dev
, 
öfo
);

1057 i‡(
ªt
 =-
EIWCOMMIT
)

1058 
ªt
 = 
	`ˇŒ_commô_h™dÀr
(
dev
);

1062  
ªt
;

1063 
	}
}

1066 
	$wext_h™dÀ_io˘l
(
√t
 *√t, 
cmd
, 
__u£r
 *
¨g
)

1068 
iw_ªque°_öfo
 
öfo
 = { .
cmd
 = cmd, .
Êags
 = 0 };

1069 
iwªq
 
iwr
;

1070 
ªt
;

1072 i‡(
	`c›y_‰om_u£r
(&
iwr
, 
¨g
, (iwr)))

1073  -
EFAULT
;

1075 
iwr
.
i‰_«me
[(iwr.ifr_name) - 1] = 0;

1077 
ªt
 = 
	`wext_io˘l_di•©ch
(
√t
, &
iwr
, 
cmd
, &
öfo
,

1078 
io˘l_°™d¨d_ˇŒ
,

1079 
io˘l_¥iv©e_ˇŒ
);

1080 i‡(
ªt
 >= 0 &&

1081 
	`IW_IS_GET
(
cmd
) &&

1082 
	`c›y_to_u£r
(
¨g
, &
iwr
, (
iwªq
)))

1083  -
EFAULT
;

1085  
ªt
;

1086 
	}
}

1088 #ifde‡
CONFIG_COMPAT


1089 
	$com∑t_°™d¨d_ˇŒ
(
√t_devi˚
 *
dev
,

1090 
iwªq
 *
iwr
,

1091 
cmd
,

1092 
iw_ªque°_öfo
 *
öfo
,

1093 
iw_h™dÀr
 
h™dÀr
)

1095 c⁄° 
iw_io˘l_des¸ùti⁄
 *
des¸
;

1096 
com∑t_iw_poöt
 *
iwp_com∑t
;

1097 
iw_poöt
 
iwp
;

1098 
îr
;

1100 
des¸
 = 
°™d¨d_io˘l
 + 
	`IW_IOCTL_IDX
(
cmd
);

1102 i‡(
des¸
->
hódî_ty≥
 !
IW_HEADER_TYPE_POINT
)

1103  
	`io˘l_°™d¨d_ˇŒ
(
dev
, 
iwr
, 
cmd
, 
öfo
, 
h™dÀr
);

1105 
iwp_com∑t
 = (
com∑t_iw_poöt
 *Ë&
iwr
->
u
.
d©a
;

1106 
iwp
.
poöãr
 = 
	`com∑t_±r
(
iwp_com∑t
->pointer);

1107 
iwp
.
Àngth
 = 
iwp_com∑t
->length;

1108 
iwp
.
Êags
 = 
iwp_com∑t
->flags;

1110 
îr
 = 
	`io˘l_°™d¨d_iw_poöt
(&
iwp
, 
cmd
, 
des¸
, 
h™dÀr
, 
dev
, 
öfo
);

1112 
iwp_com∑t
->
poöãr
 = 
	`±r_to_com∑t
(
iwp
.pointer);

1113 
iwp_com∑t
->
Àngth
 = 
iwp
.length;

1114 
iwp_com∑t
->
Êags
 = 
iwp
.flags;

1116  
îr
;

1117 
	}
}

1119 
	$com∑t_wext_h™dÀ_io˘l
(
√t
 *√t, 
cmd
,

1120 
¨g
)

1122 
__u£r
 *
¨gp
 = (__u£∏*)
¨g
;

1123 
iw_ªque°_öfo
 
öfo
;

1124 
iwªq
 
iwr
;

1125 *
cﬁ⁄
;

1126 
ªt
;

1128 i‡(
	`c›y_‰om_u£r
(&
iwr
, 
¨gp
, (
iwªq
)))

1129  -
EFAULT
;

1131 
iwr
.
i‰_«me
[
IFNAMSIZ
-1] = 0;

1132 
cﬁ⁄
 = 
	`°rchr
(
iwr
.
i‰_«me
, ':');

1133 i‡(
cﬁ⁄
)

1134 *
cﬁ⁄
 = 0;

1136 
öfo
.
cmd
 = cmd;

1137 
öfo
.
Êags
 = 
IW_REQUEST_FLAG_COMPAT
;

1139 
ªt
 = 
	`wext_io˘l_di•©ch
(
√t
, &
iwr
, 
cmd
, &
öfo
,

1140 
com∑t_°™d¨d_ˇŒ
,

1141 
com∑t_¥iv©e_ˇŒ
);

1143 i‡(
ªt
 >= 0 &&

1144 
	`IW_IS_GET
(
cmd
) &&

1145 
	`c›y_to_u£r
(
¨gp
, &
iwr
, (
iwªq
)))

1146  -
EFAULT
;

1148  
ªt
;

1149 
	}
}

1152 *
	$iwe_°ªam_add_evít
(
iw_ªque°_öfo
 *
öfo
, *
°ªam
,

1153 *
íds
, 
iw_evít
 *
iwe
, 
evít_Àn
)

1155 
l˝_Àn
 = 
	`iwe_°ªam_l˝_Àn
(
öfo
);

1157 
evít_Àn
 = 
	`iwe_°ªam_evít_Àn_adju°
(
öfo
,Évent_len);

1160 i‡(
	`likñy
((
°ªam
 + 
evít_Àn
Ë< 
íds
)) {

1161 
iwe
->
Àn
 = 
evít_Àn
;

1163 
	`mem˝y
(
°ªam
, (*Ë
iwe
, 
IW_EV_LCP_PK_LEN
);

1164 
	`mem˝y
(
°ªam
 + 
l˝_Àn
, &
iwe
->
u
,

1165 
evít_Àn
 - 
l˝_Àn
);

1166 
°ªam
 +
evít_Àn
;

1169  
°ªam
;

1170 
	}
}

1171 
EXPORT_SYMBOL
(
iwe_°ªam_add_evít
);

1173 *
	$iwe_°ªam_add_poöt
(
iw_ªque°_öfo
 *
öfo
, *
°ªam
,

1174 *
íds
, 
iw_evít
 *
iwe
, *
exåa
)

1176 
evít_Àn
 = 
	`iwe_°ªam_poöt_Àn
(
öfo
Ë+ 
iwe
->
u
.
d©a
.
Àngth
;

1177 
poöt_Àn
 = 
	`iwe_°ªam_poöt_Àn
(
öfo
);

1178 
l˝_Àn
 = 
	`iwe_°ªam_l˝_Àn
(
öfo
);

1181 i‡(
	`likñy
((
°ªam
 + 
evít_Àn
Ë< 
íds
)) {

1182 
iwe
->
Àn
 = 
evít_Àn
;

1183 
	`mem˝y
(
°ªam
, (*Ë
iwe
, 
IW_EV_LCP_PK_LEN
);

1184 
	`mem˝y
(
°ªam
 + 
l˝_Àn
,

1185 ((*Ë&
iwe
->
u
Ë+ 
IW_EV_POINT_OFF
,

1186 
IW_EV_POINT_PK_LEN
 - 
IW_EV_LCP_PK_LEN
);

1187 i‡(
iwe
->
u
.
d©a
.
Àngth
 && 
exåa
)

1188 
	`mem˝y
(
°ªam
 + 
poöt_Àn
, 
exåa
, 
iwe
->
u
.
d©a
.
Àngth
);

1189 
°ªam
 +
evít_Àn
;

1192  
°ªam
;

1193 
	}
}

1194 
EXPORT_SYMBOL
(
iwe_°ªam_add_poöt
);

1196 *
	$iwe_°ªam_add_vÆue
(
iw_ªque°_öfo
 *
öfo
, *
evít
,

1197 *
vÆue
, *
íds
, 
iw_evít
 *
iwe
,

1198 
evít_Àn
)

1200 
l˝_Àn
 = 
	`iwe_°ªam_l˝_Àn
(
öfo
);

1203 
evít_Àn
 -
IW_EV_LCP_LEN
;

1206 i‡(
	`likñy
((
vÆue
 + 
evít_Àn
Ë< 
íds
)) {

1208 
	`mem˝y
(
vÆue
, &
iwe
->
u
, 
evít_Àn
);

1209 
vÆue
 +
evít_Àn
;

1211 
iwe
->
Àn
 = 
vÆue
 - 
evít
;

1212 
	`mem˝y
(
evít
, (*Ë
iwe
, 
l˝_Àn
);

1215  
vÆue
;

1216 
	}
}

1217 
EXPORT_SYMBOL
(
iwe_°ªam_add_vÆue
);

	@wext-priv.c

10 
	~<löux/¶ab.h
>

11 
	~<löux/wúñess.h
>

12 
	~<löux/√tdevi˚.h
>

13 
	~<√t/iw_h™dÀr.h
>

14 
	~<√t/wext.h
>

16 
	$iw_h™dÀr_gë_¥iv©e
(
√t_devi˚
 * 
dev
,

17 
iw_ªque°_öfo
 * 
öfo
,

18 
iwªq_d©a
 * 
wrqu
,

19 * 
exåa
)

22 i‡((
dev
->
wúñess_h™dÀrs
->
num_¥iv©e_¨gs
 == 0) ||

23 (
dev
->
wúñess_h™dÀrs
->
¥iv©e_¨gs
 =
NULL
))

24  -
EOPNOTSUPP
;

27 i‡(
wrqu
->
d©a
.
Àngth
 < 
dev
->
wúñess_h™dÀrs
->
num_¥iv©e_¨gs
) {

31 
wrqu
->
d©a
.
Àngth
 = 
dev
->
wúñess_h™dÀrs
->
num_¥iv©e_¨gs
;

32  -
E2BIG
;

36 
wrqu
->
d©a
.
Àngth
 = 
dev
->
wúñess_h™dÀrs
->
num_¥iv©e_¨gs
;

39 
	`mem˝y
(
exåa
, 
dev
->
wúñess_h™dÀrs
->
¥iv©e_¨gs
,

40 (
iw_¥iv_¨gs
Ë* 
wrqu
->
d©a
.
Àngth
);

43 
	}
}

46 c⁄° 
	giw_¥iv_ty≥_size
[] = {

51 (
__u32
),

52 (
iw_‰eq
),

53 (
sockaddr
),

57 
	$gë_¥iv_size
(
__u16
 
¨gs
)

59 
num
 = 
¨gs
 & 
IW_PRIV_SIZE_MASK
;

60 
ty≥
 = (
¨gs
 & 
IW_PRIV_TYPE_MASK
) >> 12;

62  
num
 * 
iw_¥iv_ty≥_size
[
ty≥
];

63 
	}
}

65 
	$adju°_¥iv_size
(
__u16
 
¨gs
, 
iw_poöt
 *
iwp
)

67 
num
 = 
iwp
->
Àngth
;

68 
max
 = 
¨gs
 & 
IW_PRIV_SIZE_MASK
;

69 
ty≥
 = (
¨gs
 & 
IW_PRIV_TYPE_MASK
) >> 12;

72 i‡(
max
 < 
num
)

73 
num
 = 
max
;

75  
num
 * 
iw_¥iv_ty≥_size
[
ty≥
];

76 
	}
}

93 
	$gë_¥iv_des¸_™d_size
(
√t_devi˚
 *
dev
, 
cmd
,

94 c⁄° 
iw_¥iv_¨gs
 **
des¸p
)

96 c⁄° 
iw_¥iv_¨gs
 *
des¸
;

97 
i
, 
exåa_size
;

99 
des¸
 = 
NULL
;

100 
i
 = 0; i < 
dev
->
wúñess_h™dÀrs
->
num_¥iv©e_¨gs
; i++) {

101 i‡(
cmd
 =
dev
->
wúñess_h™dÀrs
->
¥iv©e_¨gs
[
i
].cmd) {

102 
des¸
 = &
dev
->
wúñess_h™dÀrs
->
¥iv©e_¨gs
[
i
];

107 
exåa_size
 = 0;

108 i‡(
des¸
) {

109 i‡(
	`IW_IS_SET
(
cmd
)) {

110 
off£t
 = 0;

112 i‡(
des¸
->
«me
[0] == '\0')

114 
off£t
 = (
__u32
);

117 
exåa_size
 = 
	`gë_¥iv_size
(
des¸
->
£t_¨gs
);

120 i‡((
des¸
->
£t_¨gs
 & 
IW_PRIV_SIZE_FIXED
) &&

121 ((
exåa_size
 + 
off£t
Ë<
IFNAMSIZ
))

122 
exåa_size
 = 0;

125 
exåa_size
 = 
	`gë_¥iv_size
(
des¸
->
gë_¨gs
);

128 i‡((
des¸
->
gë_¨gs
 & 
IW_PRIV_SIZE_FIXED
) &&

129 (
exåa_size
 <
IFNAMSIZ
))

130 
exåa_size
 = 0;

133 *
des¸p
 = 
des¸
;

134  
exåa_size
;

135 
	}
}

137 
	$io˘l_¥iv©e_iw_poöt
(
iw_poöt
 *
iwp
, 
cmd
,

138 c⁄° 
iw_¥iv_¨gs
 *
des¸
,

139 
iw_h™dÀr
 
h™dÀr
, 
√t_devi˚
 *
dev
,

140 
iw_ªque°_öfo
 *
öfo
, 
exåa_size
)

142 *
exåa
;

143 
îr
;

146 i‡(
	`IW_IS_SET
(
cmd
)) {

147 i‡(!
iwp
->
poöãr
 && iwp->
Àngth
 != 0)

148  -
EFAULT
;

150 i‡(
iwp
->
Àngth
 > (
des¸
->
£t_¨gs
 & 
IW_PRIV_SIZE_MASK
))

151  -
E2BIG
;

152 } i‡(!
iwp
->
poöãr
)

153  -
EFAULT
;

155 
exåa
 = 
	`kzÆloc
(
exåa_size
, 
GFP_KERNEL
);

156 i‡(!
exåa
)

157  -
ENOMEM
;

160 i‡(
	`IW_IS_SET
(
cmd
Ë&& (
iwp
->
Àngth
 != 0)) {

161 i‡(
	`c›y_‰om_u£r
(
exåa
, 
iwp
->
poöãr
, 
exåa_size
)) {

162 
îr
 = -
EFAULT
;

163 
out
;

168 
îr
 = 
	`h™dÀr
(
dev
, 
öfo
, (
iwªq_d©a
 *Ë
iwp
, 
exåa
);

171 i‡(!
îr
 && 
	`IW_IS_GET
(
cmd
)) {

175 i‡(!(
des¸
->
gë_¨gs
 & 
IW_PRIV_SIZE_FIXED
))

176 
exåa_size
 = 
	`adju°_¥iv_size
(
des¸
->
gë_¨gs
, 
iwp
);

178 i‡(
	`c›y_to_u£r
(
iwp
->
poöãr
, 
exåa
, 
exåa_size
))

179 
îr
 = -
EFAULT
;

182 
out
:

183 
	`k‰ì
(
exåa
);

184  
îr
;

185 
	}
}

187 
	$io˘l_¥iv©e_ˇŒ
(
√t_devi˚
 *
dev
, 
iwªq
 *
iwr
,

188 
cmd
, 
iw_ªque°_öfo
 *
öfo
,

189 
iw_h™dÀr
 
h™dÀr
)

191 
exåa_size
 = 0, 
ªt
 = -
EINVAL
;

192 c⁄° 
iw_¥iv_¨gs
 *
des¸
;

194 
exåa_size
 = 
	`gë_¥iv_des¸_™d_size
(
dev
, 
cmd
, &
des¸
);

197 i‡(
exåa_size
 == 0) {

199 
ªt
 = 
	`h™dÀr
(
dev
, 
öfo
, &(
iwr
->
u
), (*) &(iwr->u));

201 
ªt
 = 
	`io˘l_¥iv©e_iw_poöt
(&
iwr
->
u
.
d©a
, 
cmd
, 
des¸
,

202 
h™dÀr
, 
dev
, 
öfo
, 
exåa_size
);

206 i‡(
ªt
 =-
EIWCOMMIT
)

207 
ªt
 = 
	`ˇŒ_commô_h™dÀr
(
dev
);

209  
ªt
;

210 
	}
}

212 #ifde‡
CONFIG_COMPAT


213 
	$com∑t_¥iv©e_ˇŒ
(
√t_devi˚
 *
dev
, 
iwªq
 *
iwr
,

214 
cmd
, 
iw_ªque°_öfo
 *
öfo
,

215 
iw_h™dÀr
 
h™dÀr
)

217 c⁄° 
iw_¥iv_¨gs
 *
des¸
;

218 
ªt
, 
exåa_size
;

220 
exåa_size
 = 
	`gë_¥iv_des¸_™d_size
(
dev
, 
cmd
, &
des¸
);

223 i‡(
exåa_size
 == 0) {

225 
ªt
 = 
	`h™dÀr
(
dev
, 
öfo
, &(
iwr
->
u
), (*) &(iwr->u));

227 
com∑t_iw_poöt
 *
iwp_com∑t
;

228 
iw_poöt
 
iwp
;

230 
iwp_com∑t
 = (
com∑t_iw_poöt
 *Ë&
iwr
->
u
.
d©a
;

231 
iwp
.
poöãr
 = 
	`com∑t_±r
(
iwp_com∑t
->pointer);

232 
iwp
.
Àngth
 = 
iwp_com∑t
->length;

233 
iwp
.
Êags
 = 
iwp_com∑t
->flags;

235 
ªt
 = 
	`io˘l_¥iv©e_iw_poöt
(&
iwp
, 
cmd
, 
des¸
,

236 
h™dÀr
, 
dev
, 
öfo
, 
exåa_size
);

238 
iwp_com∑t
->
poöãr
 = 
	`±r_to_com∑t
(
iwp
.pointer);

239 
iwp_com∑t
->
Àngth
 = 
iwp
.length;

240 
iwp_com∑t
->
Êags
 = 
iwp
.flags;

244 i‡(
ªt
 =-
EIWCOMMIT
)

245 
ªt
 = 
	`ˇŒ_commô_h™dÀr
(
dev
);

247  
ªt
;

248 
	}
}

	@wext-proc.c

19 
	~<löux/moduÀ.h
>

20 
	~<löux/¥oc_fs.h
>

21 
	~<löux/£q_fûe.h
>

22 
	~<löux/wúñess.h
>

23 
	~<löux/√tdevi˚.h
>

24 
	~<löux/π√éök.h
>

25 
	~<√t/iw_h™dÀr.h
>

26 
	~<√t/wext.h
>

29 
	$wúñess_£q_¥ötf_°©s
(
£q_fûe
 *
£q
,

30 
√t_devi˚
 *
dev
)

33 
iw_°©i°ics
 *
°©s
 = 
	`gë_wúñess_°©s
(
dev
);

34 
iw_°©i°ics
 
nuŒ°©s
 = {};

37 i‡(!
°©s
) {

38 #ifde‡
CONFIG_WIRELESS_EXT


39 i‡(
dev
->
wúñess_h™dÀrs
)

40 
°©s
 = &
nuŒ°©s
;

42 #ifde‡
CONFIG_CFG80211


43 i‡(
dev
->
õì80211_±r
)

44 
°©s
 = &
nuŒ°©s
;

48 i‡(
°©s
) {

49 
	`£q_¥ötf
(
£q
, "%6s: %04x %3d%c %3d%c %3d%c %6d %6d %6d "

51 
dev
->
«me
, 
°©s
->
°©us
, sèts->
quÆ
.qual,

52 
°©s
->
quÆ
.
upd©ed
 & 
IW_QUAL_QUAL_UPDATED


54 ((
__s32
Ë
°©s
->
quÆ
.
Àvñ
) -

55 ((
°©s
->
quÆ
.
upd©ed
 & 
IW_QUAL_DBM
) ? 0x100 : 0),

56 
°©s
->
quÆ
.
upd©ed
 & 
IW_QUAL_LEVEL_UPDATED


58 ((
__s32
Ë
°©s
->
quÆ
.
noi£
) -

59 ((
°©s
->
quÆ
.
upd©ed
 & 
IW_QUAL_DBM
) ? 0x100 : 0),

60 
°©s
->
quÆ
.
upd©ed
 & 
IW_QUAL_NOISE_UPDATED


62 
°©s
->
disˇrd
.
nwid
, sèts->disˇrd.
code
,

63 
°©s
->
disˇrd
.
‰agmít
, sèts->disˇrd.
ªåõs
,

64 
°©s
->
disˇrd
.
misc
, sèts->
miss
.
bóc⁄
);

66 i‡(
°©s
 !&
nuŒ°©s
)

67 
°©s
->
quÆ
.
upd©ed
 &~
IW_QUAL_ALL_UPDATED
;

69 
	}
}

75 
	$wúñess_dev_£q_show
(
£q_fûe
 *
£q
, *
v
)

77 
	`might_¶ìp
();

79 i‡(
v
 =
SEQ_START_TOKEN
)

80 
	`£q_¥ötf
(
£q
, "Inter-| sta-| Quality | Discarded "

84 
WIRELESS_EXT
);

86 
	`wúñess_£q_¥ötf_°©s
(
£q
, 
v
);

88 
	}
}

90 *
	$wúñess_dev_£q_°¨t
(
£q_fûe
 *
£q
, 
loff_t
 *
pos
)

92 
√t
 *√à
	`£q_fûe_√t
(
£q
);

93 
loff_t
 
off
;

94 
√t_devi˚
 *
dev
;

96 
	`π∆_lock
();

97 i‡(!*
pos
)

98  
SEQ_START_TOKEN
;

100 
off
 = 1;

101 
	`f‹_óch_√tdev
(
√t
, 
dev
)

102 i‡(
off
++ =*
pos
)

103  
dev
;

104  
NULL
;

105 
	}
}

107 *
	$wúñess_dev_£q_√xt
(
£q_fûe
 *
£q
, *
v
, 
loff_t
 *
pos
)

109 
√t
 *√à
	`£q_fûe_√t
(
£q
);

111 ++*
pos
;

113  
v
 =
SEQ_START_TOKEN
 ?

114 
	`fú°_√t_devi˚
(
√t
Ë: 
	`√xt_√t_devi˚
(
v
);

115 
	}
}

117 
	$wúñess_dev_£q_°›
(
£q_fûe
 *
£q
, *
v
)

119 
	`π∆_u∆ock
();

120 
	}
}

122 c⁄° 
£q_›î©i⁄s
 
	gwúñess_£q_›s
 = {

123 .
°¨t
 = 
wúñess_dev_£q_°¨t
,

124 .
	g√xt
 = 
wúñess_dev_£q_√xt
,

125 .
	g°›
 = 
wúñess_dev_£q_°›
,

126 .
	gshow
 = 
wúñess_dev_£q_show
,

129 
__√t_öô
 
	$wext_¥oc_öô
(
√t
 *net)

132 i‡(!
	`¥oc_¸óã_√t
("wúñess", 0444, 
√t
->
¥oc_√t
,

133 &
wúñess_£q_›s
, (
£q_√t_¥iv©e
)))

134  -
ENOMEM
;

137 
	}
}

139 
__√t_exô
 
	$wext_¥oc_exô
(
√t
 *net)

141 
	`ªmove_¥oc_íåy
("wúñess", 
√t
->
¥oc_√t
);

142 
	}
}

	@wext-sme.c

9 
	~<löux/exp‹t.h
>

10 
	~<löux/ëhîdevi˚.h
>

11 
	~<löux/if_¨p.h
>

12 
	~<löux/¶ab.h
>

13 
	~<√t/cfg80211.h
>

14 
	~<√t/cfg80211-wext.h
>

15 
	~"wext-com∑t.h
"

16 
	~"∆80211.h
"

18 
	$cfg80211_mgd_wext_c⁄√˘
(
cfg80211_ªgi°îed_devi˚
 *
rdev
,

19 
wúñess_dev
 *
wdev
)

21 
cfg80211_ˇched_keys
 *
ck
 = 
NULL
;

22 c⁄° 
u8
 *
¥ev_bssid
 = 
NULL
;

23 
îr
, 
i
;

25 
	`ASSERT_RTNL
();

26 
	`lockdï_as£π_wùhy
(
wdev
->
wùhy
);

28 i‡(!
	`√tif_ru¬ög
(
wdev
->
√tdev
))

31 
wdev
->
wext
.
c⁄√˘
.
õ
 = wdev->wext.ie;

32 
wdev
->
wext
.
c⁄√˘
.
õ_Àn
 = wdev->wext.ie_len;

35 
wdev
->
wext
.
c⁄√˘
.
bg_sˇn_≥riod
 = -1;

37 i‡(
wdev
->
wext
.
keys
) {

38 
wdev
->
wext
.
keys
->
def
 = wdev->wext.
deÁu…_key
;

39 i‡(
wdev
->
wext
.
deÁu…_key
 != -1)

40 
wdev
->
wext
.
c⁄√˘
.
¥ivacy
 = 
åue
;

43 i‡(!
wdev
->
wext
.
c⁄√˘
.
ssid_Àn
)

46 i‡(
wdev
->
wext
.
keys
 && wdev->wext.keys->
def
 != -1) {

47 
ck
 = 
	`kmemdup
(
wdev
->
wext
.
keys
, (*ck), 
GFP_KERNEL
);

48 i‡(!
ck
)

49  -
ENOMEM
;

50 
i
 = 0; i < 4; i++)

51 
ck
->
∑øms
[
i
].
key
 = ck->
d©a
[i];

54 i‡(
wdev
->
wext
.
¥ev_bssid_vÆid
)

55 
¥ev_bssid
 = 
wdev
->
wext
.prev_bssid;

57 
îr
 = 
	`cfg80211_c⁄√˘
(
rdev
, 
wdev
->
√tdev
,

58 &
wdev
->
wext
.
c⁄√˘
, 
ck
, 
¥ev_bssid
);

59 i‡(
îr
)

60 
	`k‰ì_£nsôive
(
ck
);

62  
îr
;

63 
	}
}

65 
	$cfg80211_mgd_wext_siw‰eq
(
√t_devi˚
 *
dev
,

66 
iw_ªque°_öfo
 *
öfo
,

67 
iw_‰eq
 *
wext‰eq
, *
exåa
)

69 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

70 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

71 
õì80211_ch™√l
 *
ch™
 = 
NULL
;

72 
îr
, 
‰eq
;

75 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
))

76  -
EINVAL
;

78 
‰eq
 = 
	`cfg80211_wext_‰eq
(
wext‰eq
);

79 i‡(
‰eq
 < 0)

80  
‰eq
;

82 i‡(
‰eq
) {

83 
ch™
 = 
	`õì80211_gë_ch™√l
(
wdev
->
wùhy
, 
‰eq
);

84 i‡(!
ch™
)

85  -
EINVAL
;

86 i‡(
ch™
->
Êags
 & 
IEEE80211_CHAN_DISABLED
)

87  -
EINVAL
;

90 i‡(
wdev
->
c⁄n
) {

91 
boﬁ
 
evít
 = 
åue
;

93 i‡(
wdev
->
wext
.
c⁄√˘
.
ch™√l
 =
ch™
)

97 i‡(
wdev
->
wext
.
c⁄√˘
.
ssid_Àn
)

98 
evít
 = 
Ál£
;

99 
îr
 = 
	`cfg80211_disc⁄√˘
(
rdev
, 
dev
,

100 
WLAN_REASON_DEAUTH_LEAVING
, 
evít
);

101 i‡(
îr
)

102  
îr
;

105 
wdev
->
wext
.
c⁄√˘
.
ch™√l
 = 
ch™
;

106  
	`cfg80211_mgd_wext_c⁄√˘
(
rdev
, 
wdev
);

107 
	}
}

109 
	$cfg80211_mgd_wext_giw‰eq
(
√t_devi˚
 *
dev
,

110 
iw_ªque°_öfo
 *
öfo
,

111 
iw_‰eq
 *
‰eq
, *
exåa
)

113 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

114 
õì80211_ch™√l
 *
ch™
 = 
NULL
;

117 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
))

118  -
EINVAL
;

120 i‡(
wdev
->
vÆid_löks
)

121  -
EOPNOTSUPP
;

123 i‡(
wdev
->
löks
[0].
˛õ¡
.
cuºít_bss
)

124 
ch™
 = 
wdev
->
löks
[0].
˛õ¡
.
cuºít_bss
->
pub
.
ch™√l
;

125 i‡(
wdev
->
wext
.
c⁄√˘
.
ch™√l
)

126 
ch™
 = 
wdev
->
wext
.
c⁄√˘
.
ch™√l
;

128 i‡(
ch™
) {

129 
‰eq
->
m
 = 
ch™
->
˚¡î_‰eq
;

130 
‰eq
->
e
 = 6;

135  -
EINVAL
;

136 
	}
}

138 
	$cfg80211_mgd_wext_siwessid
(
√t_devi˚
 *
dev
,

139 
iw_ªque°_öfo
 *
öfo
,

140 
iw_poöt
 *
d©a
, *
ssid
)

142 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

143 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

144 
size_t
 
Àn
 = 
d©a
->
Àngth
;

145 
îr
;

148 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
))

149  -
EINVAL
;

151 i‡(!
d©a
->
Êags
)

152 
Àn
 = 0;

155 i‡(
Àn
 > 0 && 
ssid
[len - 1] == '\0')

156 
Àn
--;

158 i‡(
wdev
->
c⁄n
) {

159 
boﬁ
 
evít
 = 
åue
;

161 i‡(
wdev
->
wext
.
c⁄√˘
.
ssid
 && 
Àn
 &&

162 
Àn
 =
wdev
->
wext
.
c⁄√˘
.
ssid_Àn
 &&

163 
	`memcmp
(
wdev
->
wext
.
c⁄√˘
.
ssid
, ssid, 
Àn
) == 0)

167 i‡(
Àn
)

168 
evít
 = 
Ál£
;

169 
îr
 = 
	`cfg80211_disc⁄√˘
(
rdev
, 
dev
,

170 
WLAN_REASON_DEAUTH_LEAVING
, 
evít
);

171 i‡(
îr
)

172  
îr
;

175 
wdev
->
wext
.
¥ev_bssid_vÆid
 = 
Ál£
;

176 
wdev
->
wext
.
c⁄√˘
.
ssid
 = wdev->wext.ssid;

177 
	`mem˝y
(
wdev
->
wext
.
ssid
, ssid, 
Àn
);

178 
wdev
->
wext
.
c⁄√˘
.
ssid_Àn
 = 
Àn
;

180 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
c⁄åﬁ_p‹t
 = 
Ál£
;

181 
wdev
->
wext
.
c⁄√˘
.
¸y±o
.
c⁄åﬁ_p‹t_ëhîty≥
 =

182 
	`˝u_to_be16
(
ETH_P_PAE
);

184  
	`cfg80211_mgd_wext_c⁄√˘
(
rdev
, 
wdev
);

185 
	}
}

187 
	$cfg80211_mgd_wext_giwessid
(
√t_devi˚
 *
dev
,

188 
iw_ªque°_öfo
 *
öfo
,

189 
iw_poöt
 *
d©a
, *
ssid
)

191 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

192 
ªt
 = 0;

195 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
))

196  -
EINVAL
;

198 i‡(
wdev
->
vÆid_löks
)

199  -
EINVAL
;

201 
d©a
->
Êags
 = 0;

203 i‡(
wdev
->
löks
[0].
˛õ¡
.
cuºít_bss
) {

204 c⁄° 
ñemít
 *
ssid_ñem
;

206 
	`rcu_ªad_lock
();

207 
ssid_ñem
 = 
	`õì80211_bss_gë_ñem
(

208 &
wdev
->
löks
[0].
˛õ¡
.
cuºít_bss
->
pub
,

209 
WLAN_EID_SSID
);

210 i‡(
ssid_ñem
) {

211 
d©a
->
Êags
 = 1;

212 
d©a
->
Àngth
 = 
ssid_ñem
->
d©Æí
;

213 i‡(
d©a
->
Àngth
 > 
IW_ESSID_MAX_SIZE
)

214 
ªt
 = -
EINVAL
;

216 
	`mem˝y
(
ssid
, 
ssid_ñem
->
d©a
, d©a->
Àngth
);

218 
	`rcu_ªad_u∆ock
();

219 } i‡(
wdev
->
wext
.
c⁄√˘
.
ssid
 && wdev->wext.c⁄√˘.
ssid_Àn
) {

220 
d©a
->
Êags
 = 1;

221 
d©a
->
Àngth
 = 
wdev
->
wext
.
c⁄√˘
.
ssid_Àn
;

222 
	`mem˝y
(
ssid
, 
wdev
->
wext
.
c⁄√˘
.ssid, 
d©a
->
Àngth
);

225  
ªt
;

226 
	}
}

228 
	$cfg80211_mgd_wext_siw≠
(
√t_devi˚
 *
dev
,

229 
iw_ªque°_öfo
 *
öfo
,

230 
sockaddr
 *
≠_addr
, *
exåa
)

232 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

233 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

234 
u8
 *
bssid
 = 
≠_addr
->
ß_d©a
;

235 
îr
;

238 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
))

239  -
EINVAL
;

241 i‡(
≠_addr
->
ß_Ámûy
 !
ARPHRD_ETHER
)

242  -
EINVAL
;

245 i‡(
	`is_zîo_ëhî_addr
(
bssid
Ë|| 
	`is_brﬂdˇ°_ëhî_addr
(bssid))

246 
bssid
 = 
NULL
;

248 i‡(
wdev
->
c⁄n
) {

250 i‡(!
bssid
 && !
wdev
->
wext
.
c⁄√˘
.bssid)

254 i‡(
wdev
->
wext
.
c⁄√˘
.
bssid
 && bssid &&

255 
	`ëhî_addr_equÆ
(
bssid
, 
wdev
->
wext
.
c⁄√˘
.bssid))

258 
îr
 = 
	`cfg80211_disc⁄√˘
(
rdev
, 
dev
,

259 
WLAN_REASON_DEAUTH_LEAVING
, 
Ál£
);

260 i‡(
îr
)

261  
îr
;

264 i‡(
bssid
) {

265 
	`mem˝y
(
wdev
->
wext
.
bssid
, bssid, 
ETH_ALEN
);

266 
wdev
->
wext
.
c⁄√˘
.
bssid
 = wdev->wext.bssid;

268 
wdev
->
wext
.
c⁄√˘
.
bssid
 = 
NULL
;

270  
	`cfg80211_mgd_wext_c⁄√˘
(
rdev
, 
wdev
);

271 
	}
}

273 
	$cfg80211_mgd_wext_giw≠
(
√t_devi˚
 *
dev
,

274 
iw_ªque°_öfo
 *
öfo
,

275 
sockaddr
 *
≠_addr
, *
exåa
)

277 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

280 i‡(
	`WARN_ON
(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
))

281  -
EINVAL
;

283 
≠_addr
->
ß_Ámûy
 = 
ARPHRD_ETHER
;

285 i‡(
wdev
->
vÆid_löks
)

286  -
EOPNOTSUPP
;

288 i‡(
wdev
->
löks
[0].
˛õ¡
.
cuºít_bss
)

289 
	`mem˝y
(
≠_addr
->
ß_d©a
,

290 
wdev
->
löks
[0].
˛õ¡
.
cuºít_bss
->
pub
.
bssid
,

291 
ETH_ALEN
);

293 
	`ëh_zîo_addr
(
≠_addr
->
ß_d©a
);

296 
	}
}

298 
	$cfg80211_wext_siwgíõ
(
√t_devi˚
 *
dev
,

299 
iw_ªque°_öfo
 *
öfo
,

300 
iwªq_d©a
 *
wrqu
, *
exåa
)

302 
iw_poöt
 *
d©a
 = &
wrqu
->data;

303 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

304 
cfg80211_ªgi°îed_devi˚
 *
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

305 
u8
 *
õ
 = 
exåa
;

306 
õ_Àn
 = 
d©a
->
Àngth
, 
îr
;

308 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
)

309  -
EOPNOTSUPP
;

311 i‡(!
õ_Àn
)

312 
õ
 = 
NULL
;

314 
	`wùhy_lock
(
wdev
->
wùhy
);

317 
îr
 = 0;

318 i‡(
wdev
->
wext
.
õ_Àn
 == ie_len &&

319 
	`memcmp
(
wdev
->
wext
.
õ
, ie, 
õ_Àn
) == 0)

320 
out
;

322 i‡(
õ_Àn
) {

323 
õ
 = 
	`kmemdup
(
exåa
, 
õ_Àn
, 
GFP_KERNEL
);

324 i‡(!
õ
) {

325 
îr
 = -
ENOMEM
;

326 
out
;

329 
õ
 = 
NULL
;

331 
	`k‰ì
(
wdev
->
wext
.
õ
);

332 
wdev
->
wext
.
õ
 = ie;

333 
wdev
->
wext
.
õ_Àn
 = ie_len;

335 i‡(
wdev
->
c⁄n
) {

336 
îr
 = 
	`cfg80211_disc⁄√˘
(
rdev
, 
dev
,

337 
WLAN_REASON_DEAUTH_LEAVING
, 
Ál£
);

338 i‡(
îr
)

339 
out
;

343 
îr
 = 0;

344 
out
:

345 
	`wùhy_u∆ock
(
wdev
->
wùhy
);

346  
îr
;

347 
	}
}

349 
	$cfg80211_wext_siwmlme
(
√t_devi˚
 *
dev
,

350 
iw_ªque°_öfo
 *
öfo
,

351 
iwªq_d©a
 *
wrqu
, *
exåa
)

353 
wúñess_dev
 *
wdev
 = 
dev
->
õì80211_±r
;

354 
iw_mlme
 *
mlme
 = (iw_mlmê*)
exåa
;

355 
cfg80211_ªgi°îed_devi˚
 *
rdev
;

356 
îr
;

358 i‡(!
wdev
)

359  -
EOPNOTSUPP
;

361 
rdev
 = 
	`wùhy_to_rdev
(
wdev
->
wùhy
);

363 i‡(
wdev
->
i·y≥
 !
NL80211_IFTYPE_STATION
)

364  -
EINVAL
;

366 i‡(
mlme
->
addr
.
ß_Ámûy
 !
ARPHRD_ETHER
)

367  -
EINVAL
;

369 
	`wùhy_lock
(&
rdev
->
wùhy
);

370 
mlme
->
cmd
) {

371 
IW_MLME_DEAUTH
:

372 
IW_MLME_DISASSOC
:

373 
îr
 = 
	`cfg80211_disc⁄√˘
(
rdev
, 
dev
, 
mlme
->
ªas⁄_code
, 
åue
);

376 
îr
 = -
EOPNOTSUPP
;

379 
	`wùhy_u∆ock
(&
rdev
->
wùhy
);

381  
îr
;

382 
	}
}

	@wext-spy.c

10 
	~<löux/wúñess.h
>

11 
	~<löux/√tdevi˚.h
>

12 
	~<löux/ëhîdevi˚.h
>

13 
	~<löux/exp‹t.h
>

14 
	~<√t/iw_h™dÀr.h
>

15 
	~<√t/¨p.h
>

16 
	~<√t/wext.h
>

18 
ölöe
 
iw_•y_d©a
 *
	$gë_•yd©a
(
√t_devi˚
 *
dev
)

21 i‡(
dev
->
wúñess_d©a
)

22  
dev
->
wúñess_d©a
->
•y_d©a
;

23  
NULL
;

24 
	}
}

26 
	$iw_h™dÀr_£t_•y
(
√t_devi˚
 * 
dev
,

27 
iw_ªque°_öfo
 * 
öfo
,

28 
iwªq_d©a
 * 
wrqu
,

29 * 
exåa
)

31 
iw_•y_d©a
 * 
•yd©a
 = 
	`gë_•yd©a
(
dev
);

32 
sockaddr
 * 
addªss
 = (sockadd∏*Ë
exåa
;

35 i‡(!
•yd©a
)

36  -
EOPNOTSUPP
;

41 
•yd©a
->
•y_numbî
 = 0;

49 
	`smp_wmb
();

52 i‡(
wrqu
->
d©a
.
Àngth
 > 0) {

53 
i
;

56 
i
 = 0; i < 
wrqu
->
d©a
.
Àngth
; i++)

57 
	`mem˝y
(
•yd©a
->
•y_addªss
[
i
], 
addªss
[i].
ß_d©a
,

58 
ETH_ALEN
);

60 
	`mem£t
(
•yd©a
->
•y_°©
, 0,

61 (
iw_quÆôy
Ë* 
IW_MAX_SPY
);

65 
	`smp_wmb
();

68 
•yd©a
->
•y_numbî
 = 
wrqu
->
d©a
.
Àngth
;

71 
	}
}

72 
EXPORT_SYMBOL
(
iw_h™dÀr_£t_•y
);

74 
	$iw_h™dÀr_gë_•y
(
√t_devi˚
 * 
dev
,

75 
iw_ªque°_öfo
 * 
öfo
,

76 
iwªq_d©a
 * 
wrqu
,

77 * 
exåa
)

79 
iw_•y_d©a
 * 
•yd©a
 = 
	`gë_•yd©a
(
dev
);

80 
sockaddr
 * 
addªss
 = (sockadd∏*Ë
exåa
;

81 
i
;

84 i‡(!
•yd©a
)

85  -
EOPNOTSUPP
;

87 
wrqu
->
d©a
.
Àngth
 = 
•yd©a
->
•y_numbî
;

90 
i
 = 0; i < 
•yd©a
->
•y_numbî
; i++) {

91 
	`mem˝y
(
addªss
[
i
].
ß_d©a
, 
•yd©a
->
•y_addªss
[i], 
ETH_ALEN
);

92 
addªss
[
i
].
ß_Ámûy
 = 
AF_UNIX
;

95 i‡(
•yd©a
->
•y_numbî
 > 0)

96 
	`mem˝y
(
exåa
 + ((
sockaddr
Ë*
•yd©a
->
•y_numbî
),

97 
•yd©a
->
•y_°©
,

98 (
iw_quÆôy
Ë* 
•yd©a
->
•y_numbî
);

100 
i
 = 0; i < 
•yd©a
->
•y_numbî
; i++)

101 
•yd©a
->
•y_°©
[
i
].
upd©ed
 &~
IW_QUAL_ALL_UPDATED
;

103 
	}
}

104 
EXPORT_SYMBOL
(
iw_h™dÀr_gë_•y
);

110 
	$iw_h™dÀr_£t_thr•y
(
√t_devi˚
 * 
dev
,

111 
iw_ªque°_öfo
 *
öfo
,

112 
iwªq_d©a
 * 
wrqu
,

113 * 
exåa
)

115 
iw_•y_d©a
 * 
•yd©a
 = 
	`gë_•yd©a
(
dev
);

116 
iw_thr•y
 * 
thªshﬁd
 = (iw_thr•y *Ë
exåa
;

119 i‡(!
•yd©a
)

120  -
EOPNOTSUPP
;

123 
•yd©a
->
•y_thr_low
 = 
thªshﬁd
->
low
;

124 
•yd©a
->
•y_thr_high
 = 
thªshﬁd
->
high
;

127 
	`mem£t
(
•yd©a
->
•y_thr_undî
, '\0', (spydata->spy_thr_under));

130 
	}
}

131 
EXPORT_SYMBOL
(
iw_h™dÀr_£t_thr•y
);

137 
	$iw_h™dÀr_gë_thr•y
(
√t_devi˚
 * 
dev
,

138 
iw_ªque°_öfo
 *
öfo
,

139 
iwªq_d©a
 * 
wrqu
,

140 * 
exåa
)

142 
iw_•y_d©a
 * 
•yd©a
 = 
	`gë_•yd©a
(
dev
);

143 
iw_thr•y
 * 
thªshﬁd
 = (iw_thr•y *Ë
exåa
;

146 i‡(!
•yd©a
)

147  -
EOPNOTSUPP
;

150 
thªshﬁd
->
low
 = 
•yd©a
->
•y_thr_low
;

151 
thªshﬁd
->
high
 = 
•yd©a
->
•y_thr_high
;

154 
	}
}

155 
EXPORT_SYMBOL
(
iw_h™dÀr_gë_thr•y
);

161 
	$iw_£nd_thr•y_evít
(
√t_devi˚
 * 
dev
,

162 
iw_•y_d©a
 * 
•yd©a
,

163 * 
addªss
,

164 
iw_quÆôy
 * 
w°©s
)

166 
iwªq_d©a
 
wrqu
;

167 
iw_thr•y
 
thªshﬁd
;

170 
wrqu
.
d©a
.
Àngth
 = 1;

171 
wrqu
.
d©a
.
Êags
 = 0;

173 
	`mem˝y
(
thªshﬁd
.
addr
.
ß_d©a
, 
addªss
, 
ETH_ALEN
);

174 
thªshﬁd
.
addr
.
ß_Ámûy
 = 
ARPHRD_ETHER
;

176 
thªshﬁd
.
quÆ
 = *
w°©s
;

178 
thªshﬁd
.
low
 = 
•yd©a
->
•y_thr_low
;

179 
thªshﬁd
.
high
 = 
•yd©a
->
•y_thr_high
;

182 
	`wúñess_£nd_evít
(
dev
, 
SIOCGIWTHRSPY
, &
wrqu
, (*Ë&
thªshﬁd
);

183 
	}
}

192 
	$wúñess_•y_upd©e
(
√t_devi˚
 * 
dev
,

193 * 
addªss
,

194 
iw_quÆôy
 * 
w°©s
)

196 
iw_•y_d©a
 * 
•yd©a
 = 
	`gë_•yd©a
(
dev
);

197 
i
;

198 
m©ch
 = -1;

201 i‡(!
•yd©a
)

205 
i
 = 0; i < 
•yd©a
->
•y_numbî
; i++)

206 i‡(
	`ëhî_addr_equÆ
(
addªss
, 
•yd©a
->
•y_addªss
[
i
])) {

207 
	`mem˝y
(&(
•yd©a
->
•y_°©
[
i
]), 
w°©s
,

208 (
iw_quÆôy
));

209 
m©ch
 = 
i
;

216 i‡(
m©ch
 >= 0) {

217 i‡(
•yd©a
->
•y_thr_undî
[
m©ch
]) {

218 i‡(
w°©s
->
Àvñ
 > 
•yd©a
->
•y_thr_high
.level) {

219 
•yd©a
->
•y_thr_undî
[
m©ch
] = 0;

220 
	`iw_£nd_thr•y_evít
(
dev
, 
•yd©a
,

221 
addªss
, 
w°©s
);

224 i‡(
w°©s
->
Àvñ
 < 
•yd©a
->
•y_thr_low
.level) {

225 
•yd©a
->
•y_thr_undî
[
m©ch
] = 1;

226 
	`iw_£nd_thr•y_evít
(
dev
, 
•yd©a
,

227 
addªss
, 
w°©s
);

231 
	}
}

232 
EXPORT_SYMBOL
(
wúñess_•y_upd©e
);

	@/usr/include/linux/errno.h

1 
	~<asm/î∫o.h
>

	@/usr/include/linux/if.h

20 #i‚de‡
_LINUX_IF_H


21 
	#_LINUX_IF_H


	)

23 
	~<löux/libc-com∑t.h
>

24 
	~<löux/ty≥s.h
>

25 
	~<löux/sockë.h
>

28 
	~<sys/sockë.h
>

30 #i‡
__UAPI_DEF_IF_IFNAMSIZ


31 
	#IFNAMSIZ
 16

	)

33 
	#IFALIASZ
 256

	)

34 
	#ALTIFNAMSIZ
 128

	)

35 
	~<löux/hdlc/io˘l.h
>

38 #i‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 != 0 || \

39 
	g__UAPI_DEF_IF_NET_DEVICE_FLAGS
 != 0

80 
	e√t_devi˚_Êags
 {

82 #i‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS


83 
IFF_UP
 = 1<<0,

84 
	mIFF_BROADCAST
 = 1<<1,

85 
	mIFF_DEBUG
 = 1<<2,

86 
	mIFF_LOOPBACK
 = 1<<3,

87 
	mIFF_POINTOPOINT
 = 1<<4,

88 
	mIFF_NOTRAILERS
 = 1<<5,

89 
	mIFF_RUNNING
 = 1<<6,

90 
	mIFF_NOARP
 = 1<<7,

91 
	mIFF_PROMISC
 = 1<<8,

92 
	mIFF_ALLMULTI
 = 1<<9,

93 
	mIFF_MASTER
 = 1<<10,

94 
	mIFF_SLAVE
 = 1<<11,

95 
	mIFF_MULTICAST
 = 1<<12,

96 
	mIFF_PORTSEL
 = 1<<13,

97 
	mIFF_AUTOMEDIA
 = 1<<14,

98 
	mIFF_DYNAMIC
 = 1<<15,

100 #i‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


101 
	mIFF_LOWER_UP
 = 1<<16,

102 
	mIFF_DORMANT
 = 1<<17,

103 
	mIFF_ECHO
 = 1<<18,

109 #i‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS


110 
	#IFF_UP
 
IFF_UP


	)

111 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

112 
	#IFF_DEBUG
 
IFF_DEBUG


	)

113 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

114 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

115 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

116 
	#IFF_RUNNING
 
IFF_RUNNING


	)

117 
	#IFF_NOARP
 
IFF_NOARP


	)

118 
	#IFF_PROMISC
 
IFF_PROMISC


	)

119 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

120 
	#IFF_MASTER
 
IFF_MASTER


	)

121 
	#IFF_SLAVE
 
IFF_SLAVE


	)

122 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

123 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

124 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

125 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

128 #i‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


129 
	#IFF_LOWER_UP
 
IFF_LOWER_UP


	)

130 
	#IFF_DORMANT
 
IFF_DORMANT


	)

131 
	#IFF_ECHO
 
IFF_ECHO


	)

134 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

135 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

137 
	#IF_GET_IFACE
 0x0001

	)

138 
	#IF_GET_PROTO
 0x0002

	)

141 
	#IF_IFACE_V35
 0x1000

	)

142 
	#IF_IFACE_V24
 0x1001

	)

143 
	#IF_IFACE_X21
 0x1002

	)

144 
	#IF_IFACE_T1
 0x1003

	)

145 
	#IF_IFACE_E1
 0x1004

	)

146 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

147 
	#IF_IFACE_X21D
 0x1006

	)

150 
	#IF_PROTO_HDLC
 0x2000

	)

151 
	#IF_PROTO_PPP
 0x2001

	)

152 
	#IF_PROTO_CISCO
 0x2002

	)

153 
	#IF_PROTO_FR
 0x2003

	)

154 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

155 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

156 
	#IF_PROTO_X25
 0x2006

	)

157 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

158 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

159 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

160 
	#IF_PROTO_FR_PVC
 0x200A

	)

161 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

162 
	#IF_PROTO_RAW
 0x200C

	)

166 
	mIF_OPER_UNKNOWN
,

167 
	mIF_OPER_NOTPRESENT
,

168 
	mIF_OPER_DOWN
,

169 
	mIF_OPER_LOWERLAYERDOWN
,

170 
	mIF_OPER_TESTING
,

171 
	mIF_OPER_DORMANT
,

172 
	mIF_OPER_UP
,

177 
	mIF_LINK_MODE_DEFAULT
,

178 
	mIF_LINK_MODE_DORMANT
,

179 
	mIF_LINK_MODE_TESTING
,

193 #i‡
__UAPI_DEF_IF_IFMAP


194 
	sifm≠
 {

195 
	mmem_°¨t
;

196 
	mmem_íd
;

197 
	mba£_addr
;

198 
	múq
;

199 
	mdma
;

200 
	mp‹t
;

205 
	sif_£âögs
 {

206 
	mty≥
;

207 
	msize
;

210 
øw_hdlc_¥Ÿo
 *
	møw_hdlc
;

211 
cisco_¥Ÿo
 *
	mcisco
;

212 
‰_¥Ÿo
 *
	m‰
;

213 
‰_¥Ÿo_pvc
 *
	m‰_pvc
;

214 
‰_¥Ÿo_pvc_öfo
 *
	m‰_pvc_öfo
;

215 
x25_hdlc_¥Ÿo
 *
	mx25
;

218 
sync_£rül_£âögs
 *
	msync
;

219 
ã1_£âögs
 *
	mã1
;

220 } 
	mifs_ifsu
;

231 #i‡
__UAPI_DEF_IF_IFREQ


232 
	si‰eq
 {

233 
	#IFHWADDRLEN
 6

	)

236 
	mi‰n_«me
[
IFNAMSIZ
];

237 } 
	mi‰_i‰n
;

240 
sockaddr
 
	mi‰u_addr
;

241 
sockaddr
 
	mi‰u_d°addr
;

242 
sockaddr
 
	mi‰u_brﬂdaddr
;

243 
sockaddr
 
	mi‰u_√tmask
;

244 
sockaddr
 
	mi‰u_hwaddr
;

245 
	mi‰u_Êags
;

246 
	mi‰u_ivÆue
;

247 
	mi‰u_mtu
;

248 
ifm≠
 
	mi‰u_m≠
;

249 
	mi‰u_¶ave
[
IFNAMSIZ
];

250 
	mi‰u_√w«me
[
IFNAMSIZ
];

251 * 
	mi‰u_d©a
;

252 
if_£âögs
 
	mi‰u_£âögs
;

253 } 
	mi‰_i‰u
;

257 
	#i‰_«me
 
i‰_i‰n
.
i‰n_«me


	)

258 
	#i‰_hwaddr
 
i‰_i‰u
.
i‰u_hwaddr


	)

259 
	#i‰_addr
 
i‰_i‰u
.
i‰u_addr


	)

260 
	#i‰_d°addr
 
i‰_i‰u
.
i‰u_d°addr


	)

261 
	#i‰_brﬂdaddr
 
i‰_i‰u
.
i‰u_brﬂdaddr


	)

262 
	#i‰_√tmask
 
i‰_i‰u
.
i‰u_√tmask


	)

263 
	#i‰_Êags
 
i‰_i‰u
.
i‰u_Êags


	)

264 
	#i‰_mëric
 
i‰_i‰u
.
i‰u_ivÆue


	)

265 
	#i‰_mtu
 
i‰_i‰u
.
i‰u_mtu


	)

266 
	#i‰_m≠
 
i‰_i‰u
.
i‰u_m≠


	)

267 
	#i‰_¶ave
 
i‰_i‰u
.
i‰u_¶ave


	)

268 
	#i‰_d©a
 
i‰_i‰u
.
i‰u_d©a


	)

269 
	#i‰_ifödex
 
i‰_i‰u
.
i‰u_ivÆue


	)

270 
	#i‰_b™dwidth
 
i‰_i‰u
.
i‰u_ivÆue


	)

271 
	#i‰_qÀn
 
i‰_i‰u
.
i‰u_ivÆue


	)

272 
	#i‰_√w«me
 
i‰_i‰u
.
i‰u_√w«me


	)

273 
	#i‰_£âögs
 
i‰_i‰u
.
i‰u_£âögs


	)

283 #i‡
__UAPI_DEF_IF_IFCONF


284 
	sifc⁄f
 {

285 
	mifc_Àn
;

287 *
	mifcu_buf
;

288 
i‰eq
 *
	mifcu_ªq
;

289 } 
	mifc_ifcu
;

293 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

294 
	#ifc_ªq
 
ifc_ifcu
.
ifcu_ªq


	)

	@/usr/include/linux/if_arp.h

24 #i‚de‡
_LINUX_IF_ARP_H


25 
	#_LINUX_IF_ARP_H


	)

27 
	~<löux/√tdevi˚.h
>

30 
	#ARPHRD_NETROM
 0

	)

31 
	#ARPHRD_ETHER
 1

	)

32 
	#ARPHRD_EETHER
 2

	)

33 
	#ARPHRD_AX25
 3

	)

34 
	#ARPHRD_PRONET
 4

	)

35 
	#ARPHRD_CHAOS
 5

	)

36 
	#ARPHRD_IEEE802
 6

	)

37 
	#ARPHRD_ARCNET
 7

	)

38 
	#ARPHRD_APPLETLK
 8

	)

39 
	#ARPHRD_DLCI
 15

	)

40 
	#ARPHRD_ATM
 19

	)

41 
	#ARPHRD_METRICOM
 23

	)

42 
	#ARPHRD_IEEE1394
 24

	)

43 
	#ARPHRD_EUI64
 27

	)

44 
	#ARPHRD_INFINIBAND
 32

	)

47 
	#ARPHRD_SLIP
 256

	)

48 
	#ARPHRD_CSLIP
 257

	)

49 
	#ARPHRD_SLIP6
 258

	)

50 
	#ARPHRD_CSLIP6
 259

	)

51 
	#ARPHRD_RSRVD
 260

	)

52 
	#ARPHRD_ADAPT
 264

	)

53 
	#ARPHRD_ROSE
 270

	)

54 
	#ARPHRD_X25
 271

	)

55 
	#ARPHRD_HWX25
 272

	)

56 
	#ARPHRD_CAN
 280

	)

57 
	#ARPHRD_MCTP
 290

	)

58 
	#ARPHRD_PPP
 512

	)

59 
	#ARPHRD_CISCO
 513

	)

60 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

61 
	#ARPHRD_LAPB
 516

	)

62 
	#ARPHRD_DDCMP
 517

	)

63 
	#ARPHRD_RAWHDLC
 518

	)

64 
	#ARPHRD_RAWIP
 519

	)

66 
	#ARPHRD_TUNNEL
 768

	)

67 
	#ARPHRD_TUNNEL6
 769

	)

68 
	#ARPHRD_FRAD
 770

	)

69 
	#ARPHRD_SKIP
 771

	)

70 
	#ARPHRD_LOOPBACK
 772

	)

71 
	#ARPHRD_LOCALTLK
 773

	)

72 
	#ARPHRD_FDDI
 774

	)

73 
	#ARPHRD_BIF
 775

	)

74 
	#ARPHRD_SIT
 776

	)

75 
	#ARPHRD_IPDDP
 777

	)

76 
	#ARPHRD_IPGRE
 778

	)

77 
	#ARPHRD_PIMREG
 779

	)

78 
	#ARPHRD_HIPPI
 780

	)

79 
	#ARPHRD_ASH
 781

	)

80 
	#ARPHRD_ECONET
 782

	)

81 
	#ARPHRD_IRDA
 783

	)

83 
	#ARPHRD_FCPP
 784

	)

84 
	#ARPHRD_FCAL
 785

	)

85 
	#ARPHRD_FCPL
 786

	)

86 
	#ARPHRD_FCFABRIC
 787

	)

88 
	#ARPHRD_IEEE802_TR
 800

	)

89 
	#ARPHRD_IEEE80211
 801

	)

90 
	#ARPHRD_IEEE80211_PRISM
 802

	)

91 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

92 
	#ARPHRD_IEEE802154
 804

	)

93 
	#ARPHRD_IEEE802154_MONITOR
 805

	)

95 
	#ARPHRD_PHONET
 820

	)

96 
	#ARPHRD_PHONET_PIPE
 821

	)

97 
	#ARPHRD_CAIF
 822

	)

98 
	#ARPHRD_IP6GRE
 823

	)

99 
	#ARPHRD_NETLINK
 824

	)

100 
	#ARPHRD_6LOWPAN
 825

	)

101 
	#ARPHRD_VSOCKMON
 826

	)

103 
	#ARPHRD_VOID
 0xFFFF

	)

104 
	#ARPHRD_NONE
 0xFFFE

	)

107 
	#ARPOP_REQUEST
 1

	)

108 
	#ARPOP_REPLY
 2

	)

109 
	#ARPOP_RREQUEST
 3

	)

110 
	#ARPOP_RREPLY
 4

	)

111 
	#ARPOP_InREQUEST
 8

	)

112 
	#ARPOP_InREPLY
 9

	)

113 
	#ARPOP_NAK
 10

	)

117 
	s¨¥eq
 {

118 
sockaddr
 
	m¨p_∑
;

119 
sockaddr
 
	m¨p_ha
;

120 
	m¨p_Êags
;

121 
sockaddr
 
	m¨p_√tmask
;

122 
	m¨p_dev
[
IFNAMSIZ
];

125 
	s¨¥eq_ﬁd
 {

126 
sockaddr
 
	m¨p_∑
;

127 
sockaddr
 
	m¨p_ha
;

128 
	m¨p_Êags
;

129 
sockaddr
 
	m¨p_√tmask
;

133 
	#ATF_COM
 0x02

	)

134 
	#ATF_PERM
 0x04

	)

135 
	#ATF_PUBL
 0x08

	)

136 
	#ATF_USETRAILERS
 0x10

	)

137 
	#ATF_NETMASK
 0x20

	)

139 
	#ATF_DONTPUB
 0x40

	)

145 
	s¨phdr
 {

146 
__be16
 
	m¨_hrd
;

147 
__be16
 
	m¨_¥o
;

148 
	m¨_h 
;

149 
	m¨_∂n
;

150 
__be16
 
	m¨_›
;

156 
	m¨_sha
[
ETH_ALEN
];

157 
	m¨_sù
[4];

158 
	m¨_tha
[
ETH_ALEN
];

159 
	m¨_tù
[4];

	@/usr/include/linux/if_ether.h

22 #i‚de‡
_LINUX_IF_ETHER_H


23 
	#_LINUX_IF_ETHER_H


	)

25 
	~<löux/ty≥s.h
>

32 
	#ETH_ALEN
 6

	)

33 
	#ETH_TLEN
 2

	)

34 
	#ETH_HLEN
 14

	)

35 
	#ETH_ZLEN
 60

	)

36 
	#ETH_DATA_LEN
 1500

	)

37 
	#ETH_FRAME_LEN
 1514

	)

38 
	#ETH_FCS_LEN
 4

	)

40 
	#ETH_MIN_MTU
 68

	)

41 
	#ETH_MAX_MTU
 0xFFFFU

	)

47 
	#ETH_P_LOOP
 0x0060

	)

48 
	#ETH_P_PUP
 0x0200

	)

49 
	#ETH_P_PUPAT
 0x0201

	)

50 
	#ETH_P_TSN
 0x22F0

	)

51 
	#ETH_P_ERSPAN2
 0x22EB

	)

52 
	#ETH_P_IP
 0x0800

	)

53 
	#ETH_P_X25
 0x0805

	)

54 
	#ETH_P_ARP
 0x0806

	)

55 
	#ETH_P_BPQ
 0x08FF

	)

56 
	#ETH_P_IEEEPUP
 0x0a00

	)

57 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

58 
	#ETH_P_BATMAN
 0x4305

	)

59 
	#ETH_P_DEC
 0x6000

	)

60 
	#ETH_P_DNA_DL
 0x6001

	)

61 
	#ETH_P_DNA_RC
 0x6002

	)

62 
	#ETH_P_DNA_RT
 0x6003

	)

63 
	#ETH_P_LAT
 0x6004

	)

64 
	#ETH_P_DIAG
 0x6005

	)

65 
	#ETH_P_CUST
 0x6006

	)

66 
	#ETH_P_SCA
 0x6007

	)

67 
	#ETH_P_TEB
 0x6558

	)

68 
	#ETH_P_RARP
 0x8035

	)

69 
	#ETH_P_ATALK
 0x809B

	)

70 
	#ETH_P_AARP
 0x80F3

	)

71 
	#ETH_P_8021Q
 0x8100

	)

72 
	#ETH_P_ERSPAN
 0x88BE

	)

73 
	#ETH_P_IPX
 0x8137

	)

74 
	#ETH_P_IPV6
 0x86DD

	)

75 
	#ETH_P_PAUSE
 0x8808

	)

76 
	#ETH_P_SLOW
 0x8809

	)

77 
	#ETH_P_WCCP
 0x883E

	)

79 
	#ETH_P_MPLS_UC
 0x8847

	)

80 
	#ETH_P_MPLS_MC
 0x8848

	)

81 
	#ETH_P_ATMMPOA
 0x884¯

	)

82 
	#ETH_P_PPP_DISC
 0x8863

	)

83 
	#ETH_P_PPP_SES
 0x8864

	)

84 
	#ETH_P_LINK_CTL
 0x886¯

	)

85 
	#ETH_P_ATMFATE
 0x8884

	)

88 
	#ETH_P_PAE
 0x888E

	)

89 
	#ETH_P_AOE
 0x88A2

	)

90 
	#ETH_P_8021AD
 0x88A8

	)

91 
	#ETH_P_802_EX1
 0x88B5

	)

92 
	#ETH_P_PREAUTH
 0x88C7

	)

93 
	#ETH_P_TIPC
 0x88CA

	)

94 
	#ETH_P_LLDP
 0x88CC

	)

95 
	#ETH_P_MRP
 0x88E3

	)

96 
	#ETH_P_MACSEC
 0x88E5

	)

97 
	#ETH_P_8021AH
 0x88E7

	)

98 
	#ETH_P_MVRP
 0x88F5

	)

99 
	#ETH_P_1588
 0x88F7

	)

100 
	#ETH_P_NCSI
 0x88F8

	)

101 
	#ETH_P_PRP
 0x88FB

	)

102 
	#ETH_P_CFM
 0x8902

	)

103 
	#ETH_P_FCOE
 0x8906

	)

104 
	#ETH_P_IBOE
 0x8915

	)

105 
	#ETH_P_TDLS
 0x890D

	)

106 
	#ETH_P_FIP
 0x8914

	)

107 
	#ETH_P_80221
 0x8917

	)

108 
	#ETH_P_HSR
 0x892F

	)

109 
	#ETH_P_NSH
 0x894F

	)

110 
	#ETH_P_LOOPBACK
 0x9000

	)

111 
	#ETH_P_QINQ1
 0x9100

	)

112 
	#ETH_P_QINQ2
 0x9200

	)

113 
	#ETH_P_QINQ3
 0x9300

	)

114 
	#ETH_P_EDSA
 0xDADA

	)

115 
	#ETH_P_DSA_8021Q
 0xDADB

	)

116 
	#ETH_P_IFE
 0xED3E

	)

117 
	#ETH_P_AF_IUCV
 0xFBFB

	)

119 
	#ETH_P_802_3_MIN
 0x0600

	)

126 
	#ETH_P_802_3
 0x0001

	)

127 
	#ETH_P_AX25
 0x0002

	)

128 
	#ETH_P_ALL
 0x0003

	)

129 
	#ETH_P_802_2
 0x0004

	)

130 
	#ETH_P_SNAP
 0x0005

	)

131 
	#ETH_P_DDCMP
 0x0006

	)

132 
	#ETH_P_WAN_PPP
 0x0007

	)

133 
	#ETH_P_PPP_MP
 0x0008

	)

134 
	#ETH_P_LOCALTALK
 0x0009

	)

135 
	#ETH_P_CAN
 0x000C

	)

136 
	#ETH_P_CANFD
 0x000D

	)

137 
	#ETH_P_PPPTALK
 0x0010

	)

138 
	#ETH_P_TR_802_2
 0x0011

	)

139 
	#ETH_P_MOBITEX
 0x0015

	)

140 
	#ETH_P_CONTROL
 0x0016

	)

141 
	#ETH_P_IRDA
 0x0017

	)

142 
	#ETH_P_ECONET
 0x0018

	)

143 
	#ETH_P_HDLC
 0x0019

	)

144 
	#ETH_P_ARCNET
 0x001A

	)

145 
	#ETH_P_DSA
 0x001B

	)

146 
	#ETH_P_TRAILER
 0x001C

	)

147 
	#ETH_P_PHONET
 0x00F5

	)

148 
	#ETH_P_IEEE802154
 0x00F6

	)

149 
	#ETH_P_CAIF
 0x00F7

	)

150 
	#ETH_P_XDSA
 0x00F8

	)

151 
	#ETH_P_MAP
 0x00F9

	)

154 
	#ETH_P_MCTP
 0x00FA

	)

163 #i‚de‡
__UAPI_DEF_ETHHDR


164 
	#__UAPI_DEF_ETHHDR
 1

	)

167 #i‡
__UAPI_DEF_ETHHDR


168 
	sëhhdr
 {

169 
	mh_de°
[
ETH_ALEN
];

170 
	mh_sour˚
[
ETH_ALEN
];

171 
__be16
 
	mh_¥Ÿo
;

172 } 
__©åibuã__
((
∑cked
));

	@/usr/include/linux/if_vlan.h

14 #i‚de‡
_LINUX_IF_VLAN_H_


15 
	#_LINUX_IF_VLAN_H_


	)

21 
	evœn_io˘l_cmds
 {

22 
	mADD_VLAN_CMD
,

23 
	mDEL_VLAN_CMD
,

24 
	mSET_VLAN_INGRESS_PRIORITY_CMD
,

25 
	mSET_VLAN_EGRESS_PRIORITY_CMD
,

26 
	mGET_VLAN_INGRESS_PRIORITY_CMD
,

27 
	mGET_VLAN_EGRESS_PRIORITY_CMD
,

28 
	mSET_VLAN_NAME_TYPE_CMD
,

29 
	mSET_VLAN_FLAG_CMD
,

30 
	mGET_VLAN_REALDEV_NAME_CMD
,

31 
	mGET_VLAN_VID_CMD


34 
	evœn_Êags
 {

35 
	mVLAN_FLAG_REORDER_HDR
 = 0x1,

36 
	mVLAN_FLAG_GVRP
 = 0x2,

37 
	mVLAN_FLAG_LOOSE_BINDING
 = 0x4,

38 
	mVLAN_FLAG_MVRP
 = 0x8,

39 
	mVLAN_FLAG_BRIDGE_BINDING
 = 0x10,

42 
	evœn_«me_ty≥s
 {

43 
	mVLAN_NAME_TYPE_PLUS_VID
,

44 
	mVLAN_NAME_TYPE_RAW_PLUS_VID
,

45 
	mVLAN_NAME_TYPE_PLUS_VID_NO_PAD
,

46 
	mVLAN_NAME_TYPE_RAW_PLUS_VID_NO_PAD
,

47 
	mVLAN_NAME_TYPE_HIGHEST


50 
	svœn_io˘l_¨gs
 {

51 
	mcmd
;

52 
	mdevi˚1
[24];

55 
	mdevi˚2
[24];

56 
	mVID
;

57 
	mskb_¥i‹ôy
;

58 
	m«me_ty≥
;

59 
	mböd_ty≥
;

60 
	mÊag
;

61 } 
	mu
;

63 
	mvœn_qos
;

	@/usr/include/linux/kernel.h

2 #i‚de‡
_LINUX_KERNEL_H


3 
	#_LINUX_KERNEL_H


	)

5 
	~<löux/sysöfo.h
>

6 
	~<löux/c⁄°.h
>

	@/usr/include/linux/module.h

2 #i‚de‡
_LINUX_MODULE_H


3 
	#_LINUX_MODULE_H


	)

6 
	#MODULE_INIT_IGNORE_MODVERSIONS
 1

	)

7 
	#MODULE_INIT_IGNORE_VERMAGIC
 2

	)

	@/usr/include/linux/mpls.h

2 #i‚de‡
_MPLS_H


3 
	#_MPLS_H


	)

5 
	~<löux/ty≥s.h
>

6 
	~<asm/byã‹dî.h
>

22 
	sm∂s_œbñ
 {

23 
__be32
 
	míåy
;

26 
	#MPLS_LS_LABEL_MASK
 0xFFFFF000

	)

27 
	#MPLS_LS_LABEL_SHIFT
 12

	)

28 
	#MPLS_LS_TC_MASK
 0x00000E00

	)

29 
	#MPLS_LS_TC_SHIFT
 9

	)

30 
	#MPLS_LS_S_MASK
 0x00000100

	)

31 
	#MPLS_LS_S_SHIFT
 8

	)

32 
	#MPLS_LS_TTL_MASK
 0x000000FF

	)

33 
	#MPLS_LS_TTL_SHIFT
 0

	)

36 
	#MPLS_LABEL_IPV4NULL
 0

	)

37 
	#MPLS_LABEL_RTALERT
 1

	)

38 
	#MPLS_LABEL_IPV6NULL
 2

	)

39 
	#MPLS_LABEL_IMPLNULL
 3

	)

40 
	#MPLS_LABEL_ENTROPY
 7

	)

41 
	#MPLS_LABEL_GAL
 13

	)

42 
	#MPLS_LABEL_OAMALERT
 14

	)

43 
	#MPLS_LABEL_EXTENSION
 15

	)

45 
	#MPLS_LABEL_FIRST_UNRESERVED
 16

	)

58 
	mMPLS_STATS_UNSPEC
,

59 
	mMPLS_STATS_LINK
,

60 
	m__MPLS_STATS_MAX
,

63 
	#MPLS_STATS_MAX
 (
__MPLS_STATS_MAX
 - 1)

	)

65 
	sm∂s_lök_°©s
 {

66 
__u64
 
	mrx_∑ckës
;

67 
__u64
 
	mtx_∑ckës
;

68 
__u64
 
	mrx_byãs
;

69 
__u64
 
	mtx_byãs
;

70 
__u64
 
	mrx_îr‹s
;

71 
__u64
 
	mtx_îr‹s
;

72 
__u64
 
	mrx_dr›≥d
;

73 
__u64
 
	mtx_dr›≥d
;

74 
__u64
 
	mrx_n‹ouã
;

	@/usr/include/linux/netdevice.h

26 #i‚de‡
_LINUX_NETDEVICE_H


27 
	#_LINUX_NETDEVICE_H


	)

29 
	~<löux/if.h
>

30 
	~<löux/if_ëhî.h
>

31 
	~<löux/if_∑ckë.h
>

32 
	~<löux/if_lök.h
>

35 
	#MAX_ADDR_LEN
 32

	)

38 
	#INIT_NETDEV_GROUP
 0

	)

42 
	#NET_NAME_UNKNOWN
 0

	)

43 
	#NET_NAME_ENUM
 1

	)

44 
	#NET_NAME_PREDICTABLE
 2

	)

45 
	#NET_NAME_USER
 3

	)

46 
	#NET_NAME_RENAMED
 4

	)

50 
	mIF_PORT_UNKNOWN
 = 0,

51 
	mIF_PORT_10BASE2
,

52 
	mIF_PORT_10BASET
,

53 
	mIF_PORT_AUI
,

54 
	mIF_PORT_100BASET
,

55 
	mIF_PORT_100BASETX
,

56 
	mIF_PORT_100BASEFX


60 
	#NET_ADDR_PERM
 0

	)

61 
	#NET_ADDR_RANDOM
 1

	)

62 
	#NET_ADDR_STOLEN
 2

	)

63 
	#NET_ADDR_SET
 3

	)

	@/usr/include/linux/netlink.h

2 #i‚de‡
__LINUX_NETLINK_H


3 
	#__LINUX_NETLINK_H


	)

5 
	~<löux/c⁄°.h
>

6 
	~<löux/sockë.h
>

7 
	~<löux/ty≥s.h
>

9 
	#NETLINK_ROUTE
 0

	)

10 
	#NETLINK_UNUSED
 1

	)

11 
	#NETLINK_USERSOCK
 2

	)

12 
	#NETLINK_FIREWALL
 3

	)

13 
	#NETLINK_SOCK_DIAG
 4

	)

14 
	#NETLINK_NFLOG
 5

	)

15 
	#NETLINK_XFRM
 6

	)

16 
	#NETLINK_SELINUX
 7

	)

17 
	#NETLINK_ISCSI
 8

	)

18 
	#NETLINK_AUDIT
 9

	)

19 
	#NETLINK_FIB_LOOKUP
 10

	)

20 
	#NETLINK_CONNECTOR
 11

	)

21 
	#NETLINK_NETFILTER
 12

	)

22 
	#NETLINK_IP6_FW
 13

	)

23 
	#NETLINK_DNRTMSG
 14

	)

24 
	#NETLINK_KOBJECT_UEVENT
 15

	)

25 
	#NETLINK_GENERIC
 16

	)

27 
	#NETLINK_SCSITRANSPORT
 18

	)

28 
	#NETLINK_ECRYPTFS
 19

	)

29 
	#NETLINK_RDMA
 20

	)

30 
	#NETLINK_CRYPTO
 21

	)

31 
	#NETLINK_SMC
 22

	)

33 
	#NETLINK_INET_DIAG
 
NETLINK_SOCK_DIAG


	)

35 
	#MAX_LINKS
 32

	)

37 
	ssockaddr_∆
 {

38 
__kî√l_ß_Ámûy_t
 
	m∆_Ámûy
;

39 
	m∆_∑d
;

40 
__u32
 
	m∆_pid
;

41 
__u32
 
	m∆_groups
;

44 
	s∆msghdr
 {

45 
__u32
 
	m∆msg_Àn
;

46 
__u16
 
	m∆msg_ty≥
;

47 
__u16
 
	m∆msg_Êags
;

48 
__u32
 
	m∆msg_£q
;

49 
__u32
 
	m∆msg_pid
;

54 
	#NLM_F_REQUEST
 0x01

	)

55 
	#NLM_F_MULTI
 0x02

	)

56 
	#NLM_F_ACK
 0x04

	)

57 
	#NLM_F_ECHO
 0x08

	)

58 
	#NLM_F_DUMP_INTR
 0x10

	)

59 
	#NLM_F_DUMP_FILTERED
 0x20

	)

62 
	#NLM_F_ROOT
 0x100

	)

63 
	#NLM_F_MATCH
 0x200

	)

64 
	#NLM_F_ATOMIC
 0x400

	)

65 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

68 
	#NLM_F_REPLACE
 0x100

	)

69 
	#NLM_F_EXCL
 0x200

	)

70 
	#NLM_F_CREATE
 0x400

	)

71 
	#NLM_F_APPEND
 0x800

	)

74 
	#NLM_F_NONREC
 0x100

	)

77 
	#NLM_F_CAPPED
 0x100

	)

78 
	#NLM_F_ACK_TLVS
 0x200

	)

89 
	#NLMSG_ALIGNTO
 4U

	)

90 
	#NLMSG_ALIGN
(
Àn
Ë–(÷í)+
NLMSG_ALIGNTO
-1Ë& ~(NLMSG_ALIGNTO-1Ë)

	)

91 
	#NLMSG_HDRLEN
 ((Ë
	`NLMSG_ALIGN
((
∆msghdr
)))

	)

92 
	#NLMSG_LENGTH
(
Àn
Ë(÷íË+ 
NLMSG_HDRLEN
)

	)

93 
	#NLMSG_SPACE
(
Àn
Ë
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
÷í))

	)

94 
	#NLMSG_DATA
(
∆h
Ë((*)(((*ÍlhË+ 
NLMSG_HDRLEN
))

	)

95 
	#NLMSG_NEXT
(
∆h
,
Àn
Ë(÷íË-
	`NLMSG_ALIGN
(“lh)->
∆msg_Àn
), \

96 (
∆msghdr
 *)(((*)(
∆h
)) + \

97 
	`NLMSG_ALIGN
((
∆h
)->
∆msg_Àn
)))

	)

98 
	#NLMSG_OK
(
∆h
,
Àn
Ë(÷íË>()(
∆msghdr
) && \

99 (
∆h
)->
∆msg_Àn
 >(
∆msghdr
) && \

100 (
∆h
)->
∆msg_Àn
 <(
Àn
))

	)

101 
	#NLMSG_PAYLOAD
(
∆h
,
Àn
Ë(“lh)->
∆msg_Àn
 - 
	`NLMSG_SPACE
(÷í)))

	)

103 
	#NLMSG_NOOP
 0x1

	)

104 
	#NLMSG_ERROR
 0x2

	)

105 
	#NLMSG_DONE
 0x3

	)

106 
	#NLMSG_OVERRUN
 0x4

	)

108 
	#NLMSG_MIN_TYPE
 0x10

	)

110 
	s∆msgîr
 {

111 
	mîr‹
;

112 
∆msghdr
 
	mmsg
;

137 
	e∆msgîr_©ås
 {

138 
	mNLMSGERR_ATTR_UNUSED
,

139 
	mNLMSGERR_ATTR_MSG
,

140 
	mNLMSGERR_ATTR_OFFS
,

141 
	mNLMSGERR_ATTR_COOKIE
,

142 
	mNLMSGERR_ATTR_POLICY
,

144 
	m__NLMSGERR_ATTR_MAX
,

145 
	mNLMSGERR_ATTR_MAX
 = 
__NLMSGERR_ATTR_MAX
 - 1

148 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

149 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

150 
	#NETLINK_PKTINFO
 3

	)

151 
	#NETLINK_BROADCAST_ERROR
 4

	)

152 
	#NETLINK_NO_ENOBUFS
 5

	)

153 
	#NETLINK_RX_RING
 6

	)

154 
	#NETLINK_TX_RING
 7

	)

155 
	#NETLINK_LISTEN_ALL_NSID
 8

	)

156 
	#NETLINK_LIST_MEMBERSHIPS
 9

	)

157 
	#NETLINK_CAP_ACK
 10

	)

158 
	#NETLINK_EXT_ACK
 11

	)

159 
	#NETLINK_GET_STRICT_CHK
 12

	)

161 
	s∆_pktöfo
 {

162 
__u32
 
	mgroup
;

165 
	s∆_mm≠_ªq
 {

166 
	mnm_block_size
;

167 
	mnm_block_ƒ
;

168 
	mnm_‰ame_size
;

169 
	mnm_‰ame_ƒ
;

172 
	s∆_mm≠_hdr
 {

173 
	mnm_°©us
;

174 
	mnm_Àn
;

175 
__u32
 
	mnm_group
;

177 
__u32
 
	mnm_pid
;

178 
__u32
 
	mnm_uid
;

179 
__u32
 
	mnm_gid
;

182 
	e∆_mm≠_°©us
 {

183 
	mNL_MMAP_STATUS_UNUSED
,

184 
	mNL_MMAP_STATUS_RESERVED
,

185 
	mNL_MMAP_STATUS_VALID
,

186 
	mNL_MMAP_STATUS_COPY
,

187 
	mNL_MMAP_STATUS_SKIP
,

190 
	#NL_MMAP_MSG_ALIGNMENT
 
NLMSG_ALIGNTO


	)

191 
	#NL_MMAP_MSG_ALIGN
(
sz
Ë
	`__ALIGN_KERNEL
(sz, 
NL_MMAP_MSG_ALIGNMENT
)

	)

192 
	#NL_MMAP_HDRLEN
 
	`NL_MMAP_MSG_ALIGN
((
∆_mm≠_hdr
))

	)

194 
	#NET_MAJOR
 36

	)

197 
	mNETLINK_UNCONNECTED
 = 0,

198 
	mNETLINK_CONNECTED
,

210 
	s∆©å
 {

211 
__u16
 
	m∆a_Àn
;

212 
__u16
 
	m∆a_ty≥
;

225 
	#NLA_F_NESTED
 (1 << 15)

	)

226 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

227 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

229 
	#NLA_ALIGNTO
 4

	)

230 
	#NLA_ALIGN
(
Àn
Ë((÷íË+ 
NLA_ALIGNTO
 - 1Ë& ~(NLA_ALIGNTO - 1))

	)

231 
	#NLA_HDRLEN
 ((Ë
	`NLA_ALIGN
((
∆©å
)))

	)

246 
	s∆a_bôfõld32
 {

247 
__u32
 
	mvÆue
;

248 
__u32
 
	m£À˘‹
;

283 
	e√éök_©åibuã_ty≥
 {

284 
	mNL_ATTR_TYPE_INVALID
,

286 
	mNL_ATTR_TYPE_FLAG
,

288 
	mNL_ATTR_TYPE_U8
,

289 
	mNL_ATTR_TYPE_U16
,

290 
	mNL_ATTR_TYPE_U32
,

291 
	mNL_ATTR_TYPE_U64
,

293 
	mNL_ATTR_TYPE_S8
,

294 
	mNL_ATTR_TYPE_S16
,

295 
	mNL_ATTR_TYPE_S32
,

296 
	mNL_ATTR_TYPE_S64
,

298 
	mNL_ATTR_TYPE_BINARY
,

299 
	mNL_ATTR_TYPE_STRING
,

300 
	mNL_ATTR_TYPE_NUL_STRING
,

302 
	mNL_ATTR_TYPE_NESTED
,

303 
	mNL_ATTR_TYPE_NESTED_ARRAY
,

305 
	mNL_ATTR_TYPE_BITFIELD32
,

336 
	e√éök_pﬁicy_ty≥_©å
 {

337 
	mNL_POLICY_TYPE_ATTR_UNSPEC
,

338 
	mNL_POLICY_TYPE_ATTR_TYPE
,

339 
	mNL_POLICY_TYPE_ATTR_MIN_VALUE_S
,

340 
	mNL_POLICY_TYPE_ATTR_MAX_VALUE_S
,

341 
	mNL_POLICY_TYPE_ATTR_MIN_VALUE_U
,

342 
	mNL_POLICY_TYPE_ATTR_MAX_VALUE_U
,

343 
	mNL_POLICY_TYPE_ATTR_MIN_LENGTH
,

344 
	mNL_POLICY_TYPE_ATTR_MAX_LENGTH
,

345 
	mNL_POLICY_TYPE_ATTR_POLICY_IDX
,

346 
	mNL_POLICY_TYPE_ATTR_POLICY_MAXTYPE
,

347 
	mNL_POLICY_TYPE_ATTR_BITFIELD32_MASK
,

348 
	mNL_POLICY_TYPE_ATTR_PAD
,

349 
	mNL_POLICY_TYPE_ATTR_MASK
,

352 
	m__NL_POLICY_TYPE_ATTR_MAX
,

353 
	mNL_POLICY_TYPE_ATTR_MAX
 = 
__NL_POLICY_TYPE_ATTR_MAX
 - 1

	@/usr/include/linux/nl80211.h

1 #i‚de‡
__LINUX_NL80211_H


2 
	#__LINUX_NL80211_H


	)

43 
	~<löux/ty≥s.h
>

45 
	#NL80211_GENL_NAME
 "∆80211"

	)

47 
	#NL80211_MULTICAST_GROUP_CONFIG
 "c⁄fig"

	)

48 
	#NL80211_MULTICAST_GROUP_SCAN
 "sˇn"

	)

49 
	#NL80211_MULTICAST_GROUP_REG
 "ªguœt‹y"

	)

50 
	#NL80211_MULTICAST_GROUP_MLME
 "mlme"

	)

51 
	#NL80211_MULTICAST_GROUP_VENDOR
 "víd‹"

	)

52 
	#NL80211_MULTICAST_GROUP_NAN
 "«n"

	)

53 
	#NL80211_MULTICAST_GROUP_TESTMODE
 "ã°mode"

	)

55 
	#NL80211_EDMG_BW_CONFIG_MIN
 4

	)

56 
	#NL80211_EDMG_BW_CONFIG_MAX
 15

	)

57 
	#NL80211_EDMG_CHANNELS_MIN
 1

	)

58 
	#NL80211_EDMG_CHANNELS_MAX
 0x3¯

	)

1206 
	e∆80211_comm™ds
 {

1208 
	mNL80211_CMD_UNSPEC
,

1210 
	mNL80211_CMD_GET_WIPHY
,

1211 
	mNL80211_CMD_SET_WIPHY
,

1212 
	mNL80211_CMD_NEW_WIPHY
,

1213 
	mNL80211_CMD_DEL_WIPHY
,

1215 
	mNL80211_CMD_GET_INTERFACE
,

1216 
	mNL80211_CMD_SET_INTERFACE
,

1217 
	mNL80211_CMD_NEW_INTERFACE
,

1218 
	mNL80211_CMD_DEL_INTERFACE
,

1220 
	mNL80211_CMD_GET_KEY
,

1221 
	mNL80211_CMD_SET_KEY
,

1222 
	mNL80211_CMD_NEW_KEY
,

1223 
	mNL80211_CMD_DEL_KEY
,

1225 
	mNL80211_CMD_GET_BEACON
,

1226 
	mNL80211_CMD_SET_BEACON
,

1227 
	mNL80211_CMD_START_AP
,

1228 
	mNL80211_CMD_NEW_BEACON
 = 
NL80211_CMD_START_AP
,

1229 
	mNL80211_CMD_STOP_AP
,

1230 
	mNL80211_CMD_DEL_BEACON
 = 
NL80211_CMD_STOP_AP
,

1232 
	mNL80211_CMD_GET_STATION
,

1233 
	mNL80211_CMD_SET_STATION
,

1234 
	mNL80211_CMD_NEW_STATION
,

1235 
	mNL80211_CMD_DEL_STATION
,

1237 
	mNL80211_CMD_GET_MPATH
,

1238 
	mNL80211_CMD_SET_MPATH
,

1239 
	mNL80211_CMD_NEW_MPATH
,

1240 
	mNL80211_CMD_DEL_MPATH
,

1242 
	mNL80211_CMD_SET_BSS
,

1244 
	mNL80211_CMD_SET_REG
,

1245 
	mNL80211_CMD_REQ_SET_REG
,

1247 
	mNL80211_CMD_GET_MESH_CONFIG
,

1248 
	mNL80211_CMD_SET_MESH_CONFIG
,

1250 
	mNL80211_CMD_SET_MGMT_EXTRA_IE
 ,

1252 
	mNL80211_CMD_GET_REG
,

1254 
	mNL80211_CMD_GET_SCAN
,

1255 
	mNL80211_CMD_TRIGGER_SCAN
,

1256 
	mNL80211_CMD_NEW_SCAN_RESULTS
,

1257 
	mNL80211_CMD_SCAN_ABORTED
,

1259 
	mNL80211_CMD_REG_CHANGE
,

1261 
	mNL80211_CMD_AUTHENTICATE
,

1262 
	mNL80211_CMD_ASSOCIATE
,

1263 
	mNL80211_CMD_DEAUTHENTICATE
,

1264 
	mNL80211_CMD_DISASSOCIATE
,

1266 
	mNL80211_CMD_MICHAEL_MIC_FAILURE
,

1268 
	mNL80211_CMD_REG_BEACON_HINT
,

1270 
	mNL80211_CMD_JOIN_IBSS
,

1271 
	mNL80211_CMD_LEAVE_IBSS
,

1273 
	mNL80211_CMD_TESTMODE
,

1275 
	mNL80211_CMD_CONNECT
,

1276 
	mNL80211_CMD_ROAM
,

1277 
	mNL80211_CMD_DISCONNECT
,

1279 
	mNL80211_CMD_SET_WIPHY_NETNS
,

1281 
	mNL80211_CMD_GET_SURVEY
,

1282 
	mNL80211_CMD_NEW_SURVEY_RESULTS
,

1284 
	mNL80211_CMD_SET_PMKSA
,

1285 
	mNL80211_CMD_DEL_PMKSA
,

1286 
	mNL80211_CMD_FLUSH_PMKSA
,

1288 
	mNL80211_CMD_REMAIN_ON_CHANNEL
,

1289 
	mNL80211_CMD_CANCEL_REMAIN_ON_CHANNEL
,

1291 
	mNL80211_CMD_SET_TX_BITRATE_MASK
,

1293 
	mNL80211_CMD_REGISTER_FRAME
,

1294 
	mNL80211_CMD_REGISTER_ACTION
 = 
NL80211_CMD_REGISTER_FRAME
,

1295 
	mNL80211_CMD_FRAME
,

1296 
	mNL80211_CMD_ACTION
 = 
NL80211_CMD_FRAME
,

1297 
	mNL80211_CMD_FRAME_TX_STATUS
,

1298 
	mNL80211_CMD_ACTION_TX_STATUS
 = 
NL80211_CMD_FRAME_TX_STATUS
,

1300 
	mNL80211_CMD_SET_POWER_SAVE
,

1301 
	mNL80211_CMD_GET_POWER_SAVE
,

1303 
	mNL80211_CMD_SET_CQM
,

1304 
	mNL80211_CMD_NOTIFY_CQM
,

1306 
	mNL80211_CMD_SET_CHANNEL
,

1307 
	mNL80211_CMD_SET_WDS_PEER
,

1309 
	mNL80211_CMD_FRAME_WAIT_CANCEL
,

1311 
	mNL80211_CMD_JOIN_MESH
,

1312 
	mNL80211_CMD_LEAVE_MESH
,

1314 
	mNL80211_CMD_UNPROT_DEAUTHENTICATE
,

1315 
	mNL80211_CMD_UNPROT_DISASSOCIATE
,

1317 
	mNL80211_CMD_NEW_PEER_CANDIDATE
,

1319 
	mNL80211_CMD_GET_WOWLAN
,

1320 
	mNL80211_CMD_SET_WOWLAN
,

1322 
	mNL80211_CMD_START_SCHED_SCAN
,

1323 
	mNL80211_CMD_STOP_SCHED_SCAN
,

1324 
	mNL80211_CMD_SCHED_SCAN_RESULTS
,

1325 
	mNL80211_CMD_SCHED_SCAN_STOPPED
,

1327 
	mNL80211_CMD_SET_REKEY_OFFLOAD
,

1329 
	mNL80211_CMD_PMKSA_CANDIDATE
,

1331 
	mNL80211_CMD_TDLS_OPER
,

1332 
	mNL80211_CMD_TDLS_MGMT
,

1334 
	mNL80211_CMD_UNEXPECTED_FRAME
,

1336 
	mNL80211_CMD_PROBE_CLIENT
,

1338 
	mNL80211_CMD_REGISTER_BEACONS
,

1340 
	mNL80211_CMD_UNEXPECTED_4ADDR_FRAME
,

1342 
	mNL80211_CMD_SET_NOACK_MAP
,

1344 
	mNL80211_CMD_CH_SWITCH_NOTIFY
,

1346 
	mNL80211_CMD_START_P2P_DEVICE
,

1347 
	mNL80211_CMD_STOP_P2P_DEVICE
,

1349 
	mNL80211_CMD_CONN_FAILED
,

1351 
	mNL80211_CMD_SET_MCAST_RATE
,

1353 
	mNL80211_CMD_SET_MAC_ACL
,

1355 
	mNL80211_CMD_RADAR_DETECT
,

1357 
	mNL80211_CMD_GET_PROTOCOL_FEATURES
,

1359 
	mNL80211_CMD_UPDATE_FT_IES
,

1360 
	mNL80211_CMD_FT_EVENT
,

1362 
	mNL80211_CMD_CRIT_PROTOCOL_START
,

1363 
	mNL80211_CMD_CRIT_PROTOCOL_STOP
,

1365 
	mNL80211_CMD_GET_COALESCE
,

1366 
	mNL80211_CMD_SET_COALESCE
,

1368 
	mNL80211_CMD_CHANNEL_SWITCH
,

1370 
	mNL80211_CMD_VENDOR
,

1372 
	mNL80211_CMD_SET_QOS_MAP
,

1374 
	mNL80211_CMD_ADD_TX_TS
,

1375 
	mNL80211_CMD_DEL_TX_TS
,

1377 
	mNL80211_CMD_GET_MPP
,

1379 
	mNL80211_CMD_JOIN_OCB
,

1380 
	mNL80211_CMD_LEAVE_OCB
,

1382 
	mNL80211_CMD_CH_SWITCH_STARTED_NOTIFY
,

1384 
	mNL80211_CMD_TDLS_CHANNEL_SWITCH
,

1385 
	mNL80211_CMD_TDLS_CANCEL_CHANNEL_SWITCH
,

1387 
	mNL80211_CMD_WIPHY_REG_CHANGE
,

1389 
	mNL80211_CMD_ABORT_SCAN
,

1391 
	mNL80211_CMD_START_NAN
,

1392 
	mNL80211_CMD_STOP_NAN
,

1393 
	mNL80211_CMD_ADD_NAN_FUNCTION
,

1394 
	mNL80211_CMD_DEL_NAN_FUNCTION
,

1395 
	mNL80211_CMD_CHANGE_NAN_CONFIG
,

1396 
	mNL80211_CMD_NAN_MATCH
,

1398 
	mNL80211_CMD_SET_MULTICAST_TO_UNICAST
,

1400 
	mNL80211_CMD_UPDATE_CONNECT_PARAMS
,

1402 
	mNL80211_CMD_SET_PMK
,

1403 
	mNL80211_CMD_DEL_PMK
,

1405 
	mNL80211_CMD_PORT_AUTHORIZED
,

1407 
	mNL80211_CMD_RELOAD_REGDB
,

1409 
	mNL80211_CMD_EXTERNAL_AUTH
,

1411 
	mNL80211_CMD_STA_OPMODE_CHANGED
,

1413 
	mNL80211_CMD_CONTROL_PORT_FRAME
,

1415 
	mNL80211_CMD_GET_FTM_RESPONDER_STATS
,

1417 
	mNL80211_CMD_PEER_MEASUREMENT_START
,

1418 
	mNL80211_CMD_PEER_MEASUREMENT_RESULT
,

1419 
	mNL80211_CMD_PEER_MEASUREMENT_COMPLETE
,

1421 
	mNL80211_CMD_NOTIFY_RADAR
,

1423 
	mNL80211_CMD_UPDATE_OWE_INFO
,

1425 
	mNL80211_CMD_PROBE_MESH_LINK
,

1427 
	mNL80211_CMD_SET_TID_CONFIG
,

1429 
	mNL80211_CMD_UNPROT_BEACON
,

1431 
	mNL80211_CMD_CONTROL_PORT_FRAME_TX_STATUS
,

1433 
	mNL80211_CMD_SET_SAR_SPECS
,

1435 
	mNL80211_CMD_OBSS_COLOR_COLLISION
,

1437 
	mNL80211_CMD_COLOR_CHANGE_REQUEST
,

1439 
	mNL80211_CMD_COLOR_CHANGE_STARTED
,

1440 
	mNL80211_CMD_COLOR_CHANGE_ABORTED
,

1441 
	mNL80211_CMD_COLOR_CHANGE_COMPLETED
,

1446 
	m__NL80211_CMD_AFTER_LAST
,

1447 
	mNL80211_CMD_MAX
 = 
__NL80211_CMD_AFTER_LAST
 - 1

1454 
	#NL80211_CMD_SET_BSS
 
NL80211_CMD_SET_BSS


	)

1455 
	#NL80211_CMD_SET_MGMT_EXTRA_IE
 
NL80211_CMD_SET_MGMT_EXTRA_IE


	)

1456 
	#NL80211_CMD_REG_CHANGE
 
NL80211_CMD_REG_CHANGE


	)

1457 
	#NL80211_CMD_AUTHENTICATE
 
NL80211_CMD_AUTHENTICATE


	)

1458 
	#NL80211_CMD_ASSOCIATE
 
NL80211_CMD_ASSOCIATE


	)

1459 
	#NL80211_CMD_DEAUTHENTICATE
 
NL80211_CMD_DEAUTHENTICATE


	)

1460 
	#NL80211_CMD_DISASSOCIATE
 
NL80211_CMD_DISASSOCIATE


	)

1461 
	#NL80211_CMD_REG_BEACON_HINT
 
NL80211_CMD_REG_BEACON_HINT


	)

1463 
	#NL80211_ATTR_FEATURE_FLAGS
 
NL80211_ATTR_FEATURE_FLAGS


	)

1466 
	#NL80211_CMD_GET_MESH_PARAMS
 
NL80211_CMD_GET_MESH_CONFIG


	)

1467 
	#NL80211_CMD_SET_MESH_PARAMS
 
NL80211_CMD_SET_MESH_CONFIG


	)

1468 
	#NL80211_MESH_SETUP_VENDOR_PATH_SEL_IE
 
NL80211_MESH_SETUP_IE


	)

2600 
	e∆80211_©ås
 {

2602 
	mNL80211_ATTR_UNSPEC
,

2604 
	mNL80211_ATTR_WIPHY
,

2605 
	mNL80211_ATTR_WIPHY_NAME
,

2607 
	mNL80211_ATTR_IFINDEX
,

2608 
	mNL80211_ATTR_IFNAME
,

2609 
	mNL80211_ATTR_IFTYPE
,

2611 
	mNL80211_ATTR_MAC
,

2613 
	mNL80211_ATTR_KEY_DATA
,

2614 
	mNL80211_ATTR_KEY_IDX
,

2615 
	mNL80211_ATTR_KEY_CIPHER
,

2616 
	mNL80211_ATTR_KEY_SEQ
,

2617 
	mNL80211_ATTR_KEY_DEFAULT
,

2619 
	mNL80211_ATTR_BEACON_INTERVAL
,

2620 
	mNL80211_ATTR_DTIM_PERIOD
,

2621 
	mNL80211_ATTR_BEACON_HEAD
,

2622 
	mNL80211_ATTR_BEACON_TAIL
,

2624 
	mNL80211_ATTR_STA_AID
,

2625 
	mNL80211_ATTR_STA_FLAGS
,

2626 
	mNL80211_ATTR_STA_LISTEN_INTERVAL
,

2627 
	mNL80211_ATTR_STA_SUPPORTED_RATES
,

2628 
	mNL80211_ATTR_STA_VLAN
,

2629 
	mNL80211_ATTR_STA_INFO
,

2631 
	mNL80211_ATTR_WIPHY_BANDS
,

2633 
	mNL80211_ATTR_MNTR_FLAGS
,

2635 
	mNL80211_ATTR_MESH_ID
,

2636 
	mNL80211_ATTR_STA_PLINK_ACTION
,

2637 
	mNL80211_ATTR_MPATH_NEXT_HOP
,

2638 
	mNL80211_ATTR_MPATH_INFO
,

2640 
	mNL80211_ATTR_BSS_CTS_PROT
,

2641 
	mNL80211_ATTR_BSS_SHORT_PREAMBLE
,

2642 
	mNL80211_ATTR_BSS_SHORT_SLOT_TIME
,

2644 
	mNL80211_ATTR_HT_CAPABILITY
,

2646 
	mNL80211_ATTR_SUPPORTED_IFTYPES
,

2648 
	mNL80211_ATTR_REG_ALPHA2
,

2649 
	mNL80211_ATTR_REG_RULES
,

2651 
	mNL80211_ATTR_MESH_CONFIG
,

2653 
	mNL80211_ATTR_BSS_BASIC_RATES
,

2655 
	mNL80211_ATTR_WIPHY_TXQ_PARAMS
,

2656 
	mNL80211_ATTR_WIPHY_FREQ
,

2657 
	mNL80211_ATTR_WIPHY_CHANNEL_TYPE
,

2659 
	mNL80211_ATTR_KEY_DEFAULT_MGMT
,

2661 
	mNL80211_ATTR_MGMT_SUBTYPE
,

2662 
	mNL80211_ATTR_IE
,

2664 
	mNL80211_ATTR_MAX_NUM_SCAN_SSIDS
,

2666 
	mNL80211_ATTR_SCAN_FREQUENCIES
,

2667 
	mNL80211_ATTR_SCAN_SSIDS
,

2668 
	mNL80211_ATTR_GENERATION
,

2669 
	mNL80211_ATTR_BSS
,

2671 
	mNL80211_ATTR_REG_INITIATOR
,

2672 
	mNL80211_ATTR_REG_TYPE
,

2674 
	mNL80211_ATTR_SUPPORTED_COMMANDS
,

2676 
	mNL80211_ATTR_FRAME
,

2677 
	mNL80211_ATTR_SSID
,

2678 
	mNL80211_ATTR_AUTH_TYPE
,

2679 
	mNL80211_ATTR_REASON_CODE
,

2681 
	mNL80211_ATTR_KEY_TYPE
,

2683 
	mNL80211_ATTR_MAX_SCAN_IE_LEN
,

2684 
	mNL80211_ATTR_CIPHER_SUITES
,

2686 
	mNL80211_ATTR_FREQ_BEFORE
,

2687 
	mNL80211_ATTR_FREQ_AFTER
,

2689 
	mNL80211_ATTR_FREQ_FIXED
,

2692 
	mNL80211_ATTR_WIPHY_RETRY_SHORT
,

2693 
	mNL80211_ATTR_WIPHY_RETRY_LONG
,

2694 
	mNL80211_ATTR_WIPHY_FRAG_THRESHOLD
,

2695 
	mNL80211_ATTR_WIPHY_RTS_THRESHOLD
,

2697 
	mNL80211_ATTR_TIMED_OUT
,

2699 
	mNL80211_ATTR_USE_MFP
,

2701 
	mNL80211_ATTR_STA_FLAGS2
,

2703 
	mNL80211_ATTR_CONTROL_PORT
,

2705 
	mNL80211_ATTR_TESTDATA
,

2707 
	mNL80211_ATTR_PRIVACY
,

2709 
	mNL80211_ATTR_DISCONNECTED_BY_AP
,

2710 
	mNL80211_ATTR_STATUS_CODE
,

2712 
	mNL80211_ATTR_CIPHER_SUITES_PAIRWISE
,

2713 
	mNL80211_ATTR_CIPHER_SUITE_GROUP
,

2714 
	mNL80211_ATTR_WPA_VERSIONS
,

2715 
	mNL80211_ATTR_AKM_SUITES
,

2717 
	mNL80211_ATTR_REQ_IE
,

2718 
	mNL80211_ATTR_RESP_IE
,

2720 
	mNL80211_ATTR_PREV_BSSID
,

2722 
	mNL80211_ATTR_KEY
,

2723 
	mNL80211_ATTR_KEYS
,

2725 
	mNL80211_ATTR_PID
,

2727 
	mNL80211_ATTR_4ADDR
,

2729 
	mNL80211_ATTR_SURVEY_INFO
,

2731 
	mNL80211_ATTR_PMKID
,

2732 
	mNL80211_ATTR_MAX_NUM_PMKIDS
,

2734 
	mNL80211_ATTR_DURATION
,

2736 
	mNL80211_ATTR_COOKIE
,

2738 
	mNL80211_ATTR_WIPHY_COVERAGE_CLASS
,

2740 
	mNL80211_ATTR_TX_RATES
,

2742 
	mNL80211_ATTR_FRAME_MATCH
,

2744 
	mNL80211_ATTR_ACK
,

2746 
	mNL80211_ATTR_PS_STATE
,

2748 
	mNL80211_ATTR_CQM
,

2750 
	mNL80211_ATTR_LOCAL_STATE_CHANGE
,

2752 
	mNL80211_ATTR_AP_ISOLATE
,

2754 
	mNL80211_ATTR_WIPHY_TX_POWER_SETTING
,

2755 
	mNL80211_ATTR_WIPHY_TX_POWER_LEVEL
,

2757 
	mNL80211_ATTR_TX_FRAME_TYPES
,

2758 
	mNL80211_ATTR_RX_FRAME_TYPES
,

2759 
	mNL80211_ATTR_FRAME_TYPE
,

2761 
	mNL80211_ATTR_CONTROL_PORT_ETHERTYPE
,

2762 
	mNL80211_ATTR_CONTROL_PORT_NO_ENCRYPT
,

2764 
	mNL80211_ATTR_SUPPORT_IBSS_RSN
,

2766 
	mNL80211_ATTR_WIPHY_ANTENNA_TX
,

2767 
	mNL80211_ATTR_WIPHY_ANTENNA_RX
,

2769 
	mNL80211_ATTR_MCAST_RATE
,

2771 
	mNL80211_ATTR_OFFCHANNEL_TX_OK
,

2773 
	mNL80211_ATTR_BSS_HT_OPMODE
,

2775 
	mNL80211_ATTR_KEY_DEFAULT_TYPES
,

2777 
	mNL80211_ATTR_MAX_REMAIN_ON_CHANNEL_DURATION
,

2779 
	mNL80211_ATTR_MESH_SETUP
,

2781 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_TX
,

2782 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_RX
,

2784 
	mNL80211_ATTR_SUPPORT_MESH_AUTH
,

2785 
	mNL80211_ATTR_STA_PLINK_STATE
,

2787 
	mNL80211_ATTR_WOWLAN_TRIGGERS
,

2788 
	mNL80211_ATTR_WOWLAN_TRIGGERS_SUPPORTED
,

2790 
	mNL80211_ATTR_SCHED_SCAN_INTERVAL
,

2792 
	mNL80211_ATTR_INTERFACE_COMBINATIONS
,

2793 
	mNL80211_ATTR_SOFTWARE_IFTYPES
,

2795 
	mNL80211_ATTR_REKEY_DATA
,

2797 
	mNL80211_ATTR_MAX_NUM_SCHED_SCAN_SSIDS
,

2798 
	mNL80211_ATTR_MAX_SCHED_SCAN_IE_LEN
,

2800 
	mNL80211_ATTR_SCAN_SUPP_RATES
,

2802 
	mNL80211_ATTR_HIDDEN_SSID
,

2804 
	mNL80211_ATTR_IE_PROBE_RESP
,

2805 
	mNL80211_ATTR_IE_ASSOC_RESP
,

2807 
	mNL80211_ATTR_STA_WME
,

2808 
	mNL80211_ATTR_SUPPORT_AP_UAPSD
,

2810 
	mNL80211_ATTR_ROAM_SUPPORT
,

2812 
	mNL80211_ATTR_SCHED_SCAN_MATCH
,

2813 
	mNL80211_ATTR_MAX_MATCH_SETS
,

2815 
	mNL80211_ATTR_PMKSA_CANDIDATE
,

2817 
	mNL80211_ATTR_TX_NO_CCK_RATE
,

2819 
	mNL80211_ATTR_TDLS_ACTION
,

2820 
	mNL80211_ATTR_TDLS_DIALOG_TOKEN
,

2821 
	mNL80211_ATTR_TDLS_OPERATION
,

2822 
	mNL80211_ATTR_TDLS_SUPPORT
,

2823 
	mNL80211_ATTR_TDLS_EXTERNAL_SETUP
,

2825 
	mNL80211_ATTR_DEVICE_AP_SME
,

2827 
	mNL80211_ATTR_DONT_WAIT_FOR_ACK
,

2829 
	mNL80211_ATTR_FEATURE_FLAGS
,

2831 
	mNL80211_ATTR_PROBE_RESP_OFFLOAD
,

2833 
	mNL80211_ATTR_PROBE_RESP
,

2835 
	mNL80211_ATTR_DFS_REGION
,

2837 
	mNL80211_ATTR_DISABLE_HT
,

2838 
	mNL80211_ATTR_HT_CAPABILITY_MASK
,

2840 
	mNL80211_ATTR_NOACK_MAP
,

2842 
	mNL80211_ATTR_INACTIVITY_TIMEOUT
,

2844 
	mNL80211_ATTR_RX_SIGNAL_DBM
,

2846 
	mNL80211_ATTR_BG_SCAN_PERIOD
,

2848 
	mNL80211_ATTR_WDEV
,

2850 
	mNL80211_ATTR_USER_REG_HINT_TYPE
,

2852 
	mNL80211_ATTR_CONN_FAILED_REASON
,

2854 
	mNL80211_ATTR_AUTH_DATA
,

2856 
	mNL80211_ATTR_VHT_CAPABILITY
,

2858 
	mNL80211_ATTR_SCAN_FLAGS
,

2860 
	mNL80211_ATTR_CHANNEL_WIDTH
,

2861 
	mNL80211_ATTR_CENTER_FREQ1
,

2862 
	mNL80211_ATTR_CENTER_FREQ2
,

2864 
	mNL80211_ATTR_P2P_CTWINDOW
,

2865 
	mNL80211_ATTR_P2P_OPPPS
,

2867 
	mNL80211_ATTR_LOCAL_MESH_POWER_MODE
,

2869 
	mNL80211_ATTR_ACL_POLICY
,

2871 
	mNL80211_ATTR_MAC_ADDRS
,

2873 
	mNL80211_ATTR_MAC_ACL_MAX
,

2875 
	mNL80211_ATTR_RADAR_EVENT
,

2877 
	mNL80211_ATTR_EXT_CAPA
,

2878 
	mNL80211_ATTR_EXT_CAPA_MASK
,

2880 
	mNL80211_ATTR_STA_CAPABILITY
,

2881 
	mNL80211_ATTR_STA_EXT_CAPABILITY
,

2883 
	mNL80211_ATTR_PROTOCOL_FEATURES
,

2884 
	mNL80211_ATTR_SPLIT_WIPHY_DUMP
,

2886 
	mNL80211_ATTR_DISABLE_VHT
,

2887 
	mNL80211_ATTR_VHT_CAPABILITY_MASK
,

2889 
	mNL80211_ATTR_MDID
,

2890 
	mNL80211_ATTR_IE_RIC
,

2892 
	mNL80211_ATTR_CRIT_PROT_ID
,

2893 
	mNL80211_ATTR_MAX_CRIT_PROT_DURATION
,

2895 
	mNL80211_ATTR_PEER_AID
,

2897 
	mNL80211_ATTR_COALESCE_RULE
,

2899 
	mNL80211_ATTR_CH_SWITCH_COUNT
,

2900 
	mNL80211_ATTR_CH_SWITCH_BLOCK_TX
,

2901 
	mNL80211_ATTR_CSA_IES
,

2902 
	mNL80211_ATTR_CNTDWN_OFFS_BEACON
,

2903 
	mNL80211_ATTR_CNTDWN_OFFS_PRESP
,

2905 
	mNL80211_ATTR_RXMGMT_FLAGS
,

2907 
	mNL80211_ATTR_STA_SUPPORTED_CHANNELS
,

2909 
	mNL80211_ATTR_STA_SUPPORTED_OPER_CLASSES
,

2911 
	mNL80211_ATTR_HANDLE_DFS
,

2913 
	mNL80211_ATTR_SUPPORT_5_MHZ
,

2914 
	mNL80211_ATTR_SUPPORT_10_MHZ
,

2916 
	mNL80211_ATTR_OPMODE_NOTIF
,

2918 
	mNL80211_ATTR_VENDOR_ID
,

2919 
	mNL80211_ATTR_VENDOR_SUBCMD
,

2920 
	mNL80211_ATTR_VENDOR_DATA
,

2921 
	mNL80211_ATTR_VENDOR_EVENTS
,

2923 
	mNL80211_ATTR_QOS_MAP
,

2925 
	mNL80211_ATTR_MAC_HINT
,

2926 
	mNL80211_ATTR_WIPHY_FREQ_HINT
,

2928 
	mNL80211_ATTR_MAX_AP_ASSOC_STA
,

2930 
	mNL80211_ATTR_TDLS_PEER_CAPABILITY
,

2932 
	mNL80211_ATTR_SOCKET_OWNER
,

2934 
	mNL80211_ATTR_CSA_C_OFFSETS_TX
,

2935 
	mNL80211_ATTR_MAX_CSA_COUNTERS
,

2937 
	mNL80211_ATTR_TDLS_INITIATOR
,

2939 
	mNL80211_ATTR_USE_RRM
,

2941 
	mNL80211_ATTR_WIPHY_DYN_ACK
,

2943 
	mNL80211_ATTR_TSID
,

2944 
	mNL80211_ATTR_USER_PRIO
,

2945 
	mNL80211_ATTR_ADMITTED_TIME
,

2947 
	mNL80211_ATTR_SMPS_MODE
,

2949 
	mNL80211_ATTR_OPER_CLASS
,

2951 
	mNL80211_ATTR_MAC_MASK
,

2953 
	mNL80211_ATTR_WIPHY_SELF_MANAGED_REG
,

2955 
	mNL80211_ATTR_EXT_FEATURES
,

2957 
	mNL80211_ATTR_SURVEY_RADIO_STATS
,

2959 
	mNL80211_ATTR_NETNS_FD
,

2961 
	mNL80211_ATTR_SCHED_SCAN_DELAY
,

2963 
	mNL80211_ATTR_REG_INDOOR
,

2965 
	mNL80211_ATTR_MAX_NUM_SCHED_SCAN_PLANS
,

2966 
	mNL80211_ATTR_MAX_SCAN_PLAN_INTERVAL
,

2967 
	mNL80211_ATTR_MAX_SCAN_PLAN_ITERATIONS
,

2968 
	mNL80211_ATTR_SCHED_SCAN_PLANS
,

2970 
	mNL80211_ATTR_PBSS
,

2972 
	mNL80211_ATTR_BSS_SELECT
,

2974 
	mNL80211_ATTR_STA_SUPPORT_P2P_PS
,

2976 
	mNL80211_ATTR_PAD
,

2978 
	mNL80211_ATTR_IFTYPE_EXT_CAPA
,

2980 
	mNL80211_ATTR_MU_MIMO_GROUP_DATA
,

2981 
	mNL80211_ATTR_MU_MIMO_FOLLOW_MAC_ADDR
,

2983 
	mNL80211_ATTR_SCAN_START_TIME_TSF
,

2984 
	mNL80211_ATTR_SCAN_START_TIME_TSF_BSSID
,

2985 
	mNL80211_ATTR_MEASUREMENT_DURATION
,

2986 
	mNL80211_ATTR_MEASUREMENT_DURATION_MANDATORY
,

2988 
	mNL80211_ATTR_MESH_PEER_AID
,

2990 
	mNL80211_ATTR_NAN_MASTER_PREF
,

2991 
	mNL80211_ATTR_BANDS
,

2992 
	mNL80211_ATTR_NAN_FUNC
,

2993 
	mNL80211_ATTR_NAN_MATCH
,

2995 
	mNL80211_ATTR_FILS_KEK
,

2996 
	mNL80211_ATTR_FILS_NONCES
,

2998 
	mNL80211_ATTR_MULTICAST_TO_UNICAST_ENABLED
,

3000 
	mNL80211_ATTR_BSSID
,

3002 
	mNL80211_ATTR_SCHED_SCAN_RELATIVE_RSSI
,

3003 
	mNL80211_ATTR_SCHED_SCAN_RSSI_ADJUST
,

3005 
	mNL80211_ATTR_TIMEOUT_REASON
,

3007 
	mNL80211_ATTR_FILS_ERP_USERNAME
,

3008 
	mNL80211_ATTR_FILS_ERP_REALM
,

3009 
	mNL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
,

3010 
	mNL80211_ATTR_FILS_ERP_RRK
,

3011 
	mNL80211_ATTR_FILS_CACHE_ID
,

3013 
	mNL80211_ATTR_PMK
,

3015 
	mNL80211_ATTR_SCHED_SCAN_MULTI
,

3016 
	mNL80211_ATTR_SCHED_SCAN_MAX_REQS
,

3018 
	mNL80211_ATTR_WANT_1X_4WAY_HS
,

3019 
	mNL80211_ATTR_PMKR0_NAME
,

3020 
	mNL80211_ATTR_PORT_AUTHORIZED
,

3022 
	mNL80211_ATTR_EXTERNAL_AUTH_ACTION
,

3023 
	mNL80211_ATTR_EXTERNAL_AUTH_SUPPORT
,

3025 
	mNL80211_ATTR_NSS
,

3026 
	mNL80211_ATTR_ACK_SIGNAL
,

3028 
	mNL80211_ATTR_CONTROL_PORT_OVER_NL80211
,

3030 
	mNL80211_ATTR_TXQ_STATS
,

3031 
	mNL80211_ATTR_TXQ_LIMIT
,

3032 
	mNL80211_ATTR_TXQ_MEMORY_LIMIT
,

3033 
	mNL80211_ATTR_TXQ_QUANTUM
,

3035 
	mNL80211_ATTR_HE_CAPABILITY
,

3037 
	mNL80211_ATTR_FTM_RESPONDER
,

3039 
	mNL80211_ATTR_FTM_RESPONDER_STATS
,

3041 
	mNL80211_ATTR_TIMEOUT
,

3043 
	mNL80211_ATTR_PEER_MEASUREMENTS
,

3045 
	mNL80211_ATTR_AIRTIME_WEIGHT
,

3046 
	mNL80211_ATTR_STA_TX_POWER_SETTING
,

3047 
	mNL80211_ATTR_STA_TX_POWER
,

3049 
	mNL80211_ATTR_SAE_PASSWORD
,

3051 
	mNL80211_ATTR_TWT_RESPONDER
,

3053 
	mNL80211_ATTR_HE_OBSS_PD
,

3055 
	mNL80211_ATTR_WIPHY_EDMG_CHANNELS
,

3056 
	mNL80211_ATTR_WIPHY_EDMG_BW_CONFIG
,

3058 
	mNL80211_ATTR_VLAN_ID
,

3060 
	mNL80211_ATTR_HE_BSS_COLOR
,

3062 
	mNL80211_ATTR_IFTYPE_AKM_SUITES
,

3064 
	mNL80211_ATTR_TID_CONFIG
,

3066 
	mNL80211_ATTR_CONTROL_PORT_NO_PREAUTH
,

3068 
	mNL80211_ATTR_PMK_LIFETIME
,

3069 
	mNL80211_ATTR_PMK_REAUTH_THRESHOLD
,

3071 
	mNL80211_ATTR_RECEIVE_MULTICAST
,

3072 
	mNL80211_ATTR_WIPHY_FREQ_OFFSET
,

3073 
	mNL80211_ATTR_CENTER_FREQ1_OFFSET
,

3074 
	mNL80211_ATTR_SCAN_FREQ_KHZ
,

3076 
	mNL80211_ATTR_HE_6GHZ_CAPABILITY
,

3078 
	mNL80211_ATTR_FILS_DISCOVERY
,

3080 
	mNL80211_ATTR_UNSOL_BCAST_PROBE_RESP
,

3082 
	mNL80211_ATTR_S1G_CAPABILITY
,

3083 
	mNL80211_ATTR_S1G_CAPABILITY_MASK
,

3085 
	mNL80211_ATTR_SAE_PWE
,

3087 
	mNL80211_ATTR_RECONNECT_REQUESTED
,

3089 
	mNL80211_ATTR_SAR_SPEC
,

3091 
	mNL80211_ATTR_DISABLE_HE
,

3093 
	mNL80211_ATTR_OBSS_COLOR_BITMAP
,

3095 
	mNL80211_ATTR_COLOR_CHANGE_COUNT
,

3096 
	mNL80211_ATTR_COLOR_CHANGE_COLOR
,

3097 
	mNL80211_ATTR_COLOR_CHANGE_ELEMS
,

3101 
	m__NL80211_ATTR_AFTER_LAST
,

3102 
	mNUM_NL80211_ATTR
 = 
__NL80211_ATTR_AFTER_LAST
,

3103 
	mNL80211_ATTR_MAX
 = 
__NL80211_ATTR_AFTER_LAST
 - 1

3107 
	#NL80211_ATTR_SCAN_GENERATION
 
NL80211_ATTR_GENERATION


	)

3108 
	#NL80211_ATTR_MESH_PARAMS
 
NL80211_ATTR_MESH_CONFIG


	)

3109 
	#NL80211_ATTR_IFACE_SOCKET_OWNER
 
NL80211_ATTR_SOCKET_OWNER


	)

3110 
	#NL80211_ATTR_SAE_DATA
 
NL80211_ATTR_AUTH_DATA


	)

3111 
	#NL80211_ATTR_CSA_C_OFF_BEACON
 
NL80211_ATTR_CNTDWN_OFFS_BEACON


	)

3112 
	#NL80211_ATTR_CSA_C_OFF_PRESP
 
NL80211_ATTR_CNTDWN_OFFS_PRESP


	)

3118 
	#NL80211_CMD_CONNECT
 
NL80211_CMD_CONNECT


	)

3119 
	#NL80211_ATTR_HT_CAPABILITY
 
NL80211_ATTR_HT_CAPABILITY


	)

3120 
	#NL80211_ATTR_BSS_BASIC_RATES
 
NL80211_ATTR_BSS_BASIC_RATES


	)

3121 
	#NL80211_ATTR_WIPHY_TXQ_PARAMS
 
NL80211_ATTR_WIPHY_TXQ_PARAMS


	)

3122 
	#NL80211_ATTR_WIPHY_FREQ
 
NL80211_ATTR_WIPHY_FREQ


	)

3123 
	#NL80211_ATTR_WIPHY_CHANNEL_TYPE
 
NL80211_ATTR_WIPHY_CHANNEL_TYPE


	)

3124 
	#NL80211_ATTR_MGMT_SUBTYPE
 
NL80211_ATTR_MGMT_SUBTYPE


	)

3125 
	#NL80211_ATTR_IE
 
NL80211_ATTR_IE


	)

3126 
	#NL80211_ATTR_REG_INITIATOR
 
NL80211_ATTR_REG_INITIATOR


	)

3127 
	#NL80211_ATTR_REG_TYPE
 
NL80211_ATTR_REG_TYPE


	)

3128 
	#NL80211_ATTR_FRAME
 
NL80211_ATTR_FRAME


	)

3129 
	#NL80211_ATTR_SSID
 
NL80211_ATTR_SSID


	)

3130 
	#NL80211_ATTR_AUTH_TYPE
 
NL80211_ATTR_AUTH_TYPE


	)

3131 
	#NL80211_ATTR_REASON_CODE
 
NL80211_ATTR_REASON_CODE


	)

3132 
	#NL80211_ATTR_CIPHER_SUITES_PAIRWISE
 
NL80211_ATTR_CIPHER_SUITES_PAIRWISE


	)

3133 
	#NL80211_ATTR_CIPHER_SUITE_GROUP
 
NL80211_ATTR_CIPHER_SUITE_GROUP


	)

3134 
	#NL80211_ATTR_WPA_VERSIONS
 
NL80211_ATTR_WPA_VERSIONS


	)

3135 
	#NL80211_ATTR_AKM_SUITES
 
NL80211_ATTR_AKM_SUITES


	)

3136 
	#NL80211_ATTR_KEY
 
NL80211_ATTR_KEY


	)

3137 
	#NL80211_ATTR_KEYS
 
NL80211_ATTR_KEYS


	)

3138 
	#NL80211_ATTR_FEATURE_FLAGS
 
NL80211_ATTR_FEATURE_FLAGS


	)

3140 
	#NL80211_WIPHY_NAME_MAXLEN
 64

	)

3142 
	#NL80211_MAX_SUPP_RATES
 32

	)

3143 
	#NL80211_MAX_SUPP_HT_RATES
 77

	)

3144 
	#NL80211_MAX_SUPP_REG_RULES
 128

	)

3145 
	#NL80211_TKIP_DATA_OFFSET_ENCR_KEY
 0

	)

3146 
	#NL80211_TKIP_DATA_OFFSET_TX_MIC_KEY
 16

	)

3147 
	#NL80211_TKIP_DATA_OFFSET_RX_MIC_KEY
 24

	)

3148 
	#NL80211_HT_CAPABILITY_LEN
 26

	)

3149 
	#NL80211_VHT_CAPABILITY_LEN
 12

	)

3150 
	#NL80211_HE_MIN_CAPABILITY_LEN
 16

	)

3151 
	#NL80211_HE_MAX_CAPABILITY_LEN
 54

	)

3152 
	#NL80211_MAX_NR_CIPHER_SUITES
 5

	)

3153 
	#NL80211_MAX_NR_AKM_SUITES
 2

	)

3155 
	#NL80211_MIN_REMAIN_ON_CHANNEL_TIME
 10

	)

3158 
	#NL80211_SCAN_RSSI_THOLD_OFF
 -300

	)

3160 
	#NL80211_CQM_TXE_MAX_INTVL
 1800

	)

3191 
	e∆80211_i·y≥
 {

3192 
	mNL80211_IFTYPE_UNSPECIFIED
,

3193 
	mNL80211_IFTYPE_ADHOC
,

3194 
	mNL80211_IFTYPE_STATION
,

3195 
	mNL80211_IFTYPE_AP
,

3196 
	mNL80211_IFTYPE_AP_VLAN
,

3197 
	mNL80211_IFTYPE_WDS
,

3198 
	mNL80211_IFTYPE_MONITOR
,

3199 
	mNL80211_IFTYPE_MESH_POINT
,

3200 
	mNL80211_IFTYPE_P2P_CLIENT
,

3201 
	mNL80211_IFTYPE_P2P_GO
,

3202 
	mNL80211_IFTYPE_P2P_DEVICE
,

3203 
	mNL80211_IFTYPE_OCB
,

3204 
	mNL80211_IFTYPE_NAN
,

3207 
	mNUM_NL80211_IFTYPES
,

3208 
	mNL80211_IFTYPE_MAX
 = 
NUM_NL80211_IFTYPES
 - 1

3235 
	e∆80211_°a_Êags
 {

3236 
	m__NL80211_STA_FLAG_INVALID
,

3237 
	mNL80211_STA_FLAG_AUTHORIZED
,

3238 
	mNL80211_STA_FLAG_SHORT_PREAMBLE
,

3239 
	mNL80211_STA_FLAG_WME
,

3240 
	mNL80211_STA_FLAG_MFP
,

3241 
	mNL80211_STA_FLAG_AUTHENTICATED
,

3242 
	mNL80211_STA_FLAG_TDLS_PEER
,

3243 
	mNL80211_STA_FLAG_ASSOCIATED
,

3246 
	m__NL80211_STA_FLAG_AFTER_LAST
,

3247 
	mNL80211_STA_FLAG_MAX
 = 
__NL80211_STA_FLAG_AFTER_LAST
 - 1

3257 
	e∆80211_°a_p2p_ps_°©us
 {

3258 
	mNL80211_P2P_PS_UNSUPPORTED
 = 0,

3259 
	mNL80211_P2P_PS_SUPPORTED
,

3261 
	mNUM_NL80211_P2P_PS_STATUS
,

3264 
	#NL80211_STA_FLAG_MAX_OLD_API
 
NL80211_STA_FLAG_TDLS_PEER


	)

3273 
	s∆80211_°a_Êag_upd©e
 {

3274 
__u32
 
	mmask
;

3275 
__u32
 
	m£t
;

3276 } 
__©åibuã__
((
∑cked
));

3284 
	e∆80211_he_gi
 {

3285 
	mNL80211_RATE_INFO_HE_GI_0_8
,

3286 
	mNL80211_RATE_INFO_HE_GI_1_6
,

3287 
	mNL80211_RATE_INFO_HE_GI_3_2
,

3296 
	e∆80211_he_…f
 {

3297 
	mNL80211_RATE_INFO_HE_1XLTF
,

3298 
	mNL80211_RATE_INFO_HE_2XLTF
,

3299 
	mNL80211_RATE_INFO_HE_4XLTF
,

3312 
	e∆80211_he_ru_Æloc
 {

3313 
	mNL80211_RATE_INFO_HE_RU_ALLOC_26
,

3314 
	mNL80211_RATE_INFO_HE_RU_ALLOC_52
,

3315 
	mNL80211_RATE_INFO_HE_RU_ALLOC_106
,

3316 
	mNL80211_RATE_INFO_HE_RU_ALLOC_242
,

3317 
	mNL80211_RATE_INFO_HE_RU_ALLOC_484
,

3318 
	mNL80211_RATE_INFO_HE_RU_ALLOC_996
,

3319 
	mNL80211_RATE_INFO_HE_RU_ALLOC_2x996
,

3363 
	e∆80211_øã_öfo
 {

3364 
	m__NL80211_RATE_INFO_INVALID
,

3365 
	mNL80211_RATE_INFO_BITRATE
,

3366 
	mNL80211_RATE_INFO_MCS
,

3367 
	mNL80211_RATE_INFO_40_MHZ_WIDTH
,

3368 
	mNL80211_RATE_INFO_SHORT_GI
,

3369 
	mNL80211_RATE_INFO_BITRATE32
,

3370 
	mNL80211_RATE_INFO_VHT_MCS
,

3371 
	mNL80211_RATE_INFO_VHT_NSS
,

3372 
	mNL80211_RATE_INFO_80_MHZ_WIDTH
,

3373 
	mNL80211_RATE_INFO_80P80_MHZ_WIDTH
,

3374 
	mNL80211_RATE_INFO_160_MHZ_WIDTH
,

3375 
	mNL80211_RATE_INFO_10_MHZ_WIDTH
,

3376 
	mNL80211_RATE_INFO_5_MHZ_WIDTH
,

3377 
	mNL80211_RATE_INFO_HE_MCS
,

3378 
	mNL80211_RATE_INFO_HE_NSS
,

3379 
	mNL80211_RATE_INFO_HE_GI
,

3380 
	mNL80211_RATE_INFO_HE_DCM
,

3381 
	mNL80211_RATE_INFO_HE_RU_ALLOC
,

3384 
	m__NL80211_RATE_INFO_AFTER_LAST
,

3385 
	mNL80211_RATE_INFO_MAX
 = 
__NL80211_RATE_INFO_AFTER_LAST
 - 1

3405 
	e∆80211_°a_bss_∑øm
 {

3406 
	m__NL80211_STA_BSS_PARAM_INVALID
,

3407 
	mNL80211_STA_BSS_PARAM_CTS_PROT
,

3408 
	mNL80211_STA_BSS_PARAM_SHORT_PREAMBLE
,

3409 
	mNL80211_STA_BSS_PARAM_SHORT_SLOT_TIME
,

3410 
	mNL80211_STA_BSS_PARAM_DTIM_PERIOD
,

3411 
	mNL80211_STA_BSS_PARAM_BEACON_INTERVAL
,

3414 
	m__NL80211_STA_BSS_PARAM_AFTER_LAST
,

3415 
	mNL80211_STA_BSS_PARAM_MAX
 = 
__NL80211_STA_BSS_PARAM_AFTER_LAST
 - 1

3501 
	e∆80211_°a_öfo
 {

3502 
	m__NL80211_STA_INFO_INVALID
,

3503 
	mNL80211_STA_INFO_INACTIVE_TIME
,

3504 
	mNL80211_STA_INFO_RX_BYTES
,

3505 
	mNL80211_STA_INFO_TX_BYTES
,

3506 
	mNL80211_STA_INFO_LLID
,

3507 
	mNL80211_STA_INFO_PLID
,

3508 
	mNL80211_STA_INFO_PLINK_STATE
,

3509 
	mNL80211_STA_INFO_SIGNAL
,

3510 
	mNL80211_STA_INFO_TX_BITRATE
,

3511 
	mNL80211_STA_INFO_RX_PACKETS
,

3512 
	mNL80211_STA_INFO_TX_PACKETS
,

3513 
	mNL80211_STA_INFO_TX_RETRIES
,

3514 
	mNL80211_STA_INFO_TX_FAILED
,

3515 
	mNL80211_STA_INFO_SIGNAL_AVG
,

3516 
	mNL80211_STA_INFO_RX_BITRATE
,

3517 
	mNL80211_STA_INFO_BSS_PARAM
,

3518 
	mNL80211_STA_INFO_CONNECTED_TIME
,

3519 
	mNL80211_STA_INFO_STA_FLAGS
,

3520 
	mNL80211_STA_INFO_BEACON_LOSS
,

3521 
	mNL80211_STA_INFO_T_OFFSET
,

3522 
	mNL80211_STA_INFO_LOCAL_PM
,

3523 
	mNL80211_STA_INFO_PEER_PM
,

3524 
	mNL80211_STA_INFO_NONPEER_PM
,

3525 
	mNL80211_STA_INFO_RX_BYTES64
,

3526 
	mNL80211_STA_INFO_TX_BYTES64
,

3527 
	mNL80211_STA_INFO_CHAIN_SIGNAL
,

3528 
	mNL80211_STA_INFO_CHAIN_SIGNAL_AVG
,

3529 
	mNL80211_STA_INFO_EXPECTED_THROUGHPUT
,

3530 
	mNL80211_STA_INFO_RX_DROP_MISC
,

3531 
	mNL80211_STA_INFO_BEACON_RX
,

3532 
	mNL80211_STA_INFO_BEACON_SIGNAL_AVG
,

3533 
	mNL80211_STA_INFO_TID_STATS
,

3534 
	mNL80211_STA_INFO_RX_DURATION
,

3535 
	mNL80211_STA_INFO_PAD
,

3536 
	mNL80211_STA_INFO_ACK_SIGNAL
,

3537 
	mNL80211_STA_INFO_ACK_SIGNAL_AVG
,

3538 
	mNL80211_STA_INFO_RX_MPDUS
,

3539 
	mNL80211_STA_INFO_FCS_ERROR_COUNT
,

3540 
	mNL80211_STA_INFO_CONNECTED_TO_GATE
,

3541 
	mNL80211_STA_INFO_TX_DURATION
,

3542 
	mNL80211_STA_INFO_AIRTIME_WEIGHT
,

3543 
	mNL80211_STA_INFO_AIRTIME_LINK_METRIC
,

3544 
	mNL80211_STA_INFO_ASSOC_AT_BOOTTIME
,

3545 
	mNL80211_STA_INFO_CONNECTED_TO_AS
,

3548 
	m__NL80211_STA_INFO_AFTER_LAST
,

3549 
	mNL80211_STA_INFO_MAX
 = 
__NL80211_STA_INFO_AFTER_LAST
 - 1

3553 
	#NL80211_STA_INFO_DATA_ACK_SIGNAL_AVG
 
NL80211_STA_INFO_ACK_SIGNAL_AVG


	)

3571 
	e∆80211_tid_°©s
 {

3572 
	m__NL80211_TID_STATS_INVALID
,

3573 
	mNL80211_TID_STATS_RX_MSDU
,

3574 
	mNL80211_TID_STATS_TX_MSDU
,

3575 
	mNL80211_TID_STATS_TX_MSDU_RETRIES
,

3576 
	mNL80211_TID_STATS_TX_MSDU_FAILED
,

3577 
	mNL80211_TID_STATS_PAD
,

3578 
	mNL80211_TID_STATS_TXQ_STATS
,

3581 
	mNUM_NL80211_TID_STATS
,

3582 
	mNL80211_TID_STATS_MAX
 = 
NUM_NL80211_TID_STATS
 - 1

3604 
	e∆80211_txq_°©s
 {

3605 
	m__NL80211_TXQ_STATS_INVALID
,

3606 
	mNL80211_TXQ_STATS_BACKLOG_BYTES
,

3607 
	mNL80211_TXQ_STATS_BACKLOG_PACKETS
,

3608 
	mNL80211_TXQ_STATS_FLOWS
,

3609 
	mNL80211_TXQ_STATS_DROPS
,

3610 
	mNL80211_TXQ_STATS_ECN_MARKS
,

3611 
	mNL80211_TXQ_STATS_OVERLIMIT
,

3612 
	mNL80211_TXQ_STATS_OVERMEMORY
,

3613 
	mNL80211_TXQ_STATS_COLLISIONS
,

3614 
	mNL80211_TXQ_STATS_TX_BYTES
,

3615 
	mNL80211_TXQ_STATS_TX_PACKETS
,

3616 
	mNL80211_TXQ_STATS_MAX_FLOWS
,

3619 
	mNUM_NL80211_TXQ_STATS
,

3620 
	mNL80211_TXQ_STATS_MAX
 = 
NUM_NL80211_TXQ_STATS
 - 1

3632 
	e∆80211_m∑th_Êags
 {

3633 
	mNL80211_MPATH_FLAG_ACTIVE
 = 1<<0,

3634 
	mNL80211_MPATH_FLAG_RESOLVING
 = 1<<1,

3635 
	mNL80211_MPATH_FLAG_SN_VALID
 = 1<<2,

3636 
	mNL80211_MPATH_FLAG_FIXED
 = 1<<3,

3637 
	mNL80211_MPATH_FLAG_RESOLVED
 = 1<<4,

3661 
	e∆80211_m∑th_öfo
 {

3662 
	m__NL80211_MPATH_INFO_INVALID
,

3663 
	mNL80211_MPATH_INFO_FRAME_QLEN
,

3664 
	mNL80211_MPATH_INFO_SN
,

3665 
	mNL80211_MPATH_INFO_METRIC
,

3666 
	mNL80211_MPATH_INFO_EXPTIME
,

3667 
	mNL80211_MPATH_INFO_FLAGS
,

3668 
	mNL80211_MPATH_INFO_DISCOVERY_TIMEOUT
,

3669 
	mNL80211_MPATH_INFO_DISCOVERY_RETRIES
,

3670 
	mNL80211_MPATH_INFO_HOP_COUNT
,

3671 
	mNL80211_MPATH_INFO_PATH_CHANGE
,

3674 
	m__NL80211_MPATH_INFO_AFTER_LAST
,

3675 
	mNL80211_MPATH_INFO_MAX
 = 
__NL80211_MPATH_INFO_AFTER_LAST
 - 1

3700 
	e∆80211_b™d_i·y≥_©å
 {

3701 
	m__NL80211_BAND_IFTYPE_ATTR_INVALID
,

3703 
	mNL80211_BAND_IFTYPE_ATTR_IFTYPES
,

3704 
	mNL80211_BAND_IFTYPE_ATTR_HE_CAP_MAC
,

3705 
	mNL80211_BAND_IFTYPE_ATTR_HE_CAP_PHY
,

3706 
	mNL80211_BAND_IFTYPE_ATTR_HE_CAP_MCS_SET
,

3707 
	mNL80211_BAND_IFTYPE_ATTR_HE_CAP_PPE
,

3708 
	mNL80211_BAND_IFTYPE_ATTR_HE_6GHZ_CAPA
,

3709 
	mNL80211_BAND_IFTYPE_ATTR_VENDOR_ELEMS
,

3712 
	m__NL80211_BAND_IFTYPE_ATTR_AFTER_LAST
,

3713 
	mNL80211_BAND_IFTYPE_ATTR_MAX
 = 
__NL80211_BAND_IFTYPE_ATTR_AFTER_LAST
 - 1

3742 
	e∆80211_b™d_©å
 {

3743 
	m__NL80211_BAND_ATTR_INVALID
,

3744 
	mNL80211_BAND_ATTR_FREQS
,

3745 
	mNL80211_BAND_ATTR_RATES
,

3747 
	mNL80211_BAND_ATTR_HT_MCS_SET
,

3748 
	mNL80211_BAND_ATTR_HT_CAPA
,

3749 
	mNL80211_BAND_ATTR_HT_AMPDU_FACTOR
,

3750 
	mNL80211_BAND_ATTR_HT_AMPDU_DENSITY
,

3752 
	mNL80211_BAND_ATTR_VHT_MCS_SET
,

3753 
	mNL80211_BAND_ATTR_VHT_CAPA
,

3754 
	mNL80211_BAND_ATTR_IFTYPE_DATA
,

3756 
	mNL80211_BAND_ATTR_EDMG_CHANNELS
,

3757 
	mNL80211_BAND_ATTR_EDMG_BW_CONFIG
,

3760 
	m__NL80211_BAND_ATTR_AFTER_LAST
,

3761 
	mNL80211_BAND_ATTR_MAX
 = 
__NL80211_BAND_ATTR_AFTER_LAST
 - 1

3764 
	#NL80211_BAND_ATTR_HT_CAPA
 
NL80211_BAND_ATTR_HT_CAPA


	)

3777 
	e∆80211_wmm_ruÀ
 {

3778 
	m__NL80211_WMMR_INVALID
,

3779 
	mNL80211_WMMR_CW_MIN
,

3780 
	mNL80211_WMMR_CW_MAX
,

3781 
	mNL80211_WMMR_AIFSN
,

3782 
	mNL80211_WMMR_TXOP
,

3785 
	m__NL80211_WMMR_LAST
,

3786 
	mNL80211_WMMR_MAX
 = 
__NL80211_WMMR_LAST
 - 1

3863 
	e∆80211_‰equícy_©å
 {

3864 
	m__NL80211_FREQUENCY_ATTR_INVALID
,

3865 
	mNL80211_FREQUENCY_ATTR_FREQ
,

3866 
	mNL80211_FREQUENCY_ATTR_DISABLED
,

3867 
	mNL80211_FREQUENCY_ATTR_NO_IR
,

3868 
	m__NL80211_FREQUENCY_ATTR_NO_IBSS
,

3869 
	mNL80211_FREQUENCY_ATTR_RADAR
,

3870 
	mNL80211_FREQUENCY_ATTR_MAX_TX_POWER
,

3871 
	mNL80211_FREQUENCY_ATTR_DFS_STATE
,

3872 
	mNL80211_FREQUENCY_ATTR_DFS_TIME
,

3873 
	mNL80211_FREQUENCY_ATTR_NO_HT40_MINUS
,

3874 
	mNL80211_FREQUENCY_ATTR_NO_HT40_PLUS
,

3875 
	mNL80211_FREQUENCY_ATTR_NO_80MHZ
,

3876 
	mNL80211_FREQUENCY_ATTR_NO_160MHZ
,

3877 
	mNL80211_FREQUENCY_ATTR_DFS_CAC_TIME
,

3878 
	mNL80211_FREQUENCY_ATTR_INDOOR_ONLY
,

3879 
	mNL80211_FREQUENCY_ATTR_IR_CONCURRENT
,

3880 
	mNL80211_FREQUENCY_ATTR_NO_20MHZ
,

3881 
	mNL80211_FREQUENCY_ATTR_NO_10MHZ
,

3882 
	mNL80211_FREQUENCY_ATTR_WMM
,

3883 
	mNL80211_FREQUENCY_ATTR_NO_HE
,

3884 
	mNL80211_FREQUENCY_ATTR_OFFSET
,

3885 
	mNL80211_FREQUENCY_ATTR_1MHZ
,

3886 
	mNL80211_FREQUENCY_ATTR_2MHZ
,

3887 
	mNL80211_FREQUENCY_ATTR_4MHZ
,

3888 
	mNL80211_FREQUENCY_ATTR_8MHZ
,

3889 
	mNL80211_FREQUENCY_ATTR_16MHZ
,

3892 
	m__NL80211_FREQUENCY_ATTR_AFTER_LAST
,

3893 
	mNL80211_FREQUENCY_ATTR_MAX
 = 
__NL80211_FREQUENCY_ATTR_AFTER_LAST
 - 1

3896 
	#NL80211_FREQUENCY_ATTR_MAX_TX_POWER
 
NL80211_FREQUENCY_ATTR_MAX_TX_POWER


	)

3897 
	#NL80211_FREQUENCY_ATTR_PASSIVE_SCAN
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

3898 
	#NL80211_FREQUENCY_ATTR_NO_IBSS
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

3899 
	#NL80211_FREQUENCY_ATTR_NO_IR
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

3900 
	#NL80211_FREQUENCY_ATTR_GO_CONCURRENT
 \

3901 
NL80211_FREQUENCY_ATTR_IR_CONCURRENT


	)

3913 
	e∆80211_bôøã_©å
 {

3914 
	m__NL80211_BITRATE_ATTR_INVALID
,

3915 
	mNL80211_BITRATE_ATTR_RATE
,

3916 
	mNL80211_BITRATE_ATTR_2GHZ_SHORTPREAMBLE
,

3919 
	m__NL80211_BITRATE_ATTR_AFTER_LAST
,

3920 
	mNL80211_BITRATE_ATTR_MAX
 = 
__NL80211_BITRATE_ATTR_AFTER_LAST
 - 1

3939 
	e∆80211_ªg_öôüt‹
 {

3940 
	mNL80211_REGDOM_SET_BY_CORE
,

3941 
	mNL80211_REGDOM_SET_BY_USER
,

3942 
	mNL80211_REGDOM_SET_BY_DRIVER
,

3943 
	mNL80211_REGDOM_SET_BY_COUNTRY_IE
,

3962 
	e∆80211_ªg_ty≥
 {

3963 
	mNL80211_REGDOM_TYPE_COUNTRY
,

3964 
	mNL80211_REGDOM_TYPE_WORLD
,

3965 
	mNL80211_REGDOM_TYPE_CUSTOM_WORLD
,

3966 
	mNL80211_REGDOM_TYPE_INTERSECTION
,

3994 
	e∆80211_ªg_ruÀ_©å
 {

3995 
	m__NL80211_REG_RULE_ATTR_INVALID
,

3996 
	mNL80211_ATTR_REG_RULE_FLAGS
,

3998 
	mNL80211_ATTR_FREQ_RANGE_START
,

3999 
	mNL80211_ATTR_FREQ_RANGE_END
,

4000 
	mNL80211_ATTR_FREQ_RANGE_MAX_BW
,

4002 
	mNL80211_ATTR_POWER_RULE_MAX_ANT_GAIN
,

4003 
	mNL80211_ATTR_POWER_RULE_MAX_EIRP
,

4005 
	mNL80211_ATTR_DFS_CAC_TIME
,

4008 
	m__NL80211_REG_RULE_ATTR_AFTER_LAST
,

4009 
	mNL80211_REG_RULE_ATTR_MAX
 = 
__NL80211_REG_RULE_ATTR_AFTER_LAST
 - 1

4047 
	e∆80211_sched_sˇn_m©ch_©å
 {

4048 
	m__NL80211_SCHED_SCAN_MATCH_ATTR_INVALID
,

4050 
	mNL80211_SCHED_SCAN_MATCH_ATTR_SSID
,

4051 
	mNL80211_SCHED_SCAN_MATCH_ATTR_RSSI
,

4052 
	mNL80211_SCHED_SCAN_MATCH_ATTR_RELATIVE_RSSI
,

4053 
	mNL80211_SCHED_SCAN_MATCH_ATTR_RSSI_ADJUST
,

4054 
	mNL80211_SCHED_SCAN_MATCH_ATTR_BSSID
,

4055 
	mNL80211_SCHED_SCAN_MATCH_PER_BAND_RSSI
,

4058 
	m__NL80211_SCHED_SCAN_MATCH_ATTR_AFTER_LAST
,

4059 
	mNL80211_SCHED_SCAN_MATCH_ATTR_MAX
 =

4060 
__NL80211_SCHED_SCAN_MATCH_ATTR_AFTER_LAST
 - 1

4064 
	#NL80211_ATTR_SCHED_SCAN_MATCH_SSID
 
NL80211_SCHED_SCAN_MATCH_ATTR_SSID


	)

4089 
	e∆80211_ªg_ruÀ_Êags
 {

4090 
	mNL80211_RRF_NO_OFDM
 = 1<<0,

4091 
	mNL80211_RRF_NO_CCK
 = 1<<1,

4092 
	mNL80211_RRF_NO_INDOOR
 = 1<<2,

4093 
	mNL80211_RRF_NO_OUTDOOR
 = 1<<3,

4094 
	mNL80211_RRF_DFS
 = 1<<4,

4095 
	mNL80211_RRF_PTP_ONLY
 = 1<<5,

4096 
	mNL80211_RRF_PTMP_ONLY
 = 1<<6,

4097 
	mNL80211_RRF_NO_IR
 = 1<<7,

4098 
	m__NL80211_RRF_NO_IBSS
 = 1<<8,

4099 
	mNL80211_RRF_AUTO_BW
 = 1<<11,

4100 
	mNL80211_RRF_IR_CONCURRENT
 = 1<<12,

4101 
	mNL80211_RRF_NO_HT40MINUS
 = 1<<13,

4102 
	mNL80211_RRF_NO_HT40PLUS
 = 1<<14,

4103 
	mNL80211_RRF_NO_80MHZ
 = 1<<15,

4104 
	mNL80211_RRF_NO_160MHZ
 = 1<<16,

4105 
	mNL80211_RRF_NO_HE
 = 1<<17,

4108 
	#NL80211_RRF_PASSIVE_SCAN
 
NL80211_RRF_NO_IR


	)

4109 
	#NL80211_RRF_NO_IBSS
 
NL80211_RRF_NO_IR


	)

4110 
	#NL80211_RRF_NO_IR
 
NL80211_RRF_NO_IR


	)

4111 
	#NL80211_RRF_NO_HT40
 (
NL80211_RRF_NO_HT40MINUS
 |\

4112 
NL80211_RRF_NO_HT40PLUS
)

	)

4113 
	#NL80211_RRF_GO_CONCURRENT
 
NL80211_RRF_IR_CONCURRENT


	)

4116 
	#NL80211_RRF_NO_IR_ALL
 (
NL80211_RRF_NO_IR
 | 
__NL80211_RRF_NO_IBSS
)

	)

4126 
	e∆80211_dfs_ªgi⁄s
 {

4127 
	mNL80211_DFS_UNSET
 = 0,

4128 
	mNL80211_DFS_FCC
 = 1,

4129 
	mNL80211_DFS_ETSI
 = 2,

4130 
	mNL80211_DFS_JP
 = 3,

4150 
	e∆80211_u£r_ªg_höt_ty≥
 {

4151 
	mNL80211_USER_REG_HINT_USER
 = 0,

4152 
	mNL80211_USER_REG_HINT_CELL_BASE
 = 1,

4153 
	mNL80211_USER_REG_HINT_INDOOR
 = 2,

4186 
	e∆80211_survey_öfo
 {

4187 
	m__NL80211_SURVEY_INFO_INVALID
,

4188 
	mNL80211_SURVEY_INFO_FREQUENCY
,

4189 
	mNL80211_SURVEY_INFO_NOISE
,

4190 
	mNL80211_SURVEY_INFO_IN_USE
,

4191 
	mNL80211_SURVEY_INFO_TIME
,

4192 
	mNL80211_SURVEY_INFO_TIME_BUSY
,

4193 
	mNL80211_SURVEY_INFO_TIME_EXT_BUSY
,

4194 
	mNL80211_SURVEY_INFO_TIME_RX
,

4195 
	mNL80211_SURVEY_INFO_TIME_TX
,

4196 
	mNL80211_SURVEY_INFO_TIME_SCAN
,

4197 
	mNL80211_SURVEY_INFO_PAD
,

4198 
	mNL80211_SURVEY_INFO_TIME_BSS_RX
,

4199 
	mNL80211_SURVEY_INFO_FREQUENCY_OFFSET
,

4202 
	m__NL80211_SURVEY_INFO_AFTER_LAST
,

4203 
	mNL80211_SURVEY_INFO_MAX
 = 
__NL80211_SURVEY_INFO_AFTER_LAST
 - 1

4207 
	#NL80211_SURVEY_INFO_CHANNEL_TIME
 
NL80211_SURVEY_INFO_TIME


	)

4208 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_BUSY
 
NL80211_SURVEY_INFO_TIME_BUSY


	)

4209 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_EXT_BUSY
 
NL80211_SURVEY_INFO_TIME_EXT_BUSY


	)

4210 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_RX
 
NL80211_SURVEY_INFO_TIME_RX


	)

4211 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_TX
 
NL80211_SURVEY_INFO_TIME_TX


	)

4232 
	e∆80211_m¡r_Êags
 {

4233 
	m__NL80211_MNTR_FLAG_INVALID
,

4234 
	mNL80211_MNTR_FLAG_FCSFAIL
,

4235 
	mNL80211_MNTR_FLAG_PLCPFAIL
,

4236 
	mNL80211_MNTR_FLAG_CONTROL
,

4237 
	mNL80211_MNTR_FLAG_OTHER_BSS
,

4238 
	mNL80211_MNTR_FLAG_COOK_FRAMES
,

4239 
	mNL80211_MNTR_FLAG_ACTIVE
,

4242 
	m__NL80211_MNTR_FLAG_AFTER_LAST
,

4243 
	mNL80211_MNTR_FLAG_MAX
 = 
__NL80211_MNTR_FLAG_AFTER_LAST
 - 1

4264 
	e∆80211_mesh_powî_mode
 {

4265 
	mNL80211_MESH_POWER_UNKNOWN
,

4266 
	mNL80211_MESH_POWER_ACTIVE
,

4267 
	mNL80211_MESH_POWER_LIGHT_SLEEP
,

4268 
	mNL80211_MESH_POWER_DEEP_SLEEP
,

4270 
	m__NL80211_MESH_POWER_AFTER_LAST
,

4271 
	mNL80211_MESH_POWER_MAX
 = 
__NL80211_MESH_POWER_AFTER_LAST
 - 1

4397 
	e∆80211_meshc⁄f_∑øms
 {

4398 
	m__NL80211_MESHCONF_INVALID
,

4399 
	mNL80211_MESHCONF_RETRY_TIMEOUT
,

4400 
	mNL80211_MESHCONF_CONFIRM_TIMEOUT
,

4401 
	mNL80211_MESHCONF_HOLDING_TIMEOUT
,

4402 
	mNL80211_MESHCONF_MAX_PEER_LINKS
,

4403 
	mNL80211_MESHCONF_MAX_RETRIES
,

4404 
	mNL80211_MESHCONF_TTL
,

4405 
	mNL80211_MESHCONF_AUTO_OPEN_PLINKS
,

4406 
	mNL80211_MESHCONF_HWMP_MAX_PREQ_RETRIES
,

4407 
	mNL80211_MESHCONF_PATH_REFRESH_TIME
,

4408 
	mNL80211_MESHCONF_MIN_DISCOVERY_TIMEOUT
,

4409 
	mNL80211_MESHCONF_HWMP_ACTIVE_PATH_TIMEOUT
,

4410 
	mNL80211_MESHCONF_HWMP_PREQ_MIN_INTERVAL
,

4411 
	mNL80211_MESHCONF_HWMP_NET_DIAM_TRVS_TIME
,

4412 
	mNL80211_MESHCONF_HWMP_ROOTMODE
,

4413 
	mNL80211_MESHCONF_ELEMENT_TTL
,

4414 
	mNL80211_MESHCONF_HWMP_RANN_INTERVAL
,

4415 
	mNL80211_MESHCONF_GATE_ANNOUNCEMENTS
,

4416 
	mNL80211_MESHCONF_HWMP_PERR_MIN_INTERVAL
,

4417 
	mNL80211_MESHCONF_FORWARDING
,

4418 
	mNL80211_MESHCONF_RSSI_THRESHOLD
,

4419 
	mNL80211_MESHCONF_SYNC_OFFSET_MAX_NEIGHBOR
,

4420 
	mNL80211_MESHCONF_HT_OPMODE
,

4421 
	mNL80211_MESHCONF_HWMP_PATH_TO_ROOT_TIMEOUT
,

4422 
	mNL80211_MESHCONF_HWMP_ROOT_INTERVAL
,

4423 
	mNL80211_MESHCONF_HWMP_CONFIRMATION_INTERVAL
,

4424 
	mNL80211_MESHCONF_POWER_MODE
,

4425 
	mNL80211_MESHCONF_AWAKE_WINDOW
,

4426 
	mNL80211_MESHCONF_PLINK_TIMEOUT
,

4427 
	mNL80211_MESHCONF_CONNECTED_TO_GATE
,

4428 
	mNL80211_MESHCONF_NOLEARN
,

4429 
	mNL80211_MESHCONF_CONNECTED_TO_AS
,

4432 
	m__NL80211_MESHCONF_ATTR_AFTER_LAST
,

4433 
	mNL80211_MESHCONF_ATTR_MAX
 = 
__NL80211_MESHCONF_ATTR_AFTER_LAST
 - 1

4485 
	e∆80211_mesh_£tup_∑øms
 {

4486 
	m__NL80211_MESH_SETUP_INVALID
,

4487 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_PATH_SEL
,

4488 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_METRIC
,

4489 
	mNL80211_MESH_SETUP_IE
,

4490 
	mNL80211_MESH_SETUP_USERSPACE_AUTH
,

4491 
	mNL80211_MESH_SETUP_USERSPACE_AMPE
,

4492 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_SYNC
,

4493 
	mNL80211_MESH_SETUP_USERSPACE_MPM
,

4494 
	mNL80211_MESH_SETUP_AUTH_PROTOCOL
,

4497 
	m__NL80211_MESH_SETUP_ATTR_AFTER_LAST
,

4498 
	mNL80211_MESH_SETUP_ATTR_MAX
 = 
__NL80211_MESH_SETUP_ATTR_AFTER_LAST
 - 1

4515 
	e∆80211_txq_©å
 {

4516 
	m__NL80211_TXQ_ATTR_INVALID
,

4517 
	mNL80211_TXQ_ATTR_AC
,

4518 
	mNL80211_TXQ_ATTR_TXOP
,

4519 
	mNL80211_TXQ_ATTR_CWMIN
,

4520 
	mNL80211_TXQ_ATTR_CWMAX
,

4521 
	mNL80211_TXQ_ATTR_AIFS
,

4524 
	m__NL80211_TXQ_ATTR_AFTER_LAST
,

4525 
	mNL80211_TXQ_ATTR_MAX
 = 
__NL80211_TXQ_ATTR_AFTER_LAST
 - 1

4528 
	e∆80211_ac
 {

4529 
	mNL80211_AC_VO
,

4530 
	mNL80211_AC_VI
,

4531 
	mNL80211_AC_BE
,

4532 
	mNL80211_AC_BK
,

4533 
	mNL80211_NUM_ACS


4537 
	#NL80211_TXQ_ATTR_QUEUE
 
NL80211_TXQ_ATTR_AC


	)

4538 
	#NL80211_TXQ_Q_VO
 
NL80211_AC_VO


	)

4539 
	#NL80211_TXQ_Q_VI
 
NL80211_AC_VI


	)

4540 
	#NL80211_TXQ_Q_BE
 
NL80211_AC_BE


	)

4541 
	#NL80211_TXQ_Q_BK
 
NL80211_AC_BK


	)

4552 
	e∆80211_ch™√l_ty≥
 {

4553 
	mNL80211_CHAN_NO_HT
,

4554 
	mNL80211_CHAN_HT20
,

4555 
	mNL80211_CHAN_HT40MINUS
,

4556 
	mNL80211_CHAN_HT40PLUS


4574 
	e∆80211_key_mode
 {

4575 
	mNL80211_KEY_RX_TX
,

4576 
	mNL80211_KEY_NO_TX
,

4577 
	mNL80211_KEY_SET_TX


4604 
	e∆80211_ch™_width
 {

4605 
	mNL80211_CHAN_WIDTH_20_NOHT
,

4606 
	mNL80211_CHAN_WIDTH_20
,

4607 
	mNL80211_CHAN_WIDTH_40
,

4608 
	mNL80211_CHAN_WIDTH_80
,

4609 
	mNL80211_CHAN_WIDTH_80P80
,

4610 
	mNL80211_CHAN_WIDTH_160
,

4611 
	mNL80211_CHAN_WIDTH_5
,

4612 
	mNL80211_CHAN_WIDTH_10
,

4613 
	mNL80211_CHAN_WIDTH_1
,

4614 
	mNL80211_CHAN_WIDTH_2
,

4615 
	mNL80211_CHAN_WIDTH_4
,

4616 
	mNL80211_CHAN_WIDTH_8
,

4617 
	mNL80211_CHAN_WIDTH_16
,

4631 
	e∆80211_bss_sˇn_width
 {

4632 
	mNL80211_BSS_CHAN_WIDTH_20
,

4633 
	mNL80211_BSS_CHAN_WIDTH_10
,

4634 
	mNL80211_BSS_CHAN_WIDTH_5
,

4635 
	mNL80211_BSS_CHAN_WIDTH_1
,

4636 
	mNL80211_BSS_CHAN_WIDTH_2
,

4692 
	e∆80211_bss
 {

4693 
	m__NL80211_BSS_INVALID
,

4694 
	mNL80211_BSS_BSSID
,

4695 
	mNL80211_BSS_FREQUENCY
,

4696 
	mNL80211_BSS_TSF
,

4697 
	mNL80211_BSS_BEACON_INTERVAL
,

4698 
	mNL80211_BSS_CAPABILITY
,

4699 
	mNL80211_BSS_INFORMATION_ELEMENTS
,

4700 
	mNL80211_BSS_SIGNAL_MBM
,

4701 
	mNL80211_BSS_SIGNAL_UNSPEC
,

4702 
	mNL80211_BSS_STATUS
,

4703 
	mNL80211_BSS_SEEN_MS_AGO
,

4704 
	mNL80211_BSS_BEACON_IES
,

4705 
	mNL80211_BSS_CHAN_WIDTH
,

4706 
	mNL80211_BSS_BEACON_TSF
,

4707 
	mNL80211_BSS_PRESP_DATA
,

4708 
	mNL80211_BSS_LAST_SEEN_BOOTTIME
,

4709 
	mNL80211_BSS_PAD
,

4710 
	mNL80211_BSS_PARENT_TSF
,

4711 
	mNL80211_BSS_PARENT_BSSID
,

4712 
	mNL80211_BSS_CHAIN_SIGNAL
,

4713 
	mNL80211_BSS_FREQUENCY_OFFSET
,

4716 
	m__NL80211_BSS_AFTER_LAST
,

4717 
	mNL80211_BSS_MAX
 = 
__NL80211_BSS_AFTER_LAST
 - 1

4732 
	e∆80211_bss_°©us
 {

4733 
	mNL80211_BSS_STATUS_AUTHENTICATED
,

4734 
	mNL80211_BSS_STATUS_ASSOCIATED
,

4735 
	mNL80211_BSS_STATUS_IBSS_JOINED
,

4755 
	e∆80211_auth_ty≥
 {

4756 
	mNL80211_AUTHTYPE_OPEN_SYSTEM
,

4757 
	mNL80211_AUTHTYPE_SHARED_KEY
,

4758 
	mNL80211_AUTHTYPE_FT
,

4759 
	mNL80211_AUTHTYPE_NETWORK_EAP
,

4760 
	mNL80211_AUTHTYPE_SAE
,

4761 
	mNL80211_AUTHTYPE_FILS_SK
,

4762 
	mNL80211_AUTHTYPE_FILS_SK_PFS
,

4763 
	mNL80211_AUTHTYPE_FILS_PK
,

4766 
	m__NL80211_AUTHTYPE_NUM
,

4767 
	mNL80211_AUTHTYPE_MAX
 = 
__NL80211_AUTHTYPE_NUM
 - 1,

4768 
	mNL80211_AUTHTYPE_AUTOMATIC


4778 
	e∆80211_key_ty≥
 {

4779 
	mNL80211_KEYTYPE_GROUP
,

4780 
	mNL80211_KEYTYPE_PAIRWISE
,

4781 
	mNL80211_KEYTYPE_PEERKEY
,

4783 
	mNUM_NL80211_KEYTYPES


4792 
	e∆80211_mÂ
 {

4793 
	mNL80211_MFP_NO
,

4794 
	mNL80211_MFP_REQUIRED
,

4795 
	mNL80211_MFP_OPTIONAL
,

4798 
	e∆80211_w∑_vîsi⁄s
 {

4799 
	mNL80211_WPA_VERSION_1
 = 1 << 0,

4800 
	mNL80211_WPA_VERSION_2
 = 1 << 1,

4801 
	mNL80211_WPA_VERSION_3
 = 1 << 2,

4813 
	e∆80211_key_deÁu…_ty≥s
 {

4814 
	m__NL80211_KEY_DEFAULT_TYPE_INVALID
,

4815 
	mNL80211_KEY_DEFAULT_TYPE_UNICAST
,

4816 
	mNL80211_KEY_DEFAULT_TYPE_MULTICAST
,

4818 
	mNUM_NL80211_KEY_DEFAULT_TYPES


4847 
	e∆80211_key_©åibuãs
 {

4848 
	m__NL80211_KEY_INVALID
,

4849 
	mNL80211_KEY_DATA
,

4850 
	mNL80211_KEY_IDX
,

4851 
	mNL80211_KEY_CIPHER
,

4852 
	mNL80211_KEY_SEQ
,

4853 
	mNL80211_KEY_DEFAULT
,

4854 
	mNL80211_KEY_DEFAULT_MGMT
,

4855 
	mNL80211_KEY_TYPE
,

4856 
	mNL80211_KEY_DEFAULT_TYPES
,

4857 
	mNL80211_KEY_MODE
,

4858 
	mNL80211_KEY_DEFAULT_BEACON
,

4861 
	m__NL80211_KEY_AFTER_LAST
,

4862 
	mNL80211_KEY_MAX
 = 
__NL80211_KEY_AFTER_LAST
 - 1

4884 
	e∆80211_tx_øã_©åibuãs
 {

4885 
	m__NL80211_TXRATE_INVALID
,

4886 
	mNL80211_TXRATE_LEGACY
,

4887 
	mNL80211_TXRATE_HT
,

4888 
	mNL80211_TXRATE_VHT
,

4889 
	mNL80211_TXRATE_GI
,

4890 
	mNL80211_TXRATE_HE
,

4891 
	mNL80211_TXRATE_HE_GI
,

4892 
	mNL80211_TXRATE_HE_LTF
,

4895 
	m__NL80211_TXRATE_AFTER_LAST
,

4896 
	mNL80211_TXRATE_MAX
 = 
__NL80211_TXRATE_AFTER_LAST
 - 1

4899 
	#NL80211_TXRATE_MCS
 
NL80211_TXRATE_HT


	)

4900 
	#NL80211_VHT_NSS_MAX
 8

	)

4906 
	s∆80211_txøã_vht
 {

4907 
__u16
 
	mmcs
[
NL80211_VHT_NSS_MAX
];

4910 
	#NL80211_HE_NSS_MAX
 8

	)

4915 
	s∆80211_txøã_he
 {

4916 
__u16
 
	mmcs
[
NL80211_HE_NSS_MAX
];

4919 
	e∆80211_txøã_gi
 {

4920 
	mNL80211_TXRATE_DEFAULT_GI
,

4921 
	mNL80211_TXRATE_FORCE_SGI
,

4922 
	mNL80211_TXRATE_FORCE_LGI
,

4935 
	e∆80211_b™d
 {

4936 
	mNL80211_BAND_2GHZ
,

4937 
	mNL80211_BAND_5GHZ
,

4938 
	mNL80211_BAND_60GHZ
,

4939 
	mNL80211_BAND_6GHZ
,

4940 
	mNL80211_BAND_S1GHZ
,

4942 
	mNUM_NL80211_BANDS
,

4950 
	e∆80211_ps_°©e
 {

4951 
	mNL80211_PS_DISABLED
,

4952 
	mNL80211_PS_ENABLED
,

4988 
	e∆80211_©å_cqm
 {

4989 
	m__NL80211_ATTR_CQM_INVALID
,

4990 
	mNL80211_ATTR_CQM_RSSI_THOLD
,

4991 
	mNL80211_ATTR_CQM_RSSI_HYST
,

4992 
	mNL80211_ATTR_CQM_RSSI_THRESHOLD_EVENT
,

4993 
	mNL80211_ATTR_CQM_PKT_LOSS_EVENT
,

4994 
	mNL80211_ATTR_CQM_TXE_RATE
,

4995 
	mNL80211_ATTR_CQM_TXE_PKTS
,

4996 
	mNL80211_ATTR_CQM_TXE_INTVL
,

4997 
	mNL80211_ATTR_CQM_BEACON_LOSS_EVENT
,

4998 
	mNL80211_ATTR_CQM_RSSI_LEVEL
,

5001 
	m__NL80211_ATTR_CQM_AFTER_LAST
,

5002 
	mNL80211_ATTR_CQM_MAX
 = 
__NL80211_ATTR_CQM_AFTER_LAST
 - 1

5013 
	e∆80211_cqm_rssi_thªshﬁd_evít
 {

5014 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_LOW
,

5015 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_HIGH
,

5016 
	mNL80211_CQM_RSSI_BEACON_LOSS_EVENT
,

5026 
	e∆80211_tx_powî_£âög
 {

5027 
	mNL80211_TX_POWER_AUTOMATIC
,

5028 
	mNL80211_TX_POWER_LIMITED
,

5029 
	mNL80211_TX_POWER_FIXED
,

5037 
	e∆80211_tid_c⁄fig
 {

5038 
	mNL80211_TID_CONFIG_ENABLE
,

5039 
	mNL80211_TID_CONFIG_DISABLE
,

5047 
	e∆80211_tx_øã_£âög
 {

5048 
	mNL80211_TX_RATE_AUTOMATIC
,

5049 
	mNL80211_TX_RATE_LIMITED
,

5050 
	mNL80211_TX_RATE_FIXED
,

5097 
	e∆80211_tid_c⁄fig_©å
 {

5098 
	m__NL80211_TID_CONFIG_ATTR_INVALID
,

5099 
	mNL80211_TID_CONFIG_ATTR_PAD
,

5100 
	mNL80211_TID_CONFIG_ATTR_VIF_SUPP
,

5101 
	mNL80211_TID_CONFIG_ATTR_PEER_SUPP
,

5102 
	mNL80211_TID_CONFIG_ATTR_OVERRIDE
,

5103 
	mNL80211_TID_CONFIG_ATTR_TIDS
,

5104 
	mNL80211_TID_CONFIG_ATTR_NOACK
,

5105 
	mNL80211_TID_CONFIG_ATTR_RETRY_SHORT
,

5106 
	mNL80211_TID_CONFIG_ATTR_RETRY_LONG
,

5107 
	mNL80211_TID_CONFIG_ATTR_AMPDU_CTRL
,

5108 
	mNL80211_TID_CONFIG_ATTR_RTSCTS_CTRL
,

5109 
	mNL80211_TID_CONFIG_ATTR_AMSDU_CTRL
,

5110 
	mNL80211_TID_CONFIG_ATTR_TX_RATE_TYPE
,

5111 
	mNL80211_TID_CONFIG_ATTR_TX_RATE
,

5114 
	m__NL80211_TID_CONFIG_ATTR_AFTER_LAST
,

5115 
	mNL80211_TID_CONFIG_ATTR_MAX
 = 
__NL80211_TID_CONFIG_ATTR_AFTER_LAST
 - 1

5139 
	e∆80211_∑ckë_∑âîn_©å
 {

5140 
	m__NL80211_PKTPAT_INVALID
,

5141 
	mNL80211_PKTPAT_MASK
,

5142 
	mNL80211_PKTPAT_PATTERN
,

5143 
	mNL80211_PKTPAT_OFFSET
,

5145 
	mNUM_NL80211_PKTPAT
,

5146 
	mMAX_NL80211_PKTPAT
 = 
NUM_NL80211_PKTPAT
 - 1,

5162 
	s∆80211_∑âîn_suµ‹t
 {

5163 
__u32
 
	mmax_∑âîns
;

5164 
__u32
 
	mmö_∑âîn_Àn
;

5165 
__u32
 
	mmax_∑âîn_Àn
;

5166 
__u32
 
	mmax_pkt_off£t
;

5167 } 
__©åibuã__
((
∑cked
));

5170 
	#__NL80211_WOWLAN_PKTPAT_INVALID
 
__NL80211_PKTPAT_INVALID


	)

5171 
	#NL80211_WOWLAN_PKTPAT_MASK
 
NL80211_PKTPAT_MASK


	)

5172 
	#NL80211_WOWLAN_PKTPAT_PATTERN
 
NL80211_PKTPAT_PATTERN


	)

5173 
	#NL80211_WOWLAN_PKTPAT_OFFSET
 
NL80211_PKTPAT_OFFSET


	)

5174 
	#NUM_NL80211_WOWLAN_PKTPAT
 
NUM_NL80211_PKTPAT


	)

5175 
	#MAX_NL80211_WOWLAN_PKTPAT
 
MAX_NL80211_PKTPAT


	)

5176 
	#∆80211_wowœn_∑âîn_suµ‹t
 
∆80211_∑âîn_suµ‹t


	)

5267 
	e∆80211_wowœn_åiggîs
 {

5268 
	m__NL80211_WOWLAN_TRIG_INVALID
,

5269 
	mNL80211_WOWLAN_TRIG_ANY
,

5270 
	mNL80211_WOWLAN_TRIG_DISCONNECT
,

5271 
	mNL80211_WOWLAN_TRIG_MAGIC_PKT
,

5272 
	mNL80211_WOWLAN_TRIG_PKT_PATTERN
,

5273 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_SUPPORTED
,

5274 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_FAILURE
,

5275 
	mNL80211_WOWLAN_TRIG_EAP_IDENT_REQUEST
,

5276 
	mNL80211_WOWLAN_TRIG_4WAY_HANDSHAKE
,

5277 
	mNL80211_WOWLAN_TRIG_RFKILL_RELEASE
,

5278 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_80211
,

5279 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_80211_LEN
,

5280 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_8023
,

5281 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_8023_LEN
,

5282 
	mNL80211_WOWLAN_TRIG_TCP_CONNECTION
,

5283 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_MATCH
,

5284 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_CONNLOST
,

5285 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_NOMORETOKENS
,

5286 
	mNL80211_WOWLAN_TRIG_NET_DETECT
,

5287 
	mNL80211_WOWLAN_TRIG_NET_DETECT_RESULTS
,

5290 
	mNUM_NL80211_WOWLAN_TRIG
,

5291 
	mMAX_NL80211_WOWLAN_TRIG
 = 
NUM_NL80211_WOWLAN_TRIG
 - 1

5327 
	s∆80211_wowœn_t˝_d©a_£q
 {

5328 
__u32
 
	m°¨t
, 
	moff£t
, 
	mÀn
;

5338 
	s∆80211_wowœn_t˝_d©a_tokí
 {

5339 
__u32
 
	moff£t
, 
	mÀn
;

5340 
__u8
 
	mtokí_°ªam
[];

5349 
	s∆80211_wowœn_t˝_d©a_tokí_„©uª
 {

5350 
__u32
 
	mmö_Àn
, 
	mmax_Àn
, 
	mbufsize
;

5385 
	e∆80211_wowœn_t˝_©ås
 {

5386 
	m__NL80211_WOWLAN_TCP_INVALID
,

5387 
	mNL80211_WOWLAN_TCP_SRC_IPV4
,

5388 
	mNL80211_WOWLAN_TCP_DST_IPV4
,

5389 
	mNL80211_WOWLAN_TCP_DST_MAC
,

5390 
	mNL80211_WOWLAN_TCP_SRC_PORT
,

5391 
	mNL80211_WOWLAN_TCP_DST_PORT
,

5392 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD
,

5393 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD_SEQ
,

5394 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD_TOKEN
,

5395 
	mNL80211_WOWLAN_TCP_DATA_INTERVAL
,

5396 
	mNL80211_WOWLAN_TCP_WAKE_PAYLOAD
,

5397 
	mNL80211_WOWLAN_TCP_WAKE_MASK
,

5400 
	mNUM_NL80211_WOWLAN_TCP
,

5401 
	mMAX_NL80211_WOWLAN_TCP
 = 
NUM_NL80211_WOWLAN_TCP
 - 1

5413 
	s∆80211_cﬂÀs˚_ruÀ_suµ‹t
 {

5414 
__u32
 
	mmax_ruÀs
;

5415 
∆80211_∑âîn_suµ‹t
 
	m∑t
;

5416 
__u32
 
	mmax_dñay
;

5417 } 
__©åibuã__
((
∑cked
));

5430 
	e∆80211_©å_cﬂÀs˚_ruÀ
 {

5431 
	m__NL80211_COALESCE_RULE_INVALID
,

5432 
	mNL80211_ATTR_COALESCE_RULE_DELAY
,

5433 
	mNL80211_ATTR_COALESCE_RULE_CONDITION
,

5434 
	mNL80211_ATTR_COALESCE_RULE_PKT_PATTERN
,

5437 
	mNUM_NL80211_ATTR_COALESCE_RULE
,

5438 
	mNL80211_ATTR_COALESCE_RULE_MAX
 = 
NUM_NL80211_ATTR_COALESCE_RULE
 - 1

5448 
	e∆80211_cﬂÀs˚_c⁄dôi⁄
 {

5449 
	mNL80211_COALESCE_CONDITION_MATCH
,

5450 
	mNL80211_COALESCE_CONDITION_NO_MATCH


5463 
	e∆80211_iÁ˚_limô_©ås
 {

5464 
	mNL80211_IFACE_LIMIT_UNSPEC
,

5465 
	mNL80211_IFACE_LIMIT_MAX
,

5466 
	mNL80211_IFACE_LIMIT_TYPES
,

5469 
	mNUM_NL80211_IFACE_LIMIT
,

5470 
	mMAX_NL80211_IFACE_LIMIT
 = 
NUM_NL80211_IFACE_LIMIT
 - 1

5522 
	e∆80211_if_combö©i⁄_©ås
 {

5523 
	mNL80211_IFACE_COMB_UNSPEC
,

5524 
	mNL80211_IFACE_COMB_LIMITS
,

5525 
	mNL80211_IFACE_COMB_MAXNUM
,

5526 
	mNL80211_IFACE_COMB_STA_AP_BI_MATCH
,

5527 
	mNL80211_IFACE_COMB_NUM_CHANNELS
,

5528 
	mNL80211_IFACE_COMB_RADAR_DETECT_WIDTHS
,

5529 
	mNL80211_IFACE_COMB_RADAR_DETECT_REGIONS
,

5530 
	mNL80211_IFACE_COMB_BI_MIN_GCD
,

5533 
	mNUM_NL80211_IFACE_COMB
,

5534 
	mMAX_NL80211_IFACE_COMB
 = 
NUM_NL80211_IFACE_COMB
 - 1

5556 
	e∆80211_∂ök_°©e
 {

5557 
	mNL80211_PLINK_LISTEN
,

5558 
	mNL80211_PLINK_OPN_SNT
,

5559 
	mNL80211_PLINK_OPN_RCVD
,

5560 
	mNL80211_PLINK_CNF_RCVD
,

5561 
	mNL80211_PLINK_ESTAB
,

5562 
	mNL80211_PLINK_HOLDING
,

5563 
	mNL80211_PLINK_BLOCKED
,

5566 
	mNUM_NL80211_PLINK_STATES
,

5567 
	mMAX_NL80211_PLINK_STATES
 = 
NUM_NL80211_PLINK_STATES
 - 1

5578 
	e∂ök_a˘i⁄s
 {

5579 
	mNL80211_PLINK_ACTION_NO_ACTION
,

5580 
	mNL80211_PLINK_ACTION_OPEN
,

5581 
	mNL80211_PLINK_ACTION_BLOCK
,

5583 
	mNUM_NL80211_PLINK_ACTIONS
,

5587 
	#NL80211_KCK_LEN
 16

	)

5588 
	#NL80211_KEK_LEN
 16

	)

5589 
	#NL80211_KCK_EXT_LEN
 24

	)

5590 
	#NL80211_KEK_EXT_LEN
 32

	)

5591 
	#NL80211_REPLAY_CTR_LEN
 8

	)

5603 
	e∆80211_ªkey_d©a
 {

5604 
	m__NL80211_REKEY_DATA_INVALID
,

5605 
	mNL80211_REKEY_DATA_KEK
,

5606 
	mNL80211_REKEY_DATA_KCK
,

5607 
	mNL80211_REKEY_DATA_REPLAY_CTR
,

5608 
	mNL80211_REKEY_DATA_AKM
,

5611 
	mNUM_NL80211_REKEY_DATA
,

5612 
	mMAX_NL80211_REKEY_DATA
 = 
NUM_NL80211_REKEY_DATA
 - 1

5624 
	e∆80211_hiddí_ssid
 {

5625 
	mNL80211_HIDDEN_SSID_NOT_IN_USE
,

5626 
	mNL80211_HIDDEN_SSID_ZERO_LEN
,

5627 
	mNL80211_HIDDEN_SSID_ZERO_CONTENTS


5640 
	e∆80211_°a_wme_©å
 {

5641 
	m__NL80211_STA_WME_INVALID
,

5642 
	mNL80211_STA_WME_UAPSD_QUEUES
,

5643 
	mNL80211_STA_WME_MAX_SP
,

5646 
	m__NL80211_STA_WME_AFTER_LAST
,

5647 
	mNL80211_STA_WME_MAX
 = 
__NL80211_STA_WME_AFTER_LAST
 - 1

5662 
	e∆80211_pmkß_ˇndid©e_©å
 {

5663 
	m__NL80211_PMKSA_CANDIDATE_INVALID
,

5664 
	mNL80211_PMKSA_CANDIDATE_INDEX
,

5665 
	mNL80211_PMKSA_CANDIDATE_BSSID
,

5666 
	mNL80211_PMKSA_CANDIDATE_PREAUTH
,

5669 
	mNUM_NL80211_PMKSA_CANDIDATE
,

5670 
	mMAX_NL80211_PMKSA_CANDIDATE
 = 
NUM_NL80211_PMKSA_CANDIDATE
 - 1

5681 
	e∆80211_tdls_›î©i⁄
 {

5682 
	mNL80211_TDLS_DISCOVERY_REQ
,

5683 
	mNL80211_TDLS_SETUP
,

5684 
	mNL80211_TDLS_TEARDOWN
,

5685 
	mNL80211_TDLS_ENABLE_LINK
,

5686 
	mNL80211_TDLS_DISABLE_LINK
,

5790 
	e∆80211_„©uª_Êags
 {

5791 
	mNL80211_FEATURE_SK_TX_STATUS
 = 1 << 0,

5792 
	mNL80211_FEATURE_HT_IBSS
 = 1 << 1,

5793 
	mNL80211_FEATURE_INACTIVITY_TIMER
 = 1 << 2,

5794 
	mNL80211_FEATURE_CELL_BASE_REG_HINTS
 = 1 << 3,

5795 
	mNL80211_FEATURE_P2P_DEVICE_NEEDS_CHANNEL
 = 1 << 4,

5796 
	mNL80211_FEATURE_SAE
 = 1 << 5,

5797 
	mNL80211_FEATURE_LOW_PRIORITY_SCAN
 = 1 << 6,

5798 
	mNL80211_FEATURE_SCAN_FLUSH
 = 1 << 7,

5799 
	mNL80211_FEATURE_AP_SCAN
 = 1 << 8,

5800 
	mNL80211_FEATURE_VIF_TXPOWER
 = 1 << 9,

5801 
	mNL80211_FEATURE_NEED_OBSS_SCAN
 = 1 << 10,

5802 
	mNL80211_FEATURE_P2P_GO_CTWIN
 = 1 << 11,

5803 
	mNL80211_FEATURE_P2P_GO_OPPPS
 = 1 << 12,

5805 
	mNL80211_FEATURE_ADVERTISE_CHAN_LIMITS
 = 1 << 14,

5806 
	mNL80211_FEATURE_FULL_AP_CLIENT_STATE
 = 1 << 15,

5807 
	mNL80211_FEATURE_USERSPACE_MPM
 = 1 << 16,

5808 
	mNL80211_FEATURE_ACTIVE_MONITOR
 = 1 << 17,

5809 
	mNL80211_FEATURE_AP_MODE_CHAN_WIDTH_CHANGE
 = 1 << 18,

5810 
	mNL80211_FEATURE_DS_PARAM_SET_IE_IN_PROBES
 = 1 << 19,

5811 
	mNL80211_FEATURE_WFA_TPC_IE_IN_PROBES
 = 1 << 20,

5812 
	mNL80211_FEATURE_QUIET
 = 1 << 21,

5813 
	mNL80211_FEATURE_TX_POWER_INSERTION
 = 1 << 22,

5814 
	mNL80211_FEATURE_ACKTO_ESTIMATION
 = 1 << 23,

5815 
	mNL80211_FEATURE_STATIC_SMPS
 = 1 << 24,

5816 
	mNL80211_FEATURE_DYNAMIC_SMPS
 = 1 << 25,

5817 
	mNL80211_FEATURE_SUPPORTS_WMM_ADMISSION
 = 1 << 26,

5818 
	mNL80211_FEATURE_MAC_ON_CREATE
 = 1 << 27,

5819 
	mNL80211_FEATURE_TDLS_CHANNEL_SWITCH
 = 1 << 28,

5820 
	mNL80211_FEATURE_SCAN_RANDOM_MAC_ADDR
 = 1 << 29,

5821 
	mNL80211_FEATURE_SCHED_SCAN_RANDOM_MAC_ADDR
 = 1 << 30,

5822 
	mNL80211_FEATURE_ND_RANDOM_MAC_ADDR
 = 1U << 31,

6001 
	e∆80211_ext_„©uª_ödex
 {

6002 
	mNL80211_EXT_FEATURE_VHT_IBSS
,

6003 
	mNL80211_EXT_FEATURE_RRM
,

6004 
	mNL80211_EXT_FEATURE_MU_MIMO_AIR_SNIFFER
,

6005 
	mNL80211_EXT_FEATURE_SCAN_START_TIME
,

6006 
	mNL80211_EXT_FEATURE_BSS_PARENT_TSF
,

6007 
	mNL80211_EXT_FEATURE_SET_SCAN_DWELL
,

6008 
	mNL80211_EXT_FEATURE_BEACON_RATE_LEGACY
,

6009 
	mNL80211_EXT_FEATURE_BEACON_RATE_HT
,

6010 
	mNL80211_EXT_FEATURE_BEACON_RATE_VHT
,

6011 
	mNL80211_EXT_FEATURE_FILS_STA
,

6012 
	mNL80211_EXT_FEATURE_MGMT_TX_RANDOM_TA
,

6013 
	mNL80211_EXT_FEATURE_MGMT_TX_RANDOM_TA_CONNECTED
,

6014 
	mNL80211_EXT_FEATURE_SCHED_SCAN_RELATIVE_RSSI
,

6015 
	mNL80211_EXT_FEATURE_CQM_RSSI_LIST
,

6016 
	mNL80211_EXT_FEATURE_FILS_SK_OFFLOAD
,

6017 
	mNL80211_EXT_FEATURE_4WAY_HANDSHAKE_STA_PSK
,

6018 
	mNL80211_EXT_FEATURE_4WAY_HANDSHAKE_STA_1X
,

6019 
	mNL80211_EXT_FEATURE_FILS_MAX_CHANNEL_TIME
,

6020 
	mNL80211_EXT_FEATURE_ACCEPT_BCAST_PROBE_RESP
,

6021 
	mNL80211_EXT_FEATURE_OCE_PROBE_REQ_HIGH_TX_RATE
,

6022 
	mNL80211_EXT_FEATURE_OCE_PROBE_REQ_DEFERRAL_SUPPRESSION
,

6023 
	mNL80211_EXT_FEATURE_MFP_OPTIONAL
,

6024 
	mNL80211_EXT_FEATURE_LOW_SPAN_SCAN
,

6025 
	mNL80211_EXT_FEATURE_LOW_POWER_SCAN
,

6026 
	mNL80211_EXT_FEATURE_HIGH_ACCURACY_SCAN
,

6027 
	mNL80211_EXT_FEATURE_DFS_OFFLOAD
,

6028 
	mNL80211_EXT_FEATURE_CONTROL_PORT_OVER_NL80211
,

6029 
	mNL80211_EXT_FEATURE_ACK_SIGNAL_SUPPORT
,

6031 
	mNL80211_EXT_FEATURE_DATA_ACK_SIGNAL_SUPPORT
 = 
NL80211_EXT_FEATURE_ACK_SIGNAL_SUPPORT
,

6032 
	mNL80211_EXT_FEATURE_TXQS
,

6033 
	mNL80211_EXT_FEATURE_SCAN_RANDOM_SN
,

6034 
	mNL80211_EXT_FEATURE_SCAN_MIN_PREQ_CONTENT
,

6035 
	mNL80211_EXT_FEATURE_CAN_REPLACE_PTK0
,

6036 
	mNL80211_EXT_FEATURE_ENABLE_FTM_RESPONDER
,

6037 
	mNL80211_EXT_FEATURE_AIRTIME_FAIRNESS
,

6038 
	mNL80211_EXT_FEATURE_AP_PMKSA_CACHING
,

6039 
	mNL80211_EXT_FEATURE_SCHED_SCAN_BAND_SPECIFIC_RSSI_THOLD
,

6040 
	mNL80211_EXT_FEATURE_EXT_KEY_ID
,

6041 
	mNL80211_EXT_FEATURE_STA_TX_PWR
,

6042 
	mNL80211_EXT_FEATURE_SAE_OFFLOAD
,

6043 
	mNL80211_EXT_FEATURE_VLAN_OFFLOAD
,

6044 
	mNL80211_EXT_FEATURE_AQL
,

6045 
	mNL80211_EXT_FEATURE_BEACON_PROTECTION
,

6046 
	mNL80211_EXT_FEATURE_CONTROL_PORT_NO_PREAUTH
,

6047 
	mNL80211_EXT_FEATURE_PROTECTED_TWT
,

6048 
	mNL80211_EXT_FEATURE_DEL_IBSS_STA
,

6049 
	mNL80211_EXT_FEATURE_MULTICAST_REGISTRATIONS
,

6050 
	mNL80211_EXT_FEATURE_BEACON_PROTECTION_CLIENT
,

6051 
	mNL80211_EXT_FEATURE_SCAN_FREQ_KHZ
,

6052 
	mNL80211_EXT_FEATURE_CONTROL_PORT_OVER_NL80211_TX_STATUS
,

6053 
	mNL80211_EXT_FEATURE_OPERATING_CHANNEL_VALIDATION
,

6054 
	mNL80211_EXT_FEATURE_4WAY_HANDSHAKE_AP_PSK
,

6055 
	mNL80211_EXT_FEATURE_SAE_OFFLOAD_AP
,

6056 
	mNL80211_EXT_FEATURE_FILS_DISCOVERY
,

6057 
	mNL80211_EXT_FEATURE_UNSOL_BCAST_PROBE_RESP
,

6058 
	mNL80211_EXT_FEATURE_BEACON_RATE_HE
,

6059 
	mNL80211_EXT_FEATURE_SECURE_LTF
,

6060 
	mNL80211_EXT_FEATURE_SECURE_RTT
,

6061 
	mNL80211_EXT_FEATURE_PROT_RANGE_NEGO_AND_MEASURE
,

6062 
	mNL80211_EXT_FEATURE_BSS_COLOR
,

6065 
	mNUM_NL80211_EXT_FEATURES
,

6066 
	mMAX_NL80211_EXT_FEATURES
 = 
NUM_NL80211_EXT_FEATURES
 - 1

6083 
	e∆80211_¥obe_ª•_ofÊﬂd_suµ‹t_©å
 {

6084 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS
 = 1<<0,

6085 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS2
 = 1<<1,

6086 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_P2P
 = 1<<2,

6087 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_80211U
 = 1<<3,

6096 
	e∆80211_c⁄√˘_Áûed_ªas⁄
 {

6097 
	mNL80211_CONN_FAIL_MAX_CLIENTS
,

6098 
	mNL80211_CONN_FAIL_BLOCKED_CLIENT
,

6109 
	e∆80211_timeout_ªas⁄
 {

6110 
	mNL80211_TIMEOUT_UNSPECIFIED
,

6111 
	mNL80211_TIMEOUT_SCAN
,

6112 
	mNL80211_TIMEOUT_AUTH
,

6113 
	mNL80211_TIMEOUT_ASSOC
,

6180 
	e∆80211_sˇn_Êags
 {

6181 
	mNL80211_SCAN_FLAG_LOW_PRIORITY
 = 1<<0,

6182 
	mNL80211_SCAN_FLAG_FLUSH
 = 1<<1,

6183 
	mNL80211_SCAN_FLAG_AP
 = 1<<2,

6184 
	mNL80211_SCAN_FLAG_RANDOM_ADDR
 = 1<<3,

6185 
	mNL80211_SCAN_FLAG_FILS_MAX_CHANNEL_TIME
 = 1<<4,

6186 
	mNL80211_SCAN_FLAG_ACCEPT_BCAST_PROBE_RESP
 = 1<<5,

6187 
	mNL80211_SCAN_FLAG_OCE_PROBE_REQ_HIGH_TX_RATE
 = 1<<6,

6188 
	mNL80211_SCAN_FLAG_OCE_PROBE_REQ_DEFERRAL_SUPPRESSION
 = 1<<7,

6189 
	mNL80211_SCAN_FLAG_LOW_SPAN
 = 1<<8,

6190 
	mNL80211_SCAN_FLAG_LOW_POWER
 = 1<<9,

6191 
	mNL80211_SCAN_FLAG_HIGH_ACCURACY
 = 1<<10,

6192 
	mNL80211_SCAN_FLAG_RANDOM_SN
 = 1<<11,

6193 
	mNL80211_SCAN_FLAG_MIN_PREQ_CONTENT
 = 1<<12,

6194 
	mNL80211_SCAN_FLAG_FREQ_KHZ
 = 1<<13,

6195 
	mNL80211_SCAN_FLAG_COLOCATED_6GHZ
 = 1<<14,

6211 
	e∆80211_a˛_pﬁicy
 {

6212 
	mNL80211_ACL_POLICY_ACCEPT_UNLESS_LISTED
,

6213 
	mNL80211_ACL_POLICY_DENY_UNLESS_LISTED
,

6226 
	e∆80211_smps_mode
 {

6227 
	mNL80211_SMPS_OFF
,

6228 
	mNL80211_SMPS_STATIC
,

6229 
	mNL80211_SMPS_DYNAMIC
,

6231 
	m__NL80211_SMPS_AFTER_LAST
,

6232 
	mNL80211_SMPS_MAX
 = 
__NL80211_SMPS_AFTER_LAST
 - 1

6256 
	e∆80211_ød¨_evít
 {

6257 
	mNL80211_RADAR_DETECTED
,

6258 
	mNL80211_RADAR_CAC_FINISHED
,

6259 
	mNL80211_RADAR_CAC_ABORTED
,

6260 
	mNL80211_RADAR_NOP_FINISHED
,

6261 
	mNL80211_RADAR_PRE_CAC_EXPIRED
,

6262 
	mNL80211_RADAR_CAC_STARTED
,

6276 
	e∆80211_dfs_°©e
 {

6277 
	mNL80211_DFS_USABLE
,

6278 
	mNL80211_DFS_UNAVAILABLE
,

6279 
	mNL80211_DFS_AVAILABLE
,

6290 
	e∆80211_¥Ÿocﬁ_„©uªs
 {

6291 
	mNL80211_PROTOCOL_FEATURE_SPLIT_WIPHY_DUMP
 = 1 << 0,

6303 
	e∆80211_¸ô_¥Ÿo_id
 {

6304 
	mNL80211_CRIT_PROTO_UNSPEC
,

6305 
	mNL80211_CRIT_PROTO_DHCP
,

6306 
	mNL80211_CRIT_PROTO_EAPOL
,

6307 
	mNL80211_CRIT_PROTO_APIPA
,

6309 
	mNUM_NL80211_CRIT_PROTO


6313 
	#NL80211_CRIT_PROTO_MAX_DURATION
 5000

	)

6326 
	e∆80211_rxmgmt_Êags
 {

6327 
	mNL80211_RXMGMT_FLAG_ANSWERED
 = 1 << 0,

6328 
	mNL80211_RXMGMT_FLAG_EXTERNAL_AUTH
 = 1 << 1,

6336 
	#NL80211_VENDOR_ID_IS_LINUX
 0x80000000

	)

6346 
	s∆80211_víd‹_cmd_öfo
 {

6347 
__u32
 
	mvíd‹_id
;

6348 
__u32
 
	msubcmd
;

6362 
	e∆80211_tdls_≥î_ˇ∑bûôy
 {

6363 
	mNL80211_TDLS_PEER_HT
 = 1<<0,

6364 
	mNL80211_TDLS_PEER_VHT
 = 1<<1,

6365 
	mNL80211_TDLS_PEER_WMM
 = 1<<2,

6366 
	mNL80211_TDLS_PEER_HE
 = 1<<3,

6382 
	e∆80211_sched_sˇn_∂™
 {

6383 
	m__NL80211_SCHED_SCAN_PLAN_INVALID
,

6384 
	mNL80211_SCHED_SCAN_PLAN_INTERVAL
,

6385 
	mNL80211_SCHED_SCAN_PLAN_ITERATIONS
,

6388 
	m__NL80211_SCHED_SCAN_PLAN_AFTER_LAST
,

6389 
	mNL80211_SCHED_SCAN_PLAN_MAX
 =

6390 
__NL80211_SCHED_SCAN_PLAN_AFTER_LAST
 - 1

6400 
	s∆80211_bss_£À˘_rssi_adju°
 {

6401 
__u8
 
	mb™d
;

6402 
__s8
 
	mdñè
;

6403 } 
__©åibuã__
((
∑cked
));

6427 
	e∆80211_bss_£À˘_©å
 {

6428 
	m__NL80211_BSS_SELECT_ATTR_INVALID
,

6429 
	mNL80211_BSS_SELECT_ATTR_RSSI
,

6430 
	mNL80211_BSS_SELECT_ATTR_BAND_PREF
,

6431 
	mNL80211_BSS_SELECT_ATTR_RSSI_ADJUST
,

6434 
	m__NL80211_BSS_SELECT_ATTR_AFTER_LAST
,

6435 
	mNL80211_BSS_SELECT_ATTR_MAX
 = 
__NL80211_BSS_SELECT_ATTR_AFTER_LAST
 - 1

6447 
	e∆80211_«n_fun˘i⁄_ty≥
 {

6448 
	mNL80211_NAN_FUNC_PUBLISH
,

6449 
	mNL80211_NAN_FUNC_SUBSCRIBE
,

6450 
	mNL80211_NAN_FUNC_FOLLOW_UP
,

6453 
	m__NL80211_NAN_FUNC_TYPE_AFTER_LAST
,

6454 
	mNL80211_NAN_FUNC_MAX_TYPE
 = 
__NL80211_NAN_FUNC_TYPE_AFTER_LAST
 - 1,

6465 
	e∆80211_«n_publish_ty≥
 {

6466 
	mNL80211_NAN_SOLICITED_PUBLISH
 = 1 << 0,

6467 
	mNL80211_NAN_UNSOLICITED_PUBLISH
 = 1 << 1,

6479 
	e∆80211_«n_func_ãrm_ªas⁄
 {

6480 
	mNL80211_NAN_FUNC_TERM_REASON_USER_REQUEST
,

6481 
	mNL80211_NAN_FUNC_TERM_REASON_TTL_EXPIRED
,

6482 
	mNL80211_NAN_FUNC_TERM_REASON_ERROR
,

6485 
	#NL80211_NAN_FUNC_SERVICE_ID_LEN
 6

	)

6486 
	#NL80211_NAN_FUNC_SERVICE_SPEC_INFO_MAX_LEN
 0xff

	)

6487 
	#NL80211_NAN_FUNC_SRF_MAX_LEN
 0xff

	)

6531 
	e∆80211_«n_func_©åibuãs
 {

6532 
	m__NL80211_NAN_FUNC_INVALID
,

6533 
	mNL80211_NAN_FUNC_TYPE
,

6534 
	mNL80211_NAN_FUNC_SERVICE_ID
,

6535 
	mNL80211_NAN_FUNC_PUBLISH_TYPE
,

6536 
	mNL80211_NAN_FUNC_PUBLISH_BCAST
,

6537 
	mNL80211_NAN_FUNC_SUBSCRIBE_ACTIVE
,

6538 
	mNL80211_NAN_FUNC_FOLLOW_UP_ID
,

6539 
	mNL80211_NAN_FUNC_FOLLOW_UP_REQ_ID
,

6540 
	mNL80211_NAN_FUNC_FOLLOW_UP_DEST
,

6541 
	mNL80211_NAN_FUNC_CLOSE_RANGE
,

6542 
	mNL80211_NAN_FUNC_TTL
,

6543 
	mNL80211_NAN_FUNC_SERVICE_INFO
,

6544 
	mNL80211_NAN_FUNC_SRF
,

6545 
	mNL80211_NAN_FUNC_RX_MATCH_FILTER
,

6546 
	mNL80211_NAN_FUNC_TX_MATCH_FILTER
,

6547 
	mNL80211_NAN_FUNC_INSTANCE_ID
,

6548 
	mNL80211_NAN_FUNC_TERM_REASON
,

6551 
	mNUM_NL80211_NAN_FUNC_ATTR
,

6552 
	mNL80211_NAN_FUNC_ATTR_MAX
 = 
NUM_NL80211_NAN_FUNC_ATTR
 - 1

6570 
	e∆80211_«n_§f_©åibuãs
 {

6571 
	m__NL80211_NAN_SRF_INVALID
,

6572 
	mNL80211_NAN_SRF_INCLUDE
,

6573 
	mNL80211_NAN_SRF_BF
,

6574 
	mNL80211_NAN_SRF_BF_IDX
,

6575 
	mNL80211_NAN_SRF_MAC_ADDRS
,

6578 
	mNUM_NL80211_NAN_SRF_ATTR
,

6579 
	mNL80211_NAN_SRF_ATTR_MAX
 = 
NUM_NL80211_NAN_SRF_ATTR
 - 1,

6595 
	e∆80211_«n_m©ch_©åibuãs
 {

6596 
	m__NL80211_NAN_MATCH_INVALID
,

6597 
	mNL80211_NAN_MATCH_FUNC_LOCAL
,

6598 
	mNL80211_NAN_MATCH_FUNC_PEER
,

6601 
	mNUM_NL80211_NAN_MATCH_ATTR
,

6602 
	mNL80211_NAN_MATCH_ATTR_MAX
 = 
NUM_NL80211_NAN_MATCH_ATTR
 - 1

6611 
	e∆80211_exã∫Æ_auth_a˘i⁄
 {

6612 
	mNL80211_EXTERNAL_AUTH_START
,

6613 
	mNL80211_EXTERNAL_AUTH_ABORT
,

6630 
	e∆80211_·m_ª•⁄dî_©åibuãs
 {

6631 
	m__NL80211_FTM_RESP_ATTR_INVALID
,

6633 
	mNL80211_FTM_RESP_ATTR_ENABLED
,

6634 
	mNL80211_FTM_RESP_ATTR_LCI
,

6635 
	mNL80211_FTM_RESP_ATTR_CIVICLOC
,

6638 
	m__NL80211_FTM_RESP_ATTR_LAST
,

6639 
	mNL80211_FTM_RESP_ATTR_MAX
 = 
__NL80211_FTM_RESP_ATTR_LAST
 - 1,

6670 
	e∆80211_·m_ª•⁄dî_°©s
 {

6671 
	m__NL80211_FTM_STATS_INVALID
,

6672 
	mNL80211_FTM_STATS_SUCCESS_NUM
,

6673 
	mNL80211_FTM_STATS_PARTIAL_NUM
,

6674 
	mNL80211_FTM_STATS_FAILED_NUM
,

6675 
	mNL80211_FTM_STATS_ASAP_NUM
,

6676 
	mNL80211_FTM_STATS_NON_ASAP_NUM
,

6677 
	mNL80211_FTM_STATS_TOTAL_DURATION_MSEC
,

6678 
	mNL80211_FTM_STATS_UNKNOWN_TRIGGERS_NUM
,

6679 
	mNL80211_FTM_STATS_RESCHEDULE_REQUESTS_NUM
,

6680 
	mNL80211_FTM_STATS_OUT_OF_WINDOW_TRIGGERS_NUM
,

6681 
	mNL80211_FTM_STATS_PAD
,

6684 
	m__NL80211_FTM_STATS_AFTER_LAST
,

6685 
	mNL80211_FTM_STATS_MAX
 = 
__NL80211_FTM_STATS_AFTER_LAST
 - 1

6696 
	e∆80211_¥ómbÀ
 {

6697 
	mNL80211_PREAMBLE_LEGACY
,

6698 
	mNL80211_PREAMBLE_HT
,

6699 
	mNL80211_PREAMBLE_VHT
,

6700 
	mNL80211_PREAMBLE_DMG
,

6701 
	mNL80211_PREAMBLE_HE
,

6714 
	e∆80211_≥î_mósuªmít_ty≥
 {

6715 
	mNL80211_PMSR_TYPE_INVALID
,

6717 
	mNL80211_PMSR_TYPE_FTM
,

6719 
	mNUM_NL80211_PMSR_TYPES
,

6720 
	mNL80211_PMSR_TYPE_MAX
 = 
NUM_NL80211_PMSR_TYPES
 - 1

6731 
	e∆80211_≥î_mósuªmít_°©us
 {

6732 
	mNL80211_PMSR_STATUS_SUCCESS
,

6733 
	mNL80211_PMSR_STATUS_REFUSED
,

6734 
	mNL80211_PMSR_STATUS_TIMEOUT
,

6735 
	mNL80211_PMSR_STATUS_FAILURE
,

6751 
	e∆80211_≥î_mósuªmít_ªq
 {

6752 
	m__NL80211_PMSR_REQ_ATTR_INVALID
,

6754 
	mNL80211_PMSR_REQ_ATTR_DATA
,

6755 
	mNL80211_PMSR_REQ_ATTR_GET_AP_TSF
,

6758 
	mNUM_NL80211_PMSR_REQ_ATTRS
,

6759 
	mNL80211_PMSR_REQ_ATTR_MAX
 = 
NUM_NL80211_PMSR_REQ_ATTRS
 - 1

6787 
	e∆80211_≥î_mósuªmít_ª•
 {

6788 
	m__NL80211_PMSR_RESP_ATTR_INVALID
,

6790 
	mNL80211_PMSR_RESP_ATTR_DATA
,

6791 
	mNL80211_PMSR_RESP_ATTR_STATUS
,

6792 
	mNL80211_PMSR_RESP_ATTR_HOST_TIME
,

6793 
	mNL80211_PMSR_RESP_ATTR_AP_TSF
,

6794 
	mNL80211_PMSR_RESP_ATTR_FINAL
,

6795 
	mNL80211_PMSR_RESP_ATTR_PAD
,

6798 
	mNUM_NL80211_PMSR_RESP_ATTRS
,

6799 
	mNL80211_PMSR_RESP_ATTR_MAX
 = 
NUM_NL80211_PMSR_RESP_ATTRS
 - 1

6819 
	e∆80211_≥î_mósuªmít_≥î_©ås
 {

6820 
	m__NL80211_PMSR_PEER_ATTR_INVALID
,

6822 
	mNL80211_PMSR_PEER_ATTR_ADDR
,

6823 
	mNL80211_PMSR_PEER_ATTR_CHAN
,

6824 
	mNL80211_PMSR_PEER_ATTR_REQ
,

6825 
	mNL80211_PMSR_PEER_ATTR_RESP
,

6828 
	mNUM_NL80211_PMSR_PEER_ATTRS
,

6829 
	mNL80211_PMSR_PEER_ATTR_MAX
 = 
NUM_NL80211_PMSR_PEER_ATTRS
 - 1,

6856 
	e∆80211_≥î_mósuªmít_©ås
 {

6857 
	m__NL80211_PMSR_ATTR_INVALID
,

6859 
	mNL80211_PMSR_ATTR_MAX_PEERS
,

6860 
	mNL80211_PMSR_ATTR_REPORT_AP_TSF
,

6861 
	mNL80211_PMSR_ATTR_RANDOMIZE_MAC_ADDR
,

6862 
	mNL80211_PMSR_ATTR_TYPE_CAPA
,

6863 
	mNL80211_PMSR_ATTR_PEERS
,

6866 
	mNUM_NL80211_PMSR_ATTR
,

6867 
	mNL80211_PMSR_ATTR_MAX
 = 
NUM_NL80211_PMSR_ATTR
 - 1

6902 
	e∆80211_≥î_mósuªmít_·m_ˇ∑
 {

6903 
	m__NL80211_PMSR_FTM_CAPA_ATTR_INVALID
,

6905 
	mNL80211_PMSR_FTM_CAPA_ATTR_ASAP
,

6906 
	mNL80211_PMSR_FTM_CAPA_ATTR_NON_ASAP
,

6907 
	mNL80211_PMSR_FTM_CAPA_ATTR_REQ_LCI
,

6908 
	mNL80211_PMSR_FTM_CAPA_ATTR_REQ_CIVICLOC
,

6909 
	mNL80211_PMSR_FTM_CAPA_ATTR_PREAMBLES
,

6910 
	mNL80211_PMSR_FTM_CAPA_ATTR_BANDWIDTHS
,

6911 
	mNL80211_PMSR_FTM_CAPA_ATTR_MAX_BURSTS_EXPONENT
,

6912 
	mNL80211_PMSR_FTM_CAPA_ATTR_MAX_FTMS_PER_BURST
,

6913 
	mNL80211_PMSR_FTM_CAPA_ATTR_TRIGGER_BASED
,

6914 
	mNL80211_PMSR_FTM_CAPA_ATTR_NON_TRIGGER_BASED
,

6917 
	mNUM_NL80211_PMSR_FTM_CAPA_ATTR
,

6918 
	mNL80211_PMSR_FTM_CAPA_ATTR_MAX
 = 
NUM_NL80211_PMSR_FTM_CAPA_ATTR
 - 1

6968 
	e∆80211_≥î_mósuªmít_·m_ªq
 {

6969 
	m__NL80211_PMSR_FTM_REQ_ATTR_INVALID
,

6971 
	mNL80211_PMSR_FTM_REQ_ATTR_ASAP
,

6972 
	mNL80211_PMSR_FTM_REQ_ATTR_PREAMBLE
,

6973 
	mNL80211_PMSR_FTM_REQ_ATTR_NUM_BURSTS_EXP
,

6974 
	mNL80211_PMSR_FTM_REQ_ATTR_BURST_PERIOD
,

6975 
	mNL80211_PMSR_FTM_REQ_ATTR_BURST_DURATION
,

6976 
	mNL80211_PMSR_FTM_REQ_ATTR_FTMS_PER_BURST
,

6977 
	mNL80211_PMSR_FTM_REQ_ATTR_NUM_FTMR_RETRIES
,

6978 
	mNL80211_PMSR_FTM_REQ_ATTR_REQUEST_LCI
,

6979 
	mNL80211_PMSR_FTM_REQ_ATTR_REQUEST_CIVICLOC
,

6980 
	mNL80211_PMSR_FTM_REQ_ATTR_TRIGGER_BASED
,

6981 
	mNL80211_PMSR_FTM_REQ_ATTR_NON_TRIGGER_BASED
,

6982 
	mNL80211_PMSR_FTM_REQ_ATTR_LMR_FEEDBACK
,

6983 
	mNL80211_PMSR_FTM_REQ_ATTR_BSS_COLOR
,

6986 
	mNUM_NL80211_PMSR_FTM_REQ_ATTR
,

6987 
	mNL80211_PMSR_FTM_REQ_ATTR_MAX
 = 
NUM_NL80211_PMSR_FTM_REQ_ATTR
 - 1

7006 
	e∆80211_≥î_mósuªmít_·m_Áûuª_ªas⁄s
 {

7007 
	mNL80211_PMSR_FTM_FAILURE_UNSPECIFIED
,

7008 
	mNL80211_PMSR_FTM_FAILURE_NO_RESPONSE
,

7009 
	mNL80211_PMSR_FTM_FAILURE_REJECTED
,

7010 
	mNL80211_PMSR_FTM_FAILURE_WRONG_CHANNEL
,

7011 
	mNL80211_PMSR_FTM_FAILURE_PEER_NOT_CAPABLE
,

7012 
	mNL80211_PMSR_FTM_FAILURE_INVALID_TIMESTAMP
,

7013 
	mNL80211_PMSR_FTM_FAILURE_PEER_BUSY
,

7014 
	mNL80211_PMSR_FTM_FAILURE_BAD_CHANGED_PARAMS
,

7072 
	e∆80211_≥î_mósuªmít_·m_ª•
 {

7073 
	m__NL80211_PMSR_FTM_RESP_ATTR_INVALID
,

7075 
	mNL80211_PMSR_FTM_RESP_ATTR_FAIL_REASON
,

7076 
	mNL80211_PMSR_FTM_RESP_ATTR_BURST_INDEX
,

7077 
	mNL80211_PMSR_FTM_RESP_ATTR_NUM_FTMR_ATTEMPTS
,

7078 
	mNL80211_PMSR_FTM_RESP_ATTR_NUM_FTMR_SUCCESSES
,

7079 
	mNL80211_PMSR_FTM_RESP_ATTR_BUSY_RETRY_TIME
,

7080 
	mNL80211_PMSR_FTM_RESP_ATTR_NUM_BURSTS_EXP
,

7081 
	mNL80211_PMSR_FTM_RESP_ATTR_BURST_DURATION
,

7082 
	mNL80211_PMSR_FTM_RESP_ATTR_FTMS_PER_BURST
,

7083 
	mNL80211_PMSR_FTM_RESP_ATTR_RSSI_AVG
,

7084 
	mNL80211_PMSR_FTM_RESP_ATTR_RSSI_SPREAD
,

7085 
	mNL80211_PMSR_FTM_RESP_ATTR_TX_RATE
,

7086 
	mNL80211_PMSR_FTM_RESP_ATTR_RX_RATE
,

7087 
	mNL80211_PMSR_FTM_RESP_ATTR_RTT_AVG
,

7088 
	mNL80211_PMSR_FTM_RESP_ATTR_RTT_VARIANCE
,

7089 
	mNL80211_PMSR_FTM_RESP_ATTR_RTT_SPREAD
,

7090 
	mNL80211_PMSR_FTM_RESP_ATTR_DIST_AVG
,

7091 
	mNL80211_PMSR_FTM_RESP_ATTR_DIST_VARIANCE
,

7092 
	mNL80211_PMSR_FTM_RESP_ATTR_DIST_SPREAD
,

7093 
	mNL80211_PMSR_FTM_RESP_ATTR_LCI
,

7094 
	mNL80211_PMSR_FTM_RESP_ATTR_CIVICLOC
,

7095 
	mNL80211_PMSR_FTM_RESP_ATTR_PAD
,

7098 
	mNUM_NL80211_PMSR_FTM_RESP_ATTR
,

7099 
	mNL80211_PMSR_FTM_RESP_ATTR_MAX
 = 
NUM_NL80211_PMSR_FTM_RESP_ATTR
 - 1

7119 
	e∆80211_obss_pd_©åibuãs
 {

7120 
	m__NL80211_HE_OBSS_PD_ATTR_INVALID
,

7122 
	mNL80211_HE_OBSS_PD_ATTR_MIN_OFFSET
,

7123 
	mNL80211_HE_OBSS_PD_ATTR_MAX_OFFSET
,

7124 
	mNL80211_HE_OBSS_PD_ATTR_NON_SRG_MAX_OFFSET
,

7125 
	mNL80211_HE_OBSS_PD_ATTR_BSS_COLOR_BITMAP
,

7126 
	mNL80211_HE_OBSS_PD_ATTR_PARTIAL_BSSID_BITMAP
,

7127 
	mNL80211_HE_OBSS_PD_ATTR_SR_CTRL
,

7130 
	m__NL80211_HE_OBSS_PD_ATTR_LAST
,

7131 
	mNL80211_HE_OBSS_PD_ATTR_MAX
 = 
__NL80211_HE_OBSS_PD_ATTR_LAST
 - 1,

7145 
	e∆80211_bss_cﬁ‹_©åibuãs
 {

7146 
	m__NL80211_HE_BSS_COLOR_ATTR_INVALID
,

7148 
	mNL80211_HE_BSS_COLOR_ATTR_COLOR
,

7149 
	mNL80211_HE_BSS_COLOR_ATTR_DISABLED
,

7150 
	mNL80211_HE_BSS_COLOR_ATTR_PARTIAL
,

7153 
	m__NL80211_HE_BSS_COLOR_ATTR_LAST
,

7154 
	mNL80211_HE_BSS_COLOR_ATTR_MAX
 = 
__NL80211_HE_BSS_COLOR_ATTR_LAST
 - 1,

7170 
	e∆80211_i·y≥_akm_©åibuãs
 {

7171 
	m__NL80211_IFTYPE_AKM_ATTR_INVALID
,

7173 
	mNL80211_IFTYPE_AKM_ATTR_IFTYPES
,

7174 
	mNL80211_IFTYPE_AKM_ATTR_SUITES
,

7177 
	m__NL80211_IFTYPE_AKM_ATTR_LAST
,

7178 
	mNL80211_IFTYPE_AKM_ATTR_MAX
 = 
__NL80211_IFTYPE_AKM_ATTR_LAST
 - 1,

7197 
	e∆80211_fûs_discovîy_©åibuãs
 {

7198 
	m__NL80211_FILS_DISCOVERY_ATTR_INVALID
,

7200 
	mNL80211_FILS_DISCOVERY_ATTR_INT_MIN
,

7201 
	mNL80211_FILS_DISCOVERY_ATTR_INT_MAX
,

7202 
	mNL80211_FILS_DISCOVERY_ATTR_TMPL
,

7205 
	m__NL80211_FILS_DISCOVERY_ATTR_LAST
,

7206 
	mNL80211_FILS_DISCOVERY_ATTR_MAX
 = 
__NL80211_FILS_DISCOVERY_ATTR_LAST
 - 1

7213 
	#NL80211_FILS_DISCOVERY_TMPL_MIN_LEN
 42

	)

7230 
	e∆80211_unsﬁ_bˇ°_¥obe_ª•_©åibuãs
 {

7231 
	m__NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_INVALID
,

7233 
	mNL80211_UNSOL_BCAST_PROBE_RESP_ATTR_INT
,

7234 
	mNL80211_UNSOL_BCAST_PROBE_RESP_ATTR_TMPL
,

7237 
	m__NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_LAST
,

7238 
	mNL80211_UNSOL_BCAST_PROBE_RESP_ATTR_MAX
 =

7239 
__NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_LAST
 - 1

7254 
	e∆80211_ße_pwe_mech™ism
 {

7255 
	mNL80211_SAE_PWE_UNSPECIFIED
,

7256 
	mNL80211_SAE_PWE_HUNT_AND_PECK
,

7257 
	mNL80211_SAE_PWE_HASH_TO_ELEMENT
,

7258 
	mNL80211_SAE_PWE_BOTH
,

7267 
	e∆80211_ßr_ty≥
 {

7268 
	mNL80211_SAR_TYPE_POWER
,

7273 
	mNUM_NL80211_SAR_TYPE
,

7297 
	e∆80211_ßr_©ås
 {

7298 
	m__NL80211_SAR_ATTR_INVALID
,

7300 
	mNL80211_SAR_ATTR_TYPE
,

7301 
	mNL80211_SAR_ATTR_SPECS
,

7303 
	m__NL80211_SAR_ATTR_LAST
,

7304 
	mNL80211_SAR_ATTR_MAX
 = 
__NL80211_SAR_ATTR_LAST
 - 1,

7340 
	e∆80211_ßr_•ecs_©ås
 {

7341 
	m__NL80211_SAR_ATTR_SPECS_INVALID
,

7343 
	mNL80211_SAR_ATTR_SPECS_POWER
,

7344 
	mNL80211_SAR_ATTR_SPECS_RANGE_INDEX
,

7345 
	mNL80211_SAR_ATTR_SPECS_START_FREQ
,

7346 
	mNL80211_SAR_ATTR_SPECS_END_FREQ
,

7348 
	m__NL80211_SAR_ATTR_SPECS_LAST
,

7349 
	mNL80211_SAR_ATTR_SPECS_MAX
 = 
__NL80211_SAR_ATTR_SPECS_LAST
 - 1,

	@/usr/include/linux/random.h

8 #i‚de‡
_LINUX_RANDOM_H


9 
	#_LINUX_RANDOM_H


	)

11 
	~<löux/ty≥s.h
>

12 
	~<löux/io˘l.h
>

13 
	~<löux/úqƒ.h
>

18 
	#RNDGETENTCNT
 
	`_IOR
–'R', 0x00, )

	)

21 
	#RNDADDTOENTCNT
 
	`_IOW
–'R', 0x01, )

	)

24 
	#RNDGETPOOL
 
	`_IOR
–'R', 0x02, [2] )

	)

30 
	#RNDADDENTROPY
 
	`_IOW
–'R', 0x03, [2] )

	)

33 
	#RNDZAPENTCNT
 
	`_IO
–'R', 0x04 )

	)

36 
	#RNDCLEARPOOL
 
	`_IO
–'R', 0x06 )

	)

39 
	#RNDRESEEDCRNG
 
	`_IO
–'R', 0x07 )

	)

41 
	sønd_poﬁ_öfo
 {

42 
	míå›y_cou¡
;

43 
	mbuf_size
;

44 
__u32
 
	mbuf
[0];

54 
	#GRND_NONBLOCK
 0x0001

	)

55 
	#GRND_RANDOM
 0x0002

	)

56 
	#GRND_INSECURE
 0x0004

	)

	@/usr/include/linux/rfkill.h

18 #i‚de‡
__RFKILL_H


19 
	#__RFKILL_H


	)

22 
	~<löux/ty≥s.h
>

25 
	#RFKILL_STATE_SOFT_BLOCKED
 0

	)

26 
	#RFKILL_STATE_UNBLOCKED
 1

	)

27 
	#RFKILL_STATE_HARD_BLOCKED
 2

	)

43 
	erfkûl_ty≥
 {

44 
	mRFKILL_TYPE_ALL
 = 0,

45 
	mRFKILL_TYPE_WLAN
,

46 
	mRFKILL_TYPE_BLUETOOTH
,

47 
	mRFKILL_TYPE_UWB
,

48 
	mRFKILL_TYPE_WIMAX
,

49 
	mRFKILL_TYPE_WWAN
,

50 
	mRFKILL_TYPE_GPS
,

51 
	mRFKILL_TYPE_FM
,

52 
	mRFKILL_TYPE_NFC
,

53 
	mNUM_RFKILL_TYPES
,

65 
	erfkûl_›î©i⁄
 {

66 
	mRFKILL_OP_ADD
 = 0,

67 
	mRFKILL_OP_DEL
,

68 
	mRFKILL_OP_CHANGE
,

69 
	mRFKILL_OP_CHANGE_ALL
,

77 
	erfkûl_h¨d_block_ªas⁄s
 {

78 
	mRFKILL_HARD_BLOCK_SIGNAL
 = 1 << 0,

79 
	mRFKILL_HARD_BLOCK_NOT_OWNER
 = 1 << 1,

93 
	srfkûl_evít
 {

94 
__u32
 
	midx
;

95 
__u8
 
	mty≥
;

96 
__u8
 
	m›
;

97 
__u8
 
	mso·
;

98 
__u8
 
	mh¨d
;

99 } 
__©åibuã__
((
∑cked
));

116 
	srfkûl_evít_ext
 {

117 
__u32
 
	midx
;

118 
__u8
 
	mty≥
;

119 
__u8
 
	m›
;

120 
__u8
 
	mso·
;

121 
__u8
 
	mh¨d
;

128 
__u8
 
	mh¨d_block_ªas⁄s
;

129 } 
__©åibuã__
((
∑cked
));

172 
	#RFKILL_EVENT_SIZE_V1
 (
rfkûl_evít
)

	)

175 
	#RFKILL_IOC_MAGIC
 'R'

	)

176 
	#RFKILL_IOC_NOINPUT
 1

	)

177 
	#RFKILL_IOCTL_NOINPUT
 
	`_IO
(
RFKILL_IOC_MAGIC
, 
RFKILL_IOC_NOINPUT
)

	)

	@/usr/include/linux/rtnetlink.h

2 #i‚de‡
__LINUX_RTNETLINK_H


3 
	#__LINUX_RTNETLINK_H


	)

5 
	~<löux/ty≥s.h
>

6 
	~<löux/√éök.h
>

7 
	~<löux/if_lök.h
>

8 
	~<löux/if_addr.h
>

9 
	~<löux/√ighbour.h
>

14 
	#RTNL_FAMILY_IPMR
 128

	)

15 
	#RTNL_FAMILY_IP6MR
 129

	)

16 
	#RTNL_FAMILY_MAX
 129

	)

25 
	mRTM_BASE
 = 16,

26 
	#RTM_BASE
 
RTM_BASE


	)

28 
	mRTM_NEWLINK
 = 16,

29 
	#RTM_NEWLINK
 
RTM_NEWLINK


	)

30 
	mRTM_DELLINK
,

31 
	#RTM_DELLINK
 
RTM_DELLINK


	)

32 
	mRTM_GETLINK
,

33 
	#RTM_GETLINK
 
RTM_GETLINK


	)

34 
	mRTM_SETLINK
,

35 
	#RTM_SETLINK
 
RTM_SETLINK


	)

37 
	mRTM_NEWADDR
 = 20,

38 
	#RTM_NEWADDR
 
RTM_NEWADDR


	)

39 
	mRTM_DELADDR
,

40 
	#RTM_DELADDR
 
RTM_DELADDR


	)

41 
	mRTM_GETADDR
,

42 
	#RTM_GETADDR
 
RTM_GETADDR


	)

44 
	mRTM_NEWROUTE
 = 24,

45 
	#RTM_NEWROUTE
 
RTM_NEWROUTE


	)

46 
	mRTM_DELROUTE
,

47 
	#RTM_DELROUTE
 
RTM_DELROUTE


	)

48 
	mRTM_GETROUTE
,

49 
	#RTM_GETROUTE
 
RTM_GETROUTE


	)

51 
	mRTM_NEWNEIGH
 = 28,

52 
	#RTM_NEWNEIGH
 
RTM_NEWNEIGH


	)

53 
	mRTM_DELNEIGH
,

54 
	#RTM_DELNEIGH
 
RTM_DELNEIGH


	)

55 
	mRTM_GETNEIGH
,

56 
	#RTM_GETNEIGH
 
RTM_GETNEIGH


	)

58 
	mRTM_NEWRULE
 = 32,

59 
	#RTM_NEWRULE
 
RTM_NEWRULE


	)

60 
	mRTM_DELRULE
,

61 
	#RTM_DELRULE
 
RTM_DELRULE


	)

62 
	mRTM_GETRULE
,

63 
	#RTM_GETRULE
 
RTM_GETRULE


	)

65 
	mRTM_NEWQDISC
 = 36,

66 
	#RTM_NEWQDISC
 
RTM_NEWQDISC


	)

67 
	mRTM_DELQDISC
,

68 
	#RTM_DELQDISC
 
RTM_DELQDISC


	)

69 
	mRTM_GETQDISC
,

70 
	#RTM_GETQDISC
 
RTM_GETQDISC


	)

72 
	mRTM_NEWTCLASS
 = 40,

73 
	#RTM_NEWTCLASS
 
RTM_NEWTCLASS


	)

74 
	mRTM_DELTCLASS
,

75 
	#RTM_DELTCLASS
 
RTM_DELTCLASS


	)

76 
	mRTM_GETTCLASS
,

77 
	#RTM_GETTCLASS
 
RTM_GETTCLASS


	)

79 
	mRTM_NEWTFILTER
 = 44,

80 
	#RTM_NEWTFILTER
 
RTM_NEWTFILTER


	)

81 
	mRTM_DELTFILTER
,

82 
	#RTM_DELTFILTER
 
RTM_DELTFILTER


	)

83 
	mRTM_GETTFILTER
,

84 
	#RTM_GETTFILTER
 
RTM_GETTFILTER


	)

86 
	mRTM_NEWACTION
 = 48,

87 
	#RTM_NEWACTION
 
RTM_NEWACTION


	)

88 
	mRTM_DELACTION
,

89 
	#RTM_DELACTION
 
RTM_DELACTION


	)

90 
	mRTM_GETACTION
,

91 
	#RTM_GETACTION
 
RTM_GETACTION


	)

93 
	mRTM_NEWPREFIX
 = 52,

94 
	#RTM_NEWPREFIX
 
RTM_NEWPREFIX


	)

96 
	mRTM_GETMULTICAST
 = 58,

97 
	#RTM_GETMULTICAST
 
RTM_GETMULTICAST


	)

99 
	mRTM_GETANYCAST
 = 62,

100 
	#RTM_GETANYCAST
 
RTM_GETANYCAST


	)

102 
	mRTM_NEWNEIGHTBL
 = 64,

103 
	#RTM_NEWNEIGHTBL
 
RTM_NEWNEIGHTBL


	)

104 
	mRTM_GETNEIGHTBL
 = 66,

105 
	#RTM_GETNEIGHTBL
 
RTM_GETNEIGHTBL


	)

106 
	mRTM_SETNEIGHTBL
,

107 
	#RTM_SETNEIGHTBL
 
RTM_SETNEIGHTBL


	)

109 
	mRTM_NEWNDUSEROPT
 = 68,

110 
	#RTM_NEWNDUSEROPT
 
RTM_NEWNDUSEROPT


	)

112 
	mRTM_NEWADDRLABEL
 = 72,

113 
	#RTM_NEWADDRLABEL
 
RTM_NEWADDRLABEL


	)

114 
	mRTM_DELADDRLABEL
,

115 
	#RTM_DELADDRLABEL
 
RTM_DELADDRLABEL


	)

116 
	mRTM_GETADDRLABEL
,

117 
	#RTM_GETADDRLABEL
 
RTM_GETADDRLABEL


	)

119 
	mRTM_GETDCB
 = 78,

120 
	#RTM_GETDCB
 
RTM_GETDCB


	)

121 
	mRTM_SETDCB
,

122 
	#RTM_SETDCB
 
RTM_SETDCB


	)

124 
	mRTM_NEWNETCONF
 = 80,

125 
	#RTM_NEWNETCONF
 
RTM_NEWNETCONF


	)

126 
	mRTM_DELNETCONF
,

127 
	#RTM_DELNETCONF
 
RTM_DELNETCONF


	)

128 
	mRTM_GETNETCONF
 = 82,

129 
	#RTM_GETNETCONF
 
RTM_GETNETCONF


	)

131 
	mRTM_NEWMDB
 = 84,

132 
	#RTM_NEWMDB
 
RTM_NEWMDB


	)

133 
	mRTM_DELMDB
 = 85,

134 
	#RTM_DELMDB
 
RTM_DELMDB


	)

135 
	mRTM_GETMDB
 = 86,

136 
	#RTM_GETMDB
 
RTM_GETMDB


	)

138 
	mRTM_NEWNSID
 = 88,

139 
	#RTM_NEWNSID
 
RTM_NEWNSID


	)

140 
	mRTM_DELNSID
 = 89,

141 
	#RTM_DELNSID
 
RTM_DELNSID


	)

142 
	mRTM_GETNSID
 = 90,

143 
	#RTM_GETNSID
 
RTM_GETNSID


	)

145 
	mRTM_NEWSTATS
 = 92,

146 
	#RTM_NEWSTATS
 
RTM_NEWSTATS


	)

147 
	mRTM_GETSTATS
 = 94,

148 
	#RTM_GETSTATS
 
RTM_GETSTATS


	)

150 
	mRTM_NEWCACHEREPORT
 = 96,

151 
	#RTM_NEWCACHEREPORT
 
RTM_NEWCACHEREPORT


	)

153 
	mRTM_NEWCHAIN
 = 100,

154 
	#RTM_NEWCHAIN
 
RTM_NEWCHAIN


	)

155 
	mRTM_DELCHAIN
,

156 
	#RTM_DELCHAIN
 
RTM_DELCHAIN


	)

157 
	mRTM_GETCHAIN
,

158 
	#RTM_GETCHAIN
 
RTM_GETCHAIN


	)

160 
	mRTM_NEWNEXTHOP
 = 104,

161 
	#RTM_NEWNEXTHOP
 
RTM_NEWNEXTHOP


	)

162 
	mRTM_DELNEXTHOP
,

163 
	#RTM_DELNEXTHOP
 
RTM_DELNEXTHOP


	)

164 
	mRTM_GETNEXTHOP
,

165 
	#RTM_GETNEXTHOP
 
RTM_GETNEXTHOP


	)

167 
	mRTM_NEWLINKPROP
 = 108,

168 
	#RTM_NEWLINKPROP
 
RTM_NEWLINKPROP


	)

169 
	mRTM_DELLINKPROP
,

170 
	#RTM_DELLINKPROP
 
RTM_DELLINKPROP


	)

171 
	mRTM_GETLINKPROP
,

172 
	#RTM_GETLINKPROP
 
RTM_GETLINKPROP


	)

174 
	mRTM_NEWVLAN
 = 112,

175 
	#RTM_NEWNVLAN
 
RTM_NEWVLAN


	)

176 
	mRTM_DELVLAN
,

177 
	#RTM_DELVLAN
 
RTM_DELVLAN


	)

178 
	mRTM_GETVLAN
,

179 
	#RTM_GETVLAN
 
RTM_GETVLAN


	)

181 
	mRTM_NEWNEXTHOPBUCKET
 = 116,

182 
	#RTM_NEWNEXTHOPBUCKET
 
RTM_NEWNEXTHOPBUCKET


	)

183 
	mRTM_DELNEXTHOPBUCKET
,

184 
	#RTM_DELNEXTHOPBUCKET
 
RTM_DELNEXTHOPBUCKET


	)

185 
	mRTM_GETNEXTHOPBUCKET
,

186 
	#RTM_GETNEXTHOPBUCKET
 
RTM_GETNEXTHOPBUCKET


	)

188 
	m__RTM_MAX
,

189 
	#RTM_MAX
 (((
__RTM_MAX
 + 3Ë& ~3Ë- 1)

	)

192 
	#RTM_NR_MSGTYPES
 (
RTM_MAX
 + 1 - 
RTM_BASE
)

	)

193 
	#RTM_NR_FAMILIES
 (
RTM_NR_MSGTYPES
 >> 2)

	)

194 
	#RTM_FAM
(
cmd
Ë(((cmdË- 
RTM_BASE
Ë>> 2)

	)

202 
	sπ©å
 {

203 
	mπa_Àn
;

204 
	mπa_ty≥
;

209 
	#RTA_ALIGNTO
 4U

	)

210 
	#RTA_ALIGN
(
Àn
Ë–(÷í)+
RTA_ALIGNTO
-1Ë& ~(RTA_ALIGNTO-1Ë)

	)

211 
	#RTA_OK
(
πa
,
Àn
Ë(÷íË>()(
π©å
) && \

212 (
πa
)->
πa_Àn
 >(
π©å
) && \

213 (
πa
)->
πa_Àn
 <(
Àn
))

	)

214 
	#RTA_NEXT
(
πa
,
©åÀn
Ë(◊âæíË-
	`RTA_ALIGN
(‘è)->
πa_Àn
), \

215 (
π©å
*)(((*)(
πa
)Ë+ 
	`RTA_ALIGN
(‘è)->
πa_Àn
)))

	)

216 
	#RTA_LENGTH
(
Àn
Ë(
	`RTA_ALIGN
((
π©å
)Ë+ (Àn))

	)

217 
	#RTA_SPACE
(
Àn
Ë
	`RTA_ALIGN
(
	`RTA_LENGTH
÷í))

	)

218 
	#RTA_DATA
(
πa
Ë((*)(((*)‘è)Ë+ 
	`RTA_LENGTH
(0)))

	)

219 
	#RTA_PAYLOAD
(
πa
Ë(()(‘è)->
πa_Àn
Ë- 
	`RTA_LENGTH
(0))

	)

228 
	sπmsg
 {

229 
	mπm_Ámûy
;

230 
	mπm_d°_Àn
;

231 
	mπm_§c_Àn
;

232 
	mπm_tos
;

234 
	mπm_èbÀ
;

235 
	mπm_¥Ÿocﬁ
;

236 
	mπm_sc›e
;

237 
	mπm_ty≥
;

239 
	mπm_Êags
;

245 
	mRTN_UNSPEC
,

246 
	mRTN_UNICAST
,

247 
	mRTN_LOCAL
,

248 
	mRTN_BROADCAST
,

250 
	mRTN_ANYCAST
,

252 
	mRTN_MULTICAST
,

253 
	mRTN_BLACKHOLE
,

254 
	mRTN_UNREACHABLE
,

255 
	mRTN_PROHIBIT
,

256 
	mRTN_THROW
,

257 
	mRTN_NAT
,

258 
	mRTN_XRESOLVE
,

259 
	m__RTN_MAX


262 
	#RTN_MAX
 (
__RTN_MAX
 - 1)

	)

267 
	#RTPROT_UNSPEC
 0

	)

268 
	#RTPROT_REDIRECT
 1

	)

270 
	#RTPROT_KERNEL
 2

	)

271 
	#RTPROT_BOOT
 3

	)

272 
	#RTPROT_STATIC
 4

	)

281 
	#RTPROT_GATED
 8

	)

282 
	#RTPROT_RA
 9

	)

283 
	#RTPROT_MRT
 10

	)

284 
	#RTPROT_ZEBRA
 11

	)

285 
	#RTPROT_BIRD
 12

	)

286 
	#RTPROT_DNROUTED
 13

	)

287 
	#RTPROT_XORP
 14

	)

288 
	#RTPROT_NTK
 15

	)

289 
	#RTPROT_DHCP
 16

	)

290 
	#RTPROT_MROUTED
 17

	)

291 
	#RTPROT_KEEPALIVED
 18

	)

292 
	#RTPROT_BABEL
 42

	)

293 
	#RTPROT_OPENR
 99

	)

294 
	#RTPROT_BGP
 186

	)

295 
	#RTPROT_ISIS
 187

	)

296 
	#RTPROT_OSPF
 188

	)

297 
	#RTPROT_RIP
 189

	)

298 
	#RTPROT_EIGRP
 192

	)

311 
	eπ_sc›e_t
 {

312 
	mRT_SCOPE_UNIVERSE
=0,

314 
	mRT_SCOPE_SITE
=200,

315 
	mRT_SCOPE_LINK
=253,

316 
	mRT_SCOPE_HOST
=254,

317 
	mRT_SCOPE_NOWHERE
=255

322 
	#RTM_F_NOTIFY
 0x100

	)

323 
	#RTM_F_CLONED
 0x200

	)

324 
	#RTM_F_EQUALIZE
 0x400

	)

325 
	#RTM_F_PREFIX
 0x800

	)

326 
	#RTM_F_LOOKUP_TABLE
 0x1000

	)

327 
	#RTM_F_FIB_MATCH
 0x2000

	)

328 
	#RTM_F_OFFLOAD
 0x4000

	)

329 
	#RTM_F_TRAP
 0x8000

	)

330 
	#RTM_F_OFFLOAD_FAILED
 0x20000000

	)

338 
	eπ_˛ass_t
 {

339 
	mRT_TABLE_UNSPEC
=0,

341 
	mRT_TABLE_COMPAT
=252,

342 
	mRT_TABLE_DEFAULT
=253,

343 
	mRT_TABLE_MAIN
=254,

344 
	mRT_TABLE_LOCAL
=255,

345 
	mRT_TABLE_MAX
=0xFFFFFFFF

351 
	eπ©å_ty≥_t
 {

352 
	mRTA_UNSPEC
,

353 
	mRTA_DST
,

354 
	mRTA_SRC
,

355 
	mRTA_IIF
,

356 
	mRTA_OIF
,

357 
	mRTA_GATEWAY
,

358 
	mRTA_PRIORITY
,

359 
	mRTA_PREFSRC
,

360 
	mRTA_METRICS
,

361 
	mRTA_MULTIPATH
,

362 
	mRTA_PROTOINFO
,

363 
	mRTA_FLOW
,

364 
	mRTA_CACHEINFO
,

365 
	mRTA_SESSION
,

366 
	mRTA_MP_ALGO
,

367 
	mRTA_TABLE
,

368 
	mRTA_MARK
,

369 
	mRTA_MFC_STATS
,

370 
	mRTA_VIA
,

371 
	mRTA_NEWDST
,

372 
	mRTA_PREF
,

373 
	mRTA_ENCAP_TYPE
,

374 
	mRTA_ENCAP
,

375 
	mRTA_EXPIRES
,

376 
	mRTA_PAD
,

377 
	mRTA_UID
,

378 
	mRTA_TTL_PROPAGATE
,

379 
	mRTA_IP_PROTO
,

380 
	mRTA_SPORT
,

381 
	mRTA_DPORT
,

382 
	mRTA_NH_ID
,

383 
	m__RTA_MAX


386 
	#RTA_MAX
 (
__RTA_MAX
 - 1)

	)

388 
	#RTM_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
πmsg
))))

	)

389 
	#RTM_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
πmsg
))

	)

400 
	sπ√xth›
 {

401 
	mπnh_Àn
;

402 
	mπnh_Êags
;

403 
	mπnh_h›s
;

404 
	mπnh_ifödex
;

409 
	#RTNH_F_DEAD
 1

	)

410 
	#RTNH_F_PERVASIVE
 2

	)

411 
	#RTNH_F_ONLINK
 4

	)

412 
	#RTNH_F_OFFLOAD
 8

	)

413 
	#RTNH_F_LINKDOWN
 16

	)

414 
	#RTNH_F_UNRESOLVED
 32

	)

415 
	#RTNH_F_TRAP
 64

	)

417 
	#RTNH_COMPARE_MASK
 (
RTNH_F_DEAD
 | 
RTNH_F_LINKDOWN
 | \

418 
RTNH_F_OFFLOAD
 | 
RTNH_F_TRAP
)

	)

422 
	#RTNH_ALIGNTO
 4

	)

423 
	#RTNH_ALIGN
(
Àn
Ë–(÷í)+
RTNH_ALIGNTO
-1Ë& ~(RTNH_ALIGNTO-1Ë)

	)

424 
	#RTNH_OK
(
πnh
,
Àn
Ë(‘äh)->
πnh_Àn
 >(
π√xth›
) && \

425 (()(
πnh
)->
πnh_Àn
Ë<(
Àn
))

	)

426 
	#RTNH_NEXT
(
πnh
Ë((
π√xth›
*)(((*)‘äh)Ë+ 
	`RTNH_ALIGN
(‘äh)->
πnh_Àn
)))

	)

427 
	#RTNH_LENGTH
(
Àn
Ë(
	`RTNH_ALIGN
((
π√xth›
)Ë+ (Àn))

	)

428 
	#RTNH_SPACE
(
Àn
Ë
	`RTNH_ALIGN
(
	`RTNH_LENGTH
÷í))

	)

429 
	#RTNH_DATA
(
πnh
Ë((
π©å
*)(((*)‘äh)Ë+ 
	`RTNH_LENGTH
(0)))

	)

432 
	sπvü
 {

433 
__kî√l_ß_Ámûy_t
 
	mπvü_Ámûy
;

434 
__u8
 
	mπvü_addr
[0];

439 
	sπa_ˇcheöfo
 {

440 
__u32
 
	mπa_˛¡ªf
;

441 
__u32
 
	mπa_œ°u£
;

442 
__s32
 
	mπa_expúes
;

443 
__u32
 
	mπa_îr‹
;

444 
__u32
 
	mπa_u£d
;

446 
	#RTNETLINK_HAVE_PEERINFO
 1

	)

447 
__u32
 
	mπa_id
;

448 
__u32
 
	mπa_ts
;

449 
__u32
 
	mπa_tßge
;

455 
	mRTAX_UNSPEC
,

456 
	#RTAX_UNSPEC
 
RTAX_UNSPEC


	)

457 
	mRTAX_LOCK
,

458 
	#RTAX_LOCK
 
RTAX_LOCK


	)

459 
	mRTAX_MTU
,

460 
	#RTAX_MTU
 
RTAX_MTU


	)

461 
	mRTAX_WINDOW
,

462 
	#RTAX_WINDOW
 
RTAX_WINDOW


	)

463 
	mRTAX_RTT
,

464 
	#RTAX_RTT
 
RTAX_RTT


	)

465 
	mRTAX_RTTVAR
,

466 
	#RTAX_RTTVAR
 
RTAX_RTTVAR


	)

467 
	mRTAX_SSTHRESH
,

468 
	#RTAX_SSTHRESH
 
RTAX_SSTHRESH


	)

469 
	mRTAX_CWND
,

470 
	#RTAX_CWND
 
RTAX_CWND


	)

471 
	mRTAX_ADVMSS
,

472 
	#RTAX_ADVMSS
 
RTAX_ADVMSS


	)

473 
	mRTAX_REORDERING
,

474 
	#RTAX_REORDERING
 
RTAX_REORDERING


	)

475 
	mRTAX_HOPLIMIT
,

476 
	#RTAX_HOPLIMIT
 
RTAX_HOPLIMIT


	)

477 
	mRTAX_INITCWND
,

478 
	#RTAX_INITCWND
 
RTAX_INITCWND


	)

479 
	mRTAX_FEATURES
,

480 
	#RTAX_FEATURES
 
RTAX_FEATURES


	)

481 
	mRTAX_RTO_MIN
,

482 
	#RTAX_RTO_MIN
 
RTAX_RTO_MIN


	)

483 
	mRTAX_INITRWND
,

484 
	#RTAX_INITRWND
 
RTAX_INITRWND


	)

485 
	mRTAX_QUICKACK
,

486 
	#RTAX_QUICKACK
 
RTAX_QUICKACK


	)

487 
	mRTAX_CC_ALGO
,

488 
	#RTAX_CC_ALGO
 
RTAX_CC_ALGO


	)

489 
	mRTAX_FASTOPEN_NO_COOKIE
,

490 
	#RTAX_FASTOPEN_NO_COOKIE
 
RTAX_FASTOPEN_NO_COOKIE


	)

491 
	m__RTAX_MAX


494 
	#RTAX_MAX
 (
__RTAX_MAX
 - 1)

	)

496 
	#RTAX_FEATURE_ECN
 (1 << 0)

	)

497 
	#RTAX_FEATURE_SACK
 (1 << 1)

	)

498 
	#RTAX_FEATURE_TIMESTAMP
 (1 << 2)

	)

499 
	#RTAX_FEATURE_ALLFRAG
 (1 << 3)

	)

501 
	#RTAX_FEATURE_MASK
 (
RTAX_FEATURE_ECN
 | 
RTAX_FEATURE_SACK
 | \

502 
RTAX_FEATURE_TIMESTAMP
 | 
RTAX_FEATURE_ALLFRAG
)

	)

504 
	sπa_£ssi⁄
 {

505 
__u8
 
	m¥Ÿo
;

506 
__u8
 
	m∑d1
;

507 
__u16
 
	m∑d2
;

511 
__u16
 
	m•‹t
;

512 
__u16
 
	mdp‹t
;

513 } 
	mp‹ts
;

516 
__u8
 
	mty≥
;

517 
__u8
 
	mcode
;

518 
__u16
 
	midít
;

519 } 
	micm±
;

521 
__u32
 
	m•i
;

522 } 
	mu
;

525 
	sπa_mfc_°©s
 {

526 
__u64
 
	mmfcs_∑ckës
;

527 
__u64
 
	mmfcs_byãs
;

528 
__u64
 
	mmfcs_wr⁄g_if
;

535 
	sπgímsg
 {

536 
	mπgí_Ámûy
;

548 
	siföfomsg
 {

549 
	mifi_Ámûy
;

550 
	m__ifi_∑d
;

551 
	mifi_ty≥
;

552 
	mifi_ödex
;

553 
	mifi_Êags
;

554 
	mifi_ch™ge
;

561 
	s¥efixmsg
 {

562 
	m¥efix_Ámûy
;

563 
	m¥efix_∑d1
;

564 
	m¥efix_∑d2
;

565 
	m¥efix_ifödex
;

566 
	m¥efix_ty≥
;

567 
	m¥efix_Àn
;

568 
	m¥efix_Êags
;

569 
	m¥efix_∑d3
;

574 
	mPREFIX_UNSPEC
,

575 
	mPREFIX_ADDRESS
,

576 
	mPREFIX_CACHEINFO
,

577 
	m__PREFIX_MAX


580 
	#PREFIX_MAX
 (
__PREFIX_MAX
 - 1)

	)

582 
	s¥efix_ˇcheöfo
 {

583 
__u32
 
	m¥e„ºed_time
;

584 
__u32
 
	mvÆid_time
;

592 
	stcmsg
 {

593 
	mtcm_Ámûy
;

594 
	mtcm__∑d1
;

595 
	mtcm__∑d2
;

596 
	mtcm_ifödex
;

597 
__u32
 
	mtcm_h™dÀ
;

598 
__u32
 
	mtcm_∑ª¡
;

602 
	#tcm_block_ödex
 
tcm_∑ª¡


	)

603 
__u32
 
	mtcm_öfo
;

610 
	#TCM_IFINDEX_MAGIC_BLOCK
 (0xFFFFFFFFU)

	)

613 
	mTCA_UNSPEC
,

614 
	mTCA_KIND
,

615 
	mTCA_OPTIONS
,

616 
	mTCA_STATS
,

617 
	mTCA_XSTATS
,

618 
	mTCA_RATE
,

619 
	mTCA_FCNT
,

620 
	mTCA_STATS2
,

621 
	mTCA_STAB
,

622 
	mTCA_PAD
,

623 
	mTCA_DUMP_INVISIBLE
,

624 
	mTCA_CHAIN
,

625 
	mTCA_HW_OFFLOAD
,

626 
	mTCA_INGRESS_BLOCK
,

627 
	mTCA_EGRESS_BLOCK
,

628 
	mTCA_DUMP_FLAGS
,

629 
	m__TCA_MAX


632 
	#TCA_MAX
 (
__TCA_MAX
 - 1)

	)

634 
	#TCA_DUMP_FLAGS_TERSE
 (1 << 0Ë

	)

639 
	#TCA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
tcmsg
))))

	)

640 
	#TCA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
tcmsg
))

	)

646 
	sndu£r›tmsg
 {

647 
	mndu£r›t_Ámûy
;

648 
	mndu£r›t_∑d1
;

649 
	mndu£r›t_›ts_Àn
;

650 
	mndu£r›t_ifödex
;

651 
__u8
 
	mndu£r›t_icmp_ty≥
;

652 
__u8
 
	mndu£r›t_icmp_code
;

653 
	mndu£r›t_∑d2
;

654 
	mndu£r›t_∑d3
;

659 
	mNDUSEROPT_UNSPEC
,

660 
	mNDUSEROPT_SRCADDR
,

661 
	m__NDUSEROPT_MAX


664 
	#NDUSEROPT_MAX
 (
__NDUSEROPT_MAX
 - 1)

	)

667 
	#RTMGRP_LINK
 1

	)

668 
	#RTMGRP_NOTIFY
 2

	)

669 
	#RTMGRP_NEIGH
 4

	)

670 
	#RTMGRP_TC
 8

	)

672 
	#RTMGRP_IPV4_IFADDR
 0x10

	)

673 
	#RTMGRP_IPV4_MROUTE
 0x20

	)

674 
	#RTMGRP_IPV4_ROUTE
 0x40

	)

675 
	#RTMGRP_IPV4_RULE
 0x80

	)

677 
	#RTMGRP_IPV6_IFADDR
 0x100

	)

678 
	#RTMGRP_IPV6_MROUTE
 0x200

	)

679 
	#RTMGRP_IPV6_ROUTE
 0x400

	)

680 
	#RTMGRP_IPV6_IFINFO
 0x800

	)

682 
	#RTMGRP_DEC√t_IFADDR
 0x1000

	)

683 
	#RTMGRP_DEC√t_ROUTE
 0x4000

	)

685 
	#RTMGRP_IPV6_PREFIX
 0x20000

	)

688 
	eπ√éök_groups
 {

689 
	mRTNLGRP_NONE
,

690 
	#RTNLGRP_NONE
 
RTNLGRP_NONE


	)

691 
	mRTNLGRP_LINK
,

692 
	#RTNLGRP_LINK
 
RTNLGRP_LINK


	)

693 
	mRTNLGRP_NOTIFY
,

694 
	#RTNLGRP_NOTIFY
 
RTNLGRP_NOTIFY


	)

695 
	mRTNLGRP_NEIGH
,

696 
	#RTNLGRP_NEIGH
 
RTNLGRP_NEIGH


	)

697 
	mRTNLGRP_TC
,

698 
	#RTNLGRP_TC
 
RTNLGRP_TC


	)

699 
	mRTNLGRP_IPV4_IFADDR
,

700 
	#RTNLGRP_IPV4_IFADDR
 
RTNLGRP_IPV4_IFADDR


	)

701 
	mRTNLGRP_IPV4_MROUTE
,

702 
	#RTNLGRP_IPV4_MROUTE
 
RTNLGRP_IPV4_MROUTE


	)

703 
	mRTNLGRP_IPV4_ROUTE
,

704 
	#RTNLGRP_IPV4_ROUTE
 
RTNLGRP_IPV4_ROUTE


	)

705 
	mRTNLGRP_IPV4_RULE
,

706 
	#RTNLGRP_IPV4_RULE
 
RTNLGRP_IPV4_RULE


	)

707 
	mRTNLGRP_IPV6_IFADDR
,

708 
	#RTNLGRP_IPV6_IFADDR
 
RTNLGRP_IPV6_IFADDR


	)

709 
	mRTNLGRP_IPV6_MROUTE
,

710 
	#RTNLGRP_IPV6_MROUTE
 
RTNLGRP_IPV6_MROUTE


	)

711 
	mRTNLGRP_IPV6_ROUTE
,

712 
	#RTNLGRP_IPV6_ROUTE
 
RTNLGRP_IPV6_ROUTE


	)

713 
	mRTNLGRP_IPV6_IFINFO
,

714 
	#RTNLGRP_IPV6_IFINFO
 
RTNLGRP_IPV6_IFINFO


	)

715 
	mRTNLGRP_DEC√t_IFADDR
,

716 
	#RTNLGRP_DEC√t_IFADDR
 
RTNLGRP_DEC√t_IFADDR


	)

717 
	mRTNLGRP_NOP2
,

718 
	mRTNLGRP_DEC√t_ROUTE
,

719 
	#RTNLGRP_DEC√t_ROUTE
 
RTNLGRP_DEC√t_ROUTE


	)

720 
	mRTNLGRP_DEC√t_RULE
,

721 
	#RTNLGRP_DEC√t_RULE
 
RTNLGRP_DEC√t_RULE


	)

722 
	mRTNLGRP_NOP4
,

723 
	mRTNLGRP_IPV6_PREFIX
,

724 
	#RTNLGRP_IPV6_PREFIX
 
RTNLGRP_IPV6_PREFIX


	)

725 
	mRTNLGRP_IPV6_RULE
,

726 
	#RTNLGRP_IPV6_RULE
 
RTNLGRP_IPV6_RULE


	)

727 
	mRTNLGRP_ND_USEROPT
,

728 
	#RTNLGRP_ND_USEROPT
 
RTNLGRP_ND_USEROPT


	)

729 
	mRTNLGRP_PHONET_IFADDR
,

730 
	#RTNLGRP_PHONET_IFADDR
 
RTNLGRP_PHONET_IFADDR


	)

731 
	mRTNLGRP_PHONET_ROUTE
,

732 
	#RTNLGRP_PHONET_ROUTE
 
RTNLGRP_PHONET_ROUTE


	)

733 
	mRTNLGRP_DCB
,

734 
	#RTNLGRP_DCB
 
RTNLGRP_DCB


	)

735 
	mRTNLGRP_IPV4_NETCONF
,

736 
	#RTNLGRP_IPV4_NETCONF
 
RTNLGRP_IPV4_NETCONF


	)

737 
	mRTNLGRP_IPV6_NETCONF
,

738 
	#RTNLGRP_IPV6_NETCONF
 
RTNLGRP_IPV6_NETCONF


	)

739 
	mRTNLGRP_MDB
,

740 
	#RTNLGRP_MDB
 
RTNLGRP_MDB


	)

741 
	mRTNLGRP_MPLS_ROUTE
,

742 
	#RTNLGRP_MPLS_ROUTE
 
RTNLGRP_MPLS_ROUTE


	)

743 
	mRTNLGRP_NSID
,

744 
	#RTNLGRP_NSID
 
RTNLGRP_NSID


	)

745 
	mRTNLGRP_MPLS_NETCONF
,

746 
	#RTNLGRP_MPLS_NETCONF
 
RTNLGRP_MPLS_NETCONF


	)

747 
	mRTNLGRP_IPV4_MROUTE_R
,

748 
	#RTNLGRP_IPV4_MROUTE_R
 
RTNLGRP_IPV4_MROUTE_R


	)

749 
	mRTNLGRP_IPV6_MROUTE_R
,

750 
	#RTNLGRP_IPV6_MROUTE_R
 
RTNLGRP_IPV6_MROUTE_R


	)

751 
	mRTNLGRP_NEXTHOP
,

752 
	#RTNLGRP_NEXTHOP
 
RTNLGRP_NEXTHOP


	)

753 
	mRTNLGRP_BRVLAN
,

754 
	#RTNLGRP_BRVLAN
 
RTNLGRP_BRVLAN


	)

755 
	m__RTNLGRP_MAX


757 
	#RTNLGRP_MAX
 (
__RTNLGRP_MAX
 - 1)

	)

760 
	stˇmsg
 {

761 
	mtˇ_Ámûy
;

762 
	mtˇ__∑d1
;

763 
	mtˇ__∑d2
;

767 
	mTCA_ROOT_UNSPEC
,

768 
	mTCA_ROOT_TAB
,

769 
	#TCA_ACT_TAB
 
TCA_ROOT_TAB


	)

770 
	#TCAA_MAX
 
TCA_ROOT_TAB


	)

771 
	mTCA_ROOT_FLAGS
,

772 
	mTCA_ROOT_COUNT
,

773 
	mTCA_ROOT_TIME_DELTA
,

774 
	m__TCA_ROOT_MAX
,

775 
	#TCA_ROOT_MAX
 (
__TCA_ROOT_MAX
 - 1)

	)

778 
	#TA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
tˇmsg
))))

	)

779 
	#TA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
tˇmsg
))

	)

791 
	#TCA_FLAG_LARGE_DUMP_ON
 (1 << 0)

	)

792 
	#TCA_ACT_FLAG_LARGE_DUMP_ON
 
TCA_FLAG_LARGE_DUMP_ON


	)

793 
	#TCA_ACT_FLAG_TERSE_DUMP
 (1 << 1)

	)

796 
	#RTEXT_FILTER_VF
 (1 << 0)

	)

797 
	#RTEXT_FILTER_BRVLAN
 (1 << 1)

	)

798 
	#RTEXT_FILTER_BRVLAN_COMPRESSED
 (1 << 2)

	)

799 
	#RTEXT_FILTER_SKIP_STATS
 (1 << 3)

	)

800 
	#RTEXT_FILTER_MRP
 (1 << 4)

	)

801 
	#RTEXT_FILTER_CFM_CONFIG
 (1 << 5)

	)

802 
	#RTEXT_FILTER_CFM_STATUS
 (1 << 6)

	)

	@/usr/include/linux/sched.h

2 #i‚de‡
_LINUX_SCHED_H


3 
	#_LINUX_SCHED_H


	)

5 
	~<löux/ty≥s.h
>

10 
	#CSIGNAL
 0x000000f‡

	)

11 
	#CLONE_VM
 0x00000100

	)

12 
	#CLONE_FS
 0x00000200

	)

13 
	#CLONE_FILES
 0x00000400

	)

14 
	#CLONE_SIGHAND
 0x00000800

	)

15 
	#CLONE_PIDFD
 0x00001000

	)

16 
	#CLONE_PTRACE
 0x00002000

	)

17 
	#CLONE_VFORK
 0x00004000

	)

18 
	#CLONE_PARENT
 0x00008000

	)

19 
	#CLONE_THREAD
 0x00010000

	)

20 
	#CLONE_NEWNS
 0x00020000

	)

21 
	#CLONE_SYSVSEM
 0x00040000

	)

22 
	#CLONE_SETTLS
 0x00080000

	)

23 
	#CLONE_PARENT_SETTID
 0x00100000

	)

24 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

25 
	#CLONE_DETACHED
 0x00400000

	)

26 
	#CLONE_UNTRACED
 0x00800000

	)

27 
	#CLONE_CHILD_SETTID
 0x01000000

	)

28 
	#CLONE_NEWCGROUP
 0x02000000

	)

29 
	#CLONE_NEWUTS
 0x04000000

	)

30 
	#CLONE_NEWIPC
 0x08000000

	)

31 
	#CLONE_NEWUSER
 0x10000000

	)

32 
	#CLONE_NEWPID
 0x20000000

	)

33 
	#CLONE_NEWNET
 0x40000000

	)

34 
	#CLONE_IO
 0x80000000

	)

37 
	#CLONE_CLEAR_SIGHAND
 0x100000000ULL

	)

38 
	#CLONE_INTO_CGROUP
 0x200000000ULL

	)

44 
	#CLONE_NEWTIME
 0x00000080

	)

46 #i‚de‡
__ASSEMBLY__


92 
	s˛⁄e_¨gs
 {

93 
__Æig√d_u64
 
	mÊags
;

94 
__Æig√d_u64
 
	mpidfd
;

95 
__Æig√d_u64
 
	mchûd_tid
;

96 
__Æig√d_u64
 
	m∑ª¡_tid
;

97 
__Æig√d_u64
 
	mexô_sig«l
;

98 
__Æig√d_u64
 
	m°ack
;

99 
__Æig√d_u64
 
	m°ack_size
;

100 
__Æig√d_u64
 
	més
;

101 
__Æig√d_u64
 
	m£t_tid
;

102 
__Æig√d_u64
 
	m£t_tid_size
;

103 
__Æig√d_u64
 
	mcgroup
;

107 
	#CLONE_ARGS_SIZE_VER0
 64

	)

108 
	#CLONE_ARGS_SIZE_VER1
 80

	)

109 
	#CLONE_ARGS_SIZE_VER2
 88

	)

114 
	#SCHED_NORMAL
 0

	)

115 
	#SCHED_FIFO
 1

	)

116 
	#SCHED_RR
 2

	)

117 
	#SCHED_BATCH
 3

	)

119 
	#SCHED_IDLE
 5

	)

120 
	#SCHED_DEADLINE
 6

	)

123 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

128 
	#SCHED_FLAG_RESET_ON_FORK
 0x01

	)

129 
	#SCHED_FLAG_RECLAIM
 0x02

	)

130 
	#SCHED_FLAG_DL_OVERRUN
 0x04

	)

131 
	#SCHED_FLAG_KEEP_POLICY
 0x08

	)

132 
	#SCHED_FLAG_KEEP_PARAMS
 0x10

	)

133 
	#SCHED_FLAG_UTIL_CLAMP_MIN
 0x20

	)

134 
	#SCHED_FLAG_UTIL_CLAMP_MAX
 0x40

	)

136 
	#SCHED_FLAG_KEEP_ALL
 (
SCHED_FLAG_KEEP_POLICY
 | \

137 
SCHED_FLAG_KEEP_PARAMS
)

	)

139 
	#SCHED_FLAG_UTIL_CLAMP
 (
SCHED_FLAG_UTIL_CLAMP_MIN
 | \

140 
SCHED_FLAG_UTIL_CLAMP_MAX
)

	)

142 
	#SCHED_FLAG_ALL
 (
SCHED_FLAG_RESET_ON_FORK
 | \

143 
SCHED_FLAG_RECLAIM
 | \

144 
SCHED_FLAG_DL_OVERRUN
 | \

145 
SCHED_FLAG_KEEP_ALL
 | \

146 
SCHED_FLAG_UTIL_CLAMP
)

	)

	@/usr/include/linux/string.h

2 #i‚de‡
_LINUX_STRING_H_


3 
	#_LINUX_STRING_H_


	)

7 
	~<°rög.h
>

	@/usr/include/linux/time.h

2 #i‚de‡
_LINUX_TIME_H


3 
	#_LINUX_TIME_H


	)

5 
	~<löux/ty≥s.h
>

6 
	~<löux/time_ty≥s.h
>

8 #i‚de‡
_STRUCT_TIMESPEC


9 
	#_STRUCT_TIMESPEC


	)

10 
	stime•ec
 {

11 
__kî√l_ﬁd_time_t
 
	mtv_£c
;

12 
	mtv_n£c
;

16 
	stimevÆ
 {

17 
__kî√l_ﬁd_time_t
 
	mtv_£c
;

18 
__kî√l_su£c⁄ds_t
 
	mtv_u£c
;

21 
	sôimî•ec
 {

22 
time•ec
 
	mô_öãrvÆ
;

23 
time•ec
 
	mô_vÆue
;

26 
	sôimîvÆ
 {

27 
timevÆ
 
	mô_öãrvÆ
;

28 
timevÆ
 
	mô_vÆue
;

31 
	stimez⁄e
 {

32 
	mtz_möuãswe°
;

33 
	mtz_d°time
;

40 
	#ITIMER_REAL
 0

	)

41 
	#ITIMER_VIRTUAL
 1

	)

42 
	#ITIMER_PROF
 2

	)

47 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

49 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

50 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

51 
	#CLOCK_MONOTONIC_RAW
 4

	)

52 
	#CLOCK_REALTIME_COARSE
 5

	)

53 
	#CLOCK_MONOTONIC_COARSE
 6

	)

54 
	#CLOCK_BOOTTIME
 7

	)

55 
	#CLOCK_REALTIME_ALARM
 8

	)

56 
	#CLOCK_BOOTTIME_ALARM
 9

	)

61 
	#CLOCK_SGI_CYCLE
 10

	)

62 
	#CLOCK_TAI
 11

	)

64 
	#MAX_CLOCKS
 16

	)

65 
	#CLOCKS_MASK
 (
CLOCK_REALTIME
 | 
CLOCK_MONOTONIC
)

	)

66 
	#CLOCKS_MONO
 
CLOCK_MONOTONIC


	)

71 
	#TIMER_ABSTIME
 0x01

	)

	@/usr/include/linux/utsname.h

2 #i‚de‡
_LINUX_UTSNAME_H


3 
	#_LINUX_UTSNAME_H


	)

5 
	#__OLD_UTS_LEN
 8

	)

7 
	sﬁdﬁd_ut¢ame
 {

8 
	msy¢ame
[9];

9 
	mnodíame
[9];

10 
	mªÀa£
[9];

11 
	mvîsi⁄
[9];

12 
	mmachöe
[9];

15 
	#__NEW_UTS_LEN
 64

	)

17 
	sﬁd_ut¢ame
 {

18 
	msy¢ame
[65];

19 
	mnodíame
[65];

20 
	mªÀa£
[65];

21 
	mvîsi⁄
[65];

22 
	mmachöe
[65];

25 
	s√w_ut¢ame
 {

26 
	msy¢ame
[
__NEW_UTS_LEN
 + 1];

27 
	mnodíame
[
__NEW_UTS_LEN
 + 1];

28 
	mªÀa£
[
__NEW_UTS_LEN
 + 1];

29 
	mvîsi⁄
[
__NEW_UTS_LEN
 + 1];

30 
	mmachöe
[
__NEW_UTS_LEN
 + 1];

31 
	mdomaö«me
[
__NEW_UTS_LEN
 + 1];

	@/usr/include/linux/wireless.h

11 #i‚de‡
_LINUX_WIRELESS_H


12 
	#_LINUX_WIRELESS_H


	)

73 
	~<löux/ty≥s.h
>

74 
	~<löux/sockë.h
>

75 
	~<löux/if.h
>

77 
	~<°ddef.h
>

86 
	#WIRELESS_EXT
 22

	)

233 
	#SIOCSIWCOMMIT
 0x8B00

	)

234 
	#SIOCGIWNAME
 0x8B01

	)

240 
	#SIOCSIWNWID
 0x8B02

	)

241 
	#SIOCGIWNWID
 0x8B03

	)

242 
	#SIOCSIWFREQ
 0x8B04

	)

243 
	#SIOCGIWFREQ
 0x8B05

	)

244 
	#SIOCSIWMODE
 0x8B06

	)

245 
	#SIOCGIWMODE
 0x8B07

	)

246 
	#SIOCSIWSENS
 0x8B08

	)

247 
	#SIOCGIWSENS
 0x8B09

	)

250 
	#SIOCSIWRANGE
 0x8B0A

	)

251 
	#SIOCGIWRANGE
 0x8B0B

	)

252 
	#SIOCSIWPRIV
 0x8B0C

	)

253 
	#SIOCGIWPRIV
 0x8B0D

	)

254 
	#SIOCSIWSTATS
 0x8B0E

	)

255 
	#SIOCGIWSTATS
 0x8B0F

	)

260 
	#SIOCSIWSPY
 0x8B10

	)

261 
	#SIOCGIWSPY
 0x8B11

	)

262 
	#SIOCSIWTHRSPY
 0x8B12

	)

263 
	#SIOCGIWTHRSPY
 0x8B13

	)

266 
	#SIOCSIWAP
 0x8B14

	)

267 
	#SIOCGIWAP
 0x8B15

	)

268 
	#SIOCGIWAPLIST
 0x8B17

	)

269 
	#SIOCSIWSCAN
 0x8B18

	)

270 
	#SIOCGIWSCAN
 0x8B19

	)

273 
	#SIOCSIWESSID
 0x8B1A

	)

274 
	#SIOCGIWESSID
 0x8B1B

	)

275 
	#SIOCSIWNICKN
 0x8B1C

	)

276 
	#SIOCGIWNICKN
 0x8B1D

	)

282 
	#SIOCSIWRATE
 0x8B20

	)

283 
	#SIOCGIWRATE
 0x8B21

	)

284 
	#SIOCSIWRTS
 0x8B22

	)

285 
	#SIOCGIWRTS
 0x8B23

	)

286 
	#SIOCSIWFRAG
 0x8B24

	)

287 
	#SIOCGIWFRAG
 0x8B25

	)

288 
	#SIOCSIWTXPOW
 0x8B26

	)

289 
	#SIOCGIWTXPOW
 0x8B27

	)

290 
	#SIOCSIWRETRY
 0x8B28

	)

291 
	#SIOCGIWRETRY
 0x8B29

	)

294 
	#SIOCSIWENCODE
 0x8B2A

	)

295 
	#SIOCGIWENCODE
 0x8B2B

	)

297 
	#SIOCSIWPOWER
 0x8B2C

	)

298 
	#SIOCGIWPOWER
 0x8B2D

	)

307 
	#SIOCSIWGENIE
 0x8B30

	)

308 
	#SIOCGIWGENIE
 0x8B31

	)

311 
	#SIOCSIWMLME
 0x8B16

	)

314 
	#SIOCSIWAUTH
 0x8B32

	)

315 
	#SIOCGIWAUTH
 0x8B33

	)

318 
	#SIOCSIWENCODEEXT
 0x8B34

	)

319 
	#SIOCGIWENCODEEXT
 0x8B35

	)

322 
	#SIOCSIWPMKSA
 0x8B36

	)

333 
	#SIOCIWFIRSTPRIV
 0x8BE0

	)

334 
	#SIOCIWLASTPRIV
 0x8BFF

	)

349 
	#SIOCIWFIRST
 0x8B00

	)

350 
	#SIOCIWLAST
 
SIOCIWLASTPRIV


	)

351 
	#IW_IOCTL_IDX
(
cmd
Ë((cmdË- 
SIOCIWFIRST
)

	)

352 
	#IW_HANDLER
(
id
, 
func
) \

353 [
	`IW_IOCTL_IDX
(
id
)] = 
func


	)

356 
	#IW_IS_SET
(
cmd
Ë(!((cmdË& 0x1))

	)

357 
	#IW_IS_GET
(
cmd
Ë((cmdË& 0x1)

	)

363 
	#IWEVTXDROP
 0x8C00

	)

364 
	#IWEVQUAL
 0x8C01

	)

365 
	#IWEVCUSTOM
 0x8C02

	)

366 
	#IWEVREGISTERED
 0x8C03

	)

367 
	#IWEVEXPIRED
 0x8C04

	)

368 
	#IWEVGENIE
 0x8C05

	)

374 
	#IWEVMICHAELMICFAILURE
 0x8C06

	)

377 
	#IWEVASSOCREQIE
 0x8C07

	)

386 
	#IWEVASSOCRESPIE
 0x8C08

	)

393 
	#IWEVPMKIDCAND
 0x8C09

	)

397 
	#IWEVFIRST
 0x8C00

	)

398 
	#IW_EVENT_IDX
(
cmd
Ë((cmdË- 
IWEVFIRST
)

	)

407 
	#IW_PRIV_TYPE_MASK
 0x7000

	)

408 
	#IW_PRIV_TYPE_NONE
 0x0000

	)

409 
	#IW_PRIV_TYPE_BYTE
 0x1000

	)

410 
	#IW_PRIV_TYPE_CHAR
 0x2000

	)

411 
	#IW_PRIV_TYPE_INT
 0x4000

	)

412 
	#IW_PRIV_TYPE_FLOAT
 0x5000

	)

413 
	#IW_PRIV_TYPE_ADDR
 0x6000

	)

415 
	#IW_PRIV_SIZE_FIXED
 0x0800

	)

417 
	#IW_PRIV_SIZE_MASK
 0x07FF

	)

427 
	#IW_MAX_FREQUENCIES
 32

	)

433 
	#IW_MAX_BITRATES
 32

	)

436 
	#IW_MAX_TXPOWER
 8

	)

441 
	#IW_MAX_SPY
 8

	)

445 
	#IW_MAX_AP
 64

	)

448 
	#IW_ESSID_MAX_SIZE
 32

	)

451 
	#IW_MODE_AUTO
 0

	)

452 
	#IW_MODE_ADHOC
 1

	)

453 
	#IW_MODE_INFRA
 2

	)

454 
	#IW_MODE_MASTER
 3

	)

455 
	#IW_MODE_REPEAT
 4

	)

456 
	#IW_MODE_SECOND
 5

	)

457 
	#IW_MODE_MONITOR
 6

	)

458 
	#IW_MODE_MESH
 7

	)

461 
	#IW_QUAL_QUAL_UPDATED
 0x01

	)

462 
	#IW_QUAL_LEVEL_UPDATED
 0x02

	)

463 
	#IW_QUAL_NOISE_UPDATED
 0x04

	)

464 
	#IW_QUAL_ALL_UPDATED
 0x07

	)

465 
	#IW_QUAL_DBM
 0x08

	)

466 
	#IW_QUAL_QUAL_INVALID
 0x10

	)

467 
	#IW_QUAL_LEVEL_INVALID
 0x20

	)

468 
	#IW_QUAL_NOISE_INVALID
 0x40

	)

469 
	#IW_QUAL_RCPI
 0x80

	)

470 
	#IW_QUAL_ALL_INVALID
 0x70

	)

473 
	#IW_FREQ_AUTO
 0x00

	)

474 
	#IW_FREQ_FIXED
 0x01

	)

478 
	#IW_MAX_ENCODING_SIZES
 8

	)

481 
	#IW_ENCODING_TOKEN_MAX
 64

	)

484 
	#IW_ENCODE_INDEX
 0x00FF

	)

485 
	#IW_ENCODE_FLAGS
 0xFF00

	)

486 
	#IW_ENCODE_MODE
 0xF000

	)

487 
	#IW_ENCODE_DISABLED
 0x8000

	)

488 
	#IW_ENCODE_ENABLED
 0x0000

	)

489 
	#IW_ENCODE_RESTRICTED
 0x4000

	)

490 
	#IW_ENCODE_OPEN
 0x2000

	)

491 
	#IW_ENCODE_NOKEY
 0x0800

	)

492 
	#IW_ENCODE_TEMP
 0x0400

	)

495 
	#IW_POWER_ON
 0x0000

	)

496 
	#IW_POWER_TYPE
 0xF000

	)

497 
	#IW_POWER_PERIOD
 0x1000

	)

498 
	#IW_POWER_TIMEOUT
 0x2000

	)

499 
	#IW_POWER_MODE
 0x0F00

	)

500 
	#IW_POWER_UNICAST_R
 0x0100

	)

501 
	#IW_POWER_MULTICAST_R
 0x0200

	)

502 
	#IW_POWER_ALL_R
 0x0300

	)

503 
	#IW_POWER_FORCE_S
 0x0400

	)

504 
	#IW_POWER_REPEATER
 0x0800

	)

505 
	#IW_POWER_MODIFIER
 0x000F

	)

506 
	#IW_POWER_MIN
 0x0001

	)

507 
	#IW_POWER_MAX
 0x0002

	)

508 
	#IW_POWER_RELATIVE
 0x0004

	)

511 
	#IW_TXPOW_TYPE
 0x00FF

	)

512 
	#IW_TXPOW_DBM
 0x0000

	)

513 
	#IW_TXPOW_MWATT
 0x0001

	)

514 
	#IW_TXPOW_RELATIVE
 0x0002

	)

515 
	#IW_TXPOW_RANGE
 0x1000

	)

518 
	#IW_RETRY_ON
 0x0000

	)

519 
	#IW_RETRY_TYPE
 0xF000

	)

520 
	#IW_RETRY_LIMIT
 0x1000

	)

521 
	#IW_RETRY_LIFETIME
 0x2000

	)

522 
	#IW_RETRY_MODIFIER
 0x00FF

	)

523 
	#IW_RETRY_MIN
 0x0001

	)

524 
	#IW_RETRY_MAX
 0x0002

	)

525 
	#IW_RETRY_RELATIVE
 0x0004

	)

526 
	#IW_RETRY_SHORT
 0x0010

	)

527 
	#IW_RETRY_LONG
 0x0020

	)

530 
	#IW_SCAN_DEFAULT
 0x0000

	)

531 
	#IW_SCAN_ALL_ESSID
 0x0001

	)

532 
	#IW_SCAN_THIS_ESSID
 0x0002

	)

533 
	#IW_SCAN_ALL_FREQ
 0x0004

	)

534 
	#IW_SCAN_THIS_FREQ
 0x0008

	)

535 
	#IW_SCAN_ALL_MODE
 0x0010

	)

536 
	#IW_SCAN_THIS_MODE
 0x0020

	)

537 
	#IW_SCAN_ALL_RATE
 0x0040

	)

538 
	#IW_SCAN_THIS_RATE
 0x0080

	)

540 
	#IW_SCAN_TYPE_ACTIVE
 0

	)

541 
	#IW_SCAN_TYPE_PASSIVE
 1

	)

543 
	#IW_SCAN_MAX_DATA
 4096

	)

546 
	#IW_SCAN_CAPA_NONE
 0x00

	)

547 
	#IW_SCAN_CAPA_ESSID
 0x01

	)

548 
	#IW_SCAN_CAPA_BSSID
 0x02

	)

549 
	#IW_SCAN_CAPA_CHANNEL
 0x04

	)

550 
	#IW_SCAN_CAPA_MODE
 0x08

	)

551 
	#IW_SCAN_CAPA_RATE
 0x10

	)

552 
	#IW_SCAN_CAPA_TYPE
 0x20

	)

553 
	#IW_SCAN_CAPA_TIME
 0x40

	)

556 
	#IW_CUSTOM_MAX
 256

	)

559 
	#IW_GENERIC_IE_MAX
 1024

	)

562 
	#IW_MLME_DEAUTH
 0

	)

563 
	#IW_MLME_DISASSOC
 1

	)

564 
	#IW_MLME_AUTH
 2

	)

565 
	#IW_MLME_ASSOC
 3

	)

568 
	#IW_AUTH_INDEX
 0x0FFF

	)

569 
	#IW_AUTH_FLAGS
 0xF000

	)

574 
	#IW_AUTH_WPA_VERSION
 0

	)

575 
	#IW_AUTH_CIPHER_PAIRWISE
 1

	)

576 
	#IW_AUTH_CIPHER_GROUP
 2

	)

577 
	#IW_AUTH_KEY_MGMT
 3

	)

578 
	#IW_AUTH_TKIP_COUNTERMEASURES
 4

	)

579 
	#IW_AUTH_DROP_UNENCRYPTED
 5

	)

580 
	#IW_AUTH_80211_AUTH_ALG
 6

	)

581 
	#IW_AUTH_WPA_ENABLED
 7

	)

582 
	#IW_AUTH_RX_UNENCRYPTED_EAPOL
 8

	)

583 
	#IW_AUTH_ROAMING_CONTROL
 9

	)

584 
	#IW_AUTH_PRIVACY_INVOKED
 10

	)

585 
	#IW_AUTH_CIPHER_GROUP_MGMT
 11

	)

586 
	#IW_AUTH_MFP
 12

	)

589 
	#IW_AUTH_WPA_VERSION_DISABLED
 0x00000001

	)

590 
	#IW_AUTH_WPA_VERSION_WPA
 0x00000002

	)

591 
	#IW_AUTH_WPA_VERSION_WPA2
 0x00000004

	)

595 
	#IW_AUTH_CIPHER_NONE
 0x00000001

	)

596 
	#IW_AUTH_CIPHER_WEP40
 0x00000002

	)

597 
	#IW_AUTH_CIPHER_TKIP
 0x00000004

	)

598 
	#IW_AUTH_CIPHER_CCMP
 0x00000008

	)

599 
	#IW_AUTH_CIPHER_WEP104
 0x00000010

	)

600 
	#IW_AUTH_CIPHER_AES_CMAC
 0x00000020

	)

603 
	#IW_AUTH_KEY_MGMT_802_1X
 1

	)

604 
	#IW_AUTH_KEY_MGMT_PSK
 2

	)

607 
	#IW_AUTH_ALG_OPEN_SYSTEM
 0x00000001

	)

608 
	#IW_AUTH_ALG_SHARED_KEY
 0x00000002

	)

609 
	#IW_AUTH_ALG_LEAP
 0x00000004

	)

612 
	#IW_AUTH_ROAMING_ENABLE
 0

	)

613 
	#IW_AUTH_ROAMING_DISABLE
 1

	)

617 
	#IW_AUTH_MFP_DISABLED
 0

	)

618 
	#IW_AUTH_MFP_OPTIONAL
 1

	)

619 
	#IW_AUTH_MFP_REQUIRED
 2

	)

622 
	#IW_ENCODE_SEQ_MAX_SIZE
 8

	)

624 
	#IW_ENCODE_ALG_NONE
 0

	)

625 
	#IW_ENCODE_ALG_WEP
 1

	)

626 
	#IW_ENCODE_ALG_TKIP
 2

	)

627 
	#IW_ENCODE_ALG_CCMP
 3

	)

628 
	#IW_ENCODE_ALG_PMK
 4

	)

629 
	#IW_ENCODE_ALG_AES_CMAC
 5

	)

631 
	#IW_ENCODE_EXT_TX_SEQ_VALID
 0x00000001

	)

632 
	#IW_ENCODE_EXT_RX_SEQ_VALID
 0x00000002

	)

633 
	#IW_ENCODE_EXT_GROUP_KEY
 0x00000004

	)

634 
	#IW_ENCODE_EXT_SET_TX_KEY
 0x00000008

	)

637 
	#IW_MICFAILURE_KEY_ID
 0x00000003

	)

638 
	#IW_MICFAILURE_GROUP
 0x00000004

	)

639 
	#IW_MICFAILURE_PAIRWISE
 0x00000008

	)

640 
	#IW_MICFAILURE_STAKEY
 0x00000010

	)

641 
	#IW_MICFAILURE_COUNT
 0x00000060

	)

645 
	#IW_ENC_CAPA_WPA
 0x00000001

	)

646 
	#IW_ENC_CAPA_WPA2
 0x00000002

	)

647 
	#IW_ENC_CAPA_CIPHER_TKIP
 0x00000004

	)

648 
	#IW_ENC_CAPA_CIPHER_CCMP
 0x00000008

	)

649 
	#IW_ENC_CAPA_4WAY_HANDSHAKE
 0x00000010

	)

654 
	#IW_EVENT_CAPA_BASE
(
cmd
Ë((cmd >
SIOCIWFIRSTPRIV
) ? \

655 (
cmd
 - 
SIOCIWFIRSTPRIV
 + 0x60) : \

656 (
cmd
 - 
SIOCIWFIRST
))

	)

657 
	#IW_EVENT_CAPA_INDEX
(
cmd
Ë(
	`IW_EVENT_CAPA_BASE
(cmdË>> 5)

	)

658 
	#IW_EVENT_CAPA_MASK
(
cmd
Ë(1 << (
	`IW_EVENT_CAPA_BASE
(cmdË& 0x1F))

	)

661 
	#IW_EVENT_CAPA_K_0
 (
	`IW_EVENT_CAPA_MASK
(0x8B04) | \

662 
	`IW_EVENT_CAPA_MASK
(0x8B06) | \

663 
	`IW_EVENT_CAPA_MASK
(0x8B1A))

	)

664 
	#IW_EVENT_CAPA_K_1
 (
	`IW_EVENT_CAPA_MASK
(0x8B2A))

	)

666 
	#IW_EVENT_CAPA_SET
(
evít_ˇ∑
, 
cmd
Ë”vít_ˇ∑[
	`IW_EVENT_CAPA_INDEX
(cmd)] |
	`IW_EVENT_CAPA_MASK
(cmd))

	)

667 
	#IW_EVENT_CAPA_SET_KERNEL
(
evít_ˇ∑
Ë{evít_ˇ∑[0] |
IW_EVENT_CAPA_K_0
;Évít_ˇ∑[1] |
IW_EVENT_CAPA_K_1
; }

	)

676 
	siw_∑øm
 {

677 
__s32
 
	mvÆue
;

678 
__u8
 
	mfixed
;

679 
__u8
 
	mdißbÀd
;

680 
__u16
 
	mÊags
;

687 
	siw_poöt
 {

688 *
	mpoöãr
;

689 
__u16
 
	mÀngth
;

690 
__u16
 
	mÊags
;

702 
	siw_‰eq
 {

703 
__s32
 
	mm
;

704 
__s16
 
	me
;

705 
__u8
 
	mi
;

706 
__u8
 
	mÊags
;

712 
	siw_quÆôy
 {

713 
__u8
 
	mquÆ
;

715 
__u8
 
	mÀvñ
;

716 
__u8
 
	mnoi£
;

717 
__u8
 
	mupd©ed
;

727 
	siw_disˇrded
 {

728 
__u32
 
	mnwid
;

729 
__u32
 
	mcode
;

730 
__u32
 
	m‰agmít
;

731 
__u32
 
	mªåõs
;

732 
__u32
 
	mmisc
;

739 
	siw_mis£d
 {

740 
__u32
 
	mbóc⁄
;

746 
	siw_thr•y
 {

747 
sockaddr
 
	maddr
;

748 
iw_quÆôy
 
	mquÆ
;

749 
iw_quÆôy
 
	mlow
;

750 
iw_quÆôy
 
	mhigh
;

764 
	siw_sˇn_ªq
 {

765 
__u8
 
	msˇn_ty≥
;

766 
__u8
 
	messid_Àn
;

767 
__u8
 
	mnum_ch™√ls
;

769 
__u8
 
	mÊags
;

772 
sockaddr
 
	mbssid
;

781 
__u8
 
	messid
[
IW_ESSID_MAX_SIZE
];

793 
__u32
 
	mmö_ch™√l_time
;

794 
__u32
 
	mmax_ch™√l_time
;

796 
iw_‰eq
 
	mch™√l_li°
[
IW_MAX_FREQUENCIES
];

825 
	siw_ícode_ext
 {

826 
__u32
 
	mext_Êags
;

827 
__u8
 
	mtx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

828 
__u8
 
	mrx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

829 
sockaddr
 
	maddr
;

832 
__u16
 
	mÆg
;

833 
__u16
 
	mkey_Àn
;

834 
__u8
 
	mkey
[0];

838 
	siw_mlme
 {

839 
__u16
 
	mcmd
;

840 
__u16
 
	mªas⁄_code
;

841 
sockaddr
 
	maddr
;

845 
	#IW_PMKSA_ADD
 1

	)

846 
	#IW_PMKSA_REMOVE
 2

	)

847 
	#IW_PMKSA_FLUSH
 3

	)

849 
	#IW_PMKID_LEN
 16

	)

851 
	siw_pmkß
 {

852 
__u32
 
	mcmd
;

853 
sockaddr
 
	mbssid
;

854 
__u8
 
	mpmkid
[
IW_PMKID_LEN
];

858 
	siw_mich´lmicÁûuª
 {

859 
__u32
 
	mÊags
;

860 
sockaddr
 
	m§c_addr
;

861 
__u8
 
	mtsc
[
IW_ENCODE_SEQ_MAX_SIZE
];

865 
	#IW_PMKID_CAND_PREAUTH
 0x00000001

	)

866 
	siw_pmkid_ˇnd
 {

867 
__u32
 
	mÊags
;

868 
__u32
 
	mödex
;

870 
sockaddr
 
	mbssid
;

877 
	siw_°©i°ics
 {

878 
__u16
 
	m°©us
;

881 
iw_quÆôy
 
	mquÆ
;

883 
iw_disˇrded
 
	mdisˇrd
;

884 
iw_mis£d
 
	mmiss
;

898 
	uiwªq_d©a
 {

900 
	m«me
[
IFNAMSIZ
];

904 
iw_poöt
 
	messid
;

905 
iw_∑øm
 
	mnwid
;

906 
iw_‰eq
 
	m‰eq
;

910 
iw_∑øm
 
	m£ns
;

911 
iw_∑øm
 
	mbôøã
;

912 
iw_∑øm
 
	mtxpowî
;

913 
iw_∑øm
 
	mπs
;

914 
iw_∑øm
 
	m‰ag
;

915 
__u32
 
	mmode
;

916 
iw_∑øm
 
	mªåy
;

918 
iw_poöt
 
	mícodög
;

919 
iw_∑øm
 
	mpowî
;

920 
iw_quÆôy
 
	mquÆ
;

922 
sockaddr
 
	m≠_addr
;

923 
sockaddr
 
	maddr
;

925 
iw_∑øm
 
	m∑øm
;

926 
iw_poöt
 
	md©a
;

935 
	siwªq
 {

938 
	mi‰n_«me
[
IFNAMSIZ
];

939 } 
	mi‰_i‰n
;

942 
iwªq_d©a
 
	mu
;

955 
	siw_ønge
 {

957 
__u32
 
	mthroughput
;

966 
__u32
 
	mmö_nwid
;

967 
__u32
 
	mmax_nwid
;

970 
__u16
 
	mﬁd_num_ch™√ls
;

971 
__u8
 
	mﬁd_num_‰equícy
;

974 
__u8
 
	msˇn_ˇ∑
;

977 
__u32
 
	mevít_ˇ∑
[6];

980 
__s32
 
	m£nsôivôy
;

987 
iw_quÆôy
 
	mmax_quÆ
;

997 
iw_quÆôy
 
	mavg_quÆ
;

1000 
__u8
 
	mnum_bôøãs
;

1001 
__s32
 
	mbôøã
[
IW_MAX_BITRATES
];

1004 
__s32
 
	mmö_πs
;

1005 
__s32
 
	mmax_πs
;

1008 
__s32
 
	mmö_‰ag
;

1009 
__s32
 
	mmax_‰ag
;

1012 
__s32
 
	mmö_pmp
;

1013 
__s32
 
	mmax_pmp
;

1014 
__s32
 
	mmö_pmt
;

1015 
__s32
 
	mmax_pmt
;

1016 
__u16
 
	mpmp_Êags
;

1017 
__u16
 
	mpmt_Êags
;

1018 
__u16
 
	mpm_ˇ∑
;

1021 
__u16
 
	mícodög_size
[
IW_MAX_ENCODING_SIZES
];

1022 
__u8
 
	mnum_ícodög_sizes
;

1023 
__u8
 
	mmax_ícodög_tokís
;

1025 
__u8
 
	mícodög_logö_ödex
;

1028 
__u16
 
	mtxpowî_ˇ∑
;

1029 
__u8
 
	mnum_txpowî
;

1030 
__s32
 
	mtxpowî
[
IW_MAX_TXPOWER
];

1033 
__u8
 
	mwe_vîsi⁄_compûed
;

1034 
__u8
 
	mwe_vîsi⁄_sour˚
;

1037 
__u16
 
	mªåy_ˇ∑
;

1038 
__u16
 
	mªåy_Êags
;

1039 
__u16
 
	mr_time_Êags
;

1040 
__s32
 
	mmö_ªåy
;

1041 
__s32
 
	mmax_ªåy
;

1042 
__s32
 
	mmö_r_time
;

1043 
__s32
 
	mmax_r_time
;

1046 
__u16
 
	mnum_ch™√ls
;

1047 
__u8
 
	mnum_‰equícy
;

1048 
iw_‰eq
 
	m‰eq
[
IW_MAX_FREQUENCIES
];

1052 
__u32
 
	míc_ˇ∑
;

1059 
	siw_¥iv_¨gs
 {

1060 
__u32
 
	mcmd
;

1061 
__u16
 
	m£t_¨gs
;

1062 
__u16
 
	mgë_¨gs
;

1063 
	m«me
[
IFNAMSIZ
];

1076 
	siw_evít
 {

1077 
__u16
 
	mÀn
;

1078 
__u16
 
	mcmd
;

1079 
iwªq_d©a
 
	mu
;

1083 
	#IW_EV_LCP_LEN
 ((
iw_evít
Ë- (
iwªq_d©a
))

	)

1085 
	#IW_EV_CHAR_LEN
 (
IW_EV_LCP_LEN
 + 
IFNAMSIZ
)

	)

1086 
	#IW_EV_UINT_LEN
 (
IW_EV_LCP_LEN
 + (
__u32
))

	)

1087 
	#IW_EV_FREQ_LEN
 (
IW_EV_LCP_LEN
 + (
iw_‰eq
))

	)

1088 
	#IW_EV_PARAM_LEN
 (
IW_EV_LCP_LEN
 + (
iw_∑øm
))

	)

1089 
	#IW_EV_ADDR_LEN
 (
IW_EV_LCP_LEN
 + (
sockaddr
))

	)

1090 
	#IW_EV_QUAL_LEN
 (
IW_EV_LCP_LEN
 + (
iw_quÆôy
))

	)

1095 
	#IW_EV_POINT_OFF
 
	`off£tof
(
iw_poöt
, 
Àngth
)

	)

1096 
	#IW_EV_POINT_LEN
 (
IW_EV_LCP_LEN
 + (
iw_poöt
) - \

1097 
IW_EV_POINT_OFF
)

	)

1101 
	#IW_EV_LCP_PK_LEN
 (4)

	)

1103 
	#IW_EV_CHAR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + 
IFNAMSIZ
)

	)

1104 
	#IW_EV_UINT_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
__u32
))

	)

1105 
	#IW_EV_FREQ_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_‰eq
))

	)

1106 
	#IW_EV_PARAM_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_∑øm
))

	)

1107 
	#IW_EV_ADDR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
sockaddr
))

	)

1108 
	#IW_EV_QUAL_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_quÆôy
))

	)

1109 
	#IW_EV_POINT_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + 4)

	)

	@/usr/include/linux/const.h

4 #i‚de‡
_LINUX_CONST_H


5 
	#_LINUX_CONST_H


	)

16 #ifde‡
__ASSEMBLY__


17 
	#_AC
(
X
,
Y
Ë
	)
X

18 
	#_AT
(
T
,
X
Ë
	)
X

20 
	#__AC
(
X
,
Y
Ë(X##Y)

	)

21 
	#_AC
(
X
,
Y
Ë
	`__AC
(X,Y)

	)

22 
	#_AT
(
T
,
X
Ë((T)(X))

	)

25 
	#_UL
(
x
Ë(
	`_AC
(x, 
UL
))

	)

26 
	#_ULL
(
x
Ë(
	`_AC
(x, 
ULL
))

	)

28 
	#_BITUL
(
x
Ë(
	`_UL
(1Ë<< (x))

	)

29 
	#_BITULL
(
x
Ë(
	`_ULL
(1Ë<< (x))

	)

31 
	#__ALIGN_KERNEL
(
x
, 
a
Ë
	`__ALIGN_KERNEL_MASK
(x, (
	`__ty≥of__
(x))◊Ë- 1)

	)

32 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
Ë(((xË+ (mask)Ë& ~(mask))

	)

34 
	#__KERNEL_DIV_ROUND_UP
(
n
, 
d
Ë((“Ë+ (dË- 1Ë/ (d))

	)

	@/usr/include/linux/hdlc/ioctl.h

2 #i‚de‡
__HDLC_IOCTL_H__


3 
	#__HDLC_IOCTL_H__


	)

6 
	#GENERIC_HDLC_VERSION
 4

	)

8 
	#CLOCK_DEFAULT
 0

	)

9 
	#CLOCK_EXT
 1

	)

10 
	#CLOCK_INT
 2

	)

11 
	#CLOCK_TXINT
 3

	)

12 
	#CLOCK_TXFROMRX
 4

	)

15 
	#ENCODING_DEFAULT
 0

	)

16 
	#ENCODING_NRZ
 1

	)

17 
	#ENCODING_NRZI
 2

	)

18 
	#ENCODING_FM_MARK
 3

	)

19 
	#ENCODING_FM_SPACE
 4

	)

20 
	#ENCODING_MANCHESTER
 5

	)

23 
	#PARITY_DEFAULT
 0

	)

24 
	#PARITY_NONE
 1

	)

25 
	#PARITY_CRC16_PR0
 2

	)

26 
	#PARITY_CRC16_PR1
 3

	)

27 
	#PARITY_CRC16_PR0_CCITT
 4

	)

28 
	#PARITY_CRC16_PR1_CCITT
 5

	)

29 
	#PARITY_CRC32_PR0_CCITT
 6

	)

30 
	#PARITY_CRC32_PR1_CCITT
 7

	)

32 
	#LMI_DEFAULT
 0

	)

33 
	#LMI_NONE
 1

	)

34 
	#LMI_ANSI
 2

	)

35 
	#LMI_CCITT
 3

	)

36 
	#LMI_CISCO
 4

	)

38 #i‚de‡
__ASSEMBLY__


41 
	m˛ock_øã
;

42 
	m˛ock_ty≥
;

43 
	mlo›back
;

44 } 
	tsync_£rül_£âögs
;

47 
	m˛ock_øã
;

48 
	m˛ock_ty≥
;

49 
	mlo›back
;

50 
	m¶Ÿ_m≠
;

51 } 
	tã1_£âögs
;

54 
	mícodög
;

55 
	m∑rôy
;

56 } 
	tøw_hdlc_¥Ÿo
;

59 
	mt391
;

60 
	mt392
;

61 
	mn391
;

62 
	mn392
;

63 
	mn393
;

64 
	mlmi
;

65 
	md˚
;

66 } 
	t‰_¥Ÿo
;

69 
	mdlci
;

70 } 
	t‰_¥Ÿo_pvc
;

73 
	mdlci
;

74 
	mma°î
[
IFNAMSIZ
];

75 }
	t‰_¥Ÿo_pvc_öfo
;

78 
	möãrvÆ
;

79 
	mtimeout
;

80 } 
	tcisco_¥Ÿo
;

83 
	md˚
;

84 
	mmodulo
;

85 
	mwödow
;

86 
	mt1
;

87 
	mt2
;

88 
	mn2
;

89 } 
	tx25_hdlc_¥Ÿo
;

	@/usr/include/linux/if_addr.h

2 #i‚de‡
__LINUX_IF_ADDR_H


3 
	#__LINUX_IF_ADDR_H


	)

5 
	~<löux/ty≥s.h
>

6 
	~<löux/√éök.h
>

8 
	siÁddrmsg
 {

9 
__u8
 
	miÁ_Ámûy
;

10 
__u8
 
	miÁ_¥efixÀn
;

11 
__u8
 
	miÁ_Êags
;

12 
__u8
 
	miÁ_sc›e
;

13 
__u32
 
	miÁ_ödex
;

27 
	mIFA_UNSPEC
,

28 
	mIFA_ADDRESS
,

29 
	mIFA_LOCAL
,

30 
	mIFA_LABEL
,

31 
	mIFA_BROADCAST
,

32 
	mIFA_ANYCAST
,

33 
	mIFA_CACHEINFO
,

34 
	mIFA_MULTICAST
,

35 
	mIFA_FLAGS
,

36 
	mIFA_RT_PRIORITY
,

37 
	mIFA_TARGET_NETNSID
,

38 
	m__IFA_MAX
,

41 
	#IFA_MAX
 (
__IFA_MAX
 - 1)

	)

44 
	#IFA_F_SECONDARY
 0x01

	)

45 
	#IFA_F_TEMPORARY
 
IFA_F_SECONDARY


	)

47 
	#IFA_F_NODAD
 0x02

	)

48 
	#IFA_F_OPTIMISTIC
 0x04

	)

49 
	#IFA_F_DADFAILED
 0x08

	)

50 
	#IFA_F_HOMEADDRESS
 0x10

	)

51 
	#IFA_F_DEPRECATED
 0x20

	)

52 
	#IFA_F_TENTATIVE
 0x40

	)

53 
	#IFA_F_PERMANENT
 0x80

	)

54 
	#IFA_F_MANAGETEMPADDR
 0x100

	)

55 
	#IFA_F_NOPREFIXROUTE
 0x200

	)

56 
	#IFA_F_MCAUTOJOIN
 0x400

	)

57 
	#IFA_F_STABLE_PRIVACY
 0x800

	)

59 
	siÁ_ˇcheöfo
 {

60 
__u32
 
	miÁ_¥e„ªd
;

61 
__u32
 
	miÁ_vÆid
;

62 
__u32
 
	mc°amp
;

63 
__u32
 
	mt°amp
;

67 
	#IFA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
iÁddrmsg
))))

	)

68 
	#IFA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
iÁddrmsg
))

	)

	@/usr/include/linux/if_link.h

2 #i‚de‡
_LINUX_IF_LINK_H


3 
	#_LINUX_IF_LINK_H


	)

5 
	~<löux/ty≥s.h
>

6 
	~<löux/√éök.h
>

9 
	sπ∆_lök_°©s
 {

10 
__u32
 
	mrx_∑ckës
;

11 
__u32
 
	mtx_∑ckës
;

12 
__u32
 
	mrx_byãs
;

13 
__u32
 
	mtx_byãs
;

14 
__u32
 
	mrx_îr‹s
;

15 
__u32
 
	mtx_îr‹s
;

16 
__u32
 
	mrx_dr›≥d
;

17 
__u32
 
	mtx_dr›≥d
;

18 
__u32
 
	mmu…iˇ°
;

19 
__u32
 
	mcﬁlisi⁄s
;

21 
__u32
 
	mrx_Àngth_îr‹s
;

22 
__u32
 
	mrx_ovî_îr‹s
;

23 
__u32
 
	mrx_¸c_îr‹s
;

24 
__u32
 
	mrx_‰ame_îr‹s
;

25 
__u32
 
	mrx_fifo_îr‹s
;

26 
__u32
 
	mrx_mis£d_îr‹s
;

29 
__u32
 
	mtx_ab‹ãd_îr‹s
;

30 
__u32
 
	mtx_ˇºõr_îr‹s
;

31 
__u32
 
	mtx_fifo_îr‹s
;

32 
__u32
 
	mtx_hóπbót_îr‹s
;

33 
__u32
 
	mtx_wödow_îr‹s
;

36 
__u32
 
	mrx_com¥es£d
;

37 
__u32
 
	mtx_com¥es£d
;

39 
__u32
 
	mrx_noh™dÀr
;

215 
	sπ∆_lök_°©s64
 {

216 
__u64
 
	mrx_∑ckës
;

217 
__u64
 
	mtx_∑ckës
;

218 
__u64
 
	mrx_byãs
;

219 
__u64
 
	mtx_byãs
;

220 
__u64
 
	mrx_îr‹s
;

221 
__u64
 
	mtx_îr‹s
;

222 
__u64
 
	mrx_dr›≥d
;

223 
__u64
 
	mtx_dr›≥d
;

224 
__u64
 
	mmu…iˇ°
;

225 
__u64
 
	mcﬁlisi⁄s
;

228 
__u64
 
	mrx_Àngth_îr‹s
;

229 
__u64
 
	mrx_ovî_îr‹s
;

230 
__u64
 
	mrx_¸c_îr‹s
;

231 
__u64
 
	mrx_‰ame_îr‹s
;

232 
__u64
 
	mrx_fifo_îr‹s
;

233 
__u64
 
	mrx_mis£d_îr‹s
;

236 
__u64
 
	mtx_ab‹ãd_îr‹s
;

237 
__u64
 
	mtx_ˇºõr_îr‹s
;

238 
__u64
 
	mtx_fifo_îr‹s
;

239 
__u64
 
	mtx_hóπbót_îr‹s
;

240 
__u64
 
	mtx_wödow_îr‹s
;

243 
__u64
 
	mrx_com¥es£d
;

244 
__u64
 
	mtx_com¥es£d
;

245 
__u64
 
	mrx_noh™dÀr
;

249 
	sπ∆_lök_ifm≠
 {

250 
__u64
 
	mmem_°¨t
;

251 
__u64
 
	mmem_íd
;

252 
__u64
 
	mba£_addr
;

253 
__u16
 
	múq
;

254 
__u8
 
	mdma
;

255 
__u8
 
	mp‹t
;

277 
	mIFLA_UNSPEC
,

278 
	mIFLA_ADDRESS
,

279 
	mIFLA_BROADCAST
,

280 
	mIFLA_IFNAME
,

281 
	mIFLA_MTU
,

282 
	mIFLA_LINK
,

283 
	mIFLA_QDISC
,

284 
	mIFLA_STATS
,

285 
	mIFLA_COST
,

286 
	#IFLA_COST
 
IFLA_COST


	)

287 
	mIFLA_PRIORITY
,

288 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

289 
	mIFLA_MASTER
,

290 
	#IFLA_MASTER
 
IFLA_MASTER


	)

291 
	mIFLA_WIRELESS
,

292 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

293 
	mIFLA_PROTINFO
,

294 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

295 
	mIFLA_TXQLEN
,

296 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

297 
	mIFLA_MAP
,

298 
	#IFLA_MAP
 
IFLA_MAP


	)

299 
	mIFLA_WEIGHT
,

300 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

301 
	mIFLA_OPERSTATE
,

302 
	mIFLA_LINKMODE
,

303 
	mIFLA_LINKINFO
,

304 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

305 
	mIFLA_NET_NS_PID
,

306 
	mIFLA_IFALIAS
,

307 
	mIFLA_NUM_VF
,

308 
	mIFLA_VFINFO_LIST
,

309 
	mIFLA_STATS64
,

310 
	mIFLA_VF_PORTS
,

311 
	mIFLA_PORT_SELF
,

312 
	mIFLA_AF_SPEC
,

313 
	mIFLA_GROUP
,

314 
	mIFLA_NET_NS_FD
,

315 
	mIFLA_EXT_MASK
,

316 
	mIFLA_PROMISCUITY
,

317 
	#IFLA_PROMISCUITY
 
IFLA_PROMISCUITY


	)

318 
	mIFLA_NUM_TX_QUEUES
,

319 
	mIFLA_NUM_RX_QUEUES
,

320 
	mIFLA_CARRIER
,

321 
	mIFLA_PHYS_PORT_ID
,

322 
	mIFLA_CARRIER_CHANGES
,

323 
	mIFLA_PHYS_SWITCH_ID
,

324 
	mIFLA_LINK_NETNSID
,

325 
	mIFLA_PHYS_PORT_NAME
,

326 
	mIFLA_PROTO_DOWN
,

327 
	mIFLA_GSO_MAX_SEGS
,

328 
	mIFLA_GSO_MAX_SIZE
,

329 
	mIFLA_PAD
,

330 
	mIFLA_XDP
,

331 
	mIFLA_EVENT
,

332 
	mIFLA_NEW_NETNSID
,

333 
	mIFLA_IF_NETNSID
,

334 
	mIFLA_TARGET_NETNSID
 = 
IFLA_IF_NETNSID
,

335 
	mIFLA_CARRIER_UP_COUNT
,

336 
	mIFLA_CARRIER_DOWN_COUNT
,

337 
	mIFLA_NEW_IFINDEX
,

338 
	mIFLA_MIN_MTU
,

339 
	mIFLA_MAX_MTU
,

340 
	mIFLA_PROP_LIST
,

341 
	mIFLA_ALT_IFNAME
,

342 
	mIFLA_PERM_ADDRESS
,

343 
	mIFLA_PROTO_DOWN_REASON
,

348 
	mIFLA_PARENT_DEV_NAME
,

349 
	mIFLA_PARENT_DEV_BUS_NAME
,

351 
	m__IFLA_MAX


355 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

358 
	mIFLA_PROTO_DOWN_REASON_UNSPEC
,

359 
	mIFLA_PROTO_DOWN_REASON_MASK
,

360 
	mIFLA_PROTO_DOWN_REASON_VALUE
,

362 
	m__IFLA_PROTO_DOWN_REASON_CNT
,

363 
	mIFLA_PROTO_DOWN_REASON_MAX
 = 
__IFLA_PROTO_DOWN_REASON_CNT
 - 1

367 
	#IFLA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
iföfomsg
))))

	)

368 
	#IFLA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
iföfomsg
))

	)

371 
	mIFLA_INET_UNSPEC
,

372 
	mIFLA_INET_CONF
,

373 
	m__IFLA_INET_MAX
,

376 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

409 
	mIFLA_INET6_UNSPEC
,

410 
	mIFLA_INET6_FLAGS
,

411 
	mIFLA_INET6_CONF
,

412 
	mIFLA_INET6_STATS
,

413 
	mIFLA_INET6_MCAST
,

414 
	mIFLA_INET6_CACHEINFO
,

415 
	mIFLA_INET6_ICMP6STATS
,

416 
	mIFLA_INET6_TOKEN
,

417 
	mIFLA_INET6_ADDR_GEN_MODE
,

418 
	mIFLA_INET6_RA_MTU
,

419 
	m__IFLA_INET6_MAX


422 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

424 
	eö6_addr_gí_mode
 {

425 
	mIN6_ADDR_GEN_MODE_EUI64
,

426 
	mIN6_ADDR_GEN_MODE_NONE
,

427 
	mIN6_ADDR_GEN_MODE_STABLE_PRIVACY
,

428 
	mIN6_ADDR_GEN_MODE_RANDOM
,

434 
	mIFLA_BR_UNSPEC
,

435 
	mIFLA_BR_FORWARD_DELAY
,

436 
	mIFLA_BR_HELLO_TIME
,

437 
	mIFLA_BR_MAX_AGE
,

438 
	mIFLA_BR_AGEING_TIME
,

439 
	mIFLA_BR_STP_STATE
,

440 
	mIFLA_BR_PRIORITY
,

441 
	mIFLA_BR_VLAN_FILTERING
,

442 
	mIFLA_BR_VLAN_PROTOCOL
,

443 
	mIFLA_BR_GROUP_FWD_MASK
,

444 
	mIFLA_BR_ROOT_ID
,

445 
	mIFLA_BR_BRIDGE_ID
,

446 
	mIFLA_BR_ROOT_PORT
,

447 
	mIFLA_BR_ROOT_PATH_COST
,

448 
	mIFLA_BR_TOPOLOGY_CHANGE
,

449 
	mIFLA_BR_TOPOLOGY_CHANGE_DETECTED
,

450 
	mIFLA_BR_HELLO_TIMER
,

451 
	mIFLA_BR_TCN_TIMER
,

452 
	mIFLA_BR_TOPOLOGY_CHANGE_TIMER
,

453 
	mIFLA_BR_GC_TIMER
,

454 
	mIFLA_BR_GROUP_ADDR
,

455 
	mIFLA_BR_FDB_FLUSH
,

456 
	mIFLA_BR_MCAST_ROUTER
,

457 
	mIFLA_BR_MCAST_SNOOPING
,

458 
	mIFLA_BR_MCAST_QUERY_USE_IFADDR
,

459 
	mIFLA_BR_MCAST_QUERIER
,

460 
	mIFLA_BR_MCAST_HASH_ELASTICITY
,

461 
	mIFLA_BR_MCAST_HASH_MAX
,

462 
	mIFLA_BR_MCAST_LAST_MEMBER_CNT
,

463 
	mIFLA_BR_MCAST_STARTUP_QUERY_CNT
,

464 
	mIFLA_BR_MCAST_LAST_MEMBER_INTVL
,

465 
	mIFLA_BR_MCAST_MEMBERSHIP_INTVL
,

466 
	mIFLA_BR_MCAST_QUERIER_INTVL
,

467 
	mIFLA_BR_MCAST_QUERY_INTVL
,

468 
	mIFLA_BR_MCAST_QUERY_RESPONSE_INTVL
,

469 
	mIFLA_BR_MCAST_STARTUP_QUERY_INTVL
,

470 
	mIFLA_BR_NF_CALL_IPTABLES
,

471 
	mIFLA_BR_NF_CALL_IP6TABLES
,

472 
	mIFLA_BR_NF_CALL_ARPTABLES
,

473 
	mIFLA_BR_VLAN_DEFAULT_PVID
,

474 
	mIFLA_BR_PAD
,

475 
	mIFLA_BR_VLAN_STATS_ENABLED
,

476 
	mIFLA_BR_MCAST_STATS_ENABLED
,

477 
	mIFLA_BR_MCAST_IGMP_VERSION
,

478 
	mIFLA_BR_MCAST_MLD_VERSION
,

479 
	mIFLA_BR_VLAN_STATS_PER_PORT
,

480 
	mIFLA_BR_MULTI_BOOLOPT
,

481 
	mIFLA_BR_MCAST_QUERIER_STATE
,

482 
	m__IFLA_BR_MAX
,

485 
	#IFLA_BR_MAX
 (
__IFLA_BR_MAX
 - 1)

	)

487 
	siÊa_bridge_id
 {

488 
__u8
 
	m¥io
[2];

489 
__u8
 
	maddr
[6];

493 
	mBRIDGE_MODE_UNSPEC
,

494 
	mBRIDGE_MODE_HAIRPIN
,

498 
	mIFLA_BRPORT_UNSPEC
,

499 
	mIFLA_BRPORT_STATE
,

500 
	mIFLA_BRPORT_PRIORITY
,

501 
	mIFLA_BRPORT_COST
,

502 
	mIFLA_BRPORT_MODE
,

503 
	mIFLA_BRPORT_GUARD
,

504 
	mIFLA_BRPORT_PROTECT
,

505 
	mIFLA_BRPORT_FAST_LEAVE
,

506 
	mIFLA_BRPORT_LEARNING
,

507 
	mIFLA_BRPORT_UNICAST_FLOOD
,

508 
	mIFLA_BRPORT_PROXYARP
,

509 
	mIFLA_BRPORT_LEARNING_SYNC
,

510 
	mIFLA_BRPORT_PROXYARP_WIFI
,

511 
	mIFLA_BRPORT_ROOT_ID
,

512 
	mIFLA_BRPORT_BRIDGE_ID
,

513 
	mIFLA_BRPORT_DESIGNATED_PORT
,

514 
	mIFLA_BRPORT_DESIGNATED_COST
,

515 
	mIFLA_BRPORT_ID
,

516 
	mIFLA_BRPORT_NO
,

517 
	mIFLA_BRPORT_TOPOLOGY_CHANGE_ACK
,

518 
	mIFLA_BRPORT_CONFIG_PENDING
,

519 
	mIFLA_BRPORT_MESSAGE_AGE_TIMER
,

520 
	mIFLA_BRPORT_FORWARD_DELAY_TIMER
,

521 
	mIFLA_BRPORT_HOLD_TIMER
,

522 
	mIFLA_BRPORT_FLUSH
,

523 
	mIFLA_BRPORT_MULTICAST_ROUTER
,

524 
	mIFLA_BRPORT_PAD
,

525 
	mIFLA_BRPORT_MCAST_FLOOD
,

526 
	mIFLA_BRPORT_MCAST_TO_UCAST
,

527 
	mIFLA_BRPORT_VLAN_TUNNEL
,

528 
	mIFLA_BRPORT_BCAST_FLOOD
,

529 
	mIFLA_BRPORT_GROUP_FWD_MASK
,

530 
	mIFLA_BRPORT_NEIGH_SUPPRESS
,

531 
	mIFLA_BRPORT_ISOLATED
,

532 
	mIFLA_BRPORT_BACKUP_PORT
,

533 
	mIFLA_BRPORT_MRP_RING_OPEN
,

534 
	mIFLA_BRPORT_MRP_IN_OPEN
,

535 
	mIFLA_BRPORT_MCAST_EHT_HOSTS_LIMIT
,

536 
	mIFLA_BRPORT_MCAST_EHT_HOSTS_CNT
,

537 
	m__IFLA_BRPORT_MAX


539 
	#IFLA_BRPORT_MAX
 (
__IFLA_BRPORT_MAX
 - 1)

	)

541 
	siÊa_ˇcheöfo
 {

542 
__u32
 
	mmax_ªasm_Àn
;

543 
__u32
 
	mt°amp
;

544 
__u32
 
	mªachabÀ_time
;

545 
__u32
 
	mªå™s_time
;

549 
	mIFLA_INFO_UNSPEC
,

550 
	mIFLA_INFO_KIND
,

551 
	mIFLA_INFO_DATA
,

552 
	mIFLA_INFO_XSTATS
,

553 
	mIFLA_INFO_SLAVE_KIND
,

554 
	mIFLA_INFO_SLAVE_DATA
,

555 
	m__IFLA_INFO_MAX
,

558 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

563 
	mIFLA_VLAN_UNSPEC
,

564 
	mIFLA_VLAN_ID
,

565 
	mIFLA_VLAN_FLAGS
,

566 
	mIFLA_VLAN_EGRESS_QOS
,

567 
	mIFLA_VLAN_INGRESS_QOS
,

568 
	mIFLA_VLAN_PROTOCOL
,

569 
	m__IFLA_VLAN_MAX
,

572 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

574 
	siÊa_vœn_Êags
 {

575 
__u32
 
	mÊags
;

576 
__u32
 
	mmask
;

580 
	mIFLA_VLAN_QOS_UNSPEC
,

581 
	mIFLA_VLAN_QOS_MAPPING
,

582 
	m__IFLA_VLAN_QOS_MAX


585 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

587 
	siÊa_vœn_qos_m≠pög
 {

588 
__u32
 
	m‰om
;

589 
__u32
 
	mto
;

594 
	mIFLA_MACVLAN_UNSPEC
,

595 
	mIFLA_MACVLAN_MODE
,

596 
	mIFLA_MACVLAN_FLAGS
,

597 
	mIFLA_MACVLAN_MACADDR_MODE
,

598 
	mIFLA_MACVLAN_MACADDR
,

599 
	mIFLA_MACVLAN_MACADDR_DATA
,

600 
	mIFLA_MACVLAN_MACADDR_COUNT
,

601 
	mIFLA_MACVLAN_BC_QUEUE_LEN
,

602 
	mIFLA_MACVLAN_BC_QUEUE_LEN_USED
,

603 
	m__IFLA_MACVLAN_MAX
,

606 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

608 
	emacvœn_mode
 {

609 
	mMACVLAN_MODE_PRIVATE
 = 1,

610 
	mMACVLAN_MODE_VEPA
 = 2,

611 
	mMACVLAN_MODE_BRIDGE
 = 4,

612 
	mMACVLAN_MODE_PASSTHRU
 = 8,

613 
	mMACVLAN_MODE_SOURCE
 = 16,

616 
	emacvœn_maˇddr_mode
 {

617 
	mMACVLAN_MACADDR_ADD
,

618 
	mMACVLAN_MACADDR_DEL
,

619 
	mMACVLAN_MACADDR_FLUSH
,

620 
	mMACVLAN_MACADDR_SET
,

623 
	#MACVLAN_FLAG_NOPROMISC
 1

	)

624 
	#MACVLAN_FLAG_NODST
 2

	)

628 
	mIFLA_VRF_UNSPEC
,

629 
	mIFLA_VRF_TABLE
,

630 
	m__IFLA_VRF_MAX


633 
	#IFLA_VRF_MAX
 (
__IFLA_VRF_MAX
 - 1)

	)

636 
	mIFLA_VRF_PORT_UNSPEC
,

637 
	mIFLA_VRF_PORT_TABLE
,

638 
	m__IFLA_VRF_PORT_MAX


641 
	#IFLA_VRF_PORT_MAX
 (
__IFLA_VRF_PORT_MAX
 - 1)

	)

645 
	mIFLA_MACSEC_UNSPEC
,

646 
	mIFLA_MACSEC_SCI
,

647 
	mIFLA_MACSEC_PORT
,

648 
	mIFLA_MACSEC_ICV_LEN
,

649 
	mIFLA_MACSEC_CIPHER_SUITE
,

650 
	mIFLA_MACSEC_WINDOW
,

651 
	mIFLA_MACSEC_ENCODING_SA
,

652 
	mIFLA_MACSEC_ENCRYPT
,

653 
	mIFLA_MACSEC_PROTECT
,

654 
	mIFLA_MACSEC_INC_SCI
,

655 
	mIFLA_MACSEC_ES
,

656 
	mIFLA_MACSEC_SCB
,

657 
	mIFLA_MACSEC_REPLAY_PROTECT
,

658 
	mIFLA_MACSEC_VALIDATION
,

659 
	mIFLA_MACSEC_PAD
,

660 
	mIFLA_MACSEC_OFFLOAD
,

661 
	m__IFLA_MACSEC_MAX
,

664 
	#IFLA_MACSEC_MAX
 (
__IFLA_MACSEC_MAX
 - 1)

	)

668 
	mIFLA_XFRM_UNSPEC
,

669 
	mIFLA_XFRM_LINK
,

670 
	mIFLA_XFRM_IF_ID
,

671 
	m__IFLA_XFRM_MAX


674 
	#IFLA_XFRM_MAX
 (
__IFLA_XFRM_MAX
 - 1)

	)

676 
	emac£c_vÆid©i⁄_ty≥
 {

677 
	mMACSEC_VALIDATE_DISABLED
 = 0,

678 
	mMACSEC_VALIDATE_CHECK
 = 1,

679 
	mMACSEC_VALIDATE_STRICT
 = 2,

680 
	m__MACSEC_VALIDATE_END
,

681 
	mMACSEC_VALIDATE_MAX
 = 
__MACSEC_VALIDATE_END
 - 1,

684 
	emac£c_ofÊﬂd
 {

685 
	mMACSEC_OFFLOAD_OFF
 = 0,

686 
	mMACSEC_OFFLOAD_PHY
 = 1,

687 
	mMACSEC_OFFLOAD_MAC
 = 2,

688 
	m__MACSEC_OFFLOAD_END
,

689 
	mMACSEC_OFFLOAD_MAX
 = 
__MACSEC_OFFLOAD_END
 - 1,

694 
	mIFLA_IPVLAN_UNSPEC
,

695 
	mIFLA_IPVLAN_MODE
,

696 
	mIFLA_IPVLAN_FLAGS
,

697 
	m__IFLA_IPVLAN_MAX


700 
	#IFLA_IPVLAN_MAX
 (
__IFLA_IPVLAN_MAX
 - 1)

	)

702 
	eùvœn_mode
 {

703 
	mIPVLAN_MODE_L2
 = 0,

704 
	mIPVLAN_MODE_L3
,

705 
	mIPVLAN_MODE_L3S
,

706 
	mIPVLAN_MODE_MAX


709 
	#IPVLAN_F_PRIVATE
 0x01

	)

710 
	#IPVLAN_F_VEPA
 0x02

	)

714 
	mIFLA_VXLAN_UNSPEC
,

715 
	mIFLA_VXLAN_ID
,

716 
	mIFLA_VXLAN_GROUP
,

717 
	mIFLA_VXLAN_LINK
,

718 
	mIFLA_VXLAN_LOCAL
,

719 
	mIFLA_VXLAN_TTL
,

720 
	mIFLA_VXLAN_TOS
,

721 
	mIFLA_VXLAN_LEARNING
,

722 
	mIFLA_VXLAN_AGEING
,

723 
	mIFLA_VXLAN_LIMIT
,

724 
	mIFLA_VXLAN_PORT_RANGE
,

725 
	mIFLA_VXLAN_PROXY
,

726 
	mIFLA_VXLAN_RSC
,

727 
	mIFLA_VXLAN_L2MISS
,

728 
	mIFLA_VXLAN_L3MISS
,

729 
	mIFLA_VXLAN_PORT
,

730 
	mIFLA_VXLAN_GROUP6
,

731 
	mIFLA_VXLAN_LOCAL6
,

732 
	mIFLA_VXLAN_UDP_CSUM
,

733 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_TX
,

734 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_RX
,

735 
	mIFLA_VXLAN_REMCSUM_TX
,

736 
	mIFLA_VXLAN_REMCSUM_RX
,

737 
	mIFLA_VXLAN_GBP
,

738 
	mIFLA_VXLAN_REMCSUM_NOPARTIAL
,

739 
	mIFLA_VXLAN_COLLECT_METADATA
,

740 
	mIFLA_VXLAN_LABEL
,

741 
	mIFLA_VXLAN_GPE
,

742 
	mIFLA_VXLAN_TTL_INHERIT
,

743 
	mIFLA_VXLAN_DF
,

744 
	mIFLA_VXLAN_FAN_MAP
 = 33,

745 
	m__IFLA_VXLAN_MAX


747 
	#IFLA_VXLAN_MAX
 (
__IFLA_VXLAN_MAX
 - 1)

	)

749 
	siÊa_vxœn_p‹t_ønge
 {

750 
__be16
 
	mlow
;

751 
__be16
 
	mhigh
;

754 
	eiÊa_vxœn_df
 {

755 
	mVXLAN_DF_UNSET
 = 0,

756 
	mVXLAN_DF_SET
,

757 
	mVXLAN_DF_INHERIT
,

758 
	m__VXLAN_DF_END
,

759 
	mVXLAN_DF_MAX
 = 
__VXLAN_DF_END
 - 1,

764 
	mIFLA_GENEVE_UNSPEC
,

765 
	mIFLA_GENEVE_ID
,

766 
	mIFLA_GENEVE_REMOTE
,

767 
	mIFLA_GENEVE_TTL
,

768 
	mIFLA_GENEVE_TOS
,

769 
	mIFLA_GENEVE_PORT
,

770 
	mIFLA_GENEVE_COLLECT_METADATA
,

771 
	mIFLA_GENEVE_REMOTE6
,

772 
	mIFLA_GENEVE_UDP_CSUM
,

773 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_TX
,

774 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_RX
,

775 
	mIFLA_GENEVE_LABEL
,

776 
	mIFLA_GENEVE_TTL_INHERIT
,

777 
	mIFLA_GENEVE_DF
,

778 
	m__IFLA_GENEVE_MAX


780 
	#IFLA_GENEVE_MAX
 (
__IFLA_GENEVE_MAX
 - 1)

	)

782 
	eiÊa_gíeve_df
 {

783 
	mGENEVE_DF_UNSET
 = 0,

784 
	mGENEVE_DF_SET
,

785 
	mGENEVE_DF_INHERIT
,

786 
	m__GENEVE_DF_END
,

787 
	mGENEVE_DF_MAX
 = 
__GENEVE_DF_END
 - 1,

792 
	mIFLA_BAREUDP_UNSPEC
,

793 
	mIFLA_BAREUDP_PORT
,

794 
	mIFLA_BAREUDP_ETHERTYPE
,

795 
	mIFLA_BAREUDP_SRCPORT_MIN
,

796 
	mIFLA_BAREUDP_MULTIPROTO_MODE
,

797 
	m__IFLA_BAREUDP_MAX


800 
	#IFLA_BAREUDP_MAX
 (
__IFLA_BAREUDP_MAX
 - 1)

	)

804 
	mIFLA_PPP_UNSPEC
,

805 
	mIFLA_PPP_DEV_FD
,

806 
	m__IFLA_PPP_MAX


808 
	#IFLA_PPP_MAX
 (
__IFLA_PPP_MAX
 - 1)

	)

812 
	eiÊa_gç_rﬁe
 {

813 
	mGTP_ROLE_GGSN
 = 0,

814 
	mGTP_ROLE_SGSN
,

818 
	mIFLA_GTP_UNSPEC
,

819 
	mIFLA_GTP_FD0
,

820 
	mIFLA_GTP_FD1
,

821 
	mIFLA_GTP_PDP_HASHSIZE
,

822 
	mIFLA_GTP_ROLE
,

823 
	m__IFLA_GTP_MAX
,

825 
	#IFLA_GTP_MAX
 (
__IFLA_GTP_MAX
 - 1)

	)

830 
	mIFLA_BOND_UNSPEC
,

831 
	mIFLA_BOND_MODE
,

832 
	mIFLA_BOND_ACTIVE_SLAVE
,

833 
	mIFLA_BOND_MIIMON
,

834 
	mIFLA_BOND_UPDELAY
,

835 
	mIFLA_BOND_DOWNDELAY
,

836 
	mIFLA_BOND_USE_CARRIER
,

837 
	mIFLA_BOND_ARP_INTERVAL
,

838 
	mIFLA_BOND_ARP_IP_TARGET
,

839 
	mIFLA_BOND_ARP_VALIDATE
,

840 
	mIFLA_BOND_ARP_ALL_TARGETS
,

841 
	mIFLA_BOND_PRIMARY
,

842 
	mIFLA_BOND_PRIMARY_RESELECT
,

843 
	mIFLA_BOND_FAIL_OVER_MAC
,

844 
	mIFLA_BOND_XMIT_HASH_POLICY
,

845 
	mIFLA_BOND_RESEND_IGMP
,

846 
	mIFLA_BOND_NUM_PEER_NOTIF
,

847 
	mIFLA_BOND_ALL_SLAVES_ACTIVE
,

848 
	mIFLA_BOND_MIN_LINKS
,

849 
	mIFLA_BOND_LP_INTERVAL
,

850 
	mIFLA_BOND_PACKETS_PER_SLAVE
,

851 
	mIFLA_BOND_AD_LACP_RATE
,

852 
	mIFLA_BOND_AD_SELECT
,

853 
	mIFLA_BOND_AD_INFO
,

854 
	mIFLA_BOND_AD_ACTOR_SYS_PRIO
,

855 
	mIFLA_BOND_AD_USER_PORT_KEY
,

856 
	mIFLA_BOND_AD_ACTOR_SYSTEM
,

857 
	mIFLA_BOND_TLB_DYNAMIC_LB
,

858 
	mIFLA_BOND_PEER_NOTIF_DELAY
,

859 
	mIFLA_BOND_AD_LACP_ACTIVE
,

860 
	mIFLA_BOND_MISSED_MAX
,

861 
	m__IFLA_BOND_MAX
,

864 
	#IFLA_BOND_MAX
 (
__IFLA_BOND_MAX
 - 1)

	)

867 
	mIFLA_BOND_AD_INFO_UNSPEC
,

868 
	mIFLA_BOND_AD_INFO_AGGREGATOR
,

869 
	mIFLA_BOND_AD_INFO_NUM_PORTS
,

870 
	mIFLA_BOND_AD_INFO_ACTOR_KEY
,

871 
	mIFLA_BOND_AD_INFO_PARTNER_KEY
,

872 
	mIFLA_BOND_AD_INFO_PARTNER_MAC
,

873 
	m__IFLA_BOND_AD_INFO_MAX
,

876 
	#IFLA_BOND_AD_INFO_MAX
 (
__IFLA_BOND_AD_INFO_MAX
 - 1)

	)

879 
	mIFLA_BOND_SLAVE_UNSPEC
,

880 
	mIFLA_BOND_SLAVE_STATE
,

881 
	mIFLA_BOND_SLAVE_MII_STATUS
,

882 
	mIFLA_BOND_SLAVE_LINK_FAILURE_COUNT
,

883 
	mIFLA_BOND_SLAVE_PERM_HWADDR
,

884 
	mIFLA_BOND_SLAVE_QUEUE_ID
,

885 
	mIFLA_BOND_SLAVE_AD_AGGREGATOR_ID
,

886 
	mIFLA_BOND_SLAVE_AD_ACTOR_OPER_PORT_STATE
,

887 
	mIFLA_BOND_SLAVE_AD_PARTNER_OPER_PORT_STATE
,

888 
	m__IFLA_BOND_SLAVE_MAX
,

891 
	#IFLA_BOND_SLAVE_MAX
 (
__IFLA_BOND_SLAVE_MAX
 - 1)

	)

896 
	mIFLA_VF_INFO_UNSPEC
,

897 
	mIFLA_VF_INFO
,

898 
	m__IFLA_VF_INFO_MAX
,

901 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

904 
	mIFLA_VF_UNSPEC
,

905 
	mIFLA_VF_MAC
,

906 
	mIFLA_VF_VLAN
,

907 
	mIFLA_VF_TX_RATE
,

908 
	mIFLA_VF_SPOOFCHK
,

909 
	mIFLA_VF_LINK_STATE
,

910 
	mIFLA_VF_RATE
,

911 
	mIFLA_VF_RSS_QUERY_EN
,

914 
	mIFLA_VF_STATS
,

915 
	mIFLA_VF_TRUST
,

916 
	mIFLA_VF_IB_NODE_GUID
,

917 
	mIFLA_VF_IB_PORT_GUID
,

918 
	mIFLA_VF_VLAN_LIST
,

919 
	mIFLA_VF_BROADCAST
,

920 
	m__IFLA_VF_MAX
,

923 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

925 
	siÊa_vf_mac
 {

926 
__u32
 
	mvf
;

927 
__u8
 
	mmac
[32];

930 
	siÊa_vf_brﬂdˇ°
 {

931 
__u8
 
	mbrﬂdˇ°
[32];

934 
	siÊa_vf_vœn
 {

935 
__u32
 
	mvf
;

936 
__u32
 
	mvœn
;

937 
__u32
 
	mqos
;

941 
	mIFLA_VF_VLAN_INFO_UNSPEC
,

942 
	mIFLA_VF_VLAN_INFO
,

943 
	m__IFLA_VF_VLAN_INFO_MAX
,

946 
	#IFLA_VF_VLAN_INFO_MAX
 (
__IFLA_VF_VLAN_INFO_MAX
 - 1)

	)

947 
	#MAX_VLAN_LIST_LEN
 1

	)

949 
	siÊa_vf_vœn_öfo
 {

950 
__u32
 
	mvf
;

951 
__u32
 
	mvœn
;

952 
__u32
 
	mqos
;

953 
__be16
 
	mvœn_¥Ÿo
;

956 
	siÊa_vf_tx_øã
 {

957 
__u32
 
	mvf
;

958 
__u32
 
	møã
;

961 
	siÊa_vf_øã
 {

962 
__u32
 
	mvf
;

963 
__u32
 
	mmö_tx_øã
;

964 
__u32
 
	mmax_tx_øã
;

967 
	siÊa_vf_•oofchk
 {

968 
__u32
 
	mvf
;

969 
__u32
 
	m£âög
;

972 
	siÊa_vf_guid
 {

973 
__u32
 
	mvf
;

974 
__u64
 
	mguid
;

978 
	mIFLA_VF_LINK_STATE_AUTO
,

979 
	mIFLA_VF_LINK_STATE_ENABLE
,

980 
	mIFLA_VF_LINK_STATE_DISABLE
,

981 
	m__IFLA_VF_LINK_STATE_MAX
,

984 
	siÊa_vf_lök_°©e
 {

985 
__u32
 
	mvf
;

986 
__u32
 
	mlök_°©e
;

989 
	siÊa_vf_rss_quîy_í
 {

990 
__u32
 
	mvf
;

991 
__u32
 
	m£âög
;

995 
	mIFLA_VF_STATS_RX_PACKETS
,

996 
	mIFLA_VF_STATS_TX_PACKETS
,

997 
	mIFLA_VF_STATS_RX_BYTES
,

998 
	mIFLA_VF_STATS_TX_BYTES
,

999 
	mIFLA_VF_STATS_BROADCAST
,

1000 
	mIFLA_VF_STATS_MULTICAST
,

1001 
	mIFLA_VF_STATS_PAD
,

1002 
	mIFLA_VF_STATS_RX_DROPPED
,

1003 
	mIFLA_VF_STATS_TX_DROPPED
,

1004 
	m__IFLA_VF_STATS_MAX
,

1007 
	#IFLA_VF_STATS_MAX
 (
__IFLA_VF_STATS_MAX
 - 1)

	)

1009 
	siÊa_vf_åu°
 {

1010 
__u32
 
	mvf
;

1011 
__u32
 
	m£âög
;

1030 
	mIFLA_VF_PORT_UNSPEC
,

1031 
	mIFLA_VF_PORT
,

1032 
	m__IFLA_VF_PORT_MAX
,

1035 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

1038 
	mIFLA_PORT_UNSPEC
,

1039 
	mIFLA_PORT_VF
,

1040 
	mIFLA_PORT_PROFILE
,

1041 
	mIFLA_PORT_VSI_TYPE
,

1042 
	mIFLA_PORT_INSTANCE_UUID
,

1043 
	mIFLA_PORT_HOST_UUID
,

1044 
	mIFLA_PORT_REQUEST
,

1045 
	mIFLA_PORT_RESPONSE
,

1046 
	m__IFLA_PORT_MAX
,

1049 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

1051 
	#PORT_PROFILE_MAX
 40

	)

1052 
	#PORT_UUID_MAX
 16

	)

1053 
	#PORT_SELF_VF
 -1

	)

1056 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

1057 
	mPORT_REQUEST_PREASSOCIATE_RR
,

1058 
	mPORT_REQUEST_ASSOCIATE
,

1059 
	mPORT_REQUEST_DISASSOCIATE
,

1063 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

1064 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

1065 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

1066 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

1067 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

1068 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

1069 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

1071 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

1072 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

1073 
	mPORT_PROFILE_RESPONSE_INVALID
,

1074 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

1075 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

1076 
	mPORT_PROFILE_RESPONSE_ERROR
,

1079 
	siÊa_p‹t_vsi
 {

1080 
__u8
 
	mvsi_mgr_id
;

1081 
__u8
 
	mvsi_ty≥_id
[3];

1082 
__u8
 
	mvsi_ty≥_vîsi⁄
;

1083 
__u8
 
	m∑d
[3];

1090 
	mIFLA_IPOIB_UNSPEC
,

1091 
	mIFLA_IPOIB_PKEY
,

1092 
	mIFLA_IPOIB_MODE
,

1093 
	mIFLA_IPOIB_UMCAST
,

1094 
	m__IFLA_IPOIB_MAX


1098 
	mIPOIB_MODE_DATAGRAM
 = 0,

1099 
	mIPOIB_MODE_CONNECTED
 = 1,

1102 
	#IFLA_IPOIB_MAX
 (
__IFLA_IPOIB_MAX
 - 1)

	)

1109 
	mHSR_PROTOCOL_HSR
,

1110 
	mHSR_PROTOCOL_PRP
,

1111 
	mHSR_PROTOCOL_MAX
,

1115 
	mIFLA_HSR_UNSPEC
,

1116 
	mIFLA_HSR_SLAVE1
,

1117 
	mIFLA_HSR_SLAVE2
,

1118 
	mIFLA_HSR_MULTICAST_SPEC
,

1119 
	mIFLA_HSR_SUPERVISION_ADDR
,

1120 
	mIFLA_HSR_SEQ_NR
,

1121 
	mIFLA_HSR_VERSION
,

1122 
	mIFLA_HSR_PROTOCOL
,

1125 
	m__IFLA_HSR_MAX
,

1128 
	#IFLA_HSR_MAX
 (
__IFLA_HSR_MAX
 - 1)

	)

1132 
	sif_°©s_msg
 {

1133 
__u8
 
	mÁmûy
;

1134 
__u8
 
	m∑d1
;

1135 
__u16
 
	m∑d2
;

1136 
__u32
 
	mifödex
;

1137 
__u32
 
	mfûãr_mask
;

1144 
	mIFLA_STATS_UNSPEC
,

1145 
	mIFLA_STATS_LINK_64
,

1146 
	mIFLA_STATS_LINK_XSTATS
,

1147 
	mIFLA_STATS_LINK_XSTATS_SLAVE
,

1148 
	mIFLA_STATS_LINK_OFFLOAD_XSTATS
,

1149 
	mIFLA_STATS_AF_SPEC
,

1150 
	m__IFLA_STATS_MAX
,

1153 
	#IFLA_STATS_MAX
 (
__IFLA_STATS_MAX
 - 1)

	)

1155 
	#IFLA_STATS_FILTER_BIT
(
ATTR
Ë(1 << (ATTR - 1))

	)

1163 
	mLINK_XSTATS_TYPE_UNSPEC
,

1164 
	mLINK_XSTATS_TYPE_BRIDGE
,

1165 
	mLINK_XSTATS_TYPE_BOND
,

1166 
	m__LINK_XSTATS_TYPE_MAX


1168 
	#LINK_XSTATS_TYPE_MAX
 (
__LINK_XSTATS_TYPE_MAX
 - 1)

	)

1172 
	mIFLA_OFFLOAD_XSTATS_UNSPEC
,

1173 
	mIFLA_OFFLOAD_XSTATS_CPU_HIT
,

1174 
	m__IFLA_OFFLOAD_XSTATS_MAX


1176 
	#IFLA_OFFLOAD_XSTATS_MAX
 (
__IFLA_OFFLOAD_XSTATS_MAX
 - 1)

	)

1180 
	#XDP_FLAGS_UPDATE_IF_NOEXIST
 (1U << 0)

	)

1181 
	#XDP_FLAGS_SKB_MODE
 (1U << 1)

	)

1182 
	#XDP_FLAGS_DRV_MODE
 (1U << 2)

	)

1183 
	#XDP_FLAGS_HW_MODE
 (1U << 3)

	)

1184 
	#XDP_FLAGS_REPLACE
 (1U << 4)

	)

1185 
	#XDP_FLAGS_MODES
 (
XDP_FLAGS_SKB_MODE
 | \

1186 
XDP_FLAGS_DRV_MODE
 | \

1187 
XDP_FLAGS_HW_MODE
)

	)

1188 
	#XDP_FLAGS_MASK
 (
XDP_FLAGS_UPDATE_IF_NOEXIST
 | \

1189 
XDP_FLAGS_MODES
 | 
XDP_FLAGS_REPLACE
)

	)

1193 
	mXDP_ATTACHED_NONE
 = 0,

1194 
	mXDP_ATTACHED_DRV
,

1195 
	mXDP_ATTACHED_SKB
,

1196 
	mXDP_ATTACHED_HW
,

1197 
	mXDP_ATTACHED_MULTI
,

1201 
	mIFLA_XDP_UNSPEC
,

1202 
	mIFLA_XDP_FD
,

1203 
	mIFLA_XDP_ATTACHED
,

1204 
	mIFLA_XDP_FLAGS
,

1205 
	mIFLA_XDP_PROG_ID
,

1206 
	mIFLA_XDP_DRV_PROG_ID
,

1207 
	mIFLA_XDP_SKB_PROG_ID
,

1208 
	mIFLA_XDP_HW_PROG_ID
,

1209 
	mIFLA_XDP_EXPECTED_FD
,

1210 
	m__IFLA_XDP_MAX
,

1213 
	#IFLA_XDP_MAX
 (
__IFLA_XDP_MAX
 - 1)

	)

1216 
	mIFLA_EVENT_NONE
,

1217 
	mIFLA_EVENT_REBOOT
,

1218 
	mIFLA_EVENT_FEATURES
,

1219 
	mIFLA_EVENT_BONDING_FAILOVER
,

1220 
	mIFLA_EVENT_NOTIFY_PEERS
,

1221 
	mIFLA_EVENT_IGMP_RESEND
,

1222 
	mIFLA_EVENT_BONDING_OPTIONS
,

1228 
	mIFLA_TUN_UNSPEC
,

1229 
	mIFLA_TUN_OWNER
,

1230 
	mIFLA_TUN_GROUP
,

1231 
	mIFLA_TUN_TYPE
,

1232 
	mIFLA_TUN_PI
,

1233 
	mIFLA_TUN_VNET_HDR
,

1234 
	mIFLA_TUN_PERSIST
,

1235 
	mIFLA_TUN_MULTI_QUEUE
,

1236 
	mIFLA_TUN_NUM_QUEUES
,

1237 
	mIFLA_TUN_NUM_DISABLED_QUEUES
,

1238 
	m__IFLA_TUN_MAX
,

1241 
	#IFLA_TUN_MAX
 (
__IFLA_TUN_MAX
 - 1)

	)

1245 
	#RMNET_FLAGS_INGRESS_DEAGGREGATION
 (1U << 0)

	)

1246 
	#RMNET_FLAGS_INGRESS_MAP_COMMANDS
 (1U << 1)

	)

1247 
	#RMNET_FLAGS_INGRESS_MAP_CKSUMV4
 (1U << 2)

	)

1248 
	#RMNET_FLAGS_EGRESS_MAP_CKSUMV4
 (1U << 3)

	)

1249 
	#RMNET_FLAGS_INGRESS_MAP_CKSUMV5
 (1U << 4)

	)

1250 
	#RMNET_FLAGS_EGRESS_MAP_CKSUMV5
 (1U << 5)

	)

1253 
	mIFLA_RMNET_UNSPEC
,

1254 
	mIFLA_RMNET_MUX_ID
,

1255 
	mIFLA_RMNET_FLAGS
,

1256 
	m__IFLA_RMNET_MAX
,

1259 
	#IFLA_RMNET_MAX
 (
__IFLA_RMNET_MAX
 - 1)

	)

1261 
	siÊa_rm√t_Êags
 {

1262 
__u32
 
	mÊags
;

1263 
__u32
 
	mmask
;

1269 
	mIFLA_MCTP_UNSPEC
,

1270 
	mIFLA_MCTP_NET
,

1271 
	m__IFLA_MCTP_MAX
,

1274 
	#IFLA_MCTP_MAX
 (
__IFLA_MCTP_MAX
 - 1)

	)

	@/usr/include/linux/if_packet.h

2 #i‚de‡
__LINUX_IF_PACKET_H


3 
	#__LINUX_IF_PACKET_H


	)

5 
	~<asm/byã‹dî.h
>

6 
	~<löux/ty≥s.h
>

8 
	ssockaddr_pkt
 {

9 
	m•kt_Ámûy
;

10 
	m•kt_devi˚
[14];

11 
__be16
 
	m•kt_¥Ÿocﬁ
;

14 
	ssockaddr_Œ
 {

15 
	m¶l_Ámûy
;

16 
__be16
 
	m¶l_¥Ÿocﬁ
;

17 
	m¶l_ifödex
;

18 
	m¶l_h©y≥
;

19 
	m¶l_pkây≥
;

20 
	m¶l_hÆí
;

21 
	m¶l_addr
[8];

26 
	#PACKET_HOST
 0

	)

27 
	#PACKET_BROADCAST
 1

	)

28 
	#PACKET_MULTICAST
 2

	)

29 
	#PACKET_OTHERHOST
 3

	)

30 
	#PACKET_OUTGOING
 4

	)

31 
	#PACKET_LOOPBACK
 5

	)

32 
	#PACKET_USER
 6

	)

33 
	#PACKET_KERNEL
 7

	)

35 
	#PACKET_FASTROUTE
 6

	)

39 
	#PACKET_ADD_MEMBERSHIP
 1

	)

40 
	#PACKET_DROP_MEMBERSHIP
 2

	)

41 
	#PACKET_RECV_OUTPUT
 3

	)

43 
	#PACKET_RX_RING
 5

	)

44 
	#PACKET_STATISTICS
 6

	)

45 
	#PACKET_COPY_THRESH
 7

	)

46 
	#PACKET_AUXDATA
 8

	)

47 
	#PACKET_ORIGDEV
 9

	)

48 
	#PACKET_VERSION
 10

	)

49 
	#PACKET_HDRLEN
 11

	)

50 
	#PACKET_RESERVE
 12

	)

51 
	#PACKET_TX_RING
 13

	)

52 
	#PACKET_LOSS
 14

	)

53 
	#PACKET_VNET_HDR
 15

	)

54 
	#PACKET_TX_TIMESTAMP
 16

	)

55 
	#PACKET_TIMESTAMP
 17

	)

56 
	#PACKET_FANOUT
 18

	)

57 
	#PACKET_TX_HAS_OFF
 19

	)

58 
	#PACKET_QDISC_BYPASS
 20

	)

59 
	#PACKET_ROLLOVER_STATS
 21

	)

60 
	#PACKET_FANOUT_DATA
 22

	)

61 
	#PACKET_IGNORE_OUTGOING
 23

	)

63 
	#PACKET_FANOUT_HASH
 0

	)

64 
	#PACKET_FANOUT_LB
 1

	)

65 
	#PACKET_FANOUT_CPU
 2

	)

66 
	#PACKET_FANOUT_ROLLOVER
 3

	)

67 
	#PACKET_FANOUT_RND
 4

	)

68 
	#PACKET_FANOUT_QM
 5

	)

69 
	#PACKET_FANOUT_CBPF
 6

	)

70 
	#PACKET_FANOUT_EBPF
 7

	)

71 
	#PACKET_FANOUT_FLAG_ROLLOVER
 0x1000

	)

72 
	#PACKET_FANOUT_FLAG_UNIQUEID
 0x2000

	)

73 
	#PACKET_FANOUT_FLAG_DEFRAG
 0x8000

	)

75 
	sçackë_°©s
 {

76 
	mç_∑ckës
;

77 
	mç_dr›s
;

80 
	sçackë_°©s_v3
 {

81 
	mç_∑ckës
;

82 
	mç_dr›s
;

83 
	mç_‰ìze_q_˙t
;

86 
	sçackë_rﬁlovî_°©s
 {

87 
__Æig√d_u64
 
	mç_Æl
;

88 
__Æig√d_u64
 
	mç_huge
;

89 
__Æig√d_u64
 
	mç_Áûed
;

92 
	uçackë_°©s_u
 {

93 
çackë_°©s
 
	m°©s1
;

94 
çackë_°©s_v3
 
	m°©s3
;

97 
	sçackë_auxd©a
 {

98 
__u32
 
	mç_°©us
;

99 
__u32
 
	mç_Àn
;

100 
__u32
 
	mç_¢≠Àn
;

101 
__u16
 
	mç_mac
;

102 
__u16
 
	mç_√t
;

103 
__u16
 
	mç_vœn_tci
;

104 
__u16
 
	mç_vœn_çid
;

108 
	#TP_STATUS_KERNEL
 0

	)

109 
	#TP_STATUS_USER
 (1 << 0)

	)

110 
	#TP_STATUS_COPY
 (1 << 1)

	)

111 
	#TP_STATUS_LOSING
 (1 << 2)

	)

112 
	#TP_STATUS_CSUMNOTREADY
 (1 << 3)

	)

113 
	#TP_STATUS_VLAN_VALID
 (1 << 4Ë

	)

114 
	#TP_STATUS_BLK_TMO
 (1 << 5)

	)

115 
	#TP_STATUS_VLAN_TPID_VALID
 (1 << 6Ë

	)

116 
	#TP_STATUS_CSUM_VALID
 (1 << 7)

	)

119 
	#TP_STATUS_AVAILABLE
 0

	)

120 
	#TP_STATUS_SEND_REQUEST
 (1 << 0)

	)

121 
	#TP_STATUS_SENDING
 (1 << 1)

	)

122 
	#TP_STATUS_WRONG_FORMAT
 (1 << 2)

	)

125 
	#TP_STATUS_TS_SOFTWARE
 (1 << 29)

	)

126 
	#TP_STATUS_TS_SYS_HARDWARE
 (1 << 30Ë

	)

127 
	#TP_STATUS_TS_RAW_HARDWARE
 (1U << 31)

	)

130 
	#TP_FT_REQ_FILL_RXHASH
 0x1

	)

132 
	sçackë_hdr
 {

133 
	mç_°©us
;

134 
	mç_Àn
;

135 
	mç_¢≠Àn
;

136 
	mç_mac
;

137 
	mç_√t
;

138 
	mç_£c
;

139 
	mç_u£c
;

142 
	#TPACKET_ALIGNMENT
 16

	)

143 
	#TPACKET_ALIGN
(
x
Ë(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

144 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë_hdr
)Ë+ (
sockaddr_Œ
))

	)

146 
	sçackë2_hdr
 {

147 
__u32
 
	mç_°©us
;

148 
__u32
 
	mç_Àn
;

149 
__u32
 
	mç_¢≠Àn
;

150 
__u16
 
	mç_mac
;

151 
__u16
 
	mç_√t
;

152 
__u32
 
	mç_£c
;

153 
__u32
 
	mç_n£c
;

154 
__u16
 
	mç_vœn_tci
;

155 
__u16
 
	mç_vœn_çid
;

156 
__u8
 
	mç_∑ddög
[4];

159 
	sçackë_hdr_v¨ü¡1
 {

160 
__u32
 
	mç_rxhash
;

161 
__u32
 
	mç_vœn_tci
;

162 
__u16
 
	mç_vœn_çid
;

163 
__u16
 
	mç_∑ddög
;

166 
	sçackë3_hdr
 {

167 
__u32
 
	mç_√xt_off£t
;

168 
__u32
 
	mç_£c
;

169 
__u32
 
	mç_n£c
;

170 
__u32
 
	mç_¢≠Àn
;

171 
__u32
 
	mç_Àn
;

172 
__u32
 
	mç_°©us
;

173 
__u16
 
	mç_mac
;

174 
__u16
 
	mç_√t
;

177 
çackë_hdr_v¨ü¡1
 
	mhv1
;

179 
__u8
 
	mç_∑ddög
[8];

182 
	sçackë_bd_ts
 {

183 
	mts_£c
;

185 
	mts_u£c
;

186 
	mts_n£c
;

190 
	sçackë_hdr_v1
 {

191 
__u32
 
	mblock_°©us
;

192 
__u32
 
	mnum_pkts
;

193 
__u32
 
	moff£t_to_fú°_pkt
;

198 
__u32
 
	mblk_Àn
;

209 
__Æig√d_u64
 
	m£q_num
;

236 
çackë_bd_ts
 
	mts_fú°_pkt
, 
	mts_œ°_pkt
;

239 
	uçackë_bd_hódî_u
 {

240 
çackë_hdr_v1
 
	mbh1
;

243 
	sçackë_block_desc
 {

244 
__u32
 
	mvîsi⁄
;

245 
__u32
 
	moff£t_to_¥iv
;

246 
çackë_bd_hódî_u
 
	mhdr
;

249 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë2_hdr
)Ë+ (
sockaddr_Œ
))

	)

250 
	#TPACKET3_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë3_hdr
)Ë+ (
sockaddr_Œ
))

	)

252 
	eçackë_vîsi⁄s
 {

253 
	mTPACKET_V1
,

254 
	mTPACKET_V2
,

255 
	mTPACKET_V3


271 
	sçackë_ªq
 {

272 
	mç_block_size
;

273 
	mç_block_ƒ
;

274 
	mç_‰ame_size
;

275 
	mç_‰ame_ƒ
;

278 
	sçackë_ªq3
 {

279 
	mç_block_size
;

280 
	mç_block_ƒ
;

281 
	mç_‰ame_size
;

282 
	mç_‰ame_ƒ
;

283 
	mç_ªtúe_blk_tov
;

284 
	mç_sizeof_¥iv
;

285 
	mç_„©uª_ªq_w‹d
;

288 
	uçackë_ªq_u
 {

289 
çackë_ªq
 
	mªq
;

290 
çackë_ªq3
 
	mªq3
;

293 
	s∑ckë_mªq
 {

294 
	mmr_ifödex
;

295 
	mmr_ty≥
;

296 
	mmr_Æí
;

297 
	mmr_addªss
[8];

300 
	sÁnout_¨gs
 {

301 #i‡
deföed
(
__LITTLE_ENDIAN_BITFIELD
)

302 
__u16
 
	mid
;

303 
__u16
 
	mty≥_Êags
;

305 
__u16
 
	mty≥_Êags
;

306 
__u16
 
	mid
;

308 
__u32
 
	mmax_num_membîs
;

311 
	#PACKET_MR_MULTICAST
 0

	)

312 
	#PACKET_MR_PROMISC
 1

	)

313 
	#PACKET_MR_ALLMULTI
 2

	)

314 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/ioctl.h

2 #i‚de‡
_LINUX_IOCTL_H


3 
	#_LINUX_IOCTL_H


	)

5 
	~<asm/io˘l.h
>

	@/usr/include/linux/irqnr.h

	@/usr/include/linux/libc-compat.h

49 #i‚de‡
_LIBC_COMPAT_H


50 
	#_LIBC_COMPAT_H


	)

53 #i‡
deföed
(
__GLIBC__
)

56 #i‡
deföed
(
_NET_IF_H
Ë&& deföed(
__USE_MISC
)

61 
	#__UAPI_DEF_IF_IFCONF
 0

	)

62 
	#__UAPI_DEF_IF_IFMAP
 0

	)

63 
	#__UAPI_DEF_IF_IFNAMSIZ
 0

	)

64 
	#__UAPI_DEF_IF_IFREQ
 0

	)

66 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 0

	)

68 #i‚de‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


69 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

78 
	#__UAPI_DEF_IF_IFCONF
 1

	)

79 
	#__UAPI_DEF_IF_IFMAP
 1

	)

80 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

81 
	#__UAPI_DEF_IF_IFREQ
 1

	)

83 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

85 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

90 #i‡
deföed
(
_NETINET_IN_H
)

94 
	#__UAPI_DEF_IN_ADDR
 0

	)

95 
	#__UAPI_DEF_IN_IPPROTO
 0

	)

96 
	#__UAPI_DEF_IN_PKTINFO
 0

	)

97 
	#__UAPI_DEF_IP_MREQ
 0

	)

98 
	#__UAPI_DEF_SOCKADDR_IN
 0

	)

99 
	#__UAPI_DEF_IN_CLASS
 0

	)

101 
	#__UAPI_DEF_IN6_ADDR
 0

	)

106 #i‡
deföed
(
__USE_MISC
Ë|| deföed (
__USE_GNU
)

107 
	#__UAPI_DEF_IN6_ADDR_ALT
 0

	)

109 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

111 
	#__UAPI_DEF_SOCKADDR_IN6
 0

	)

112 
	#__UAPI_DEF_IPV6_MREQ
 0

	)

113 
	#__UAPI_DEF_IPPROTO_V6
 0

	)

114 
	#__UAPI_DEF_IPV6_OPTIONS
 0

	)

115 
	#__UAPI_DEF_IN6_PKTINFO
 0

	)

116 
	#__UAPI_DEF_IP6_MTUINFO
 0

	)

123 
	#__UAPI_DEF_IN_ADDR
 1

	)

124 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

125 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

126 
	#__UAPI_DEF_IP_MREQ
 1

	)

127 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

128 
	#__UAPI_DEF_IN_CLASS
 1

	)

130 
	#__UAPI_DEF_IN6_ADDR
 1

	)

133 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

134 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

135 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

136 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

137 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

138 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

139 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

144 #i‡
deföed
(
__NETIPX_IPX_H
)

146 
	#__UAPI_DEF_SOCKADDR_IPX
 0

	)

147 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 0

	)

148 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 0

	)

149 
	#__UAPI_DEF_IPX_CONFIG_DATA
 0

	)

150 
	#__UAPI_DEF_IPX_ROUTE_DEF
 0

	)

154 
	#__UAPI_DEF_SOCKADDR_IPX
 1

	)

155 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 1

	)

156 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 1

	)

157 
	#__UAPI_DEF_IPX_CONFIG_DATA
 1

	)

158 
	#__UAPI_DEF_IPX_ROUTE_DEF
 1

	)

163 #i‡
deföed
(
_SYS_XATTR_H
)

164 
	#__UAPI_DEF_XATTR
 0

	)

166 
	#__UAPI_DEF_XATTR
 1

	)

176 #i‚de‡
__UAPI_DEF_IF_IFCONF


177 
	#__UAPI_DEF_IF_IFCONF
 1

	)

179 #i‚de‡
__UAPI_DEF_IF_IFMAP


180 
	#__UAPI_DEF_IF_IFMAP
 1

	)

182 #i‚de‡
__UAPI_DEF_IF_IFNAMSIZ


183 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

185 #i‚de‡
__UAPI_DEF_IF_IFREQ


186 
	#__UAPI_DEF_IF_IFREQ
 1

	)

189 #i‚de‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS


190 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

193 #i‚de‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


194 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

198 #i‚de‡
__UAPI_DEF_IN_ADDR


199 
	#__UAPI_DEF_IN_ADDR
 1

	)

201 #i‚de‡
__UAPI_DEF_IN_IPPROTO


202 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

204 #i‚de‡
__UAPI_DEF_IN_PKTINFO


205 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

207 #i‚de‡
__UAPI_DEF_IP_MREQ


208 
	#__UAPI_DEF_IP_MREQ
 1

	)

210 #i‚de‡
__UAPI_DEF_SOCKADDR_IN


211 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

213 #i‚de‡
__UAPI_DEF_IN_CLASS


214 
	#__UAPI_DEF_IN_CLASS
 1

	)

218 #i‚de‡
__UAPI_DEF_IN6_ADDR


219 
	#__UAPI_DEF_IN6_ADDR
 1

	)

221 #i‚de‡
__UAPI_DEF_IN6_ADDR_ALT


222 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

224 #i‚de‡
__UAPI_DEF_SOCKADDR_IN6


225 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

227 #i‚de‡
__UAPI_DEF_IPV6_MREQ


228 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

230 #i‚de‡
__UAPI_DEF_IPPROTO_V6


231 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

233 #i‚de‡
__UAPI_DEF_IPV6_OPTIONS


234 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

236 #i‚de‡
__UAPI_DEF_IN6_PKTINFO


237 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

239 #i‚de‡
__UAPI_DEF_IP6_MTUINFO


240 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

244 #i‚de‡
__UAPI_DEF_SOCKADDR_IPX


245 
	#__UAPI_DEF_SOCKADDR_IPX
 1

	)

247 #i‚de‡
__UAPI_DEF_IPX_ROUTE_DEFINITION


248 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 1

	)

250 #i‚de‡
__UAPI_DEF_IPX_INTERFACE_DEFINITION


251 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 1

	)

253 #i‚de‡
__UAPI_DEF_IPX_CONFIG_DATA


254 
	#__UAPI_DEF_IPX_CONFIG_DATA
 1

	)

256 #i‚de‡
__UAPI_DEF_IPX_ROUTE_DEF


257 
	#__UAPI_DEF_IPX_ROUTE_DEF
 1

	)

261 #i‚de‡
__UAPI_DEF_XATTR


262 
	#__UAPI_DEF_XATTR
 1

	)

	@/usr/include/linux/neighbour.h

2 #i‚de‡
__LINUX_NEIGHBOUR_H


3 
	#__LINUX_NEIGHBOUR_H


	)

5 
	~<löux/ty≥s.h
>

6 
	~<löux/√éök.h
>

8 
	sndmsg
 {

9 
__u8
 
	mndm_Ámûy
;

10 
__u8
 
	mndm_∑d1
;

11 
__u16
 
	mndm_∑d2
;

12 
__s32
 
	mndm_ifödex
;

13 
__u16
 
	mndm_°©e
;

14 
__u8
 
	mndm_Êags
;

15 
__u8
 
	mndm_ty≥
;

19 
	mNDA_UNSPEC
,

20 
	mNDA_DST
,

21 
	mNDA_LLADDR
,

22 
	mNDA_CACHEINFO
,

23 
	mNDA_PROBES
,

24 
	mNDA_VLAN
,

25 
	mNDA_PORT
,

26 
	mNDA_VNI
,

27 
	mNDA_IFINDEX
,

28 
	mNDA_MASTER
,

29 
	mNDA_LINK_NETNSID
,

30 
	mNDA_SRC_VNI
,

31 
	mNDA_PROTOCOL
,

32 
	mNDA_NH_ID
,

33 
	mNDA_FDB_EXT_ATTRS
,

34 
	m__NDA_MAX


37 
	#NDA_MAX
 (
__NDA_MAX
 - 1)

	)

43 
	#NTF_USE
 0x01

	)

44 
	#NTF_SELF
 0x02

	)

45 
	#NTF_MASTER
 0x04

	)

46 
	#NTF_PROXY
 0x08

	)

47 
	#NTF_EXT_LEARNED
 0x10

	)

48 
	#NTF_OFFLOADED
 0x20

	)

49 
	#NTF_STICKY
 0x40

	)

50 
	#NTF_ROUTER
 0x80

	)

56 
	#NUD_INCOMPLETE
 0x01

	)

57 
	#NUD_REACHABLE
 0x02

	)

58 
	#NUD_STALE
 0x04

	)

59 
	#NUD_DELAY
 0x08

	)

60 
	#NUD_PROBE
 0x10

	)

61 
	#NUD_FAILED
 0x20

	)

64 
	#NUD_NOARP
 0x40

	)

65 
	#NUD_PERMANENT
 0x80

	)

66 
	#NUD_NONE
 0x00

	)

76 
	snda_ˇcheöfo
 {

77 
__u32
 
	mndm_c⁄fúmed
;

78 
__u32
 
	mndm_u£d
;

79 
__u32
 
	mndm_upd©ed
;

80 
__u32
 
	mndm_ªf˙t
;

108 
	sndt_°©s
 {

109 
__u64
 
	mndts_Ælocs
;

110 
__u64
 
	mndts_de°roys
;

111 
__u64
 
	mndts_hash_grows
;

112 
__u64
 
	mndts_ªs_Áûed
;

113 
__u64
 
	mndts_lookups
;

114 
__u64
 
	mndts_hôs
;

115 
__u64
 
	mndts_rcv_¥obes_mˇ°
;

116 
__u64
 
	mndts_rcv_¥obes_uˇ°
;

117 
__u64
 
	mndts_≥riodic_gc_runs
;

118 
__u64
 
	mndts_f‹˚d_gc_runs
;

119 
__u64
 
	mndts_èbÀ_fuŒs
;

123 
	mNDTPA_UNSPEC
,

124 
	mNDTPA_IFINDEX
,

125 
	mNDTPA_REFCNT
,

126 
	mNDTPA_REACHABLE_TIME
,

127 
	mNDTPA_BASE_REACHABLE_TIME
,

128 
	mNDTPA_RETRANS_TIME
,

129 
	mNDTPA_GC_STALETIME
,

130 
	mNDTPA_DELAY_PROBE_TIME
,

131 
	mNDTPA_QUEUE_LEN
,

132 
	mNDTPA_APP_PROBES
,

133 
	mNDTPA_UCAST_PROBES
,

134 
	mNDTPA_MCAST_PROBES
,

135 
	mNDTPA_ANYCAST_DELAY
,

136 
	mNDTPA_PROXY_DELAY
,

137 
	mNDTPA_PROXY_QLEN
,

138 
	mNDTPA_LOCKTIME
,

139 
	mNDTPA_QUEUE_LENBYTES
,

140 
	mNDTPA_MCAST_REPROBES
,

141 
	mNDTPA_PAD
,

142 
	m__NDTPA_MAX


144 
	#NDTPA_MAX
 (
__NDTPA_MAX
 - 1)

	)

146 
	sndtmsg
 {

147 
__u8
 
	mndtm_Ámûy
;

148 
__u8
 
	mndtm_∑d1
;

149 
__u16
 
	mndtm_∑d2
;

152 
	sndt_c⁄fig
 {

153 
__u16
 
	mndtc_key_Àn
;

154 
__u16
 
	mndtc_íåy_size
;

155 
__u32
 
	mndtc_íåõs
;

156 
__u32
 
	mndtc_œ°_Êush
;

157 
__u32
 
	mndtc_œ°_ønd
;

158 
__u32
 
	mndtc_hash_∫d
;

159 
__u32
 
	mndtc_hash_mask
;

160 
__u32
 
	mndtc_hash_chaö_gc
;

161 
__u32
 
	mndtc_¥oxy_qÀn
;

165 
	mNDTA_UNSPEC
,

166 
	mNDTA_NAME
,

167 
	mNDTA_THRESH1
,

168 
	mNDTA_THRESH2
,

169 
	mNDTA_THRESH3
,

170 
	mNDTA_CONFIG
,

171 
	mNDTA_PARMS
,

172 
	mNDTA_STATS
,

173 
	mNDTA_GC_INTERVAL
,

174 
	mNDTA_PAD
,

175 
	m__NDTA_MAX


177 
	#NDTA_MAX
 (
__NDTA_MAX
 - 1)

	)

184 
	mFDB_NOTIFY_BIT
 = (1 << 0),

185 
	mFDB_NOTIFY_INACTIVE_BIT
 = (1 << 1)

195 
	mNFEA_UNSPEC
,

196 
	mNFEA_ACTIVITY_NOTIFY
,

197 
	mNFEA_DONT_REFRESH
,

198 
	m__NFEA_MAX


200 
	#NFEA_MAX
 (
__NFEA_MAX
 - 1)

	)

	@/usr/include/linux/socket.h

2 #i‚de‡
_LINUX_SOCKET_H


3 
	#_LINUX_SOCKET_H


	)

8 
	#_K_SS_MAXSIZE
 128

	)

10 
	t__kî√l_ß_Ámûy_t
;

16 
	s__kî√l_sockaddr_°‹age
 {

19 
__kî√l_ß_Ámûy_t
 
	mss_Ámûy
;

21 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

25 *
	m__Æign
;

29 
	#SOCK_SNDBUF_LOCK
 1

	)

30 
	#SOCK_RCVBUF_LOCK
 2

	)

32 
	#SOCK_BUF_LOCK_MASK
 (
SOCK_SNDBUF_LOCK
 | 
SOCK_RCVBUF_LOCK
)

	)

	@/usr/include/linux/sysinfo.h

2 #i‚de‡
_LINUX_SYSINFO_H


3 
	#_LINUX_SYSINFO_H


	)

5 
	~<löux/ty≥s.h
>

7 
	#SI_LOAD_SHIFT
 16

	)

8 
	ssysöfo
 {

9 
__kî√l_l⁄g_t
 
	mu±ime
;

10 
__kî√l_ul⁄g_t
 
	mlﬂds
[3];

11 
__kî√l_ul⁄g_t
 
	mtŸÆøm
;

12 
__kî√l_ul⁄g_t
 
	m‰ìøm
;

13 
__kî√l_ul⁄g_t
 
	msh¨edøm
;

14 
__kî√l_ul⁄g_t
 
	mbuf„ºam
;

15 
__kî√l_ul⁄g_t
 
	mtŸÆsw≠
;

16 
__kî√l_ul⁄g_t
 
	m‰ìsw≠
;

17 
__u16
 
	m¥ocs
;

18 
__u16
 
	m∑d
;

19 
__kî√l_ul⁄g_t
 
	mtŸÆhigh
;

20 
__kî√l_ul⁄g_t
 
	m‰ìhigh
;

21 
__u32
 
	mmem_unô
;

22 
	m_f
[20-2*(
__kî√l_ul⁄g_t
)-(
__u32
)];

	@/usr/include/linux/time_types.h

2 #i‚de‡
_LINUX_TIME_TYPES_H


3 
	#_LINUX_TIME_TYPES_H


	)

5 
	~<löux/ty≥s.h
>

7 
	s__kî√l_time•ec
 {

8 
__kî√l_time64_t
 
	mtv_£c
;

9 
	mtv_n£c
;

12 
	s__kî√l_ôimî•ec
 {

13 
__kî√l_time•ec
 
	mô_öãrvÆ
;

14 
__kî√l_time•ec
 
	mô_vÆue
;

24 #i‚de‡
__kî√l_ﬁd_timevÆ


25 
	s__kî√l_ﬁd_timevÆ
 {

26 
__kî√l_l⁄g_t
 
	mtv_£c
;

27 
__kî√l_l⁄g_t
 
	mtv_u£c
;

31 
	s__kî√l_ﬁd_time•ec
 {

32 
__kî√l_ﬁd_time_t
 
	mtv_£c
;

33 
	mtv_n£c
;

36 
	s__kî√l_ﬁd_ôimîvÆ
 {

37 
__kî√l_ﬁd_timevÆ
 
	mô_öãrvÆ
;

38 
__kî√l_ﬁd_timevÆ
 
	mô_vÆue
;

41 
	s__kî√l_sock_timevÆ
 {

42 
__s64
 
	mtv_£c
;

43 
__s64
 
	mtv_u£c
;

	@/usr/include/linux/types.h

2 #i‚de‡
_LINUX_TYPES_H


3 
	#_LINUX_TYPES_H


	)

5 
	~<asm/ty≥s.h
>

7 #i‚de‡
__ASSEMBLY__


9 
	~<löux/posix_ty≥s.h
>

17 #ifde‡
__CHECKER__


18 
	#__bôwi£__
 
	`__©åibuã__
((
bôwi£
))

	)

20 
	#__bôwi£__


	)

22 
	#__bôwi£
 
__bôwi£__


	)

24 
__u16
 
	t__bôwi£
 
	t__À16
;

25 
__u16
 
	t__bôwi£
 
	t__be16
;

26 
__u32
 
	t__bôwi£
 
	t__À32
;

27 
__u32
 
	t__bôwi£
 
	t__be32
;

28 
__u64
 
	t__bôwi£
 
	t__À64
;

29 
__u64
 
	t__bôwi£
 
	t__be64
;

31 
__u16
 
	t__bôwi£
 
	t__sum16
;

32 
__u32
 
	t__bôwi£
 
	t__wsum
;

43 
	#__Æig√d_u64
 
__u64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

44 
	#__Æig√d_be64
 
__be64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

45 
	#__Æig√d_À64
 
__À64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

47 
	t__bôwi£
 
	t__pﬁl_t
;

	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<bôs/libc-hódî-°¨t.h
>

28 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

36 #i‡
deföed
 
__˝lu•lus
 && (
__GNUC_PREREQ
 (4, 4) \

37 || 
	$__glibc_˛™g_¥îeq
 (3, 5))

38 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

43 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

44 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

47 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

48 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

53 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
 || 
	`__GLIBC_USE
 (
ISOC2X
)

54 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
	`__©å_ac˚ss
 ((
__wrôe_⁄ly__
, 1, 4));

61 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

64 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

65 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

80 
	$__memcm≥q
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

81 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

84 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


87 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

88 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

89 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

90 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

92 #ifde‡
__OPTIMIZE__


93 
__exã∫_Æways_ölöe
 *

94 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


96  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

99 
__exã∫_Æways_ölöe
 const *

100 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


102  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

105 
	}
}

107 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

108 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

111 #ifde‡
__USE_GNU


114 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


115 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

116 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

117 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

118 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

120 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

121 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

125 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


126 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

127 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1))

128 
	`__©å_ac˚ss
 ((
__ªad_⁄ly__
, 1, 3));

129 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

130 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1))

131 
	`__©å_ac˚ss
 ((
__ªad_⁄ly__
, 1, 3));

133 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

134 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1))

135 
	`__©å_ac˚ss
 ((
__ªad_⁄ly__
, 1, 3));

141 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

142 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

144 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

145 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

146 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

149 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

150 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

152 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

153 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

156 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

157 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

159 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

160 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

163 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

164 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

166 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

167 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

168 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
	`__©å_ac˚ss
 ((
__wrôe_⁄ly__
, 1, 3));

170 #ifde‡
__USE_XOPEN2K8


172 
	~<bôs/ty≥s/loˇÀ_t.h
>

175 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
loˇÀ_t
 
__l
)

176 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

179 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

180 
loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4))

181 
	`__©å_ac˚ss
 ((
__wrôe_⁄ly__
, 1, 3));

184 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8
 \

185 || 
	`__GLIBC_USE
 (
LIB_EXT2
Ë|| 
	$__GLIBC_USE
 (
ISOC2X
))

187 *
	$°rdup
 (c⁄° *
__s
)

188 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

194 #i‡
deföed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
Ë|| __GLIBC_USE (
ISOC2X
)

195 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

196 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

199 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


201 
	#°rdu∑
(
s
) \

202 (
__exãnsi⁄__
 \

204 c⁄° *
__ﬁd
 = (
s
); \

205 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

206 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

207 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

208 
	}
}))

	)

211 
	#°∫du∑
(
s
, 
n
) \

212 (
__exãnsi⁄__
 \

214 c⁄° *
__ﬁd
 = (
s
); \

215 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

216 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

217 
__√w
[
__Àn
] = '\0'; \

218 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

219 }))

	)

223 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


226 *
°rchr
 (*
__s
, 
__c
)

227 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

228 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

229 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

231 #ifde‡
__OPTIMIZE__


232 
__exã∫_Æways_ölöe
 *

233 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


235  
__buûtö_°rchr
 (
__s
, 
__c
);

238 
__exã∫_Æways_ölöe
 const *

239 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


241  
__buûtö_°rchr
 (
__s
, 
__c
);

246 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

247 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

250 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


253 *
	`°ºchr
 (*
__s
, 
__c
)

254 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

255 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

256 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

258 #ifde‡
__OPTIMIZE__


259 
__exã∫_Æways_ölöe
 *

260 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


262  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

265 
__exã∫_Æways_ölöe
 const *

266 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


268  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

271 
	}
}

273 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

274 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

277 #ifde‡
__USE_GNU


280 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


281 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

282 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

283 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

284 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

286 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

287 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

293 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

294 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

297 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

298 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

300 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


303 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

304 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

305 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

306 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

308 #ifde‡
__OPTIMIZE__


309 
__exã∫_Æways_ölöe
 *

310 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


312  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

315 
__exã∫_Æways_ölöe
 const *

316 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


318  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

321 
	}
}

323 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

324 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

327 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


330 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

331 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

332 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

333 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

335 #ifde‡
__OPTIMIZE__


336 
__exã∫_Æways_ölöe
 *

337 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


339  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

342 
__exã∫_Æways_ölöe
 const *

343 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


345  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

348 
	}
}

350 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

351 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

356 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2));

361 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

362 c⁄° *
__ª°ri˘
 
__dñim
,

363 **
__ª°ri˘
 
__ßve_±r
)

364 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

365 #ifde‡
__USE_POSIX


366 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

367 **
__ª°ri˘
 
__ßve_±r
)

368 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

371 #ifde‡
__USE_GNU


373 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


374 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

375 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

376 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

377 c⁄° *
__√edÀ
)

378 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

380 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

381 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

385 #ifde‡
__USE_GNU


389 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

390 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

391 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3))

392 
	`__©å_ac˚ss
 ((
__ªad_⁄ly__
, 1, 2))

393 
	`__©å_ac˚ss
 ((
__ªad_⁄ly__
, 3, 4));

397 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

398 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

399 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

400 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

401 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

402 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

407 
size_t
 
	$°æí
 (c⁄° *
__s
)

408 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

410 #ifdef 
__USE_XOPEN2K8


413 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

414 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

419 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

420 #ifde‡
__USE_XOPEN2K


428 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


431 #ifde‡
__REDIRECT_NTH


432 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

433 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

434 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2))

435 
	`__©å_ac˚ss
 ((
__wrôe_⁄ly__
, 2, 3));

437 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

438 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
	`__©å_ac˚ss
 ((
__wrôe_⁄ly__
, 2, 3));

439 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

444 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

445 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
 
	`__©å_ac˚ss
 ((
__wrôe_⁄ly__
, 2, 3));

448 #ifde‡
__USE_GNU


450 c⁄° *
	$°ªº‹desc_≈
 (
__îr
Ë
__THROW
;

452 c⁄° *
	$°ªº‹«me_≈
 (
__îr
Ë
__THROW
;

456 #ifde‡
__USE_XOPEN2K8


458 *
	$°ªº‹_l
 (
__î∫um
, 
loˇÀ_t
 
__l
Ë
__THROW
;

461 #ifde‡
__USE_MISC


462 
	~<°rögs.h
>

466 
	$ex∂icô_bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1))

467 
	`__f‹tifõd_©å_ac˚ss
 (
__wrôe_⁄ly__
, 1, 2);

471 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

472 c⁄° *
__ª°ri˘
 
__dñim
)

473 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

476 #ifdef 
__USE_XOPEN2K8


478 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

480 #ifde‡
__USE_GNU


482 c⁄° *
	$sigabbªv_≈
 (
__sig
Ë
__THROW
;

485 c⁄° *
	$sigdes¸_≈
 (
__sig
Ë
__THROW
;

489 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

490 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

491 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

492 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

496 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

497 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

498 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

499 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

500 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

501 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

504 #ifdef 
__USE_GNU


506 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

507 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

510 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

513 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1))

514 
	`__©å_ac˚ss
 ((
__ªad_wrôe__
, 1, 2));

516 #i‚de‡
ba£«me


521 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


522 "C++" *
	$ba£«me
 (*
__fûíame
)

523 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

524 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

525 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

527 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

532 #i‡
	`__GNUC_PREREQ
 (3,4)

533 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


535 
	~<bôs/°rög_f‹tifõd.h
>

539 
__END_DECLS


	@/usr/include/linux/posix_types.h

2 #i‚de‡
_LINUX_POSIX_TYPES_H


3 
	#_LINUX_POSIX_TYPES_H


	)

5 
	~<löux/°ddef.h
>

22 #unde‡
__FD_SETSIZE


23 
	#__FD_SETSIZE
 1024

	)

26 
	mfds_bôs
[
__FD_SETSIZE
 / (8 * ())];

27 } 
	t__kî√l_fd_£t
;

30 (*
	t__kî√l_sigh™dÀr_t
)();

33 
	t__kî√l_key_t
;

34 
	t__kî√l_mqd_t
;

36 
	~<asm/posix_ty≥s.h
>

	@/usr/include/strings.h

18 #i‚def 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

21 
	~<„©uªs.h
>

22 
	#__√ed_size_t


	)

23 
	~<°ddef.h
>

26 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

27 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

30 
	g__BEGIN_DECLS


32 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


34 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

35 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

38 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

39 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

42 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

45 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


48 *
	`ödex
 (*
__s
, 
__c
)

49 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

50 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

51 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

53 #i‡
deföed
 
__OPTIMIZE__


54 
__exã∫_Æways_ölöe
 *

55 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


57  
	`__buûtö_ödex
 (
__s
, 
__c
);

60 
__exã∫_Æways_ölöe
 const *

61 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


63  
	`__buûtö_ödex
 (
__s
, 
__c
);

66 
	}
}

68 *
	$ödex
 (c⁄° *
__s
, 
__c
)

69 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

73 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


76 *
	`rödex
 (*
__s
, 
__c
)

77 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

78 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

79 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

81 #i‡
deföed
 
__OPTIMIZE__


82 
__exã∫_Æways_ölöe
 *

83 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


85  
	`__buûtö_rödex
 (
__s
, 
__c
);

88 
__exã∫_Æways_ölöe
 const *

89 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


91  
	`__buûtö_rödex
 (
__s
, 
__c
);

94 
	}
}

96 *
	$rödex
 (c⁄° *
__s
, 
__c
)

97 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

101 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8
 || deföed 
__USE_XOPEN2K8XSI


104 
	$ffs
 (
__i
Ë
__THROW
 
__©åibuã_c⁄°__
;

109 #ifdef 
__USE_MISC


110 
	$ff¶
 (
__l
Ë
__THROW
 
__©åibuã_c⁄°__
;

111 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

112 
__THROW
 
__©åibuã_c⁄°__
;

116 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

117 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

120 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

123 #ifdef 
__USE_XOPEN2K8


125 
	~<bôs/ty≥s/loˇÀ_t.h
>

128 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
loˇÀ_t
 
__loc
)

129 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

133 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

134 
size_t
 
__n
, 
loˇÀ_t
 
__loc
)

135 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

138 
__END_DECLS


140 #i‡
	`__GNUC_PREREQ
 (3,4Ë&& 
__USE_FORTIFY_LEVEL
 > 0 \

141 && 
deföed
 
__f‹tify_fun˘i⁄


143 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


144 
	~<bôs/°rögs_f‹tifõd.h
>

	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

126 #unde‡
__USE_ISOC11


127 #unde‡
__USE_ISOC99


128 #unde‡
__USE_ISOC95


129 #unde‡
__USE_ISOCXX11


130 #unde‡
__USE_POSIX


131 #unde‡
__USE_POSIX2


132 #unde‡
__USE_POSIX199309


133 #unde‡
__USE_POSIX199506


134 #unde‡
__USE_XOPEN


135 #unde‡
__USE_XOPEN_EXTENDED


136 #unde‡
__USE_UNIX98


137 #unde‡
__USE_XOPEN2K


138 #unde‡
__USE_XOPEN2KXSI


139 #unde‡
__USE_XOPEN2K8


140 #unde‡
__USE_XOPEN2K8XSI


141 #unde‡
__USE_LARGEFILE


142 #unde‡
__USE_LARGEFILE64


143 #unde‡
__USE_FILE_OFFSET64


144 #unde‡
__USE_MISC


145 #unde‡
__USE_ATFILE


146 #unde‡
__USE_DYNAMIC_STACK_SIZE


147 #unde‡
__USE_GNU


148 #unde‡
__USE_FORTIFY_LEVEL


149 #unde‡
__KERNEL_STRICT_NAMES


150 #unde‡
__GLIBC_USE_ISOC2X


151 #unde‡
__GLIBC_USE_DEPRECATED_GETS


152 #unde‡
__GLIBC_USE_DEPRECATED_SCANF


156 #i‚de‡
_LOOSE_KERNEL_NAMES


157 
	#__KERNEL_STRICT_NAMES


	)

167 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


168 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

169 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

171 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

178 #i‡
deföed
 
__˛™g_maj‹__
 && deföed 
__˛™g_mö‹__


179 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
) \

180 ((
__˛™g_maj‹__
 << 16Ë+ 
__˛™g_mö‹__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

182 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
Ë0

	)

186 
	#__GLIBC_USE
(
F
Ë
__GLIBC_USE_
 ## 
	)
F

192 #i‡(
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE
) \

193 && !
deföed
 
	g_DEFAULT_SOURCE


195 #unde‡
_DEFAULT_SOURCE


196 
	#_DEFAULT_SOURCE
 1

	)

200 #ifde‡
_GNU_SOURCE


201 #unde‡
_ISOC95_SOURCE


202 
	#_ISOC95_SOURCE
 1

	)

203 #unde‡
_ISOC99_SOURCE


204 
	#_ISOC99_SOURCE
 1

	)

205 #unde‡
_ISOC11_SOURCE


206 
	#_ISOC11_SOURCE
 1

	)

207 #unde‡
_ISOC2X_SOURCE


208 
	#_ISOC2X_SOURCE
 1

	)

209 #unde‡
_POSIX_SOURCE


210 
	#_POSIX_SOURCE
 1

	)

211 #unde‡
_POSIX_C_SOURCE


212 
	#_POSIX_C_SOURCE
 200809L

	)

213 #unde‡
_XOPEN_SOURCE


214 
	#_XOPEN_SOURCE
 700

	)

215 #unde‡
_XOPEN_SOURCE_EXTENDED


216 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

217 #unde‡
_LARGEFILE64_SOURCE


218 
	#_LARGEFILE64_SOURCE
 1

	)

219 #unde‡
_DEFAULT_SOURCE


220 
	#_DEFAULT_SOURCE
 1

	)

221 #unde‡
_ATFILE_SOURCE


222 
	#_ATFILE_SOURCE
 1

	)

223 #unde‡
_DYNAMIC_STACK_SIZE_SOURCE


224 
	#_DYNAMIC_STACK_SIZE_SOURCE
 1

	)

229 #i‡(
deföed
 
_DEFAULT_SOURCE
 \

230 || (!
deföed
 
	g__STRICT_ANSI__
 \

231 && !
deföed
 
	g_ISOC99_SOURCE
 && !deföed 
	g_ISOC11_SOURCE
 \

232 && !
deföed
 
	g_ISOC2X_SOURCE
 \

233 && !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 \

234 && !
deföed
 
	g_XOPEN_SOURCE
))

235 #unde‡
_DEFAULT_SOURCE


236 
	#_DEFAULT_SOURCE
 1

	)

240 #i‡(
deföed
 
_ISOC2X_SOURCE
 \

241 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ > 201710L))

242 
	#__GLIBC_USE_ISOC2X
 1

	)

244 
	#__GLIBC_USE_ISOC2X
 0

	)

248 #i‡(
deföed
 
_ISOC11_SOURCE
 || deföed 
_ISOC2X_SOURCE
 \

249 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

250 
	#__USE_ISOC11
 1

	)

254 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

255 || 
deföed
 
_ISOC2X_SOURCE
 \

256 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

257 
	#__USE_ISOC99
 1

	)

261 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

262 || 
deföed
 
_ISOC2X_SOURCE
 \

263 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

264 
	#__USE_ISOC95
 1

	)

267 #ifde‡
__˝lu•lus


269 #i‡
__˝lu•lus
 >= 201703L

270 
	#__USE_ISOC11
 1

	)

274 #i‡
__˝lu•lus
 >201103L || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__


275 
	#__USE_ISOCXX11
 1

	)

276 
	#__USE_ISOC99
 1

	)

283 #ifde‡
_DEFAULT_SOURCE


284 #i‡!
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE


285 
	#__USE_POSIX_IMPLICITLY
 1

	)

287 #unde‡
_POSIX_SOURCE


288 
	#_POSIX_SOURCE
 1

	)

289 #unde‡
_POSIX_C_SOURCE


290 
	#_POSIX_C_SOURCE
 200809L

	)

293 #i‡((!
deföed
 
__STRICT_ANSI__
 \

294 || (
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

295 && !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

296 
	#_POSIX_SOURCE
 1

	)

297 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

298 
	#_POSIX_C_SOURCE
 2

	)

299 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

300 
	#_POSIX_C_SOURCE
 199506L

	)

301 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

302 
	#_POSIX_C_SOURCE
 200112L

	)

304 
	#_POSIX_C_SOURCE
 200809L

	)

306 
	#__USE_POSIX_IMPLICITLY
 1

	)

315 #i‡((!
deföed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

316 && (
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE
))

317 
	#_POSIX_SOURCE
 1

	)

318 #unde‡
_POSIX_C_SOURCE


319 
	#_POSIX_C_SOURCE
 199506L

	)

322 #i‡(
deföed
 
_POSIX_SOURCE
 \

323 || (
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

324 || 
deföed
 
_XOPEN_SOURCE
)

325 
	#__USE_POSIX
 1

	)

328 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


329 
	#__USE_POSIX2
 1

	)

332 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

333 
	#__USE_POSIX199309
 1

	)

336 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

337 
	#__USE_POSIX199506
 1

	)

340 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

341 
	#__USE_XOPEN2K
 1

	)

342 #unde‡
__USE_ISOC95


343 
	#__USE_ISOC95
 1

	)

344 #unde‡
__USE_ISOC99


345 
	#__USE_ISOC99
 1

	)

348 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

349 
	#__USE_XOPEN2K8
 1

	)

350 #unde‡
_ATFILE_SOURCE


351 
	#_ATFILE_SOURCE
 1

	)

354 #ifdef 
_XOPEN_SOURCE


355 
	#__USE_XOPEN
 1

	)

356 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

357 
	#__USE_XOPEN_EXTENDED
 1

	)

358 
	#__USE_UNIX98
 1

	)

359 #unde‡
_LARGEFILE_SOURCE


360 
	#_LARGEFILE_SOURCE
 1

	)

361 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

362 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

363 
	#__USE_XOPEN2K8
 1

	)

364 
	#__USE_XOPEN2K8XSI
 1

	)

366 
	#__USE_XOPEN2K
 1

	)

367 
	#__USE_XOPEN2KXSI
 1

	)

368 #unde‡
__USE_ISOC95


369 
	#__USE_ISOC95
 1

	)

370 #unde‡
__USE_ISOC99


371 
	#__USE_ISOC99
 1

	)

374 #ifde‡
_XOPEN_SOURCE_EXTENDED


375 
	#__USE_XOPEN_EXTENDED
 1

	)

380 #ifde‡
_LARGEFILE_SOURCE


381 
	#__USE_LARGEFILE
 1

	)

384 #ifde‡
_LARGEFILE64_SOURCE


385 
	#__USE_LARGEFILE64
 1

	)

388 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

389 
	#__USE_FILE_OFFSET64
 1

	)

392 
	~<„©uªs-time64.h
>

394 #i‡
deföed
 
_DEFAULT_SOURCE


395 
	#__USE_MISC
 1

	)

398 #ifdef 
_ATFILE_SOURCE


399 
	#__USE_ATFILE
 1

	)

402 #ifdef 
_DYNAMIC_STACK_SIZE_SOURCE


403 
	#__USE_DYNAMIC_STACK_SIZE
 1

	)

406 #ifdef 
_GNU_SOURCE


407 
	#__USE_GNU
 1

	)

410 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0

411 #i‡!
deföed
 
__OPTIMIZE__
 || __OPTIMIZE__ <= 0

412 #ñi‡!
__GNUC_PREREQ
 (4, 1)

413 #ñi‡
_FORTIFY_SOURCE
 > 2 && (
__glibc_˛™g_¥îeq
 (9, 0) \

414 || 
	$__GNUC_PREREQ
 (12, 0))

416 #i‡
_FORTIFY_SOURCE
 > 3

418 
	#__USE_FORTIFY_LEVEL
 3

	)

419 #ñi‡
_FORTIFY_SOURCE
 > 1

420 #i‡
_FORTIFY_SOURCE
 > 2

422 
	#__USE_FORTIFY_LEVEL
 2

	)

424 
	#__USE_FORTIFY_LEVEL
 1

	)

427 #i‚de‡
__USE_FORTIFY_LEVEL


428 
	#__USE_FORTIFY_LEVEL
 0

	)

435 #i‡
deföed
 
__˝lu•lus
 ? __˝lu•lu†>201402L : deföed 
__USE_ISOC11


436 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

438 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

453 #i‡(
deföed
 
__USE_GNU
 \

454 && (
deföed
 
__˝lu•lus
 \

455 ? (
__˝lu•lus
 < 201103L && !
deföed
 
__GXX_EXPERIMENTAL_CXX0X__
) \

456 : (!
deföed
 
__STDC_VERSION__
 || __STDC_VERSION__ < 199901L)))

457 
	#__GLIBC_USE_DEPRECATED_SCANF
 1

	)

459 
	#__GLIBC_USE_DEPRECATED_SCANF
 0

	)

464 
	~<°dc-¥edef.h
>

472 #unde‡
__GNU_LIBRARY__


473 
	#__GNU_LIBRARY__
 6

	)

477 
	#__GLIBC__
 2

	)

478 
	#__GLIBC_MINOR__
 35

	)

480 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

481 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

484 #i‚de‡
__ASSEMBLER__


485 #i‚de‡
_SYS_CDEFS_H


486 
	~<sys/cdefs.h
>

491 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


492 
	#__USE_LARGEFILE
 1

	)

493 
	#__USE_LARGEFILE64
 1

	)

499 #i‡
	`__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

500 && !
deföed
 
__OPTIMIZE_SIZE__
 && !deföed 
__NO_INLINE__
 \

501 && 
deföed
 
__exã∫_ölöe


502 
	#__USE_EXTERN_INLINES
 1

	)

510 
	~<gnu/°ubs.h
>

	@/usr/include/linux/stddef.h

2 #i‚de‡
_LINUX_STDDEF_H


3 
	#_LINUX_STDDEF_H


	)

7 #i‚de‡
__Æways_ölöe


8 
	#__Æways_ölöe
 
__ölöe__


	)

26 
	#__°ru˘_group
(
TAG
, 
NAME
, 
ATTRS
, 
MEMBERS
...) \

28 °ru˘ { 
MEMBERS
 } 
ATTRS
; \

29 
	sTAG
 { 
MEMBERS
 } 
ATTRS
 
NAME
; \

30 } 
ATTRS


	)

42 
	#__DECLARE_FLEX_ARRAY
(
TYPE
, 
NAME
) \

44 °ru˘ { } 
__em±y_
 ## 
NAME
; \

45 
TYPE
 
NAME
[]; \

46 }

	)

	@/usr/include/features-time64.h

20 
	~<bôs/w‹dsize.h
>

21 
	~<bôs/timesize.h
>

23 #i‡
deföed
 
_TIME_BITS


24 #i‡
_TIME_BITS
 == 64

25 #i‡! 
deföed
 (
_FILE_OFFSET_BITS
) || _FILE_OFFSET_BITS != 64

27 #ñi‡
__TIMESIZE
 == 32

28 
	#__USE_TIME_BITS64
 1

	)

30 #ñi‡
_TIME_BITS
 == 32

31 #i‡
__TIMESIZE
 > 32

35 #îr‹ 
InvÆid
 
_TIME_BITS
 
vÆue
 (
ˇn
 
⁄ly
 
be
 32 
‹
 64-
bô
)

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde‡
__GCC_IEC_559


37 #i‡
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

39 
	#__STDC_IEC_60559_BFP__
 201404L

	)

42 
	#__STDC_IEC_559__
 1

	)

43 
	#__STDC_IEC_60559_BFP__
 201404L

	)

46 #ifde‡
__GCC_IEC_559_COMPLEX


47 #i‡
__GCC_IEC_559_COMPLEX
 > 0

48 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_60559_COMPLEX__
 201404L

	)

52 
	#__STDC_IEC_559_COMPLEX__
 1

	)

53 
	#__STDC_IEC_60559_COMPLEX__
 201404L

	)

62 
	#__STDC_ISO_10646__
 201706L

	)

	@
1
.
1
/usr/include
96
1792
ap.c
cfg80211.mod.c
chan.c
core.c
core.h
debugfs.c
debugfs.h
ethtool.c
ibss.c
lib80211.c
lib80211.mod.c
lib80211_crypt_ccmp.c
lib80211_crypt_ccmp.mod.c
lib80211_crypt_tkip.c
lib80211_crypt_tkip.mod.c
lib80211_crypt_wep.c
lib80211_crypt_wep.mod.c
mesh.c
mlme.c
nl80211.c
nl80211.h
ocb.c
of.c
pmsr.c
radiotap.c
rdev-ops.h
reg.c
reg.h
scan.c
shipped-certs.c
sme.c
sysfs.c
sysfs.h
tests/chan.c
tests/fragmentation.c
tests/module.c
tests/scan.c
tests/util.c
tests/util.h
thread_name.c
thread_name.h
time.c
time.mod.c
time/debug_print.c
time/debug_print.h
time/hello.c
time_module.c
trace.c
trace.h
util.c
wext-compat.c
wext-compat.h
wext-core.c
wext-priv.c
wext-proc.c
wext-sme.c
wext-spy.c
/usr/include/linux/errno.h
/usr/include/linux/if.h
/usr/include/linux/if_arp.h
/usr/include/linux/if_ether.h
/usr/include/linux/if_vlan.h
/usr/include/linux/kernel.h
/usr/include/linux/module.h
/usr/include/linux/mpls.h
/usr/include/linux/netdevice.h
/usr/include/linux/netlink.h
/usr/include/linux/nl80211.h
/usr/include/linux/random.h
/usr/include/linux/rfkill.h
/usr/include/linux/rtnetlink.h
/usr/include/linux/sched.h
/usr/include/linux/string.h
/usr/include/linux/time.h
/usr/include/linux/utsname.h
/usr/include/linux/wireless.h
/usr/include/linux/const.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/if_addr.h
/usr/include/linux/if_link.h
/usr/include/linux/if_packet.h
/usr/include/linux/ioctl.h
/usr/include/linux/irqnr.h
/usr/include/linux/libc-compat.h
/usr/include/linux/neighbour.h
/usr/include/linux/socket.h
/usr/include/linux/sysinfo.h
/usr/include/linux/time_types.h
/usr/include/linux/types.h
/usr/include/string.h
/usr/include/linux/posix_types.h
/usr/include/strings.h
/usr/include/features.h
/usr/include/linux/stddef.h
/usr/include/features-time64.h
/usr/include/stdc-predef.h
